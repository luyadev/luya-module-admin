function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/*
 AngularJS v1.7.9
 (c) 2010-2018 Google, Inc. http://angularjs.org
 License: MIT
*/
(function (C) {
  'use strict';

  function re(a) {
    if (D(a)) w(a.objectMaxDepth) && (Wb.objectMaxDepth = Xb(a.objectMaxDepth) ? a.objectMaxDepth : NaN), w(a.urlErrorParamsEnabled) && Ga(a.urlErrorParamsEnabled) && (Wb.urlErrorParamsEnabled = a.urlErrorParamsEnabled);else return Wb;
  }

  function Xb(a) {
    return W(a) && 0 < a;
  }

  function F(a, b) {
    b = b || Error;
    return function () {
      var d = arguments[0],
          c;
      c = "[" + (a ? a + ":" : "") + d + "] http://errors.angularjs.org/1.7.9/" + (a ? a + "/" : "") + d;

      for (d = 1; d < arguments.length; d++) {
        c = c + (1 == d ? "?" : "&") + "p" + (d - 1) + "=";
        var e = encodeURIComponent,
            f;
        f = arguments[d];
        f = "function" == typeof f ? f.toString().replace(/ \{[\s\S]*$/, "") : "undefined" == typeof f ? "undefined" : "string" != typeof f ? JSON.stringify(f) : f;
        c += e(f);
      }

      return new b(c);
    };
  }

  function ya(a) {
    if (null == a || $a(a)) return !1;
    if (H(a) || A(a) || x && a instanceof x) return !0;
    var b = "length" in Object(a) && a.length;
    return W(b) && (0 <= b && b - 1 in a || "function" === typeof a.item);
  }

  function r(a, b, d) {
    var c, e;
    if (a) if (B(a)) for (c in a) {
      "prototype" !== c && "length" !== c && "name" !== c && a.hasOwnProperty(c) && b.call(d, a[c], c, a);
    } else if (H(a) || ya(a)) {
      var f = "object" !== _typeof(a);

      c = 0;

      for (e = a.length; c < e; c++) {
        (f || c in a) && b.call(d, a[c], c, a);
      }
    } else if (a.forEach && a.forEach !== r) a.forEach(b, d, a);else if (Nc(a)) for (c in a) {
      b.call(d, a[c], c, a);
    } else if ("function" === typeof a.hasOwnProperty) for (c in a) {
      a.hasOwnProperty(c) && b.call(d, a[c], c, a);
    } else for (c in a) {
      ta.call(a, c) && b.call(d, a[c], c, a);
    }
    return a;
  }

  function Oc(a, b, d) {
    for (var c = Object.keys(a).sort(), e = 0; e < c.length; e++) {
      b.call(d, a[c[e]], c[e]);
    }

    return c;
  }

  function Yb(a) {
    return function (b, d) {
      a(d, b);
    };
  }

  function se() {
    return ++pb;
  }

  function Zb(a, b, d) {
    for (var c = a.$$hashKey, e = 0, f = b.length; e < f; ++e) {
      var g = b[e];
      if (D(g) || B(g)) for (var k = Object.keys(g), h = 0, l = k.length; h < l; h++) {
        var m = k[h],
            p = g[m];
        d && D(p) ? ha(p) ? a[m] = new Date(p.valueOf()) : ab(p) ? a[m] = new RegExp(p) : p.nodeName ? a[m] = p.cloneNode(!0) : $b(p) ? a[m] = p.clone() : "__proto__" !== m && (D(a[m]) || (a[m] = H(p) ? [] : {}), Zb(a[m], [p], !0)) : a[m] = p;
      }
    }

    c ? a.$$hashKey = c : delete a.$$hashKey;
    return a;
  }

  function S(a) {
    return Zb(a, Ha.call(arguments, 1), !1);
  }

  function te(a) {
    return Zb(a, Ha.call(arguments, 1), !0);
  }

  function fa(a) {
    return parseInt(a, 10);
  }

  function ac(a, b) {
    return S(Object.create(a), b);
  }

  function E() {}

  function Ta(a) {
    return a;
  }

  function ia(a) {
    return function () {
      return a;
    };
  }

  function bc(a) {
    return B(a.toString) && a.toString !== la;
  }

  function z(a) {
    return "undefined" === typeof a;
  }

  function w(a) {
    return "undefined" !== typeof a;
  }

  function D(a) {
    return null !== a && "object" === _typeof(a);
  }

  function Nc(a) {
    return null !== a && "object" === _typeof(a) && !Pc(a);
  }

  function A(a) {
    return "string" === typeof a;
  }

  function W(a) {
    return "number" === typeof a;
  }

  function ha(a) {
    return "[object Date]" === la.call(a);
  }

  function H(a) {
    return Array.isArray(a) || a instanceof Array;
  }

  function cc(a) {
    switch (la.call(a)) {
      case "[object Error]":
        return !0;

      case "[object Exception]":
        return !0;

      case "[object DOMException]":
        return !0;

      default:
        return a instanceof Error;
    }
  }

  function B(a) {
    return "function" === typeof a;
  }

  function ab(a) {
    return "[object RegExp]" === la.call(a);
  }

  function $a(a) {
    return a && a.window === a;
  }

  function bb(a) {
    return a && a.$evalAsync && a.$watch;
  }

  function Ga(a) {
    return "boolean" === typeof a;
  }

  function ue(a) {
    return a && W(a.length) && ve.test(la.call(a));
  }

  function $b(a) {
    return !(!a || !(a.nodeName || a.prop && a.attr && a.find));
  }

  function we(a) {
    var b = {};
    a = a.split(",");
    var d;

    for (d = 0; d < a.length; d++) {
      b[a[d]] = !0;
    }

    return b;
  }

  function ua(a) {
    return K(a.nodeName || a[0] && a[0].nodeName);
  }

  function cb(a, b) {
    var d = a.indexOf(b);
    0 <= d && a.splice(d, 1);
    return d;
  }

  function Ia(a, b, d) {
    function c(a, b, c) {
      c--;
      if (0 > c) return "...";
      var d = b.$$hashKey,
          f;

      if (H(a)) {
        f = 0;

        for (var g = a.length; f < g; f++) {
          b.push(e(a[f], c));
        }
      } else if (Nc(a)) for (f in a) {
        b[f] = e(a[f], c);
      } else if (a && "function" === typeof a.hasOwnProperty) for (f in a) {
        a.hasOwnProperty(f) && (b[f] = e(a[f], c));
      } else for (f in a) {
        ta.call(a, f) && (b[f] = e(a[f], c));
      }

      d ? b.$$hashKey = d : delete b.$$hashKey;
      return b;
    }

    function e(a, b) {
      if (!D(a)) return a;
      var d = g.indexOf(a);
      if (-1 !== d) return k[d];
      if ($a(a) || bb(a)) throw pa("cpws");
      var d = !1,
          e = f(a);
      void 0 === e && (e = H(a) ? [] : Object.create(Pc(a)), d = !0);
      g.push(a);
      k.push(e);
      return d ? c(a, e, b) : e;
    }

    function f(a) {
      switch (la.call(a)) {
        case "[object Int8Array]":
        case "[object Int16Array]":
        case "[object Int32Array]":
        case "[object Float32Array]":
        case "[object Float64Array]":
        case "[object Uint8Array]":
        case "[object Uint8ClampedArray]":
        case "[object Uint16Array]":
        case "[object Uint32Array]":
          return new a.constructor(e(a.buffer), a.byteOffset, a.length);

        case "[object ArrayBuffer]":
          if (!a.slice) {
            var b = new ArrayBuffer(a.byteLength);
            new Uint8Array(b).set(new Uint8Array(a));
            return b;
          }

          return a.slice(0);

        case "[object Boolean]":
        case "[object Number]":
        case "[object String]":
        case "[object Date]":
          return new a.constructor(a.valueOf());

        case "[object RegExp]":
          return b = new RegExp(a.source, a.toString().match(/[^/]*$/)[0]), b.lastIndex = a.lastIndex, b;

        case "[object Blob]":
          return new a.constructor([a], {
            type: a.type
          });
      }

      if (B(a.cloneNode)) return a.cloneNode(!0);
    }

    var g = [],
        k = [];
    d = Xb(d) ? d : NaN;

    if (b) {
      if (ue(b) || "[object ArrayBuffer]" === la.call(b)) throw pa("cpta");
      if (a === b) throw pa("cpi");
      H(b) ? b.length = 0 : r(b, function (a, c) {
        "$$hashKey" !== c && delete b[c];
      });
      g.push(a);
      k.push(b);
      return c(a, b, d);
    }

    return e(a, d);
  }

  function dc(a, b) {
    return a === b || a !== a && b !== b;
  }

  function va(a, b) {
    if (a === b) return !0;
    if (null === a || null === b) return !1;
    if (a !== a && b !== b) return !0;

    var d = _typeof(a),
        c;

    if (d === _typeof(b) && "object" === d) if (H(a)) {
      if (!H(b)) return !1;

      if ((d = a.length) === b.length) {
        for (c = 0; c < d; c++) {
          if (!va(a[c], b[c])) return !1;
        }

        return !0;
      }
    } else {
      if (ha(a)) return ha(b) ? dc(a.getTime(), b.getTime()) : !1;
      if (ab(a)) return ab(b) ? a.toString() === b.toString() : !1;
      if (bb(a) || bb(b) || $a(a) || $a(b) || H(b) || ha(b) || ab(b)) return !1;
      d = T();

      for (c in a) {
        if ("$" !== c.charAt(0) && !B(a[c])) {
          if (!va(a[c], b[c])) return !1;
          d[c] = !0;
        }
      }

      for (c in b) {
        if (!(c in d) && "$" !== c.charAt(0) && w(b[c]) && !B(b[c])) return !1;
      }

      return !0;
    }
    return !1;
  }

  function db(a, b, d) {
    return a.concat(Ha.call(b, d));
  }

  function Va(a, b) {
    var d = 2 < arguments.length ? Ha.call(arguments, 2) : [];
    return !B(b) || b instanceof RegExp ? b : d.length ? function () {
      return arguments.length ? b.apply(a, db(d, arguments, 0)) : b.apply(a, d);
    } : function () {
      return arguments.length ? b.apply(a, arguments) : b.call(a);
    };
  }

  function Qc(a, b) {
    var d = b;
    "string" === typeof a && "$" === a.charAt(0) && "$" === a.charAt(1) ? d = void 0 : $a(b) ? d = "$WINDOW" : b && C.document === b ? d = "$DOCUMENT" : bb(b) && (d = "$SCOPE");
    return d;
  }

  function eb(a, b) {
    if (!z(a)) return W(b) || (b = b ? 2 : null), JSON.stringify(a, Qc, b);
  }

  function Rc(a) {
    return A(a) ? JSON.parse(a) : a;
  }

  function ec(a, b) {
    a = a.replace(xe, "");
    var d = Date.parse("Jan 01, 1970 00:00:00 " + a) / 6E4;
    return X(d) ? b : d;
  }

  function Sc(a, b) {
    a = new Date(a.getTime());
    a.setMinutes(a.getMinutes() + b);
    return a;
  }

  function fc(a, b, d) {
    d = d ? -1 : 1;
    var c = a.getTimezoneOffset();
    b = ec(b, c);
    return Sc(a, d * (b - c));
  }

  function za(a) {
    a = x(a).clone().empty();
    var b = x("<div></div>").append(a).html();

    try {
      return a[0].nodeType === Pa ? K(b) : b.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/, function (a, b) {
        return "<" + K(b);
      });
    } catch (d) {
      return K(b);
    }
  }

  function Tc(a) {
    try {
      return decodeURIComponent(a);
    } catch (b) {}
  }

  function gc(a) {
    var b = {};
    r((a || "").split("&"), function (a) {
      var c, e, f;
      a && (e = a = a.replace(/\+/g, "%20"), c = a.indexOf("="), -1 !== c && (e = a.substring(0, c), f = a.substring(c + 1)), e = Tc(e), w(e) && (f = w(f) ? Tc(f) : !0, ta.call(b, e) ? H(b[e]) ? b[e].push(f) : b[e] = [b[e], f] : b[e] = f));
    });
    return b;
  }

  function ye(a) {
    var b = [];
    r(a, function (a, c) {
      H(a) ? r(a, function (a) {
        b.push(ba(c, !0) + (!0 === a ? "" : "=" + ba(a, !0)));
      }) : b.push(ba(c, !0) + (!0 === a ? "" : "=" + ba(a, !0)));
    });
    return b.length ? b.join("&") : "";
  }

  function hc(a) {
    return ba(a, !0).replace(/%26/gi, "&").replace(/%3D/gi, "=").replace(/%2B/gi, "+");
  }

  function ba(a, b) {
    return encodeURIComponent(a).replace(/%40/gi, "@").replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%3B/gi, ";").replace(/%20/g, b ? "%20" : "+");
  }

  function ze(a, b) {
    var d,
        c,
        e = Qa.length;

    for (c = 0; c < e; ++c) {
      if (d = Qa[c] + b, A(d = a.getAttribute(d))) return d;
    }

    return null;
  }

  function Ae(a, b) {
    var d,
        c,
        e = {};
    r(Qa, function (b) {
      b += "app";
      !d && a.hasAttribute && a.hasAttribute(b) && (d = a, c = a.getAttribute(b));
    });
    r(Qa, function (b) {
      b += "app";
      var e;
      !d && (e = a.querySelector("[" + b.replace(":", "\\:") + "]")) && (d = e, c = e.getAttribute(b));
    });
    d && (Be ? (e.strictDi = null !== ze(d, "strict-di"), b(d, c ? [c] : [], e)) : C.console.error("AngularJS: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match."));
  }

  function Uc(a, b, d) {
    D(d) || (d = {});
    d = S({
      strictDi: !1
    }, d);

    var c = function c() {
      a = x(a);

      if (a.injector()) {
        var c = a[0] === C.document ? "document" : za(a);
        throw pa("btstrpd", c.replace(/</, "&lt;").replace(/>/, "&gt;"));
      }

      b = b || [];
      b.unshift(["$provide", function (b) {
        b.value("$rootElement", a);
      }]);
      d.debugInfoEnabled && b.push(["$compileProvider", function (a) {
        a.debugInfoEnabled(!0);
      }]);
      b.unshift("ng");
      c = fb(b, d.strictDi);
      c.invoke(["$rootScope", "$rootElement", "$compile", "$injector", function (a, b, c, d) {
        a.$apply(function () {
          b.data("$injector", d);
          c(b)(a);
        });
      }]);
      return c;
    },
        e = /^NG_ENABLE_DEBUG_INFO!/,
        f = /^NG_DEFER_BOOTSTRAP!/;

    C && e.test(C.name) && (d.debugInfoEnabled = !0, C.name = C.name.replace(e, ""));
    if (C && !f.test(C.name)) return c();
    C.name = C.name.replace(f, "");

    ca.resumeBootstrap = function (a) {
      r(a, function (a) {
        b.push(a);
      });
      return c();
    };

    B(ca.resumeDeferredBootstrap) && ca.resumeDeferredBootstrap();
  }

  function Ce() {
    C.name = "NG_ENABLE_DEBUG_INFO!" + C.name;
    C.location.reload();
  }

  function De(a) {
    a = ca.element(a).injector();
    if (!a) throw pa("test");
    return a.get("$$testability");
  }

  function Vc(a, b) {
    b = b || "_";
    return a.replace(Ee, function (a, c) {
      return (c ? b : "") + a.toLowerCase();
    });
  }

  function Fe() {
    var a;

    if (!Wc) {
      var b = qb();
      (rb = z(b) ? C.jQuery : b ? C[b] : void 0) && rb.fn.on ? (x = rb, S(rb.fn, {
        scope: Wa.scope,
        isolateScope: Wa.isolateScope,
        controller: Wa.controller,
        injector: Wa.injector,
        inheritedData: Wa.inheritedData
      })) : x = Y;
      a = x.cleanData;

      x.cleanData = function (b) {
        for (var c, e = 0, f; null != (f = b[e]); e++) {
          (c = (x._data(f) || {}).events) && c.$destroy && x(f).triggerHandler("$destroy");
        }

        a(b);
      };

      ca.element = x;
      Wc = !0;
    }
  }

  function gb(a, b, d) {
    if (!a) throw pa("areq", b || "?", d || "required");
    return a;
  }

  function sb(a, b, d) {
    d && H(a) && (a = a[a.length - 1]);
    gb(B(a), b, "not a function, got " + (a && "object" === _typeof(a) ? a.constructor.name || "Object" : _typeof(a)));
    return a;
  }

  function Ja(a, b) {
    if ("hasOwnProperty" === a) throw pa("badname", b);
  }

  function Ge(a, b, d) {
    if (!b) return a;
    b = b.split(".");

    for (var c, e = a, f = b.length, g = 0; g < f; g++) {
      c = b[g], a && (a = (e = a)[c]);
    }

    return !d && B(a) ? Va(e, a) : a;
  }

  function tb(a) {
    for (var b = a[0], d = a[a.length - 1], c, e = 1; b !== d && (b = b.nextSibling); e++) {
      if (c || a[e] !== b) c || (c = x(Ha.call(a, 0, e))), c.push(b);
    }

    return c || a;
  }

  function T() {
    return Object.create(null);
  }

  function ic(a) {
    if (null == a) return "";

    switch (_typeof(a)) {
      case "string":
        break;

      case "number":
        a = "" + a;
        break;

      default:
        a = !bc(a) || H(a) || ha(a) ? eb(a) : a.toString();
    }

    return a;
  }

  function He(a) {
    function b(a, b, c) {
      return a[b] || (a[b] = c());
    }

    var d = F("$injector"),
        c = F("ng");
    a = b(a, "angular", Object);
    a.$$minErr = a.$$minErr || F;
    return b(a, "module", function () {
      var a = {};
      return function (f, g, k) {
        var h = {};
        if ("hasOwnProperty" === f) throw c("badname", "module");
        g && a.hasOwnProperty(f) && (a[f] = null);
        return b(a, f, function () {
          function a(b, c, d, f) {
            f || (f = e);
            return function () {
              f[d || "push"]([b, c, arguments]);
              return t;
            };
          }

          function b(a, c, d) {
            d || (d = e);
            return function (b, e) {
              e && B(e) && (e.$$moduleName = f);
              d.push([a, c, arguments]);
              return t;
            };
          }

          if (!g) throw d("nomod", f);
          var e = [],
              n = [],
              s = [],
              G = a("$injector", "invoke", "push", n),
              t = {
            _invokeQueue: e,
            _configBlocks: n,
            _runBlocks: s,
            info: function info(a) {
              if (w(a)) {
                if (!D(a)) throw c("aobj", "value");
                h = a;
                return this;
              }

              return h;
            },
            requires: g,
            name: f,
            provider: b("$provide", "provider"),
            factory: b("$provide", "factory"),
            service: b("$provide", "service"),
            value: a("$provide", "value"),
            constant: a("$provide", "constant", "unshift"),
            decorator: b("$provide", "decorator", n),
            animation: b("$animateProvider", "register"),
            filter: b("$filterProvider", "register"),
            controller: b("$controllerProvider", "register"),
            directive: b("$compileProvider", "directive"),
            component: b("$compileProvider", "component"),
            config: G,
            run: function run(a) {
              s.push(a);
              return this;
            }
          };
          k && G(k);
          return t;
        });
      };
    });
  }

  function ja(a, b) {
    if (H(a)) {
      b = b || [];

      for (var d = 0, c = a.length; d < c; d++) {
        b[d] = a[d];
      }
    } else if (D(a)) for (d in b = b || {}, a) {
      if ("$" !== d.charAt(0) || "$" !== d.charAt(1)) b[d] = a[d];
    }

    return b || a;
  }

  function Ie(a, b) {
    var d = [];
    Xb(b) && (a = ca.copy(a, null, b));
    return JSON.stringify(a, function (a, b) {
      b = Qc(a, b);

      if (D(b)) {
        if (0 <= d.indexOf(b)) return "...";
        d.push(b);
      }

      return b;
    });
  }

  function Je(a) {
    S(a, {
      errorHandlingConfig: re,
      bootstrap: Uc,
      copy: Ia,
      extend: S,
      merge: te,
      equals: va,
      element: x,
      forEach: r,
      injector: fb,
      noop: E,
      bind: Va,
      toJson: eb,
      fromJson: Rc,
      identity: Ta,
      isUndefined: z,
      isDefined: w,
      isString: A,
      isFunction: B,
      isObject: D,
      isNumber: W,
      isElement: $b,
      isArray: H,
      version: Ke,
      isDate: ha,
      callbacks: {
        $$counter: 0
      },
      getTestability: De,
      reloadWithDebugInfo: Ce,
      $$minErr: F,
      $$csp: Aa,
      $$encodeUriSegment: hc,
      $$encodeUriQuery: ba,
      $$lowercase: K,
      $$stringify: ic,
      $$uppercase: ub
    });
    kc = He(C);
    kc("ng", ["ngLocale"], ["$provide", function (a) {
      a.provider({
        $$sanitizeUri: Le
      });
      a.provider("$compile", Xc).directive({
        a: Me,
        input: Yc,
        textarea: Yc,
        form: Ne,
        script: Oe,
        select: Pe,
        option: Qe,
        ngBind: Re,
        ngBindHtml: Se,
        ngBindTemplate: Te,
        ngClass: Ue,
        ngClassEven: Ve,
        ngClassOdd: We,
        ngCloak: Xe,
        ngController: Ye,
        ngForm: Ze,
        ngHide: $e,
        ngIf: af,
        ngInclude: bf,
        ngInit: cf,
        ngNonBindable: df,
        ngPluralize: ef,
        ngRef: ff,
        ngRepeat: gf,
        ngShow: hf,
        ngStyle: jf,
        ngSwitch: kf,
        ngSwitchWhen: lf,
        ngSwitchDefault: mf,
        ngOptions: nf,
        ngTransclude: of,
        ngModel: pf,
        ngList: qf,
        ngChange: rf,
        pattern: Zc,
        ngPattern: Zc,
        required: $c,
        ngRequired: $c,
        minlength: ad,
        ngMinlength: ad,
        maxlength: bd,
        ngMaxlength: bd,
        ngValue: sf,
        ngModelOptions: tf
      }).directive({
        ngInclude: uf,
        input: vf
      }).directive(vb).directive(cd);
      a.provider({
        $anchorScroll: wf,
        $animate: xf,
        $animateCss: yf,
        $$animateJs: zf,
        $$animateQueue: Af,
        $$AnimateRunner: Bf,
        $$animateAsyncRun: Cf,
        $browser: Df,
        $cacheFactory: Ef,
        $controller: Ff,
        $document: Gf,
        $$isDocumentHidden: Hf,
        $exceptionHandler: If,
        $filter: dd,
        $$forceReflow: Jf,
        $interpolate: Kf,
        $interval: Lf,
        $$intervalFactory: Mf,
        $http: Nf,
        $httpParamSerializer: Of,
        $httpParamSerializerJQLike: Pf,
        $httpBackend: Qf,
        $xhrFactory: Rf,
        $jsonpCallbacks: Sf,
        $location: Tf,
        $log: Uf,
        $parse: Vf,
        $rootScope: Wf,
        $q: Xf,
        $$q: Yf,
        $sce: Zf,
        $sceDelegate: $f,
        $sniffer: ag,
        $$taskTrackerFactory: bg,
        $templateCache: cg,
        $templateRequest: dg,
        $$testability: eg,
        $timeout: fg,
        $window: gg,
        $$rAF: hg,
        $$jqLite: ig,
        $$Map: jg,
        $$cookieReader: kg
      });
    }]).info({
      angularVersion: "1.7.9"
    });
  }

  function wb(a, b) {
    return b.toUpperCase();
  }

  function xb(a) {
    return a.replace(lg, wb);
  }

  function lc(a) {
    a = a.nodeType;
    return 1 === a || !a || 9 === a;
  }

  function ed(a, b) {
    var d,
        c,
        e = b.createDocumentFragment(),
        f = [];

    if (mc.test(a)) {
      d = e.appendChild(b.createElement("div"));
      c = (mg.exec(a) || ["", ""])[1].toLowerCase();
      c = oa[c] || oa._default;
      d.innerHTML = c[1] + a.replace(ng, "<$1></$2>") + c[2];

      for (c = c[0]; c--;) {
        d = d.lastChild;
      }

      f = db(f, d.childNodes);
      d = e.firstChild;
      d.textContent = "";
    } else f.push(b.createTextNode(a));

    e.textContent = "";
    e.innerHTML = "";
    r(f, function (a) {
      e.appendChild(a);
    });
    return e;
  }

  function Y(a) {
    if (a instanceof Y) return a;
    var b;
    A(a) && (a = U(a), b = !0);

    if (!(this instanceof Y)) {
      if (b && "<" !== a.charAt(0)) throw nc("nosel");
      return new Y(a);
    }

    if (b) {
      b = C.document;
      var d;
      a = (d = og.exec(a)) ? [b.createElement(d[1])] : (d = ed(a, b)) ? d.childNodes : [];
      oc(this, a);
    } else B(a) ? fd(a) : oc(this, a);
  }

  function pc(a) {
    return a.cloneNode(!0);
  }

  function yb(a, b) {
    !b && lc(a) && x.cleanData([a]);
    a.querySelectorAll && x.cleanData(a.querySelectorAll("*"));
  }

  function gd(a) {
    for (var b in a) {
      return !1;
    }

    return !0;
  }

  function hd(a) {
    var b = a.ng339,
        d = b && Ka[b],
        c = d && d.events,
        d = d && d.data;
    d && !gd(d) || c && !gd(c) || (delete Ka[b], a.ng339 = void 0);
  }

  function id(a, b, d, c) {
    if (w(c)) throw nc("offargs");
    var e = (c = zb(a)) && c.events,
        f = c && c.handle;

    if (f) {
      if (b) {
        var g = function g(b) {
          var c = e[b];
          w(d) && cb(c || [], d);
          w(d) && c && 0 < c.length || (a.removeEventListener(b, f), delete e[b]);
        };

        r(b.split(" "), function (a) {
          g(a);
          Ab[a] && g(Ab[a]);
        });
      } else for (b in e) {
        "$destroy" !== b && a.removeEventListener(b, f), delete e[b];
      }

      hd(a);
    }
  }

  function qc(a, b) {
    var d = a.ng339;
    if (d = d && Ka[d]) b ? delete d.data[b] : d.data = {}, hd(a);
  }

  function zb(a, b) {
    var d = a.ng339,
        d = d && Ka[d];
    b && !d && (a.ng339 = d = ++pg, d = Ka[d] = {
      events: {},
      data: {},
      handle: void 0
    });
    return d;
  }

  function rc(a, b, d) {
    if (lc(a)) {
      var c,
          e = w(d),
          f = !e && b && !D(b),
          g = !b;
      a = (a = zb(a, !f)) && a.data;
      if (e) a[xb(b)] = d;else {
        if (g) return a;
        if (f) return a && a[xb(b)];

        for (c in b) {
          a[xb(c)] = b[c];
        }
      }
    }
  }

  function Bb(a, b) {
    return a.getAttribute ? -1 < (" " + (a.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " ").indexOf(" " + b + " ") : !1;
  }

  function Cb(a, b) {
    if (b && a.setAttribute) {
      var d = (" " + (a.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " "),
          c = d;
      r(b.split(" "), function (a) {
        a = U(a);
        c = c.replace(" " + a + " ", " ");
      });
      c !== d && a.setAttribute("class", U(c));
    }
  }

  function Db(a, b) {
    if (b && a.setAttribute) {
      var d = (" " + (a.getAttribute("class") || "") + " ").replace(/[\n\t]/g, " "),
          c = d;
      r(b.split(" "), function (a) {
        a = U(a);
        -1 === c.indexOf(" " + a + " ") && (c += a + " ");
      });
      c !== d && a.setAttribute("class", U(c));
    }
  }

  function oc(a, b) {
    if (b) if (b.nodeType) a[a.length++] = b;else {
      var d = b.length;

      if ("number" === typeof d && b.window !== b) {
        if (d) for (var c = 0; c < d; c++) {
          a[a.length++] = b[c];
        }
      } else a[a.length++] = b;
    }
  }

  function jd(a, b) {
    return Eb(a, "$" + (b || "ngController") + "Controller");
  }

  function Eb(a, b, d) {
    9 === a.nodeType && (a = a.documentElement);

    for (b = H(b) ? b : [b]; a;) {
      for (var c = 0, e = b.length; c < e; c++) {
        if (w(d = x.data(a, b[c]))) return d;
      }

      a = a.parentNode || 11 === a.nodeType && a.host;
    }
  }

  function kd(a) {
    for (yb(a, !0); a.firstChild;) {
      a.removeChild(a.firstChild);
    }
  }

  function Fb(a, b) {
    b || yb(a);
    var d = a.parentNode;
    d && d.removeChild(a);
  }

  function qg(a, b) {
    b = b || C;
    if ("complete" === b.document.readyState) b.setTimeout(a);else x(b).on("load", a);
  }

  function fd(a) {
    function b() {
      C.document.removeEventListener("DOMContentLoaded", b);
      C.removeEventListener("load", b);
      a();
    }

    "complete" === C.document.readyState ? C.setTimeout(a) : (C.document.addEventListener("DOMContentLoaded", b), C.addEventListener("load", b));
  }

  function ld(a, b) {
    var d = Gb[b.toLowerCase()];
    return d && md[ua(a)] && d;
  }

  function rg(a, b) {
    var d = function d(c, _d) {
      c.isDefaultPrevented = function () {
        return c.defaultPrevented;
      };

      var f = b[_d || c.type],
          g = f ? f.length : 0;

      if (g) {
        if (z(c.immediatePropagationStopped)) {
          var k = c.stopImmediatePropagation;

          c.stopImmediatePropagation = function () {
            c.immediatePropagationStopped = !0;
            c.stopPropagation && c.stopPropagation();
            k && k.call(c);
          };
        }

        c.isImmediatePropagationStopped = function () {
          return !0 === c.immediatePropagationStopped;
        };

        var h = f.specialHandlerWrapper || sg;
        1 < g && (f = ja(f));

        for (var l = 0; l < g; l++) {
          c.isImmediatePropagationStopped() || h(a, c, f[l]);
        }
      }
    };

    d.elem = a;
    return d;
  }

  function sg(a, b, d) {
    d.call(a, b);
  }

  function tg(a, b, d) {
    var c = b.relatedTarget;
    c && (c === a || ug.call(a, c)) || d.call(a, b);
  }

  function ig() {
    this.$get = function () {
      return S(Y, {
        hasClass: function hasClass(a, b) {
          a.attr && (a = a[0]);
          return Bb(a, b);
        },
        addClass: function addClass(a, b) {
          a.attr && (a = a[0]);
          return Db(a, b);
        },
        removeClass: function removeClass(a, b) {
          a.attr && (a = a[0]);
          return Cb(a, b);
        }
      });
    };
  }

  function La(a, b) {
    var d = a && a.$$hashKey;
    if (d) return "function" === typeof d && (d = a.$$hashKey()), d;
    d = _typeof(a);
    return d = "function" === d || "object" === d && null !== a ? a.$$hashKey = d + ":" + (b || se)() : d + ":" + a;
  }

  function nd() {
    this._keys = [];
    this._values = [];
    this._lastKey = NaN;
    this._lastIndex = -1;
  }

  function od(a) {
    a = Function.prototype.toString.call(a).replace(vg, "");
    return a.match(wg) || a.match(xg);
  }

  function yg(a) {
    return (a = od(a)) ? "function(" + (a[1] || "").replace(/[\s\r\n]+/, " ") + ")" : "fn";
  }

  function fb(a, b) {
    function d(a) {
      return function (b, c) {
        if (D(b)) r(b, Yb(a));else return a(b, c);
      };
    }

    function c(a, b) {
      Ja(a, "service");
      if (B(b) || H(b)) b = n.instantiate(b);
      if (!b.$get) throw Ba("pget", a);
      return p[a + "Provider"] = b;
    }

    function e(a, b) {
      return function () {
        var c = t.invoke(b, this);
        if (z(c)) throw Ba("undef", a);
        return c;
      };
    }

    function f(a, b, d) {
      return c(a, {
        $get: !1 !== d ? e(a, b) : b
      });
    }

    function g(a) {
      gb(z(a) || H(a), "modulesToLoad", "not an array");
      var b = [],
          c;
      r(a, function (a) {
        function d(a) {
          var b, c;
          b = 0;

          for (c = a.length; b < c; b++) {
            var e = a[b],
                f = n.get(e[0]);
            f[e[1]].apply(f, e[2]);
          }
        }

        if (!m.get(a)) {
          m.set(a, !0);

          try {
            A(a) ? (c = kc(a), t.modules[a] = c, b = b.concat(g(c.requires)).concat(c._runBlocks), d(c._invokeQueue), d(c._configBlocks)) : B(a) ? b.push(n.invoke(a)) : H(a) ? b.push(n.invoke(a)) : sb(a, "module");
          } catch (e) {
            throw H(a) && (a = a[a.length - 1]), e.message && e.stack && -1 === e.stack.indexOf(e.message) && (e = e.message + "\n" + e.stack), Ba("modulerr", a, e.stack || e.message || e);
          }
        }
      });
      return b;
    }

    function k(a, c) {
      function d(b, e) {
        if (a.hasOwnProperty(b)) {
          if (a[b] === h) throw Ba("cdep", b + " <- " + l.join(" <- "));
          return a[b];
        }

        try {
          return l.unshift(b), a[b] = h, a[b] = c(b, e), a[b];
        } catch (f) {
          throw a[b] === h && delete a[b], f;
        } finally {
          l.shift();
        }
      }

      function e(a, c, f) {
        var g = [];
        a = fb.$$annotate(a, b, f);

        for (var h = 0, k = a.length; h < k; h++) {
          var l = a[h];
          if ("string" !== typeof l) throw Ba("itkn", l);
          g.push(c && c.hasOwnProperty(l) ? c[l] : d(l, f));
        }

        return g;
      }

      return {
        invoke: function invoke(a, b, c, d) {
          "string" === typeof c && (d = c, c = null);
          c = e(a, c, d);
          H(a) && (a = a[a.length - 1]);
          d = a;
          if (Ca || "function" !== typeof d) d = !1;else {
            var f = d.$$ngIsClass;
            Ga(f) || (f = d.$$ngIsClass = /^class\b/.test(Function.prototype.toString.call(d)));
            d = f;
          }
          return d ? (c.unshift(null), new (Function.prototype.bind.apply(a, c))()) : a.apply(b, c);
        },
        instantiate: function instantiate(a, b, c) {
          var d = H(a) ? a[a.length - 1] : a;
          a = e(a, b, c);
          a.unshift(null);
          return new (Function.prototype.bind.apply(d, a))();
        },
        get: d,
        annotate: fb.$$annotate,
        has: function has(b) {
          return p.hasOwnProperty(b + "Provider") || a.hasOwnProperty(b);
        }
      };
    }

    b = !0 === b;
    var h = {},
        l = [],
        m = new Hb(),
        p = {
      $provide: {
        provider: d(c),
        factory: d(f),
        service: d(function (a, b) {
          return f(a, ["$injector", function (a) {
            return a.instantiate(b);
          }]);
        }),
        value: d(function (a, b) {
          return f(a, ia(b), !1);
        }),
        constant: d(function (a, b) {
          Ja(a, "constant");
          p[a] = b;
          s[a] = b;
        }),
        decorator: function decorator(a, b) {
          var c = n.get(a + "Provider"),
              d = c.$get;

          c.$get = function () {
            var a = t.invoke(d, c);
            return t.invoke(b, null, {
              $delegate: a
            });
          };
        }
      }
    },
        n = p.$injector = k(p, function (a, b) {
      ca.isString(b) && l.push(b);
      throw Ba("unpr", l.join(" <- "));
    }),
        s = {},
        G = k(s, function (a, b) {
      var c = n.get(a + "Provider", b);
      return t.invoke(c.$get, c, void 0, a);
    }),
        t = G;
    p.$injectorProvider = {
      $get: ia(G)
    };
    t.modules = n.modules = T();
    var N = g(a),
        t = G.get("$injector");
    t.strictDi = b;
    r(N, function (a) {
      a && t.invoke(a);
    });

    t.loadNewModules = function (a) {
      r(g(a), function (a) {
        a && t.invoke(a);
      });
    };

    return t;
  }

  function wf() {
    var a = !0;

    this.disableAutoScrolling = function () {
      a = !1;
    };

    this.$get = ["$window", "$location", "$rootScope", function (b, d, c) {
      function e(a) {
        var b = null;
        Array.prototype.some.call(a, function (a) {
          if ("a" === ua(a)) return b = a, !0;
        });
        return b;
      }

      function f(a) {
        if (a) {
          a.scrollIntoView();
          var c;
          c = g.yOffset;
          B(c) ? c = c() : $b(c) ? (c = c[0], c = "fixed" !== b.getComputedStyle(c).position ? 0 : c.getBoundingClientRect().bottom) : W(c) || (c = 0);
          c && (a = a.getBoundingClientRect().top, b.scrollBy(0, a - c));
        } else b.scrollTo(0, 0);
      }

      function g(a) {
        a = A(a) ? a : W(a) ? a.toString() : d.hash();
        var b;
        a ? (b = k.getElementById(a)) ? f(b) : (b = e(k.getElementsByName(a))) ? f(b) : "top" === a && f(null) : f(null);
      }

      var k = b.document;
      a && c.$watch(function () {
        return d.hash();
      }, function (a, b) {
        a === b && "" === a || qg(function () {
          c.$evalAsync(g);
        });
      });
      return g;
    }];
  }

  function hb(a, b) {
    if (!a && !b) return "";
    if (!a) return b;
    if (!b) return a;
    H(a) && (a = a.join(" "));
    H(b) && (b = b.join(" "));
    return a + " " + b;
  }

  function zg(a) {
    A(a) && (a = a.split(" "));
    var b = T();
    r(a, function (a) {
      a.length && (b[a] = !0);
    });
    return b;
  }

  function ra(a) {
    return D(a) ? a : {};
  }

  function Ag(a, b, d, c, e) {
    function f() {
      qa = null;
      k();
    }

    function g() {
      t = y();
      t = z(t) ? null : t;
      va(t, P) && (t = P);
      N = P = t;
    }

    function k() {
      var a = N;
      g();
      if (v !== h.url() || a !== t) v = h.url(), N = t, r(J, function (a) {
        a(h.url(), t);
      });
    }

    var h = this,
        l = a.location,
        m = a.history,
        p = a.setTimeout,
        n = a.clearTimeout,
        s = {},
        G = e(d);
    h.isMock = !1;
    h.$$completeOutstandingRequest = G.completeTask;
    h.$$incOutstandingRequestCount = G.incTaskCount;
    h.notifyWhenNoOutstandingRequests = G.notifyWhenNoPendingTasks;
    var t,
        N,
        v = l.href,
        jc = b.find("base"),
        qa = null,
        y = c.history ? function () {
      try {
        return m.state;
      } catch (a) {}
    } : E;
    g();

    h.url = function (b, d, e) {
      z(e) && (e = null);
      l !== a.location && (l = a.location);
      m !== a.history && (m = a.history);

      if (b) {
        var f = N === e;
        b = ga(b).href;
        if (v === b && (!c.history || f)) return h;
        var k = v && Da(v) === Da(b);
        v = b;
        N = e;
        !c.history || k && f ? (k || (qa = b), d ? l.replace(b) : k ? (d = l, e = b, f = e.indexOf("#"), e = -1 === f ? "" : e.substr(f), d.hash = e) : l.href = b, l.href !== b && (qa = b)) : (m[d ? "replaceState" : "pushState"](e, "", b), g());
        qa && (qa = b);
        return h;
      }

      return (qa || l.href).replace(/#$/, "");
    };

    h.state = function () {
      return t;
    };

    var J = [],
        I = !1,
        P = null;

    h.onUrlChange = function (b) {
      if (!I) {
        if (c.history) x(a).on("popstate", f);
        x(a).on("hashchange", f);
        I = !0;
      }

      J.push(b);
      return b;
    };

    h.$$applicationDestroyed = function () {
      x(a).off("hashchange popstate", f);
    };

    h.$$checkUrlChange = k;

    h.baseHref = function () {
      var a = jc.attr("href");
      return a ? a.replace(/^(https?:)?\/\/[^/]*/, "") : "";
    };

    h.defer = function (a, b, c) {
      var d;
      b = b || 0;
      c = c || G.DEFAULT_TASK_TYPE;
      G.incTaskCount(c);
      d = p(function () {
        delete s[d];
        G.completeTask(a, c);
      }, b);
      s[d] = c;
      return d;
    };

    h.defer.cancel = function (a) {
      if (s.hasOwnProperty(a)) {
        var b = s[a];
        delete s[a];
        n(a);
        G.completeTask(E, b);
        return !0;
      }

      return !1;
    };
  }

  function Df() {
    this.$get = ["$window", "$log", "$sniffer", "$document", "$$taskTrackerFactory", function (a, b, d, c, e) {
      return new Ag(a, c, b, d, e);
    }];
  }

  function Ef() {
    this.$get = function () {
      function a(a, c) {
        function e(a) {
          a !== p && (n ? n === a && (n = a.n) : n = a, f(a.n, a.p), f(a, p), p = a, p.n = null);
        }

        function f(a, b) {
          a !== b && (a && (a.p = b), b && (b.n = a));
        }

        if (a in b) throw F("$cacheFactory")("iid", a);
        var g = 0,
            k = S({}, c, {
          id: a
        }),
            h = T(),
            l = c && c.capacity || Number.MAX_VALUE,
            m = T(),
            p = null,
            n = null;
        return b[a] = {
          put: function put(a, b) {
            if (!z(b)) {
              if (l < Number.MAX_VALUE) {
                var c = m[a] || (m[a] = {
                  key: a
                });
                e(c);
              }

              a in h || g++;
              h[a] = b;
              g > l && this.remove(n.key);
              return b;
            }
          },
          get: function get(a) {
            if (l < Number.MAX_VALUE) {
              var b = m[a];
              if (!b) return;
              e(b);
            }

            return h[a];
          },
          remove: function remove(a) {
            if (l < Number.MAX_VALUE) {
              var b = m[a];
              if (!b) return;
              b === p && (p = b.p);
              b === n && (n = b.n);
              f(b.n, b.p);
              delete m[a];
            }

            a in h && (delete h[a], g--);
          },
          removeAll: function removeAll() {
            h = T();
            g = 0;
            m = T();
            p = n = null;
          },
          destroy: function destroy() {
            m = k = h = null;
            delete b[a];
          },
          info: function info() {
            return S({}, k, {
              size: g
            });
          }
        };
      }

      var b = {};

      a.info = function () {
        var a = {};
        r(b, function (b, e) {
          a[e] = b.info();
        });
        return a;
      };

      a.get = function (a) {
        return b[a];
      };

      return a;
    };
  }

  function cg() {
    this.$get = ["$cacheFactory", function (a) {
      return a("templates");
    }];
  }

  function Xc(a, b) {
    function d(a, b, c) {
      var d = /^([@&]|[=<](\*?))(\??)\s*([\w$]*)$/,
          e = T();
      r(a, function (a, f) {
        a = a.trim();
        if (a in p) e[f] = p[a];else {
          var g = a.match(d);
          if (!g) throw $("iscp", b, f, a, c ? "controller bindings definition" : "isolate scope definition");
          e[f] = {
            mode: g[1][0],
            collection: "*" === g[2],
            optional: "?" === g[3],
            attrName: g[4] || f
          };
          g[4] && (p[a] = e[f]);
        }
      });
      return e;
    }

    function c(a) {
      var b = a.charAt(0);
      if (!b || b !== K(b)) throw $("baddir", a);
      if (a !== a.trim()) throw $("baddir", a);
    }

    function e(a) {
      var b = a.require || a.controller && a.name;
      !H(b) && D(b) && r(b, function (a, c) {
        var d = a.match(l);
        a.substring(d[0].length) || (b[c] = d[0] + c);
      });
      return b;
    }

    var f = {},
        g = /^\s*directive:\s*([\w-]+)\s+(.*)$/,
        k = /(([\w-]+)(?::([^;]+))?;?)/,
        h = we("ngSrc,ngSrcset,src,srcset"),
        l = /^(?:(\^\^?)?(\?)?(\^\^?)?)?/,
        m = /^(on[a-z]+|formaction)$/,
        p = T();

    this.directive = function qa(b, d) {
      gb(b, "name");
      Ja(b, "directive");
      A(b) ? (c(b), gb(d, "directiveFactory"), f.hasOwnProperty(b) || (f[b] = [], a.factory(b + "Directive", ["$injector", "$exceptionHandler", function (a, c) {
        var d = [];
        r(f[b], function (f, g) {
          try {
            var h = a.invoke(f);
            B(h) ? h = {
              compile: ia(h)
            } : !h.compile && h.link && (h.compile = ia(h.link));
            h.priority = h.priority || 0;
            h.index = g;
            h.name = h.name || b;
            h.require = e(h);
            var k = h,
                l = h.restrict;
            if (l && (!A(l) || !/[EACM]/.test(l))) throw $("badrestrict", l, b);
            k.restrict = l || "EA";
            h.$$moduleName = f.$$moduleName;
            d.push(h);
          } catch (m) {
            c(m);
          }
        });
        return d;
      }])), f[b].push(d)) : r(b, Yb(qa));
      return this;
    };

    this.component = function y(a, b) {
      function c(a) {
        function e(b) {
          return B(b) || H(b) ? function (c, d) {
            return a.invoke(b, this, {
              $element: c,
              $attrs: d
            });
          } : b;
        }

        var f = b.template || b.templateUrl ? b.template : "",
            g = {
          controller: d,
          controllerAs: Bg(b.controller) || b.controllerAs || "$ctrl",
          template: e(f),
          templateUrl: e(b.templateUrl),
          transclude: b.transclude,
          scope: {},
          bindToController: b.bindings || {},
          restrict: "E",
          require: b.require
        };
        r(b, function (a, b) {
          "$" === b.charAt(0) && (g[b] = a);
        });
        return g;
      }

      if (!A(a)) return r(a, Yb(Va(this, y))), this;

      var d = b.controller || function () {};

      r(b, function (a, b) {
        "$" === b.charAt(0) && (c[b] = a, B(d) && (d[b] = a));
      });
      c.$inject = ["$injector"];
      return this.directive(a, c);
    };

    this.aHrefSanitizationWhitelist = function (a) {
      return w(a) ? (b.aHrefSanitizationWhitelist(a), this) : b.aHrefSanitizationWhitelist();
    };

    this.imgSrcSanitizationWhitelist = function (a) {
      return w(a) ? (b.imgSrcSanitizationWhitelist(a), this) : b.imgSrcSanitizationWhitelist();
    };

    var n = !0;

    this.debugInfoEnabled = function (a) {
      return w(a) ? (n = a, this) : n;
    };

    var s = !1;

    this.strictComponentBindingsEnabled = function (a) {
      return w(a) ? (s = a, this) : s;
    };

    var G = 10;

    this.onChangesTtl = function (a) {
      return arguments.length ? (G = a, this) : G;
    };

    var t = !0;

    this.commentDirectivesEnabled = function (a) {
      return arguments.length ? (t = a, this) : t;
    };

    var N = !0;

    this.cssClassDirectivesEnabled = function (a) {
      return arguments.length ? (N = a, this) : N;
    };

    var v = T();

    this.addPropertySecurityContext = function (a, b, c) {
      var d = a.toLowerCase() + "|" + b.toLowerCase();
      if (d in v && v[d] !== c) throw $("ctxoverride", a, b, v[d], c);
      v[d] = c;
      return this;
    };

    (function () {
      function a(b, c) {
        r(c, function (a) {
          v[a.toLowerCase()] = b;
        });
      }

      a(V.HTML, ["iframe|srcdoc", "*|innerHTML", "*|outerHTML"]);
      a(V.CSS, ["*|style"]);
      a(V.URL, "area|href area|ping a|href a|ping blockquote|cite body|background del|cite input|src ins|cite q|cite".split(" "));
      a(V.MEDIA_URL, "audio|src img|src img|srcset source|src source|srcset track|src video|src video|poster".split(" "));
      a(V.RESOURCE_URL, "*|formAction applet|code applet|codebase base|href embed|src frame|src form|action head|profile html|manifest iframe|src link|href media|src object|codebase object|data script|src".split(" "));
    })();

    this.$get = ["$injector", "$interpolate", "$exceptionHandler", "$templateRequest", "$parse", "$controller", "$rootScope", "$sce", "$animate", function (a, b, c, e, p, M, L, u, R) {
      function q() {
        try {
          if (! --Ja) throw Ua = void 0, $("infchng", G);
          L.$apply(function () {
            for (var a = 0, b = Ua.length; a < b; ++a) {
              try {
                Ua[a]();
              } catch (d) {
                c(d);
              }
            }

            Ua = void 0;
          });
        } finally {
          Ja++;
        }
      }

      function ma(a, b) {
        if (!a) return a;
        if (!A(a)) throw $("srcset", b, a.toString());

        for (var c = "", d = U(a), e = /(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/, e = /\s/.test(d) ? e : /(,)/, d = d.split(e), e = Math.floor(d.length / 2), f = 0; f < e; f++) {
          var g = 2 * f,
              c = c + u.getTrustedMediaUrl(U(d[g])),
              c = c + (" " + U(d[g + 1]));
        }

        d = U(d[2 * f]).split(/\s/);
        c += u.getTrustedMediaUrl(U(d[0]));
        2 === d.length && (c += " " + U(d[1]));
        return c;
      }

      function w(a, b) {
        if (b) {
          var c = Object.keys(b),
              d,
              e,
              f;
          d = 0;

          for (e = c.length; d < e; d++) {
            f = c[d], this[f] = b[f];
          }
        } else this.$attr = {};

        this.$$element = a;
      }

      function O(a, b, c) {
        Fa.innerHTML = "<span " + b + ">";
        b = Fa.firstChild.attributes;
        var d = b[0];
        b.removeNamedItem(d.name);
        d.value = c;
        a.attributes.setNamedItem(d);
      }

      function sa(a, b) {
        try {
          a.addClass(b);
        } catch (c) {}
      }

      function da(a, b, c, d, e) {
        a instanceof x || (a = x(a));
        var f = Xa(a, b, a, c, d, e);
        da.$$addScopeClass(a);
        var g = null;
        return function (b, c, d) {
          if (!a) throw $("multilink");
          gb(b, "scope");
          e && e.needsNewScope && (b = b.$parent.$new());
          d = d || {};
          var h = d.parentBoundTranscludeFn,
              k = d.transcludeControllers;
          d = d.futureParentElement;
          h && h.$$boundTransclude && (h = h.$$boundTransclude);
          g || (g = (d = d && d[0]) ? "foreignobject" !== ua(d) && la.call(d).match(/SVG/) ? "svg" : "html" : "html");
          d = "html" !== g ? x(ja(g, x("<div></div>").append(a).html())) : c ? Wa.clone.call(a) : a;
          if (k) for (var l in k) {
            d.data("$" + l + "Controller", k[l].instance);
          }
          da.$$addScopeInfo(d, b);
          c && c(d, b);
          f && f(b, d, d, h);
          c || (a = f = null);
          return d;
        };
      }

      function Xa(a, b, c, d, e, f) {
        function g(a, c, d, e) {
          var f, k, l, m, p, I, t;
          if (n) for (t = Array(c.length), m = 0; m < h.length; m += 3) {
            f = h[m], t[f] = c[f];
          } else t = c;
          m = 0;

          for (p = h.length; m < p;) {
            k = t[h[m++]], c = h[m++], f = h[m++], c ? (c.scope ? (l = a.$new(), da.$$addScopeInfo(x(k), l)) : l = a, I = c.transcludeOnThisElement ? ka(a, c.transclude, e) : !c.templateOnThisElement && e ? e : !e && b ? ka(a, b) : null, c(f, l, k, d, I)) : f && f(a, k.childNodes, void 0, e);
          }
        }

        for (var h = [], k = H(a) || a instanceof x, l, m, p, I, n, t = 0; t < a.length; t++) {
          l = new w();
          11 === Ca && ib(a, t, k);
          m = sc(a[t], [], l, 0 === t ? d : void 0, e);
          (f = m.length ? aa(m, a[t], l, b, c, null, [], [], f) : null) && f.scope && da.$$addScopeClass(l.$$element);
          l = f && f.terminal || !(p = a[t].childNodes) || !p.length ? null : Xa(p, f ? (f.transcludeOnThisElement || !f.templateOnThisElement) && f.transclude : b);
          if (f || l) h.push(t, f, l), I = !0, n = n || f;
          f = null;
        }

        return I ? g : null;
      }

      function ib(a, b, c) {
        var d = a[b],
            e = d.parentNode,
            f;
        if (d.nodeType === Pa) for (;;) {
          f = e ? d.nextSibling : a[b + 1];
          if (!f || f.nodeType !== Pa) break;
          d.nodeValue += f.nodeValue;
          f.parentNode && f.parentNode.removeChild(f);
          c && f === a[b + 1] && a.splice(b + 1, 1);
        }
      }

      function ka(a, b, c) {
        function d(e, f, g, h, k) {
          e || (e = a.$new(!1, k), e.$$transcluded = !0);
          return b(e, f, {
            parentBoundTranscludeFn: c,
            transcludeControllers: g,
            futureParentElement: h
          });
        }

        var e = d.$$slots = T(),
            f;

        for (f in b.$$slots) {
          e[f] = b.$$slots[f] ? ka(a, b.$$slots[f], c) : null;
        }

        return d;
      }

      function sc(a, b, d, e, f) {
        var g = d.$attr,
            h;

        switch (a.nodeType) {
          case 1:
            h = ua(a);
            X(b, wa(h), "E", e, f);

            for (var l, m, n, t, J, s = a.attributes, v = 0, G = s && s.length; v < G; v++) {
              var P = !1,
                  N = !1,
                  r = !1,
                  y = !1,
                  u = !1,
                  M;
              l = s[v];
              m = l.name;
              t = l.value;
              n = wa(m.toLowerCase());
              (J = n.match(Ra)) ? (r = "Attr" === J[1], y = "Prop" === J[1], u = "On" === J[1], m = m.replace(pd, "").toLowerCase().substr(4 + J[1].length).replace(/_(.)/g, function (a, b) {
                return b.toUpperCase();
              })) : (M = n.match(Sa)) && ca(M[1]) && (P = m, N = m.substr(0, m.length - 5) + "end", m = m.substr(0, m.length - 6));
              if (y || u) d[n] = t, g[n] = l.name, y ? Ea(a, b, n, m) : b.push(qd(p, L, c, n, m, !1));else {
                n = wa(m.toLowerCase());
                g[n] = m;
                if (r || !d.hasOwnProperty(n)) d[n] = t, ld(a, n) && (d[n] = !0);
                Ia(a, b, t, n, r);
                X(b, n, "A", e, f, P, N);
              }
            }

            "input" === h && "hidden" === a.getAttribute("type") && a.setAttribute("autocomplete", "off");
            if (!Qa) break;
            g = a.className;
            D(g) && (g = g.animVal);
            if (A(g) && "" !== g) for (; a = k.exec(g);) {
              n = wa(a[2]), X(b, n, "C", e, f) && (d[n] = U(a[3])), g = g.substr(a.index + a[0].length);
            }
            break;

          case Pa:
            na(b, a.nodeValue);
            break;

          case 8:
            if (!Oa) break;
            F(a, b, d, e, f);
        }

        b.sort(ia);
        return b;
      }

      function F(a, b, c, d, e) {
        try {
          var f = g.exec(a.nodeValue);

          if (f) {
            var h = wa(f[1]);
            X(b, h, "M", d, e) && (c[h] = U(f[2]));
          }
        } catch (k) {}
      }

      function V(a, b, c) {
        var d = [],
            e = 0;

        if (b && a.hasAttribute && a.hasAttribute(b)) {
          do {
            if (!a) throw $("uterdir", b, c);
            1 === a.nodeType && (a.hasAttribute(b) && e++, a.hasAttribute(c) && e--);
            d.push(a);
            a = a.nextSibling;
          } while (0 < e);
        } else d.push(a);

        return x(d);
      }

      function Y(a, b, c) {
        return function (d, e, f, g, h) {
          e = V(e[0], b, c);
          return a(d, e, f, g, h);
        };
      }

      function Z(a, b, c, d, e, f) {
        var g;
        return a ? da(b, c, d, e, f) : function () {
          g || (g = da(b, c, d, e, f), b = c = f = null);
          return g.apply(this, arguments);
        };
      }

      function aa(a, b, d, e, f, g, h, k, l) {
        function m(a, b, c, d) {
          if (a) {
            c && (a = Y(a, c, d));
            a.require = u.require;
            a.directiveName = Q;
            if (s === u || u.$$isolateScope) a = Aa(a, {
              isolateScope: !0
            });
            h.push(a);
          }

          if (b) {
            c && (b = Y(b, c, d));
            b.require = u.require;
            b.directiveName = Q;
            if (s === u || u.$$isolateScope) b = Aa(b, {
              isolateScope: !0
            });
            k.push(b);
          }
        }

        function p(a, e, f, g, l) {
          function m(a, b, c, d) {
            var e;
            bb(a) || (d = c, c = b, b = a, a = void 0);
            N && (e = P);
            c || (c = N ? Q.parent() : Q);

            if (d) {
              var f = l.$$slots[d];
              if (f) return f(a, b, e, c, R);
              if (z(f)) throw $("noslot", d, za(Q));
            } else return l(a, b, e, c, R);
          }

          var n, u, L, y, G, P, M, Q;
          b === f ? (g = d, Q = d.$$element) : (Q = x(f), g = new w(Q, d));
          G = e;
          s ? y = e.$new(!0) : t && (G = e.$parent);
          l && (M = m, M.$$boundTransclude = l, M.isSlotFilled = function (a) {
            return !!l.$$slots[a];
          });
          J && (P = ea(Q, g, M, J, y, e, s));
          s && (da.$$addScopeInfo(Q, y, !0, !(v && (v === s || v === s.$$originalDirective))), da.$$addScopeClass(Q, !0), y.$$isolateBindings = s.$$isolateBindings, u = Da(e, g, y, y.$$isolateBindings, s), u.removeWatches && y.$on("$destroy", u.removeWatches));

          for (n in P) {
            u = J[n];
            L = P[n];
            var Cg = u.$$bindings.bindToController;
            L.instance = L();
            Q.data("$" + u.name + "Controller", L.instance);
            L.bindingInfo = Da(G, g, L.instance, Cg, u);
          }

          r(J, function (a, b) {
            var c = a.require;
            a.bindToController && !H(c) && D(c) && S(P[b].instance, W(b, c, Q, P));
          });
          r(P, function (a) {
            var b = a.instance;
            if (B(b.$onChanges)) try {
              b.$onChanges(a.bindingInfo.initialChanges);
            } catch (d) {
              c(d);
            }
            if (B(b.$onInit)) try {
              b.$onInit();
            } catch (e) {
              c(e);
            }
            B(b.$doCheck) && (G.$watch(function () {
              b.$doCheck();
            }), b.$doCheck());
            B(b.$onDestroy) && G.$on("$destroy", function () {
              b.$onDestroy();
            });
          });
          n = 0;

          for (u = h.length; n < u; n++) {
            L = h[n], Ba(L, L.isolateScope ? y : e, Q, g, L.require && W(L.directiveName, L.require, Q, P), M);
          }

          var R = e;
          s && (s.template || null === s.templateUrl) && (R = y);
          a && a(R, f.childNodes, void 0, l);

          for (n = k.length - 1; 0 <= n; n--) {
            L = k[n], Ba(L, L.isolateScope ? y : e, Q, g, L.require && W(L.directiveName, L.require, Q, P), M);
          }

          r(P, function (a) {
            a = a.instance;
            B(a.$postLink) && a.$postLink();
          });
        }

        l = l || {};

        for (var n = -Number.MAX_VALUE, t = l.newScopeDirective, J = l.controllerDirectives, s = l.newIsolateScopeDirective, v = l.templateDirective, L = l.nonTlbTranscludeDirective, G = !1, P = !1, N = l.hasElementTranscludeDirective, y = d.$$element = x(b), u, Q, M, R = e, q, ma = !1, Ib = !1, O, sa = 0, A = a.length; sa < A; sa++) {
          u = a[sa];
          var E = u.$$start,
              ib = u.$$end;
          E && (y = V(b, E, ib));
          M = void 0;
          if (n > u.priority) break;
          if (O = u.scope) u.templateUrl || (D(O) ? (ba("new/isolated scope", s || t, u, y), s = u) : ba("new/isolated scope", s, u, y)), t = t || u;
          Q = u.name;

          if (!ma && (u.replace && (u.templateUrl || u.template) || u.transclude && !u.$$tlb)) {
            for (O = sa + 1; ma = a[O++];) {
              if (ma.transclude && !ma.$$tlb || ma.replace && (ma.templateUrl || ma.template)) {
                Ib = !0;
                break;
              }
            }

            ma = !0;
          }

          !u.templateUrl && u.controller && (J = J || T(), ba("'" + Q + "' controller", J[Q], u, y), J[Q] = u);
          if (O = u.transclude) if (G = !0, u.$$tlb || (ba("transclusion", L, u, y), L = u), "element" === O) N = !0, n = u.priority, M = y, y = d.$$element = x(da.$$createComment(Q, d[Q])), b = y[0], pa(f, Ha.call(M, 0), b), R = Z(Ib, M, e, n, g && g.name, {
            nonTlbTranscludeDirective: L
          });else {
            var ka = T();

            if (D(O)) {
              M = C.document.createDocumentFragment();
              var Xa = T(),
                  F = T();
              r(O, function (a, b) {
                var c = "?" === a.charAt(0);
                a = c ? a.substring(1) : a;
                Xa[a] = b;
                ka[b] = null;
                F[b] = c;
              });
              r(y.contents(), function (a) {
                var b = Xa[wa(ua(a))];
                b ? (F[b] = !0, ka[b] = ka[b] || C.document.createDocumentFragment(), ka[b].appendChild(a)) : M.appendChild(a);
              });
              r(F, function (a, b) {
                if (!a) throw $("reqslot", b);
              });

              for (var K in ka) {
                ka[K] && (R = x(ka[K].childNodes), ka[K] = Z(Ib, R, e));
              }

              M = x(M.childNodes);
            } else M = x(pc(b)).contents();

            y.empty();
            R = Z(Ib, M, e, void 0, void 0, {
              needsNewScope: u.$$isolateScope || u.$$newScope
            });
            R.$$slots = ka;
          }
          if (u.template) if (P = !0, ba("template", v, u, y), v = u, O = B(u.template) ? u.template(y, d) : u.template, O = Na(O), u.replace) {
            g = u;
            M = mc.test(O) ? rd(ja(u.templateNamespace, U(O))) : [];
            b = M[0];
            if (1 !== M.length || 1 !== b.nodeType) throw $("tplrt", Q, "");
            pa(f, y, b);
            A = {
              $attr: {}
            };
            O = sc(b, [], A);
            var Dg = a.splice(sa + 1, a.length - (sa + 1));
            (s || t) && fa(O, s, t);
            a = a.concat(O).concat(Dg);
            ga(d, A);
            A = a.length;
          } else y.html(O);
          if (u.templateUrl) P = !0, ba("template", v, u, y), v = u, u.replace && (g = u), p = ha(a.splice(sa, a.length - sa), y, d, f, G && R, h, k, {
            controllerDirectives: J,
            newScopeDirective: t !== u && t,
            newIsolateScopeDirective: s,
            templateDirective: v,
            nonTlbTranscludeDirective: L
          }), A = a.length;else if (u.compile) try {
            q = u.compile(y, d, R);
            var X = u.$$originalDirective || u;
            B(q) ? m(null, Va(X, q), E, ib) : q && m(Va(X, q.pre), Va(X, q.post), E, ib);
          } catch (ca) {
            c(ca, za(y));
          }
          u.terminal && (p.terminal = !0, n = Math.max(n, u.priority));
        }

        p.scope = t && !0 === t.scope;
        p.transcludeOnThisElement = G;
        p.templateOnThisElement = P;
        p.transclude = R;
        l.hasElementTranscludeDirective = N;
        return p;
      }

      function W(a, b, c, d) {
        var e;

        if (A(b)) {
          var f = b.match(l);
          b = b.substring(f[0].length);
          var g = f[1] || f[3],
              f = "?" === f[2];
          "^^" === g ? c = c.parent() : e = (e = d && d[b]) && e.instance;

          if (!e) {
            var h = "$" + b + "Controller";
            e = "^^" === g && c[0] && 9 === c[0].nodeType ? null : g ? c.inheritedData(h) : c.data(h);
          }

          if (!e && !f) throw $("ctreq", b, a);
        } else if (H(b)) for (e = [], g = 0, f = b.length; g < f; g++) {
          e[g] = W(a, b[g], c, d);
        } else D(b) && (e = {}, r(b, function (b, f) {
          e[f] = W(a, b, c, d);
        }));

        return e || null;
      }

      function ea(a, b, c, d, e, f, g) {
        var h = T(),
            k;

        for (k in d) {
          var l = d[k],
              m = {
            $scope: l === g || l.$$isolateScope ? e : f,
            $element: a,
            $attrs: b,
            $transclude: c
          },
              p = l.controller;
          "@" === p && (p = b[l.name]);
          m = M(p, m, !0, l.controllerAs);
          h[l.name] = m;
          a.data("$" + l.name + "Controller", m.instance);
        }

        return h;
      }

      function fa(a, b, c) {
        for (var d = 0, e = a.length; d < e; d++) {
          a[d] = ac(a[d], {
            $$isolateScope: b,
            $$newScope: c
          });
        }
      }

      function X(b, c, e, g, h, k, l) {
        if (c === h) return null;
        var m = null;

        if (f.hasOwnProperty(c)) {
          h = a.get(c + "Directive");

          for (var p = 0, n = h.length; p < n; p++) {
            if (c = h[p], (z(g) || g > c.priority) && -1 !== c.restrict.indexOf(e)) {
              k && (c = ac(c, {
                $$start: k,
                $$end: l
              }));

              if (!c.$$bindings) {
                var I = m = c,
                    t = c.name,
                    u = {
                  isolateScope: null,
                  bindToController: null
                };
                D(I.scope) && (!0 === I.bindToController ? (u.bindToController = d(I.scope, t, !0), u.isolateScope = {}) : u.isolateScope = d(I.scope, t, !1));
                D(I.bindToController) && (u.bindToController = d(I.bindToController, t, !0));
                if (u.bindToController && !I.controller) throw $("noctrl", t);
                m = m.$$bindings = u;
                D(m.isolateScope) && (c.$$isolateBindings = m.isolateScope);
              }

              b.push(c);
              m = c;
            }
          }
        }

        return m;
      }

      function ca(b) {
        if (f.hasOwnProperty(b)) for (var c = a.get(b + "Directive"), d = 0, e = c.length; d < e; d++) {
          if (b = c[d], b.multiElement) return !0;
        }
        return !1;
      }

      function ga(a, b) {
        var c = b.$attr,
            d = a.$attr;
        r(a, function (d, e) {
          "$" !== e.charAt(0) && (b[e] && b[e] !== d && (d = d.length ? d + (("style" === e ? ";" : " ") + b[e]) : b[e]), a.$set(e, d, !0, c[e]));
        });
        r(b, function (b, e) {
          a.hasOwnProperty(e) || "$" === e.charAt(0) || (a[e] = b, "class" !== e && "style" !== e && (d[e] = c[e]));
        });
      }

      function ha(a, b, d, f, g, h, k, l) {
        var m = [],
            p,
            n,
            t = b[0],
            u = a.shift(),
            J = ac(u, {
          templateUrl: null,
          transclude: null,
          replace: null,
          $$originalDirective: u
        }),
            s = B(u.templateUrl) ? u.templateUrl(b, d) : u.templateUrl,
            L = u.templateNamespace;
        b.empty();
        e(s).then(function (c) {
          var e, I;
          c = Na(c);

          if (u.replace) {
            c = mc.test(c) ? rd(ja(L, U(c))) : [];
            e = c[0];
            if (1 !== c.length || 1 !== e.nodeType) throw $("tplrt", u.name, s);
            c = {
              $attr: {}
            };
            pa(f, b, e);
            var v = sc(e, [], c);
            D(u.scope) && fa(v, !0);
            a = v.concat(a);
            ga(d, c);
          } else e = t, b.html(c);

          a.unshift(J);
          p = aa(a, e, d, g, b, u, h, k, l);
          r(f, function (a, c) {
            a === e && (f[c] = b[0]);
          });

          for (n = Xa(b[0].childNodes, g); m.length;) {
            c = m.shift();
            I = m.shift();
            var y = m.shift(),
                P = m.shift(),
                v = b[0];

            if (!c.$$destroyed) {
              if (I !== t) {
                var G = I.className;
                l.hasElementTranscludeDirective && u.replace || (v = pc(e));
                pa(y, x(I), v);
                sa(x(v), G);
              }

              I = p.transcludeOnThisElement ? ka(c, p.transclude, P) : P;
              p(n, c, v, f, I);
            }
          }

          m = null;
        }).catch(function (a) {
          cc(a) && c(a);
        });
        return function (a, b, c, d, e) {
          a = e;
          b.$$destroyed || (m ? m.push(b, c, d, a) : (p.transcludeOnThisElement && (a = ka(b, p.transclude, e)), p(n, b, c, d, a)));
        };
      }

      function ia(a, b) {
        var c = b.priority - a.priority;
        return 0 !== c ? c : a.name !== b.name ? a.name < b.name ? -1 : 1 : a.index - b.index;
      }

      function ba(a, b, c, d) {
        function e(a) {
          return a ? " (module: " + a + ")" : "";
        }

        if (b) throw $("multidir", b.name, e(b.$$moduleName), c.name, e(c.$$moduleName), a, za(d));
      }

      function na(a, c) {
        var d = b(c, !0);
        d && a.push({
          priority: 0,
          compile: function compile(a) {
            a = a.parent();
            var b = !!a.length;
            b && da.$$addBindingClass(a);
            return function (a, c) {
              var e = c.parent();
              b || da.$$addBindingClass(e);
              da.$$addBindingInfo(e, d.expressions);
              a.$watch(d, function (a) {
                c[0].nodeValue = a;
              });
            };
          }
        });
      }

      function ja(a, b) {
        a = K(a || "html");

        switch (a) {
          case "svg":
          case "math":
            var c = C.document.createElement("div");
            c.innerHTML = "<" + a + ">" + b + "</" + a + ">";
            return c.childNodes[0].childNodes;

          default:
            return b;
        }
      }

      function oa(a, b) {
        if ("srcdoc" === b) return u.HTML;
        if ("src" === b || "ngSrc" === b) return -1 === ["img", "video", "audio", "source", "track"].indexOf(a) ? u.RESOURCE_URL : u.MEDIA_URL;
        if ("xlinkHref" === b) return "image" === a ? u.MEDIA_URL : "a" === a ? u.URL : u.RESOURCE_URL;
        if ("form" === a && "action" === b || "base" === a && "href" === b || "link" === a && "href" === b) return u.RESOURCE_URL;
        if ("a" === a && ("href" === b || "ngHref" === b)) return u.URL;
      }

      function xa(a, b) {
        var c = b.toLowerCase();
        return v[a + "|" + c] || v["*|" + c];
      }

      function ya(a) {
        return ma(u.valueOf(a), "ng-prop-srcset");
      }

      function Ea(a, b, c, d) {
        if (m.test(d)) throw $("nodomevents");
        a = ua(a);
        var e = xa(a, d),
            f = Ta;
        "srcset" !== d || "img" !== a && "source" !== a ? e && (f = u.getTrusted.bind(u, e)) : f = ya;
        b.push({
          priority: 100,
          compile: function compile(a, b) {
            var e = p(b[c]),
                g = p(b[c], function (a) {
              return u.valueOf(a);
            });
            return {
              pre: function pre(a, b) {
                function c() {
                  var g = e(a);
                  b[0][d] = f(g);
                }

                c();
                a.$watch(g, c);
              }
            };
          }
        });
      }

      function Ia(a, c, d, e, f) {
        var g = ua(a),
            k = oa(g, e),
            l = h[e] || f,
            p = b(d, !f, k, l);

        if (p) {
          if ("multiple" === e && "select" === g) throw $("selmulti", za(a));
          if (m.test(e)) throw $("nodomevents");
          c.push({
            priority: 100,
            compile: function compile() {
              return {
                pre: function pre(a, c, f) {
                  c = f.$$observers || (f.$$observers = T());
                  var g = f[e];
                  g !== d && (p = g && b(g, !0, k, l), d = g);
                  p && (f[e] = p(a), (c[e] || (c[e] = [])).$$inter = !0, (f.$$observers && f.$$observers[e].$$scope || a).$watch(p, function (a, b) {
                    "class" === e && a !== b ? f.$updateClass(a, b) : f.$set(e, a);
                  }));
                }
              };
            }
          });
        }
      }

      function pa(a, b, c) {
        var d = b[0],
            e = b.length,
            f = d.parentNode,
            g,
            h;
        if (a) for (g = 0, h = a.length; g < h; g++) {
          if (a[g] === d) {
            a[g++] = c;
            h = g + e - 1;

            for (var k = a.length; g < k; g++, h++) {
              h < k ? a[g] = a[h] : delete a[g];
            }

            a.length -= e - 1;
            a.context === d && (a.context = c);
            break;
          }
        }
        f && f.replaceChild(c, d);
        a = C.document.createDocumentFragment();

        for (g = 0; g < e; g++) {
          a.appendChild(b[g]);
        }

        x.hasData(d) && (x.data(c, x.data(d)), x(d).off("$destroy"));
        x.cleanData(a.querySelectorAll("*"));

        for (g = 1; g < e; g++) {
          delete b[g];
        }

        b[0] = c;
        b.length = 1;
      }

      function Aa(a, b) {
        return S(function () {
          return a.apply(null, arguments);
        }, a, b);
      }

      function Ba(a, b, d, e, f, g) {
        try {
          a(b, d, e, f, g);
        } catch (h) {
          c(h, za(d));
        }
      }

      function ra(a, b) {
        if (s) throw $("missingattr", a, b);
      }

      function Da(a, c, d, e, f) {
        function g(b, c, e) {
          B(d.$onChanges) && !dc(c, e) && (Ua || (a.$$postDigest(q), Ua = []), m || (m = {}, Ua.push(h)), m[b] && (e = m[b].previousValue), m[b] = new Jb(e, c));
        }

        function h() {
          d.$onChanges(m);
          m = void 0;
        }

        var k = [],
            l = {},
            m;
        r(e, function (e, h) {
          var m = e.attrName,
              n = e.optional,
              I,
              t,
              u,
              s;

          switch (e.mode) {
            case "@":
              n || ta.call(c, m) || (ra(m, f.name), d[h] = c[m] = void 0);
              n = c.$observe(m, function (a) {
                if (A(a) || Ga(a)) g(h, a, d[h]), d[h] = a;
              });
              c.$$observers[m].$$scope = a;
              I = c[m];
              A(I) ? d[h] = b(I)(a) : Ga(I) && (d[h] = I);
              l[h] = new Jb(tc, d[h]);
              k.push(n);
              break;

            case "=":
              if (!ta.call(c, m)) {
                if (n) break;
                ra(m, f.name);
                c[m] = void 0;
              }

              if (n && !c[m]) break;
              t = p(c[m]);
              s = t.literal ? va : dc;

              u = t.assign || function () {
                I = d[h] = t(a);
                throw $("nonassign", c[m], m, f.name);
              };

              I = d[h] = t(a);

              n = function n(b) {
                s(b, d[h]) || (s(b, I) ? u(a, b = d[h]) : d[h] = b);
                return I = b;
              };

              n.$stateful = !0;
              n = e.collection ? a.$watchCollection(c[m], n) : a.$watch(p(c[m], n), null, t.literal);
              k.push(n);
              break;

            case "<":
              if (!ta.call(c, m)) {
                if (n) break;
                ra(m, f.name);
                c[m] = void 0;
              }

              if (n && !c[m]) break;
              t = p(c[m]);
              var v = t.literal,
                  L = d[h] = t(a);
              l[h] = new Jb(tc, d[h]);
              n = a[e.collection ? "$watchCollection" : "$watch"](t, function (a, b) {
                if (b === a) {
                  if (b === L || v && va(b, L)) return;
                  b = L;
                }

                g(h, a, b);
                d[h] = a;
              });
              k.push(n);
              break;

            case "&":
              n || ta.call(c, m) || ra(m, f.name);
              t = c.hasOwnProperty(m) ? p(c[m]) : E;
              if (t === E && n) break;

              d[h] = function (b) {
                return t(a, b);
              };

          }
        });
        return {
          initialChanges: l,
          removeWatches: k.length && function () {
            for (var a = 0, b = k.length; a < b; ++a) {
              k[a]();
            }
          }
        };
      }

      var Ma = /^\w/,
          Fa = C.document.createElement("div"),
          Oa = t,
          Qa = N,
          Ja = G,
          Ua;
      w.prototype = {
        $normalize: wa,
        $addClass: function $addClass(a) {
          a && 0 < a.length && R.addClass(this.$$element, a);
        },
        $removeClass: function $removeClass(a) {
          a && 0 < a.length && R.removeClass(this.$$element, a);
        },
        $updateClass: function $updateClass(a, b) {
          var c = sd(a, b);
          c && c.length && R.addClass(this.$$element, c);
          (c = sd(b, a)) && c.length && R.removeClass(this.$$element, c);
        },
        $set: function $set(a, b, d, e) {
          var f = ld(this.$$element[0], a),
              g = td[a],
              h = a;
          f ? (this.$$element.prop(a, b), e = f) : g && (this[g] = b, h = g);
          this[a] = b;
          e ? this.$attr[a] = e : (e = this.$attr[a]) || (this.$attr[a] = e = Vc(a, "-"));
          "img" === ua(this.$$element) && "srcset" === a && (this[a] = b = ma(b, "$set('srcset', value)"));
          !1 !== d && (null === b || z(b) ? this.$$element.removeAttr(e) : Ma.test(e) ? f && !1 === b ? this.$$element.removeAttr(e) : this.$$element.attr(e, b) : O(this.$$element[0], e, b));
          (a = this.$$observers) && r(a[h], function (a) {
            try {
              a(b);
            } catch (d) {
              c(d);
            }
          });
        },
        $observe: function $observe(a, b) {
          var c = this,
              d = c.$$observers || (c.$$observers = T()),
              e = d[a] || (d[a] = []);
          e.push(b);
          L.$evalAsync(function () {
            e.$$inter || !c.hasOwnProperty(a) || z(c[a]) || b(c[a]);
          });
          return function () {
            cb(e, b);
          };
        }
      };
      var Ka = b.startSymbol(),
          La = b.endSymbol(),
          Na = "{{" === Ka && "}}" === La ? Ta : function (a) {
        return a.replace(/\{\{/g, Ka).replace(/}}/g, La);
      },
          Ra = /^ng(Attr|Prop|On)([A-Z].*)$/,
          Sa = /^(.+)Start$/;
      da.$$addBindingInfo = n ? function (a, b) {
        var c = a.data("$binding") || [];
        H(b) ? c = c.concat(b) : c.push(b);
        a.data("$binding", c);
      } : E;
      da.$$addBindingClass = n ? function (a) {
        sa(a, "ng-binding");
      } : E;
      da.$$addScopeInfo = n ? function (a, b, c, d) {
        a.data(c ? d ? "$isolateScopeNoTemplate" : "$isolateScope" : "$scope", b);
      } : E;
      da.$$addScopeClass = n ? function (a, b) {
        sa(a, b ? "ng-isolate-scope" : "ng-scope");
      } : E;

      da.$$createComment = function (a, b) {
        var c = "";
        n && (c = " " + (a || "") + ": ", b && (c += b + " "));
        return C.document.createComment(c);
      };

      return da;
    }];
  }

  function Jb(a, b) {
    this.previousValue = a;
    this.currentValue = b;
  }

  function wa(a) {
    return a.replace(pd, "").replace(Eg, function (a, d, c) {
      return c ? d.toUpperCase() : d;
    });
  }

  function sd(a, b) {
    var d = "",
        c = a.split(/\s+/),
        e = b.split(/\s+/),
        f = 0;

    a: for (; f < c.length; f++) {
      for (var g = c[f], k = 0; k < e.length; k++) {
        if (g === e[k]) continue a;
      }

      d += (0 < d.length ? " " : "") + g;
    }

    return d;
  }

  function rd(a) {
    a = x(a);
    var b = a.length;
    if (1 >= b) return a;

    for (; b--;) {
      var d = a[b];
      (8 === d.nodeType || d.nodeType === Pa && "" === d.nodeValue.trim()) && Fg.call(a, b, 1);
    }

    return a;
  }

  function Bg(a, b) {
    if (b && A(b)) return b;

    if (A(a)) {
      var d = ud.exec(a);
      if (d) return d[3];
    }
  }

  function Ff() {
    var a = {};

    this.has = function (b) {
      return a.hasOwnProperty(b);
    };

    this.register = function (b, d) {
      Ja(b, "controller");
      D(b) ? S(a, b) : a[b] = d;
    };

    this.$get = ["$injector", function (b) {
      function d(a, b, d, g) {
        if (!a || !D(a.$scope)) throw F("$controller")("noscp", g, b);
        a.$scope[b] = d;
      }

      return function (c, e, f, g) {
        var k, h, l;
        f = !0 === f;
        g && A(g) && (l = g);

        if (A(c)) {
          g = c.match(ud);
          if (!g) throw vd("ctrlfmt", c);
          h = g[1];
          l = l || g[3];
          c = a.hasOwnProperty(h) ? a[h] : Ge(e.$scope, h, !0);
          if (!c) throw vd("ctrlreg", h);
          sb(c, h, !0);
        }

        if (f) return f = (H(c) ? c[c.length - 1] : c).prototype, k = Object.create(f || null), l && d(e, l, k, h || c.name), S(function () {
          var a = b.invoke(c, k, e, h);
          a !== k && (D(a) || B(a)) && (k = a, l && d(e, l, k, h || c.name));
          return k;
        }, {
          instance: k,
          identifier: l
        });
        k = b.instantiate(c, e, h);
        l && d(e, l, k, h || c.name);
        return k;
      };
    }];
  }

  function Gf() {
    this.$get = ["$window", function (a) {
      return x(a.document);
    }];
  }

  function Hf() {
    this.$get = ["$document", "$rootScope", function (a, b) {
      function d() {
        e = c.hidden;
      }

      var c = a[0],
          e = c && c.hidden;
      a.on("visibilitychange", d);
      b.$on("$destroy", function () {
        a.off("visibilitychange", d);
      });
      return function () {
        return e;
      };
    }];
  }

  function If() {
    this.$get = ["$log", function (a) {
      return function (b, d) {
        a.error.apply(a, arguments);
      };
    }];
  }

  function uc(a) {
    return D(a) ? ha(a) ? a.toISOString() : eb(a) : a;
  }

  function Of() {
    this.$get = function () {
      return function (a) {
        if (!a) return "";
        var b = [];
        Oc(a, function (a, c) {
          null === a || z(a) || B(a) || (H(a) ? r(a, function (a) {
            b.push(ba(c) + "=" + ba(uc(a)));
          }) : b.push(ba(c) + "=" + ba(uc(a))));
        });
        return b.join("&");
      };
    };
  }

  function Pf() {
    this.$get = function () {
      return function (a) {
        function b(a, e, f) {
          H(a) ? r(a, function (a, c) {
            b(a, e + "[" + (D(a) ? c : "") + "]");
          }) : D(a) && !ha(a) ? Oc(a, function (a, c) {
            b(a, e + (f ? "" : "[") + c + (f ? "" : "]"));
          }) : (B(a) && (a = a()), d.push(ba(e) + "=" + (null == a ? "" : ba(uc(a)))));
        }

        if (!a) return "";
        var d = [];
        b(a, "", !0);
        return d.join("&");
      };
    };
  }

  function vc(a, b) {
    if (A(a)) {
      var d = a.replace(Gg, "").trim();

      if (d) {
        var c = b("Content-Type"),
            c = c && 0 === c.indexOf(wd),
            e;
        (e = c) || (e = (e = d.match(Hg)) && Ig[e[0]].test(d));
        if (e) try {
          a = Rc(d);
        } catch (f) {
          if (!c) return a;
          throw Kb("baddata", a, f);
        }
      }
    }

    return a;
  }

  function xd(a) {
    var b = T(),
        d;
    A(a) ? r(a.split("\n"), function (a) {
      d = a.indexOf(":");
      var e = K(U(a.substr(0, d)));
      a = U(a.substr(d + 1));
      e && (b[e] = b[e] ? b[e] + ", " + a : a);
    }) : D(a) && r(a, function (a, d) {
      var f = K(d),
          g = U(a);
      f && (b[f] = b[f] ? b[f] + ", " + g : g);
    });
    return b;
  }

  function yd(a) {
    var b;
    return function (d) {
      b || (b = xd(a));
      return d ? (d = b[K(d)], void 0 === d && (d = null), d) : b;
    };
  }

  function zd(a, b, d, c) {
    if (B(c)) return c(a, b, d);
    r(c, function (c) {
      a = c(a, b, d);
    });
    return a;
  }

  function Nf() {
    var a = this.defaults = {
      transformResponse: [vc],
      transformRequest: [function (a) {
        return D(a) && "[object File]" !== la.call(a) && "[object Blob]" !== la.call(a) && "[object FormData]" !== la.call(a) ? eb(a) : a;
      }],
      headers: {
        common: {
          Accept: "application/json, text/plain, */*"
        },
        post: ja(wc),
        put: ja(wc),
        patch: ja(wc)
      },
      xsrfCookieName: "XSRF-TOKEN",
      xsrfHeaderName: "X-XSRF-TOKEN",
      paramSerializer: "$httpParamSerializer",
      jsonpCallbackParam: "callback"
    },
        b = !1;

    this.useApplyAsync = function (a) {
      return w(a) ? (b = !!a, this) : b;
    };

    var d = this.interceptors = [],
        c = this.xsrfWhitelistedOrigins = [];
    this.$get = ["$browser", "$httpBackend", "$$cookieReader", "$cacheFactory", "$rootScope", "$q", "$injector", "$sce", function (e, f, g, k, h, l, m, p) {
      function n(b) {
        function c(a, b) {
          for (var d = 0, e = b.length; d < e;) {
            var f = b[d++],
                g = b[d++];
            a = a.then(f, g);
          }

          b.length = 0;
          return a;
        }

        function d(a, b) {
          var c,
              e = {};
          r(a, function (a, d) {
            B(a) ? (c = a(b), null != c && (e[d] = c)) : e[d] = a;
          });
          return e;
        }

        function f(a) {
          var b = S({}, a);
          b.data = zd(a.data, a.headers, a.status, g.transformResponse);
          a = a.status;
          return 200 <= a && 300 > a ? b : l.reject(b);
        }

        if (!D(b)) throw F("$http")("badreq", b);
        if (!A(p.valueOf(b.url))) throw F("$http")("badreq", b.url);
        var g = S({
          method: "get",
          transformRequest: a.transformRequest,
          transformResponse: a.transformResponse,
          paramSerializer: a.paramSerializer,
          jsonpCallbackParam: a.jsonpCallbackParam
        }, b);

        g.headers = function (b) {
          var c = a.headers,
              e = S({}, b.headers),
              f,
              g,
              h,
              c = S({}, c.common, c[K(b.method)]);

          a: for (f in c) {
            g = K(f);

            for (h in e) {
              if (K(h) === g) continue a;
            }

            e[f] = c[f];
          }

          return d(e, ja(b));
        }(b);

        g.method = ub(g.method);
        g.paramSerializer = A(g.paramSerializer) ? m.get(g.paramSerializer) : g.paramSerializer;
        e.$$incOutstandingRequestCount("$http");
        var h = [],
            k = [];
        b = l.resolve(g);
        r(v, function (a) {
          (a.request || a.requestError) && h.unshift(a.request, a.requestError);
          (a.response || a.responseError) && k.push(a.response, a.responseError);
        });
        b = c(b, h);
        b = b.then(function (b) {
          var c = b.headers,
              d = zd(b.data, yd(c), void 0, b.transformRequest);
          z(d) && r(c, function (a, b) {
            "content-type" === K(b) && delete c[b];
          });
          z(b.withCredentials) && !z(a.withCredentials) && (b.withCredentials = a.withCredentials);
          return s(b, d).then(f, f);
        });
        b = c(b, k);
        return b = b.finally(function () {
          e.$$completeOutstandingRequest(E, "$http");
        });
      }

      function s(c, d) {
        function e(a) {
          if (a) {
            var c = {};
            r(a, function (a, d) {
              c[d] = function (c) {
                function d() {
                  a(c);
                }

                b ? h.$applyAsync(d) : h.$$phase ? d() : h.$apply(d);
              };
            });
            return c;
          }
        }

        function k(a, c, d, e, f) {
          function g() {
            m(c, a, d, e, f);
          }

          R && (200 <= a && 300 > a ? R.put(O, [a, c, xd(d), e, f]) : R.remove(O));
          b ? h.$applyAsync(g) : (g(), h.$$phase || h.$apply());
        }

        function m(a, b, d, e, f) {
          b = -1 <= b ? b : 0;
          (200 <= b && 300 > b ? L.resolve : L.reject)({
            data: a,
            status: b,
            headers: yd(d),
            config: c,
            statusText: e,
            xhrStatus: f
          });
        }

        function s(a) {
          m(a.data, a.status, ja(a.headers()), a.statusText, a.xhrStatus);
        }

        function v() {
          var a = n.pendingRequests.indexOf(c);
          -1 !== a && n.pendingRequests.splice(a, 1);
        }

        var L = l.defer(),
            u = L.promise,
            R,
            q,
            ma = c.headers,
            x = "jsonp" === K(c.method),
            O = c.url;
        x ? O = p.getTrustedResourceUrl(O) : A(O) || (O = p.valueOf(O));
        O = G(O, c.paramSerializer(c.params));
        x && (O = t(O, c.jsonpCallbackParam));
        n.pendingRequests.push(c);
        u.then(v, v);
        !c.cache && !a.cache || !1 === c.cache || "GET" !== c.method && "JSONP" !== c.method || (R = D(c.cache) ? c.cache : D(a.cache) ? a.cache : N);
        R && (q = R.get(O), w(q) ? q && B(q.then) ? q.then(s, s) : H(q) ? m(q[1], q[0], ja(q[2]), q[3], q[4]) : m(q, 200, {}, "OK", "complete") : R.put(O, u));
        z(q) && ((q = jc(c.url) ? g()[c.xsrfCookieName || a.xsrfCookieName] : void 0) && (ma[c.xsrfHeaderName || a.xsrfHeaderName] = q), f(c.method, O, d, k, ma, c.timeout, c.withCredentials, c.responseType, e(c.eventHandlers), e(c.uploadEventHandlers)));
        return u;
      }

      function G(a, b) {
        0 < b.length && (a += (-1 === a.indexOf("?") ? "?" : "&") + b);
        return a;
      }

      function t(a, b) {
        var c = a.split("?");
        if (2 < c.length) throw Kb("badjsonp", a);
        c = gc(c[1]);
        r(c, function (c, d) {
          if ("JSON_CALLBACK" === c) throw Kb("badjsonp", a);
          if (d === b) throw Kb("badjsonp", b, a);
        });
        return a += (-1 === a.indexOf("?") ? "?" : "&") + b + "=JSON_CALLBACK";
      }

      var N = k("$http");
      a.paramSerializer = A(a.paramSerializer) ? m.get(a.paramSerializer) : a.paramSerializer;
      var v = [];
      r(d, function (a) {
        v.unshift(A(a) ? m.get(a) : m.invoke(a));
      });
      var jc = Jg(c);
      n.pendingRequests = [];

      (function (a) {
        r(arguments, function (a) {
          n[a] = function (b, c) {
            return n(S({}, c || {}, {
              method: a,
              url: b
            }));
          };
        });
      })("get", "delete", "head", "jsonp");

      (function (a) {
        r(arguments, function (a) {
          n[a] = function (b, c, d) {
            return n(S({}, d || {}, {
              method: a,
              url: b,
              data: c
            }));
          };
        });
      })("post", "put", "patch");

      n.defaults = a;
      return n;
    }];
  }

  function Rf() {
    this.$get = function () {
      return function () {
        return new C.XMLHttpRequest();
      };
    };
  }

  function Qf() {
    this.$get = ["$browser", "$jsonpCallbacks", "$document", "$xhrFactory", function (a, b, d, c) {
      return Kg(a, c, a.defer, b, d[0]);
    }];
  }

  function Kg(a, b, d, c, e) {
    function f(a, b, d) {
      a = a.replace("JSON_CALLBACK", b);
      var f = e.createElement("script"),
          _m = null;
      f.type = "text/javascript";
      f.src = a;
      f.async = !0;

      _m = function m(a) {
        f.removeEventListener("load", _m);
        f.removeEventListener("error", _m);
        e.body.removeChild(f);
        f = null;
        var g = -1,
            s = "unknown";
        a && ("load" !== a.type || c.wasCalled(b) || (a = {
          type: "error"
        }), s = a.type, g = "error" === a.type ? 404 : 200);
        d && d(g, s);
      };

      f.addEventListener("load", _m);
      f.addEventListener("error", _m);
      e.body.appendChild(f);
      return _m;
    }

    return function (e, k, h, l, m, p, n, s, G, t) {
      function N(a) {
        J = "timeout" === a;
        qa && qa();
        y && y.abort();
      }

      function v(a, b, c, e, f, g) {
        w(P) && d.cancel(P);
        qa = y = null;
        a(b, c, e, f, g);
      }

      k = k || a.url();
      if ("jsonp" === K(e)) var q = c.createCallback(k),
          qa = f(k, q, function (a, b) {
        var d = 200 === a && c.getResponse(q);
        v(l, a, d, "", b, "complete");
        c.removeCallback(q);
      });else {
        var y = b(e, k),
            J = !1;
        y.open(e, k, !0);
        r(m, function (a, b) {
          w(a) && y.setRequestHeader(b, a);
        });

        y.onload = function () {
          var a = y.statusText || "",
              b = "response" in y ? y.response : y.responseText,
              c = 1223 === y.status ? 204 : y.status;
          0 === c && (c = b ? 200 : "file" === ga(k).protocol ? 404 : 0);
          v(l, c, b, y.getAllResponseHeaders(), a, "complete");
        };

        y.onerror = function () {
          v(l, -1, null, null, "", "error");
        };

        y.ontimeout = function () {
          v(l, -1, null, null, "", "timeout");
        };

        y.onabort = function () {
          v(l, -1, null, null, "", J ? "timeout" : "abort");
        };

        r(G, function (a, b) {
          y.addEventListener(b, a);
        });
        r(t, function (a, b) {
          y.upload.addEventListener(b, a);
        });
        n && (y.withCredentials = !0);
        if (s) try {
          y.responseType = s;
        } catch (I) {
          if ("json" !== s) throw I;
        }
        y.send(z(h) ? null : h);
      }
      if (0 < p) var P = d(function () {
        N("timeout");
      }, p);else p && B(p.then) && p.then(function () {
        N(w(p.$$timeoutId) ? "timeout" : "abort");
      });
    };
  }

  function Kf() {
    var a = "{{",
        b = "}}";

    this.startSymbol = function (b) {
      return b ? (a = b, this) : a;
    };

    this.endSymbol = function (a) {
      return a ? (b = a, this) : b;
    };

    this.$get = ["$parse", "$exceptionHandler", "$sce", function (d, c, e) {
      function f(a) {
        return "\\\\\\" + a;
      }

      function g(c) {
        return c.replace(p, a).replace(n, b);
      }

      function k(a, b, c, d) {
        var e = a.$watch(function (a) {
          e();
          return d(a);
        }, b, c);
        return e;
      }

      function h(f, h, n, p) {
        function v(a) {
          try {
            return a = n && !r ? e.getTrusted(n, a) : e.valueOf(a), p && !w(a) ? a : ic(a);
          } catch (b) {
            c(Ma.interr(f, b));
          }
        }

        var r = n === e.URL || n === e.MEDIA_URL;

        if (!f.length || -1 === f.indexOf(a)) {
          if (h) return;
          h = g(f);
          r && (h = e.getTrusted(n, h));
          h = ia(h);
          h.exp = f;
          h.expressions = [];
          h.$$watchDelegate = k;
          return h;
        }

        p = !!p;

        for (var q, y, J = 0, I = [], P, Q = f.length, M = [], L = [], u; J < Q;) {
          if (-1 !== (q = f.indexOf(a, J)) && -1 !== (y = f.indexOf(b, q + l))) J !== q && M.push(g(f.substring(J, q))), J = f.substring(q + l, y), I.push(J), J = y + m, L.push(M.length), M.push("");else {
            J !== Q && M.push(g(f.substring(J)));
            break;
          }
        }

        u = 1 === M.length && 1 === L.length;
        var R = r && u ? void 0 : v;
        P = I.map(function (a) {
          return d(a, R);
        });

        if (!h || I.length) {
          var x = function x(a) {
            for (var b = 0, c = I.length; b < c; b++) {
              if (p && z(a[b])) return;
              M[L[b]] = a[b];
            }

            if (r) return e.getTrusted(n, u ? M[0] : M.join(""));
            n && 1 < M.length && Ma.throwNoconcat(f);
            return M.join("");
          };

          return S(function (a) {
            var b = 0,
                d = I.length,
                e = Array(d);

            try {
              for (; b < d; b++) {
                e[b] = P[b](a);
              }

              return x(e);
            } catch (g) {
              c(Ma.interr(f, g));
            }
          }, {
            exp: f,
            expressions: I,
            $$watchDelegate: function $$watchDelegate(a, b) {
              var c;
              return a.$watchGroup(P, function (d, e) {
                var f = x(d);
                b.call(this, f, d !== e ? c : f, a);
                c = f;
              });
            }
          });
        }
      }

      var l = a.length,
          m = b.length,
          p = new RegExp(a.replace(/./g, f), "g"),
          n = new RegExp(b.replace(/./g, f), "g");

      h.startSymbol = function () {
        return a;
      };

      h.endSymbol = function () {
        return b;
      };

      return h;
    }];
  }

  function Lf() {
    this.$get = ["$$intervalFactory", "$window", function (a, b) {
      var d = {},
          c = function c(a) {
        b.clearInterval(a);
        delete d[a];
      },
          e = a(function (a, c, e) {
        a = b.setInterval(a, c);
        d[a] = e;
        return a;
      }, c);

      e.cancel = function (a) {
        if (!a) return !1;
        if (!a.hasOwnProperty("$$intervalId")) throw Lg("badprom");
        if (!d.hasOwnProperty(a.$$intervalId)) return !1;
        a = a.$$intervalId;
        var b = d[a],
            e = b.promise;
        e.$$state && (e.$$state.pur = !0);
        b.reject("canceled");
        c(a);
        return !0;
      };

      return e;
    }];
  }

  function Mf() {
    this.$get = ["$browser", "$q", "$$q", "$rootScope", function (a, b, d, c) {
      return function (e, f) {
        return function (g, k, h, l) {
          function m() {
            p ? g.apply(null, n) : g(s);
          }

          var p = 4 < arguments.length,
              n = p ? Ha.call(arguments, 4) : [],
              s = 0,
              G = w(l) && !l,
              t = (G ? d : b).defer(),
              r = t.promise;
          h = w(h) ? h : 0;
          r.$$intervalId = e(function () {
            G ? a.defer(m) : c.$evalAsync(m);
            t.notify(s++);
            0 < h && s >= h && (t.resolve(s), f(r.$$intervalId));
            G || c.$apply();
          }, k, t, G);
          return r;
        };
      };
    }];
  }

  function Ad(a, b) {
    var d = ga(a);
    b.$$protocol = d.protocol;
    b.$$host = d.hostname;
    b.$$port = fa(d.port) || Mg[d.protocol] || null;
  }

  function Bd(a, b, d) {
    if (Ng.test(a)) throw jb("badpath", a);
    var c = "/" !== a.charAt(0);
    c && (a = "/" + a);
    a = ga(a);

    for (var c = (c && "/" === a.pathname.charAt(0) ? a.pathname.substring(1) : a.pathname).split("/"), e = c.length; e--;) {
      c[e] = decodeURIComponent(c[e]), d && (c[e] = c[e].replace(/\//g, "%2F"));
    }

    d = c.join("/");
    b.$$path = d;
    b.$$search = gc(a.search);
    b.$$hash = decodeURIComponent(a.hash);
    b.$$path && "/" !== b.$$path.charAt(0) && (b.$$path = "/" + b.$$path);
  }

  function xc(a, b) {
    return a.slice(0, b.length) === b;
  }

  function xa(a, b) {
    if (xc(b, a)) return b.substr(a.length);
  }

  function Da(a) {
    var b = a.indexOf("#");
    return -1 === b ? a : a.substr(0, b);
  }

  function yc(a, b, d) {
    this.$$html5 = !0;
    d = d || "";
    Ad(a, this);

    this.$$parse = function (a) {
      var d = xa(b, a);
      if (!A(d)) throw jb("ipthprfx", a, b);
      Bd(d, this, !0);
      this.$$path || (this.$$path = "/");
      this.$$compose();
    };

    this.$$normalizeUrl = function (a) {
      return b + a.substr(1);
    };

    this.$$parseLinkUrl = function (c, e) {
      if (e && "#" === e[0]) return this.hash(e.slice(1)), !0;
      var f, g;
      w(f = xa(a, c)) ? (g = f, g = d && w(f = xa(d, f)) ? b + (xa("/", f) || f) : a + g) : w(f = xa(b, c)) ? g = b + f : b === c + "/" && (g = b);
      g && this.$$parse(g);
      return !!g;
    };
  }

  function zc(a, b, d) {
    Ad(a, this);

    this.$$parse = function (c) {
      var e = xa(a, c) || xa(b, c),
          f;
      z(e) || "#" !== e.charAt(0) ? this.$$html5 ? f = e : (f = "", z(e) && (a = c, this.replace())) : (f = xa(d, e), z(f) && (f = e));
      Bd(f, this, !1);
      c = this.$$path;
      var e = a,
          g = /^\/[A-Z]:(\/.*)/;
      xc(f, e) && (f = f.replace(e, ""));
      g.exec(f) || (c = (f = g.exec(c)) ? f[1] : c);
      this.$$path = c;
      this.$$compose();
    };

    this.$$normalizeUrl = function (b) {
      return a + (b ? d + b : "");
    };

    this.$$parseLinkUrl = function (b, d) {
      return Da(a) === Da(b) ? (this.$$parse(b), !0) : !1;
    };
  }

  function Cd(a, b, d) {
    this.$$html5 = !0;
    zc.apply(this, arguments);

    this.$$parseLinkUrl = function (c, e) {
      if (e && "#" === e[0]) return this.hash(e.slice(1)), !0;
      var f, g;
      a === Da(c) ? f = c : (g = xa(b, c)) ? f = a + d + g : b === c + "/" && (f = b);
      f && this.$$parse(f);
      return !!f;
    };

    this.$$normalizeUrl = function (b) {
      return a + d + b;
    };
  }

  function Lb(a) {
    return function () {
      return this[a];
    };
  }

  function Dd(a, b) {
    return function (d) {
      if (z(d)) return this[a];
      this[a] = b(d);
      this.$$compose();
      return this;
    };
  }

  function Tf() {
    var a = "!",
        b = {
      enabled: !1,
      requireBase: !0,
      rewriteLinks: !0
    };

    this.hashPrefix = function (b) {
      return w(b) ? (a = b, this) : a;
    };

    this.html5Mode = function (a) {
      if (Ga(a)) return b.enabled = a, this;

      if (D(a)) {
        Ga(a.enabled) && (b.enabled = a.enabled);
        Ga(a.requireBase) && (b.requireBase = a.requireBase);
        if (Ga(a.rewriteLinks) || A(a.rewriteLinks)) b.rewriteLinks = a.rewriteLinks;
        return this;
      }

      return b;
    };

    this.$get = ["$rootScope", "$browser", "$sniffer", "$rootElement", "$window", function (d, c, e, f, g) {
      function k(a, b) {
        return a === b || ga(a).href === ga(b).href;
      }

      function h(a, b, d) {
        var e = m.url(),
            f = m.$$state;

        try {
          c.url(a, b, d), m.$$state = c.state();
        } catch (g) {
          throw m.url(e), m.$$state = f, g;
        }
      }

      function l(a, b) {
        d.$broadcast("$locationChangeSuccess", m.absUrl(), a, m.$$state, b);
      }

      var m, p;
      p = c.baseHref();
      var n = c.url(),
          s;

      if (b.enabled) {
        if (!p && b.requireBase) throw jb("nobase");
        s = n.substring(0, n.indexOf("/", n.indexOf("//") + 2)) + (p || "/");
        p = e.history ? yc : Cd;
      } else s = Da(n), p = zc;

      var r = s.substr(0, Da(s).lastIndexOf("/") + 1);
      m = new p(s, r, "#" + a);
      m.$$parseLinkUrl(n, n);
      m.$$state = c.state();
      var t = /^\s*(javascript|mailto):/i;
      f.on("click", function (a) {
        var e = b.rewriteLinks;

        if (e && !a.ctrlKey && !a.metaKey && !a.shiftKey && 2 !== a.which && 2 !== a.button) {
          for (var g = x(a.target); "a" !== ua(g[0]);) {
            if (g[0] === f[0] || !(g = g.parent())[0]) return;
          }

          if (!A(e) || !z(g.attr(e))) {
            var e = g.prop("href"),
                h = g.attr("href") || g.attr("xlink:href");
            D(e) && "[object SVGAnimatedString]" === e.toString() && (e = ga(e.animVal).href);
            t.test(e) || !e || g.attr("target") || a.isDefaultPrevented() || !m.$$parseLinkUrl(e, h) || (a.preventDefault(), m.absUrl() !== c.url() && d.$apply());
          }
        }
      });
      m.absUrl() !== n && c.url(m.absUrl(), !0);
      var N = !0;
      c.onUrlChange(function (a, b) {
        xc(a, r) ? (d.$evalAsync(function () {
          var c = m.absUrl(),
              e = m.$$state,
              f;
          m.$$parse(a);
          m.$$state = b;
          f = d.$broadcast("$locationChangeStart", a, c, b, e).defaultPrevented;
          m.absUrl() === a && (f ? (m.$$parse(c), m.$$state = e, h(c, !1, e)) : (N = !1, l(c, e)));
        }), d.$$phase || d.$digest()) : g.location.href = a;
      });
      d.$watch(function () {
        if (N || m.$$urlUpdatedByLocation) {
          m.$$urlUpdatedByLocation = !1;
          var a = c.url(),
              b = m.absUrl(),
              f = c.state(),
              g = m.$$replace,
              n = !k(a, b) || m.$$html5 && e.history && f !== m.$$state;
          if (N || n) N = !1, d.$evalAsync(function () {
            var b = m.absUrl(),
                c = d.$broadcast("$locationChangeStart", b, a, m.$$state, f).defaultPrevented;
            m.absUrl() === b && (c ? (m.$$parse(a), m.$$state = f) : (n && h(b, g, f === m.$$state ? null : m.$$state), l(a, f)));
          });
        }

        m.$$replace = !1;
      });
      return m;
    }];
  }

  function Uf() {
    var a = !0,
        b = this;

    this.debugEnabled = function (b) {
      return w(b) ? (a = b, this) : a;
    };

    this.$get = ["$window", function (d) {
      function c(a) {
        cc(a) && (a.stack && f ? a = a.message && -1 === a.stack.indexOf(a.message) ? "Error: " + a.message + "\n" + a.stack : a.stack : a.sourceURL && (a = a.message + "\n" + a.sourceURL + ":" + a.line));
        return a;
      }

      function e(a) {
        var b = d.console || {},
            e = b[a] || b.log || E;
        return function () {
          var a = [];
          r(arguments, function (b) {
            a.push(c(b));
          });
          return Function.prototype.apply.call(e, b, a);
        };
      }

      var f = Ca || /\bEdge\//.test(d.navigator && d.navigator.userAgent);
      return {
        log: e("log"),
        info: e("info"),
        warn: e("warn"),
        error: e("error"),
        debug: function () {
          var c = e("debug");
          return function () {
            a && c.apply(b, arguments);
          };
        }()
      };
    }];
  }

  function Og(a) {
    return a + "";
  }

  function Pg(a, b) {
    return "undefined" !== typeof a ? a : b;
  }

  function Ed(a, b) {
    return "undefined" === typeof a ? b : "undefined" === typeof b ? a : a + b;
  }

  function Qg(a, b) {
    switch (a.type) {
      case q.MemberExpression:
        if (a.computed) return !1;
        break;

      case q.UnaryExpression:
        return 1;

      case q.BinaryExpression:
        return "+" !== a.operator ? 1 : !1;

      case q.CallExpression:
        return !1;
    }

    return void 0 === b ? Fd : b;
  }

  function Z(a, b, d) {
    var c,
        e,
        f = a.isPure = Qg(a, d);

    switch (a.type) {
      case q.Program:
        c = !0;
        r(a.body, function (a) {
          Z(a.expression, b, f);
          c = c && a.expression.constant;
        });
        a.constant = c;
        break;

      case q.Literal:
        a.constant = !0;
        a.toWatch = [];
        break;

      case q.UnaryExpression:
        Z(a.argument, b, f);
        a.constant = a.argument.constant;
        a.toWatch = a.argument.toWatch;
        break;

      case q.BinaryExpression:
        Z(a.left, b, f);
        Z(a.right, b, f);
        a.constant = a.left.constant && a.right.constant;
        a.toWatch = a.left.toWatch.concat(a.right.toWatch);
        break;

      case q.LogicalExpression:
        Z(a.left, b, f);
        Z(a.right, b, f);
        a.constant = a.left.constant && a.right.constant;
        a.toWatch = a.constant ? [] : [a];
        break;

      case q.ConditionalExpression:
        Z(a.test, b, f);
        Z(a.alternate, b, f);
        Z(a.consequent, b, f);
        a.constant = a.test.constant && a.alternate.constant && a.consequent.constant;
        a.toWatch = a.constant ? [] : [a];
        break;

      case q.Identifier:
        a.constant = !1;
        a.toWatch = [a];
        break;

      case q.MemberExpression:
        Z(a.object, b, f);
        a.computed && Z(a.property, b, f);
        a.constant = a.object.constant && (!a.computed || a.property.constant);
        a.toWatch = a.constant ? [] : [a];
        break;

      case q.CallExpression:
        c = d = a.filter ? !b(a.callee.name).$stateful : !1;
        e = [];
        r(a.arguments, function (a) {
          Z(a, b, f);
          c = c && a.constant;
          e.push.apply(e, a.toWatch);
        });
        a.constant = c;
        a.toWatch = d ? e : [a];
        break;

      case q.AssignmentExpression:
        Z(a.left, b, f);
        Z(a.right, b, f);
        a.constant = a.left.constant && a.right.constant;
        a.toWatch = [a];
        break;

      case q.ArrayExpression:
        c = !0;
        e = [];
        r(a.elements, function (a) {
          Z(a, b, f);
          c = c && a.constant;
          e.push.apply(e, a.toWatch);
        });
        a.constant = c;
        a.toWatch = e;
        break;

      case q.ObjectExpression:
        c = !0;
        e = [];
        r(a.properties, function (a) {
          Z(a.value, b, f);
          c = c && a.value.constant;
          e.push.apply(e, a.value.toWatch);
          a.computed && (Z(a.key, b, !1), c = c && a.key.constant, e.push.apply(e, a.key.toWatch));
        });
        a.constant = c;
        a.toWatch = e;
        break;

      case q.ThisExpression:
        a.constant = !1;
        a.toWatch = [];
        break;

      case q.LocalsExpression:
        a.constant = !1, a.toWatch = [];
    }
  }

  function Gd(a) {
    if (1 === a.length) {
      a = a[0].expression;
      var b = a.toWatch;
      return 1 !== b.length ? b : b[0] !== a ? b : void 0;
    }
  }

  function Hd(a) {
    return a.type === q.Identifier || a.type === q.MemberExpression;
  }

  function Id(a) {
    if (1 === a.body.length && Hd(a.body[0].expression)) return {
      type: q.AssignmentExpression,
      left: a.body[0].expression,
      right: {
        type: q.NGValueParameter
      },
      operator: "="
    };
  }

  function Jd(a) {
    this.$filter = a;
  }

  function Kd(a) {
    this.$filter = a;
  }

  function Mb(a, b, d) {
    this.ast = new q(a, d);
    this.astCompiler = d.csp ? new Kd(b) : new Jd(b);
  }

  function Ac(a) {
    return B(a.valueOf) ? a.valueOf() : Rg.call(a);
  }

  function Vf() {
    var a = T(),
        b = {
      "true": !0,
      "false": !1,
      "null": null,
      undefined: void 0
    },
        d,
        c;

    this.addLiteral = function (a, c) {
      b[a] = c;
    };

    this.setIdentifierFns = function (a, b) {
      d = a;
      c = b;
      return this;
    };

    this.$get = ["$filter", function (e) {
      function f(b, c) {
        var d, f;

        switch (_typeof(b)) {
          case "string":
            return f = b = b.trim(), d = a[f], d || (d = new Nb(G), d = new Mb(d, e, G).parse(b), a[f] = p(d)), s(d, c);

          case "function":
            return s(b, c);

          default:
            return s(E, c);
        }
      }

      function g(a, b, c) {
        return null == a || null == b ? a === b : "object" !== _typeof(a) || (a = Ac(a), "object" !== _typeof(a) || c) ? a === b || a !== a && b !== b : !1;
      }

      function k(a, b, c, d, e) {
        var f = d.inputs,
            h;

        if (1 === f.length) {
          var k = g,
              f = f[0];
          return a.$watch(function (a) {
            var b = f(a);
            g(b, k, f.isPure) || (h = d(a, void 0, void 0, [b]), k = b && Ac(b));
            return h;
          }, b, c, e);
        }

        for (var l = [], m = [], n = 0, p = f.length; n < p; n++) {
          l[n] = g, m[n] = null;
        }

        return a.$watch(function (a) {
          for (var b = !1, c = 0, e = f.length; c < e; c++) {
            var k = f[c](a);
            if (b || (b = !g(k, l[c], f[c].isPure))) m[c] = k, l[c] = k && Ac(k);
          }

          b && (h = d(a, void 0, void 0, m));
          return h;
        }, b, c, e);
      }

      function h(a, b, c, d, e) {
        function f() {
          h(m) && k();
        }

        function g(a, b, c, d) {
          m = u && d ? d[0] : n(a, b, c, d);
          h(m) && a.$$postDigest(f);
          return s(m);
        }

        var h = d.literal ? l : w,
            k,
            m,
            n = d.$$intercepted || d,
            s = d.$$interceptor || Ta,
            u = d.inputs && !n.inputs;
        g.literal = d.literal;
        g.constant = d.constant;
        g.inputs = d.inputs;
        p(g);
        return k = a.$watch(g, b, c, e);
      }

      function l(a) {
        var b = !0;
        r(a, function (a) {
          w(a) || (b = !1);
        });
        return b;
      }

      function m(a, b, c, d) {
        var e = a.$watch(function (a) {
          e();
          return d(a);
        }, b, c);
        return e;
      }

      function p(a) {
        a.constant ? a.$$watchDelegate = m : a.oneTime ? a.$$watchDelegate = h : a.inputs && (a.$$watchDelegate = k);
        return a;
      }

      function n(a, b) {
        function c(d) {
          return b(a(d));
        }

        c.$stateful = a.$stateful || b.$stateful;
        c.$$pure = a.$$pure && b.$$pure;
        return c;
      }

      function s(a, b) {
        if (!b) return a;
        a.$$interceptor && (b = n(a.$$interceptor, b), a = a.$$intercepted);

        var c = !1,
            d = function d(_d2, e, f, g) {
          _d2 = c && g ? g[0] : a(_d2, e, f, g);
          return b(_d2);
        };

        d.$$intercepted = a;
        d.$$interceptor = b;
        d.literal = a.literal;
        d.oneTime = a.oneTime;
        d.constant = a.constant;
        b.$stateful || (c = !a.inputs, d.inputs = a.inputs ? a.inputs : [a], b.$$pure || (d.inputs = d.inputs.map(function (a) {
          return a.isPure === Fd ? function (b) {
            return a(b);
          } : a;
        })));
        return p(d);
      }

      var G = {
        csp: Aa().noUnsafeEval,
        literals: Ia(b),
        isIdentifierStart: B(d) && d,
        isIdentifierContinue: B(c) && c
      };

      f.$$getAst = function (a) {
        var b = new Nb(G);
        return new Mb(b, e, G).getAst(a).ast;
      };

      return f;
    }];
  }

  function Xf() {
    var a = !0;
    this.$get = ["$rootScope", "$exceptionHandler", function (b, d) {
      return Ld(function (a) {
        b.$evalAsync(a);
      }, d, a);
    }];

    this.errorOnUnhandledRejections = function (b) {
      return w(b) ? (a = b, this) : a;
    };
  }

  function Yf() {
    var a = !0;
    this.$get = ["$browser", "$exceptionHandler", function (b, d) {
      return Ld(function (a) {
        b.defer(a);
      }, d, a);
    }];

    this.errorOnUnhandledRejections = function (b) {
      return w(b) ? (a = b, this) : a;
    };
  }

  function Ld(a, b, d) {
    function c() {
      return new e();
    }

    function e() {
      var a = this.promise = new f();

      this.resolve = function (b) {
        h(a, b);
      };

      this.reject = function (b) {
        m(a, b);
      };

      this.notify = function (b) {
        n(a, b);
      };
    }

    function f() {
      this.$$state = {
        status: 0
      };
    }

    function g() {
      for (; !w && x.length;) {
        var a = x.shift();

        if (!a.pur) {
          a.pur = !0;
          var c = a.value,
              c = "Possibly unhandled rejection: " + ("function" === typeof c ? c.toString().replace(/ \{[\s\S]*$/, "") : z(c) ? "undefined" : "string" !== typeof c ? Ie(c, void 0) : c);
          cc(a.value) ? b(a.value, c) : b(c);
        }
      }
    }

    function k(c) {
      !d || c.pending || 2 !== c.status || c.pur || (0 === w && 0 === x.length && a(g), x.push(c));
      !c.processScheduled && c.pending && (c.processScheduled = !0, ++w, a(function () {
        var e, f, k;
        k = c.pending;
        c.processScheduled = !1;
        c.pending = void 0;

        try {
          for (var l = 0, n = k.length; l < n; ++l) {
            c.pur = !0;
            f = k[l][0];
            e = k[l][c.status];

            try {
              B(e) ? h(f, e(c.value)) : 1 === c.status ? h(f, c.value) : m(f, c.value);
            } catch (p) {
              m(f, p), p && !0 === p.$$passToExceptionHandler && b(p);
            }
          }
        } finally {
          --w, d && 0 === w && a(g);
        }
      }));
    }

    function h(a, b) {
      a.$$state.status || (b === a ? p(a, v("qcycle", b)) : l(a, b));
    }

    function l(a, b) {
      function c(b) {
        g || (g = !0, l(a, b));
      }

      function d(b) {
        g || (g = !0, p(a, b));
      }

      function e(b) {
        n(a, b);
      }

      var f,
          g = !1;

      try {
        if (D(b) || B(b)) f = b.then;
        B(f) ? (a.$$state.status = -1, f.call(b, c, d, e)) : (a.$$state.value = b, a.$$state.status = 1, k(a.$$state));
      } catch (h) {
        d(h);
      }
    }

    function m(a, b) {
      a.$$state.status || p(a, b);
    }

    function p(a, b) {
      a.$$state.value = b;
      a.$$state.status = 2;
      k(a.$$state);
    }

    function n(c, d) {
      var e = c.$$state.pending;
      0 >= c.$$state.status && e && e.length && a(function () {
        for (var a, c, f = 0, g = e.length; f < g; f++) {
          c = e[f][0];
          a = e[f][3];

          try {
            n(c, B(a) ? a(d) : d);
          } catch (h) {
            b(h);
          }
        }
      });
    }

    function s(a) {
      var b = new f();
      m(b, a);
      return b;
    }

    function G(a, b, c) {
      var d = null;

      try {
        B(c) && (d = c());
      } catch (e) {
        return s(e);
      }

      return d && B(d.then) ? d.then(function () {
        return b(a);
      }, s) : b(a);
    }

    function t(a, b, c, d) {
      var e = new f();
      h(e, a);
      return e.then(b, c, d);
    }

    function q(a) {
      if (!B(a)) throw v("norslvr", a);
      var b = new f();
      a(function (a) {
        h(b, a);
      }, function (a) {
        m(b, a);
      });
      return b;
    }

    var v = F("$q", TypeError),
        w = 0,
        x = [];
    S(f.prototype, {
      then: function then(a, b, c) {
        if (z(a) && z(b) && z(c)) return this;
        var d = new f();
        this.$$state.pending = this.$$state.pending || [];
        this.$$state.pending.push([d, a, b, c]);
        0 < this.$$state.status && k(this.$$state);
        return d;
      },
      "catch": function _catch(a) {
        return this.then(null, a);
      },
      "finally": function _finally(a, b) {
        return this.then(function (b) {
          return G(b, y, a);
        }, function (b) {
          return G(b, s, a);
        }, b);
      }
    });
    var y = t;
    q.prototype = f.prototype;
    q.defer = c;
    q.reject = s;
    q.when = t;
    q.resolve = y;

    q.all = function (a) {
      var b = new f(),
          c = 0,
          d = H(a) ? [] : {};
      r(a, function (a, e) {
        c++;
        t(a).then(function (a) {
          d[e] = a;
          --c || h(b, d);
        }, function (a) {
          m(b, a);
        });
      });
      0 === c && h(b, d);
      return b;
    };

    q.race = function (a) {
      var b = c();
      r(a, function (a) {
        t(a).then(b.resolve, b.reject);
      });
      return b.promise;
    };

    return q;
  }

  function hg() {
    this.$get = ["$window", "$timeout", function (a, b) {
      var d = a.requestAnimationFrame || a.webkitRequestAnimationFrame,
          c = a.cancelAnimationFrame || a.webkitCancelAnimationFrame || a.webkitCancelRequestAnimationFrame,
          e = !!d,
          f = e ? function (a) {
        var b = d(a);
        return function () {
          c(b);
        };
      } : function (a) {
        var c = b(a, 16.66, !1);
        return function () {
          b.cancel(c);
        };
      };
      f.supported = e;
      return f;
    }];
  }

  function Wf() {
    function a(a) {
      function b() {
        this.$$watchers = this.$$nextSibling = this.$$childHead = this.$$childTail = null;
        this.$$listeners = {};
        this.$$listenerCount = {};
        this.$$watchersCount = 0;
        this.$id = ++pb;
        this.$$ChildScope = null;
        this.$$suspended = !1;
      }

      b.prototype = a;
      return b;
    }

    var b = 10,
        d = F("$rootScope"),
        c = null,
        e = null;

    this.digestTtl = function (a) {
      arguments.length && (b = a);
      return b;
    };

    this.$get = ["$exceptionHandler", "$parse", "$browser", function (f, g, k) {
      function h(a) {
        a.currentScope.$$destroyed = !0;
      }

      function l(a) {
        9 === Ca && (a.$$childHead && l(a.$$childHead), a.$$nextSibling && l(a.$$nextSibling));
        a.$parent = a.$$nextSibling = a.$$prevSibling = a.$$childHead = a.$$childTail = a.$root = a.$$watchers = null;
      }

      function m() {
        this.$id = ++pb;
        this.$$phase = this.$parent = this.$$watchers = this.$$nextSibling = this.$$prevSibling = this.$$childHead = this.$$childTail = null;
        this.$root = this;
        this.$$suspended = this.$$destroyed = !1;
        this.$$listeners = {};
        this.$$listenerCount = {};
        this.$$watchersCount = 0;
        this.$$isolateBindings = null;
      }

      function p(a) {
        if (v.$$phase) throw d("inprog", v.$$phase);
        v.$$phase = a;
      }

      function n(a, b) {
        do {
          a.$$watchersCount += b;
        } while (a = a.$parent);
      }

      function s(a, b, c) {
        do {
          a.$$listenerCount[c] -= b, 0 === a.$$listenerCount[c] && delete a.$$listenerCount[c];
        } while (a = a.$parent);
      }

      function G() {}

      function t() {
        for (; y.length;) {
          try {
            y.shift()();
          } catch (a) {
            f(a);
          }
        }

        e = null;
      }

      function q() {
        null === e && (e = k.defer(function () {
          v.$apply(t);
        }, null, "$applyAsync"));
      }

      m.prototype = {
        constructor: m,
        $new: function $new(b, c) {
          var d;
          c = c || this;
          b ? (d = new m(), d.$root = this.$root) : (this.$$ChildScope || (this.$$ChildScope = a(this)), d = new this.$$ChildScope());
          d.$parent = c;
          d.$$prevSibling = c.$$childTail;
          c.$$childHead ? (c.$$childTail.$$nextSibling = d, c.$$childTail = d) : c.$$childHead = c.$$childTail = d;
          (b || c !== this) && d.$on("$destroy", h);
          return d;
        },
        $watch: function $watch(a, b, d, e) {
          var f = g(a);
          b = B(b) ? b : E;
          if (f.$$watchDelegate) return f.$$watchDelegate(this, b, d, f, a);
          var h = this,
              k = h.$$watchers,
              l = {
            fn: b,
            last: G,
            get: f,
            exp: e || a,
            eq: !!d
          };
          c = null;
          k || (k = h.$$watchers = [], k.$$digestWatchIndex = -1);
          k.unshift(l);
          k.$$digestWatchIndex++;
          n(this, 1);
          return function () {
            var a = cb(k, l);
            0 <= a && (n(h, -1), a < k.$$digestWatchIndex && k.$$digestWatchIndex--);
            c = null;
          };
        },
        $watchGroup: function $watchGroup(a, b) {
          function c() {
            h = !1;

            try {
              k ? (k = !1, b(e, e, g)) : b(e, d, g);
            } finally {
              for (var f = 0; f < a.length; f++) {
                d[f] = e[f];
              }
            }
          }

          var d = Array(a.length),
              e = Array(a.length),
              f = [],
              g = this,
              h = !1,
              k = !0;

          if (!a.length) {
            var l = !0;
            g.$evalAsync(function () {
              l && b(e, e, g);
            });
            return function () {
              l = !1;
            };
          }

          if (1 === a.length) return this.$watch(a[0], function (a, c, f) {
            e[0] = a;
            d[0] = c;
            b(e, a === c ? e : d, f);
          });
          r(a, function (a, b) {
            var d = g.$watch(a, function (a) {
              e[b] = a;
              h || (h = !0, g.$evalAsync(c));
            });
            f.push(d);
          });
          return function () {
            for (; f.length;) {
              f.shift()();
            }
          };
        },
        $watchCollection: function $watchCollection(a, b) {
          function c(a) {
            e = a;
            var b, d, g, h;

            if (!z(e)) {
              if (D(e)) {
                if (ya(e)) for (f !== n && (f = n, t = f.length = 0, l++), a = e.length, t !== a && (l++, f.length = t = a), b = 0; b < a; b++) {
                  h = f[b], g = e[b], d = h !== h && g !== g, d || h === g || (l++, f[b] = g);
                } else {
                  f !== p && (f = p = {}, t = 0, l++);
                  a = 0;

                  for (b in e) {
                    ta.call(e, b) && (a++, g = e[b], h = f[b], b in f ? (d = h !== h && g !== g, d || h === g || (l++, f[b] = g)) : (t++, f[b] = g, l++));
                  }

                  if (t > a) for (b in l++, f) {
                    ta.call(e, b) || (t--, delete f[b]);
                  }
                }
              } else f !== e && (f = e, l++);
              return l;
            }
          }

          c.$$pure = g(a).literal;
          c.$stateful = !c.$$pure;
          var d = this,
              e,
              f,
              h,
              k = 1 < b.length,
              l = 0,
              m = g(a, c),
              n = [],
              p = {},
              s = !0,
              t = 0;
          return this.$watch(m, function () {
            s ? (s = !1, b(e, e, d)) : b(e, h, d);
            if (k) if (D(e)) {
              if (ya(e)) {
                h = Array(e.length);

                for (var a = 0; a < e.length; a++) {
                  h[a] = e[a];
                }
              } else for (a in h = {}, e) {
                ta.call(e, a) && (h[a] = e[a]);
              }
            } else h = e;
          });
        },
        $digest: function $digest() {
          var a,
              g,
              h,
              l,
              m,
              n,
              s,
              r = b,
              q,
              y = w.length ? v : this,
              N = [],
              z,
              A;
          p("$digest");
          k.$$checkUrlChange();
          this === v && null !== e && (k.defer.cancel(e), t());
          c = null;

          do {
            s = !1;
            q = y;

            for (n = 0; n < w.length; n++) {
              try {
                A = w[n], l = A.fn, l(A.scope, A.locals);
              } catch (C) {
                f(C);
              }

              c = null;
            }

            w.length = 0;

            a: do {
              if (n = !q.$$suspended && q.$$watchers) for (n.$$digestWatchIndex = n.length; n.$$digestWatchIndex--;) {
                try {
                  if (a = n[n.$$digestWatchIndex]) if (m = a.get, (g = m(q)) !== (h = a.last) && !(a.eq ? va(g, h) : X(g) && X(h))) s = !0, c = a, a.last = a.eq ? Ia(g, null) : g, l = a.fn, l(g, h === G ? g : h, q), 5 > r && (z = 4 - r, N[z] || (N[z] = []), N[z].push({
                    msg: B(a.exp) ? "fn: " + (a.exp.name || a.exp.toString()) : a.exp,
                    newVal: g,
                    oldVal: h
                  }));else if (a === c) {
                    s = !1;
                    break a;
                  }
                } catch (E) {
                  f(E);
                }
              }
              if (!(n = !q.$$suspended && q.$$watchersCount && q.$$childHead || q !== y && q.$$nextSibling)) for (; q !== y && !(n = q.$$nextSibling);) {
                q = q.$parent;
              }
            } while (q = n);

            if ((s || w.length) && !r--) throw v.$$phase = null, d("infdig", b, N);
          } while (s || w.length);

          for (v.$$phase = null; J < x.length;) {
            try {
              x[J++]();
            } catch (D) {
              f(D);
            }
          }

          x.length = J = 0;
          k.$$checkUrlChange();
        },
        $suspend: function $suspend() {
          this.$$suspended = !0;
        },
        $isSuspended: function $isSuspended() {
          return this.$$suspended;
        },
        $resume: function $resume() {
          this.$$suspended = !1;
        },
        $destroy: function $destroy() {
          if (!this.$$destroyed) {
            var a = this.$parent;
            this.$broadcast("$destroy");
            this.$$destroyed = !0;
            this === v && k.$$applicationDestroyed();
            n(this, -this.$$watchersCount);

            for (var b in this.$$listenerCount) {
              s(this, this.$$listenerCount[b], b);
            }

            a && a.$$childHead === this && (a.$$childHead = this.$$nextSibling);
            a && a.$$childTail === this && (a.$$childTail = this.$$prevSibling);
            this.$$prevSibling && (this.$$prevSibling.$$nextSibling = this.$$nextSibling);
            this.$$nextSibling && (this.$$nextSibling.$$prevSibling = this.$$prevSibling);
            this.$destroy = this.$digest = this.$apply = this.$evalAsync = this.$applyAsync = E;

            this.$on = this.$watch = this.$watchGroup = function () {
              return E;
            };

            this.$$listeners = {};
            this.$$nextSibling = null;
            l(this);
          }
        },
        $eval: function $eval(a, b) {
          return g(a)(this, b);
        },
        $evalAsync: function $evalAsync(a, b) {
          v.$$phase || w.length || k.defer(function () {
            w.length && v.$digest();
          }, null, "$evalAsync");
          w.push({
            scope: this,
            fn: g(a),
            locals: b
          });
        },
        $$postDigest: function $$postDigest(a) {
          x.push(a);
        },
        $apply: function $apply(a) {
          try {
            p("$apply");

            try {
              return this.$eval(a);
            } finally {
              v.$$phase = null;
            }
          } catch (b) {
            f(b);
          } finally {
            try {
              v.$digest();
            } catch (c) {
              throw f(c), c;
            }
          }
        },
        $applyAsync: function $applyAsync(a) {
          function b() {
            c.$eval(a);
          }

          var c = this;
          a && y.push(b);
          a = g(a);
          q();
        },
        $on: function $on(a, b) {
          var c = this.$$listeners[a];
          c || (this.$$listeners[a] = c = []);
          c.push(b);
          var d = this;

          do {
            d.$$listenerCount[a] || (d.$$listenerCount[a] = 0), d.$$listenerCount[a]++;
          } while (d = d.$parent);

          var e = this;
          return function () {
            var d = c.indexOf(b);
            -1 !== d && (delete c[d], s(e, 1, a));
          };
        },
        $emit: function $emit(a, b) {
          var c = [],
              d,
              e = this,
              g = !1,
              h = {
            name: a,
            targetScope: e,
            stopPropagation: function stopPropagation() {
              g = !0;
            },
            preventDefault: function preventDefault() {
              h.defaultPrevented = !0;
            },
            defaultPrevented: !1
          },
              k = db([h], arguments, 1),
              l,
              m;

          do {
            d = e.$$listeners[a] || c;
            h.currentScope = e;
            l = 0;

            for (m = d.length; l < m; l++) {
              if (d[l]) try {
                d[l].apply(null, k);
              } catch (n) {
                f(n);
              } else d.splice(l, 1), l--, m--;
            }

            if (g) break;
            e = e.$parent;
          } while (e);

          h.currentScope = null;
          return h;
        },
        $broadcast: function $broadcast(a, b) {
          var c = this,
              d = this,
              e = {
            name: a,
            targetScope: this,
            preventDefault: function preventDefault() {
              e.defaultPrevented = !0;
            },
            defaultPrevented: !1
          };
          if (!this.$$listenerCount[a]) return e;

          for (var g = db([e], arguments, 1), h, k; c = d;) {
            e.currentScope = c;
            d = c.$$listeners[a] || [];
            h = 0;

            for (k = d.length; h < k; h++) {
              if (d[h]) try {
                d[h].apply(null, g);
              } catch (l) {
                f(l);
              } else d.splice(h, 1), h--, k--;
            }

            if (!(d = c.$$listenerCount[a] && c.$$childHead || c !== this && c.$$nextSibling)) for (; c !== this && !(d = c.$$nextSibling);) {
              c = c.$parent;
            }
          }

          e.currentScope = null;
          return e;
        }
      };
      var v = new m(),
          w = v.$$asyncQueue = [],
          x = v.$$postDigestQueue = [],
          y = v.$$applyAsyncQueue = [],
          J = 0;
      return v;
    }];
  }

  function Le() {
    var a = /^\s*(https?|s?ftp|mailto|tel|file):/,
        b = /^\s*((https?|ftp|file|blob):|data:image\/)/;

    this.aHrefSanitizationWhitelist = function (b) {
      return w(b) ? (a = b, this) : a;
    };

    this.imgSrcSanitizationWhitelist = function (a) {
      return w(a) ? (b = a, this) : b;
    };

    this.$get = function () {
      return function (d, c) {
        var e = c ? b : a,
            f = ga(d && d.trim()).href;
        return "" === f || f.match(e) ? d : "unsafe:" + f;
      };
    };
  }

  function Sg(a) {
    if ("self" === a) return a;

    if (A(a)) {
      if (-1 < a.indexOf("***")) throw Ea("iwcard", a);
      a = Md(a).replace(/\\\*\\\*/g, ".*").replace(/\\\*/g, "[^:/.?&;]*");
      return new RegExp("^" + a + "$");
    }

    if (ab(a)) return new RegExp("^" + a.source + "$");
    throw Ea("imatcher");
  }

  function Nd(a) {
    var b = [];
    w(a) && r(a, function (a) {
      b.push(Sg(a));
    });
    return b;
  }

  function $f() {
    this.SCE_CONTEXTS = V;
    var a = ["self"],
        b = [];

    this.resourceUrlWhitelist = function (b) {
      arguments.length && (a = Nd(b));
      return a;
    };

    this.resourceUrlBlacklist = function (a) {
      arguments.length && (b = Nd(a));
      return b;
    };

    this.$get = ["$injector", "$$sanitizeUri", function (d, c) {
      function e(a, b) {
        var c;
        "self" === a ? (c = Bc(b, Od)) || (C.document.baseURI ? c = C.document.baseURI : (Na || (Na = C.document.createElement("a"), Na.href = ".", Na = Na.cloneNode(!1)), c = Na.href), c = Bc(b, c)) : c = !!a.exec(b.href);
        return c;
      }

      function f(a) {
        var b = function b(a) {
          this.$$unwrapTrustedValue = function () {
            return a;
          };
        };

        a && (b.prototype = new a());

        b.prototype.valueOf = function () {
          return this.$$unwrapTrustedValue();
        };

        b.prototype.toString = function () {
          return this.$$unwrapTrustedValue().toString();
        };

        return b;
      }

      var g = function g(a) {
        throw Ea("unsafe");
      };

      d.has("$sanitize") && (g = d.get("$sanitize"));
      var k = f(),
          h = {};
      h[V.HTML] = f(k);
      h[V.CSS] = f(k);
      h[V.MEDIA_URL] = f(k);
      h[V.URL] = f(h[V.MEDIA_URL]);
      h[V.JS] = f(k);
      h[V.RESOURCE_URL] = f(h[V.URL]);
      return {
        trustAs: function trustAs(a, b) {
          var c = h.hasOwnProperty(a) ? h[a] : null;
          if (!c) throw Ea("icontext", a, b);
          if (null === b || z(b) || "" === b) return b;
          if ("string" !== typeof b) throw Ea("itype", a);
          return new c(b);
        },
        getTrusted: function getTrusted(d, f) {
          if (null === f || z(f) || "" === f) return f;
          var k = h.hasOwnProperty(d) ? h[d] : null;
          if (k && f instanceof k) return f.$$unwrapTrustedValue();
          B(f.$$unwrapTrustedValue) && (f = f.$$unwrapTrustedValue());
          if (d === V.MEDIA_URL || d === V.URL) return c(f.toString(), d === V.MEDIA_URL);

          if (d === V.RESOURCE_URL) {
            var k = ga(f.toString()),
                n,
                s,
                r = !1;
            n = 0;

            for (s = a.length; n < s; n++) {
              if (e(a[n], k)) {
                r = !0;
                break;
              }
            }

            if (r) for (n = 0, s = b.length; n < s; n++) {
              if (e(b[n], k)) {
                r = !1;
                break;
              }
            }
            if (r) return f;
            throw Ea("insecurl", f.toString());
          }

          if (d === V.HTML) return g(f);
          throw Ea("unsafe");
        },
        valueOf: function valueOf(a) {
          return a instanceof k ? a.$$unwrapTrustedValue() : a;
        }
      };
    }];
  }

  function Zf() {
    var a = !0;

    this.enabled = function (b) {
      arguments.length && (a = !!b);
      return a;
    };

    this.$get = ["$parse", "$sceDelegate", function (b, d) {
      if (a && 8 > Ca) throw Ea("iequirks");
      var c = ja(V);

      c.isEnabled = function () {
        return a;
      };

      c.trustAs = d.trustAs;
      c.getTrusted = d.getTrusted;
      c.valueOf = d.valueOf;
      a || (c.trustAs = c.getTrusted = function (a, b) {
        return b;
      }, c.valueOf = Ta);

      c.parseAs = function (a, d) {
        var e = b(d);
        return e.literal && e.constant ? e : b(d, function (b) {
          return c.getTrusted(a, b);
        });
      };

      var e = c.parseAs,
          f = c.getTrusted,
          g = c.trustAs;
      r(V, function (a, b) {
        var d = K(b);

        c[("parse_as_" + d).replace(Cc, wb)] = function (b) {
          return e(a, b);
        };

        c[("get_trusted_" + d).replace(Cc, wb)] = function (b) {
          return f(a, b);
        };

        c[("trust_as_" + d).replace(Cc, wb)] = function (b) {
          return g(a, b);
        };
      });
      return c;
    }];
  }

  function ag() {
    this.$get = ["$window", "$document", function (a, b) {
      var d = {},
          c = !((!a.nw || !a.nw.process) && a.chrome && (a.chrome.app && a.chrome.app.runtime || !a.chrome.app && a.chrome.runtime && a.chrome.runtime.id)) && a.history && a.history.pushState,
          e = fa((/android (\d+)/.exec(K((a.navigator || {}).userAgent)) || [])[1]),
          f = /Boxee/i.test((a.navigator || {}).userAgent),
          g = b[0] || {},
          k = g.body && g.body.style,
          h = !1,
          l = !1;
      k && (h = !!("transition" in k || "webkitTransition" in k), l = !!("animation" in k || "webkitAnimation" in k));
      return {
        history: !(!c || 4 > e || f),
        hasEvent: function hasEvent(a) {
          if ("input" === a && Ca) return !1;

          if (z(d[a])) {
            var b = g.createElement("div");
            d[a] = "on" + a in b;
          }

          return d[a];
        },
        csp: Aa(),
        transitions: h,
        animations: l,
        android: e
      };
    }];
  }

  function bg() {
    this.$get = ia(function (a) {
      return new Tg(a);
    });
  }

  function Tg(a) {
    function b() {
      var a = e.pop();
      return a && a.cb;
    }

    function d(a) {
      for (var b = e.length - 1; 0 <= b; --b) {
        var c = e[b];
        if (c.type === a) return e.splice(b, 1), c.cb;
      }
    }

    var c = {},
        e = [],
        f = this.ALL_TASKS_TYPE = "$$all$$",
        g = this.DEFAULT_TASK_TYPE = "$$default$$";

    this.completeTask = function (e, h) {
      h = h || g;

      try {
        e();
      } finally {
        var l;
        l = h || g;
        c[l] && (c[l]--, c[f]--);
        l = c[h];
        var m = c[f];
        if (!m || !l) for (l = m ? d : b; m = l(h);) {
          try {
            m();
          } catch (p) {
            a.error(p);
          }
        }
      }
    };

    this.incTaskCount = function (a) {
      a = a || g;
      c[a] = (c[a] || 0) + 1;
      c[f] = (c[f] || 0) + 1;
    };

    this.notifyWhenNoPendingTasks = function (a, b) {
      b = b || f;
      c[b] ? e.push({
        type: b,
        cb: a
      }) : a();
    };
  }

  function dg() {
    var a;

    this.httpOptions = function (b) {
      return b ? (a = b, this) : a;
    };

    this.$get = ["$exceptionHandler", "$templateCache", "$http", "$q", "$sce", function (b, d, c, e, f) {
      function g(k, h) {
        g.totalPendingRequests++;
        if (!A(k) || z(d.get(k))) k = f.getTrustedResourceUrl(k);
        var l = c.defaults && c.defaults.transformResponse;
        H(l) ? l = l.filter(function (a) {
          return a !== vc;
        }) : l === vc && (l = null);
        return c.get(k, S({
          cache: d,
          transformResponse: l
        }, a)).finally(function () {
          g.totalPendingRequests--;
        }).then(function (a) {
          return d.put(k, a.data);
        }, function (a) {
          h || (a = Ug("tpload", k, a.status, a.statusText), b(a));
          return e.reject(a);
        });
      }

      g.totalPendingRequests = 0;
      return g;
    }];
  }

  function eg() {
    this.$get = ["$rootScope", "$browser", "$location", function (a, b, d) {
      return {
        findBindings: function findBindings(a, b, d) {
          a = a.getElementsByClassName("ng-binding");
          var g = [];
          r(a, function (a) {
            var c = ca.element(a).data("$binding");
            c && r(c, function (c) {
              d ? new RegExp("(^|\\s)" + Md(b) + "(\\s|\\||$)").test(c) && g.push(a) : -1 !== c.indexOf(b) && g.push(a);
            });
          });
          return g;
        },
        findModels: function findModels(a, b, d) {
          for (var g = ["ng-", "data-ng-", "ng\\:"], k = 0; k < g.length; ++k) {
            var h = a.querySelectorAll("[" + g[k] + "model" + (d ? "=" : "*=") + '"' + b + '"]');
            if (h.length) return h;
          }
        },
        getLocation: function getLocation() {
          return d.url();
        },
        setLocation: function setLocation(b) {
          b !== d.url() && (d.url(b), a.$digest());
        },
        whenStable: function whenStable(a) {
          b.notifyWhenNoOutstandingRequests(a);
        }
      };
    }];
  }

  function fg() {
    this.$get = ["$rootScope", "$browser", "$q", "$$q", "$exceptionHandler", function (a, b, d, c, e) {
      function f(f, h, l) {
        B(f) || (l = h, h = f, f = E);
        var m = Ha.call(arguments, 3),
            p = w(l) && !l,
            n = (p ? c : d).defer(),
            s = n.promise,
            r;
        r = b.defer(function () {
          try {
            n.resolve(f.apply(null, m));
          } catch (b) {
            n.reject(b), e(b);
          } finally {
            delete g[s.$$timeoutId];
          }

          p || a.$apply();
        }, h, "$timeout");
        s.$$timeoutId = r;
        g[r] = n;
        return s;
      }

      var g = {};

      f.cancel = function (a) {
        if (!a) return !1;
        if (!a.hasOwnProperty("$$timeoutId")) throw Vg("badprom");
        if (!g.hasOwnProperty(a.$$timeoutId)) return !1;
        a = a.$$timeoutId;
        var c = g[a],
            d = c.promise;
        d.$$state && (d.$$state.pur = !0);
        c.reject("canceled");
        delete g[a];
        return b.defer.cancel(a);
      };

      return f;
    }];
  }

  function ga(a) {
    if (!A(a)) return a;
    Ca && (aa.setAttribute("href", a), a = aa.href);
    aa.setAttribute("href", a);
    a = aa.hostname;
    !Wg && -1 < a.indexOf(":") && (a = "[" + a + "]");
    return {
      href: aa.href,
      protocol: aa.protocol ? aa.protocol.replace(/:$/, "") : "",
      host: aa.host,
      search: aa.search ? aa.search.replace(/^\?/, "") : "",
      hash: aa.hash ? aa.hash.replace(/^#/, "") : "",
      hostname: a,
      port: aa.port,
      pathname: "/" === aa.pathname.charAt(0) ? aa.pathname : "/" + aa.pathname
    };
  }

  function Jg(a) {
    var b = [Od].concat(a.map(ga));
    return function (a) {
      a = ga(a);
      return b.some(Bc.bind(null, a));
    };
  }

  function Bc(a, b) {
    a = ga(a);
    b = ga(b);
    return a.protocol === b.protocol && a.host === b.host;
  }

  function gg() {
    this.$get = ia(C);
  }

  function Pd(a) {
    function b(a) {
      try {
        return decodeURIComponent(a);
      } catch (b) {
        return a;
      }
    }

    var d = a[0] || {},
        c = {},
        e = "";
    return function () {
      var a, g, k, h, l;

      try {
        a = d.cookie || "";
      } catch (m) {
        a = "";
      }

      if (a !== e) for (e = a, a = e.split("; "), c = {}, k = 0; k < a.length; k++) {
        g = a[k], h = g.indexOf("="), 0 < h && (l = b(g.substring(0, h)), z(c[l]) && (c[l] = b(g.substring(h + 1))));
      }
      return c;
    };
  }

  function kg() {
    this.$get = Pd;
  }

  function dd(a) {
    function b(d, c) {
      if (D(d)) {
        var e = {};
        r(d, function (a, c) {
          e[c] = b(c, a);
        });
        return e;
      }

      return a.factory(d + "Filter", c);
    }

    this.register = b;
    this.$get = ["$injector", function (a) {
      return function (b) {
        return a.get(b + "Filter");
      };
    }];
    b("currency", Qd);
    b("date", Rd);
    b("filter", Xg);
    b("json", Yg);
    b("limitTo", Zg);
    b("lowercase", $g);
    b("number", Sd);
    b("orderBy", Td);
    b("uppercase", ah);
  }

  function Xg() {
    return function (a, b, d, c) {
      if (!ya(a)) {
        if (null == a) return a;
        throw F("filter")("notarray", a);
      }

      c = c || "$";
      var e;

      switch (Dc(b)) {
        case "function":
          break;

        case "boolean":
        case "null":
        case "number":
        case "string":
          e = !0;

        case "object":
          b = bh(b, d, c, e);
          break;

        default:
          return a;
      }

      return Array.prototype.filter.call(a, b);
    };
  }

  function bh(a, b, d, c) {
    var e = D(a) && d in a;
    !0 === b ? b = va : B(b) || (b = function b(a, _b) {
      if (z(a)) return !1;
      if (null === a || null === _b) return a === _b;
      if (D(_b) || D(a) && !bc(a)) return !1;
      a = K("" + a);
      _b = K("" + _b);
      return -1 !== a.indexOf(_b);
    });
    return function (f) {
      return e && !D(f) ? Fa(f, a[d], b, d, !1) : Fa(f, a, b, d, c);
    };
  }

  function Fa(a, b, d, c, e, f) {
    var g = Dc(a),
        k = Dc(b);
    if ("string" === k && "!" === b.charAt(0)) return !Fa(a, b.substring(1), d, c, e);
    if (H(a)) return a.some(function (a) {
      return Fa(a, b, d, c, e);
    });

    switch (g) {
      case "object":
        var h;

        if (e) {
          for (h in a) {
            if (h.charAt && "$" !== h.charAt(0) && Fa(a[h], b, d, c, !0)) return !0;
          }

          return f ? !1 : Fa(a, b, d, c, !1);
        }

        if ("object" === k) {
          for (h in b) {
            if (f = b[h], !B(f) && !z(f) && (g = h === c, !Fa(g ? a : a[h], f, d, c, g, g))) return !1;
          }

          return !0;
        }

        return d(a, b);

      case "function":
        return !1;

      default:
        return d(a, b);
    }
  }

  function Dc(a) {
    return null === a ? "null" : _typeof(a);
  }

  function Qd(a) {
    var b = a.NUMBER_FORMATS;
    return function (a, c, e) {
      z(c) && (c = b.CURRENCY_SYM);
      z(e) && (e = b.PATTERNS[1].maxFrac);
      var f = c ? /\u00A4/g : /\s*\u00A4\s*/g;
      return null == a ? a : Ud(a, b.PATTERNS[1], b.GROUP_SEP, b.DECIMAL_SEP, e).replace(f, c);
    };
  }

  function Sd(a) {
    var b = a.NUMBER_FORMATS;
    return function (a, c) {
      return null == a ? a : Ud(a, b.PATTERNS[0], b.GROUP_SEP, b.DECIMAL_SEP, c);
    };
  }

  function ch(a) {
    var b = 0,
        d,
        c,
        e,
        f,
        g;
    -1 < (c = a.indexOf(Vd)) && (a = a.replace(Vd, ""));
    0 < (e = a.search(/e/i)) ? (0 > c && (c = e), c += +a.slice(e + 1), a = a.substring(0, e)) : 0 > c && (c = a.length);

    for (e = 0; a.charAt(e) === Ec; e++) {
      ;
    }

    if (e === (g = a.length)) d = [0], c = 1;else {
      for (g--; a.charAt(g) === Ec;) {
        g--;
      }

      c -= e;
      d = [];

      for (f = 0; e <= g; e++, f++) {
        d[f] = +a.charAt(e);
      }
    }
    c > Wd && (d = d.splice(0, Wd - 1), b = c - 1, c = 1);
    return {
      d: d,
      e: b,
      i: c
    };
  }

  function dh(a, b, d, c) {
    var e = a.d,
        f = e.length - a.i;
    b = z(b) ? Math.min(Math.max(d, f), c) : +b;
    d = b + a.i;
    c = e[d];

    if (0 < d) {
      e.splice(Math.max(a.i, d));

      for (var g = d; g < e.length; g++) {
        e[g] = 0;
      }
    } else for (f = Math.max(0, f), a.i = 1, e.length = Math.max(1, d = b + 1), e[0] = 0, g = 1; g < d; g++) {
      e[g] = 0;
    }

    if (5 <= c) if (0 > d - 1) {
      for (c = 0; c > d; c--) {
        e.unshift(0), a.i++;
      }

      e.unshift(1);
      a.i++;
    } else e[d - 1]++;

    for (; f < Math.max(0, b); f++) {
      e.push(0);
    }

    if (b = e.reduceRight(function (a, b, c, d) {
      b += a;
      d[c] = b % 10;
      return Math.floor(b / 10);
    }, 0)) e.unshift(b), a.i++;
  }

  function Ud(a, b, d, c, e) {
    if (!A(a) && !W(a) || isNaN(a)) return "";
    var f = !isFinite(a),
        g = !1,
        k = Math.abs(a) + "",
        h = "";
    if (f) h = "\u221E";else {
      g = ch(k);
      dh(g, e, b.minFrac, b.maxFrac);
      h = g.d;
      k = g.i;
      e = g.e;
      f = [];

      for (g = h.reduce(function (a, b) {
        return a && !b;
      }, !0); 0 > k;) {
        h.unshift(0), k++;
      }

      0 < k ? f = h.splice(k, h.length) : (f = h, h = [0]);
      k = [];

      for (h.length >= b.lgSize && k.unshift(h.splice(-b.lgSize, h.length).join("")); h.length > b.gSize;) {
        k.unshift(h.splice(-b.gSize, h.length).join(""));
      }

      h.length && k.unshift(h.join(""));
      h = k.join(d);
      f.length && (h += c + f.join(""));
      e && (h += "e+" + e);
    }
    return 0 > a && !g ? b.negPre + h + b.negSuf : b.posPre + h + b.posSuf;
  }

  function Ob(a, b, d, c) {
    var e = "";
    if (0 > a || c && 0 >= a) c ? a = -a + 1 : (a = -a, e = "-");

    for (a = "" + a; a.length < b;) {
      a = Ec + a;
    }

    d && (a = a.substr(a.length - b));
    return e + a;
  }

  function ea(a, b, d, c, e) {
    d = d || 0;
    return function (f) {
      f = f["get" + a]();
      if (0 < d || f > -d) f += d;
      0 === f && -12 === d && (f = 12);
      return Ob(f, b, c, e);
    };
  }

  function kb(a, b, d) {
    return function (c, e) {
      var f = c["get" + a](),
          g = ub((d ? "STANDALONE" : "") + (b ? "SHORT" : "") + a);
      return e[g][f];
    };
  }

  function Xd(a) {
    var b = new Date(a, 0, 1).getDay();
    return new Date(a, 0, (4 >= b ? 5 : 12) - b);
  }

  function Yd(a) {
    return function (b) {
      var d = Xd(b.getFullYear());
      b = +new Date(b.getFullYear(), b.getMonth(), b.getDate() + (4 - b.getDay())) - +d;
      b = 1 + Math.round(b / 6048E5);
      return Ob(b, a);
    };
  }

  function Fc(a, b) {
    return 0 >= a.getFullYear() ? b.ERAS[0] : b.ERAS[1];
  }

  function Rd(a) {
    function b(a) {
      var b;

      if (b = a.match(d)) {
        a = new Date(0);
        var f = 0,
            g = 0,
            k = b[8] ? a.setUTCFullYear : a.setFullYear,
            h = b[8] ? a.setUTCHours : a.setHours;
        b[9] && (f = fa(b[9] + b[10]), g = fa(b[9] + b[11]));
        k.call(a, fa(b[1]), fa(b[2]) - 1, fa(b[3]));
        f = fa(b[4] || 0) - f;
        g = fa(b[5] || 0) - g;
        k = fa(b[6] || 0);
        b = Math.round(1E3 * parseFloat("0." + (b[7] || 0)));
        h.call(a, f, g, k, b);
      }

      return a;
    }

    var d = /^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
    return function (c, d, f) {
      var g = "",
          k = [],
          h,
          l;
      d = d || "mediumDate";
      d = a.DATETIME_FORMATS[d] || d;
      A(c) && (c = eh.test(c) ? fa(c) : b(c));
      W(c) && (c = new Date(c));
      if (!ha(c) || !isFinite(c.getTime())) return c;

      for (; d;) {
        (l = fh.exec(d)) ? (k = db(k, l, 1), d = k.pop()) : (k.push(d), d = null);
      }

      var m = c.getTimezoneOffset();
      f && (m = ec(f, m), c = fc(c, f, !0));
      r(k, function (b) {
        h = gh[b];
        g += h ? h(c, a.DATETIME_FORMATS, m) : "''" === b ? "'" : b.replace(/(^'|'$)/g, "").replace(/''/g, "'");
      });
      return g;
    };
  }

  function Yg() {
    return function (a, b) {
      z(b) && (b = 2);
      return eb(a, b);
    };
  }

  function Zg() {
    return function (a, b, d) {
      b = Infinity === Math.abs(Number(b)) ? Number(b) : fa(b);
      if (X(b)) return a;
      W(a) && (a = a.toString());
      if (!ya(a)) return a;
      d = !d || isNaN(d) ? 0 : fa(d);
      d = 0 > d ? Math.max(0, a.length + d) : d;
      return 0 <= b ? Gc(a, d, d + b) : 0 === d ? Gc(a, b, a.length) : Gc(a, Math.max(0, d + b), d);
    };
  }

  function Gc(a, b, d) {
    return A(a) ? a.slice(b, d) : Ha.call(a, b, d);
  }

  function Td(a) {
    function b(b) {
      return b.map(function (b) {
        var c = 1,
            d = Ta;
        if (B(b)) d = b;else if (A(b)) {
          if ("+" === b.charAt(0) || "-" === b.charAt(0)) c = "-" === b.charAt(0) ? -1 : 1, b = b.substring(1);
          if ("" !== b && (d = a(b), d.constant)) var e = d(),
              d = function d(a) {
            return a[e];
          };
        }
        return {
          get: d,
          descending: c
        };
      });
    }

    function d(a) {
      switch (_typeof(a)) {
        case "number":
        case "boolean":
        case "string":
          return !0;

        default:
          return !1;
      }
    }

    function c(a, b) {
      var c = 0,
          d = a.type,
          h = b.type;

      if (d === h) {
        var h = a.value,
            l = b.value;
        "string" === d ? (h = h.toLowerCase(), l = l.toLowerCase()) : "object" === d && (D(h) && (h = a.index), D(l) && (l = b.index));
        h !== l && (c = h < l ? -1 : 1);
      } else c = "undefined" === d ? 1 : "undefined" === h ? -1 : "null" === d ? 1 : "null" === h ? -1 : d < h ? -1 : 1;

      return c;
    }

    return function (a, f, g, k) {
      if (null == a) return a;
      if (!ya(a)) throw F("orderBy")("notarray", a);
      H(f) || (f = [f]);
      0 === f.length && (f = ["+"]);
      var h = b(f),
          l = g ? -1 : 1,
          m = B(k) ? k : c;
      a = Array.prototype.map.call(a, function (a, b) {
        return {
          value: a,
          tieBreaker: {
            value: b,
            type: "number",
            index: b
          },
          predicateValues: h.map(function (c) {
            var e = c.get(a);
            c = _typeof(e);
            if (null === e) c = "null";else if ("object" === c) a: {
              if (B(e.valueOf) && (e = e.valueOf(), d(e))) break a;
              bc(e) && (e = e.toString(), d(e));
            }
            return {
              value: e,
              type: c,
              index: b
            };
          })
        };
      });
      a.sort(function (a, b) {
        for (var d = 0, e = h.length; d < e; d++) {
          var f = m(a.predicateValues[d], b.predicateValues[d]);
          if (f) return f * h[d].descending * l;
        }

        return (m(a.tieBreaker, b.tieBreaker) || c(a.tieBreaker, b.tieBreaker)) * l;
      });
      return a = a.map(function (a) {
        return a.value;
      });
    };
  }

  function Ra(a) {
    B(a) && (a = {
      link: a
    });
    a.restrict = a.restrict || "AC";
    return ia(a);
  }

  function Pb(a, b, d, c, e) {
    this.$$controls = [];
    this.$error = {};
    this.$$success = {};
    this.$pending = void 0;
    this.$name = e(b.name || b.ngForm || "")(d);
    this.$dirty = !1;
    this.$valid = this.$pristine = !0;
    this.$submitted = this.$invalid = !1;
    this.$$parentForm = lb;
    this.$$element = a;
    this.$$animate = c;
    Zd(this);
  }

  function Zd(a) {
    a.$$classCache = {};
    a.$$classCache[$d] = !(a.$$classCache[mb] = a.$$element.hasClass(mb));
  }

  function ae(a) {
    function b(a, b, c) {
      c && !a.$$classCache[b] ? (a.$$animate.addClass(a.$$element, b), a.$$classCache[b] = !0) : !c && a.$$classCache[b] && (a.$$animate.removeClass(a.$$element, b), a.$$classCache[b] = !1);
    }

    function d(a, c, d) {
      c = c ? "-" + Vc(c, "-") : "";
      b(a, mb + c, !0 === d);
      b(a, $d + c, !1 === d);
    }

    var c = a.set,
        e = a.unset;

    a.clazz.prototype.$setValidity = function (a, g, k) {
      z(g) ? (this.$pending || (this.$pending = {}), c(this.$pending, a, k)) : (this.$pending && e(this.$pending, a, k), be(this.$pending) && (this.$pending = void 0));
      Ga(g) ? g ? (e(this.$error, a, k), c(this.$$success, a, k)) : (c(this.$error, a, k), e(this.$$success, a, k)) : (e(this.$error, a, k), e(this.$$success, a, k));
      this.$pending ? (b(this, "ng-pending", !0), this.$valid = this.$invalid = void 0, d(this, "", null)) : (b(this, "ng-pending", !1), this.$valid = be(this.$error), this.$invalid = !this.$valid, d(this, "", this.$valid));
      g = this.$pending && this.$pending[a] ? void 0 : this.$error[a] ? !1 : this.$$success[a] ? !0 : null;
      d(this, a, g);
      this.$$parentForm.$setValidity(a, g, this);
    };
  }

  function be(a) {
    if (a) for (var b in a) {
      if (a.hasOwnProperty(b)) return !1;
    }
    return !0;
  }

  function Hc(a) {
    a.$formatters.push(function (b) {
      return a.$isEmpty(b) ? b : b.toString();
    });
  }

  function Sa(a, b, d, c, e, f) {
    var g = K(b[0].type);

    if (!e.android) {
      var k = !1;
      b.on("compositionstart", function () {
        k = !0;
      });
      b.on("compositionupdate", function (a) {
        if (z(a.data) || "" === a.data) k = !1;
      });
      b.on("compositionend", function () {
        k = !1;
        l();
      });
    }

    var h,
        l = function l(a) {
      h && (f.defer.cancel(h), h = null);

      if (!k) {
        var e = b.val();
        a = a && a.type;
        "password" === g || d.ngTrim && "false" === d.ngTrim || (e = U(e));
        (c.$viewValue !== e || "" === e && c.$$hasNativeValidators) && c.$setViewValue(e, a);
      }
    };

    if (e.hasEvent("input")) b.on("input", l);else {
      var m = function m(a, b, c) {
        h || (h = f.defer(function () {
          h = null;
          b && b.value === c || l(a);
        }));
      };

      b.on("keydown", function (a) {
        var b = a.keyCode;
        91 === b || 15 < b && 19 > b || 37 <= b && 40 >= b || m(a, this, this.value);
      });
      if (e.hasEvent("paste")) b.on("paste cut drop", m);
    }
    b.on("change", l);
    if (ce[g] && c.$$hasNativeValidators && g === d.type) b.on("keydown wheel mousedown", function (a) {
      if (!h) {
        var b = this.validity,
            c = b.badInput,
            d = b.typeMismatch;
        h = f.defer(function () {
          h = null;
          b.badInput === c && b.typeMismatch === d || l(a);
        });
      }
    });

    c.$render = function () {
      var a = c.$isEmpty(c.$viewValue) ? "" : c.$viewValue;
      b.val() !== a && b.val(a);
    };
  }

  function Qb(a, b) {
    return function (d, c) {
      var e, f;
      if (ha(d)) return d;

      if (A(d)) {
        '"' === d.charAt(0) && '"' === d.charAt(d.length - 1) && (d = d.substring(1, d.length - 1));
        if (hh.test(d)) return new Date(d);
        a.lastIndex = 0;
        if (e = a.exec(d)) return e.shift(), f = c ? {
          yyyy: c.getFullYear(),
          MM: c.getMonth() + 1,
          dd: c.getDate(),
          HH: c.getHours(),
          mm: c.getMinutes(),
          ss: c.getSeconds(),
          sss: c.getMilliseconds() / 1E3
        } : {
          yyyy: 1970,
          MM: 1,
          dd: 1,
          HH: 0,
          mm: 0,
          ss: 0,
          sss: 0
        }, r(e, function (a, c) {
          c < b.length && (f[b[c]] = +a);
        }), e = new Date(f.yyyy, f.MM - 1, f.dd, f.HH, f.mm, f.ss || 0, 1E3 * f.sss || 0), 100 > f.yyyy && e.setFullYear(f.yyyy), e;
      }

      return NaN;
    };
  }

  function nb(a, b, d, c) {
    return function (e, f, g, k, h, l, m, p) {
      function n(a) {
        return a && !(a.getTime && a.getTime() !== a.getTime());
      }

      function s(a) {
        return w(a) && !ha(a) ? r(a) || void 0 : a;
      }

      function r(a, b) {
        var c = k.$options.getOption("timezone");
        v && v !== c && (b = Sc(b, ec(v)));
        var e = d(a, b);
        !isNaN(e) && c && (e = fc(e, c));
        return e;
      }

      Ic(e, f, g, k, a);
      Sa(e, f, g, k, h, l);
      var t = "time" === a || "datetimelocal" === a,
          q,
          v;
      k.$parsers.push(function (c) {
        if (k.$isEmpty(c)) return null;
        if (b.test(c)) return r(c, q);
        k.$$parserName = a;
      });
      k.$formatters.push(function (a) {
        if (a && !ha(a)) throw ob("datefmt", a);

        if (n(a)) {
          q = a;
          var b = k.$options.getOption("timezone");
          b && (v = b, q = fc(q, b, !0));
          var d = c;
          t && A(k.$options.getOption("timeSecondsFormat")) && (d = c.replace("ss.sss", k.$options.getOption("timeSecondsFormat")).replace(/:$/, ""));
          a = m("date")(a, d, b);
          t && k.$options.getOption("timeStripZeroSeconds") && (a = a.replace(/(?::00)?(?:\.000)?$/, ""));
          return a;
        }

        v = q = null;
        return "";
      });

      if (w(g.min) || g.ngMin) {
        var x = g.min || p(g.ngMin)(e),
            B = s(x);

        k.$validators.min = function (a) {
          return !n(a) || z(B) || d(a) >= B;
        };

        g.$observe("min", function (a) {
          a !== x && (B = s(a), x = a, k.$validate());
        });
      }

      if (w(g.max) || g.ngMax) {
        var y = g.max || p(g.ngMax)(e),
            J = s(y);

        k.$validators.max = function (a) {
          return !n(a) || z(J) || d(a) <= J;
        };

        g.$observe("max", function (a) {
          a !== y && (J = s(a), y = a, k.$validate());
        });
      }
    };
  }

  function Ic(a, b, d, c, e) {
    (c.$$hasNativeValidators = D(b[0].validity)) && c.$parsers.push(function (a) {
      var d = b.prop("validity") || {};
      if (d.badInput || d.typeMismatch) c.$$parserName = e;else return a;
    });
  }

  function de(a) {
    a.$parsers.push(function (b) {
      if (a.$isEmpty(b)) return null;
      if (ih.test(b)) return parseFloat(b);
      a.$$parserName = "number";
    });
    a.$formatters.push(function (b) {
      if (!a.$isEmpty(b)) {
        if (!W(b)) throw ob("numfmt", b);
        b = b.toString();
      }

      return b;
    });
  }

  function na(a) {
    w(a) && !W(a) && (a = parseFloat(a));
    return X(a) ? void 0 : a;
  }

  function Jc(a) {
    var b = a.toString(),
        d = b.indexOf(".");
    return -1 === d ? -1 < a && 1 > a && (a = /e-(\d+)$/.exec(b)) ? Number(a[1]) : 0 : b.length - d - 1;
  }

  function ee(a, b, d) {
    a = Number(a);
    var c = (a | 0) !== a,
        e = (b | 0) !== b,
        f = (d | 0) !== d;

    if (c || e || f) {
      var g = c ? Jc(a) : 0,
          k = e ? Jc(b) : 0,
          h = f ? Jc(d) : 0,
          g = Math.max(g, k, h),
          g = Math.pow(10, g);
      a *= g;
      b *= g;
      d *= g;
      c && (a = Math.round(a));
      e && (b = Math.round(b));
      f && (d = Math.round(d));
    }

    return 0 === (a - b) % d;
  }

  function fe(a, b, d, c, e) {
    if (w(c)) {
      a = a(c);
      if (!a.constant) throw ob("constexpr", d, c);
      return a(b);
    }

    return e;
  }

  function Kc(a, b) {
    function d(a, b) {
      if (!a || !a.length) return [];
      if (!b || !b.length) return a;
      var c = [],
          d = 0;

      a: for (; d < a.length; d++) {
        for (var e = a[d], m = 0; m < b.length; m++) {
          if (e === b[m]) continue a;
        }

        c.push(e);
      }

      return c;
    }

    function c(a) {
      if (!a) return a;
      var b = a;
      H(a) ? b = a.map(c).join(" ") : D(a) ? b = Object.keys(a).filter(function (b) {
        return a[b];
      }).join(" ") : A(a) || (b = a + "");
      return b;
    }

    a = "ngClass" + a;
    var e;
    return ["$parse", function (f) {
      return {
        restrict: "AC",
        link: function link(g, k, h) {
          function l(a, b) {
            var c = [];
            r(a, function (a) {
              if (0 < b || p[a]) p[a] = (p[a] || 0) + b, p[a] === +(0 < b) && c.push(a);
            });
            return c.join(" ");
          }

          function m(a) {
            if (a === b) {
              var c = s,
                  c = l(c && c.split(" "), 1);
              h.$addClass(c);
            } else c = s, c = l(c && c.split(" "), -1), h.$removeClass(c);

            n = a;
          }

          var p = k.data("$classCounts"),
              n = !0,
              s;
          p || (p = T(), k.data("$classCounts", p));
          "ngClass" !== a && (e || (e = f("$index", function (a) {
            return a & 1;
          })), g.$watch(e, m));
          g.$watch(f(h[a], c), function (a) {
            if (n === b) {
              var c = s && s.split(" "),
                  e = a && a.split(" "),
                  f = d(c, e),
                  c = d(e, c),
                  f = l(f, -1),
                  c = l(c, 1);
              h.$addClass(c);
              h.$removeClass(f);
            }

            s = a;
          });
        }
      };
    }];
  }

  function qd(a, b, d, c, e, f) {
    return {
      restrict: "A",
      compile: function compile(g, k) {
        var h = a(k[c]);
        return function (a, c) {
          c.on(e, function (c) {
            var e = function e() {
              h(a, {
                $event: c
              });
            };

            if (b.$$phase) {
              if (f) a.$evalAsync(e);else try {
                e();
              } catch (g) {
                d(g);
              }
            } else a.$apply(e);
          });
        };
      }
    };
  }

  function Rb(a, b, d, c, e, f, g, k, h) {
    this.$modelValue = this.$viewValue = Number.NaN;
    this.$$rawModelValue = void 0;
    this.$validators = {};
    this.$asyncValidators = {};
    this.$parsers = [];
    this.$formatters = [];
    this.$viewChangeListeners = [];
    this.$untouched = !0;
    this.$touched = !1;
    this.$pristine = !0;
    this.$dirty = !1;
    this.$valid = !0;
    this.$invalid = !1;
    this.$error = {};
    this.$$success = {};
    this.$pending = void 0;
    this.$name = h(d.name || "", !1)(a);
    this.$$parentForm = lb;
    this.$options = Sb;
    this.$$updateEvents = "";
    this.$$updateEventHandler = this.$$updateEventHandler.bind(this);
    this.$$parsedNgModel = e(d.ngModel);
    this.$$parsedNgModelAssign = this.$$parsedNgModel.assign;
    this.$$ngModelGet = this.$$parsedNgModel;
    this.$$ngModelSet = this.$$parsedNgModelAssign;
    this.$$pendingDebounce = null;
    this.$$parserValid = void 0;
    this.$$parserName = "parse";
    this.$$currentValidationRunId = 0;
    this.$$scope = a;
    this.$$rootScope = a.$root;
    this.$$attr = d;
    this.$$element = c;
    this.$$animate = f;
    this.$$timeout = g;
    this.$$parse = e;
    this.$$q = k;
    this.$$exceptionHandler = b;
    Zd(this);
    jh(this);
  }

  function jh(a) {
    a.$$scope.$watch(function (b) {
      b = a.$$ngModelGet(b);
      b === a.$modelValue || a.$modelValue !== a.$modelValue && b !== b || a.$$setModelValue(b);
      return b;
    });
  }

  function Lc(a) {
    this.$$options = a;
  }

  function ge(a, b) {
    r(b, function (b, c) {
      w(a[c]) || (a[c] = b);
    });
  }

  function Oa(a, b) {
    a.prop("selected", b);
    a.attr("selected", b);
  }

  function he(a, b, d) {
    if (a) {
      A(a) && (a = new RegExp("^" + a + "$"));
      if (!a.test) throw F("ngPattern")("noregexp", b, a, za(d));
      return a;
    }
  }

  function Tb(a) {
    a = fa(a);
    return X(a) ? -1 : a;
  }

  var Wb = {
    objectMaxDepth: 5,
    urlErrorParamsEnabled: !0
  },
      ie = /^\/(.+)\/([a-z]*)$/,
      ta = Object.prototype.hasOwnProperty,
      K = function K(a) {
    return A(a) ? a.toLowerCase() : a;
  },
      ub = function ub(a) {
    return A(a) ? a.toUpperCase() : a;
  },
      Ca,
      x,
      rb,
      Ha = [].slice,
      Fg = [].splice,
      kh = [].push,
      la = Object.prototype.toString,
      Pc = Object.getPrototypeOf,
      pa = F("ng"),
      ca = C.angular || (C.angular = {}),
      kc,
      pb = 0;

  Ca = C.document.documentMode;

  var X = Number.isNaN || function (a) {
    return a !== a;
  };

  E.$inject = [];
  Ta.$inject = [];

  var ve = /^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,
      U = function U(a) {
    return A(a) ? a.trim() : a;
  },
      Md = function Md(a) {
    return a.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g, "\\$1").replace(/\x08/g, "\\x08");
  },
      Aa = function Aa() {
    if (!w(Aa.rules)) {
      var a = C.document.querySelector("[ng-csp]") || C.document.querySelector("[data-ng-csp]");

      if (a) {
        var b = a.getAttribute("ng-csp") || a.getAttribute("data-ng-csp");
        Aa.rules = {
          noUnsafeEval: !b || -1 !== b.indexOf("no-unsafe-eval"),
          noInlineStyle: !b || -1 !== b.indexOf("no-inline-style")
        };
      } else {
        a = Aa;

        try {
          new Function(""), b = !1;
        } catch (d) {
          b = !0;
        }

        a.rules = {
          noUnsafeEval: b,
          noInlineStyle: !1
        };
      }
    }

    return Aa.rules;
  },
      qb = function qb() {
    if (w(qb.name_)) return qb.name_;
    var a,
        b,
        d = Qa.length,
        c,
        e;

    for (b = 0; b < d; ++b) {
      if (c = Qa[b], a = C.document.querySelector("[" + c.replace(":", "\\:") + "jq]")) {
        e = a.getAttribute(c + "jq");
        break;
      }
    }

    return qb.name_ = e;
  },
      xe = /:/g,
      Qa = ["ng-", "data-ng-", "ng:", "x-ng-"],
      Be = function (a) {
    var b = a.currentScript;
    if (!b) return !0;
    if (!(b instanceof C.HTMLScriptElement || b instanceof C.SVGScriptElement)) return !1;
    b = b.attributes;
    return [b.getNamedItem("src"), b.getNamedItem("href"), b.getNamedItem("xlink:href")].every(function (b) {
      if (!b) return !0;
      if (!b.value) return !1;
      var c = a.createElement("a");
      c.href = b.value;
      if (a.location.origin === c.origin) return !0;

      switch (c.protocol) {
        case "http:":
        case "https:":
        case "ftp:":
        case "blob:":
        case "file:":
        case "data:":
          return !0;

        default:
          return !1;
      }
    });
  }(C.document),
      Ee = /[A-Z]/g,
      Wc = !1,
      Pa = 3,
      Ke = {
    full: "1.7.9",
    major: 1,
    minor: 7,
    dot: 9,
    codeName: "pollution-eradication"
  };

  Y.expando = "ng339";
  var Ka = Y.cache = {},
      pg = 1;

  Y._data = function (a) {
    return this.cache[a[this.expando]] || {};
  };

  var lg = /-([a-z])/g,
      lh = /^-ms-/,
      Ab = {
    mouseleave: "mouseout",
    mouseenter: "mouseover"
  },
      nc = F("jqLite"),
      og = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
      mc = /<|&#?\w+;/,
      mg = /<([\w:-]+)/,
      ng = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,
      oa = {
    option: [1, '<select multiple="multiple">', "</select>"],
    thead: [1, "<table>", "</table>"],
    col: [2, "<table><colgroup>", "</colgroup></table>"],
    tr: [2, "<table><tbody>", "</tbody></table>"],
    td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
    _default: [0, "", ""]
  };
  oa.optgroup = oa.option;
  oa.tbody = oa.tfoot = oa.colgroup = oa.caption = oa.thead;
  oa.th = oa.td;

  var ug = C.Node.prototype.contains || function (a) {
    return !!(this.compareDocumentPosition(a) & 16);
  },
      Wa = Y.prototype = {
    ready: fd,
    toString: function toString() {
      var a = [];
      r(this, function (b) {
        a.push("" + b);
      });
      return "[" + a.join(", ") + "]";
    },
    eq: function eq(a) {
      return 0 <= a ? x(this[a]) : x(this[this.length + a]);
    },
    length: 0,
    push: kh,
    sort: [].sort,
    splice: [].splice
  },
      Gb = {};

  r("multiple selected checked disabled readOnly required open".split(" "), function (a) {
    Gb[K(a)] = a;
  });
  var md = {};
  r("input select option textarea button form details".split(" "), function (a) {
    md[a] = !0;
  });
  var td = {
    ngMinlength: "minlength",
    ngMaxlength: "maxlength",
    ngMin: "min",
    ngMax: "max",
    ngPattern: "pattern",
    ngStep: "step"
  };
  r({
    data: rc,
    removeData: qc,
    hasData: function hasData(a) {
      for (var b in Ka[a.ng339]) {
        return !0;
      }

      return !1;
    },
    cleanData: function cleanData(a) {
      for (var b = 0, d = a.length; b < d; b++) {
        qc(a[b]), id(a[b]);
      }
    }
  }, function (a, b) {
    Y[b] = a;
  });
  r({
    data: rc,
    inheritedData: Eb,
    scope: function scope(a) {
      return x.data(a, "$scope") || Eb(a.parentNode || a, ["$isolateScope", "$scope"]);
    },
    isolateScope: function isolateScope(a) {
      return x.data(a, "$isolateScope") || x.data(a, "$isolateScopeNoTemplate");
    },
    controller: jd,
    injector: function injector(a) {
      return Eb(a, "$injector");
    },
    removeAttr: function removeAttr(a, b) {
      a.removeAttribute(b);
    },
    hasClass: Bb,
    css: function css(a, b, d) {
      b = xb(b.replace(lh, "ms-"));
      if (w(d)) a.style[b] = d;else return a.style[b];
    },
    attr: function attr(a, b, d) {
      var c = a.nodeType;

      if (c !== Pa && 2 !== c && 8 !== c && a.getAttribute) {
        var c = K(b),
            e = Gb[c];
        if (w(d)) null === d || !1 === d && e ? a.removeAttribute(b) : a.setAttribute(b, e ? c : d);else return a = a.getAttribute(b), e && null !== a && (a = c), null === a ? void 0 : a;
      }
    },
    prop: function prop(a, b, d) {
      if (w(d)) a[b] = d;else return a[b];
    },
    text: function () {
      function a(a, d) {
        if (z(d)) {
          var c = a.nodeType;
          return 1 === c || c === Pa ? a.textContent : "";
        }

        a.textContent = d;
      }

      a.$dv = "";
      return a;
    }(),
    val: function val(a, b) {
      if (z(b)) {
        if (a.multiple && "select" === ua(a)) {
          var d = [];
          r(a.options, function (a) {
            a.selected && d.push(a.value || a.text);
          });
          return d;
        }

        return a.value;
      }

      a.value = b;
    },
    html: function html(a, b) {
      if (z(b)) return a.innerHTML;
      yb(a, !0);
      a.innerHTML = b;
    },
    empty: kd
  }, function (a, b) {
    Y.prototype[b] = function (b, c) {
      var e,
          f,
          g = this.length;

      if (a !== kd && z(2 === a.length && a !== Bb && a !== jd ? b : c)) {
        if (D(b)) {
          for (e = 0; e < g; e++) {
            if (a === rc) a(this[e], b);else for (f in b) {
              a(this[e], f, b[f]);
            }
          }

          return this;
        }

        e = a.$dv;
        g = z(e) ? Math.min(g, 1) : g;

        for (f = 0; f < g; f++) {
          var k = a(this[f], b, c);
          e = e ? e + k : k;
        }

        return e;
      }

      for (e = 0; e < g; e++) {
        a(this[e], b, c);
      }

      return this;
    };
  });
  r({
    removeData: qc,
    on: function on(a, b, d, c) {
      if (w(c)) throw nc("onargs");

      if (lc(a)) {
        c = zb(a, !0);
        var e = c.events,
            f = c.handle;
        f || (f = c.handle = rg(a, e));
        c = 0 <= b.indexOf(" ") ? b.split(" ") : [b];

        for (var g = c.length, k = function k(b, c, g) {
          var k = e[b];
          k || (k = e[b] = [], k.specialHandlerWrapper = c, "$destroy" === b || g || a.addEventListener(b, f));
          k.push(d);
        }; g--;) {
          b = c[g], Ab[b] ? (k(Ab[b], tg), k(b, void 0, !0)) : k(b);
        }
      }
    },
    off: id,
    one: function one(a, b, d) {
      a = x(a);
      a.on(b, function e() {
        a.off(b, d);
        a.off(b, e);
      });
      a.on(b, d);
    },
    replaceWith: function replaceWith(a, b) {
      var d,
          c = a.parentNode;
      yb(a);
      r(new Y(b), function (b) {
        d ? c.insertBefore(b, d.nextSibling) : c.replaceChild(b, a);
        d = b;
      });
    },
    children: function children(a) {
      var b = [];
      r(a.childNodes, function (a) {
        1 === a.nodeType && b.push(a);
      });
      return b;
    },
    contents: function contents(a) {
      return a.contentDocument || a.childNodes || [];
    },
    append: function append(a, b) {
      var d = a.nodeType;

      if (1 === d || 11 === d) {
        b = new Y(b);

        for (var d = 0, c = b.length; d < c; d++) {
          a.appendChild(b[d]);
        }
      }
    },
    prepend: function prepend(a, b) {
      if (1 === a.nodeType) {
        var d = a.firstChild;
        r(new Y(b), function (b) {
          a.insertBefore(b, d);
        });
      }
    },
    wrap: function wrap(a, b) {
      var d = x(b).eq(0).clone()[0],
          c = a.parentNode;
      c && c.replaceChild(d, a);
      d.appendChild(a);
    },
    remove: Fb,
    detach: function detach(a) {
      Fb(a, !0);
    },
    after: function after(a, b) {
      var d = a,
          c = a.parentNode;

      if (c) {
        b = new Y(b);

        for (var e = 0, f = b.length; e < f; e++) {
          var g = b[e];
          c.insertBefore(g, d.nextSibling);
          d = g;
        }
      }
    },
    addClass: Db,
    removeClass: Cb,
    toggleClass: function toggleClass(a, b, d) {
      b && r(b.split(" "), function (b) {
        var e = d;
        z(e) && (e = !Bb(a, b));
        (e ? Db : Cb)(a, b);
      });
    },
    parent: function parent(a) {
      return (a = a.parentNode) && 11 !== a.nodeType ? a : null;
    },
    next: function next(a) {
      return a.nextElementSibling;
    },
    find: function find(a, b) {
      return a.getElementsByTagName ? a.getElementsByTagName(b) : [];
    },
    clone: pc,
    triggerHandler: function triggerHandler(a, b, d) {
      var c,
          e,
          f = b.type || b,
          g = zb(a);
      if (g = (g = g && g.events) && g[f]) c = {
        preventDefault: function preventDefault() {
          this.defaultPrevented = !0;
        },
        isDefaultPrevented: function isDefaultPrevented() {
          return !0 === this.defaultPrevented;
        },
        stopImmediatePropagation: function stopImmediatePropagation() {
          this.immediatePropagationStopped = !0;
        },
        isImmediatePropagationStopped: function isImmediatePropagationStopped() {
          return !0 === this.immediatePropagationStopped;
        },
        stopPropagation: E,
        type: f,
        target: a
      }, b.type && (c = S(c, b)), b = ja(g), e = d ? [c].concat(d) : [c], r(b, function (b) {
        c.isImmediatePropagationStopped() || b.apply(a, e);
      });
    }
  }, function (a, b) {
    Y.prototype[b] = function (b, c, e) {
      for (var f, g = 0, k = this.length; g < k; g++) {
        z(f) ? (f = a(this[g], b, c, e), w(f) && (f = x(f))) : oc(f, a(this[g], b, c, e));
      }

      return w(f) ? f : this;
    };
  });
  Y.prototype.bind = Y.prototype.on;
  Y.prototype.unbind = Y.prototype.off;
  var mh = Object.create(null);
  nd.prototype = {
    _idx: function _idx(a) {
      a !== this._lastKey && (this._lastKey = a, this._lastIndex = this._keys.indexOf(a));
      return this._lastIndex;
    },
    _transformKey: function _transformKey(a) {
      return X(a) ? mh : a;
    },
    get: function get(a) {
      a = this._transformKey(a);
      a = this._idx(a);
      if (-1 !== a) return this._values[a];
    },
    has: function has(a) {
      a = this._transformKey(a);
      return -1 !== this._idx(a);
    },
    set: function set(a, b) {
      a = this._transformKey(a);

      var d = this._idx(a);

      -1 === d && (d = this._lastIndex = this._keys.length);
      this._keys[d] = a;
      this._values[d] = b;
    },
    delete: function _delete(a) {
      a = this._transformKey(a);
      a = this._idx(a);
      if (-1 === a) return !1;

      this._keys.splice(a, 1);

      this._values.splice(a, 1);

      this._lastKey = NaN;
      this._lastIndex = -1;
      return !0;
    }
  };
  var Hb = nd,
      jg = [function () {
    this.$get = [function () {
      return Hb;
    }];
  }],
      wg = /^([^(]+?)=>/,
      xg = /^[^(]*\(\s*([^)]*)\)/m,
      nh = /,/,
      oh = /^\s*(_?)(\S+?)\1\s*$/,
      vg = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,
      Ba = F("$injector");

  fb.$$annotate = function (a, b, d) {
    var c;

    if ("function" === typeof a) {
      if (!(c = a.$inject)) {
        c = [];

        if (a.length) {
          if (b) throw A(d) && d || (d = a.name || yg(a)), Ba("strictdi", d);
          b = od(a);
          r(b[1].split(nh), function (a) {
            a.replace(oh, function (a, b, d) {
              c.push(d);
            });
          });
        }

        a.$inject = c;
      }
    } else H(a) ? (b = a.length - 1, sb(a[b], "fn"), c = a.slice(0, b)) : sb(a, "fn", !0);

    return c;
  };

  var je = F("$animate"),
      zf = function zf() {
    this.$get = E;
  },
      Af = function Af() {
    var a = new Hb(),
        b = [];
    this.$get = ["$$AnimateRunner", "$rootScope", function (d, c) {
      function e(a, b, c) {
        var d = !1;
        b && (b = A(b) ? b.split(" ") : H(b) ? b : [], r(b, function (b) {
          b && (d = !0, a[b] = c);
        }));
        return d;
      }

      function f() {
        r(b, function (b) {
          var c = a.get(b);

          if (c) {
            var d = zg(b.attr("class")),
                e = "",
                f = "";
            r(c, function (a, b) {
              a !== !!d[b] && (a ? e += (e.length ? " " : "") + b : f += (f.length ? " " : "") + b);
            });
            r(b, function (a) {
              e && Db(a, e);
              f && Cb(a, f);
            });
            a.delete(b);
          }
        });
        b.length = 0;
      }

      return {
        enabled: E,
        on: E,
        off: E,
        pin: E,
        push: function push(g, k, h, l) {
          l && l();
          h = h || {};
          h.from && g.css(h.from);
          h.to && g.css(h.to);
          if (h.addClass || h.removeClass) if (k = h.addClass, l = h.removeClass, h = a.get(g) || {}, k = e(h, k, !0), l = e(h, l, !1), k || l) a.set(g, h), b.push(g), 1 === b.length && c.$$postDigest(f);
          g = new d();
          g.complete();
          return g;
        }
      };
    }];
  },
      xf = ["$provide", function (a) {
    var b = this,
        d = null,
        c = null;
    this.$$registeredAnimations = Object.create(null);

    this.register = function (c, d) {
      if (c && "." !== c.charAt(0)) throw je("notcsel", c);
      var g = c + "-animation";
      b.$$registeredAnimations[c.substr(1)] = g;
      a.factory(g, d);
    };

    this.customFilter = function (a) {
      1 === arguments.length && (c = B(a) ? a : null);
      return c;
    };

    this.classNameFilter = function (a) {
      if (1 === arguments.length && (d = a instanceof RegExp ? a : null) && /[(\s|\/)]ng-animate[(\s|\/)]/.test(d.toString())) throw d = null, je("nongcls", "ng-animate");
      return d;
    };

    this.$get = ["$$animateQueue", function (a) {
      function b(a, c, d) {
        if (d) {
          var e;

          a: {
            for (e = 0; e < d.length; e++) {
              var f = d[e];

              if (1 === f.nodeType) {
                e = f;
                break a;
              }
            }

            e = void 0;
          }

          !e || e.parentNode || e.previousElementSibling || (d = null);
        }

        d ? d.after(a) : c.prepend(a);
      }

      return {
        on: a.on,
        off: a.off,
        pin: a.pin,
        enabled: a.enabled,
        cancel: function cancel(a) {
          a.cancel && a.cancel();
        },
        enter: function enter(c, d, h, l) {
          d = d && x(d);
          h = h && x(h);
          d = d || h.parent();
          b(c, d, h);
          return a.push(c, "enter", ra(l));
        },
        move: function move(c, d, h, l) {
          d = d && x(d);
          h = h && x(h);
          d = d || h.parent();
          b(c, d, h);
          return a.push(c, "move", ra(l));
        },
        leave: function leave(b, c) {
          return a.push(b, "leave", ra(c), function () {
            b.remove();
          });
        },
        addClass: function addClass(b, c, d) {
          d = ra(d);
          d.addClass = hb(d.addclass, c);
          return a.push(b, "addClass", d);
        },
        removeClass: function removeClass(b, c, d) {
          d = ra(d);
          d.removeClass = hb(d.removeClass, c);
          return a.push(b, "removeClass", d);
        },
        setClass: function setClass(b, c, d, f) {
          f = ra(f);
          f.addClass = hb(f.addClass, c);
          f.removeClass = hb(f.removeClass, d);
          return a.push(b, "setClass", f);
        },
        animate: function animate(b, c, d, f, m) {
          m = ra(m);
          m.from = m.from ? S(m.from, c) : c;
          m.to = m.to ? S(m.to, d) : d;
          m.tempClasses = hb(m.tempClasses, f || "ng-inline-animate");
          return a.push(b, "animate", m);
        }
      };
    }];
  }],
      Cf = function Cf() {
    this.$get = ["$$rAF", function (a) {
      function b(b) {
        d.push(b);
        1 < d.length || a(function () {
          for (var a = 0; a < d.length; a++) {
            d[a]();
          }

          d = [];
        });
      }

      var d = [];
      return function () {
        var a = !1;
        b(function () {
          a = !0;
        });
        return function (d) {
          a ? d() : b(d);
        };
      };
    }];
  },
      Bf = function Bf() {
    this.$get = ["$q", "$sniffer", "$$animateAsyncRun", "$$isDocumentHidden", "$timeout", function (a, b, d, c, e) {
      function f(a) {
        this.setHost(a);
        var b = d();
        this._doneCallbacks = [];

        this._tick = function (a) {
          c() ? e(a, 0, !1) : b(a);
        };

        this._state = 0;
      }

      f.chain = function (a, b) {
        function c() {
          if (d === a.length) b(!0);else a[d](function (a) {
            !1 === a ? b(!1) : (d++, c());
          });
        }

        var d = 0;
        c();
      };

      f.all = function (a, b) {
        function c(f) {
          e = e && f;
          ++d === a.length && b(e);
        }

        var d = 0,
            e = !0;
        r(a, function (a) {
          a.done(c);
        });
      };

      f.prototype = {
        setHost: function setHost(a) {
          this.host = a || {};
        },
        done: function done(a) {
          2 === this._state ? a() : this._doneCallbacks.push(a);
        },
        progress: E,
        getPromise: function getPromise() {
          if (!this.promise) {
            var b = this;
            this.promise = a(function (a, c) {
              b.done(function (b) {
                !1 === b ? c() : a();
              });
            });
          }

          return this.promise;
        },
        then: function then(a, b) {
          return this.getPromise().then(a, b);
        },
        "catch": function _catch(a) {
          return this.getPromise()["catch"](a);
        },
        "finally": function _finally(a) {
          return this.getPromise()["finally"](a);
        },
        pause: function pause() {
          this.host.pause && this.host.pause();
        },
        resume: function resume() {
          this.host.resume && this.host.resume();
        },
        end: function end() {
          this.host.end && this.host.end();

          this._resolve(!0);
        },
        cancel: function cancel() {
          this.host.cancel && this.host.cancel();

          this._resolve(!1);
        },
        complete: function complete(a) {
          var b = this;
          0 === b._state && (b._state = 1, b._tick(function () {
            b._resolve(a);
          }));
        },
        _resolve: function _resolve(a) {
          2 !== this._state && (r(this._doneCallbacks, function (b) {
            b(a);
          }), this._doneCallbacks.length = 0, this._state = 2);
        }
      };
      return f;
    }];
  },
      yf = function yf() {
    this.$get = ["$$rAF", "$q", "$$AnimateRunner", function (a, b, d) {
      return function (b, e) {
        function f() {
          a(function () {
            g.addClass && (b.addClass(g.addClass), g.addClass = null);
            g.removeClass && (b.removeClass(g.removeClass), g.removeClass = null);
            g.to && (b.css(g.to), g.to = null);
            k || h.complete();
            k = !0;
          });
          return h;
        }

        var g = e || {};
        g.$$prepared || (g = Ia(g));
        g.cleanupStyles && (g.from = g.to = null);
        g.from && (b.css(g.from), g.from = null);
        var k,
            h = new d();
        return {
          start: f,
          end: f
        };
      };
    }];
  },
      $ = F("$compile"),
      tc = new function () {}();

  Xc.$inject = ["$provide", "$$sanitizeUriProvider"];

  Jb.prototype.isFirstChange = function () {
    return this.previousValue === tc;
  };

  var pd = /^((?:x|data)[:\-_])/i,
      Eg = /[:\-_]+(.)/g,
      vd = F("$controller"),
      ud = /^(\S+)(\s+as\s+([\w$]+))?$/,
      Jf = function Jf() {
    this.$get = ["$document", function (a) {
      return function (b) {
        b ? !b.nodeType && b instanceof x && (b = b[0]) : b = a[0].body;
        return b.offsetWidth + 1;
      };
    }];
  },
      wd = "application/json",
      wc = {
    "Content-Type": wd + ";charset=utf-8"
  },
      Hg = /^\[|^\{(?!\{)/,
      Ig = {
    "[": /]$/,
    "{": /}$/
  },
      Gg = /^\)]\}',?\n/,
      Kb = F("$http"),
      Ma = ca.$interpolateMinErr = F("$interpolate");

  Ma.throwNoconcat = function (a) {
    throw Ma("noconcat", a);
  };

  Ma.interr = function (a, b) {
    return Ma("interr", a, b.toString());
  };

  var Lg = F("$interval"),
      Sf = function Sf() {
    this.$get = function () {
      function a(a) {
        var b = function b(a) {
          b.data = a;
          b.called = !0;
        };

        b.id = a;
        return b;
      }

      var b = ca.callbacks,
          d = {};
      return {
        createCallback: function createCallback(c) {
          c = "_" + (b.$$counter++).toString(36);
          var e = "angular.callbacks." + c,
              f = a(c);
          d[e] = b[c] = f;
          return e;
        },
        wasCalled: function wasCalled(a) {
          return d[a].called;
        },
        getResponse: function getResponse(a) {
          return d[a].data;
        },
        removeCallback: function removeCallback(a) {
          delete b[d[a].id];
          delete d[a];
        }
      };
    };
  },
      ph = /^([^?#]*)(\?([^#]*))?(#(.*))?$/,
      Mg = {
    http: 80,
    https: 443,
    ftp: 21
  },
      jb = F("$location"),
      Ng = /^\s*[\\/]{2,}/,
      qh = {
    $$absUrl: "",
    $$html5: !1,
    $$replace: !1,
    $$compose: function $$compose() {
      for (var a = this.$$path, b = this.$$hash, d = ye(this.$$search), b = b ? "#" + hc(b) : "", a = a.split("/"), c = a.length; c--;) {
        a[c] = hc(a[c].replace(/%2F/g, "/"));
      }

      this.$$url = a.join("/") + (d ? "?" + d : "") + b;
      this.$$absUrl = this.$$normalizeUrl(this.$$url);
      this.$$urlUpdatedByLocation = !0;
    },
    absUrl: Lb("$$absUrl"),
    url: function url(a) {
      if (z(a)) return this.$$url;
      var b = ph.exec(a);
      (b[1] || "" === a) && this.path(decodeURIComponent(b[1]));
      (b[2] || b[1] || "" === a) && this.search(b[3] || "");
      this.hash(b[5] || "");
      return this;
    },
    protocol: Lb("$$protocol"),
    host: Lb("$$host"),
    port: Lb("$$port"),
    path: Dd("$$path", function (a) {
      a = null !== a ? a.toString() : "";
      return "/" === a.charAt(0) ? a : "/" + a;
    }),
    search: function search(a, b) {
      switch (arguments.length) {
        case 0:
          return this.$$search;

        case 1:
          if (A(a) || W(a)) a = a.toString(), this.$$search = gc(a);else if (D(a)) a = Ia(a, {}), r(a, function (b, c) {
            null == b && delete a[c];
          }), this.$$search = a;else throw jb("isrcharg");
          break;

        default:
          z(b) || null === b ? delete this.$$search[a] : this.$$search[a] = b;
      }

      this.$$compose();
      return this;
    },
    hash: Dd("$$hash", function (a) {
      return null !== a ? a.toString() : "";
    }),
    replace: function replace() {
      this.$$replace = !0;
      return this;
    }
  };

  r([Cd, zc, yc], function (a) {
    a.prototype = Object.create(qh);

    a.prototype.state = function (b) {
      if (!arguments.length) return this.$$state;
      if (a !== yc || !this.$$html5) throw jb("nostate");
      this.$$state = z(b) ? null : b;
      this.$$urlUpdatedByLocation = !0;
      return this;
    };
  });
  var Ya = F("$parse"),
      Rg = {}.constructor.prototype.valueOf,
      Ub = T();
  r("+ - * / % === !== == != < > <= >= && || ! = |".split(" "), function (a) {
    Ub[a] = !0;
  });

  var rh = {
    n: "\n",
    f: "\f",
    r: "\r",
    t: "\t",
    v: "\v",
    "'": "'",
    '"': '"'
  },
      Nb = function Nb(a) {
    this.options = a;
  };

  Nb.prototype = {
    constructor: Nb,
    lex: function lex(a) {
      this.text = a;
      this.index = 0;

      for (this.tokens = []; this.index < this.text.length;) {
        if (a = this.text.charAt(this.index), '"' === a || "'" === a) this.readString(a);else if (this.isNumber(a) || "." === a && this.isNumber(this.peek())) this.readNumber();else if (this.isIdentifierStart(this.peekMultichar())) this.readIdent();else if (this.is(a, "(){}[].,;:?")) this.tokens.push({
          index: this.index,
          text: a
        }), this.index++;else if (this.isWhitespace(a)) this.index++;else {
          var b = a + this.peek(),
              d = b + this.peek(2),
              c = Ub[b],
              e = Ub[d];
          Ub[a] || c || e ? (a = e ? d : c ? b : a, this.tokens.push({
            index: this.index,
            text: a,
            operator: !0
          }), this.index += a.length) : this.throwError("Unexpected next character ", this.index, this.index + 1);
        }
      }

      return this.tokens;
    },
    is: function is(a, b) {
      return -1 !== b.indexOf(a);
    },
    peek: function peek(a) {
      a = a || 1;
      return this.index + a < this.text.length ? this.text.charAt(this.index + a) : !1;
    },
    isNumber: function isNumber(a) {
      return "0" <= a && "9" >= a && "string" === typeof a;
    },
    isWhitespace: function isWhitespace(a) {
      return " " === a || "\r" === a || "\t" === a || "\n" === a || "\v" === a || "\xA0" === a;
    },
    isIdentifierStart: function isIdentifierStart(a) {
      return this.options.isIdentifierStart ? this.options.isIdentifierStart(a, this.codePointAt(a)) : this.isValidIdentifierStart(a);
    },
    isValidIdentifierStart: function isValidIdentifierStart(a) {
      return "a" <= a && "z" >= a || "A" <= a && "Z" >= a || "_" === a || "$" === a;
    },
    isIdentifierContinue: function isIdentifierContinue(a) {
      return this.options.isIdentifierContinue ? this.options.isIdentifierContinue(a, this.codePointAt(a)) : this.isValidIdentifierContinue(a);
    },
    isValidIdentifierContinue: function isValidIdentifierContinue(a, b) {
      return this.isValidIdentifierStart(a, b) || this.isNumber(a);
    },
    codePointAt: function codePointAt(a) {
      return 1 === a.length ? a.charCodeAt(0) : (a.charCodeAt(0) << 10) + a.charCodeAt(1) - 56613888;
    },
    peekMultichar: function peekMultichar() {
      var a = this.text.charAt(this.index),
          b = this.peek();
      if (!b) return a;
      var d = a.charCodeAt(0),
          c = b.charCodeAt(0);
      return 55296 <= d && 56319 >= d && 56320 <= c && 57343 >= c ? a + b : a;
    },
    isExpOperator: function isExpOperator(a) {
      return "-" === a || "+" === a || this.isNumber(a);
    },
    throwError: function throwError(a, b, d) {
      d = d || this.index;
      b = w(b) ? "s " + b + "-" + this.index + " [" + this.text.substring(b, d) + "]" : " " + d;
      throw Ya("lexerr", a, b, this.text);
    },
    readNumber: function readNumber() {
      for (var a = "", b = this.index; this.index < this.text.length;) {
        var d = K(this.text.charAt(this.index));
        if ("." === d || this.isNumber(d)) a += d;else {
          var c = this.peek();
          if ("e" === d && this.isExpOperator(c)) a += d;else if (this.isExpOperator(d) && c && this.isNumber(c) && "e" === a.charAt(a.length - 1)) a += d;else if (!this.isExpOperator(d) || c && this.isNumber(c) || "e" !== a.charAt(a.length - 1)) break;else this.throwError("Invalid exponent");
        }
        this.index++;
      }

      this.tokens.push({
        index: b,
        text: a,
        constant: !0,
        value: Number(a)
      });
    },
    readIdent: function readIdent() {
      var a = this.index;

      for (this.index += this.peekMultichar().length; this.index < this.text.length;) {
        var b = this.peekMultichar();
        if (!this.isIdentifierContinue(b)) break;
        this.index += b.length;
      }

      this.tokens.push({
        index: a,
        text: this.text.slice(a, this.index),
        identifier: !0
      });
    },
    readString: function readString(a) {
      var b = this.index;
      this.index++;

      for (var d = "", c = a, e = !1; this.index < this.text.length;) {
        var f = this.text.charAt(this.index),
            c = c + f;
        if (e) "u" === f ? (e = this.text.substring(this.index + 1, this.index + 5), e.match(/[\da-f]{4}/i) || this.throwError("Invalid unicode escape [\\u" + e + "]"), this.index += 4, d += String.fromCharCode(parseInt(e, 16))) : d += rh[f] || f, e = !1;else if ("\\" === f) e = !0;else {
          if (f === a) {
            this.index++;
            this.tokens.push({
              index: b,
              text: c,
              constant: !0,
              value: d
            });
            return;
          }

          d += f;
        }
        this.index++;
      }

      this.throwError("Unterminated quote", b);
    }
  };

  var q = function q(a, b) {
    this.lexer = a;
    this.options = b;
  };

  q.Program = "Program";
  q.ExpressionStatement = "ExpressionStatement";
  q.AssignmentExpression = "AssignmentExpression";
  q.ConditionalExpression = "ConditionalExpression";
  q.LogicalExpression = "LogicalExpression";
  q.BinaryExpression = "BinaryExpression";
  q.UnaryExpression = "UnaryExpression";
  q.CallExpression = "CallExpression";
  q.MemberExpression = "MemberExpression";
  q.Identifier = "Identifier";
  q.Literal = "Literal";
  q.ArrayExpression = "ArrayExpression";
  q.Property = "Property";
  q.ObjectExpression = "ObjectExpression";
  q.ThisExpression = "ThisExpression";
  q.LocalsExpression = "LocalsExpression";
  q.NGValueParameter = "NGValueParameter";
  q.prototype = {
    ast: function ast(a) {
      this.text = a;
      this.tokens = this.lexer.lex(a);
      a = this.program();
      0 !== this.tokens.length && this.throwError("is an unexpected token", this.tokens[0]);
      return a;
    },
    program: function program() {
      for (var a = [];;) {
        if (0 < this.tokens.length && !this.peek("}", ")", ";", "]") && a.push(this.expressionStatement()), !this.expect(";")) return {
          type: q.Program,
          body: a
        };
      }
    },
    expressionStatement: function expressionStatement() {
      return {
        type: q.ExpressionStatement,
        expression: this.filterChain()
      };
    },
    filterChain: function filterChain() {
      for (var a = this.expression(); this.expect("|");) {
        a = this.filter(a);
      }

      return a;
    },
    expression: function expression() {
      return this.assignment();
    },
    assignment: function assignment() {
      var a = this.ternary();

      if (this.expect("=")) {
        if (!Hd(a)) throw Ya("lval");
        a = {
          type: q.AssignmentExpression,
          left: a,
          right: this.assignment(),
          operator: "="
        };
      }

      return a;
    },
    ternary: function ternary() {
      var a = this.logicalOR(),
          b,
          d;
      return this.expect("?") && (b = this.expression(), this.consume(":")) ? (d = this.expression(), {
        type: q.ConditionalExpression,
        test: a,
        alternate: b,
        consequent: d
      }) : a;
    },
    logicalOR: function logicalOR() {
      for (var a = this.logicalAND(); this.expect("||");) {
        a = {
          type: q.LogicalExpression,
          operator: "||",
          left: a,
          right: this.logicalAND()
        };
      }

      return a;
    },
    logicalAND: function logicalAND() {
      for (var a = this.equality(); this.expect("&&");) {
        a = {
          type: q.LogicalExpression,
          operator: "&&",
          left: a,
          right: this.equality()
        };
      }

      return a;
    },
    equality: function equality() {
      for (var a = this.relational(), b; b = this.expect("==", "!=", "===", "!==");) {
        a = {
          type: q.BinaryExpression,
          operator: b.text,
          left: a,
          right: this.relational()
        };
      }

      return a;
    },
    relational: function relational() {
      for (var a = this.additive(), b; b = this.expect("<", ">", "<=", ">=");) {
        a = {
          type: q.BinaryExpression,
          operator: b.text,
          left: a,
          right: this.additive()
        };
      }

      return a;
    },
    additive: function additive() {
      for (var a = this.multiplicative(), b; b = this.expect("+", "-");) {
        a = {
          type: q.BinaryExpression,
          operator: b.text,
          left: a,
          right: this.multiplicative()
        };
      }

      return a;
    },
    multiplicative: function multiplicative() {
      for (var a = this.unary(), b; b = this.expect("*", "/", "%");) {
        a = {
          type: q.BinaryExpression,
          operator: b.text,
          left: a,
          right: this.unary()
        };
      }

      return a;
    },
    unary: function unary() {
      var a;
      return (a = this.expect("+", "-", "!")) ? {
        type: q.UnaryExpression,
        operator: a.text,
        prefix: !0,
        argument: this.unary()
      } : this.primary();
    },
    primary: function primary() {
      var a;
      this.expect("(") ? (a = this.filterChain(), this.consume(")")) : this.expect("[") ? a = this.arrayDeclaration() : this.expect("{") ? a = this.object() : this.selfReferential.hasOwnProperty(this.peek().text) ? a = Ia(this.selfReferential[this.consume().text]) : this.options.literals.hasOwnProperty(this.peek().text) ? a = {
        type: q.Literal,
        value: this.options.literals[this.consume().text]
      } : this.peek().identifier ? a = this.identifier() : this.peek().constant ? a = this.constant() : this.throwError("not a primary expression", this.peek());

      for (var b; b = this.expect("(", "[", ".");) {
        "(" === b.text ? (a = {
          type: q.CallExpression,
          callee: a,
          arguments: this.parseArguments()
        }, this.consume(")")) : "[" === b.text ? (a = {
          type: q.MemberExpression,
          object: a,
          property: this.expression(),
          computed: !0
        }, this.consume("]")) : "." === b.text ? a = {
          type: q.MemberExpression,
          object: a,
          property: this.identifier(),
          computed: !1
        } : this.throwError("IMPOSSIBLE");
      }

      return a;
    },
    filter: function filter(a) {
      a = [a];

      for (var b = {
        type: q.CallExpression,
        callee: this.identifier(),
        arguments: a,
        filter: !0
      }; this.expect(":");) {
        a.push(this.expression());
      }

      return b;
    },
    parseArguments: function parseArguments() {
      var a = [];

      if (")" !== this.peekToken().text) {
        do {
          a.push(this.filterChain());
        } while (this.expect(","));
      }

      return a;
    },
    identifier: function identifier() {
      var a = this.consume();
      a.identifier || this.throwError("is not a valid identifier", a);
      return {
        type: q.Identifier,
        name: a.text
      };
    },
    constant: function constant() {
      return {
        type: q.Literal,
        value: this.consume().value
      };
    },
    arrayDeclaration: function arrayDeclaration() {
      var a = [];

      if ("]" !== this.peekToken().text) {
        do {
          if (this.peek("]")) break;
          a.push(this.expression());
        } while (this.expect(","));
      }

      this.consume("]");
      return {
        type: q.ArrayExpression,
        elements: a
      };
    },
    object: function object() {
      var a = [],
          b;

      if ("}" !== this.peekToken().text) {
        do {
          if (this.peek("}")) break;
          b = {
            type: q.Property,
            kind: "init"
          };
          this.peek().constant ? (b.key = this.constant(), b.computed = !1, this.consume(":"), b.value = this.expression()) : this.peek().identifier ? (b.key = this.identifier(), b.computed = !1, this.peek(":") ? (this.consume(":"), b.value = this.expression()) : b.value = b.key) : this.peek("[") ? (this.consume("["), b.key = this.expression(), this.consume("]"), b.computed = !0, this.consume(":"), b.value = this.expression()) : this.throwError("invalid key", this.peek());
          a.push(b);
        } while (this.expect(","));
      }

      this.consume("}");
      return {
        type: q.ObjectExpression,
        properties: a
      };
    },
    throwError: function throwError(a, b) {
      throw Ya("syntax", b.text, a, b.index + 1, this.text, this.text.substring(b.index));
    },
    consume: function consume(a) {
      if (0 === this.tokens.length) throw Ya("ueoe", this.text);
      var b = this.expect(a);
      b || this.throwError("is unexpected, expecting [" + a + "]", this.peek());
      return b;
    },
    peekToken: function peekToken() {
      if (0 === this.tokens.length) throw Ya("ueoe", this.text);
      return this.tokens[0];
    },
    peek: function peek(a, b, d, c) {
      return this.peekAhead(0, a, b, d, c);
    },
    peekAhead: function peekAhead(a, b, d, c, e) {
      if (this.tokens.length > a) {
        a = this.tokens[a];
        var f = a.text;
        if (f === b || f === d || f === c || f === e || !(b || d || c || e)) return a;
      }

      return !1;
    },
    expect: function expect(a, b, d, c) {
      return (a = this.peek(a, b, d, c)) ? (this.tokens.shift(), a) : !1;
    },
    selfReferential: {
      "this": {
        type: q.ThisExpression
      },
      $locals: {
        type: q.LocalsExpression
      }
    }
  };
  var Fd = 2;
  Jd.prototype = {
    compile: function compile(a) {
      var b = this;
      this.state = {
        nextId: 0,
        filters: {},
        fn: {
          vars: [],
          body: [],
          own: {}
        },
        assign: {
          vars: [],
          body: [],
          own: {}
        },
        inputs: []
      };
      Z(a, b.$filter);
      var d = "",
          c;
      this.stage = "assign";
      if (c = Id(a)) this.state.computing = "assign", d = this.nextId(), this.recurse(c, d), this.return_(d), d = "fn.assign=" + this.generateFunction("assign", "s,v,l");
      c = Gd(a.body);
      b.stage = "inputs";
      r(c, function (a, c) {
        var d = "fn" + c;
        b.state[d] = {
          vars: [],
          body: [],
          own: {}
        };
        b.state.computing = d;
        var k = b.nextId();
        b.recurse(a, k);
        b.return_(k);
        b.state.inputs.push({
          name: d,
          isPure: a.isPure
        });
        a.watchId = c;
      });
      this.state.computing = "fn";
      this.stage = "main";
      this.recurse(a);
      a = '"' + this.USE + " " + this.STRICT + '";\n' + this.filterPrefix() + "var fn=" + this.generateFunction("fn", "s,l,a,i") + d + this.watchFns() + "return fn;";
      a = new Function("$filter", "getStringValue", "ifDefined", "plus", a)(this.$filter, Og, Pg, Ed);
      this.state = this.stage = void 0;
      return a;
    },
    USE: "use",
    STRICT: "strict",
    watchFns: function watchFns() {
      var a = [],
          b = this.state.inputs,
          d = this;
      r(b, function (b) {
        a.push("var " + b.name + "=" + d.generateFunction(b.name, "s"));
        b.isPure && a.push(b.name, ".isPure=" + JSON.stringify(b.isPure) + ";");
      });
      b.length && a.push("fn.inputs=[" + b.map(function (a) {
        return a.name;
      }).join(",") + "];");
      return a.join("");
    },
    generateFunction: function generateFunction(a, b) {
      return "function(" + b + "){" + this.varsPrefix(a) + this.body(a) + "};";
    },
    filterPrefix: function filterPrefix() {
      var a = [],
          b = this;
      r(this.state.filters, function (d, c) {
        a.push(d + "=$filter(" + b.escape(c) + ")");
      });
      return a.length ? "var " + a.join(",") + ";" : "";
    },
    varsPrefix: function varsPrefix(a) {
      return this.state[a].vars.length ? "var " + this.state[a].vars.join(",") + ";" : "";
    },
    body: function body(a) {
      return this.state[a].body.join("");
    },
    recurse: function recurse(a, b, d, c, e, f) {
      var g,
          k,
          h = this,
          l,
          m,
          p;
      c = c || E;
      if (!f && w(a.watchId)) b = b || this.nextId(), this.if_("i", this.lazyAssign(b, this.computedMember("i", a.watchId)), this.lazyRecurse(a, b, d, c, e, !0));else switch (a.type) {
        case q.Program:
          r(a.body, function (b, c) {
            h.recurse(b.expression, void 0, void 0, function (a) {
              k = a;
            });
            c !== a.body.length - 1 ? h.current().body.push(k, ";") : h.return_(k);
          });
          break;

        case q.Literal:
          m = this.escape(a.value);
          this.assign(b, m);
          c(b || m);
          break;

        case q.UnaryExpression:
          this.recurse(a.argument, void 0, void 0, function (a) {
            k = a;
          });
          m = a.operator + "(" + this.ifDefined(k, 0) + ")";
          this.assign(b, m);
          c(m);
          break;

        case q.BinaryExpression:
          this.recurse(a.left, void 0, void 0, function (a) {
            g = a;
          });
          this.recurse(a.right, void 0, void 0, function (a) {
            k = a;
          });
          m = "+" === a.operator ? this.plus(g, k) : "-" === a.operator ? this.ifDefined(g, 0) + a.operator + this.ifDefined(k, 0) : "(" + g + ")" + a.operator + "(" + k + ")";
          this.assign(b, m);
          c(m);
          break;

        case q.LogicalExpression:
          b = b || this.nextId();
          h.recurse(a.left, b);
          h.if_("&&" === a.operator ? b : h.not(b), h.lazyRecurse(a.right, b));
          c(b);
          break;

        case q.ConditionalExpression:
          b = b || this.nextId();
          h.recurse(a.test, b);
          h.if_(b, h.lazyRecurse(a.alternate, b), h.lazyRecurse(a.consequent, b));
          c(b);
          break;

        case q.Identifier:
          b = b || this.nextId();
          d && (d.context = "inputs" === h.stage ? "s" : this.assign(this.nextId(), this.getHasOwnProperty("l", a.name) + "?l:s"), d.computed = !1, d.name = a.name);
          h.if_("inputs" === h.stage || h.not(h.getHasOwnProperty("l", a.name)), function () {
            h.if_("inputs" === h.stage || "s", function () {
              e && 1 !== e && h.if_(h.isNull(h.nonComputedMember("s", a.name)), h.lazyAssign(h.nonComputedMember("s", a.name), "{}"));
              h.assign(b, h.nonComputedMember("s", a.name));
            });
          }, b && h.lazyAssign(b, h.nonComputedMember("l", a.name)));
          c(b);
          break;

        case q.MemberExpression:
          g = d && (d.context = this.nextId()) || this.nextId();
          b = b || this.nextId();
          h.recurse(a.object, g, void 0, function () {
            h.if_(h.notNull(g), function () {
              a.computed ? (k = h.nextId(), h.recurse(a.property, k), h.getStringValue(k), e && 1 !== e && h.if_(h.not(h.computedMember(g, k)), h.lazyAssign(h.computedMember(g, k), "{}")), m = h.computedMember(g, k), h.assign(b, m), d && (d.computed = !0, d.name = k)) : (e && 1 !== e && h.if_(h.isNull(h.nonComputedMember(g, a.property.name)), h.lazyAssign(h.nonComputedMember(g, a.property.name), "{}")), m = h.nonComputedMember(g, a.property.name), h.assign(b, m), d && (d.computed = !1, d.name = a.property.name));
            }, function () {
              h.assign(b, "undefined");
            });
            c(b);
          }, !!e);
          break;

        case q.CallExpression:
          b = b || this.nextId();
          a.filter ? (k = h.filter(a.callee.name), l = [], r(a.arguments, function (a) {
            var b = h.nextId();
            h.recurse(a, b);
            l.push(b);
          }), m = k + "(" + l.join(",") + ")", h.assign(b, m), c(b)) : (k = h.nextId(), g = {}, l = [], h.recurse(a.callee, k, g, function () {
            h.if_(h.notNull(k), function () {
              r(a.arguments, function (b) {
                h.recurse(b, a.constant ? void 0 : h.nextId(), void 0, function (a) {
                  l.push(a);
                });
              });
              m = g.name ? h.member(g.context, g.name, g.computed) + "(" + l.join(",") + ")" : k + "(" + l.join(",") + ")";
              h.assign(b, m);
            }, function () {
              h.assign(b, "undefined");
            });
            c(b);
          }));
          break;

        case q.AssignmentExpression:
          k = this.nextId();
          g = {};
          this.recurse(a.left, void 0, g, function () {
            h.if_(h.notNull(g.context), function () {
              h.recurse(a.right, k);
              m = h.member(g.context, g.name, g.computed) + a.operator + k;
              h.assign(b, m);
              c(b || m);
            });
          }, 1);
          break;

        case q.ArrayExpression:
          l = [];
          r(a.elements, function (b) {
            h.recurse(b, a.constant ? void 0 : h.nextId(), void 0, function (a) {
              l.push(a);
            });
          });
          m = "[" + l.join(",") + "]";
          this.assign(b, m);
          c(b || m);
          break;

        case q.ObjectExpression:
          l = [];
          p = !1;
          r(a.properties, function (a) {
            a.computed && (p = !0);
          });
          p ? (b = b || this.nextId(), this.assign(b, "{}"), r(a.properties, function (a) {
            a.computed ? (g = h.nextId(), h.recurse(a.key, g)) : g = a.key.type === q.Identifier ? a.key.name : "" + a.key.value;
            k = h.nextId();
            h.recurse(a.value, k);
            h.assign(h.member(b, g, a.computed), k);
          })) : (r(a.properties, function (b) {
            h.recurse(b.value, a.constant ? void 0 : h.nextId(), void 0, function (a) {
              l.push(h.escape(b.key.type === q.Identifier ? b.key.name : "" + b.key.value) + ":" + a);
            });
          }), m = "{" + l.join(",") + "}", this.assign(b, m));
          c(b || m);
          break;

        case q.ThisExpression:
          this.assign(b, "s");
          c(b || "s");
          break;

        case q.LocalsExpression:
          this.assign(b, "l");
          c(b || "l");
          break;

        case q.NGValueParameter:
          this.assign(b, "v"), c(b || "v");
      }
    },
    getHasOwnProperty: function getHasOwnProperty(a, b) {
      var d = a + "." + b,
          c = this.current().own;
      c.hasOwnProperty(d) || (c[d] = this.nextId(!1, a + "&&(" + this.escape(b) + " in " + a + ")"));
      return c[d];
    },
    assign: function assign(a, b) {
      if (a) return this.current().body.push(a, "=", b, ";"), a;
    },
    filter: function filter(a) {
      this.state.filters.hasOwnProperty(a) || (this.state.filters[a] = this.nextId(!0));
      return this.state.filters[a];
    },
    ifDefined: function ifDefined(a, b) {
      return "ifDefined(" + a + "," + this.escape(b) + ")";
    },
    plus: function plus(a, b) {
      return "plus(" + a + "," + b + ")";
    },
    return_: function return_(a) {
      this.current().body.push("return ", a, ";");
    },
    if_: function if_(a, b, d) {
      if (!0 === a) b();else {
        var c = this.current().body;
        c.push("if(", a, "){");
        b();
        c.push("}");
        d && (c.push("else{"), d(), c.push("}"));
      }
    },
    not: function not(a) {
      return "!(" + a + ")";
    },
    isNull: function isNull(a) {
      return a + "==null";
    },
    notNull: function notNull(a) {
      return a + "!=null";
    },
    nonComputedMember: function nonComputedMember(a, b) {
      var d = /[^$_a-zA-Z0-9]/g;
      return /^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(b) ? a + "." + b : a + '["' + b.replace(d, this.stringEscapeFn) + '"]';
    },
    computedMember: function computedMember(a, b) {
      return a + "[" + b + "]";
    },
    member: function member(a, b, d) {
      return d ? this.computedMember(a, b) : this.nonComputedMember(a, b);
    },
    getStringValue: function getStringValue(a) {
      this.assign(a, "getStringValue(" + a + ")");
    },
    lazyRecurse: function lazyRecurse(a, b, d, c, e, f) {
      var g = this;
      return function () {
        g.recurse(a, b, d, c, e, f);
      };
    },
    lazyAssign: function lazyAssign(a, b) {
      var d = this;
      return function () {
        d.assign(a, b);
      };
    },
    stringEscapeRegex: /[^ a-zA-Z0-9]/g,
    stringEscapeFn: function stringEscapeFn(a) {
      return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
    },
    escape: function escape(a) {
      if (A(a)) return "'" + a.replace(this.stringEscapeRegex, this.stringEscapeFn) + "'";
      if (W(a)) return a.toString();
      if (!0 === a) return "true";
      if (!1 === a) return "false";
      if (null === a) return "null";
      if ("undefined" === typeof a) return "undefined";
      throw Ya("esc");
    },
    nextId: function nextId(a, b) {
      var d = "v" + this.state.nextId++;
      a || this.current().vars.push(d + (b ? "=" + b : ""));
      return d;
    },
    current: function current() {
      return this.state[this.state.computing];
    }
  };
  Kd.prototype = {
    compile: function compile(a) {
      var b = this;
      Z(a, b.$filter);
      var d, c;
      if (d = Id(a)) c = this.recurse(d);
      d = Gd(a.body);
      var e;
      d && (e = [], r(d, function (a, c) {
        var d = b.recurse(a);
        d.isPure = a.isPure;
        a.input = d;
        e.push(d);
        a.watchId = c;
      }));
      var f = [];
      r(a.body, function (a) {
        f.push(b.recurse(a.expression));
      });
      a = 0 === a.body.length ? E : 1 === a.body.length ? f[0] : function (a, b) {
        var c;
        r(f, function (d) {
          c = d(a, b);
        });
        return c;
      };
      c && (a.assign = function (a, b, d) {
        return c(a, d, b);
      });
      e && (a.inputs = e);
      return a;
    },
    recurse: function recurse(a, b, d) {
      var c,
          e,
          f = this,
          g;
      if (a.input) return this.inputs(a.input, a.watchId);

      switch (a.type) {
        case q.Literal:
          return this.value(a.value, b);

        case q.UnaryExpression:
          return e = this.recurse(a.argument), this["unary" + a.operator](e, b);

        case q.BinaryExpression:
          return c = this.recurse(a.left), e = this.recurse(a.right), this["binary" + a.operator](c, e, b);

        case q.LogicalExpression:
          return c = this.recurse(a.left), e = this.recurse(a.right), this["binary" + a.operator](c, e, b);

        case q.ConditionalExpression:
          return this["ternary?:"](this.recurse(a.test), this.recurse(a.alternate), this.recurse(a.consequent), b);

        case q.Identifier:
          return f.identifier(a.name, b, d);

        case q.MemberExpression:
          return c = this.recurse(a.object, !1, !!d), a.computed || (e = a.property.name), a.computed && (e = this.recurse(a.property)), a.computed ? this.computedMember(c, e, b, d) : this.nonComputedMember(c, e, b, d);

        case q.CallExpression:
          return g = [], r(a.arguments, function (a) {
            g.push(f.recurse(a));
          }), a.filter && (e = this.$filter(a.callee.name)), a.filter || (e = this.recurse(a.callee, !0)), a.filter ? function (a, c, d, f) {
            for (var p = [], n = 0; n < g.length; ++n) {
              p.push(g[n](a, c, d, f));
            }

            a = e.apply(void 0, p, f);
            return b ? {
              context: void 0,
              name: void 0,
              value: a
            } : a;
          } : function (a, c, d, f) {
            var p = e(a, c, d, f),
                n;

            if (null != p.value) {
              n = [];

              for (var s = 0; s < g.length; ++s) {
                n.push(g[s](a, c, d, f));
              }

              n = p.value.apply(p.context, n);
            }

            return b ? {
              value: n
            } : n;
          };

        case q.AssignmentExpression:
          return c = this.recurse(a.left, !0, 1), e = this.recurse(a.right), function (a, d, f, g) {
            var p = c(a, d, f, g);
            a = e(a, d, f, g);
            p.context[p.name] = a;
            return b ? {
              value: a
            } : a;
          };

        case q.ArrayExpression:
          return g = [], r(a.elements, function (a) {
            g.push(f.recurse(a));
          }), function (a, c, d, e) {
            for (var f = [], n = 0; n < g.length; ++n) {
              f.push(g[n](a, c, d, e));
            }

            return b ? {
              value: f
            } : f;
          };

        case q.ObjectExpression:
          return g = [], r(a.properties, function (a) {
            a.computed ? g.push({
              key: f.recurse(a.key),
              computed: !0,
              value: f.recurse(a.value)
            }) : g.push({
              key: a.key.type === q.Identifier ? a.key.name : "" + a.key.value,
              computed: !1,
              value: f.recurse(a.value)
            });
          }), function (a, c, d, e) {
            for (var f = {}, n = 0; n < g.length; ++n) {
              g[n].computed ? f[g[n].key(a, c, d, e)] = g[n].value(a, c, d, e) : f[g[n].key] = g[n].value(a, c, d, e);
            }

            return b ? {
              value: f
            } : f;
          };

        case q.ThisExpression:
          return function (a) {
            return b ? {
              value: a
            } : a;
          };

        case q.LocalsExpression:
          return function (a, c) {
            return b ? {
              value: c
            } : c;
          };

        case q.NGValueParameter:
          return function (a, c, d) {
            return b ? {
              value: d
            } : d;
          };
      }
    },
    "unary+": function unary(a, b) {
      return function (d, c, e, f) {
        d = a(d, c, e, f);
        d = w(d) ? +d : 0;
        return b ? {
          value: d
        } : d;
      };
    },
    "unary-": function unary(a, b) {
      return function (d, c, e, f) {
        d = a(d, c, e, f);
        d = w(d) ? -d : -0;
        return b ? {
          value: d
        } : d;
      };
    },
    "unary!": function unary(a, b) {
      return function (d, c, e, f) {
        d = !a(d, c, e, f);
        return b ? {
          value: d
        } : d;
      };
    },
    "binary+": function binary(a, b, d) {
      return function (c, e, f, g) {
        var k = a(c, e, f, g);
        c = b(c, e, f, g);
        k = Ed(k, c);
        return d ? {
          value: k
        } : k;
      };
    },
    "binary-": function binary(a, b, d) {
      return function (c, e, f, g) {
        var k = a(c, e, f, g);
        c = b(c, e, f, g);
        k = (w(k) ? k : 0) - (w(c) ? c : 0);
        return d ? {
          value: k
        } : k;
      };
    },
    "binary*": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) * b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary/": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) / b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary%": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) % b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary===": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) === b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary!==": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) !== b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary==": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) == b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary!=": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) != b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary<": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) < b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary>": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) > b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary<=": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) <= b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary>=": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) >= b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary&&": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) && b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "binary||": function binary(a, b, d) {
      return function (c, e, f, g) {
        c = a(c, e, f, g) || b(c, e, f, g);
        return d ? {
          value: c
        } : c;
      };
    },
    "ternary?:": function ternary(a, b, d, c) {
      return function (e, f, g, k) {
        e = a(e, f, g, k) ? b(e, f, g, k) : d(e, f, g, k);
        return c ? {
          value: e
        } : e;
      };
    },
    value: function value(a, b) {
      return function () {
        return b ? {
          context: void 0,
          name: void 0,
          value: a
        } : a;
      };
    },
    identifier: function identifier(a, b, d) {
      return function (c, e, f, g) {
        c = e && a in e ? e : c;
        d && 1 !== d && c && null == c[a] && (c[a] = {});
        e = c ? c[a] : void 0;
        return b ? {
          context: c,
          name: a,
          value: e
        } : e;
      };
    },
    computedMember: function computedMember(a, b, d, c) {
      return function (e, f, g, k) {
        var h = a(e, f, g, k),
            l,
            m;
        null != h && (l = b(e, f, g, k), l += "", c && 1 !== c && h && !h[l] && (h[l] = {}), m = h[l]);
        return d ? {
          context: h,
          name: l,
          value: m
        } : m;
      };
    },
    nonComputedMember: function nonComputedMember(a, b, d, c) {
      return function (e, f, g, k) {
        e = a(e, f, g, k);
        c && 1 !== c && e && null == e[b] && (e[b] = {});
        f = null != e ? e[b] : void 0;
        return d ? {
          context: e,
          name: b,
          value: f
        } : f;
      };
    },
    inputs: function inputs(a, b) {
      return function (d, c, e, f) {
        return f ? f[b] : a(d, c, e);
      };
    }
  };
  Mb.prototype = {
    constructor: Mb,
    parse: function parse(a) {
      a = this.getAst(a);
      var b = this.astCompiler.compile(a.ast),
          d = a.ast;
      b.literal = 0 === d.body.length || 1 === d.body.length && (d.body[0].expression.type === q.Literal || d.body[0].expression.type === q.ArrayExpression || d.body[0].expression.type === q.ObjectExpression);
      b.constant = a.ast.constant;
      b.oneTime = a.oneTime;
      return b;
    },
    getAst: function getAst(a) {
      var b = !1;
      a = a.trim();
      ":" === a.charAt(0) && ":" === a.charAt(1) && (b = !0, a = a.substring(2));
      return {
        ast: this.ast.ast(a),
        oneTime: b
      };
    }
  };
  var Ea = F("$sce"),
      V = {
    HTML: "html",
    CSS: "css",
    MEDIA_URL: "mediaUrl",
    URL: "url",
    RESOURCE_URL: "resourceUrl",
    JS: "js"
  },
      Cc = /_([a-z])/g,
      Ug = F("$templateRequest"),
      Vg = F("$timeout"),
      aa = C.document.createElement("a"),
      Od = ga(C.location.href),
      Na;
  aa.href = "http://[::1]";
  var Wg = "[::1]" === aa.hostname;
  Pd.$inject = ["$document"];
  dd.$inject = ["$provide"];
  var Wd = 22,
      Vd = ".",
      Ec = "0";
  Qd.$inject = ["$locale"];
  Sd.$inject = ["$locale"];
  var gh = {
    yyyy: ea("FullYear", 4, 0, !1, !0),
    yy: ea("FullYear", 2, 0, !0, !0),
    y: ea("FullYear", 1, 0, !1, !0),
    MMMM: kb("Month"),
    MMM: kb("Month", !0),
    MM: ea("Month", 2, 1),
    M: ea("Month", 1, 1),
    LLLL: kb("Month", !1, !0),
    dd: ea("Date", 2),
    d: ea("Date", 1),
    HH: ea("Hours", 2),
    H: ea("Hours", 1),
    hh: ea("Hours", 2, -12),
    h: ea("Hours", 1, -12),
    mm: ea("Minutes", 2),
    m: ea("Minutes", 1),
    ss: ea("Seconds", 2),
    s: ea("Seconds", 1),
    sss: ea("Milliseconds", 3),
    EEEE: kb("Day"),
    EEE: kb("Day", !0),
    a: function a(_a, b) {
      return 12 > _a.getHours() ? b.AMPMS[0] : b.AMPMS[1];
    },
    Z: function Z(a, b, d) {
      a = -1 * d;
      return a = (0 <= a ? "+" : "") + (Ob(Math[0 < a ? "floor" : "ceil"](a / 60), 2) + Ob(Math.abs(a % 60), 2));
    },
    ww: Yd(2),
    w: Yd(1),
    G: Fc,
    GG: Fc,
    GGG: Fc,
    GGGG: function GGGG(a, b) {
      return 0 >= a.getFullYear() ? b.ERANAMES[0] : b.ERANAMES[1];
    }
  },
      fh = /((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,
      eh = /^-?\d+$/;
  Rd.$inject = ["$locale"];
  var $g = ia(K),
      ah = ia(ub);
  Td.$inject = ["$parse"];
  var Me = ia({
    restrict: "E",
    compile: function compile(a, b) {
      if (!b.href && !b.xlinkHref) return function (a, b) {
        if ("a" === b[0].nodeName.toLowerCase()) {
          var e = "[object SVGAnimatedString]" === la.call(b.prop("href")) ? "xlink:href" : "href";
          b.on("click", function (a) {
            b.attr(e) || a.preventDefault();
          });
        }
      };
    }
  }),
      vb = {};
  r(Gb, function (a, b) {
    function d(a, d, e) {
      a.$watch(e[c], function (a) {
        e.$set(b, !!a);
      });
    }

    if ("multiple" !== a) {
      var c = wa("ng-" + b),
          e = d;
      "checked" === a && (e = function e(a, b, _e) {
        _e.ngModel !== _e[c] && d(a, b, _e);
      });

      vb[c] = function () {
        return {
          restrict: "A",
          priority: 100,
          link: e
        };
      };
    }
  });
  r(td, function (a, b) {
    vb[b] = function () {
      return {
        priority: 100,
        link: function link(a, c, e) {
          if ("ngPattern" === b && "/" === e.ngPattern.charAt(0) && (c = e.ngPattern.match(ie))) {
            e.$set("ngPattern", new RegExp(c[1], c[2]));
            return;
          }

          a.$watch(e[b], function (a) {
            e.$set(b, a);
          });
        }
      };
    };
  });
  r(["src", "srcset", "href"], function (a) {
    var b = wa("ng-" + a);
    vb[b] = ["$sce", function (d) {
      return {
        priority: 99,
        link: function link(c, e, f) {
          var g = a,
              k = a;
          "href" === a && "[object SVGAnimatedString]" === la.call(e.prop("href")) && (k = "xlinkHref", f.$attr[k] = "xlink:href", g = null);
          f.$set(b, d.getTrustedMediaUrl(f[b]));
          f.$observe(b, function (b) {
            b ? (f.$set(k, b), Ca && g && e.prop(g, f[k])) : "href" === a && f.$set(k, null);
          });
        }
      };
    }];
  });
  var lb = {
    $addControl: E,
    $getControls: ia([]),
    $$renameControl: function $$renameControl(a, b) {
      a.$name = b;
    },
    $removeControl: E,
    $setValidity: E,
    $setDirty: E,
    $setPristine: E,
    $setSubmitted: E,
    $$setSubmitted: E
  };
  Pb.$inject = ["$element", "$attrs", "$scope", "$animate", "$interpolate"];
  Pb.prototype = {
    $rollbackViewValue: function $rollbackViewValue() {
      r(this.$$controls, function (a) {
        a.$rollbackViewValue();
      });
    },
    $commitViewValue: function $commitViewValue() {
      r(this.$$controls, function (a) {
        a.$commitViewValue();
      });
    },
    $addControl: function $addControl(a) {
      Ja(a.$name, "input");
      this.$$controls.push(a);
      a.$name && (this[a.$name] = a);
      a.$$parentForm = this;
    },
    $getControls: function $getControls() {
      return ja(this.$$controls);
    },
    $$renameControl: function $$renameControl(a, b) {
      var d = a.$name;
      this[d] === a && delete this[d];
      this[b] = a;
      a.$name = b;
    },
    $removeControl: function $removeControl(a) {
      a.$name && this[a.$name] === a && delete this[a.$name];
      r(this.$pending, function (b, d) {
        this.$setValidity(d, null, a);
      }, this);
      r(this.$error, function (b, d) {
        this.$setValidity(d, null, a);
      }, this);
      r(this.$$success, function (b, d) {
        this.$setValidity(d, null, a);
      }, this);
      cb(this.$$controls, a);
      a.$$parentForm = lb;
    },
    $setDirty: function $setDirty() {
      this.$$animate.removeClass(this.$$element, Za);
      this.$$animate.addClass(this.$$element, Vb);
      this.$dirty = !0;
      this.$pristine = !1;
      this.$$parentForm.$setDirty();
    },
    $setPristine: function $setPristine() {
      this.$$animate.setClass(this.$$element, Za, Vb + " ng-submitted");
      this.$dirty = !1;
      this.$pristine = !0;
      this.$submitted = !1;
      r(this.$$controls, function (a) {
        a.$setPristine();
      });
    },
    $setUntouched: function $setUntouched() {
      r(this.$$controls, function (a) {
        a.$setUntouched();
      });
    },
    $setSubmitted: function $setSubmitted() {
      for (var a = this; a.$$parentForm && a.$$parentForm !== lb;) {
        a = a.$$parentForm;
      }

      a.$$setSubmitted();
    },
    $$setSubmitted: function $$setSubmitted() {
      this.$$animate.addClass(this.$$element, "ng-submitted");
      this.$submitted = !0;
      r(this.$$controls, function (a) {
        a.$$setSubmitted && a.$$setSubmitted();
      });
    }
  };
  ae({
    clazz: Pb,
    set: function set(a, b, d) {
      var c = a[b];
      c ? -1 === c.indexOf(d) && c.push(d) : a[b] = [d];
    },
    unset: function unset(a, b, d) {
      var c = a[b];
      c && (cb(c, d), 0 === c.length && delete a[b]);
    }
  });

  var ke = function ke(a) {
    return ["$timeout", "$parse", function (b, d) {
      function c(a) {
        return "" === a ? d('this[""]').assign : d(a).assign || E;
      }

      return {
        name: "form",
        restrict: a ? "EAC" : "E",
        require: ["form", "^^?form"],
        controller: Pb,
        compile: function compile(d, f) {
          d.addClass(Za).addClass(mb);
          var g = f.name ? "name" : a && f.ngForm ? "ngForm" : !1;
          return {
            pre: function pre(a, d, e, f) {
              var p = f[0];

              if (!("action" in e)) {
                var n = function n(b) {
                  a.$apply(function () {
                    p.$commitViewValue();
                    p.$setSubmitted();
                  });
                  b.preventDefault();
                };

                d[0].addEventListener("submit", n);
                d.on("$destroy", function () {
                  b(function () {
                    d[0].removeEventListener("submit", n);
                  }, 0, !1);
                });
              }

              (f[1] || p.$$parentForm).$addControl(p);
              var s = g ? c(p.$name) : E;
              g && (s(a, p), e.$observe(g, function (b) {
                p.$name !== b && (s(a, void 0), p.$$parentForm.$$renameControl(p, b), s = c(p.$name), s(a, p));
              }));
              d.on("$destroy", function () {
                p.$$parentForm.$removeControl(p);
                s(a, void 0);
                S(p, lb);
              });
            }
          };
        }
      };
    }];
  },
      Ne = ke(),
      Ze = ke(!0),
      hh = /^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,
      sh = /^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,
      th = /^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,
      ih = /^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,
      le = /^(\d{4,})-(\d{2})-(\d{2})$/,
      me = /^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,
      Mc = /^(\d{4,})-W(\d\d)$/,
      ne = /^(\d{4,})-(\d\d)$/,
      oe = /^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,
      ce = T();

  r(["date", "datetime-local", "month", "time", "week"], function (a) {
    ce[a] = !0;
  });

  var pe = {
    text: function text(a, b, d, c, e, f) {
      Sa(a, b, d, c, e, f);
      Hc(c);
    },
    date: nb("date", le, Qb(le, ["yyyy", "MM", "dd"]), "yyyy-MM-dd"),
    "datetime-local": nb("datetimelocal", me, Qb(me, "yyyy MM dd HH mm ss sss".split(" ")), "yyyy-MM-ddTHH:mm:ss.sss"),
    time: nb("time", oe, Qb(oe, ["HH", "mm", "ss", "sss"]), "HH:mm:ss.sss"),
    week: nb("week", Mc, function (a, b) {
      if (ha(a)) return a;

      if (A(a)) {
        Mc.lastIndex = 0;
        var d = Mc.exec(a);

        if (d) {
          var c = +d[1],
              e = +d[2],
              f = d = 0,
              g = 0,
              k = 0,
              h = Xd(c),
              e = 7 * (e - 1);
          b && (d = b.getHours(), f = b.getMinutes(), g = b.getSeconds(), k = b.getMilliseconds());
          return new Date(c, 0, h.getDate() + e, d, f, g, k);
        }
      }

      return NaN;
    }, "yyyy-Www"),
    month: nb("month", ne, Qb(ne, ["yyyy", "MM"]), "yyyy-MM"),
    number: function number(a, b, d, c, e, f, g, k) {
      Ic(a, b, d, c, "number");
      de(c);
      Sa(a, b, d, c, e, f);
      var h;

      if (w(d.min) || d.ngMin) {
        var l = d.min || k(d.ngMin)(a);
        h = na(l);

        c.$validators.min = function (a, b) {
          return c.$isEmpty(b) || z(h) || b >= h;
        };

        d.$observe("min", function (a) {
          a !== l && (h = na(a), l = a, c.$validate());
        });
      }

      if (w(d.max) || d.ngMax) {
        var m = d.max || k(d.ngMax)(a),
            p = na(m);

        c.$validators.max = function (a, b) {
          return c.$isEmpty(b) || z(p) || b <= p;
        };

        d.$observe("max", function (a) {
          a !== m && (p = na(a), m = a, c.$validate());
        });
      }

      if (w(d.step) || d.ngStep) {
        var n = d.step || k(d.ngStep)(a),
            s = na(n);

        c.$validators.step = function (a, b) {
          return c.$isEmpty(b) || z(s) || ee(b, h || 0, s);
        };

        d.$observe("step", function (a) {
          a !== n && (s = na(a), n = a, c.$validate());
        });
      }
    },
    url: function url(a, b, d, c, e, f) {
      Sa(a, b, d, c, e, f);
      Hc(c);

      c.$validators.url = function (a, b) {
        var d = a || b;
        return c.$isEmpty(d) || sh.test(d);
      };
    },
    email: function email(a, b, d, c, e, f) {
      Sa(a, b, d, c, e, f);
      Hc(c);

      c.$validators.email = function (a, b) {
        var d = a || b;
        return c.$isEmpty(d) || th.test(d);
      };
    },
    radio: function radio(a, b, d, c) {
      var e = !d.ngTrim || "false" !== U(d.ngTrim);
      z(d.name) && b.attr("name", ++pb);
      b.on("change", function (a) {
        var g;
        b[0].checked && (g = d.value, e && (g = U(g)), c.$setViewValue(g, a && a.type));
      });

      c.$render = function () {
        var a = d.value;
        e && (a = U(a));
        b[0].checked = a === c.$viewValue;
      };

      d.$observe("value", c.$render);
    },
    range: function range(a, b, d, c, e, f) {
      function g(a, c) {
        b.attr(a, d[a]);
        var e = d[a];
        d.$observe(a, function (a) {
          a !== e && (e = a, c(a));
        });
      }

      function k(a) {
        p = na(a);
        X(c.$modelValue) || (m ? (a = b.val(), p > a && (a = p, b.val(a)), c.$setViewValue(a)) : c.$validate());
      }

      function h(a) {
        n = na(a);
        X(c.$modelValue) || (m ? (a = b.val(), n < a && (b.val(n), a = n < p ? p : n), c.$setViewValue(a)) : c.$validate());
      }

      function l(a) {
        s = na(a);
        X(c.$modelValue) || (m ? c.$viewValue !== b.val() && c.$setViewValue(b.val()) : c.$validate());
      }

      Ic(a, b, d, c, "range");
      de(c);
      Sa(a, b, d, c, e, f);
      var m = c.$$hasNativeValidators && "range" === b[0].type,
          p = m ? 0 : void 0,
          n = m ? 100 : void 0,
          s = m ? 1 : void 0,
          r = b[0].validity;
      a = w(d.min);
      e = w(d.max);
      f = w(d.step);
      var q = c.$render;
      c.$render = m && w(r.rangeUnderflow) && w(r.rangeOverflow) ? function () {
        q();
        c.$setViewValue(b.val());
      } : q;
      a && (p = na(d.min), c.$validators.min = m ? function () {
        return !0;
      } : function (a, b) {
        return c.$isEmpty(b) || z(p) || b >= p;
      }, g("min", k));
      e && (n = na(d.max), c.$validators.max = m ? function () {
        return !0;
      } : function (a, b) {
        return c.$isEmpty(b) || z(n) || b <= n;
      }, g("max", h));
      f && (s = na(d.step), c.$validators.step = m ? function () {
        return !r.stepMismatch;
      } : function (a, b) {
        return c.$isEmpty(b) || z(s) || ee(b, p || 0, s);
      }, g("step", l));
    },
    checkbox: function checkbox(a, b, d, c, e, f, g, k) {
      var h = fe(k, a, "ngTrueValue", d.ngTrueValue, !0),
          l = fe(k, a, "ngFalseValue", d.ngFalseValue, !1);
      b.on("change", function (a) {
        c.$setViewValue(b[0].checked, a && a.type);
      });

      c.$render = function () {
        b[0].checked = c.$viewValue;
      };

      c.$isEmpty = function (a) {
        return !1 === a;
      };

      c.$formatters.push(function (a) {
        return va(a, h);
      });
      c.$parsers.push(function (a) {
        return a ? h : l;
      });
    },
    hidden: E,
    button: E,
    submit: E,
    reset: E,
    file: E
  },
      Yc = ["$browser", "$sniffer", "$filter", "$parse", function (a, b, d, c) {
    return {
      restrict: "E",
      require: ["?ngModel"],
      link: {
        pre: function pre(e, f, g, k) {
          k[0] && (pe[K(g.type)] || pe.text)(e, f, g, k[0], b, a, d, c);
        }
      }
    };
  }],
      vf = function vf() {
    var a = {
      configurable: !0,
      enumerable: !1,
      get: function get() {
        return this.getAttribute("value") || "";
      },
      set: function set(a) {
        this.setAttribute("value", a);
      }
    };
    return {
      restrict: "E",
      priority: 200,
      compile: function compile(b, d) {
        if ("hidden" === K(d.type)) return {
          pre: function pre(b, d, f, g) {
            b = d[0];
            b.parentNode && b.parentNode.insertBefore(b, b.nextSibling);
            Object.defineProperty && Object.defineProperty(b, "value", a);
          }
        };
      }
    };
  },
      uh = /^(true|false|\d+)$/,
      sf = function sf() {
    function a(a, d, c) {
      var e = w(c) ? c : 9 === Ca ? "" : null;
      a.prop("value", e);
      d.$set("value", c);
    }

    return {
      restrict: "A",
      priority: 100,
      compile: function compile(b, d) {
        return uh.test(d.ngValue) ? function (b, d, f) {
          b = b.$eval(f.ngValue);
          a(d, f, b);
        } : function (b, d, f) {
          b.$watch(f.ngValue, function (b) {
            a(d, f, b);
          });
        };
      }
    };
  },
      Re = ["$compile", function (a) {
    return {
      restrict: "AC",
      compile: function compile(b) {
        a.$$addBindingClass(b);
        return function (b, c, e) {
          a.$$addBindingInfo(c, e.ngBind);
          c = c[0];
          b.$watch(e.ngBind, function (a) {
            c.textContent = ic(a);
          });
        };
      }
    };
  }],
      Te = ["$interpolate", "$compile", function (a, b) {
    return {
      compile: function compile(d) {
        b.$$addBindingClass(d);
        return function (c, d, f) {
          c = a(d.attr(f.$attr.ngBindTemplate));
          b.$$addBindingInfo(d, c.expressions);
          d = d[0];
          f.$observe("ngBindTemplate", function (a) {
            d.textContent = z(a) ? "" : a;
          });
        };
      }
    };
  }],
      Se = ["$sce", "$parse", "$compile", function (a, b, d) {
    return {
      restrict: "A",
      compile: function compile(c, e) {
        var f = b(e.ngBindHtml),
            g = b(e.ngBindHtml, function (b) {
          return a.valueOf(b);
        });
        d.$$addBindingClass(c);
        return function (b, c, e) {
          d.$$addBindingInfo(c, e.ngBindHtml);
          b.$watch(g, function () {
            var d = f(b);
            c.html(a.getTrustedHtml(d) || "");
          });
        };
      }
    };
  }],
      rf = ia({
    restrict: "A",
    require: "ngModel",
    link: function link(a, b, d, c) {
      c.$viewChangeListeners.push(function () {
        a.$eval(d.ngChange);
      });
    }
  }),
      Ue = Kc("", !0),
      We = Kc("Odd", 0),
      Ve = Kc("Even", 1),
      Xe = Ra({
    compile: function compile(a, b) {
      b.$set("ngCloak", void 0);
      a.removeClass("ng-cloak");
    }
  }),
      Ye = [function () {
    return {
      restrict: "A",
      scope: !0,
      controller: "@",
      priority: 500
    };
  }],
      cd = {},
      vh = {
    blur: !0,
    focus: !0
  };

  r("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "), function (a) {
    var b = wa("ng-" + a);
    cd[b] = ["$parse", "$rootScope", "$exceptionHandler", function (d, c, e) {
      return qd(d, c, e, b, a, vh[a]);
    }];
  });

  var af = ["$animate", "$compile", function (a, b) {
    return {
      multiElement: !0,
      transclude: "element",
      priority: 600,
      terminal: !0,
      restrict: "A",
      $$tlb: !0,
      link: function link(d, c, e, f, g) {
        var k, h, l;
        d.$watch(e.ngIf, function (d) {
          d ? h || g(function (d, f) {
            h = f;
            d[d.length++] = b.$$createComment("end ngIf", e.ngIf);
            k = {
              clone: d
            };
            a.enter(d, c.parent(), c);
          }) : (l && (l.remove(), l = null), h && (h.$destroy(), h = null), k && (l = tb(k.clone), a.leave(l).done(function (a) {
            !1 !== a && (l = null);
          }), k = null));
        });
      }
    };
  }],
      bf = ["$templateRequest", "$anchorScroll", "$animate", function (a, b, d) {
    return {
      restrict: "ECA",
      priority: 400,
      terminal: !0,
      transclude: "element",
      controller: ca.noop,
      compile: function compile(c, e) {
        var f = e.ngInclude || e.src,
            g = e.onload || "",
            k = e.autoscroll;
        return function (c, e, m, p, n) {
          var r = 0,
              q,
              t,
              x,
              v = function v() {
            t && (t.remove(), t = null);
            q && (q.$destroy(), q = null);
            x && (d.leave(x).done(function (a) {
              !1 !== a && (t = null);
            }), t = x, x = null);
          };

          c.$watch(f, function (f) {
            var m = function m(a) {
              !1 === a || !w(k) || k && !c.$eval(k) || b();
            },
                t = ++r;

            f ? (a(f, !0).then(function (a) {
              if (!c.$$destroyed && t === r) {
                var b = c.$new();
                p.template = a;
                a = n(b, function (a) {
                  v();
                  d.enter(a, null, e).done(m);
                });
                q = b;
                x = a;
                q.$emit("$includeContentLoaded", f);
                c.$eval(g);
              }
            }, function () {
              c.$$destroyed || t !== r || (v(), c.$emit("$includeContentError", f));
            }), c.$emit("$includeContentRequested", f)) : (v(), p.template = null);
          });
        };
      }
    };
  }],
      uf = ["$compile", function (a) {
    return {
      restrict: "ECA",
      priority: -400,
      require: "ngInclude",
      link: function link(b, d, c, e) {
        la.call(d[0]).match(/SVG/) ? (d.empty(), a(ed(e.template, C.document).childNodes)(b, function (a) {
          d.append(a);
        }, {
          futureParentElement: d
        })) : (d.html(e.template), a(d.contents())(b));
      }
    };
  }],
      cf = Ra({
    priority: 450,
    compile: function compile() {
      return {
        pre: function pre(a, b, d) {
          a.$eval(d.ngInit);
        }
      };
    }
  }),
      qf = function qf() {
    return {
      restrict: "A",
      priority: 100,
      require: "ngModel",
      link: function link(a, b, d, c) {
        var e = d.ngList || ", ",
            f = "false" !== d.ngTrim,
            g = f ? U(e) : e;
        c.$parsers.push(function (a) {
          if (!z(a)) {
            var b = [];
            a && r(a.split(g), function (a) {
              a && b.push(f ? U(a) : a);
            });
            return b;
          }
        });
        c.$formatters.push(function (a) {
          if (H(a)) return a.join(e);
        });

        c.$isEmpty = function (a) {
          return !a || !a.length;
        };
      }
    };
  },
      mb = "ng-valid",
      $d = "ng-invalid",
      Za = "ng-pristine",
      Vb = "ng-dirty",
      ob = F("ngModel");

  Rb.$inject = "$scope $exceptionHandler $attrs $element $parse $animate $timeout $q $interpolate".split(" ");
  Rb.prototype = {
    $$initGetterSetters: function $$initGetterSetters() {
      if (this.$options.getOption("getterSetter")) {
        var a = this.$$parse(this.$$attr.ngModel + "()"),
            b = this.$$parse(this.$$attr.ngModel + "($$$p)");

        this.$$ngModelGet = function (b) {
          var c = this.$$parsedNgModel(b);
          B(c) && (c = a(b));
          return c;
        };

        this.$$ngModelSet = function (a, c) {
          B(this.$$parsedNgModel(a)) ? b(a, {
            $$$p: c
          }) : this.$$parsedNgModelAssign(a, c);
        };
      } else if (!this.$$parsedNgModel.assign) throw ob("nonassign", this.$$attr.ngModel, za(this.$$element));
    },
    $render: E,
    $isEmpty: function $isEmpty(a) {
      return z(a) || "" === a || null === a || a !== a;
    },
    $$updateEmptyClasses: function $$updateEmptyClasses(a) {
      this.$isEmpty(a) ? (this.$$animate.removeClass(this.$$element, "ng-not-empty"), this.$$animate.addClass(this.$$element, "ng-empty")) : (this.$$animate.removeClass(this.$$element, "ng-empty"), this.$$animate.addClass(this.$$element, "ng-not-empty"));
    },
    $setPristine: function $setPristine() {
      this.$dirty = !1;
      this.$pristine = !0;
      this.$$animate.removeClass(this.$$element, Vb);
      this.$$animate.addClass(this.$$element, Za);
    },
    $setDirty: function $setDirty() {
      this.$dirty = !0;
      this.$pristine = !1;
      this.$$animate.removeClass(this.$$element, Za);
      this.$$animate.addClass(this.$$element, Vb);
      this.$$parentForm.$setDirty();
    },
    $setUntouched: function $setUntouched() {
      this.$touched = !1;
      this.$untouched = !0;
      this.$$animate.setClass(this.$$element, "ng-untouched", "ng-touched");
    },
    $setTouched: function $setTouched() {
      this.$touched = !0;
      this.$untouched = !1;
      this.$$animate.setClass(this.$$element, "ng-touched", "ng-untouched");
    },
    $rollbackViewValue: function $rollbackViewValue() {
      this.$$timeout.cancel(this.$$pendingDebounce);
      this.$viewValue = this.$$lastCommittedViewValue;
      this.$render();
    },
    $validate: function $validate() {
      if (!X(this.$modelValue)) {
        var a = this.$$lastCommittedViewValue,
            b = this.$$rawModelValue,
            d = this.$valid,
            c = this.$modelValue,
            e = this.$options.getOption("allowInvalid"),
            f = this;
        this.$$runValidators(b, a, function (a) {
          e || d === a || (f.$modelValue = a ? b : void 0, f.$modelValue !== c && f.$$writeModelToScope());
        });
      }
    },
    $$runValidators: function $$runValidators(a, b, d) {
      function c() {
        var c = !0;
        r(h.$validators, function (d, e) {
          var g = Boolean(d(a, b));
          c = c && g;
          f(e, g);
        });
        return c ? !0 : (r(h.$asyncValidators, function (a, b) {
          f(b, null);
        }), !1);
      }

      function e() {
        var c = [],
            d = !0;
        r(h.$asyncValidators, function (e, g) {
          var h = e(a, b);
          if (!h || !B(h.then)) throw ob("nopromise", h);
          f(g, void 0);
          c.push(h.then(function () {
            f(g, !0);
          }, function () {
            d = !1;
            f(g, !1);
          }));
        });
        c.length ? h.$$q.all(c).then(function () {
          g(d);
        }, E) : g(!0);
      }

      function f(a, b) {
        k === h.$$currentValidationRunId && h.$setValidity(a, b);
      }

      function g(a) {
        k === h.$$currentValidationRunId && d(a);
      }

      this.$$currentValidationRunId++;
      var k = this.$$currentValidationRunId,
          h = this;
      (function () {
        var a = h.$$parserName;
        if (z(h.$$parserValid)) f(a, null);else return h.$$parserValid || (r(h.$validators, function (a, b) {
          f(b, null);
        }), r(h.$asyncValidators, function (a, b) {
          f(b, null);
        })), f(a, h.$$parserValid), h.$$parserValid;
        return !0;
      })() ? c() ? e() : g(!1) : g(!1);
    },
    $commitViewValue: function $commitViewValue() {
      var a = this.$viewValue;
      this.$$timeout.cancel(this.$$pendingDebounce);
      if (this.$$lastCommittedViewValue !== a || "" === a && this.$$hasNativeValidators) this.$$updateEmptyClasses(a), this.$$lastCommittedViewValue = a, this.$pristine && this.$setDirty(), this.$$parseAndValidate();
    },
    $$parseAndValidate: function $$parseAndValidate() {
      var a = this.$$lastCommittedViewValue,
          b = this;
      this.$$parserValid = z(a) ? void 0 : !0;
      this.$setValidity(this.$$parserName, null);
      this.$$parserName = "parse";
      if (this.$$parserValid) for (var d = 0; d < this.$parsers.length; d++) {
        if (a = this.$parsers[d](a), z(a)) {
          this.$$parserValid = !1;
          break;
        }
      }
      X(this.$modelValue) && (this.$modelValue = this.$$ngModelGet(this.$$scope));
      var c = this.$modelValue,
          e = this.$options.getOption("allowInvalid");
      this.$$rawModelValue = a;
      e && (this.$modelValue = a, b.$modelValue !== c && b.$$writeModelToScope());
      this.$$runValidators(a, this.$$lastCommittedViewValue, function (d) {
        e || (b.$modelValue = d ? a : void 0, b.$modelValue !== c && b.$$writeModelToScope());
      });
    },
    $$writeModelToScope: function $$writeModelToScope() {
      this.$$ngModelSet(this.$$scope, this.$modelValue);
      r(this.$viewChangeListeners, function (a) {
        try {
          a();
        } catch (b) {
          this.$$exceptionHandler(b);
        }
      }, this);
    },
    $setViewValue: function $setViewValue(a, b) {
      this.$viewValue = a;
      this.$options.getOption("updateOnDefault") && this.$$debounceViewValueCommit(b);
    },
    $$debounceViewValueCommit: function $$debounceViewValueCommit(a) {
      var b = this.$options.getOption("debounce");
      W(b[a]) ? b = b[a] : W(b["default"]) && -1 === this.$options.getOption("updateOn").indexOf(a) ? b = b["default"] : W(b["*"]) && (b = b["*"]);
      this.$$timeout.cancel(this.$$pendingDebounce);
      var d = this;
      0 < b ? this.$$pendingDebounce = this.$$timeout(function () {
        d.$commitViewValue();
      }, b) : this.$$rootScope.$$phase ? this.$commitViewValue() : this.$$scope.$apply(function () {
        d.$commitViewValue();
      });
    },
    $overrideModelOptions: function $overrideModelOptions(a) {
      this.$options = this.$options.createChild(a);
      this.$$setUpdateOnEvents();
    },
    $processModelValue: function $processModelValue() {
      var a = this.$$format();
      this.$viewValue !== a && (this.$$updateEmptyClasses(a), this.$viewValue = this.$$lastCommittedViewValue = a, this.$render(), this.$$runValidators(this.$modelValue, this.$viewValue, E));
    },
    $$format: function $$format() {
      for (var a = this.$formatters, b = a.length, d = this.$modelValue; b--;) {
        d = a[b](d);
      }

      return d;
    },
    $$setModelValue: function $$setModelValue(a) {
      this.$modelValue = this.$$rawModelValue = a;
      this.$$parserValid = void 0;
      this.$processModelValue();
    },
    $$setUpdateOnEvents: function $$setUpdateOnEvents() {
      this.$$updateEvents && this.$$element.off(this.$$updateEvents, this.$$updateEventHandler);
      if (this.$$updateEvents = this.$options.getOption("updateOn")) this.$$element.on(this.$$updateEvents, this.$$updateEventHandler);
    },
    $$updateEventHandler: function $$updateEventHandler(a) {
      this.$$debounceViewValueCommit(a && a.type);
    }
  };
  ae({
    clazz: Rb,
    set: function set(a, b) {
      a[b] = !0;
    },
    unset: function unset(a, b) {
      delete a[b];
    }
  });
  var pf = ["$rootScope", function (a) {
    return {
      restrict: "A",
      require: ["ngModel", "^?form", "^?ngModelOptions"],
      controller: Rb,
      priority: 1,
      compile: function compile(b) {
        b.addClass(Za).addClass("ng-untouched").addClass(mb);
        return {
          pre: function pre(a, b, e, f) {
            var g = f[0];
            b = f[1] || g.$$parentForm;
            if (f = f[2]) g.$options = f.$options;
            g.$$initGetterSetters();
            b.$addControl(g);
            e.$observe("name", function (a) {
              g.$name !== a && g.$$parentForm.$$renameControl(g, a);
            });
            a.$on("$destroy", function () {
              g.$$parentForm.$removeControl(g);
            });
          },
          post: function post(b, c, e, f) {
            function g() {
              k.$setTouched();
            }

            var k = f[0];
            k.$$setUpdateOnEvents();
            c.on("blur", function () {
              k.$touched || (a.$$phase ? b.$evalAsync(g) : b.$apply(g));
            });
          }
        };
      }
    };
  }],
      Sb,
      wh = /(\s+|^)default(\s+|$)/;
  Lc.prototype = {
    getOption: function getOption(a) {
      return this.$$options[a];
    },
    createChild: function createChild(a) {
      var b = !1;
      a = S({}, a);
      r(a, function (d, c) {
        "$inherit" === d ? "*" === c ? b = !0 : (a[c] = this.$$options[c], "updateOn" === c && (a.updateOnDefault = this.$$options.updateOnDefault)) : "updateOn" === c && (a.updateOnDefault = !1, a[c] = U(d.replace(wh, function () {
          a.updateOnDefault = !0;
          return " ";
        })));
      }, this);
      b && (delete a["*"], ge(a, this.$$options));
      ge(a, Sb.$$options);
      return new Lc(a);
    }
  };
  Sb = new Lc({
    updateOn: "",
    updateOnDefault: !0,
    debounce: 0,
    getterSetter: !1,
    allowInvalid: !1,
    timezone: null
  });

  var tf = function tf() {
    function a(a, d) {
      this.$$attrs = a;
      this.$$scope = d;
    }

    a.$inject = ["$attrs", "$scope"];
    a.prototype = {
      $onInit: function $onInit() {
        var a = this.parentCtrl ? this.parentCtrl.$options : Sb,
            d = this.$$scope.$eval(this.$$attrs.ngModelOptions);
        this.$options = a.createChild(d);
      }
    };
    return {
      restrict: "A",
      priority: 10,
      require: {
        parentCtrl: "?^^ngModelOptions"
      },
      bindToController: !0,
      controller: a
    };
  },
      df = Ra({
    terminal: !0,
    priority: 1E3
  }),
      xh = F("ngOptions"),
      yh = /^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
      nf = ["$compile", "$document", "$parse", function (a, b, d) {
    function c(a, b, c) {
      function e(a, b, c, d, f) {
        this.selectValue = a;
        this.viewValue = b;
        this.label = c;
        this.group = d;
        this.disabled = f;
      }

      function f(a) {
        var b;
        if (!r && ya(a)) b = a;else {
          b = [];

          for (var c in a) {
            a.hasOwnProperty(c) && "$" !== c.charAt(0) && b.push(c);
          }
        }
        return b;
      }

      var p = a.match(yh);
      if (!p) throw xh("iexp", a, za(b));
      var n = p[5] || p[7],
          r = p[6];
      a = / as /.test(p[0]) && p[1];
      var q = p[9];
      b = d(p[2] ? p[1] : n);

      var t = a && d(a) || b,
          w = q && d(q),
          v = q ? function (a, b) {
        return w(c, b);
      } : function (a) {
        return La(a);
      },
          x = function x(a, b) {
        return v(a, A(a, b));
      },
          z = d(p[2] || p[1]),
          y = d(p[3] || ""),
          J = d(p[4] || ""),
          I = d(p[8]),
          B = {},
          A = r ? function (a, b) {
        B[r] = b;
        B[n] = a;
        return B;
      } : function (a) {
        B[n] = a;
        return B;
      };

      return {
        trackBy: q,
        getTrackByValue: x,
        getWatchables: d(I, function (a) {
          var b = [];
          a = a || [];

          for (var d = f(a), e = d.length, g = 0; g < e; g++) {
            var k = a === d ? g : d[g],
                l = a[k],
                k = A(l, k),
                l = v(l, k);
            b.push(l);
            if (p[2] || p[1]) l = z(c, k), b.push(l);
            p[4] && (k = J(c, k), b.push(k));
          }

          return b;
        }),
        getOptions: function getOptions() {
          for (var a = [], b = {}, d = I(c) || [], g = f(d), k = g.length, n = 0; n < k; n++) {
            var p = d === g ? n : g[n],
                r = A(d[p], p),
                s = t(c, r),
                p = v(s, r),
                w = z(c, r),
                B = y(c, r),
                r = J(c, r),
                s = new e(p, s, w, B, r);
            a.push(s);
            b[p] = s;
          }

          return {
            items: a,
            selectValueMap: b,
            getOptionFromViewValue: function getOptionFromViewValue(a) {
              return b[x(a)];
            },
            getViewValueFromOption: function getViewValueFromOption(a) {
              return q ? Ia(a.viewValue) : a.viewValue;
            }
          };
        }
      };
    }

    var e = C.document.createElement("option"),
        f = C.document.createElement("optgroup");
    return {
      restrict: "A",
      terminal: !0,
      require: ["select", "ngModel"],
      link: {
        pre: function pre(a, b, c, d) {
          d[0].registerOption = E;
        },
        post: function post(d, k, h, l) {
          function m(a) {
            var b = (a = v.getOptionFromViewValue(a)) && a.element;
            b && !b.selected && (b.selected = !0);
            return a;
          }

          function p(a, b) {
            a.element = b;
            b.disabled = a.disabled;
            a.label !== b.label && (b.label = a.label, b.textContent = a.label);
            b.value = a.selectValue;
          }

          var n = l[0],
              q = l[1],
              z = h.multiple;
          l = 0;

          for (var t = k.children(), B = t.length; l < B; l++) {
            if ("" === t[l].value) {
              n.hasEmptyOption = !0;
              n.emptyOption = t.eq(l);
              break;
            }
          }

          k.empty();
          l = !!n.emptyOption;
          x(e.cloneNode(!1)).val("?");
          var v,
              A = c(h.ngOptions, k, d),
              C = b[0].createDocumentFragment();

          n.generateUnknownOptionValue = function (a) {
            return "?";
          };

          z ? (n.writeValue = function (a) {
            if (v) {
              var b = a && a.map(m) || [];
              v.items.forEach(function (a) {
                a.element.selected && -1 === Array.prototype.indexOf.call(b, a) && (a.element.selected = !1);
              });
            }
          }, n.readValue = function () {
            var a = k.val() || [],
                b = [];
            r(a, function (a) {
              (a = v.selectValueMap[a]) && !a.disabled && b.push(v.getViewValueFromOption(a));
            });
            return b;
          }, A.trackBy && d.$watchCollection(function () {
            if (H(q.$viewValue)) return q.$viewValue.map(function (a) {
              return A.getTrackByValue(a);
            });
          }, function () {
            q.$render();
          })) : (n.writeValue = function (a) {
            if (v) {
              var b = k[0].options[k[0].selectedIndex],
                  c = v.getOptionFromViewValue(a);
              b && b.removeAttribute("selected");
              c ? (k[0].value !== c.selectValue && (n.removeUnknownOption(), k[0].value = c.selectValue, c.element.selected = !0), c.element.setAttribute("selected", "selected")) : n.selectUnknownOrEmptyOption(a);
            }
          }, n.readValue = function () {
            var a = v.selectValueMap[k.val()];
            return a && !a.disabled ? (n.unselectEmptyOption(), n.removeUnknownOption(), v.getViewValueFromOption(a)) : null;
          }, A.trackBy && d.$watch(function () {
            return A.getTrackByValue(q.$viewValue);
          }, function () {
            q.$render();
          }));
          l && (a(n.emptyOption)(d), k.prepend(n.emptyOption), 8 === n.emptyOption[0].nodeType ? (n.hasEmptyOption = !1, n.registerOption = function (a, b) {
            "" === b.val() && (n.hasEmptyOption = !0, n.emptyOption = b, n.emptyOption.removeClass("ng-scope"), q.$render(), b.on("$destroy", function () {
              var a = n.$isEmptyOptionSelected();
              n.hasEmptyOption = !1;
              n.emptyOption = void 0;
              a && q.$render();
            }));
          }) : n.emptyOption.removeClass("ng-scope"));
          d.$watchCollection(A.getWatchables, function () {
            var a = v && n.readValue();
            if (v) for (var b = v.items.length - 1; 0 <= b; b--) {
              var c = v.items[b];
              w(c.group) ? Fb(c.element.parentNode) : Fb(c.element);
            }
            v = A.getOptions();
            var d = {};
            v.items.forEach(function (a) {
              var b;

              if (w(a.group)) {
                b = d[a.group];
                b || (b = f.cloneNode(!1), C.appendChild(b), b.label = null === a.group ? "null" : a.group, d[a.group] = b);
                var c = e.cloneNode(!1);
                b.appendChild(c);
                p(a, c);
              } else b = e.cloneNode(!1), C.appendChild(b), p(a, b);
            });
            k[0].appendChild(C);
            q.$render();
            q.$isEmpty(a) || (b = n.readValue(), (A.trackBy || z ? va(a, b) : a === b) || (q.$setViewValue(b), q.$render()));
          });
        }
      }
    };
  }],
      ef = ["$locale", "$interpolate", "$log", function (a, b, d) {
    var c = /{}/g,
        e = /^when(Minus)?(.+)$/;
    return {
      link: function link(f, g, k) {
        function h(a) {
          g.text(a || "");
        }

        var l = k.count,
            m = k.$attr.when && g.attr(k.$attr.when),
            p = k.offset || 0,
            n = f.$eval(m) || {},
            q = {},
            w = b.startSymbol(),
            t = b.endSymbol(),
            x = w + l + "-" + p + t,
            v = ca.noop,
            A;
        r(k, function (a, b) {
          var c = e.exec(b);
          c && (c = (c[1] ? "-" : "") + K(c[2]), n[c] = g.attr(k.$attr[b]));
        });
        r(n, function (a, d) {
          q[d] = b(a.replace(c, x));
        });
        f.$watch(l, function (b) {
          var c = parseFloat(b),
              e = X(c);
          e || c in n || (c = a.pluralCat(c - p));
          c === A || e && X(A) || (v(), e = q[c], z(e) ? (null != b && d.debug("ngPluralize: no rule defined for '" + c + "' in " + m), v = E, h()) : v = f.$watch(e, h), A = c);
        });
      }
    };
  }],
      qe = F("ngRef"),
      ff = ["$parse", function (a) {
    return {
      priority: -1,
      restrict: "A",
      compile: function compile(b, d) {
        var c = wa(ua(b)),
            e = a(d.ngRef),
            f = e.assign || function () {
          throw qe("nonassign", d.ngRef);
        };

        return function (a, b, h) {
          var l;
          if (h.hasOwnProperty("ngRefRead")) {
            if ("$element" === h.ngRefRead) l = b;else {
              if (l = b.data("$" + h.ngRefRead + "Controller"), !l) throw qe("noctrl", h.ngRefRead, d.ngRef);
            }
          } else l = b.data("$" + c + "Controller");
          l = l || b;
          f(a, l);
          b.on("$destroy", function () {
            e(a) === l && f(a, null);
          });
        };
      }
    };
  }],
      gf = ["$parse", "$animate", "$compile", function (a, b, d) {
    var c = F("ngRepeat"),
        e = function e(a, b, c, d, _e2, f, g) {
      a[c] = d;
      _e2 && (a[_e2] = f);
      a.$index = b;
      a.$first = 0 === b;
      a.$last = b === g - 1;
      a.$middle = !(a.$first || a.$last);
      a.$odd = !(a.$even = 0 === (b & 1));
    },
        f = function f(a, b, c) {
      return La(c);
    },
        g = function g(a, b) {
      return b;
    };

    return {
      restrict: "A",
      multiElement: !0,
      transclude: "element",
      priority: 1E3,
      terminal: !0,
      $$tlb: !0,
      compile: function compile(k, h) {
        var l = h.ngRepeat,
            m = d.$$createComment("end ngRepeat", l),
            p = l.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);
        if (!p) throw c("iexp", l);
        var n = p[1],
            q = p[2],
            w = p[3],
            t = p[4],
            p = n.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/);
        if (!p) throw c("iidexp", n);
        var x = p[3] || p[1],
            v = p[2];
        if (w && (!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(w) || /^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(w))) throw c("badident", w);
        var z;

        if (t) {
          var A = {
            $id: La
          },
              y = a(t);

          z = function z(a, b, c, d) {
            v && (A[v] = b);
            A[x] = c;
            A.$index = d;
            return y(a, A);
          };
        }

        return function (a, d, h, k, n) {
          var p = T();
          a.$watchCollection(q, function (h) {
            var k,
                q,
                t = d[0],
                s,
                y = T(),
                B,
                C,
                E,
                D,
                H,
                F,
                K;
            w && (a[w] = h);
            if (ya(h)) H = h, q = z || f;else for (K in q = z || g, H = [], h) {
              ta.call(h, K) && "$" !== K.charAt(0) && H.push(K);
            }
            B = H.length;
            K = Array(B);

            for (k = 0; k < B; k++) {
              if (C = h === H ? k : H[k], E = h[C], D = q(a, C, E, k), p[D]) F = p[D], delete p[D], y[D] = F, K[k] = F;else {
                if (y[D]) throw r(K, function (a) {
                  a && a.scope && (p[a.id] = a);
                }), c("dupes", l, D, E);
                K[k] = {
                  id: D,
                  scope: void 0,
                  clone: void 0
                };
                y[D] = !0;
              }
            }

            A && (A[x] = void 0);

            for (s in p) {
              F = p[s];
              D = tb(F.clone);
              b.leave(D);
              if (D[0].parentNode) for (k = 0, q = D.length; k < q; k++) {
                D[k].$$NG_REMOVED = !0;
              }
              F.scope.$destroy();
            }

            for (k = 0; k < B; k++) {
              if (C = h === H ? k : H[k], E = h[C], F = K[k], F.scope) {
                s = t;

                do {
                  s = s.nextSibling;
                } while (s && s.$$NG_REMOVED);

                F.clone[0] !== s && b.move(tb(F.clone), null, t);
                t = F.clone[F.clone.length - 1];
                e(F.scope, k, x, E, v, C, B);
              } else n(function (a, c) {
                F.scope = c;
                var d = m.cloneNode(!1);
                a[a.length++] = d;
                b.enter(a, null, t);
                t = d;
                F.clone = a;
                y[F.id] = F;
                e(F.scope, k, x, E, v, C, B);
              });
            }

            p = y;
          });
        };
      }
    };
  }],
      hf = ["$animate", function (a) {
    return {
      restrict: "A",
      multiElement: !0,
      link: function link(b, d, c) {
        b.$watch(c.ngShow, function (b) {
          a[b ? "removeClass" : "addClass"](d, "ng-hide", {
            tempClasses: "ng-hide-animate"
          });
        });
      }
    };
  }],
      $e = ["$animate", function (a) {
    return {
      restrict: "A",
      multiElement: !0,
      link: function link(b, d, c) {
        b.$watch(c.ngHide, function (b) {
          a[b ? "addClass" : "removeClass"](d, "ng-hide", {
            tempClasses: "ng-hide-animate"
          });
        });
      }
    };
  }],
      jf = Ra(function (a, b, d) {
    a.$watchCollection(d.ngStyle, function (a, d) {
      d && a !== d && r(d, function (a, c) {
        b.css(c, "");
      });
      a && b.css(a);
    });
  }),
      kf = ["$animate", "$compile", function (a, b) {
    return {
      require: "ngSwitch",
      controller: ["$scope", function () {
        this.cases = {};
      }],
      link: function link(d, c, e, f) {
        var g = [],
            k = [],
            h = [],
            l = [],
            m = function m(a, b) {
          return function (c) {
            !1 !== c && a.splice(b, 1);
          };
        };

        d.$watch(e.ngSwitch || e.on, function (c) {
          for (var d, e; h.length;) {
            a.cancel(h.pop());
          }

          d = 0;

          for (e = l.length; d < e; ++d) {
            var q = tb(k[d].clone);
            l[d].$destroy();
            (h[d] = a.leave(q)).done(m(h, d));
          }

          k.length = 0;
          l.length = 0;
          (g = f.cases["!" + c] || f.cases["?"]) && r(g, function (c) {
            c.transclude(function (d, e) {
              l.push(e);
              var f = c.element;
              d[d.length++] = b.$$createComment("end ngSwitchWhen");
              k.push({
                clone: d
              });
              a.enter(d, f.parent(), f);
            });
          });
        });
      }
    };
  }],
      lf = Ra({
    transclude: "element",
    priority: 1200,
    require: "^ngSwitch",
    multiElement: !0,
    link: function link(a, b, d, c, e) {
      a = d.ngSwitchWhen.split(d.ngSwitchWhenSeparator).sort().filter(function (a, b, c) {
        return c[b - 1] !== a;
      });
      r(a, function (a) {
        c.cases["!" + a] = c.cases["!" + a] || [];
        c.cases["!" + a].push({
          transclude: e,
          element: b
        });
      });
    }
  }),
      mf = Ra({
    transclude: "element",
    priority: 1200,
    require: "^ngSwitch",
    multiElement: !0,
    link: function link(a, b, d, c, e) {
      c.cases["?"] = c.cases["?"] || [];
      c.cases["?"].push({
        transclude: e,
        element: b
      });
    }
  }),
      zh = F("ngTransclude"),
      of = ["$compile", function (a) {
    return {
      restrict: "EAC",
      compile: function compile(b) {
        var d = a(b.contents());
        b.empty();
        return function (a, b, f, g, k) {
          function h() {
            d(a, function (a) {
              b.append(a);
            });
          }

          if (!k) throw zh("orphan", za(b));
          f.ngTransclude === f.$attr.ngTransclude && (f.ngTransclude = "");
          f = f.ngTransclude || f.ngTranscludeSlot;
          k(function (a, c) {
            var d;
            if (d = a.length) a: {
              d = 0;

              for (var f = a.length; d < f; d++) {
                var g = a[d];

                if (g.nodeType !== Pa || g.nodeValue.trim()) {
                  d = !0;
                  break a;
                }
              }

              d = void 0;
            }
            d ? b.append(a) : (h(), c.$destroy());
          }, null, f);
          f && !k.isSlotFilled(f) && h();
        };
      }
    };
  }],
      Oe = ["$templateCache", function (a) {
    return {
      restrict: "E",
      terminal: !0,
      compile: function compile(b, d) {
        "text/ng-template" === d.type && a.put(d.id, b[0].text);
      }
    };
  }],
      Ah = {
    $setViewValue: E,
    $render: E
  },
      Bh = ["$element", "$scope", function (a, b) {
    function d() {
      g || (g = !0, b.$$postDigest(function () {
        g = !1;
        e.ngModelCtrl.$render();
      }));
    }

    function c(a) {
      k || (k = !0, b.$$postDigest(function () {
        b.$$destroyed || (k = !1, e.ngModelCtrl.$setViewValue(e.readValue()), a && e.ngModelCtrl.$render());
      }));
    }

    var e = this,
        f = new Hb();
    e.selectValueMap = {};
    e.ngModelCtrl = Ah;
    e.multiple = !1;
    e.unknownOption = x(C.document.createElement("option"));
    e.hasEmptyOption = !1;
    e.emptyOption = void 0;

    e.renderUnknownOption = function (b) {
      b = e.generateUnknownOptionValue(b);
      e.unknownOption.val(b);
      a.prepend(e.unknownOption);
      Oa(e.unknownOption, !0);
      a.val(b);
    };

    e.updateUnknownOption = function (b) {
      b = e.generateUnknownOptionValue(b);
      e.unknownOption.val(b);
      Oa(e.unknownOption, !0);
      a.val(b);
    };

    e.generateUnknownOptionValue = function (a) {
      return "? " + La(a) + " ?";
    };

    e.removeUnknownOption = function () {
      e.unknownOption.parent() && e.unknownOption.remove();
    };

    e.selectEmptyOption = function () {
      e.emptyOption && (a.val(""), Oa(e.emptyOption, !0));
    };

    e.unselectEmptyOption = function () {
      e.hasEmptyOption && Oa(e.emptyOption, !1);
    };

    b.$on("$destroy", function () {
      e.renderUnknownOption = E;
    });

    e.readValue = function () {
      var b = a.val(),
          b = b in e.selectValueMap ? e.selectValueMap[b] : b;
      return e.hasOption(b) ? b : null;
    };

    e.writeValue = function (b) {
      var c = a[0].options[a[0].selectedIndex];
      c && Oa(x(c), !1);
      e.hasOption(b) ? (e.removeUnknownOption(), c = La(b), a.val(c in e.selectValueMap ? c : b), Oa(x(a[0].options[a[0].selectedIndex]), !0)) : e.selectUnknownOrEmptyOption(b);
    };

    e.addOption = function (a, b) {
      if (8 !== b[0].nodeType) {
        Ja(a, '"option value"');
        "" === a && (e.hasEmptyOption = !0, e.emptyOption = b);
        var c = f.get(a) || 0;
        f.set(a, c + 1);
        d();
      }
    };

    e.removeOption = function (a) {
      var b = f.get(a);
      b && (1 === b ? (f.delete(a), "" === a && (e.hasEmptyOption = !1, e.emptyOption = void 0)) : f.set(a, b - 1));
    };

    e.hasOption = function (a) {
      return !!f.get(a);
    };

    e.$hasEmptyOption = function () {
      return e.hasEmptyOption;
    };

    e.$isUnknownOptionSelected = function () {
      return a[0].options[0] === e.unknownOption[0];
    };

    e.$isEmptyOptionSelected = function () {
      return e.hasEmptyOption && a[0].options[a[0].selectedIndex] === e.emptyOption[0];
    };

    e.selectUnknownOrEmptyOption = function (a) {
      null == a && e.emptyOption ? (e.removeUnknownOption(), e.selectEmptyOption()) : e.unknownOption.parent().length ? e.updateUnknownOption(a) : e.renderUnknownOption(a);
    };

    var g = !1,
        k = !1;

    e.registerOption = function (a, b, f, g, k) {
      if (f.$attr.ngValue) {
        var q, r;
        f.$observe("value", function (a) {
          var d,
              f = b.prop("selected");
          w(r) && (e.removeOption(q), delete e.selectValueMap[r], d = !0);
          r = La(a);
          q = a;
          e.selectValueMap[r] = a;
          e.addOption(a, b);
          b.attr("value", r);
          d && f && c();
        });
      } else g ? f.$observe("value", function (a) {
        e.readValue();
        var d,
            f = b.prop("selected");
        w(q) && (e.removeOption(q), d = !0);
        q = a;
        e.addOption(a, b);
        d && f && c();
      }) : k ? a.$watch(k, function (a, d) {
        f.$set("value", a);
        var g = b.prop("selected");
        d !== a && e.removeOption(d);
        e.addOption(a, b);
        d && g && c();
      }) : e.addOption(f.value, b);

      f.$observe("disabled", function (a) {
        if ("true" === a || a && b.prop("selected")) e.multiple ? c(!0) : (e.ngModelCtrl.$setViewValue(null), e.ngModelCtrl.$render());
      });
      b.on("$destroy", function () {
        var a = e.readValue(),
            b = f.value;
        e.removeOption(b);
        d();
        (e.multiple && a && -1 !== a.indexOf(b) || a === b) && c(!0);
      });
    };
  }],
      Pe = function Pe() {
    return {
      restrict: "E",
      require: ["select", "?ngModel"],
      controller: Bh,
      priority: 1,
      link: {
        pre: function pre(a, b, d, c) {
          var e = c[0],
              f = c[1];

          if (f) {
            if (e.ngModelCtrl = f, b.on("change", function () {
              e.removeUnknownOption();
              a.$apply(function () {
                f.$setViewValue(e.readValue());
              });
            }), d.multiple) {
              e.multiple = !0;

              e.readValue = function () {
                var a = [];
                r(b.find("option"), function (b) {
                  b.selected && !b.disabled && (b = b.value, a.push(b in e.selectValueMap ? e.selectValueMap[b] : b));
                });
                return a;
              };

              e.writeValue = function (a) {
                r(b.find("option"), function (b) {
                  var c = !!a && (-1 !== Array.prototype.indexOf.call(a, b.value) || -1 !== Array.prototype.indexOf.call(a, e.selectValueMap[b.value]));
                  c !== b.selected && Oa(x(b), c);
                });
              };

              var g,
                  k = NaN;
              a.$watch(function () {
                k !== f.$viewValue || va(g, f.$viewValue) || (g = ja(f.$viewValue), f.$render());
                k = f.$viewValue;
              });

              f.$isEmpty = function (a) {
                return !a || 0 === a.length;
              };
            }
          } else e.registerOption = E;
        },
        post: function post(a, b, d, c) {
          var e = c[1];

          if (e) {
            var f = c[0];

            e.$render = function () {
              f.writeValue(e.$viewValue);
            };
          }
        }
      }
    };
  },
      Qe = ["$interpolate", function (a) {
    return {
      restrict: "E",
      priority: 100,
      compile: function compile(b, d) {
        var c, e;
        w(d.ngValue) || (w(d.value) ? c = a(d.value, !0) : (e = a(b.text(), !0)) || d.$set("value", b.text()));
        return function (a, b, d) {
          var h = b.parent();
          (h = h.data("$selectController") || h.parent().data("$selectController")) && h.registerOption(a, b, d, c, e);
        };
      }
    };
  }],
      $c = ["$parse", function (a) {
    return {
      restrict: "A",
      require: "?ngModel",
      link: function link(b, d, c, e) {
        if (e) {
          var f = c.hasOwnProperty("required") || a(c.ngRequired)(b);
          c.ngRequired || (c.required = !0);

          e.$validators.required = function (a, b) {
            return !f || !e.$isEmpty(b);
          };

          c.$observe("required", function (a) {
            f !== a && (f = a, e.$validate());
          });
        }
      }
    };
  }],
      Zc = ["$parse", function (a) {
    return {
      restrict: "A",
      require: "?ngModel",
      compile: function compile(b, d) {
        var c, e;
        d.ngPattern && (c = d.ngPattern, e = "/" === d.ngPattern.charAt(0) && ie.test(d.ngPattern) ? function () {
          return d.ngPattern;
        } : a(d.ngPattern));
        return function (a, b, d, h) {
          if (h) {
            var l = d.pattern;
            d.ngPattern ? l = e(a) : c = d.pattern;
            var m = he(l, c, b);
            d.$observe("pattern", function (a) {
              var d = m;
              m = he(a, c, b);
              (d && d.toString()) !== (m && m.toString()) && h.$validate();
            });

            h.$validators.pattern = function (a, b) {
              return h.$isEmpty(b) || z(m) || m.test(b);
            };
          }
        };
      }
    };
  }],
      bd = ["$parse", function (a) {
    return {
      restrict: "A",
      require: "?ngModel",
      link: function link(b, d, c, e) {
        if (e) {
          var f = c.maxlength || a(c.ngMaxlength)(b),
              g = Tb(f);
          c.$observe("maxlength", function (a) {
            f !== a && (g = Tb(a), f = a, e.$validate());
          });

          e.$validators.maxlength = function (a, b) {
            return 0 > g || e.$isEmpty(b) || b.length <= g;
          };
        }
      }
    };
  }],
      ad = ["$parse", function (a) {
    return {
      restrict: "A",
      require: "?ngModel",
      link: function link(b, d, c, e) {
        if (e) {
          var f = c.minlength || a(c.ngMinlength)(b),
              g = Tb(f) || -1;
          c.$observe("minlength", function (a) {
            f !== a && (g = Tb(a) || -1, f = a, e.$validate());
          });

          e.$validators.minlength = function (a, b) {
            return e.$isEmpty(b) || b.length >= g;
          };
        }
      }
    };
  }];

  C.angular.bootstrap ? C.console && console.log("WARNING: Tried to load AngularJS more than once.") : (Fe(), Je(ca), ca.module("ngLocale", [], ["$provide", function (a) {
    function b(a) {
      a += "";
      var b = a.indexOf(".");
      return -1 == b ? 0 : a.length - b - 1;
    }

    a.value("$locale", {
      DATETIME_FORMATS: {
        AMPMS: ["AM", "PM"],
        DAY: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
        ERANAMES: ["Before Christ", "Anno Domini"],
        ERAS: ["BC", "AD"],
        FIRSTDAYOFWEEK: 6,
        MONTH: "January February March April May June July August September October November December".split(" "),
        SHORTDAY: "Sun Mon Tue Wed Thu Fri Sat".split(" "),
        SHORTMONTH: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
        STANDALONEMONTH: "January February March April May June July August September October November December".split(" "),
        WEEKENDRANGE: [5, 6],
        fullDate: "EEEE, MMMM d, y",
        longDate: "MMMM d, y",
        medium: "MMM d, y h:mm:ss a",
        mediumDate: "MMM d, y",
        mediumTime: "h:mm:ss a",
        "short": "M/d/yy h:mm a",
        shortDate: "M/d/yy",
        shortTime: "h:mm a"
      },
      NUMBER_FORMATS: {
        CURRENCY_SYM: "$",
        DECIMAL_SEP: ".",
        GROUP_SEP: ",",
        PATTERNS: [{
          gSize: 3,
          lgSize: 3,
          maxFrac: 3,
          minFrac: 0,
          minInt: 1,
          negPre: "-",
          negSuf: "",
          posPre: "",
          posSuf: ""
        }, {
          gSize: 3,
          lgSize: 3,
          maxFrac: 2,
          minFrac: 2,
          minInt: 1,
          negPre: "-\xA4",
          negSuf: "",
          posPre: "\xA4",
          posSuf: ""
        }]
      },
      id: "en-us",
      localeID: "en_US",
      pluralCat: function pluralCat(a, c) {
        var e = a | 0,
            f = c;
        void 0 === f && (f = Math.min(b(a), 3));
        Math.pow(10, f);
        return 1 == e && 0 == f ? "one" : "other";
      }
    });
  }]), x(function () {
    Ae(C.document, Uc);
  }));
})(window);

!window.angular.$$csp().noInlineStyle && window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>');function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

// ┌────────────────────────────────────────────────────────────────────┐ \\
// │ Raphaël 2.1.1 - JavaScript Vector Library                          │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Copyright © 2008-2012 Dmitry Baranovskiy (http://raphaeljs.com)    │ \\
// │ Copyright © 2008-2012 Sencha Labs (http://sencha.com)              │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Licensed under the MIT (http://raphaeljs.com/license.html) license.│ \\
// └────────────────────────────────────────────────────────────────────┘ \\
!function (a) {
  var b,
      c,
      d = "0.4.2",
      e = "hasOwnProperty",
      f = /[\.\/]/,
      g = "*",
      h = function h() {},
      i = function i(a, b) {
    return a - b;
  },
      j = {
    n: {}
  },
      k = function k(a, d) {
    a = String(a);
    var e,
        f = c,
        g = Array.prototype.slice.call(arguments, 2),
        h = k.listeners(a),
        j = 0,
        l = [],
        m = {},
        n = [],
        o = b;
    b = a, c = 0;

    for (var p = 0, q = h.length; q > p; p++) {
      "zIndex" in h[p] && (l.push(h[p].zIndex), h[p].zIndex < 0 && (m[h[p].zIndex] = h[p]));
    }

    for (l.sort(i); l[j] < 0;) {
      if (e = m[l[j++]], n.push(e.apply(d, g)), c) return c = f, n;
    }

    for (p = 0; q > p; p++) {
      if (e = h[p], "zIndex" in e) {
        if (e.zIndex == l[j]) {
          if (n.push(e.apply(d, g)), c) break;

          do {
            if (j++, e = m[l[j]], e && n.push(e.apply(d, g)), c) break;
          } while (e);
        } else m[e.zIndex] = e;
      } else if (n.push(e.apply(d, g)), c) break;
    }

    return c = f, b = o, n.length ? n : null;
  };

  k._events = j, k.listeners = function (a) {
    var b,
        c,
        d,
        e,
        h,
        i,
        k,
        l,
        m = a.split(f),
        n = j,
        o = [n],
        p = [];

    for (e = 0, h = m.length; h > e; e++) {
      for (l = [], i = 0, k = o.length; k > i; i++) {
        for (n = o[i].n, c = [n[m[e]], n[g]], d = 2; d--;) {
          b = c[d], b && (l.push(b), p = p.concat(b.f || []));
        }
      }

      o = l;
    }

    return p;
  }, k.on = function (a, b) {
    if (a = String(a), "function" != typeof b) return function () {};

    for (var c = a.split(f), d = j, e = 0, g = c.length; g > e; e++) {
      d = d.n, d = d.hasOwnProperty(c[e]) && d[c[e]] || (d[c[e]] = {
        n: {}
      });
    }

    for (d.f = d.f || [], e = 0, g = d.f.length; g > e; e++) {
      if (d.f[e] == b) return h;
    }

    return d.f.push(b), function (a) {
      +a == +a && (b.zIndex = +a);
    };
  }, k.f = function (a) {
    var b = [].slice.call(arguments, 1);
    return function () {
      k.apply(null, [a, null].concat(b).concat([].slice.call(arguments, 0)));
    };
  }, k.stop = function () {
    c = 1;
  }, k.nt = function (a) {
    return a ? new RegExp("(?:\\.|\\/|^)" + a + "(?:\\.|\\/|$)").test(b) : b;
  }, k.nts = function () {
    return b.split(f);
  }, k.off = k.unbind = function (a, b) {
    if (!a) return k._events = j = {
      n: {}
    }, void 0;
    var c,
        d,
        h,
        i,
        l,
        m,
        n,
        o = a.split(f),
        p = [j];

    for (i = 0, l = o.length; l > i; i++) {
      for (m = 0; m < p.length; m += h.length - 2) {
        if (h = [m, 1], c = p[m].n, o[i] != g) c[o[i]] && h.push(c[o[i]]);else for (d in c) {
          c[e](d) && h.push(c[d]);
        }
        p.splice.apply(p, h);
      }
    }

    for (i = 0, l = p.length; l > i; i++) {
      for (c = p[i]; c.n;) {
        if (b) {
          if (c.f) {
            for (m = 0, n = c.f.length; n > m; m++) {
              if (c.f[m] == b) {
                c.f.splice(m, 1);
                break;
              }
            }

            !c.f.length && delete c.f;
          }

          for (d in c.n) {
            if (c.n[e](d) && c.n[d].f) {
              var q = c.n[d].f;

              for (m = 0, n = q.length; n > m; m++) {
                if (q[m] == b) {
                  q.splice(m, 1);
                  break;
                }
              }

              !q.length && delete c.n[d].f;
            }
          }
        } else {
          delete c.f;

          for (d in c.n) {
            c.n[e](d) && c.n[d].f && delete c.n[d].f;
          }
        }

        c = c.n;
      }
    }
  }, k.once = function (a, b) {
    var c = function c() {
      return k.unbind(a, c), b.apply(this, arguments);
    };

    return k.on(a, c);
  }, k.version = d, k.toString = function () {
    return "You are running Eve " + d;
  }, "undefined" != typeof module && module.exports ? module.exports = k : "undefined" != typeof define ? define("eve", [], function () {
    return k;
  }) : a.eve = k;
}(this), function (a, b) {
  "function" == typeof define && define.amd ? define(["eve"], function (c) {
    return b(a, c);
  }) : b(a, a.eve);
}(this, function (a, b) {
  function c(a) {
    if (c.is(a, "function")) return u ? a() : b.on("raphael.DOMload", a);
    if (c.is(a, V)) return c._engine.create[D](c, a.splice(0, 3 + c.is(a[0], T))).add(a);
    var d = Array.prototype.slice.call(arguments, 0);

    if (c.is(d[d.length - 1], "function")) {
      var e = d.pop();
      return u ? e.call(c._engine.create[D](c, d)) : b.on("raphael.DOMload", function () {
        e.call(c._engine.create[D](c, d));
      });
    }

    return c._engine.create[D](c, arguments);
  }

  function d(a) {
    if ("function" == typeof a || Object(a) !== a) return a;
    var b = new a.constructor();

    for (var c in a) {
      a[z](c) && (b[c] = d(a[c]));
    }

    return b;
  }

  function e(a, b) {
    for (var c = 0, d = a.length; d > c; c++) {
      if (a[c] === b) return a.push(a.splice(c, 1)[0]);
    }
  }

  function f(a, b, c) {
    function d() {
      var f = Array.prototype.slice.call(arguments, 0),
          g = f.join("␀"),
          h = d.cache = d.cache || {},
          i = d.count = d.count || [];
      return h[z](g) ? (e(i, g), c ? c(h[g]) : h[g]) : (i.length >= 1e3 && delete h[i.shift()], i.push(g), h[g] = a[D](b, f), c ? c(h[g]) : h[g]);
    }

    return d;
  }

  function g() {
    return this.hex;
  }

  function h(a, b) {
    for (var c = [], d = 0, e = a.length; e - 2 * !b > d; d += 2) {
      var f = [{
        x: +a[d - 2],
        y: +a[d - 1]
      }, {
        x: +a[d],
        y: +a[d + 1]
      }, {
        x: +a[d + 2],
        y: +a[d + 3]
      }, {
        x: +a[d + 4],
        y: +a[d + 5]
      }];
      b ? d ? e - 4 == d ? f[3] = {
        x: +a[0],
        y: +a[1]
      } : e - 2 == d && (f[2] = {
        x: +a[0],
        y: +a[1]
      }, f[3] = {
        x: +a[2],
        y: +a[3]
      }) : f[0] = {
        x: +a[e - 2],
        y: +a[e - 1]
      } : e - 4 == d ? f[3] = f[2] : d || (f[0] = {
        x: +a[d],
        y: +a[d + 1]
      }), c.push(["C", (-f[0].x + 6 * f[1].x + f[2].x) / 6, (-f[0].y + 6 * f[1].y + f[2].y) / 6, (f[1].x + 6 * f[2].x - f[3].x) / 6, (f[1].y + 6 * f[2].y - f[3].y) / 6, f[2].x, f[2].y]);
    }

    return c;
  }

  function i(a, b, c, d, e) {
    var f = -3 * b + 9 * c - 9 * d + 3 * e,
        g = a * f + 6 * b - 12 * c + 6 * d;
    return a * g - 3 * b + 3 * c;
  }

  function j(a, b, c, d, e, f, g, h, j) {
    null == j && (j = 1), j = j > 1 ? 1 : 0 > j ? 0 : j;

    for (var k = j / 2, l = 12, m = [-.1252, .1252, -.3678, .3678, -.5873, .5873, -.7699, .7699, -.9041, .9041, -.9816, .9816], n = [.2491, .2491, .2335, .2335, .2032, .2032, .1601, .1601, .1069, .1069, .0472, .0472], o = 0, p = 0; l > p; p++) {
      var q = k * m[p] + k,
          r = i(q, a, c, e, g),
          s = i(q, b, d, f, h),
          t = r * r + s * s;
      o += n[p] * N.sqrt(t);
    }

    return k * o;
  }

  function k(a, b, c, d, e, f, g, h, i) {
    if (!(0 > i || j(a, b, c, d, e, f, g, h) < i)) {
      var k,
          l = 1,
          m = l / 2,
          n = l - m,
          o = .01;

      for (k = j(a, b, c, d, e, f, g, h, n); Q(k - i) > o;) {
        m /= 2, n += (i > k ? 1 : -1) * m, k = j(a, b, c, d, e, f, g, h, n);
      }

      return n;
    }
  }

  function l(a, b, c, d, e, f, g, h) {
    if (!(O(a, c) < P(e, g) || P(a, c) > O(e, g) || O(b, d) < P(f, h) || P(b, d) > O(f, h))) {
      var i = (a * d - b * c) * (e - g) - (a - c) * (e * h - f * g),
          j = (a * d - b * c) * (f - h) - (b - d) * (e * h - f * g),
          k = (a - c) * (f - h) - (b - d) * (e - g);

      if (k) {
        var l = i / k,
            m = j / k,
            n = +l.toFixed(2),
            o = +m.toFixed(2);
        if (!(n < +P(a, c).toFixed(2) || n > +O(a, c).toFixed(2) || n < +P(e, g).toFixed(2) || n > +O(e, g).toFixed(2) || o < +P(b, d).toFixed(2) || o > +O(b, d).toFixed(2) || o < +P(f, h).toFixed(2) || o > +O(f, h).toFixed(2))) return {
          x: l,
          y: m
        };
      }
    }
  }

  function m(a, b, d) {
    var e = c.bezierBBox(a),
        f = c.bezierBBox(b);
    if (!c.isBBoxIntersect(e, f)) return d ? 0 : [];

    for (var g = j.apply(0, a), h = j.apply(0, b), i = O(~~(g / 5), 1), k = O(~~(h / 5), 1), m = [], n = [], o = {}, p = d ? 0 : [], q = 0; i + 1 > q; q++) {
      var r = c.findDotsAtSegment.apply(c, a.concat(q / i));
      m.push({
        x: r.x,
        y: r.y,
        t: q / i
      });
    }

    for (q = 0; k + 1 > q; q++) {
      r = c.findDotsAtSegment.apply(c, b.concat(q / k)), n.push({
        x: r.x,
        y: r.y,
        t: q / k
      });
    }

    for (q = 0; i > q; q++) {
      for (var s = 0; k > s; s++) {
        var t = m[q],
            u = m[q + 1],
            v = n[s],
            w = n[s + 1],
            x = Q(u.x - t.x) < .001 ? "y" : "x",
            y = Q(w.x - v.x) < .001 ? "y" : "x",
            z = l(t.x, t.y, u.x, u.y, v.x, v.y, w.x, w.y);

        if (z) {
          if (o[z.x.toFixed(4)] == z.y.toFixed(4)) continue;
          o[z.x.toFixed(4)] = z.y.toFixed(4);
          var A = t.t + Q((z[x] - t[x]) / (u[x] - t[x])) * (u.t - t.t),
              B = v.t + Q((z[y] - v[y]) / (w[y] - v[y])) * (w.t - v.t);
          A >= 0 && 1.001 >= A && B >= 0 && 1.001 >= B && (d ? p++ : p.push({
            x: z.x,
            y: z.y,
            t1: P(A, 1),
            t2: P(B, 1)
          }));
        }
      }
    }

    return p;
  }

  function n(a, b, d) {
    a = c._path2curve(a), b = c._path2curve(b);

    for (var e, f, g, h, i, j, k, l, n, o, p = d ? 0 : [], q = 0, r = a.length; r > q; q++) {
      var s = a[q];
      if ("M" == s[0]) e = i = s[1], f = j = s[2];else {
        "C" == s[0] ? (n = [e, f].concat(s.slice(1)), e = n[6], f = n[7]) : (n = [e, f, e, f, i, j, i, j], e = i, f = j);

        for (var t = 0, u = b.length; u > t; t++) {
          var v = b[t];
          if ("M" == v[0]) g = k = v[1], h = l = v[2];else {
            "C" == v[0] ? (o = [g, h].concat(v.slice(1)), g = o[6], h = o[7]) : (o = [g, h, g, h, k, l, k, l], g = k, h = l);
            var w = m(n, o, d);
            if (d) p += w;else {
              for (var x = 0, y = w.length; y > x; x++) {
                w[x].segment1 = q, w[x].segment2 = t, w[x].bez1 = n, w[x].bez2 = o;
              }

              p = p.concat(w);
            }
          }
        }
      }
    }

    return p;
  }

  function o(a, b, c, d, e, f) {
    null != a ? (this.a = +a, this.b = +b, this.c = +c, this.d = +d, this.e = +e, this.f = +f) : (this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.e = 0, this.f = 0);
  }

  function p() {
    return this.x + H + this.y + H + this.width + " × " + this.height;
  }

  function q(a, b, c, d, e, f) {
    function g(a) {
      return ((l * a + k) * a + j) * a;
    }

    function h(a, b) {
      var c = i(a, b);
      return ((o * c + n) * c + m) * c;
    }

    function i(a, b) {
      var c, d, e, f, h, i;

      for (e = a, i = 0; 8 > i; i++) {
        if (f = g(e) - a, Q(f) < b) return e;
        if (h = (3 * l * e + 2 * k) * e + j, Q(h) < 1e-6) break;
        e -= f / h;
      }

      if (c = 0, d = 1, e = a, c > e) return c;
      if (e > d) return d;

      for (; d > c;) {
        if (f = g(e), Q(f - a) < b) return e;
        a > f ? c = e : d = e, e = (d - c) / 2 + c;
      }

      return e;
    }

    var j = 3 * b,
        k = 3 * (d - b) - j,
        l = 1 - j - k,
        m = 3 * c,
        n = 3 * (e - c) - m,
        o = 1 - m - n;
    return h(a, 1 / (200 * f));
  }

  function r(a, b) {
    var c = [],
        d = {};

    if (this.ms = b, this.times = 1, a) {
      for (var e in a) {
        a[z](e) && (d[_(e)] = a[e], c.push(_(e)));
      }

      c.sort(lb);
    }

    this.anim = d, this.top = c[c.length - 1], this.percents = c;
  }

  function s(a, d, e, f, g, h) {
    e = _(e);
    var i,
        j,
        k,
        l,
        m,
        n,
        p = a.ms,
        r = {},
        s = {},
        t = {};
    if (f) for (v = 0, x = ic.length; x > v; v++) {
      var u = ic[v];

      if (u.el.id == d.id && u.anim == a) {
        u.percent != e ? (ic.splice(v, 1), k = 1) : j = u, d.attr(u.totalOrigin);
        break;
      }
    } else f = +s;

    for (var v = 0, x = a.percents.length; x > v; v++) {
      if (a.percents[v] == e || a.percents[v] > f * a.top) {
        e = a.percents[v], m = a.percents[v - 1] || 0, p = p / a.top * (e - m), l = a.percents[v + 1], i = a.anim[e];
        break;
      }

      f && d.attr(a.anim[a.percents[v]]);
    }

    if (i) {
      if (j) j.initstatus = f, j.start = new Date() - j.ms * f;else {
        for (var y in i) {
          if (i[z](y) && (db[z](y) || d.paper.customAttributes[z](y))) switch (r[y] = d.attr(y), null == r[y] && (r[y] = cb[y]), s[y] = i[y], db[y]) {
            case T:
              t[y] = (s[y] - r[y]) / p;
              break;

            case "colour":
              r[y] = c.getRGB(r[y]);
              var A = c.getRGB(s[y]);
              t[y] = {
                r: (A.r - r[y].r) / p,
                g: (A.g - r[y].g) / p,
                b: (A.b - r[y].b) / p
              };
              break;

            case "path":
              var B = Kb(r[y], s[y]),
                  C = B[1];

              for (r[y] = B[0], t[y] = [], v = 0, x = r[y].length; x > v; v++) {
                t[y][v] = [0];

                for (var D = 1, F = r[y][v].length; F > D; D++) {
                  t[y][v][D] = (C[v][D] - r[y][v][D]) / p;
                }
              }

              break;

            case "transform":
              var G = d._,
                  H = Pb(G[y], s[y]);
              if (H) for (r[y] = H.from, s[y] = H.to, t[y] = [], t[y].real = !0, v = 0, x = r[y].length; x > v; v++) {
                for (t[y][v] = [r[y][v][0]], D = 1, F = r[y][v].length; F > D; D++) {
                  t[y][v][D] = (s[y][v][D] - r[y][v][D]) / p;
                }
              } else {
                var K = d.matrix || new o(),
                    L = {
                  _: {
                    transform: G.transform
                  },
                  getBBox: function getBBox() {
                    return d.getBBox(1);
                  }
                };
                r[y] = [K.a, K.b, K.c, K.d, K.e, K.f], Nb(L, s[y]), s[y] = L._.transform, t[y] = [(L.matrix.a - K.a) / p, (L.matrix.b - K.b) / p, (L.matrix.c - K.c) / p, (L.matrix.d - K.d) / p, (L.matrix.e - K.e) / p, (L.matrix.f - K.f) / p];
              }
              break;

            case "csv":
              var M = I(i[y])[J](w),
                  N = I(r[y])[J](w);
              if ("clip-rect" == y) for (r[y] = N, t[y] = [], v = N.length; v--;) {
                t[y][v] = (M[v] - r[y][v]) / p;
              }
              s[y] = M;
              break;

            default:
              for (M = [][E](i[y]), N = [][E](r[y]), t[y] = [], v = d.paper.customAttributes[y].length; v--;) {
                t[y][v] = ((M[v] || 0) - (N[v] || 0)) / p;
              }

          }
        }

        var O = i.easing,
            P = c.easing_formulas[O];
        if (!P) if (P = I(O).match(Z), P && 5 == P.length) {
          var Q = P;

          P = function P(a) {
            return q(a, +Q[1], +Q[2], +Q[3], +Q[4], p);
          };
        } else P = nb;
        if (n = i.start || a.start || +new Date(), u = {
          anim: a,
          percent: e,
          timestamp: n,
          start: n + (a.del || 0),
          status: 0,
          initstatus: f || 0,
          stop: !1,
          ms: p,
          easing: P,
          from: r,
          diff: t,
          to: s,
          el: d,
          callback: i.callback,
          prev: m,
          next: l,
          repeat: h || a.times,
          origin: d.attr(),
          totalOrigin: g
        }, ic.push(u), f && !j && !k && (u.stop = !0, u.start = new Date() - p * f, 1 == ic.length)) return kc();
        k && (u.start = new Date() - u.ms * f), 1 == ic.length && jc(kc);
      }
      b("raphael.anim.start." + d.id, d, a);
    }
  }

  function t(a) {
    for (var b = 0; b < ic.length; b++) {
      ic[b].el.paper == a && ic.splice(b--, 1);
    }
  }

  c.version = "2.1.0", c.eve = b;

  var u,
      v,
      w = /[, ]+/,
      x = {
    circle: 1,
    rect: 1,
    path: 1,
    ellipse: 1,
    text: 1,
    image: 1
  },
      y = /\{(\d+)\}/g,
      z = "hasOwnProperty",
      A = {
    doc: document,
    win: a
  },
      B = {
    was: Object.prototype[z].call(A.win, "Raphael"),
    is: A.win.Raphael
  },
      C = function C() {
    this.ca = this.customAttributes = {};
  },
      D = "apply",
      E = "concat",
      F = "ontouchstart" in A.win || A.win.DocumentTouch && A.doc instanceof DocumentTouch,
      G = "",
      H = " ",
      I = String,
      J = "split",
      K = "click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[J](H),
      L = {
    mousedown: "touchstart",
    mousemove: "touchmove",
    mouseup: "touchend"
  },
      M = I.prototype.toLowerCase,
      N = Math,
      O = N.max,
      P = N.min,
      Q = N.abs,
      R = N.pow,
      S = N.PI,
      T = "number",
      U = "string",
      V = "array",
      W = Object.prototype.toString,
      X = (c._ISURL = /^url\(['"]?([^\)]+?)['"]?\)$/i, /^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),
      Y = {
    NaN: 1,
    Infinity: 1,
    "-Infinity": 1
  },
      Z = /^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,
      $ = N.round,
      _ = parseFloat,
      ab = parseInt,
      bb = I.prototype.toUpperCase,
      cb = c._availableAttrs = {
    "arrow-end": "none",
    "arrow-start": "none",
    blur: 0,
    "clip-rect": "0 0 1e9 1e9",
    cursor: "default",
    cx: 0,
    cy: 0,
    fill: "#fff",
    "fill-opacity": 1,
    font: '10px "Arial"',
    "font-family": '"Arial"',
    "font-size": "10",
    "font-style": "normal",
    "font-weight": 400,
    gradient: 0,
    height: 0,
    href: "http://raphaeljs.com/",
    "letter-spacing": 0,
    opacity: 1,
    path: "M0,0",
    r: 0,
    rx: 0,
    ry: 0,
    src: "",
    stroke: "#000",
    "stroke-dasharray": "",
    "stroke-linecap": "butt",
    "stroke-linejoin": "butt",
    "stroke-miterlimit": 0,
    "stroke-opacity": 1,
    "stroke-width": 1,
    target: "_blank",
    "text-anchor": "middle",
    title: "Raphael",
    transform: "",
    width: 0,
    x: 0,
    y: 0
  },
      db = c._availableAnimAttrs = {
    blur: T,
    "clip-rect": "csv",
    cx: T,
    cy: T,
    fill: "colour",
    "fill-opacity": T,
    "font-size": T,
    height: T,
    opacity: T,
    path: "path",
    r: T,
    rx: T,
    ry: T,
    stroke: "colour",
    "stroke-opacity": T,
    "stroke-width": T,
    transform: "transform",
    width: T,
    x: T,
    y: T
  },
      eb = /[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
      fb = {
    hs: 1,
    rg: 1
  },
      gb = /,?([achlmqrstvxz]),?/gi,
      hb = /([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,
      ib = /([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,
      jb = /(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,
      kb = (c._radial_gradient = /^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/, {}),
      lb = function lb(a, b) {
    return _(a) - _(b);
  },
      mb = function mb() {},
      nb = function nb(a) {
    return a;
  },
      ob = c._rectPath = function (a, b, c, d, e) {
    return e ? [["M", a + e, b], ["l", c - 2 * e, 0], ["a", e, e, 0, 0, 1, e, e], ["l", 0, d - 2 * e], ["a", e, e, 0, 0, 1, -e, e], ["l", 2 * e - c, 0], ["a", e, e, 0, 0, 1, -e, -e], ["l", 0, 2 * e - d], ["a", e, e, 0, 0, 1, e, -e], ["z"]] : [["M", a, b], ["l", c, 0], ["l", 0, d], ["l", -c, 0], ["z"]];
  },
      pb = function pb(a, b, c, d) {
    return null == d && (d = c), [["M", a, b], ["m", 0, -d], ["a", c, d, 0, 1, 1, 0, 2 * d], ["a", c, d, 0, 1, 1, 0, -2 * d], ["z"]];
  },
      qb = c._getPath = {
    path: function path(a) {
      return a.attr("path");
    },
    circle: function circle(a) {
      var b = a.attrs;
      return pb(b.cx, b.cy, b.r);
    },
    ellipse: function ellipse(a) {
      var b = a.attrs;
      return pb(b.cx, b.cy, b.rx, b.ry);
    },
    rect: function rect(a) {
      var b = a.attrs;
      return ob(b.x, b.y, b.width, b.height, b.r);
    },
    image: function image(a) {
      var b = a.attrs;
      return ob(b.x, b.y, b.width, b.height);
    },
    text: function text(a) {
      var b = a._getBBox();

      return ob(b.x, b.y, b.width, b.height);
    },
    set: function set(a) {
      var b = a._getBBox();

      return ob(b.x, b.y, b.width, b.height);
    }
  },
      rb = c.mapPath = function (a, b) {
    if (!b) return a;
    var c, d, e, f, g, h, i;

    for (a = Kb(a), e = 0, g = a.length; g > e; e++) {
      for (i = a[e], f = 1, h = i.length; h > f; f += 2) {
        c = b.x(i[f], i[f + 1]), d = b.y(i[f], i[f + 1]), i[f] = c, i[f + 1] = d;
      }
    }

    return a;
  };

  if (c._g = A, c.type = A.win.SVGAngle || A.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1") ? "SVG" : "VML", "VML" == c.type) {
    var sb,
        tb = A.doc.createElement("div");
    if (tb.innerHTML = '<v:shape adj="1"/>', sb = tb.firstChild, sb.style.behavior = "url(#default#VML)", !sb || "object" != _typeof(sb.adj)) return c.type = G;
    tb = null;
  }

  c.svg = !(c.vml = "VML" == c.type), c._Paper = C, c.fn = v = C.prototype = c.prototype, c._id = 0, c._oid = 0, c.is = function (a, b) {
    return b = M.call(b), "finite" == b ? !Y[z](+a) : "array" == b ? a instanceof Array : "null" == b && null === a || b == _typeof(a) && null !== a || "object" == b && a === Object(a) || "array" == b && Array.isArray && Array.isArray(a) || W.call(a).slice(8, -1).toLowerCase() == b;
  }, c.angle = function (a, b, d, e, f, g) {
    if (null == f) {
      var h = a - d,
          i = b - e;
      return h || i ? (180 + 180 * N.atan2(-i, -h) / S + 360) % 360 : 0;
    }

    return c.angle(a, b, f, g) - c.angle(d, e, f, g);
  }, c.rad = function (a) {
    return a % 360 * S / 180;
  }, c.deg = function (a) {
    return 180 * a / S % 360;
  }, c.snapTo = function (a, b, d) {
    if (d = c.is(d, "finite") ? d : 10, c.is(a, V)) {
      for (var e = a.length; e--;) {
        if (Q(a[e] - b) <= d) return a[e];
      }
    } else {
      a = +a;
      var f = b % a;
      if (d > f) return b - f;
      if (f > a - d) return b - f + a;
    }

    return b;
  }, c.createUUID = function (a, b) {
    return function () {
      return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a, b).toUpperCase();
    };
  }(/[xy]/g, function (a) {
    var b = 0 | 16 * N.random(),
        c = "x" == a ? b : 8 | 3 & b;
    return c.toString(16);
  }), c.setWindow = function (a) {
    b("raphael.setWindow", c, A.win, a), A.win = a, A.doc = A.win.document, c._engine.initWin && c._engine.initWin(A.win);
  };

  var _ub = function ub(a) {
    if (c.vml) {
      var b,
          d = /^\s+|\s+$/g;

      try {
        var e = new ActiveXObject("htmlfile");
        e.write("<body>"), e.close(), b = e.body;
      } catch (g) {
        b = createPopup().document.body;
      }

      var h = b.createTextRange();
      _ub = f(function (a) {
        try {
          b.style.color = I(a).replace(d, G);
          var c = h.queryCommandValue("ForeColor");
          return c = (255 & c) << 16 | 65280 & c | (16711680 & c) >>> 16, "#" + ("000000" + c.toString(16)).slice(-6);
        } catch (e) {
          return "none";
        }
      });
    } else {
      var i = A.doc.createElement("i");
      i.title = "Raphaël Colour Picker", i.style.display = "none", A.doc.body.appendChild(i), _ub = f(function (a) {
        return i.style.color = a, A.doc.defaultView.getComputedStyle(i, G).getPropertyValue("color");
      });
    }

    return _ub(a);
  },
      vb = function vb() {
    return "hsb(" + [this.h, this.s, this.b] + ")";
  },
      wb = function wb() {
    return "hsl(" + [this.h, this.s, this.l] + ")";
  },
      xb = function xb() {
    return this.hex;
  },
      yb = function yb(a, b, d) {
    if (null == b && c.is(a, "object") && "r" in a && "g" in a && "b" in a && (d = a.b, b = a.g, a = a.r), null == b && c.is(a, U)) {
      var e = c.getRGB(a);
      a = e.r, b = e.g, d = e.b;
    }

    return (a > 1 || b > 1 || d > 1) && (a /= 255, b /= 255, d /= 255), [a, b, d];
  },
      zb = function zb(a, b, d, e) {
    a *= 255, b *= 255, d *= 255;
    var f = {
      r: a,
      g: b,
      b: d,
      hex: c.rgb(a, b, d),
      toString: xb
    };
    return c.is(e, "finite") && (f.opacity = e), f;
  };

  c.color = function (a) {
    var b;
    return c.is(a, "object") && "h" in a && "s" in a && "b" in a ? (b = c.hsb2rgb(a), a.r = b.r, a.g = b.g, a.b = b.b, a.hex = b.hex) : c.is(a, "object") && "h" in a && "s" in a && "l" in a ? (b = c.hsl2rgb(a), a.r = b.r, a.g = b.g, a.b = b.b, a.hex = b.hex) : (c.is(a, "string") && (a = c.getRGB(a)), c.is(a, "object") && "r" in a && "g" in a && "b" in a ? (b = c.rgb2hsl(a), a.h = b.h, a.s = b.s, a.l = b.l, b = c.rgb2hsb(a), a.v = b.b) : (a = {
      hex: "none"
    }, a.r = a.g = a.b = a.h = a.s = a.v = a.l = -1)), a.toString = xb, a;
  }, c.hsb2rgb = function (a, b, c, d) {
    this.is(a, "object") && "h" in a && "s" in a && "b" in a && (c = a.b, b = a.s, a = a.h, d = a.o), a *= 360;
    var e, f, g, h, i;
    return a = a % 360 / 60, i = c * b, h = i * (1 - Q(a % 2 - 1)), e = f = g = c - i, a = ~~a, e += [i, h, 0, 0, h, i][a], f += [h, i, i, h, 0, 0][a], g += [0, 0, h, i, i, h][a], zb(e, f, g, d);
  }, c.hsl2rgb = function (a, b, c, d) {
    this.is(a, "object") && "h" in a && "s" in a && "l" in a && (c = a.l, b = a.s, a = a.h), (a > 1 || b > 1 || c > 1) && (a /= 360, b /= 100, c /= 100), a *= 360;
    var e, f, g, h, i;
    return a = a % 360 / 60, i = 2 * b * (.5 > c ? c : 1 - c), h = i * (1 - Q(a % 2 - 1)), e = f = g = c - i / 2, a = ~~a, e += [i, h, 0, 0, h, i][a], f += [h, i, i, h, 0, 0][a], g += [0, 0, h, i, i, h][a], zb(e, f, g, d);
  }, c.rgb2hsb = function (a, b, c) {
    c = yb(a, b, c), a = c[0], b = c[1], c = c[2];
    var d, e, f, g;
    return f = O(a, b, c), g = f - P(a, b, c), d = 0 == g ? null : f == a ? (b - c) / g : f == b ? (c - a) / g + 2 : (a - b) / g + 4, d = 60 * ((d + 360) % 6) / 360, e = 0 == g ? 0 : g / f, {
      h: d,
      s: e,
      b: f,
      toString: vb
    };
  }, c.rgb2hsl = function (a, b, c) {
    c = yb(a, b, c), a = c[0], b = c[1], c = c[2];
    var d, e, f, g, h, i;
    return g = O(a, b, c), h = P(a, b, c), i = g - h, d = 0 == i ? null : g == a ? (b - c) / i : g == b ? (c - a) / i + 2 : (a - b) / i + 4, d = 60 * ((d + 360) % 6) / 360, f = (g + h) / 2, e = 0 == i ? 0 : .5 > f ? i / (2 * f) : i / (2 - 2 * f), {
      h: d,
      s: e,
      l: f,
      toString: wb
    };
  }, c._path2string = function () {
    return this.join(",").replace(gb, "$1");
  }, c._preload = function (a, b) {
    var c = A.doc.createElement("img");
    c.style.cssText = "position:absolute;left:-9999em;top:-9999em", c.onload = function () {
      b.call(this), this.onload = null, A.doc.body.removeChild(this);
    }, c.onerror = function () {
      A.doc.body.removeChild(this);
    }, A.doc.body.appendChild(c), c.src = a;
  }, c.getRGB = f(function (a) {
    if (!a || (a = I(a)).indexOf("-") + 1) return {
      r: -1,
      g: -1,
      b: -1,
      hex: "none",
      error: 1,
      toString: g
    };
    if ("none" == a) return {
      r: -1,
      g: -1,
      b: -1,
      hex: "none",
      toString: g
    };
    !(fb[z](a.toLowerCase().substring(0, 2)) || "#" == a.charAt()) && (a = _ub(a));
    var b,
        d,
        e,
        f,
        h,
        i,
        j = a.match(X);
    return j ? (j[2] && (e = ab(j[2].substring(5), 16), d = ab(j[2].substring(3, 5), 16), b = ab(j[2].substring(1, 3), 16)), j[3] && (e = ab((h = j[3].charAt(3)) + h, 16), d = ab((h = j[3].charAt(2)) + h, 16), b = ab((h = j[3].charAt(1)) + h, 16)), j[4] && (i = j[4][J](eb), b = _(i[0]), "%" == i[0].slice(-1) && (b *= 2.55), d = _(i[1]), "%" == i[1].slice(-1) && (d *= 2.55), e = _(i[2]), "%" == i[2].slice(-1) && (e *= 2.55), "rgba" == j[1].toLowerCase().slice(0, 4) && (f = _(i[3])), i[3] && "%" == i[3].slice(-1) && (f /= 100)), j[5] ? (i = j[5][J](eb), b = _(i[0]), "%" == i[0].slice(-1) && (b *= 2.55), d = _(i[1]), "%" == i[1].slice(-1) && (d *= 2.55), e = _(i[2]), "%" == i[2].slice(-1) && (e *= 2.55), ("deg" == i[0].slice(-3) || "°" == i[0].slice(-1)) && (b /= 360), "hsba" == j[1].toLowerCase().slice(0, 4) && (f = _(i[3])), i[3] && "%" == i[3].slice(-1) && (f /= 100), c.hsb2rgb(b, d, e, f)) : j[6] ? (i = j[6][J](eb), b = _(i[0]), "%" == i[0].slice(-1) && (b *= 2.55), d = _(i[1]), "%" == i[1].slice(-1) && (d *= 2.55), e = _(i[2]), "%" == i[2].slice(-1) && (e *= 2.55), ("deg" == i[0].slice(-3) || "°" == i[0].slice(-1)) && (b /= 360), "hsla" == j[1].toLowerCase().slice(0, 4) && (f = _(i[3])), i[3] && "%" == i[3].slice(-1) && (f /= 100), c.hsl2rgb(b, d, e, f)) : (j = {
      r: b,
      g: d,
      b: e,
      toString: g
    }, j.hex = "#" + (16777216 | e | d << 8 | b << 16).toString(16).slice(1), c.is(f, "finite") && (j.opacity = f), j)) : {
      r: -1,
      g: -1,
      b: -1,
      hex: "none",
      error: 1,
      toString: g
    };
  }, c), c.hsb = f(function (a, b, d) {
    return c.hsb2rgb(a, b, d).hex;
  }), c.hsl = f(function (a, b, d) {
    return c.hsl2rgb(a, b, d).hex;
  }), c.rgb = f(function (a, b, c) {
    return "#" + (16777216 | c | b << 8 | a << 16).toString(16).slice(1);
  }), c.getColor = function (a) {
    var b = this.getColor.start = this.getColor.start || {
      h: 0,
      s: 1,
      b: a || .75
    },
        c = this.hsb2rgb(b.h, b.s, b.b);
    return b.h += .075, b.h > 1 && (b.h = 0, b.s -= .2, b.s <= 0 && (this.getColor.start = {
      h: 0,
      s: 1,
      b: b.b
    })), c.hex;
  }, c.getColor.reset = function () {
    delete this.start;
  }, c.parsePathString = function (a) {
    if (!a) return null;
    var b = Ab(a);
    if (b.arr) return Cb(b.arr);
    var d = {
      a: 7,
      c: 6,
      h: 1,
      l: 2,
      m: 2,
      r: 4,
      q: 4,
      s: 4,
      t: 2,
      v: 1,
      z: 0
    },
        e = [];
    return c.is(a, V) && c.is(a[0], V) && (e = Cb(a)), e.length || I(a).replace(hb, function (a, b, c) {
      var f = [],
          g = b.toLowerCase();
      if (c.replace(jb, function (a, b) {
        b && f.push(+b);
      }), "m" == g && f.length > 2 && (e.push([b][E](f.splice(0, 2))), g = "l", b = "m" == b ? "l" : "L"), "r" == g) e.push([b][E](f));else for (; f.length >= d[g] && (e.push([b][E](f.splice(0, d[g]))), d[g]);) {
        ;
      }
    }), e.toString = c._path2string, b.arr = Cb(e), e;
  }, c.parseTransformString = f(function (a) {
    if (!a) return null;
    var b = [];
    return c.is(a, V) && c.is(a[0], V) && (b = Cb(a)), b.length || I(a).replace(ib, function (a, c, d) {
      var e = [];
      M.call(c), d.replace(jb, function (a, b) {
        b && e.push(+b);
      }), b.push([c][E](e));
    }), b.toString = c._path2string, b;
  });

  var Ab = function Ab(a) {
    var b = Ab.ps = Ab.ps || {};
    return b[a] ? b[a].sleep = 100 : b[a] = {
      sleep: 100
    }, setTimeout(function () {
      for (var c in b) {
        b[z](c) && c != a && (b[c].sleep--, !b[c].sleep && delete b[c]);
      }
    }), b[a];
  };

  c.findDotsAtSegment = function (a, b, c, d, e, f, g, h, i) {
    var j = 1 - i,
        k = R(j, 3),
        l = R(j, 2),
        m = i * i,
        n = m * i,
        o = k * a + 3 * l * i * c + 3 * j * i * i * e + n * g,
        p = k * b + 3 * l * i * d + 3 * j * i * i * f + n * h,
        q = a + 2 * i * (c - a) + m * (e - 2 * c + a),
        r = b + 2 * i * (d - b) + m * (f - 2 * d + b),
        s = c + 2 * i * (e - c) + m * (g - 2 * e + c),
        t = d + 2 * i * (f - d) + m * (h - 2 * f + d),
        u = j * a + i * c,
        v = j * b + i * d,
        w = j * e + i * g,
        x = j * f + i * h,
        y = 90 - 180 * N.atan2(q - s, r - t) / S;
    return (q > s || t > r) && (y += 180), {
      x: o,
      y: p,
      m: {
        x: q,
        y: r
      },
      n: {
        x: s,
        y: t
      },
      start: {
        x: u,
        y: v
      },
      end: {
        x: w,
        y: x
      },
      alpha: y
    };
  }, c.bezierBBox = function (a, b, d, e, f, g, h, i) {
    c.is(a, "array") || (a = [a, b, d, e, f, g, h, i]);
    var j = Jb.apply(null, a);
    return {
      x: j.min.x,
      y: j.min.y,
      x2: j.max.x,
      y2: j.max.y,
      width: j.max.x - j.min.x,
      height: j.max.y - j.min.y
    };
  }, c.isPointInsideBBox = function (a, b, c) {
    return b >= a.x && b <= a.x2 && c >= a.y && c <= a.y2;
  }, c.isBBoxIntersect = function (a, b) {
    var d = c.isPointInsideBBox;
    return d(b, a.x, a.y) || d(b, a.x2, a.y) || d(b, a.x, a.y2) || d(b, a.x2, a.y2) || d(a, b.x, b.y) || d(a, b.x2, b.y) || d(a, b.x, b.y2) || d(a, b.x2, b.y2) || (a.x < b.x2 && a.x > b.x || b.x < a.x2 && b.x > a.x) && (a.y < b.y2 && a.y > b.y || b.y < a.y2 && b.y > a.y);
  }, c.pathIntersection = function (a, b) {
    return n(a, b);
  }, c.pathIntersectionNumber = function (a, b) {
    return n(a, b, 1);
  }, c.isPointInsidePath = function (a, b, d) {
    var e = c.pathBBox(a);
    return c.isPointInsideBBox(e, b, d) && 1 == n(a, [["M", b, d], ["H", e.x2 + 10]], 1) % 2;
  }, c._removedFactory = function (a) {
    return function () {
      b("raphael.log", null, "Raphaël: you are calling to method “" + a + "” of removed object", a);
    };
  };

  var Bb = c.pathBBox = function (a) {
    var b = Ab(a);
    if (b.bbox) return d(b.bbox);
    if (!a) return {
      x: 0,
      y: 0,
      width: 0,
      height: 0,
      x2: 0,
      y2: 0
    };
    a = Kb(a);

    for (var c, e = 0, f = 0, g = [], h = [], i = 0, j = a.length; j > i; i++) {
      if (c = a[i], "M" == c[0]) e = c[1], f = c[2], g.push(e), h.push(f);else {
        var k = Jb(e, f, c[1], c[2], c[3], c[4], c[5], c[6]);
        g = g[E](k.min.x, k.max.x), h = h[E](k.min.y, k.max.y), e = c[5], f = c[6];
      }
    }

    var l = P[D](0, g),
        m = P[D](0, h),
        n = O[D](0, g),
        o = O[D](0, h),
        p = n - l,
        q = o - m,
        r = {
      x: l,
      y: m,
      x2: n,
      y2: o,
      width: p,
      height: q,
      cx: l + p / 2,
      cy: m + q / 2
    };
    return b.bbox = d(r), r;
  },
      Cb = function Cb(a) {
    var b = d(a);
    return b.toString = c._path2string, b;
  },
      Db = c._pathToRelative = function (a) {
    var b = Ab(a);
    if (b.rel) return Cb(b.rel);
    c.is(a, V) && c.is(a && a[0], V) || (a = c.parsePathString(a));
    var d = [],
        e = 0,
        f = 0,
        g = 0,
        h = 0,
        i = 0;
    "M" == a[0][0] && (e = a[0][1], f = a[0][2], g = e, h = f, i++, d.push(["M", e, f]));

    for (var j = i, k = a.length; k > j; j++) {
      var l = d[j] = [],
          m = a[j];
      if (m[0] != M.call(m[0])) switch (l[0] = M.call(m[0]), l[0]) {
        case "a":
          l[1] = m[1], l[2] = m[2], l[3] = m[3], l[4] = m[4], l[5] = m[5], l[6] = +(m[6] - e).toFixed(3), l[7] = +(m[7] - f).toFixed(3);
          break;

        case "v":
          l[1] = +(m[1] - f).toFixed(3);
          break;

        case "m":
          g = m[1], h = m[2];

        default:
          for (var n = 1, o = m.length; o > n; n++) {
            l[n] = +(m[n] - (n % 2 ? e : f)).toFixed(3);
          }

      } else {
        l = d[j] = [], "m" == m[0] && (g = m[1] + e, h = m[2] + f);

        for (var p = 0, q = m.length; q > p; p++) {
          d[j][p] = m[p];
        }
      }
      var r = d[j].length;

      switch (d[j][0]) {
        case "z":
          e = g, f = h;
          break;

        case "h":
          e += +d[j][r - 1];
          break;

        case "v":
          f += +d[j][r - 1];
          break;

        default:
          e += +d[j][r - 2], f += +d[j][r - 1];
      }
    }

    return d.toString = c._path2string, b.rel = Cb(d), d;
  },
      Eb = c._pathToAbsolute = function (a) {
    var b = Ab(a);
    if (b.abs) return Cb(b.abs);
    if (c.is(a, V) && c.is(a && a[0], V) || (a = c.parsePathString(a)), !a || !a.length) return [["M", 0, 0]];
    var d = [],
        e = 0,
        f = 0,
        g = 0,
        i = 0,
        j = 0;
    "M" == a[0][0] && (e = +a[0][1], f = +a[0][2], g = e, i = f, j++, d[0] = ["M", e, f]);

    for (var k, l, m = 3 == a.length && "M" == a[0][0] && "R" == a[1][0].toUpperCase() && "Z" == a[2][0].toUpperCase(), n = j, o = a.length; o > n; n++) {
      if (d.push(k = []), l = a[n], l[0] != bb.call(l[0])) switch (k[0] = bb.call(l[0]), k[0]) {
        case "A":
          k[1] = l[1], k[2] = l[2], k[3] = l[3], k[4] = l[4], k[5] = l[5], k[6] = +(l[6] + e), k[7] = +(l[7] + f);
          break;

        case "V":
          k[1] = +l[1] + f;
          break;

        case "H":
          k[1] = +l[1] + e;
          break;

        case "R":
          for (var p = [e, f][E](l.slice(1)), q = 2, r = p.length; r > q; q++) {
            p[q] = +p[q] + e, p[++q] = +p[q] + f;
          }

          d.pop(), d = d[E](h(p, m));
          break;

        case "M":
          g = +l[1] + e, i = +l[2] + f;

        default:
          for (q = 1, r = l.length; r > q; q++) {
            k[q] = +l[q] + (q % 2 ? e : f);
          }

      } else if ("R" == l[0]) p = [e, f][E](l.slice(1)), d.pop(), d = d[E](h(p, m)), k = ["R"][E](l.slice(-2));else for (var s = 0, t = l.length; t > s; s++) {
        k[s] = l[s];
      }

      switch (k[0]) {
        case "Z":
          e = g, f = i;
          break;

        case "H":
          e = k[1];
          break;

        case "V":
          f = k[1];
          break;

        case "M":
          g = k[k.length - 2], i = k[k.length - 1];

        default:
          e = k[k.length - 2], f = k[k.length - 1];
      }
    }

    return d.toString = c._path2string, b.abs = Cb(d), d;
  },
      Fb = function Fb(a, b, c, d) {
    return [a, b, c, d, c, d];
  },
      Gb = function Gb(a, b, c, d, e, f) {
    var g = 1 / 3,
        h = 2 / 3;
    return [g * a + h * c, g * b + h * d, g * e + h * c, g * f + h * d, e, f];
  },
      Hb = function Hb(a, b, c, d, e, g, h, i, j, k) {
    var l,
        m = 120 * S / 180,
        n = S / 180 * (+e || 0),
        o = [],
        p = f(function (a, b, c) {
      var d = a * N.cos(c) - b * N.sin(c),
          e = a * N.sin(c) + b * N.cos(c);
      return {
        x: d,
        y: e
      };
    });
    if (k) y = k[0], z = k[1], w = k[2], x = k[3];else {
      l = p(a, b, -n), a = l.x, b = l.y, l = p(i, j, -n), i = l.x, j = l.y;
      var q = (N.cos(S / 180 * e), N.sin(S / 180 * e), (a - i) / 2),
          r = (b - j) / 2,
          s = q * q / (c * c) + r * r / (d * d);
      s > 1 && (s = N.sqrt(s), c = s * c, d = s * d);
      var t = c * c,
          u = d * d,
          v = (g == h ? -1 : 1) * N.sqrt(Q((t * u - t * r * r - u * q * q) / (t * r * r + u * q * q))),
          w = v * c * r / d + (a + i) / 2,
          x = v * -d * q / c + (b + j) / 2,
          y = N.asin(((b - x) / d).toFixed(9)),
          z = N.asin(((j - x) / d).toFixed(9));
      y = w > a ? S - y : y, z = w > i ? S - z : z, 0 > y && (y = 2 * S + y), 0 > z && (z = 2 * S + z), h && y > z && (y -= 2 * S), !h && z > y && (z -= 2 * S);
    }
    var A = z - y;

    if (Q(A) > m) {
      var B = z,
          C = i,
          D = j;
      z = y + m * (h && z > y ? 1 : -1), i = w + c * N.cos(z), j = x + d * N.sin(z), o = Hb(i, j, c, d, e, 0, h, C, D, [z, B, w, x]);
    }

    A = z - y;
    var F = N.cos(y),
        G = N.sin(y),
        H = N.cos(z),
        I = N.sin(z),
        K = N.tan(A / 4),
        L = 4 / 3 * c * K,
        M = 4 / 3 * d * K,
        O = [a, b],
        P = [a + L * G, b - M * F],
        R = [i + L * I, j - M * H],
        T = [i, j];
    if (P[0] = 2 * O[0] - P[0], P[1] = 2 * O[1] - P[1], k) return [P, R, T][E](o);
    o = [P, R, T][E](o).join()[J](",");

    for (var U = [], V = 0, W = o.length; W > V; V++) {
      U[V] = V % 2 ? p(o[V - 1], o[V], n).y : p(o[V], o[V + 1], n).x;
    }

    return U;
  },
      Ib = function Ib(a, b, c, d, e, f, g, h, i) {
    var j = 1 - i;
    return {
      x: R(j, 3) * a + 3 * R(j, 2) * i * c + 3 * j * i * i * e + R(i, 3) * g,
      y: R(j, 3) * b + 3 * R(j, 2) * i * d + 3 * j * i * i * f + R(i, 3) * h
    };
  },
      Jb = f(function (a, b, c, d, e, f, g, h) {
    var i,
        j = e - 2 * c + a - (g - 2 * e + c),
        k = 2 * (c - a) - 2 * (e - c),
        l = a - c,
        m = (-k + N.sqrt(k * k - 4 * j * l)) / 2 / j,
        n = (-k - N.sqrt(k * k - 4 * j * l)) / 2 / j,
        o = [b, h],
        p = [a, g];
    return Q(m) > "1e12" && (m = .5), Q(n) > "1e12" && (n = .5), m > 0 && 1 > m && (i = Ib(a, b, c, d, e, f, g, h, m), p.push(i.x), o.push(i.y)), n > 0 && 1 > n && (i = Ib(a, b, c, d, e, f, g, h, n), p.push(i.x), o.push(i.y)), j = f - 2 * d + b - (h - 2 * f + d), k = 2 * (d - b) - 2 * (f - d), l = b - d, m = (-k + N.sqrt(k * k - 4 * j * l)) / 2 / j, n = (-k - N.sqrt(k * k - 4 * j * l)) / 2 / j, Q(m) > "1e12" && (m = .5), Q(n) > "1e12" && (n = .5), m > 0 && 1 > m && (i = Ib(a, b, c, d, e, f, g, h, m), p.push(i.x), o.push(i.y)), n > 0 && 1 > n && (i = Ib(a, b, c, d, e, f, g, h, n), p.push(i.x), o.push(i.y)), {
      min: {
        x: P[D](0, p),
        y: P[D](0, o)
      },
      max: {
        x: O[D](0, p),
        y: O[D](0, o)
      }
    };
  }),
      Kb = c._path2curve = f(function (a, b) {
    var c = !b && Ab(a);
    if (!b && c.curve) return Cb(c.curve);

    for (var d = Eb(a), e = b && Eb(b), f = {
      x: 0,
      y: 0,
      bx: 0,
      by: 0,
      X: 0,
      Y: 0,
      qx: null,
      qy: null
    }, g = {
      x: 0,
      y: 0,
      bx: 0,
      by: 0,
      X: 0,
      Y: 0,
      qx: null,
      qy: null
    }, h = function h(a, b, c) {
      var d, e;
      if (!a) return ["C", b.x, b.y, b.x, b.y, b.x, b.y];

      switch (!(a[0] in {
        T: 1,
        Q: 1
      }) && (b.qx = b.qy = null), a[0]) {
        case "M":
          b.X = a[1], b.Y = a[2];
          break;

        case "A":
          a = ["C"][E](Hb[D](0, [b.x, b.y][E](a.slice(1))));
          break;

        case "S":
          "C" == c || "S" == c ? (d = 2 * b.x - b.bx, e = 2 * b.y - b.by) : (d = b.x, e = b.y), a = ["C", d, e][E](a.slice(1));
          break;

        case "T":
          "Q" == c || "T" == c ? (b.qx = 2 * b.x - b.qx, b.qy = 2 * b.y - b.qy) : (b.qx = b.x, b.qy = b.y), a = ["C"][E](Gb(b.x, b.y, b.qx, b.qy, a[1], a[2]));
          break;

        case "Q":
          b.qx = a[1], b.qy = a[2], a = ["C"][E](Gb(b.x, b.y, a[1], a[2], a[3], a[4]));
          break;

        case "L":
          a = ["C"][E](Fb(b.x, b.y, a[1], a[2]));
          break;

        case "H":
          a = ["C"][E](Fb(b.x, b.y, a[1], b.y));
          break;

        case "V":
          a = ["C"][E](Fb(b.x, b.y, b.x, a[1]));
          break;

        case "Z":
          a = ["C"][E](Fb(b.x, b.y, b.X, b.Y));
      }

      return a;
    }, i = function i(a, b) {
      if (a[b].length > 7) {
        a[b].shift();

        for (var c = a[b]; c.length;) {
          a.splice(b++, 0, ["C"][E](c.splice(0, 6)));
        }

        a.splice(b, 1), l = O(d.length, e && e.length || 0);
      }
    }, j = function j(a, b, c, f, g) {
      a && b && "M" == a[g][0] && "M" != b[g][0] && (b.splice(g, 0, ["M", f.x, f.y]), c.bx = 0, c.by = 0, c.x = a[g][1], c.y = a[g][2], l = O(d.length, e && e.length || 0));
    }, k = 0, l = O(d.length, e && e.length || 0); l > k; k++) {
      d[k] = h(d[k], f), i(d, k), e && (e[k] = h(e[k], g)), e && i(e, k), j(d, e, f, g, k), j(e, d, g, f, k);
      var m = d[k],
          n = e && e[k],
          o = m.length,
          p = e && n.length;
      f.x = m[o - 2], f.y = m[o - 1], f.bx = _(m[o - 4]) || f.x, f.by = _(m[o - 3]) || f.y, g.bx = e && (_(n[p - 4]) || g.x), g.by = e && (_(n[p - 3]) || g.y), g.x = e && n[p - 2], g.y = e && n[p - 1];
    }

    return e || (c.curve = Cb(d)), e ? [d, e] : d;
  }, null, Cb),
      Lb = (c._parseDots = f(function (a) {
    for (var b = [], d = 0, e = a.length; e > d; d++) {
      var f = {},
          g = a[d].match(/^([^:]*):?([\d\.]*)/);
      if (f.color = c.getRGB(g[1]), f.color.error) return null;
      f.color = f.color.hex, g[2] && (f.offset = g[2] + "%"), b.push(f);
    }

    for (d = 1, e = b.length - 1; e > d; d++) {
      if (!b[d].offset) {
        for (var h = _(b[d - 1].offset || 0), i = 0, j = d + 1; e > j; j++) {
          if (b[j].offset) {
            i = b[j].offset;
            break;
          }
        }

        i || (i = 100, j = e), i = _(i);

        for (var k = (i - h) / (j - d + 1); j > d; d++) {
          h += k, b[d].offset = h + "%";
        }
      }
    }

    return b;
  }), c._tear = function (a, b) {
    a == b.top && (b.top = a.prev), a == b.bottom && (b.bottom = a.next), a.next && (a.next.prev = a.prev), a.prev && (a.prev.next = a.next);
  }),
      Mb = (c._tofront = function (a, b) {
    b.top !== a && (Lb(a, b), a.next = null, a.prev = b.top, b.top.next = a, b.top = a);
  }, c._toback = function (a, b) {
    b.bottom !== a && (Lb(a, b), a.next = b.bottom, a.prev = null, b.bottom.prev = a, b.bottom = a);
  }, c._insertafter = function (a, b, c) {
    Lb(a, c), b == c.top && (c.top = a), b.next && (b.next.prev = a), a.next = b.next, a.prev = b, b.next = a;
  }, c._insertbefore = function (a, b, c) {
    Lb(a, c), b == c.bottom && (c.bottom = a), b.prev && (b.prev.next = a), a.prev = b.prev, b.prev = a, a.next = b;
  }, c.toMatrix = function (a, b) {
    var c = Bb(a),
        d = {
      _: {
        transform: G
      },
      getBBox: function getBBox() {
        return c;
      }
    };
    return Nb(d, b), d.matrix;
  }),
      Nb = (c.transformPath = function (a, b) {
    return rb(a, Mb(a, b));
  }, c._extractTransform = function (a, b) {
    if (null == b) return a._.transform;
    b = I(b).replace(/\.{3}|\u2026/g, a._.transform || G);
    var d = c.parseTransformString(b),
        e = 0,
        f = 0,
        g = 0,
        h = 1,
        i = 1,
        j = a._,
        k = new o();
    if (j.transform = d || [], d) for (var l = 0, m = d.length; m > l; l++) {
      var n,
          p,
          q,
          r,
          s,
          t = d[l],
          u = t.length,
          v = I(t[0]).toLowerCase(),
          w = t[0] != v,
          x = w ? k.invert() : 0;
      "t" == v && 3 == u ? w ? (n = x.x(0, 0), p = x.y(0, 0), q = x.x(t[1], t[2]), r = x.y(t[1], t[2]), k.translate(q - n, r - p)) : k.translate(t[1], t[2]) : "r" == v ? 2 == u ? (s = s || a.getBBox(1), k.rotate(t[1], s.x + s.width / 2, s.y + s.height / 2), e += t[1]) : 4 == u && (w ? (q = x.x(t[2], t[3]), r = x.y(t[2], t[3]), k.rotate(t[1], q, r)) : k.rotate(t[1], t[2], t[3]), e += t[1]) : "s" == v ? 2 == u || 3 == u ? (s = s || a.getBBox(1), k.scale(t[1], t[u - 1], s.x + s.width / 2, s.y + s.height / 2), h *= t[1], i *= t[u - 1]) : 5 == u && (w ? (q = x.x(t[3], t[4]), r = x.y(t[3], t[4]), k.scale(t[1], t[2], q, r)) : k.scale(t[1], t[2], t[3], t[4]), h *= t[1], i *= t[2]) : "m" == v && 7 == u && k.add(t[1], t[2], t[3], t[4], t[5], t[6]), j.dirtyT = 1, a.matrix = k;
    }
    a.matrix = k, j.sx = h, j.sy = i, j.deg = e, j.dx = f = k.e, j.dy = g = k.f, 1 == h && 1 == i && !e && j.bbox ? (j.bbox.x += +f, j.bbox.y += +g) : j.dirtyT = 1;
  }),
      Ob = function Ob(a) {
    var b = a[0];

    switch (b.toLowerCase()) {
      case "t":
        return [b, 0, 0];

      case "m":
        return [b, 1, 0, 0, 1, 0, 0];

      case "r":
        return 4 == a.length ? [b, 0, a[2], a[3]] : [b, 0];

      case "s":
        return 5 == a.length ? [b, 1, 1, a[3], a[4]] : 3 == a.length ? [b, 1, 1] : [b, 1];
    }
  },
      Pb = c._equaliseTransform = function (a, b) {
    b = I(b).replace(/\.{3}|\u2026/g, a), a = c.parseTransformString(a) || [], b = c.parseTransformString(b) || [];

    for (var d, e, f, g, h = O(a.length, b.length), i = [], j = [], k = 0; h > k; k++) {
      if (f = a[k] || Ob(b[k]), g = b[k] || Ob(f), f[0] != g[0] || "r" == f[0].toLowerCase() && (f[2] != g[2] || f[3] != g[3]) || "s" == f[0].toLowerCase() && (f[3] != g[3] || f[4] != g[4])) return;

      for (i[k] = [], j[k] = [], d = 0, e = O(f.length, g.length); e > d; d++) {
        d in f && (i[k][d] = f[d]), d in g && (j[k][d] = g[d]);
      }
    }

    return {
      from: i,
      to: j
    };
  };

  c._getContainer = function (a, b, d, e) {
    var f;
    return f = null != e || c.is(a, "object") ? a : A.doc.getElementById(a), null != f ? f.tagName ? null == b ? {
      container: f,
      width: f.style.pixelWidth || f.offsetWidth,
      height: f.style.pixelHeight || f.offsetHeight
    } : {
      container: f,
      width: b,
      height: d
    } : {
      container: 1,
      x: a,
      y: b,
      width: d,
      height: e
    } : void 0;
  }, c.pathToRelative = Db, c._engine = {}, c.path2curve = Kb, c.matrix = function (a, b, c, d, e, f) {
    return new o(a, b, c, d, e, f);
  }, function (a) {
    function b(a) {
      return a[0] * a[0] + a[1] * a[1];
    }

    function d(a) {
      var c = N.sqrt(b(a));
      a[0] && (a[0] /= c), a[1] && (a[1] /= c);
    }

    a.add = function (a, b, c, d, e, f) {
      var g,
          h,
          i,
          j,
          k = [[], [], []],
          l = [[this.a, this.c, this.e], [this.b, this.d, this.f], [0, 0, 1]],
          m = [[a, c, e], [b, d, f], [0, 0, 1]];

      for (a && a instanceof o && (m = [[a.a, a.c, a.e], [a.b, a.d, a.f], [0, 0, 1]]), g = 0; 3 > g; g++) {
        for (h = 0; 3 > h; h++) {
          for (j = 0, i = 0; 3 > i; i++) {
            j += l[g][i] * m[i][h];
          }

          k[g][h] = j;
        }
      }

      this.a = k[0][0], this.b = k[1][0], this.c = k[0][1], this.d = k[1][1], this.e = k[0][2], this.f = k[1][2];
    }, a.invert = function () {
      var a = this,
          b = a.a * a.d - a.b * a.c;
      return new o(a.d / b, -a.b / b, -a.c / b, a.a / b, (a.c * a.f - a.d * a.e) / b, (a.b * a.e - a.a * a.f) / b);
    }, a.clone = function () {
      return new o(this.a, this.b, this.c, this.d, this.e, this.f);
    }, a.translate = function (a, b) {
      this.add(1, 0, 0, 1, a, b);
    }, a.scale = function (a, b, c, d) {
      null == b && (b = a), (c || d) && this.add(1, 0, 0, 1, c, d), this.add(a, 0, 0, b, 0, 0), (c || d) && this.add(1, 0, 0, 1, -c, -d);
    }, a.rotate = function (a, b, d) {
      a = c.rad(a), b = b || 0, d = d || 0;
      var e = +N.cos(a).toFixed(9),
          f = +N.sin(a).toFixed(9);
      this.add(e, f, -f, e, b, d), this.add(1, 0, 0, 1, -b, -d);
    }, a.x = function (a, b) {
      return a * this.a + b * this.c + this.e;
    }, a.y = function (a, b) {
      return a * this.b + b * this.d + this.f;
    }, a.get = function (a) {
      return +this[I.fromCharCode(97 + a)].toFixed(4);
    }, a.toString = function () {
      return c.svg ? "matrix(" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)].join() + ")" : [this.get(0), this.get(2), this.get(1), this.get(3), 0, 0].join();
    }, a.toFilter = function () {
      return "progid:DXImageTransform.Microsoft.Matrix(M11=" + this.get(0) + ", M12=" + this.get(2) + ", M21=" + this.get(1) + ", M22=" + this.get(3) + ", Dx=" + this.get(4) + ", Dy=" + this.get(5) + ", sizingmethod='auto expand')";
    }, a.offset = function () {
      return [this.e.toFixed(4), this.f.toFixed(4)];
    }, a.split = function () {
      var a = {};
      a.dx = this.e, a.dy = this.f;
      var e = [[this.a, this.c], [this.b, this.d]];
      a.scalex = N.sqrt(b(e[0])), d(e[0]), a.shear = e[0][0] * e[1][0] + e[0][1] * e[1][1], e[1] = [e[1][0] - e[0][0] * a.shear, e[1][1] - e[0][1] * a.shear], a.scaley = N.sqrt(b(e[1])), d(e[1]), a.shear /= a.scaley;
      var f = -e[0][1],
          g = e[1][1];
      return 0 > g ? (a.rotate = c.deg(N.acos(g)), 0 > f && (a.rotate = 360 - a.rotate)) : a.rotate = c.deg(N.asin(f)), a.isSimple = !(+a.shear.toFixed(9) || a.scalex.toFixed(9) != a.scaley.toFixed(9) && a.rotate), a.isSuperSimple = !+a.shear.toFixed(9) && a.scalex.toFixed(9) == a.scaley.toFixed(9) && !a.rotate, a.noRotation = !+a.shear.toFixed(9) && !a.rotate, a;
    }, a.toTransformString = function (a) {
      var b = a || this[J]();
      return b.isSimple ? (b.scalex = +b.scalex.toFixed(4), b.scaley = +b.scaley.toFixed(4), b.rotate = +b.rotate.toFixed(4), (b.dx || b.dy ? "t" + [b.dx, b.dy] : G) + (1 != b.scalex || 1 != b.scaley ? "s" + [b.scalex, b.scaley, 0, 0] : G) + (b.rotate ? "r" + [b.rotate, 0, 0] : G)) : "m" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)];
    };
  }(o.prototype);
  var Qb = navigator.userAgent.match(/Version\/(.*?)\s/) || navigator.userAgent.match(/Chrome\/(\d+)/);
  v.safari = "Apple Computer, Inc." == navigator.vendor && (Qb && Qb[1] < 4 || "iP" == navigator.platform.slice(0, 2)) || "Google Inc." == navigator.vendor && Qb && Qb[1] < 8 ? function () {
    var a = this.rect(-99, -99, this.width + 99, this.height + 99).attr({
      stroke: "none"
    });
    setTimeout(function () {
      a.remove();
    });
  } : mb;

  for (var Rb = function Rb() {
    this.returnValue = !1;
  }, Sb = function Sb() {
    return this.originalEvent.preventDefault();
  }, Tb = function Tb() {
    this.cancelBubble = !0;
  }, Ub = function Ub() {
    return this.originalEvent.stopPropagation();
  }, Vb = function Vb(a) {
    var b = A.doc.documentElement.scrollTop || A.doc.body.scrollTop,
        c = A.doc.documentElement.scrollLeft || A.doc.body.scrollLeft;
    return {
      x: a.clientX + c,
      y: a.clientY + b
    };
  }, Wb = function () {
    return A.doc.addEventListener ? function (a, b, c, d) {
      var e = function e(a) {
        var b = Vb(a);
        return c.call(d, a, b.x, b.y);
      };

      if (a.addEventListener(b, e, !1), F && L[b]) {
        var f = function f(b) {
          for (var e = Vb(b), f = b, g = 0, h = b.targetTouches && b.targetTouches.length; h > g; g++) {
            if (b.targetTouches[g].target == a) {
              b = b.targetTouches[g], b.originalEvent = f, b.preventDefault = Sb, b.stopPropagation = Ub;
              break;
            }
          }

          return c.call(d, b, e.x, e.y);
        };

        a.addEventListener(L[b], f, !1);
      }

      return function () {
        return a.removeEventListener(b, e, !1), F && L[b] && a.removeEventListener(L[b], e, !1), !0;
      };
    } : A.doc.attachEvent ? function (a, b, c, d) {
      var e = function e(a) {
        a = a || A.win.event;
        var b = A.doc.documentElement.scrollTop || A.doc.body.scrollTop,
            e = A.doc.documentElement.scrollLeft || A.doc.body.scrollLeft,
            f = a.clientX + e,
            g = a.clientY + b;
        return a.preventDefault = a.preventDefault || Rb, a.stopPropagation = a.stopPropagation || Tb, c.call(d, a, f, g);
      };

      a.attachEvent("on" + b, e);

      var f = function f() {
        return a.detachEvent("on" + b, e), !0;
      };

      return f;
    } : void 0;
  }(), Xb = [], Yb = function Yb(a) {
    for (var c, d = a.clientX, e = a.clientY, f = A.doc.documentElement.scrollTop || A.doc.body.scrollTop, g = A.doc.documentElement.scrollLeft || A.doc.body.scrollLeft, h = Xb.length; h--;) {
      if (c = Xb[h], F && a.touches) {
        for (var i, j = a.touches.length; j--;) {
          if (i = a.touches[j], i.identifier == c.el._drag.id) {
            d = i.clientX, e = i.clientY, (a.originalEvent ? a.originalEvent : a).preventDefault();
            break;
          }
        }
      } else a.preventDefault();

      var k,
          l = c.el.node,
          m = l.nextSibling,
          n = l.parentNode,
          o = l.style.display;
      A.win.opera && n.removeChild(l), l.style.display = "none", k = c.el.paper.getElementByPoint(d, e), l.style.display = o, A.win.opera && (m ? n.insertBefore(l, m) : n.appendChild(l)), k && b("raphael.drag.over." + c.el.id, c.el, k), d += g, e += f, b("raphael.drag.move." + c.el.id, c.move_scope || c.el, d - c.el._drag.x, e - c.el._drag.y, d, e, a);
    }
  }, Zb = function Zb(a) {
    c.unmousemove(Yb).unmouseup(Zb);

    for (var d, e = Xb.length; e--;) {
      d = Xb[e], d.el._drag = {}, b("raphael.drag.end." + d.el.id, d.end_scope || d.start_scope || d.move_scope || d.el, a);
    }

    Xb = [];
  }, $b = c.el = {}, _b = K.length; _b--;) {
    !function (a) {
      c[a] = $b[a] = function (b, d) {
        return c.is(b, "function") && (this.events = this.events || [], this.events.push({
          name: a,
          f: b,
          unbind: Wb(this.shape || this.node || A.doc, a, b, d || this)
        })), this;
      }, c["un" + a] = $b["un" + a] = function (b) {
        for (var d = this.events || [], e = d.length; e--;) {
          d[e].name != a || !c.is(b, "undefined") && d[e].f != b || (d[e].unbind(), d.splice(e, 1), !d.length && delete this.events);
        }

        return this;
      };
    }(K[_b]);
  }

  $b.data = function (a, d) {
    var e = kb[this.id] = kb[this.id] || {};
    if (0 == arguments.length) return e;

    if (1 == arguments.length) {
      if (c.is(a, "object")) {
        for (var f in a) {
          a[z](f) && this.data(f, a[f]);
        }

        return this;
      }

      return b("raphael.data.get." + this.id, this, e[a], a), e[a];
    }

    return e[a] = d, b("raphael.data.set." + this.id, this, d, a), this;
  }, $b.removeData = function (a) {
    return null == a ? kb[this.id] = {} : kb[this.id] && delete kb[this.id][a], this;
  }, $b.getData = function () {
    return d(kb[this.id] || {});
  }, $b.hover = function (a, b, c, d) {
    return this.mouseover(a, c).mouseout(b, d || c);
  }, $b.unhover = function (a, b) {
    return this.unmouseover(a).unmouseout(b);
  };
  var ac = [];
  $b.drag = function (a, d, e, f, g, h) {
    function i(i) {
      (i.originalEvent || i).preventDefault();
      var j = i.clientX,
          k = i.clientY,
          l = A.doc.documentElement.scrollTop || A.doc.body.scrollTop,
          m = A.doc.documentElement.scrollLeft || A.doc.body.scrollLeft;
      if (this._drag.id = i.identifier, F && i.touches) for (var n, o = i.touches.length; o--;) {
        if (n = i.touches[o], this._drag.id = n.identifier, n.identifier == this._drag.id) {
          j = n.clientX, k = n.clientY;
          break;
        }
      }
      this._drag.x = j + m, this._drag.y = k + l, !Xb.length && c.mousemove(Yb).mouseup(Zb), Xb.push({
        el: this,
        move_scope: f,
        start_scope: g,
        end_scope: h
      }), d && b.on("raphael.drag.start." + this.id, d), a && b.on("raphael.drag.move." + this.id, a), e && b.on("raphael.drag.end." + this.id, e), b("raphael.drag.start." + this.id, g || f || this, i.clientX + m, i.clientY + l, i);
    }

    return this._drag = {}, ac.push({
      el: this,
      start: i
    }), this.mousedown(i), this;
  }, $b.onDragOver = function (a) {
    a ? b.on("raphael.drag.over." + this.id, a) : b.unbind("raphael.drag.over." + this.id);
  }, $b.undrag = function () {
    for (var a = ac.length; a--;) {
      ac[a].el == this && (this.unmousedown(ac[a].start), ac.splice(a, 1), b.unbind("raphael.drag.*." + this.id));
    }

    !ac.length && c.unmousemove(Yb).unmouseup(Zb), Xb = [];
  }, v.circle = function (a, b, d) {
    var e = c._engine.circle(this, a || 0, b || 0, d || 0);

    return this.__set__ && this.__set__.push(e), e;
  }, v.rect = function (a, b, d, e, f) {
    var g = c._engine.rect(this, a || 0, b || 0, d || 0, e || 0, f || 0);

    return this.__set__ && this.__set__.push(g), g;
  }, v.ellipse = function (a, b, d, e) {
    var f = c._engine.ellipse(this, a || 0, b || 0, d || 0, e || 0);

    return this.__set__ && this.__set__.push(f), f;
  }, v.path = function (a) {
    a && !c.is(a, U) && !c.is(a[0], V) && (a += G);

    var b = c._engine.path(c.format[D](c, arguments), this);

    return this.__set__ && this.__set__.push(b), b;
  }, v.image = function (a, b, d, e, f) {
    var g = c._engine.image(this, a || "about:blank", b || 0, d || 0, e || 0, f || 0);

    return this.__set__ && this.__set__.push(g), g;
  }, v.text = function (a, b, d) {
    var e = c._engine.text(this, a || 0, b || 0, I(d));

    return this.__set__ && this.__set__.push(e), e;
  }, v.set = function (a) {
    !c.is(a, "array") && (a = Array.prototype.splice.call(arguments, 0, arguments.length));
    var b = new mc(a);
    return this.__set__ && this.__set__.push(b), b.paper = this, b.type = "set", b;
  }, v.setStart = function (a) {
    this.__set__ = a || this.set();
  }, v.setFinish = function () {
    var a = this.__set__;
    return delete this.__set__, a;
  }, v.setSize = function (a, b) {
    return c._engine.setSize.call(this, a, b);
  }, v.setViewBox = function (a, b, d, e, f) {
    return c._engine.setViewBox.call(this, a, b, d, e, f);
  }, v.top = v.bottom = null, v.raphael = c;

  var bc = function bc(a) {
    var b = a.getBoundingClientRect(),
        c = a.ownerDocument,
        d = c.body,
        e = c.documentElement,
        f = e.clientTop || d.clientTop || 0,
        g = e.clientLeft || d.clientLeft || 0,
        h = b.top + (A.win.pageYOffset || e.scrollTop || d.scrollTop) - f,
        i = b.left + (A.win.pageXOffset || e.scrollLeft || d.scrollLeft) - g;
    return {
      y: h,
      x: i
    };
  };

  v.getElementByPoint = function (a, b) {
    var c = this,
        d = c.canvas,
        e = A.doc.elementFromPoint(a, b);

    if (A.win.opera && "svg" == e.tagName) {
      var f = bc(d),
          g = d.createSVGRect();
      g.x = a - f.x, g.y = b - f.y, g.width = g.height = 1;
      var h = d.getIntersectionList(g, null);
      h.length && (e = h[h.length - 1]);
    }

    if (!e) return null;

    for (; e.parentNode && e != d.parentNode && !e.raphael;) {
      e = e.parentNode;
    }

    return e == c.canvas.parentNode && (e = d), e = e && e.raphael ? c.getById(e.raphaelid) : null;
  }, v.getElementsByBBox = function (a) {
    var b = this.set();
    return this.forEach(function (d) {
      c.isBBoxIntersect(d.getBBox(), a) && b.push(d);
    }), b;
  }, v.getById = function (a) {
    for (var b = this.bottom; b;) {
      if (b.id == a) return b;
      b = b.next;
    }

    return null;
  }, v.forEach = function (a, b) {
    for (var c = this.bottom; c;) {
      if (a.call(b, c) === !1) return this;
      c = c.next;
    }

    return this;
  }, v.getElementsByPoint = function (a, b) {
    var c = this.set();
    return this.forEach(function (d) {
      d.isPointInside(a, b) && c.push(d);
    }), c;
  }, $b.isPointInside = function (a, b) {
    var d = this.realPath = qb[this.type](this);
    return this.attr("transform") && this.attr("transform").length && (d = c.transformPath(d, this.attr("transform"))), c.isPointInsidePath(d, a, b);
  }, $b.getBBox = function (a) {
    if (this.removed) return {};
    var b = this._;
    return a ? ((b.dirty || !b.bboxwt) && (this.realPath = qb[this.type](this), b.bboxwt = Bb(this.realPath), b.bboxwt.toString = p, b.dirty = 0), b.bboxwt) : ((b.dirty || b.dirtyT || !b.bbox) && ((b.dirty || !this.realPath) && (b.bboxwt = 0, this.realPath = qb[this.type](this)), b.bbox = Bb(rb(this.realPath, this.matrix)), b.bbox.toString = p, b.dirty = b.dirtyT = 0), b.bbox);
  }, $b.clone = function () {
    if (this.removed) return null;
    var a = this.paper[this.type]().attr(this.attr());
    return this.__set__ && this.__set__.push(a), a;
  }, $b.glow = function (a) {
    if ("text" == this.type) return null;
    a = a || {};
    var b = {
      width: (a.width || 10) + (+this.attr("stroke-width") || 1),
      fill: a.fill || !1,
      opacity: a.opacity || .5,
      offsetx: a.offsetx || 0,
      offsety: a.offsety || 0,
      color: a.color || "#000"
    },
        c = b.width / 2,
        d = this.paper,
        e = d.set(),
        f = this.realPath || qb[this.type](this);
    f = this.matrix ? rb(f, this.matrix) : f;

    for (var g = 1; c + 1 > g; g++) {
      e.push(d.path(f).attr({
        stroke: b.color,
        fill: b.fill ? b.color : "none",
        "stroke-linejoin": "round",
        "stroke-linecap": "round",
        "stroke-width": +(b.width / c * g).toFixed(3),
        opacity: +(b.opacity / c).toFixed(3)
      }));
    }

    return e.insertBefore(this).translate(b.offsetx, b.offsety);
  };

  var cc = function cc(a, b, d, e, f, g, h, i, l) {
    return null == l ? j(a, b, d, e, f, g, h, i) : c.findDotsAtSegment(a, b, d, e, f, g, h, i, k(a, b, d, e, f, g, h, i, l));
  },
      dc = function dc(a, b) {
    return function (d, e, f) {
      d = Kb(d);

      for (var g, h, i, j, k, l = "", m = {}, n = 0, o = 0, p = d.length; p > o; o++) {
        if (i = d[o], "M" == i[0]) g = +i[1], h = +i[2];else {
          if (j = cc(g, h, i[1], i[2], i[3], i[4], i[5], i[6]), n + j > e) {
            if (b && !m.start) {
              if (k = cc(g, h, i[1], i[2], i[3], i[4], i[5], i[6], e - n), l += ["C" + k.start.x, k.start.y, k.m.x, k.m.y, k.x, k.y], f) return l;
              m.start = l, l = ["M" + k.x, k.y + "C" + k.n.x, k.n.y, k.end.x, k.end.y, i[5], i[6]].join(), n += j, g = +i[5], h = +i[6];
              continue;
            }

            if (!a && !b) return k = cc(g, h, i[1], i[2], i[3], i[4], i[5], i[6], e - n), {
              x: k.x,
              y: k.y,
              alpha: k.alpha
            };
          }

          n += j, g = +i[5], h = +i[6];
        }
        l += i.shift() + i;
      }

      return m.end = l, k = a ? n : b ? m : c.findDotsAtSegment(g, h, i[0], i[1], i[2], i[3], i[4], i[5], 1), k.alpha && (k = {
        x: k.x,
        y: k.y,
        alpha: k.alpha
      }), k;
    };
  },
      ec = dc(1),
      fc = dc(),
      gc = dc(0, 1);

  c.getTotalLength = ec, c.getPointAtLength = fc, c.getSubpath = function (a, b, c) {
    if (this.getTotalLength(a) - c < 1e-6) return gc(a, b).end;
    var d = gc(a, c, 1);
    return b ? gc(d, b).end : d;
  }, $b.getTotalLength = function () {
    var a = this.getPath();
    if (a) return this.node.getTotalLength ? this.node.getTotalLength() : ec(a);
  }, $b.getPointAtLength = function (a) {
    var b = this.getPath();
    if (b) return fc(b, a);
  }, $b.getPath = function () {
    var a,
        b = c._getPath[this.type];
    if ("text" != this.type && "set" != this.type) return b && (a = b(this)), a;
  }, $b.getSubpath = function (a, b) {
    var d = this.getPath();
    if (d) return c.getSubpath(d, a, b);
  };
  var hc = c.easing_formulas = {
    linear: function linear(a) {
      return a;
    },
    "<": function _(a) {
      return R(a, 1.7);
    },
    ">": function _(a) {
      return R(a, .48);
    },
    "<>": function _(a) {
      var b = .48 - a / 1.04,
          c = N.sqrt(.1734 + b * b),
          d = c - b,
          e = R(Q(d), 1 / 3) * (0 > d ? -1 : 1),
          f = -c - b,
          g = R(Q(f), 1 / 3) * (0 > f ? -1 : 1),
          h = e + g + .5;
      return 3 * (1 - h) * h * h + h * h * h;
    },
    backIn: function backIn(a) {
      var b = 1.70158;
      return a * a * ((b + 1) * a - b);
    },
    backOut: function backOut(a) {
      a -= 1;
      var b = 1.70158;
      return a * a * ((b + 1) * a + b) + 1;
    },
    elastic: function elastic(a) {
      return a == !!a ? a : R(2, -10 * a) * N.sin((a - .075) * 2 * S / .3) + 1;
    },
    bounce: function bounce(a) {
      var b,
          c = 7.5625,
          d = 2.75;
      return 1 / d > a ? b = c * a * a : 2 / d > a ? (a -= 1.5 / d, b = c * a * a + .75) : 2.5 / d > a ? (a -= 2.25 / d, b = c * a * a + .9375) : (a -= 2.625 / d, b = c * a * a + .984375), b;
    }
  };
  hc.easeIn = hc["ease-in"] = hc["<"], hc.easeOut = hc["ease-out"] = hc[">"], hc.easeInOut = hc["ease-in-out"] = hc["<>"], hc["back-in"] = hc.backIn, hc["back-out"] = hc.backOut;

  var ic = [],
      jc = a.requestAnimationFrame || a.webkitRequestAnimationFrame || a.mozRequestAnimationFrame || a.oRequestAnimationFrame || a.msRequestAnimationFrame || function (a) {
    setTimeout(a, 16);
  },
      kc = function kc() {
    for (var a = +new Date(), d = 0; d < ic.length; d++) {
      var e = ic[d];

      if (!e.el.removed && !e.paused) {
        var f,
            g,
            h = a - e.start,
            i = e.ms,
            j = e.easing,
            k = e.from,
            l = e.diff,
            m = e.to,
            n = (e.t, e.el),
            o = {},
            p = {};
        if (e.initstatus ? (h = (e.initstatus * e.anim.top - e.prev) / (e.percent - e.prev) * i, e.status = e.initstatus, delete e.initstatus, e.stop && ic.splice(d--, 1)) : e.status = (e.prev + (e.percent - e.prev) * (h / i)) / e.anim.top, !(0 > h)) if (i > h) {
          var q = j(h / i);

          for (var r in k) {
            if (k[z](r)) {
              switch (db[r]) {
                case T:
                  f = +k[r] + q * i * l[r];
                  break;

                case "colour":
                  f = "rgb(" + [lc($(k[r].r + q * i * l[r].r)), lc($(k[r].g + q * i * l[r].g)), lc($(k[r].b + q * i * l[r].b))].join(",") + ")";
                  break;

                case "path":
                  f = [];

                  for (var t = 0, u = k[r].length; u > t; t++) {
                    f[t] = [k[r][t][0]];

                    for (var v = 1, w = k[r][t].length; w > v; v++) {
                      f[t][v] = +k[r][t][v] + q * i * l[r][t][v];
                    }

                    f[t] = f[t].join(H);
                  }

                  f = f.join(H);
                  break;

                case "transform":
                  if (l[r].real) for (f = [], t = 0, u = k[r].length; u > t; t++) {
                    for (f[t] = [k[r][t][0]], v = 1, w = k[r][t].length; w > v; v++) {
                      f[t][v] = k[r][t][v] + q * i * l[r][t][v];
                    }
                  } else {
                    var x = function x(a) {
                      return +k[r][a] + q * i * l[r][a];
                    };

                    f = [["m", x(0), x(1), x(2), x(3), x(4), x(5)]];
                  }
                  break;

                case "csv":
                  if ("clip-rect" == r) for (f = [], t = 4; t--;) {
                    f[t] = +k[r][t] + q * i * l[r][t];
                  }
                  break;

                default:
                  var y = [][E](k[r]);

                  for (f = [], t = n.paper.customAttributes[r].length; t--;) {
                    f[t] = +y[t] + q * i * l[r][t];
                  }

              }

              o[r] = f;
            }
          }

          n.attr(o), function (a, c, d) {
            setTimeout(function () {
              b("raphael.anim.frame." + a, c, d);
            });
          }(n.id, n, e.anim);
        } else {
          if (function (a, d, e) {
            setTimeout(function () {
              b("raphael.anim.frame." + d.id, d, e), b("raphael.anim.finish." + d.id, d, e), c.is(a, "function") && a.call(d);
            });
          }(e.callback, n, e.anim), n.attr(m), ic.splice(d--, 1), e.repeat > 1 && !e.next) {
            for (g in m) {
              m[z](g) && (p[g] = e.totalOrigin[g]);
            }

            e.el.attr(p), s(e.anim, e.el, e.anim.percents[0], null, e.totalOrigin, e.repeat - 1);
          }

          e.next && !e.stop && s(e.anim, e.el, e.next, null, e.totalOrigin, e.repeat);
        }
      }
    }

    c.svg && n && n.paper && n.paper.safari(), ic.length && jc(kc);
  },
      lc = function lc(a) {
    return a > 255 ? 255 : 0 > a ? 0 : a;
  };

  $b.animateWith = function (a, b, d, e, f, g) {
    var h = this;
    if (h.removed) return g && g.call(h), h;
    var i = d instanceof r ? d : c.animation(d, e, f, g);
    s(i, h, i.percents[0], null, h.attr());

    for (var j = 0, k = ic.length; k > j; j++) {
      if (ic[j].anim == b && ic[j].el == a) {
        ic[k - 1].start = ic[j].start;
        break;
      }
    }

    return h;
  }, $b.onAnimation = function (a) {
    return a ? b.on("raphael.anim.frame." + this.id, a) : b.unbind("raphael.anim.frame." + this.id), this;
  }, r.prototype.delay = function (a) {
    var b = new r(this.anim, this.ms);
    return b.times = this.times, b.del = +a || 0, b;
  }, r.prototype.repeat = function (a) {
    var b = new r(this.anim, this.ms);
    return b.del = this.del, b.times = N.floor(O(a, 0)) || 1, b;
  }, c.animation = function (a, b, d, e) {
    if (a instanceof r) return a;
    (c.is(d, "function") || !d) && (e = e || d || null, d = null), a = Object(a), b = +b || 0;
    var f,
        g,
        h = {};

    for (g in a) {
      a[z](g) && _(g) != g && _(g) + "%" != g && (f = !0, h[g] = a[g]);
    }

    return f ? (d && (h.easing = d), e && (h.callback = e), new r({
      100: h
    }, b)) : new r(a, b);
  }, $b.animate = function (a, b, d, e) {
    var f = this;
    if (f.removed) return e && e.call(f), f;
    var g = a instanceof r ? a : c.animation(a, b, d, e);
    return s(g, f, g.percents[0], null, f.attr()), f;
  }, $b.setTime = function (a, b) {
    return a && null != b && this.status(a, P(b, a.ms) / a.ms), this;
  }, $b.status = function (a, b) {
    var c,
        d,
        e = [],
        f = 0;
    if (null != b) return s(a, this, -1, P(b, 1)), this;

    for (c = ic.length; c > f; f++) {
      if (d = ic[f], d.el.id == this.id && (!a || d.anim == a)) {
        if (a) return d.status;
        e.push({
          anim: d.anim,
          status: d.status
        });
      }
    }

    return a ? 0 : e;
  }, $b.pause = function (a) {
    for (var c = 0; c < ic.length; c++) {
      ic[c].el.id != this.id || a && ic[c].anim != a || b("raphael.anim.pause." + this.id, this, ic[c].anim) !== !1 && (ic[c].paused = !0);
    }

    return this;
  }, $b.resume = function (a) {
    for (var c = 0; c < ic.length; c++) {
      if (ic[c].el.id == this.id && (!a || ic[c].anim == a)) {
        var d = ic[c];
        b("raphael.anim.resume." + this.id, this, d.anim) !== !1 && (delete d.paused, this.status(d.anim, d.status));
      }
    }

    return this;
  }, $b.stop = function (a) {
    for (var c = 0; c < ic.length; c++) {
      ic[c].el.id != this.id || a && ic[c].anim != a || b("raphael.anim.stop." + this.id, this, ic[c].anim) !== !1 && ic.splice(c--, 1);
    }

    return this;
  }, b.on("raphael.remove", t), b.on("raphael.clear", t), $b.toString = function () {
    return "Raphaël’s object";
  };

  var mc = function mc(a) {
    if (this.items = [], this.length = 0, this.type = "set", a) for (var b = 0, c = a.length; c > b; b++) {
      !a[b] || a[b].constructor != $b.constructor && a[b].constructor != mc || (this[this.items.length] = this.items[this.items.length] = a[b], this.length++);
    }
  },
      nc = mc.prototype;

  nc.push = function () {
    for (var a, b, c = 0, d = arguments.length; d > c; c++) {
      a = arguments[c], !a || a.constructor != $b.constructor && a.constructor != mc || (b = this.items.length, this[b] = this.items[b] = a, this.length++);
    }

    return this;
  }, nc.pop = function () {
    return this.length && delete this[this.length--], this.items.pop();
  }, nc.forEach = function (a, b) {
    for (var c = 0, d = this.items.length; d > c; c++) {
      if (a.call(b, this.items[c], c) === !1) return this;
    }

    return this;
  };

  for (var oc in $b) {
    $b[z](oc) && (nc[oc] = function (a) {
      return function () {
        var b = arguments;
        return this.forEach(function (c) {
          c[a][D](c, b);
        });
      };
    }(oc));
  }

  return nc.attr = function (a, b) {
    if (a && c.is(a, V) && c.is(a[0], "object")) for (var d = 0, e = a.length; e > d; d++) {
      this.items[d].attr(a[d]);
    } else for (var f = 0, g = this.items.length; g > f; f++) {
      this.items[f].attr(a, b);
    }
    return this;
  }, nc.clear = function () {
    for (; this.length;) {
      this.pop();
    }
  }, nc.splice = function (a, b) {
    a = 0 > a ? O(this.length + a, 0) : a, b = O(0, P(this.length - a, b));
    var c,
        d = [],
        e = [],
        f = [];

    for (c = 2; c < arguments.length; c++) {
      f.push(arguments[c]);
    }

    for (c = 0; b > c; c++) {
      e.push(this[a + c]);
    }

    for (; c < this.length - a; c++) {
      d.push(this[a + c]);
    }

    var g = f.length;

    for (c = 0; c < g + d.length; c++) {
      this.items[a + c] = this[a + c] = g > c ? f[c] : d[c - g];
    }

    for (c = this.items.length = this.length -= b - g; this[c];) {
      delete this[c++];
    }

    return new mc(e);
  }, nc.exclude = function (a) {
    for (var b = 0, c = this.length; c > b; b++) {
      if (this[b] == a) return this.splice(b, 1), !0;
    }
  }, nc.animate = function (a, b, d, e) {
    (c.is(d, "function") || !d) && (e = d || null);
    var f,
        g,
        h = this.items.length,
        i = h,
        j = this;
    if (!h) return this;
    e && (g = function g() {
      ! --h && e.call(j);
    }), d = c.is(d, U) ? d : g;
    var k = c.animation(a, b, d, g);

    for (f = this.items[--i].animate(k); i--;) {
      this.items[i] && !this.items[i].removed && this.items[i].animateWith(f, k, k), this.items[i] && !this.items[i].removed || h--;
    }

    return this;
  }, nc.insertAfter = function (a) {
    for (var b = this.items.length; b--;) {
      this.items[b].insertAfter(a);
    }

    return this;
  }, nc.getBBox = function () {
    for (var a = [], b = [], c = [], d = [], e = this.items.length; e--;) {
      if (!this.items[e].removed) {
        var f = this.items[e].getBBox();
        a.push(f.x), b.push(f.y), c.push(f.x + f.width), d.push(f.y + f.height);
      }
    }

    return a = P[D](0, a), b = P[D](0, b), c = O[D](0, c), d = O[D](0, d), {
      x: a,
      y: b,
      x2: c,
      y2: d,
      width: c - a,
      height: d - b
    };
  }, nc.clone = function (a) {
    a = this.paper.set();

    for (var b = 0, c = this.items.length; c > b; b++) {
      a.push(this.items[b].clone());
    }

    return a;
  }, nc.toString = function () {
    return "Raphaël‘s set";
  }, nc.glow = function (a) {
    var b = this.paper.set();
    return this.forEach(function (c) {
      var d = c.glow(a);
      null != d && d.forEach(function (a) {
        b.push(a);
      });
    }), b;
  }, nc.isPointInside = function (a, b) {
    var c = !1;
    return this.forEach(function (d) {
      return d.isPointInside(a, b) ? (console.log("runned"), c = !0, !1) : void 0;
    }), c;
  }, c.registerFont = function (a) {
    if (!a.face) return a;
    this.fonts = this.fonts || {};
    var b = {
      w: a.w,
      face: {},
      glyphs: {}
    },
        c = a.face["font-family"];

    for (var d in a.face) {
      a.face[z](d) && (b.face[d] = a.face[d]);
    }

    if (this.fonts[c] ? this.fonts[c].push(b) : this.fonts[c] = [b], !a.svg) {
      b.face["units-per-em"] = ab(a.face["units-per-em"], 10);

      for (var e in a.glyphs) {
        if (a.glyphs[z](e)) {
          var f = a.glyphs[e];
          if (b.glyphs[e] = {
            w: f.w,
            k: {},
            d: f.d && "M" + f.d.replace(/[mlcxtrv]/g, function (a) {
              return {
                l: "L",
                c: "C",
                x: "z",
                t: "m",
                r: "l",
                v: "c"
              }[a] || "M";
            }) + "z"
          }, f.k) for (var g in f.k) {
            f[z](g) && (b.glyphs[e].k[g] = f.k[g]);
          }
        }
      }
    }

    return a;
  }, v.getFont = function (a, b, d, e) {
    if (e = e || "normal", d = d || "normal", b = +b || {
      normal: 400,
      bold: 700,
      lighter: 300,
      bolder: 800
    }[b] || 400, c.fonts) {
      var f = c.fonts[a];

      if (!f) {
        var g = new RegExp("(^|\\s)" + a.replace(/[^\w\d\s+!~.:_-]/g, G) + "(\\s|$)", "i");

        for (var h in c.fonts) {
          if (c.fonts[z](h) && g.test(h)) {
            f = c.fonts[h];
            break;
          }
        }
      }

      var i;
      if (f) for (var j = 0, k = f.length; k > j && (i = f[j], i.face["font-weight"] != b || i.face["font-style"] != d && i.face["font-style"] || i.face["font-stretch"] != e); j++) {
        ;
      }
      return i;
    }
  }, v.print = function (a, b, d, e, f, g, h, i) {
    g = g || "middle", h = O(P(h || 0, 1), -1), i = O(P(i || 1, 3), 1);
    var j,
        k = I(d)[J](G),
        l = 0,
        m = 0,
        n = G;

    if (c.is(e, "string") && (e = this.getFont(e)), e) {
      j = (f || 16) / e.face["units-per-em"];

      for (var o = e.face.bbox[J](w), p = +o[0], q = o[3] - o[1], r = 0, s = +o[1] + ("baseline" == g ? q + +e.face.descent : q / 2), t = 0, u = k.length; u > t; t++) {
        if ("\n" == k[t]) l = 0, x = 0, m = 0, r += q * i;else {
          var v = m && e.glyphs[k[t - 1]] || {},
              x = e.glyphs[k[t]];
          l += m ? (v.w || e.w) + (v.k && v.k[k[t]] || 0) + e.w * h : 0, m = 1;
        }
        x && x.d && (n += c.transformPath(x.d, ["t", l * j, r * j, "s", j, j, p, s, "t", (a - p) / j, (b - s) / j]));
      }
    }

    return this.path(n).attr({
      fill: "#000",
      stroke: "none"
    });
  }, v.add = function (a) {
    if (c.is(a, "array")) for (var b, d = this.set(), e = 0, f = a.length; f > e; e++) {
      b = a[e] || {}, x[z](b.type) && d.push(this[b.type]().attr(b));
    }
    return d;
  }, c.format = function (a, b) {
    var d = c.is(b, V) ? [0][E](b) : arguments;
    return a && c.is(a, U) && d.length - 1 && (a = a.replace(y, function (a, b) {
      return null == d[++b] ? G : d[b];
    })), a || G;
  }, c.fullfill = function () {
    var a = /\{([^\}]+)\}/g,
        b = /(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,
        c = function c(a, _c, d) {
      var e = d;
      return _c.replace(b, function (a, b, c, d, f) {
        b = b || d, e && (b in e && (e = e[b]), "function" == typeof e && f && (e = e()));
      }), e = (null == e || e == d ? a : e) + "";
    };

    return function (b, d) {
      return String(b).replace(a, function (a, b) {
        return c(a, b, d);
      });
    };
  }(), c.ninja = function () {
    return B.was ? A.win.Raphael = B.is : delete Raphael, c;
  }, c.st = nc, function (a, b, _d) {
    function e() {
      /in/.test(a.readyState) ? setTimeout(e, 9) : c.eve("raphael.DOMload");
    }

    null == a.readyState && a.addEventListener && (a.addEventListener(b, _d = function d() {
      a.removeEventListener(b, _d, !1), a.readyState = "complete";
    }, !1), a.readyState = "loading"), e();
  }(document, "DOMContentLoaded"), b.on("raphael.DOMload", function () {
    u = !0;
  }), function () {
    if (c.svg) {
      var a = "hasOwnProperty",
          b = String,
          d = parseFloat,
          e = parseInt,
          f = Math,
          g = f.max,
          h = f.abs,
          i = f.pow,
          j = /[, ]+/,
          k = c.eve,
          l = "",
          m = " ",
          n = "http://www.w3.org/1999/xlink",
          o = {
        block: "M5,0 0,2.5 5,5z",
        classic: "M5,0 0,2.5 5,5 3.5,3 3.5,2z",
        diamond: "M2.5,0 5,2.5 2.5,5 0,2.5z",
        open: "M6,1 1,3.5 6,6",
        oval: "M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"
      },
          p = {};

      c.toString = function () {
        return "Your browser supports SVG.\nYou are running Raphaël " + this.version;
      };

      var q = function q(d, e) {
        if (e) {
          "string" == typeof d && (d = q(d));

          for (var f in e) {
            e[a](f) && ("xlink:" == f.substring(0, 6) ? d.setAttributeNS(n, f.substring(6), b(e[f])) : d.setAttribute(f, b(e[f])));
          }
        } else d = c._g.doc.createElementNS("http://www.w3.org/2000/svg", d), d.style && (d.style.webkitTapHighlightColor = "rgba(0,0,0,0)");

        return d;
      },
          r = function r(a, e) {
        var j = "linear",
            k = a.id + e,
            m = .5,
            n = .5,
            o = a.node,
            p = a.paper,
            r = o.style,
            s = c._g.doc.getElementById(k);

        if (!s) {
          if (e = b(e).replace(c._radial_gradient, function (a, b, c) {
            if (j = "radial", b && c) {
              m = d(b), n = d(c);
              var e = 2 * (n > .5) - 1;
              i(m - .5, 2) + i(n - .5, 2) > .25 && (n = f.sqrt(.25 - i(m - .5, 2)) * e + .5) && .5 != n && (n = n.toFixed(5) - 1e-5 * e);
            }

            return l;
          }), e = e.split(/\s*\-\s*/), "linear" == j) {
            var t = e.shift();
            if (t = -d(t), isNaN(t)) return null;
            var u = [0, 0, f.cos(c.rad(t)), f.sin(c.rad(t))],
                v = 1 / (g(h(u[2]), h(u[3])) || 1);
            u[2] *= v, u[3] *= v, u[2] < 0 && (u[0] = -u[2], u[2] = 0), u[3] < 0 && (u[1] = -u[3], u[3] = 0);
          }

          var w = c._parseDots(e);

          if (!w) return null;

          if (k = k.replace(/[\(\)\s,\xb0#]/g, "_"), a.gradient && k != a.gradient.id && (p.defs.removeChild(a.gradient), delete a.gradient), !a.gradient) {
            s = q(j + "Gradient", {
              id: k
            }), a.gradient = s, q(s, "radial" == j ? {
              fx: m,
              fy: n
            } : {
              x1: u[0],
              y1: u[1],
              x2: u[2],
              y2: u[3],
              gradientTransform: a.matrix.invert()
            }), p.defs.appendChild(s);

            for (var x = 0, y = w.length; y > x; x++) {
              s.appendChild(q("stop", {
                offset: w[x].offset ? w[x].offset : x ? "100%" : "0%",
                "stop-color": w[x].color || "#fff"
              }));
            }
          }
        }

        return q(o, {
          fill: "url(#" + k + ")",
          opacity: 1,
          "fill-opacity": 1
        }), r.fill = l, r.opacity = 1, r.fillOpacity = 1, 1;
      },
          s = function s(a) {
        var b = a.getBBox(1);
        q(a.pattern, {
          patternTransform: a.matrix.invert() + " translate(" + b.x + "," + b.y + ")"
        });
      },
          t = function t(d, e, f) {
        if ("path" == d.type) {
          for (var g, h, i, j, k, m = b(e).toLowerCase().split("-"), n = d.paper, r = f ? "end" : "start", s = d.node, t = d.attrs, u = t["stroke-width"], v = m.length, w = "classic", x = 3, y = 3, z = 5; v--;) {
            switch (m[v]) {
              case "block":
              case "classic":
              case "oval":
              case "diamond":
              case "open":
              case "none":
                w = m[v];
                break;

              case "wide":
                y = 5;
                break;

              case "narrow":
                y = 2;
                break;

              case "long":
                x = 5;
                break;

              case "short":
                x = 2;
            }
          }

          if ("open" == w ? (x += 2, y += 2, z += 2, i = 1, j = f ? 4 : 1, k = {
            fill: "none",
            stroke: t.stroke
          }) : (j = i = x / 2, k = {
            fill: t.stroke,
            stroke: "none"
          }), d._.arrows ? f ? (d._.arrows.endPath && p[d._.arrows.endPath]--, d._.arrows.endMarker && p[d._.arrows.endMarker]--) : (d._.arrows.startPath && p[d._.arrows.startPath]--, d._.arrows.startMarker && p[d._.arrows.startMarker]--) : d._.arrows = {}, "none" != w) {
            var A = "raphael-marker-" + w,
                B = "raphael-marker-" + r + w + x + y;
            c._g.doc.getElementById(A) ? p[A]++ : (n.defs.appendChild(q(q("path"), {
              "stroke-linecap": "round",
              d: o[w],
              id: A
            })), p[A] = 1);

            var C,
                D = c._g.doc.getElementById(B);

            D ? (p[B]++, C = D.getElementsByTagName("use")[0]) : (D = q(q("marker"), {
              id: B,
              markerHeight: y,
              markerWidth: x,
              orient: "auto",
              refX: j,
              refY: y / 2
            }), C = q(q("use"), {
              "xlink:href": "#" + A,
              transform: (f ? "rotate(180 " + x / 2 + " " + y / 2 + ") " : l) + "scale(" + x / z + "," + y / z + ")",
              "stroke-width": (1 / ((x / z + y / z) / 2)).toFixed(4)
            }), D.appendChild(C), n.defs.appendChild(D), p[B] = 1), q(C, k);
            var E = i * ("diamond" != w && "oval" != w);
            f ? (g = d._.arrows.startdx * u || 0, h = c.getTotalLength(t.path) - E * u) : (g = E * u, h = c.getTotalLength(t.path) - (d._.arrows.enddx * u || 0)), k = {}, k["marker-" + r] = "url(#" + B + ")", (h || g) && (k.d = c.getSubpath(t.path, g, h)), q(s, k), d._.arrows[r + "Path"] = A, d._.arrows[r + "Marker"] = B, d._.arrows[r + "dx"] = E, d._.arrows[r + "Type"] = w, d._.arrows[r + "String"] = e;
          } else f ? (g = d._.arrows.startdx * u || 0, h = c.getTotalLength(t.path) - g) : (g = 0, h = c.getTotalLength(t.path) - (d._.arrows.enddx * u || 0)), d._.arrows[r + "Path"] && q(s, {
            d: c.getSubpath(t.path, g, h)
          }), delete d._.arrows[r + "Path"], delete d._.arrows[r + "Marker"], delete d._.arrows[r + "dx"], delete d._.arrows[r + "Type"], delete d._.arrows[r + "String"];

          for (k in p) {
            if (p[a](k) && !p[k]) {
              var F = c._g.doc.getElementById(k);

              F && F.parentNode.removeChild(F);
            }
          }
        }
      },
          u = {
        "": [0],
        none: [0],
        "-": [3, 1],
        ".": [1, 1],
        "-.": [3, 1, 1, 1],
        "-..": [3, 1, 1, 1, 1, 1],
        ". ": [1, 3],
        "- ": [4, 3],
        "--": [8, 3],
        "- .": [4, 3, 1, 3],
        "--.": [8, 3, 1, 3],
        "--..": [8, 3, 1, 3, 1, 3]
      },
          v = function v(a, c, d) {
        if (c = u[b(c).toLowerCase()]) {
          for (var e = a.attrs["stroke-width"] || "1", f = {
            round: e,
            square: e,
            butt: 0
          }[a.attrs["stroke-linecap"] || d["stroke-linecap"]] || 0, g = [], h = c.length; h--;) {
            g[h] = c[h] * e + (h % 2 ? 1 : -1) * f;
          }

          q(a.node, {
            "stroke-dasharray": g.join(",")
          });
        }
      },
          w = function w(d, f) {
        var i = d.node,
            k = d.attrs,
            m = i.style.visibility;
        i.style.visibility = "hidden";

        for (var o in f) {
          if (f[a](o)) {
            if (!c._availableAttrs[a](o)) continue;
            var p = f[o];

            switch (k[o] = p, o) {
              case "blur":
                d.blur(p);
                break;

              case "href":
              case "title":
                var u = q("title"),
                    w = c._g.doc.createTextNode(p);

                u.appendChild(w), i.appendChild(u);
                break;

              case "target":
                var x = i.parentNode;

                if ("a" != x.tagName.toLowerCase()) {
                  var u = q("a");
                  x.insertBefore(u, i), u.appendChild(i), x = u;
                }

                "target" == o ? x.setAttributeNS(n, "show", "blank" == p ? "new" : p) : x.setAttributeNS(n, o, p);
                break;

              case "cursor":
                i.style.cursor = p;
                break;

              case "transform":
                d.transform(p);
                break;

              case "arrow-start":
                t(d, p);
                break;

              case "arrow-end":
                t(d, p, 1);
                break;

              case "clip-rect":
                var z = b(p).split(j);

                if (4 == z.length) {
                  d.clip && d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);
                  var A = q("clipPath"),
                      B = q("rect");
                  A.id = c.createUUID(), q(B, {
                    x: z[0],
                    y: z[1],
                    width: z[2],
                    height: z[3]
                  }), A.appendChild(B), d.paper.defs.appendChild(A), q(i, {
                    "clip-path": "url(#" + A.id + ")"
                  }), d.clip = B;
                }

                if (!p) {
                  var C = i.getAttribute("clip-path");

                  if (C) {
                    var D = c._g.doc.getElementById(C.replace(/(^url\(#|\)$)/g, l));

                    D && D.parentNode.removeChild(D), q(i, {
                      "clip-path": l
                    }), delete d.clip;
                  }
                }

                break;

              case "path":
                "path" == d.type && (q(i, {
                  d: p ? k.path = c._pathToAbsolute(p) : "M0,0"
                }), d._.dirty = 1, d._.arrows && ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1)));
                break;

              case "width":
                if (i.setAttribute(o, p), d._.dirty = 1, !k.fx) break;
                o = "x", p = k.x;

              case "x":
                k.fx && (p = -k.x - (k.width || 0));

              case "rx":
                if ("rx" == o && "rect" == d.type) break;

              case "cx":
                i.setAttribute(o, p), d.pattern && s(d), d._.dirty = 1;
                break;

              case "height":
                if (i.setAttribute(o, p), d._.dirty = 1, !k.fy) break;
                o = "y", p = k.y;

              case "y":
                k.fy && (p = -k.y - (k.height || 0));

              case "ry":
                if ("ry" == o && "rect" == d.type) break;

              case "cy":
                i.setAttribute(o, p), d.pattern && s(d), d._.dirty = 1;
                break;

              case "r":
                "rect" == d.type ? q(i, {
                  rx: p,
                  ry: p
                }) : i.setAttribute(o, p), d._.dirty = 1;
                break;

              case "src":
                "image" == d.type && i.setAttributeNS(n, "href", p);
                break;

              case "stroke-width":
                (1 != d._.sx || 1 != d._.sy) && (p /= g(h(d._.sx), h(d._.sy)) || 1), d.paper._vbSize && (p *= d.paper._vbSize), i.setAttribute(o, p), k["stroke-dasharray"] && v(d, k["stroke-dasharray"], f), d._.arrows && ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1));
                break;

              case "stroke-dasharray":
                v(d, p, f);
                break;

              case "fill":
                var E = b(p).match(c._ISURL);

                if (E) {
                  A = q("pattern");
                  var F = q("image");
                  A.id = c.createUUID(), q(A, {
                    x: 0,
                    y: 0,
                    patternUnits: "userSpaceOnUse",
                    height: 1,
                    width: 1
                  }), q(F, {
                    x: 0,
                    y: 0,
                    "xlink:href": E[1]
                  }), A.appendChild(F), function (a) {
                    c._preload(E[1], function () {
                      var b = this.offsetWidth,
                          c = this.offsetHeight;
                      q(a, {
                        width: b,
                        height: c
                      }), q(F, {
                        width: b,
                        height: c
                      }), d.paper.safari();
                    });
                  }(A), d.paper.defs.appendChild(A), q(i, {
                    fill: "url(#" + A.id + ")"
                  }), d.pattern = A, d.pattern && s(d);
                  break;
                }

                var G = c.getRGB(p);

                if (G.error) {
                  if (("circle" == d.type || "ellipse" == d.type || "r" != b(p).charAt()) && r(d, p)) {
                    if ("opacity" in k || "fill-opacity" in k) {
                      var H = c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g, l));

                      if (H) {
                        var I = H.getElementsByTagName("stop");
                        q(I[I.length - 1], {
                          "stop-opacity": ("opacity" in k ? k.opacity : 1) * ("fill-opacity" in k ? k["fill-opacity"] : 1)
                        });
                      }
                    }

                    k.gradient = p, k.fill = "none";
                    break;
                  }
                } else delete f.gradient, delete k.gradient, !c.is(k.opacity, "undefined") && c.is(f.opacity, "undefined") && q(i, {
                  opacity: k.opacity
                }), !c.is(k["fill-opacity"], "undefined") && c.is(f["fill-opacity"], "undefined") && q(i, {
                  "fill-opacity": k["fill-opacity"]
                });

                G[a]("opacity") && q(i, {
                  "fill-opacity": G.opacity > 1 ? G.opacity / 100 : G.opacity
                });

              case "stroke":
                G = c.getRGB(p), i.setAttribute(o, G.hex), "stroke" == o && G[a]("opacity") && q(i, {
                  "stroke-opacity": G.opacity > 1 ? G.opacity / 100 : G.opacity
                }), "stroke" == o && d._.arrows && ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1));
                break;

              case "gradient":
                ("circle" == d.type || "ellipse" == d.type || "r" != b(p).charAt()) && r(d, p);
                break;

              case "opacity":
                k.gradient && !k[a]("stroke-opacity") && q(i, {
                  "stroke-opacity": p > 1 ? p / 100 : p
                });

              case "fill-opacity":
                if (k.gradient) {
                  H = c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g, l)), H && (I = H.getElementsByTagName("stop"), q(I[I.length - 1], {
                    "stop-opacity": p
                  }));
                  break;
                }

              default:
                "font-size" == o && (p = e(p, 10) + "px");
                var J = o.replace(/(\-.)/g, function (a) {
                  return a.substring(1).toUpperCase();
                });
                i.style[J] = p, d._.dirty = 1, i.setAttribute(o, p);
            }
          }
        }

        y(d, f), i.style.visibility = m;
      },
          x = 1.2,
          y = function y(d, f) {
        if ("text" == d.type && (f[a]("text") || f[a]("font") || f[a]("font-size") || f[a]("x") || f[a]("y"))) {
          var g = d.attrs,
              h = d.node,
              i = h.firstChild ? e(c._g.doc.defaultView.getComputedStyle(h.firstChild, l).getPropertyValue("font-size"), 10) : 10;

          if (f[a]("text")) {
            for (g.text = f.text; h.firstChild;) {
              h.removeChild(h.firstChild);
            }

            for (var j, k = b(f.text).split("\n"), m = [], n = 0, o = k.length; o > n; n++) {
              j = q("tspan"), n && q(j, {
                dy: i * x,
                x: g.x
              }), j.appendChild(c._g.doc.createTextNode(k[n])), h.appendChild(j), m[n] = j;
            }
          } else for (m = h.getElementsByTagName("tspan"), n = 0, o = m.length; o > n; n++) {
            n ? q(m[n], {
              dy: i * x,
              x: g.x
            }) : q(m[0], {
              dy: 0
            });
          }

          q(h, {
            x: g.x,
            y: g.y
          }), d._.dirty = 1;

          var p = d._getBBox(),
              r = g.y - (p.y + p.height / 2);

          r && c.is(r, "finite") && q(m[0], {
            dy: r
          });
        }
      },
          z = function z(a, b) {
        this[0] = this.node = a, a.raphael = !0, this.id = c._oid++, a.raphaelid = this.id, this.matrix = c.matrix(), this.realPath = null, this.paper = b, this.attrs = this.attrs || {}, this._ = {
          transform: [],
          sx: 1,
          sy: 1,
          deg: 0,
          dx: 0,
          dy: 0,
          dirty: 1
        }, !b.bottom && (b.bottom = this), this.prev = b.top, b.top && (b.top.next = this), b.top = this, this.next = null;
      },
          A = c.el;

      z.prototype = A, A.constructor = z, c._engine.path = function (a, b) {
        var c = q("path");
        b.canvas && b.canvas.appendChild(c);
        var d = new z(c, b);
        return d.type = "path", w(d, {
          fill: "none",
          stroke: "#000",
          path: a
        }), d;
      }, A.rotate = function (a, c, e) {
        if (this.removed) return this;

        if (a = b(a).split(j), a.length - 1 && (c = d(a[1]), e = d(a[2])), a = d(a[0]), null == e && (c = e), null == c || null == e) {
          var f = this.getBBox(1);
          c = f.x + f.width / 2, e = f.y + f.height / 2;
        }

        return this.transform(this._.transform.concat([["r", a, c, e]])), this;
      }, A.scale = function (a, c, e, f) {
        if (this.removed) return this;
        if (a = b(a).split(j), a.length - 1 && (c = d(a[1]), e = d(a[2]), f = d(a[3])), a = d(a[0]), null == c && (c = a), null == f && (e = f), null == e || null == f) var g = this.getBBox(1);
        return e = null == e ? g.x + g.width / 2 : e, f = null == f ? g.y + g.height / 2 : f, this.transform(this._.transform.concat([["s", a, c, e, f]])), this;
      }, A.translate = function (a, c) {
        return this.removed ? this : (a = b(a).split(j), a.length - 1 && (c = d(a[1])), a = d(a[0]) || 0, c = +c || 0, this.transform(this._.transform.concat([["t", a, c]])), this);
      }, A.transform = function (b) {
        var d = this._;
        if (null == b) return d.transform;

        if (c._extractTransform(this, b), this.clip && q(this.clip, {
          transform: this.matrix.invert()
        }), this.pattern && s(this), this.node && q(this.node, {
          transform: this.matrix
        }), 1 != d.sx || 1 != d.sy) {
          var e = this.attrs[a]("stroke-width") ? this.attrs["stroke-width"] : 1;
          this.attr({
            "stroke-width": e
          });
        }

        return this;
      }, A.hide = function () {
        return !this.removed && this.paper.safari(this.node.style.display = "none"), this;
      }, A.show = function () {
        return !this.removed && this.paper.safari(this.node.style.display = ""), this;
      }, A.remove = function () {
        if (!this.removed && this.node.parentNode) {
          var a = this.paper;
          a.__set__ && a.__set__.exclude(this), k.unbind("raphael.*.*." + this.id), this.gradient && a.defs.removeChild(this.gradient), c._tear(this, a), "a" == this.node.parentNode.tagName.toLowerCase() ? this.node.parentNode.parentNode.removeChild(this.node.parentNode) : this.node.parentNode.removeChild(this.node);

          for (var b in this) {
            this[b] = "function" == typeof this[b] ? c._removedFactory(b) : null;
          }

          this.removed = !0;
        }
      }, A._getBBox = function () {
        if ("none" == this.node.style.display) {
          this.show();
          var a = !0;
        }

        var b = {};

        try {
          b = this.node.getBBox();
        } catch (c) {} finally {
          b = b || {};
        }

        return a && this.hide(), b;
      }, A.attr = function (b, d) {
        if (this.removed) return this;

        if (null == b) {
          var e = {};

          for (var f in this.attrs) {
            this.attrs[a](f) && (e[f] = this.attrs[f]);
          }

          return e.gradient && "none" == e.fill && (e.fill = e.gradient) && delete e.gradient, e.transform = this._.transform, e;
        }

        if (null == d && c.is(b, "string")) {
          if ("fill" == b && "none" == this.attrs.fill && this.attrs.gradient) return this.attrs.gradient;
          if ("transform" == b) return this._.transform;

          for (var g = b.split(j), h = {}, i = 0, l = g.length; l > i; i++) {
            b = g[i], h[b] = b in this.attrs ? this.attrs[b] : c.is(this.paper.customAttributes[b], "function") ? this.paper.customAttributes[b].def : c._availableAttrs[b];
          }

          return l - 1 ? h : h[g[0]];
        }

        if (null == d && c.is(b, "array")) {
          for (h = {}, i = 0, l = b.length; l > i; i++) {
            h[b[i]] = this.attr(b[i]);
          }

          return h;
        }

        if (null != d) {
          var m = {};
          m[b] = d;
        } else null != b && c.is(b, "object") && (m = b);

        for (var n in m) {
          k("raphael.attr." + n + "." + this.id, this, m[n]);
        }

        for (n in this.paper.customAttributes) {
          if (this.paper.customAttributes[a](n) && m[a](n) && c.is(this.paper.customAttributes[n], "function")) {
            var o = this.paper.customAttributes[n].apply(this, [].concat(m[n]));
            this.attrs[n] = m[n];

            for (var p in o) {
              o[a](p) && (m[p] = o[p]);
            }
          }
        }

        return w(this, m), this;
      }, A.toFront = function () {
        if (this.removed) return this;
        "a" == this.node.parentNode.tagName.toLowerCase() ? this.node.parentNode.parentNode.appendChild(this.node.parentNode) : this.node.parentNode.appendChild(this.node);
        var a = this.paper;
        return a.top != this && c._tofront(this, a), this;
      }, A.toBack = function () {
        if (this.removed) return this;
        var a = this.node.parentNode;
        return "a" == a.tagName.toLowerCase() ? a.parentNode.insertBefore(this.node.parentNode, this.node.parentNode.parentNode.firstChild) : a.firstChild != this.node && a.insertBefore(this.node, this.node.parentNode.firstChild), c._toback(this, this.paper), this.paper, this;
      }, A.insertAfter = function (a) {
        if (this.removed) return this;
        var b = a.node || a[a.length - 1].node;
        return b.nextSibling ? b.parentNode.insertBefore(this.node, b.nextSibling) : b.parentNode.appendChild(this.node), c._insertafter(this, a, this.paper), this;
      }, A.insertBefore = function (a) {
        if (this.removed) return this;
        var b = a.node || a[0].node;
        return b.parentNode.insertBefore(this.node, b), c._insertbefore(this, a, this.paper), this;
      }, A.blur = function (a) {
        var b = this;

        if (0 !== +a) {
          var d = q("filter"),
              e = q("feGaussianBlur");
          b.attrs.blur = a, d.id = c.createUUID(), q(e, {
            stdDeviation: +a || 1.5
          }), d.appendChild(e), b.paper.defs.appendChild(d), b._blur = d, q(b.node, {
            filter: "url(#" + d.id + ")"
          });
        } else b._blur && (b._blur.parentNode.removeChild(b._blur), delete b._blur, delete b.attrs.blur), b.node.removeAttribute("filter");

        return b;
      }, c._engine.circle = function (a, b, c, d) {
        var e = q("circle");
        a.canvas && a.canvas.appendChild(e);
        var f = new z(e, a);
        return f.attrs = {
          cx: b,
          cy: c,
          r: d,
          fill: "none",
          stroke: "#000"
        }, f.type = "circle", q(e, f.attrs), f;
      }, c._engine.rect = function (a, b, c, d, e, f) {
        var g = q("rect");
        a.canvas && a.canvas.appendChild(g);
        var h = new z(g, a);
        return h.attrs = {
          x: b,
          y: c,
          width: d,
          height: e,
          r: f || 0,
          rx: f || 0,
          ry: f || 0,
          fill: "none",
          stroke: "#000"
        }, h.type = "rect", q(g, h.attrs), h;
      }, c._engine.ellipse = function (a, b, c, d, e) {
        var f = q("ellipse");
        a.canvas && a.canvas.appendChild(f);
        var g = new z(f, a);
        return g.attrs = {
          cx: b,
          cy: c,
          rx: d,
          ry: e,
          fill: "none",
          stroke: "#000"
        }, g.type = "ellipse", q(f, g.attrs), g;
      }, c._engine.image = function (a, b, c, d, e, f) {
        var g = q("image");
        q(g, {
          x: c,
          y: d,
          width: e,
          height: f,
          preserveAspectRatio: "none"
        }), g.setAttributeNS(n, "href", b), a.canvas && a.canvas.appendChild(g);
        var h = new z(g, a);
        return h.attrs = {
          x: c,
          y: d,
          width: e,
          height: f,
          src: b
        }, h.type = "image", h;
      }, c._engine.text = function (a, b, d, e) {
        var f = q("text");
        a.canvas && a.canvas.appendChild(f);
        var g = new z(f, a);
        return g.attrs = {
          x: b,
          y: d,
          "text-anchor": "middle",
          text: e,
          font: c._availableAttrs.font,
          stroke: "none",
          fill: "#000"
        }, g.type = "text", w(g, g.attrs), g;
      }, c._engine.setSize = function (a, b) {
        return this.width = a || this.width, this.height = b || this.height, this.canvas.setAttribute("width", this.width), this.canvas.setAttribute("height", this.height), this._viewBox && this.setViewBox.apply(this, this._viewBox), this;
      }, c._engine.create = function () {
        var a = c._getContainer.apply(0, arguments),
            b = a && a.container,
            d = a.x,
            e = a.y,
            f = a.width,
            g = a.height;

        if (!b) throw new Error("SVG container not found.");
        var h,
            i = q("svg"),
            j = "overflow:hidden;";
        return d = d || 0, e = e || 0, f = f || 512, g = g || 342, q(i, {
          height: g,
          version: 1.1,
          width: f,
          xmlns: "http://www.w3.org/2000/svg"
        }), 1 == b ? (i.style.cssText = j + "position:absolute;left:" + d + "px;top:" + e + "px", c._g.doc.body.appendChild(i), h = 1) : (i.style.cssText = j + "position:relative", b.firstChild ? b.insertBefore(i, b.firstChild) : b.appendChild(i)), b = new c._Paper(), b.width = f, b.height = g, b.canvas = i, b.clear(), b._left = b._top = 0, h && (b.renderfix = function () {}), b.renderfix(), b;
      }, c._engine.setViewBox = function (a, b, c, d, e) {
        k("raphael.setViewBox", this, this._viewBox, [a, b, c, d, e]);
        var f,
            h,
            i = g(c / this.width, d / this.height),
            j = this.top,
            l = e ? "meet" : "xMinYMin";

        for (null == a ? (this._vbSize && (i = 1), delete this._vbSize, f = "0 0 " + this.width + m + this.height) : (this._vbSize = i, f = a + m + b + m + c + m + d), q(this.canvas, {
          viewBox: f,
          preserveAspectRatio: l
        }); i && j;) {
          h = "stroke-width" in j.attrs ? j.attrs["stroke-width"] : 1, j.attr({
            "stroke-width": h
          }), j._.dirty = 1, j._.dirtyT = 1, j = j.prev;
        }

        return this._viewBox = [a, b, c, d, !!e], this;
      }, c.prototype.renderfix = function () {
        var a,
            b = this.canvas,
            c = b.style;

        try {
          a = b.getScreenCTM() || b.createSVGMatrix();
        } catch (d) {
          a = b.createSVGMatrix();
        }

        var e = -a.e % 1,
            f = -a.f % 1;
        (e || f) && (e && (this._left = (this._left + e) % 1, c.left = this._left + "px"), f && (this._top = (this._top + f) % 1, c.top = this._top + "px"));
      }, c.prototype.clear = function () {
        c.eve("raphael.clear", this);

        for (var a = this.canvas; a.firstChild;) {
          a.removeChild(a.firstChild);
        }

        this.bottom = this.top = null, (this.desc = q("desc")).appendChild(c._g.doc.createTextNode("Created with Raphaël " + c.version)), a.appendChild(this.desc), a.appendChild(this.defs = q("defs"));
      }, c.prototype.remove = function () {
        k("raphael.remove", this), this.canvas.parentNode && this.canvas.parentNode.removeChild(this.canvas);

        for (var a in this) {
          this[a] = "function" == typeof this[a] ? c._removedFactory(a) : null;
        }
      };
      var B = c.st;

      for (var C in A) {
        A[a](C) && !B[a](C) && (B[C] = function (a) {
          return function () {
            var b = arguments;
            return this.forEach(function (c) {
              c[a].apply(c, b);
            });
          };
        }(C));
      }
    }
  }(), function () {
    if (c.vml) {
      var a = "hasOwnProperty",
          b = String,
          d = parseFloat,
          e = Math,
          f = e.round,
          g = e.max,
          h = e.min,
          i = e.abs,
          j = "fill",
          k = /[, ]+/,
          l = c.eve,
          m = " progid:DXImageTransform.Microsoft",
          n = " ",
          o = "",
          p = {
        M: "m",
        L: "l",
        C: "c",
        Z: "x",
        m: "t",
        l: "r",
        c: "v",
        z: "x"
      },
          q = /([clmz]),?([^clmz]*)/gi,
          r = / progid:\S+Blur\([^\)]+\)/g,
          s = /-?[^,\s-]+/g,
          t = "position:absolute;left:0;top:0;width:1px;height:1px",
          u = 21600,
          v = {
        path: 1,
        rect: 1,
        image: 1
      },
          w = {
        circle: 1,
        ellipse: 1
      },
          x = function x(a) {
        var d = /[ahqstv]/gi,
            e = c._pathToAbsolute;

        if (b(a).match(d) && (e = c._path2curve), d = /[clmz]/g, e == c._pathToAbsolute && !b(a).match(d)) {
          var g = b(a).replace(q, function (a, b, c) {
            var d = [],
                e = "m" == b.toLowerCase(),
                g = p[b];
            return c.replace(s, function (a) {
              e && 2 == d.length && (g += d + p["m" == b ? "l" : "L"], d = []), d.push(f(a * u));
            }), g + d;
          });
          return g;
        }

        var h,
            i,
            j = e(a);
        g = [];

        for (var k = 0, l = j.length; l > k; k++) {
          h = j[k], i = j[k][0].toLowerCase(), "z" == i && (i = "x");

          for (var m = 1, r = h.length; r > m; m++) {
            i += f(h[m] * u) + (m != r - 1 ? "," : o);
          }

          g.push(i);
        }

        return g.join(n);
      },
          y = function y(a, b, d) {
        var e = c.matrix();
        return e.rotate(-a, .5, .5), {
          dx: e.x(b, d),
          dy: e.y(b, d)
        };
      },
          z = function z(a, b, c, d, e, f) {
        var g = a._,
            h = a.matrix,
            k = g.fillpos,
            l = a.node,
            m = l.style,
            o = 1,
            p = "",
            q = u / b,
            r = u / c;

        if (m.visibility = "hidden", b && c) {
          if (l.coordsize = i(q) + n + i(r), m.rotation = f * (0 > b * c ? -1 : 1), f) {
            var s = y(f, d, e);
            d = s.dx, e = s.dy;
          }

          if (0 > b && (p += "x"), 0 > c && (p += " y") && (o = -1), m.flip = p, l.coordorigin = d * -q + n + e * -r, k || g.fillsize) {
            var t = l.getElementsByTagName(j);
            t = t && t[0], l.removeChild(t), k && (s = y(f, h.x(k[0], k[1]), h.y(k[0], k[1])), t.position = s.dx * o + n + s.dy * o), g.fillsize && (t.size = g.fillsize[0] * i(b) + n + g.fillsize[1] * i(c)), l.appendChild(t);
          }

          m.visibility = "visible";
        }
      };

      c.toString = function () {
        return "Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël " + this.version;
      };

      var A = function A(a, c, d) {
        for (var e = b(c).toLowerCase().split("-"), f = d ? "end" : "start", g = e.length, h = "classic", i = "medium", j = "medium"; g--;) {
          switch (e[g]) {
            case "block":
            case "classic":
            case "oval":
            case "diamond":
            case "open":
            case "none":
              h = e[g];
              break;

            case "wide":
            case "narrow":
              j = e[g];
              break;

            case "long":
            case "short":
              i = e[g];
          }
        }

        var k = a.node.getElementsByTagName("stroke")[0];
        k[f + "arrow"] = h, k[f + "arrowlength"] = i, k[f + "arrowwidth"] = j;
      },
          B = function B(e, i) {
        e.attrs = e.attrs || {};
        var l = e.node,
            m = e.attrs,
            p = l.style,
            q = v[e.type] && (i.x != m.x || i.y != m.y || i.width != m.width || i.height != m.height || i.cx != m.cx || i.cy != m.cy || i.rx != m.rx || i.ry != m.ry || i.r != m.r),
            r = w[e.type] && (m.cx != i.cx || m.cy != i.cy || m.r != i.r || m.rx != i.rx || m.ry != i.ry),
            s = e;

        for (var t in i) {
          i[a](t) && (m[t] = i[t]);
        }

        if (q && (m.path = c._getPath[e.type](e), e._.dirty = 1), i.href && (l.href = i.href), i.title && (l.title = i.title), i.target && (l.target = i.target), i.cursor && (p.cursor = i.cursor), "blur" in i && e.blur(i.blur), (i.path && "path" == e.type || q) && (l.path = x(~b(m.path).toLowerCase().indexOf("r") ? c._pathToAbsolute(m.path) : m.path), "image" == e.type && (e._.fillpos = [m.x, m.y], e._.fillsize = [m.width, m.height], z(e, 1, 1, 0, 0, 0))), "transform" in i && e.transform(i.transform), r) {
          var y = +m.cx,
              B = +m.cy,
              D = +m.rx || +m.r || 0,
              E = +m.ry || +m.r || 0;
          l.path = c.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x", f((y - D) * u), f((B - E) * u), f((y + D) * u), f((B + E) * u), f(y * u)), e._.dirty = 1;
        }

        if ("clip-rect" in i) {
          var G = b(i["clip-rect"]).split(k);

          if (4 == G.length) {
            G[2] = +G[2] + +G[0], G[3] = +G[3] + +G[1];

            var H = l.clipRect || c._g.doc.createElement("div"),
                I = H.style;

            I.clip = c.format("rect({1}px {2}px {3}px {0}px)", G), l.clipRect || (I.position = "absolute", I.top = 0, I.left = 0, I.width = e.paper.width + "px", I.height = e.paper.height + "px", l.parentNode.insertBefore(H, l), H.appendChild(l), l.clipRect = H);
          }

          i["clip-rect"] || l.clipRect && (l.clipRect.style.clip = "auto");
        }

        if (e.textpath) {
          var J = e.textpath.style;
          i.font && (J.font = i.font), i["font-family"] && (J.fontFamily = '"' + i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g, o) + '"'), i["font-size"] && (J.fontSize = i["font-size"]), i["font-weight"] && (J.fontWeight = i["font-weight"]), i["font-style"] && (J.fontStyle = i["font-style"]);
        }

        if ("arrow-start" in i && A(s, i["arrow-start"]), "arrow-end" in i && A(s, i["arrow-end"], 1), null != i.opacity || null != i["stroke-width"] || null != i.fill || null != i.src || null != i.stroke || null != i["stroke-width"] || null != i["stroke-opacity"] || null != i["fill-opacity"] || null != i["stroke-dasharray"] || null != i["stroke-miterlimit"] || null != i["stroke-linejoin"] || null != i["stroke-linecap"]) {
          var K = l.getElementsByTagName(j),
              L = !1;

          if (K = K && K[0], !K && (L = K = F(j)), "image" == e.type && i.src && (K.src = i.src), i.fill && (K.on = !0), (null == K.on || "none" == i.fill || null === i.fill) && (K.on = !1), K.on && i.fill) {
            var M = b(i.fill).match(c._ISURL);

            if (M) {
              K.parentNode == l && l.removeChild(K), K.rotate = !0, K.src = M[1], K.type = "tile";
              var N = e.getBBox(1);
              K.position = N.x + n + N.y, e._.fillpos = [N.x, N.y], c._preload(M[1], function () {
                e._.fillsize = [this.offsetWidth, this.offsetHeight];
              });
            } else K.color = c.getRGB(i.fill).hex, K.src = o, K.type = "solid", c.getRGB(i.fill).error && (s.type in {
              circle: 1,
              ellipse: 1
            } || "r" != b(i.fill).charAt()) && C(s, i.fill, K) && (m.fill = "none", m.gradient = i.fill, K.rotate = !1);
          }

          if ("fill-opacity" in i || "opacity" in i) {
            var O = ((+m["fill-opacity"] + 1 || 2) - 1) * ((+m.opacity + 1 || 2) - 1) * ((+c.getRGB(i.fill).o + 1 || 2) - 1);
            O = h(g(O, 0), 1), K.opacity = O, K.src && (K.color = "none");
          }

          l.appendChild(K);
          var P = l.getElementsByTagName("stroke") && l.getElementsByTagName("stroke")[0],
              Q = !1;
          !P && (Q = P = F("stroke")), (i.stroke && "none" != i.stroke || i["stroke-width"] || null != i["stroke-opacity"] || i["stroke-dasharray"] || i["stroke-miterlimit"] || i["stroke-linejoin"] || i["stroke-linecap"]) && (P.on = !0), ("none" == i.stroke || null === i.stroke || null == P.on || 0 == i.stroke || 0 == i["stroke-width"]) && (P.on = !1);
          var R = c.getRGB(i.stroke);
          P.on && i.stroke && (P.color = R.hex), O = ((+m["stroke-opacity"] + 1 || 2) - 1) * ((+m.opacity + 1 || 2) - 1) * ((+R.o + 1 || 2) - 1);
          var S = .75 * (d(i["stroke-width"]) || 1);

          if (O = h(g(O, 0), 1), null == i["stroke-width"] && (S = m["stroke-width"]), i["stroke-width"] && (P.weight = S), S && 1 > S && (O *= S) && (P.weight = 1), P.opacity = O, i["stroke-linejoin"] && (P.joinstyle = i["stroke-linejoin"] || "miter"), P.miterlimit = i["stroke-miterlimit"] || 8, i["stroke-linecap"] && (P.endcap = "butt" == i["stroke-linecap"] ? "flat" : "square" == i["stroke-linecap"] ? "square" : "round"), i["stroke-dasharray"]) {
            var T = {
              "-": "shortdash",
              ".": "shortdot",
              "-.": "shortdashdot",
              "-..": "shortdashdotdot",
              ". ": "dot",
              "- ": "dash",
              "--": "longdash",
              "- .": "dashdot",
              "--.": "longdashdot",
              "--..": "longdashdotdot"
            };
            P.dashstyle = T[a](i["stroke-dasharray"]) ? T[i["stroke-dasharray"]] : o;
          }

          Q && l.appendChild(P);
        }

        if ("text" == s.type) {
          s.paper.canvas.style.display = o;
          var U = s.paper.span,
              V = 100,
              W = m.font && m.font.match(/\d+(?:\.\d*)?(?=px)/);
          p = U.style, m.font && (p.font = m.font), m["font-family"] && (p.fontFamily = m["font-family"]), m["font-weight"] && (p.fontWeight = m["font-weight"]), m["font-style"] && (p.fontStyle = m["font-style"]), W = d(m["font-size"] || W && W[0]) || 10, p.fontSize = W * V + "px", s.textpath.string && (U.innerHTML = b(s.textpath.string).replace(/</g, "&#60;").replace(/&/g, "&#38;").replace(/\n/g, "<br>"));
          var X = U.getBoundingClientRect();
          s.W = m.w = (X.right - X.left) / V, s.H = m.h = (X.bottom - X.top) / V, s.X = m.x, s.Y = m.y + s.H / 2, ("x" in i || "y" in i) && (s.path.v = c.format("m{0},{1}l{2},{1}", f(m.x * u), f(m.y * u), f(m.x * u) + 1));

          for (var Y = ["x", "y", "text", "font", "font-family", "font-weight", "font-style", "font-size"], Z = 0, $ = Y.length; $ > Z; Z++) {
            if (Y[Z] in i) {
              s._.dirty = 1;
              break;
            }
          }

          switch (m["text-anchor"]) {
            case "start":
              s.textpath.style["v-text-align"] = "left", s.bbx = s.W / 2;
              break;

            case "end":
              s.textpath.style["v-text-align"] = "right", s.bbx = -s.W / 2;
              break;

            default:
              s.textpath.style["v-text-align"] = "center", s.bbx = 0;
          }

          s.textpath.style["v-text-kern"] = !0;
        }
      },
          C = function C(a, f, g) {
        a.attrs = a.attrs || {};
        var h = (a.attrs, Math.pow),
            i = "linear",
            j = ".5 .5";

        if (a.attrs.gradient = f, f = b(f).replace(c._radial_gradient, function (a, b, c) {
          return i = "radial", b && c && (b = d(b), c = d(c), h(b - .5, 2) + h(c - .5, 2) > .25 && (c = e.sqrt(.25 - h(b - .5, 2)) * (2 * (c > .5) - 1) + .5), j = b + n + c), o;
        }), f = f.split(/\s*\-\s*/), "linear" == i) {
          var k = f.shift();
          if (k = -d(k), isNaN(k)) return null;
        }

        var l = c._parseDots(f);

        if (!l) return null;

        if (a = a.shape || a.node, l.length) {
          a.removeChild(g), g.on = !0, g.method = "none", g.color = l[0].color, g.color2 = l[l.length - 1].color;

          for (var m = [], p = 0, q = l.length; q > p; p++) {
            l[p].offset && m.push(l[p].offset + n + l[p].color);
          }

          g.colors = m.length ? m.join() : "0% " + g.color, "radial" == i ? (g.type = "gradientTitle", g.focus = "100%", g.focussize = "0 0", g.focusposition = j, g.angle = 0) : (g.type = "gradient", g.angle = (270 - k) % 360), a.appendChild(g);
        }

        return 1;
      },
          D = function D(a, b) {
        this[0] = this.node = a, a.raphael = !0, this.id = c._oid++, a.raphaelid = this.id, this.X = 0, this.Y = 0, this.attrs = {}, this.paper = b, this.matrix = c.matrix(), this._ = {
          transform: [],
          sx: 1,
          sy: 1,
          dx: 0,
          dy: 0,
          deg: 0,
          dirty: 1,
          dirtyT: 1
        }, !b.bottom && (b.bottom = this), this.prev = b.top, b.top && (b.top.next = this), b.top = this, this.next = null;
      },
          E = c.el;

      D.prototype = E, E.constructor = D, E.transform = function (a) {
        if (null == a) return this._.transform;
        var d,
            e = this.paper._viewBoxShift,
            f = e ? "s" + [e.scale, e.scale] + "-1-1t" + [e.dx, e.dy] : o;
        e && (d = a = b(a).replace(/\.{3}|\u2026/g, this._.transform || o)), c._extractTransform(this, f + a);
        var g,
            h = this.matrix.clone(),
            i = this.skew,
            j = this.node,
            k = ~b(this.attrs.fill).indexOf("-"),
            l = !b(this.attrs.fill).indexOf("url(");
        if (h.translate(1, 1), l || k || "image" == this.type) {
          if (i.matrix = "1 0 0 1", i.offset = "0 0", g = h.split(), k && g.noRotation || !g.isSimple) {
            j.style.filter = h.toFilter();
            var m = this.getBBox(),
                p = this.getBBox(1),
                q = m.x - p.x,
                r = m.y - p.y;
            j.coordorigin = q * -u + n + r * -u, z(this, 1, 1, q, r, 0);
          } else j.style.filter = o, z(this, g.scalex, g.scaley, g.dx, g.dy, g.rotate);
        } else j.style.filter = o, i.matrix = b(h), i.offset = h.offset();
        return d && (this._.transform = d), this;
      }, E.rotate = function (a, c, e) {
        if (this.removed) return this;

        if (null != a) {
          if (a = b(a).split(k), a.length - 1 && (c = d(a[1]), e = d(a[2])), a = d(a[0]), null == e && (c = e), null == c || null == e) {
            var f = this.getBBox(1);
            c = f.x + f.width / 2, e = f.y + f.height / 2;
          }

          return this._.dirtyT = 1, this.transform(this._.transform.concat([["r", a, c, e]])), this;
        }
      }, E.translate = function (a, c) {
        return this.removed ? this : (a = b(a).split(k), a.length - 1 && (c = d(a[1])), a = d(a[0]) || 0, c = +c || 0, this._.bbox && (this._.bbox.x += a, this._.bbox.y += c), this.transform(this._.transform.concat([["t", a, c]])), this);
      }, E.scale = function (a, c, e, f) {
        if (this.removed) return this;
        if (a = b(a).split(k), a.length - 1 && (c = d(a[1]), e = d(a[2]), f = d(a[3]), isNaN(e) && (e = null), isNaN(f) && (f = null)), a = d(a[0]), null == c && (c = a), null == f && (e = f), null == e || null == f) var g = this.getBBox(1);
        return e = null == e ? g.x + g.width / 2 : e, f = null == f ? g.y + g.height / 2 : f, this.transform(this._.transform.concat([["s", a, c, e, f]])), this._.dirtyT = 1, this;
      }, E.hide = function () {
        return !this.removed && (this.node.style.display = "none"), this;
      }, E.show = function () {
        return !this.removed && (this.node.style.display = o), this;
      }, E._getBBox = function () {
        return this.removed ? {} : {
          x: this.X + (this.bbx || 0) - this.W / 2,
          y: this.Y - this.H,
          width: this.W,
          height: this.H
        };
      }, E.remove = function () {
        if (!this.removed && this.node.parentNode) {
          this.paper.__set__ && this.paper.__set__.exclude(this), c.eve.unbind("raphael.*.*." + this.id), c._tear(this, this.paper), this.node.parentNode.removeChild(this.node), this.shape && this.shape.parentNode.removeChild(this.shape);

          for (var a in this) {
            this[a] = "function" == typeof this[a] ? c._removedFactory(a) : null;
          }

          this.removed = !0;
        }
      }, E.attr = function (b, d) {
        if (this.removed) return this;

        if (null == b) {
          var e = {};

          for (var f in this.attrs) {
            this.attrs[a](f) && (e[f] = this.attrs[f]);
          }

          return e.gradient && "none" == e.fill && (e.fill = e.gradient) && delete e.gradient, e.transform = this._.transform, e;
        }

        if (null == d && c.is(b, "string")) {
          if (b == j && "none" == this.attrs.fill && this.attrs.gradient) return this.attrs.gradient;

          for (var g = b.split(k), h = {}, i = 0, m = g.length; m > i; i++) {
            b = g[i], h[b] = b in this.attrs ? this.attrs[b] : c.is(this.paper.customAttributes[b], "function") ? this.paper.customAttributes[b].def : c._availableAttrs[b];
          }

          return m - 1 ? h : h[g[0]];
        }

        if (this.attrs && null == d && c.is(b, "array")) {
          for (h = {}, i = 0, m = b.length; m > i; i++) {
            h[b[i]] = this.attr(b[i]);
          }

          return h;
        }

        var n;
        null != d && (n = {}, n[b] = d), null == d && c.is(b, "object") && (n = b);

        for (var o in n) {
          l("raphael.attr." + o + "." + this.id, this, n[o]);
        }

        if (n) {
          for (o in this.paper.customAttributes) {
            if (this.paper.customAttributes[a](o) && n[a](o) && c.is(this.paper.customAttributes[o], "function")) {
              var p = this.paper.customAttributes[o].apply(this, [].concat(n[o]));
              this.attrs[o] = n[o];

              for (var q in p) {
                p[a](q) && (n[q] = p[q]);
              }
            }
          }

          n.text && "text" == this.type && (this.textpath.string = n.text), B(this, n);
        }

        return this;
      }, E.toFront = function () {
        return !this.removed && this.node.parentNode.appendChild(this.node), this.paper && this.paper.top != this && c._tofront(this, this.paper), this;
      }, E.toBack = function () {
        return this.removed ? this : (this.node.parentNode.firstChild != this.node && (this.node.parentNode.insertBefore(this.node, this.node.parentNode.firstChild), c._toback(this, this.paper)), this);
      }, E.insertAfter = function (a) {
        return this.removed ? this : (a.constructor == c.st.constructor && (a = a[a.length - 1]), a.node.nextSibling ? a.node.parentNode.insertBefore(this.node, a.node.nextSibling) : a.node.parentNode.appendChild(this.node), c._insertafter(this, a, this.paper), this);
      }, E.insertBefore = function (a) {
        return this.removed ? this : (a.constructor == c.st.constructor && (a = a[0]), a.node.parentNode.insertBefore(this.node, a.node), c._insertbefore(this, a, this.paper), this);
      }, E.blur = function (a) {
        var b = this.node.runtimeStyle,
            d = b.filter;
        return d = d.replace(r, o), 0 !== +a ? (this.attrs.blur = a, b.filter = d + n + m + ".Blur(pixelradius=" + (+a || 1.5) + ")", b.margin = c.format("-{0}px 0 0 -{0}px", f(+a || 1.5))) : (b.filter = d, b.margin = 0, delete this.attrs.blur), this;
      }, c._engine.path = function (a, b) {
        var c = F("shape");
        c.style.cssText = t, c.coordsize = u + n + u, c.coordorigin = b.coordorigin;
        var d = new D(c, b),
            e = {
          fill: "none",
          stroke: "#000"
        };
        a && (e.path = a), d.type = "path", d.path = [], d.Path = o, B(d, e), b.canvas.appendChild(c);
        var f = F("skew");
        return f.on = !0, c.appendChild(f), d.skew = f, d.transform(o), d;
      }, c._engine.rect = function (a, b, d, e, f, g) {
        var h = c._rectPath(b, d, e, f, g),
            i = a.path(h),
            j = i.attrs;

        return i.X = j.x = b, i.Y = j.y = d, i.W = j.width = e, i.H = j.height = f, j.r = g, j.path = h, i.type = "rect", i;
      }, c._engine.ellipse = function (a, b, c, d, e) {
        var f = a.path();
        return f.attrs, f.X = b - d, f.Y = c - e, f.W = 2 * d, f.H = 2 * e, f.type = "ellipse", B(f, {
          cx: b,
          cy: c,
          rx: d,
          ry: e
        }), f;
      }, c._engine.circle = function (a, b, c, d) {
        var e = a.path();
        return e.attrs, e.X = b - d, e.Y = c - d, e.W = e.H = 2 * d, e.type = "circle", B(e, {
          cx: b,
          cy: c,
          r: d
        }), e;
      }, c._engine.image = function (a, b, d, e, f, g) {
        var h = c._rectPath(d, e, f, g),
            i = a.path(h).attr({
          stroke: "none"
        }),
            k = i.attrs,
            l = i.node,
            m = l.getElementsByTagName(j)[0];

        return k.src = b, i.X = k.x = d, i.Y = k.y = e, i.W = k.width = f, i.H = k.height = g, k.path = h, i.type = "image", m.parentNode == l && l.removeChild(m), m.rotate = !0, m.src = b, m.type = "tile", i._.fillpos = [d, e], i._.fillsize = [f, g], l.appendChild(m), z(i, 1, 1, 0, 0, 0), i;
      }, c._engine.text = function (a, d, e, g) {
        var h = F("shape"),
            i = F("path"),
            j = F("textpath");
        d = d || 0, e = e || 0, g = g || "", i.v = c.format("m{0},{1}l{2},{1}", f(d * u), f(e * u), f(d * u) + 1), i.textpathok = !0, j.string = b(g), j.on = !0, h.style.cssText = t, h.coordsize = u + n + u, h.coordorigin = "0 0";
        var k = new D(h, a),
            l = {
          fill: "#000",
          stroke: "none",
          font: c._availableAttrs.font,
          text: g
        };
        k.shape = h, k.path = i, k.textpath = j, k.type = "text", k.attrs.text = b(g), k.attrs.x = d, k.attrs.y = e, k.attrs.w = 1, k.attrs.h = 1, B(k, l), h.appendChild(j), h.appendChild(i), a.canvas.appendChild(h);
        var m = F("skew");
        return m.on = !0, h.appendChild(m), k.skew = m, k.transform(o), k;
      }, c._engine.setSize = function (a, b) {
        var d = this.canvas.style;
        return this.width = a, this.height = b, a == +a && (a += "px"), b == +b && (b += "px"), d.width = a, d.height = b, d.clip = "rect(0 " + a + " " + b + " 0)", this._viewBox && c._engine.setViewBox.apply(this, this._viewBox), this;
      }, c._engine.setViewBox = function (a, b, d, e, f) {
        c.eve("raphael.setViewBox", this, this._viewBox, [a, b, d, e, f]);
        var h,
            i,
            j = this.width,
            k = this.height,
            l = 1 / g(d / j, e / k);
        return f && (h = k / e, i = j / d, j > d * h && (a -= (j - d * h) / 2 / h), k > e * i && (b -= (k - e * i) / 2 / i)), this._viewBox = [a, b, d, e, !!f], this._viewBoxShift = {
          dx: -a,
          dy: -b,
          scale: l
        }, this.forEach(function (a) {
          a.transform("...");
        }), this;
      };
      var F;
      c._engine.initWin = function (a) {
        var b = a.document;
        b.createStyleSheet().addRule(".rvml", "behavior:url(#default#VML)");

        try {
          !b.namespaces.rvml && b.namespaces.add("rvml", "urn:schemas-microsoft-com:vml"), F = function F(a) {
            return b.createElement("<rvml:" + a + ' class="rvml">');
          };
        } catch (c) {
          F = function F(a) {
            return b.createElement("<" + a + ' xmlns="urn:schemas-microsoft.com:vml" class="rvml">');
          };
        }
      }, c._engine.initWin(c._g.win), c._engine.create = function () {
        var a = c._getContainer.apply(0, arguments),
            b = a.container,
            d = a.height,
            e = a.width,
            f = a.x,
            g = a.y;

        if (!b) throw new Error("VML container not found.");

        var h = new c._Paper(),
            i = h.canvas = c._g.doc.createElement("div"),
            j = i.style;

        return f = f || 0, g = g || 0, e = e || 512, d = d || 342, h.width = e, h.height = d, e == +e && (e += "px"), d == +d && (d += "px"), h.coordsize = 1e3 * u + n + 1e3 * u, h.coordorigin = "0 0", h.span = c._g.doc.createElement("span"), h.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;", i.appendChild(h.span), j.cssText = c.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden", e, d), 1 == b ? (c._g.doc.body.appendChild(i), j.left = f + "px", j.top = g + "px", j.position = "absolute") : b.firstChild ? b.insertBefore(i, b.firstChild) : b.appendChild(i), h.renderfix = function () {}, h;
      }, c.prototype.clear = function () {
        c.eve("raphael.clear", this), this.canvas.innerHTML = o, this.span = c._g.doc.createElement("span"), this.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;", this.canvas.appendChild(this.span), this.bottom = this.top = null;
      }, c.prototype.remove = function () {
        c.eve("raphael.remove", this), this.canvas.parentNode.removeChild(this.canvas);

        for (var a in this) {
          this[a] = "function" == typeof this[a] ? c._removedFactory(a) : null;
        }

        return !0;
      };
      var G = c.st;

      for (var H in E) {
        E[a](H) && !G[a](H) && (G[H] = function (a) {
          return function () {
            var b = arguments;
            return this.forEach(function (c) {
              c[a].apply(c, b);
            });
          };
        }(H));
      }
    }
  }(), B.was ? A.win.Raphael = c : Raphael = c, c;
});
/*
* Colorwheel
* Copyright (c) 2010 John Weir (http://famedriver.com)
* Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
*
* requires jQuery & Raphael
*   http://jquery.com http://raphaeljs.com
*
* see http://jweir.github.com/colorwheel for Usage
*
*/

Raphael.colorwheel = function (target, color_wheel_size, no_segments) {
  var canvas,
      current_color,
      current_color_hsb,
      size,
      segments = no_segments || 60,
      bs_square = {},
      hue_ring = {},
      tri_size,
      cursor = {},
      drag_target,
      input_target,
      center,
      parent,
      change_callback,
      drag_callbacks = [function () {}, function () {}],
      offset,
      padding = 2,
      sdim; // holds the dimensions for the saturation square

  function point(x, y) {
    return {
      x: x,
      y: y
    };
  }

  function radians(a) {
    return a * (Math.PI / 180);
  }

  function angle(x, y) {
    var q = x > 0 ? 0 : 180;
    return q + Math.atan((0 - y) / (0 - x)) * 180 / Math.PI;
  }

  function create(target, color_wheel_size) {
    size = color_wheel_size;
    tri_size = size / 20;
    center = size / 2;
    parent = $(target);
    canvas = Raphael(parent[0], size, size);
    canvas.safari();
    create_bs_square();
    create_hue_ring();
    hue_ring.cursor = cursor_create(tri_size);
    bs_square.cursor = cursor_create(tri_size * 0.5);
    events_setup();
    parent.css({
      height: size + "px",
      width: size + "px"
    });
    disable_select(parent);
    return public_methods();
  }

  function disable_select(target) {
    $(target).css({
      "unselectable": "on",
      "-moz-user-select": "none",
      "-webkit-user-select": "none"
    });
  }

  function public_methods() {
    return {
      input: input,
      onchange: onchange,
      ondrag: ondrag,
      color: public_set_color,
      color_hsb: public_set_color_hsb
    };
  } // Sets a textfield for user input of hex color values
  // TODO don't clear the change callback
  // TODO allow a null target to unbind the input


  function input(target) {
    change_callback = null;
    input_target = target;
    $(target).keyup(function () {
      if (this.value.match(/^#([0-9A-F]){3}$|^#([0-9A-F]){6}$/img)) {
        set_color(this.value);
        update_color(true);
        run_onchange_event();
      }
    });
    set_color(target.value);
    update_color(true);
    return public_methods();
  }

  function onchange(callback) {
    change_callback = callback;
    update_color(false);
    return public_methods();
  }

  function ondrag(start_callback, end_callback) {
    drag_callbacks = [start_callback || function () {}, end_callback || function () {}];
    return public_methods();
  }

  function drag(e) {
    var x, y, page;
    e.preventDefault(); // prevents scrolling on touch

    page = e.originalEvent.touches ? e.originalEvent.touches[0] : e;
    x = page.pageX - (parent.offset().left + center);
    y = page.pageY - (parent.offset().top + center);

    if (drag_target == hue_ring) {
      set_hue_cursor(x, y);
      update_color();
      run_onchange_event();
      return true;
    }

    if (drag_target == bs_square) {
      set_bs_cursor(x, y);
      update_color();
      run_onchange_event();
      return true;
    }
  }

  function start_drag(event, target) {
    event.preventDefault(); // prevents scrolling on touch

    $(document).on('mouseup touchend', stop_drag);
    $(document).on('mousemove touchmove', drag);
    drag_target = target;
    drag(event);
    drag_callbacks[0](current_color);
  }

  function stop_drag(event) {
    event.preventDefault(); // prevents scrolling on touch

    $(document).off("mouseup touchend", stop_drag);
    $(document).off("mousemove touchmove", drag);
    drag_callbacks[1](current_color);
    run_onchange_event();
  }

  function events_setup() {
    $([hue_ring.event.node, hue_ring.cursor[0].node]).on("mousedown touchstart", function (e) {
      start_drag(e, hue_ring);
    });
    $([bs_square.b.node, bs_square.cursor[0].node]).on("mousedown touchstart", function (e) {
      start_drag(e, bs_square);
    });
  }

  function cursor_create(size) {
    var set = canvas.set().push(canvas.circle(0, 0, size).attr({
      "stroke-width": 4,
      stroke: "#333"
    }), canvas.circle(0, 0, size + 2).attr({
      "stroke-width": 1,
      stroke: "#FFF",
      opacity: 0.5
    }));
    set[0].node.style.cursor = "crosshair";
    return set;
  }

  function set_bs_cursor(x, y) {
    x = x + center;
    y = y + center;

    if (x < sdim.x) {
      x = sdim.x;
    }

    if (x > sdim.x + sdim.l) {
      x = sdim.x + sdim.l;
    }

    if (y < sdim.y) {
      y = sdim.y;
    }

    if (y > sdim.y + sdim.l) {
      y = sdim.y + sdim.l;
    }

    bs_square.cursor.attr({
      cx: x,
      cy: y
    }).transform("t0,0");
  }

  function set_hue(color) {
    var hex = Raphael.getRGB(color).hex;
    bs_square.h.attr("fill", hex);
  }

  function hue() {
    return Raphael.rgb2hsb(bs_square.h.attr("fill")).h;
  }

  function public_set_color(value) {
    var ret = set_color(value, false);
    update_color(false);
    return ret;
  }

  function public_set_color_hsb(hsb) {
    var ret = set_color(hsb, true);
    update_color(false);
    return ret;
  }

  function set_color(value, is_hsb) {
    if (value === undefined) {
      if (is_hsb) {
        return current_color_hsb;
      } else {
        return current_color;
      }
    }

    var hsb, hex;

    if (is_hsb) {
      hsb = value; // Allow v (value) instead of b (brightness), as v is sometimes
      // used by Raphael.

      if (hsb.b === undefined) {
        hsb.b = hsb.v;
      }

      var rgb = canvas.raphael.hsb2rgb(hsb.h, hsb.s, hsb.b);
      hex = rgb.hex;
    } else {
      hex = value;
      hsb = canvas.raphael.rgb2hsb(hex);
    }

    var temp = canvas.rect(1, 1, 1, 1).attr({
      fill: hex
    });
    set_bs_cursor(0 - sdim.l / 2 + sdim.l * hsb.s, sdim.l / 2 - sdim.l * hsb.b);
    set_hue_cursor(360 * hsb.h - 90);
    temp.remove();
    return public_methods();
  } // Could optimize this method


  function update_color(dont_replace_input_value) {
    var x = bs_square.cursor.items[0].attr("cx"),
        y = bs_square.cursor.items[0].attr("cy"),
        hsb = {
      b: 1 - (y - sdim.y) / sdim.l,
      s: (x - sdim.x) / sdim.l,
      h: hue()
    };
    current_color_hsb = hsb;
    current_color = Raphael.hsb2rgb(hsb.h, hsb.s, hsb.b);

    if (input_target) {
      var c = current_color.hex;

      if (dont_replace_input_value !== true) {
        input_target.value = c;
      }

      if (hsb.b < 0.5) {
        $(input_target).css("color", "#FFF");
      } else {
        $(input_target).css("color", "#000");
      }

      input_target.style.background = c;
    }
  } // accepts either x,y or d (degrees)


  function set_hue_cursor(mixed_args) {
    var d;

    if (arguments.length == 2) {
      d = angle(arguments[0], arguments[1]);
    } else {
      d = arguments[0];
    }

    var x = Math.cos(radians(d)) * (center - tri_size - padding);
    var y = Math.sin(radians(d)) * (center - tri_size - padding);
    hue_ring.cursor.attr({
      cx: x + center,
      cy: y + center
    }).transform("t0,0");
    set_hue("hsb(" + (d + 90) / 360 + ",1,1)");
  }

  function bs_square_dim() {
    if (sdim) {
      return sdim;
    }

    var s = size - tri_size * 4;
    sdim = {
      x: s / 6 + tri_size * 2 + padding,
      y: s / 6 + tri_size * 2 + padding,
      l: s * 2 / 3 - padding * 2
    };
    return sdim;
  }

  function create_bs_square() {
    bs_square_dim();
    box = [sdim.x, sdim.y, sdim.l, sdim.l];
    bs_square.h = canvas.rect.apply(canvas, box).attr({
      stroke: "#EEE",
      gradient: "0-#FFF-#000",
      opacity: 1
    });
    bs_square.s = canvas.rect.apply(canvas, box).attr({
      stroke: null,
      gradient: "0-#FFF-#FFF",
      opacity: 0
    });
    bs_square.b = canvas.rect.apply(canvas, box).attr({
      stroke: null,
      gradient: "90-#000-#FFF",
      opacity: 0
    });
    bs_square.b.node.style.cursor = "crosshair";
  }

  function hue_segement_shape() {
    var path = "M -@W 0 L @W 0 L @W @H L -@W @H z";
    return path.replace(/@H/img, tri_size * 2).replace(/@W/img, tri_size);
  }

  function copy_segment(r, d, k) {
    var n = r.clone();
    var hue = d * (255 / k);
    var s = size / 2,
        t = tri_size,
        p = padding;
    n.transform("t" + s + "," + (s - t) + "r" + 360 / k * d + "t0,-" + (s - t - p) + "");
    n.attr({
      "stroke-width": 0,
      fill: "hsb(" + d * (1 / k) + ", 1, 0.85)"
    });
    hue_ring.hues.push(n);
  }

  function create_hue_ring() {
    var s = hue_segement_shape(),
        tri = canvas.path(s).attr({
      stroke: "rgba(0,0,0,0)"
    }).transform("t" + size / 2 + "," + padding),
        k = segments; // # of segments to use to generate the hues

    hue_ring.hues = canvas.set();

    for (n = 0; n < k; n++) {
      copy_segment(tri, n, k);
    } // IE needs a slight opacity to assign events


    hue_ring.event = canvas.circle(center, center, center - tri_size - padding).attr({
      "stroke-width": tri_size * 2,
      opacity: 0.01
    });
    hue_ring.outline = canvas.circle(center, center, center - tri_size - padding).attr({
      "stroke": "#000",
      "stroke-width": tri_size * 2 + 3,
      opacity: 0.1
    });
    hue_ring.outline.toBack();
    hue_ring.event.node.style.cursor = "crosshair";
  }

  function run_onchange_event() {
    if ({}.toString.call(change_callback).match(/function/i)) {
      change_callback(current_color);
    }
  }

  return create(target, color_wheel_size);
}; //Generated by CoffeeScript 1.9.2


'use strict';

(function () {
  var ngColorwheelDirective;

  ngColorwheelDirective = function ngColorwheelDirective() {
    var directive, link;

    link = function link(scope, elem, attrs, ngModelCtrl) {
      var cw, init, options, toView, updateModel;

      if ((typeof Raphael !== "undefined" && Raphael !== null ? Raphael.colorwheel : void 0) == null) {
        return;
      }

      options = null;

      try {
        options = scope.$eval(attrs.ngColorwheel);
      } catch (_error) {
        console.log('ERROR ON PARSING JSON-string:', attrs.ngColorwheel);
      }

      if (options == null) {
        options = {};
      }

      if (options.size == null) {
        options.size = 150;
      }

      cw = null;

      init = function init() {
        cw = Raphael.colorwheel(elem[0], options.size, options.segments);
        ngModelCtrl.$formatters.push(toView);
        return cw.onchange(updateModel);
      };

      toView = function toView(modelValue) {
        if (modelValue != null) {
          cw.color(modelValue);
        }

        return modelValue;
      };

      updateModel = function updateModel(color) {
        return ngModelCtrl.$setViewValue(color.hex);
      };

      init();
    };

    directive = {
      link: link,
      restrict: 'EA',
      require: '?ngModel'
    };
    return directive;
  };

  return angular.module('directive.ngColorwheel', []).directive('ngColorwheel', ngColorwheelDirective);
})();/*! 
 * angular-loading-bar v0.9.0
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2016 Wes Cruver
 * License: MIT
 */
!function () {
  "use strict";

  angular.module("angular-loading-bar", ["cfp.loadingBarInterceptor"]), angular.module("chieffancypants.loadingBar", ["cfp.loadingBarInterceptor"]), angular.module("cfp.loadingBarInterceptor", ["cfp.loadingBar"]).config(["$httpProvider", function (a) {
    var b = ["$q", "$cacheFactory", "$timeout", "$rootScope", "$log", "cfpLoadingBar", function (b, c, d, e, f, g) {
      function h() {
        d.cancel(j), g.complete(), l = 0, k = 0;
      }

      function i(b) {
        var d,
            e = c.get("$http"),
            f = a.defaults;
        !b.cache && !f.cache || b.cache === !1 || "GET" !== b.method && "JSONP" !== b.method || (d = angular.isObject(b.cache) ? b.cache : angular.isObject(f.cache) ? f.cache : e);
        var g = void 0 !== d ? void 0 !== d.get(b.url) : !1;
        return void 0 !== b.cached && g !== b.cached ? b.cached : (b.cached = g, g);
      }

      var j,
          k = 0,
          l = 0,
          m = g.latencyThreshold;
      return {
        request: function request(a) {
          return a.ignoreLoadingBar || i(a) || (e.$broadcast("cfpLoadingBar:loading", {
            url: a.url
          }), 0 === k && (j = d(function () {
            g.start();
          }, m)), k++, g.set(l / k)), a;
        },
        response: function response(a) {
          return a && a.config ? (a.config.ignoreLoadingBar || i(a.config) || (l++, e.$broadcast("cfpLoadingBar:loaded", {
            url: a.config.url,
            result: a
          }), l >= k ? h() : g.set(l / k)), a) : (f.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"), a);
        },
        responseError: function responseError(a) {
          return a && a.config ? (a.config.ignoreLoadingBar || i(a.config) || (l++, e.$broadcast("cfpLoadingBar:loaded", {
            url: a.config.url,
            result: a
          }), l >= k ? h() : g.set(l / k)), b.reject(a)) : (f.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"), b.reject(a));
        }
      };
    }];
    a.interceptors.push(b);
  }]), angular.module("cfp.loadingBar", []).provider("cfpLoadingBar", function () {
    this.autoIncrement = !0, this.includeSpinner = !0, this.includeBar = !0, this.latencyThreshold = 100, this.startSize = .02, this.parentSelector = "body", this.spinnerTemplate = '<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>', this.loadingBarTemplate = '<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>', this.$get = ["$injector", "$document", "$timeout", "$rootScope", function (a, b, c, d) {
      function e() {
        if (k || (k = a.get("$animate")), c.cancel(m), !r) {
          var e = b[0],
              g = e.querySelector ? e.querySelector(n) : b.find(n)[0];
          g || (g = e.getElementsByTagName("body")[0]);
          var h = angular.element(g),
              i = g.lastChild && angular.element(g.lastChild);
          d.$broadcast("cfpLoadingBar:started"), r = !0, v && k.enter(o, h, i), u && k.enter(q, h, o), f(w);
        }
      }

      function f(a) {
        if (r) {
          var b = 100 * a + "%";
          p.css("width", b), s = a, t && (c.cancel(l), l = c(function () {
            g();
          }, 250));
        }
      }

      function g() {
        if (!(h() >= 1)) {
          var a = 0,
              b = h();
          a = b >= 0 && .25 > b ? (3 * Math.random() + 3) / 100 : b >= .25 && .65 > b ? 3 * Math.random() / 100 : b >= .65 && .9 > b ? 2 * Math.random() / 100 : b >= .9 && .99 > b ? .005 : 0;
          var c = h() + a;
          f(c);
        }
      }

      function h() {
        return s;
      }

      function i() {
        s = 0, r = !1;
      }

      function j() {
        k || (k = a.get("$animate")), d.$broadcast("cfpLoadingBar:completed"), f(1), c.cancel(m), m = c(function () {
          var a = k.leave(o, i);
          a && a.then && a.then(i), k.leave(q);
        }, 500);
      }

      var k,
          l,
          m,
          n = this.parentSelector,
          o = angular.element(this.loadingBarTemplate),
          p = o.find("div").eq(0),
          q = angular.element(this.spinnerTemplate),
          r = !1,
          s = 0,
          t = this.autoIncrement,
          u = this.includeSpinner,
          v = this.includeBar,
          w = this.startSize;
      return {
        start: e,
        set: f,
        status: h,
        inc: g,
        complete: j,
        autoIncrement: this.autoIncrement,
        includeSpinner: this.includeSpinner,
        latencyThreshold: this.latencyThreshold,
        parentSelector: this.parentSelector,
        startSize: this.startSize
      };
    }];
  });
}();/*global angular document navigator*/
(function withAngular(angular, navigator) {
  'use strict';

  var A_DAY_IN_MILLISECONDS = 86400000,
      isMobile = function isMobile() {
    if (navigator.userAgent && (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i))) {
      return true;
    }
  }(),
      generateMonthAndYearHeader = function generateMonthAndYearHeader(prevButton, nextButton, preventMobile) {
    if (preventMobile) {
      isMobile = false;
    }

    if (isMobile) {
      return ['<div class="_720kb-datepicker-calendar-header">', '<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">', '<select ng-model="month" title="{{ dateMonthTitle }}" ng-change="selectedMonthHandle(month)">', '<option ng-repeat="item in months" ng-selected="item === month" ng-disabled=\'!isSelectableMaxDate(item + " " + day + ", " + year) || !isSelectableMinDate(item + " " + day + ", " + year)\' ng-value="$index + 1" value="$index + 1">', '{{ item }}', '</option>', '</select>', '</div>', '</div>', '<div class="_720kb-datepicker-calendar-header">', '<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">', '<select ng-model="mobileYear" title="{{ dateYearTitle }}" ng-change="setNewYear(mobileYear)">', '<option ng-repeat="item in paginationYears track by $index" ng-selected="year === item" ng-disabled="!isSelectableMinYear(item) || !isSelectableMaxYear(item)" ng-value="item" value="item">', '{{ item }}', '</option>', '</select>', '</div>', '</div>'];
    }

    return ['<div class="_720kb-datepicker-calendar-header">', '<div class="_720kb-datepicker-calendar-header-left">', '<a class="_720kb-datepicker-calendar-month-button" href="javascript:void(0)" ng-class="{\'_720kb-datepicker-item-hidden\': !willPrevMonthBeSelectable()}" ng-click="prevMonth()" title="{{ buttonPrevTitle }}">', prevButton, '</a>', '</div>', '<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-calendar-month">', '{{month}}&nbsp;', '<a href="javascript:void(0)" ng-click="paginateYears(year); showYearsPagination = !showYearsPagination;">', '<span>', '{{year}}', '<i ng-class="{\'_720kb-datepicker-calendar-header-closed-pagination\': !showYearsPagination, \'_720kb-datepicker-calendar-header-opened-pagination\': showYearsPagination}"></i>', '</span>', '</a>', '</div>', '<div class="_720kb-datepicker-calendar-header-right">', '<a class="_720kb-datepicker-calendar-month-button" ng-class="{\'_720kb-datepicker-item-hidden\': !willNextMonthBeSelectable()}" href="javascript:void(0)" ng-click="nextMonth()" title="{{ buttonNextTitle }}">', nextButton, '</a>', '</div>', '</div>'];
  },
      generateYearsPaginationHeader = function generateYearsPaginationHeader(prevButton, nextButton) {
    return ['<div class="_720kb-datepicker-calendar-header" ng-show="showYearsPagination">', '<div class="_720kb-datepicker-calendar-years-pagination">', '<a ng-class="{\'_720kb-datepicker-active\': y === year, \'_720kb-datepicker-disabled\': !isSelectableMaxYear(y) || !isSelectableMinYear(y)}" href="javascript:void(0)" ng-click="setNewYear(y)" ng-repeat="y in paginationYears track by $index">', '{{y}}', '</a>', '</div>', '<div class="_720kb-datepicker-calendar-years-pagination-pages">', '<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[0])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsPrevDisabled}">', prevButton, '</a>', '<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[paginationYears.length -1 ])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsNextDisabled}">', nextButton, '</a>', '</div>', '</div>'];
  },
      generateDaysColumns = function generateDaysColumns() {
    return ['<div class="_720kb-datepicker-calendar-days-header">', '<div ng-repeat="d in daysInString">', '{{d}}', '</div>', '</div>'];
  },
      generateDays = function generateDays() {
    return ['<div class="_720kb-datepicker-calendar-body">', '<a href="javascript:void(0)" ng-repeat="px in prevMonthDays" class="_720kb-datepicker-calendar-day _720kb-datepicker-disabled">', '{{px}}', '</a>', '<a href="javascript:void(0)" ng-repeat="item in days" ng-click="setDatepickerDay(item)" ng-class="{\'_720kb-datepicker-active\': selectedDay === item && selectedMonth === monthNumber && selectedYear === year, \'_720kb-datepicker-disabled\': !isSelectableMinDate(year + \'/\' + monthNumber + \'/\' + item ) || !isSelectableMaxDate(year + \'/\' + monthNumber + \'/\' + item) || !isSelectableDate(monthNumber, year, item) || !isSelectableDay(monthNumber, year, item),\'_720kb-datepicker-today\': item === today.getDate() && monthNumber === (today.getMonth() + 1) && year === today.getFullYear()}" class="_720kb-datepicker-calendar-day">', '{{item}}', '</a>', '<a href="javascript:void(0)" ng-repeat="nx in nextMonthDays" class="_720kb-datepicker-calendar-day _720kb-datepicker-disabled">', '{{nx}}', '</a>', '</div>'];
  },
      generateHtmlTemplate = function generateHtmlTemplate(prevButton, nextButton, preventMobile) {
    var toReturn = ['<div class="_720kb-datepicker-calendar {{datepickerClass}} {{datepickerID}}" ng-class="{\'_720kb-datepicker-forced-to-open\': checkVisibility()}" ng-blur="hideCalendar()">', '</div>'],
        monthAndYearHeader = generateMonthAndYearHeader(prevButton, nextButton, preventMobile),
        yearsPaginationHeader = generateYearsPaginationHeader(prevButton, nextButton),
        daysColumns = generateDaysColumns(),
        days = generateDays(),
        iterator = function iterator(aRow) {
      toReturn.splice(toReturn.length - 1, 0, aRow);
    };

    monthAndYearHeader.forEach(iterator);
    yearsPaginationHeader.forEach(iterator);
    daysColumns.forEach(iterator);
    days.forEach(iterator);
    return toReturn.join('');
  },
      datepickerDirective = function datepickerDirective($window, $compile, $locale, $filter, $interpolate, $timeout) {
    var linkingFunction = function linkingFunction($scope, element, attr) {
      $scope.today = new Date(); //get child input

      var selector = attr.selector,
          thisInput = angular.element(selector ? element[0].querySelector('.' + selector) : element[0].children[0]),
          theCalendar,
          defaultPrevButton = '<b class="_720kb-datepicker-default-button">&lang;</b>',
          defaultNextButton = '<b class="_720kb-datepicker-default-button">&rang;</b>',
          prevButton = attr.buttonPrev || defaultPrevButton,
          nextButton = attr.buttonNext || defaultNextButton,
          dateFormat = attr.dateFormat //, dateMinLimit
      //, dateMaxLimit
      ,
          dateDisabledDates = $scope.$eval($scope.dateDisabledDates),
          dateEnabledDates = $scope.$eval($scope.dateEnabledDates),
          dateDisabledWeekdays = $scope.$eval($scope.dateDisabledWeekdays),
          date = new Date(),
          isMouseOn = false,
          isMouseOnInput = false,
          preventMobile = typeof attr.datepickerMobile !== 'undefined' && attr.datepickerMobile !== 'false',
          datetime = $locale.DATETIME_FORMATS,
          pageDatepickers,
          hours24h = 86400000,
          htmlTemplate = generateHtmlTemplate(prevButton, nextButton, preventMobile),
          n,
          onClickOnWindow = function onClickOnWindow() {
        if (!isMouseOn && !isMouseOnInput && theCalendar) {
          $scope.hideCalendar();
        }
      },
          setDaysInMonth = function setDaysInMonth(month, year) {
        var i,
            limitDate = new Date(year, month, 0).getDate(),
            firstDayMonthNumber = new Date(year + '/' + month + '/' + 1).getDay(),
            lastDayMonthNumber = new Date(year + '/' + month + '/' + limitDate).getDay(),
            prevMonthDays = [],
            nextMonthDays = [],
            howManyNextDays,
            howManyPreviousDays,
            monthAlias,
            dateWeekEndDay;
        $scope.days = [];
        $scope.dateWeekStartDay = $scope.validateWeekDay($scope.dateWeekStartDay);
        dateWeekEndDay = ($scope.dateWeekStartDay + 6) % 7;

        for (i = 1; i <= limitDate; i += 1) {
          $scope.days.push(i);
        } //get previous month days if first day in month is not first day in week


        if (firstDayMonthNumber === $scope.dateWeekStartDay) {
          //no need for it
          $scope.prevMonthDays = [];
        } else {
          howManyPreviousDays = firstDayMonthNumber - $scope.dateWeekStartDay;

          if (firstDayMonthNumber < $scope.dateWeekStartDay) {
            howManyPreviousDays += 7;
          } //get previous month


          if (Number(month) === 1) {
            monthAlias = 12;
          } else {
            monthAlias = month - 1;
          } //return previous month days


          for (i = 1; i <= new Date(year, monthAlias, 0).getDate(); i += 1) {
            prevMonthDays.push(i);
          } //attach previous month days


          $scope.prevMonthDays = prevMonthDays.slice(-howManyPreviousDays);
        } //get next month days if last day in month is not last day in week


        if (lastDayMonthNumber === dateWeekEndDay) {
          //no need for it
          $scope.nextMonthDays = [];
        } else {
          howManyNextDays = 6 - lastDayMonthNumber + $scope.dateWeekStartDay;

          if (lastDayMonthNumber < $scope.dateWeekStartDay) {
            howManyNextDays -= 7;
          } //get previous month
          //return next month days


          for (i = 1; i <= howManyNextDays; i += 1) {
            nextMonthDays.push(i);
          } //attach previous month days


          $scope.nextMonthDays = nextMonthDays;
        }
      },
          resetToMinDate = function resetToMinDate() {
        $scope.month = $filter('date')(new Date($scope.dateMinLimit), 'MMMM');
        $scope.monthNumber = Number($filter('date')(new Date($scope.dateMinLimit), 'MM'));
        $scope.day = Number($filter('date')(new Date($scope.dateMinLimit), 'dd'));
        $scope.year = Number($filter('date')(new Date($scope.dateMinLimit), 'yyyy'));
        setDaysInMonth($scope.monthNumber, $scope.year);
      },
          resetToMaxDate = function resetToMaxDate() {
        $scope.month = $filter('date')(new Date($scope.dateMaxLimit), 'MMMM');
        $scope.monthNumber = Number($filter('date')(new Date($scope.dateMaxLimit), 'MM'));
        $scope.day = Number($filter('date')(new Date($scope.dateMaxLimit), 'dd'));
        $scope.year = Number($filter('date')(new Date($scope.dateMaxLimit), 'yyyy'));
        setDaysInMonth($scope.monthNumber, $scope.year);
      },
          prevYear = function prevYear() {
        $scope.year = Number($scope.year) - 1;
      },
          nextYear = function nextYear() {
        $scope.year = Number($scope.year) + 1;
      },
          localDateTimestamp = function localDateTimestamp(rawDate, dateFormatDefinition) {
        var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|MMMM|MMM|MM|M|dd?d?|yy?yy?y?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
            formatDate,
            dateSplit,
            m,
            d,
            y,
            index,
            el,
            longName,
            shortName;

        for (index = 0; index < datetime.MONTH.length; index += 1) {
          longName = datetime.MONTH[index];
          shortName = datetime.SHORTMONTH[index];

          if (rawDate.indexOf(longName) !== -1) {
            rawDate = rawDate.replace(longName, index + 1);
            break;
          }

          if (rawDate.indexOf(shortName) !== -1) {
            rawDate = rawDate.replace(shortName, index + 1);
            break;
          }
        }

        dateSplit = rawDate.split(/\D/).filter(function dateSplitFilter(item) {
          return item.length > 0;
        });
        formatDate = dateFormatDefinition.match(formattingTokens).filter(function fromatDateFilter(item) {
          return item.match(/^[a-zA-Z]+$/i) !== null;
        });

        for (index = 0; index < formatDate.length; index += 1) {
          el = formatDate[index];

          switch (true) {
            case el.indexOf('d') !== -1:
              {
                d = dateSplit[index - (formatDate.length - dateSplit.length)];
                break;
              }

            case el.indexOf('M') !== -1:
              {
                m = dateSplit[index - (formatDate.length - dateSplit.length)];
                break;
              }

            case el.indexOf('y') !== -1:
              {
                y = dateSplit[index - (formatDate.length - dateSplit.length)];
                break;
              }

            default:
              {
                break;
              }
          }
        }

        return new Date(y + '/' + m + '/' + d);
      },
          setInputValue = function setInputValue() {
        if ($scope.isSelectableMinDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.day) && $scope.isSelectableMaxDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.day)) {
          var modelDate = new Date($scope.year + '/' + $scope.monthNumber + '/' + $scope.day);

          if (attr.dateFormat) {
            thisInput.val($filter('date')(modelDate, dateFormat));
          } else {
            thisInput.val(modelDate);
          }

          thisInput.triggerHandler('input');
          thisInput.triggerHandler('change'); //just to be sure;
        } else {
          return false;
        }
      },
          classHelper = {
        'add': function add(ele, klass) {
          var classes;

          if (ele.className.indexOf(klass) > -1) {
            return;
          }

          classes = ele.className.split(' ');
          classes.push(klass);
          ele.className = classes.join(' ');
        },
        'remove': function remove(ele, klass) {
          var i, classes;

          if (ele.className.indexOf(klass) === -1) {
            return;
          }

          classes = ele.className.split(' ');

          for (i = 0; i < classes.length; i += 1) {
            if (classes[i] === klass) {
              classes = classes.slice(0, i).concat(classes.slice(i + 1));
              break;
            }
          }

          ele.className = classes.join(' ');
        }
      },
          showCalendar = function showCalendar() {
        //lets hide all the latest instances of datepicker
        pageDatepickers = $window.document.getElementsByClassName('_720kb-datepicker-calendar');
        angular.forEach(pageDatepickers, function forEachDatepickerPages(value, key) {
          if (pageDatepickers[key].classList) {
            pageDatepickers[key].classList.remove('_720kb-datepicker-open');
          } else {
            classHelper.remove(pageDatepickers[key], '_720kb-datepicker-open');
          }
        });

        if (theCalendar.classList) {
          theCalendar.classList.add('_720kb-datepicker-open');

          if (dateFormat) {
            date = localDateTimestamp(thisInput[0].value.toString(), dateFormat);
          } else {
            date = new Date(thisInput[0].value.toString());
          }

          $scope.selectedMonth = Number($filter('date')(date, 'MM'));
          $scope.selectedDay = Number($filter('date')(date, 'dd'));
          $scope.selectedYear = Number($filter('date')(date, 'yyyy'));
        } else {
          classHelper.add(theCalendar, '_720kb-datepicker-open');
        }

        $scope.today = new Date();
        $timeout(function timeoutForYears() {
          if ($scope.selectedDay) {
            $scope.year = $scope.selectedYear;
            $scope.monthNumber = $scope.selectedMonth;
          } else {
            $scope.year = $scope.today.getFullYear();
            $scope.monthNumber = $scope.today.getMonth() + 1;
          }

          $scope.month = $filter('date')(new Date($scope.year, $scope.monthNumber - 1), 'MMMM');
          setDaysInMonth($scope.monthNumber, $scope.year);
        }, 0);
      },
          checkToggle = function checkToggle() {
        if (!$scope.datepickerToggle) {
          return true;
        }

        return $scope.$eval($scope.datepickerToggle);
      },
          checkVisibility = function checkVisibility() {
        if (!$scope.datepickerShow) {
          return false;
        }

        if (dateFormat) {
          date = localDateTimestamp(thisInput[0].value.toString(), dateFormat);
        } else {
          date = new Date(thisInput[0].value.toString());
        }

        $scope.selectedMonth = Number($filter('date')(date, 'MM'));
        $scope.selectedDay = Number($filter('date')(date, 'dd'));
        $scope.selectedYear = Number($filter('date')(date, 'yyyy'));
        return $scope.$eval($scope.datepickerShow);
      },
          unregisterDataSetWatcher = $scope.$watch('dateSet', function dateSetWatcher(newValue) {
        if (newValue && !isNaN(Date.parse(newValue))) {
          date = new Date(newValue);
          $scope.month = $filter('date')(date, 'MMMM'); //december-November like

          $scope.monthNumber = Number($filter('date')(date, 'MM')); // 01-12 like

          $scope.day = Number($filter('date')(date, 'dd')); //01-31 like

          $scope.year = Number($filter('date')(date, 'yyyy')); //2014 like

          setDaysInMonth($scope.monthNumber, $scope.year);

          if ($scope.dateSetHidden !== 'true') {
            setInputValue();
          }
        }
      }),
          unregisterDateMinLimitWatcher = $scope.$watch('dateMinLimit', function dateMinLimitWatcher(newValue) {
        if (newValue) {
          resetToMinDate();
        }
      }),
          unregisterDateMaxLimitWatcher = $scope.$watch('dateMaxLimit', function dateMaxLimitWatcher(newValue) {
        if (newValue) {
          resetToMaxDate();
        }
      }),
          unregisterDateFormatWatcher = $scope.$watch('dateFormat', function dateFormatWatcher(newValue) {
        if (newValue) {
          setInputValue();
        }
      }),
          unregisterDateDisabledDatesWatcher = $scope.$watch('dateDisabledDates', function dateDisabledDatesWatcher(newValue) {
        if (newValue) {
          dateDisabledDates = $scope.$eval(newValue);

          if (!$scope.isSelectableDate($scope.monthNumber, $scope.year, $scope.day)) {
            thisInput.val('');
            thisInput.triggerHandler('input');
            thisInput.triggerHandler('change'); //just to be sure;
          }
        }
      }),
          unregisterDateEnabledDatesWatcher = $scope.$watch('dateEnabledDates', function dateEnabledDatesWatcher(newValue) {
        if (newValue) {
          dateEnabledDates = $scope.$eval(newValue);

          if (!$scope.isSelectableDate($scope.monthNumber, $scope.year, $scope.day)) {
            thisInput.val('');
            thisInput.triggerHandler('input');
            thisInput.triggerHandler('change'); //just to be sure;
          }
        }
      });

      $scope.nextMonth = function nextMonth() {
        if ($scope.monthNumber === 12) {
          $scope.monthNumber = 1; //its happy new year

          nextYear();
        } else {
          $scope.monthNumber += 1;
        } //check if max date is ok


        if ($scope.dateMaxLimit) {
          if (!$scope.isSelectableMaxDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.days[0])) {
            resetToMaxDate();
          }
        } //set next month


        $scope.month = $filter('date')(new Date($scope.year, $scope.monthNumber - 1), 'MMMM'); //reinit days

        setDaysInMonth($scope.monthNumber, $scope.year); //deactivate selected day

        $scope.day = undefined;
      };

      $scope.willPrevMonthBeSelectable = function willPrevMonthBeSelectable() {
        var monthNumber = $scope.monthNumber,
            year = $scope.year,
            prevDay = $filter('date')(new Date(new Date(year + '/' + monthNumber + '/01').getTime() - hours24h), 'dd'); //get last day in previous month

        if (monthNumber === 1) {
          monthNumber = 12;
          year = year - 1;
        } else {
          monthNumber -= 1;
        }

        if ($scope.dateMinLimit) {
          if (!$scope.isSelectableMinDate(year + '/' + monthNumber + '/' + prevDay)) {
            return false;
          }
        }

        return true;
      };

      $scope.willNextMonthBeSelectable = function willNextMonthBeSelectable() {
        var monthNumber = $scope.monthNumber,
            year = $scope.year;

        if (monthNumber === 12) {
          monthNumber = 1;
          year += 1;
        } else {
          monthNumber += 1;
        }

        if ($scope.dateMaxLimit) {
          if (!$scope.isSelectableMaxDate(year + '/' + monthNumber + '/01')) {
            return false;
          }
        }

        return true;
      };

      $scope.prevMonth = function managePrevMonth() {
        if ($scope.monthNumber === 1) {
          $scope.monthNumber = 12; //its happy new year

          prevYear();
        } else {
          $scope.monthNumber -= 1;
        } //check if min date is ok


        if ($scope.dateMinLimit) {
          if (!$scope.isSelectableMinDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.days[$scope.days.length - 1])) {
            resetToMinDate();
          }
        } //set next month


        $scope.month = $filter('date')(new Date($scope.year, $scope.monthNumber - 1), 'MMMM'); //reinit days

        setDaysInMonth($scope.monthNumber, $scope.year); //deactivate selected day

        $scope.day = undefined;
      };

      $scope.selectedMonthHandle = function manageSelectedMonthHandle(selectedMonthNumber) {
        $scope.monthNumber = Number($filter('date')(new Date(selectedMonthNumber + '/01/2000'), 'MM'));
        setDaysInMonth($scope.monthNumber, $scope.year);
        setInputValue();
      };

      $scope.setNewYear = function setNewYear(year) {
        //deactivate selected day
        if (!isMobile) {
          $scope.day = undefined;
        }

        if ($scope.dateMaxLimit && $scope.year < Number(year)) {
          if (!$scope.isSelectableMaxYear(year)) {
            return;
          }
        } else if ($scope.dateMinLimit && $scope.year > Number(year)) {
          if (!$scope.isSelectableMinYear(year)) {
            return;
          }
        }

        $scope.paginateYears(year);
        $scope.showYearsPagination = false;
        $timeout(function timeoutForYears() {
          $scope.year = Number(year);
          setDaysInMonth($scope.monthNumber, $scope.year);
        }, 0);
      };

      $scope.hideCalendar = function hideCalendar() {
        if (theCalendar.classList) {
          theCalendar.classList.remove('_720kb-datepicker-open');
        } else {
          classHelper.remove(theCalendar, '_720kb-datepicker-open');
        }
      };

      $scope.setDatepickerDay = function setDatepickerDay(day) {
        if ($scope.isSelectableDay($scope.monthNumber, $scope.year, day) && $scope.isSelectableDate($scope.monthNumber, $scope.year, day) && $scope.isSelectableMaxDate($scope.year + '/' + $scope.monthNumber + '/' + day) && $scope.isSelectableMinDate($scope.year + '/' + $scope.monthNumber + '/' + day)) {
          $scope.day = Number(day);
          $scope.selectedDay = $scope.day;
          $scope.selectedMonth = $scope.monthNumber;
          $scope.selectedYear = $scope.year;
          setInputValue();

          if (attr.hasOwnProperty('dateRefocus')) {
            thisInput[0].focus();
          }

          $scope.hideCalendar();
        }
      };

      $scope.paginateYears = function paginateYears(startingYear) {
        var i,
            theNewYears = [],
            daysToPrepend = 10,
            daysToAppend = 10;
        $scope.paginationYears = [];

        if (isMobile) {
          daysToPrepend = 50;
          daysToAppend = 50;

          if ($scope.dateMinLimit && $scope.dateMaxLimit) {
            startingYear = new Date($scope.dateMaxLimit).getFullYear();
            daysToPrepend = startingYear - new Date($scope.dateMinLimit).getFullYear();
            daysToAppend = 1;
          }
        }

        for (i = daysToPrepend; i > 0; i -= 1) {
          theNewYears.push(Number(startingYear) - i);
        }

        for (i = 0; i < daysToAppend; i += 1) {
          theNewYears.push(Number(startingYear) + i);
        } //date typing in input date-typer


        if ($scope.dateTyper === 'true') {
          thisInput.on('keyup blur', function onTyping() {
            if (thisInput[0].value && thisInput[0].value.length && thisInput[0].value.length > 0) {
              try {
                if (dateFormat) {
                  date = localDateTimestamp(thisInput[0].value.toString(), dateFormat);
                } else {
                  date = new Date(thisInput[0].value.toString());
                }

                if (date.getFullYear() && !isNaN(date.getDay()) && !isNaN(date.getMonth()) && $scope.isSelectableDay(date.getMonth(), date.getFullYear(), date.getDay()) && $scope.isSelectableDate(date.getMonth(), date.getFullYear(), date.getDay()) && $scope.isSelectableMaxDate(date) && $scope.isSelectableMinDate(date)) {
                  $scope.$apply(function applyTyping() {
                    $scope.month = $filter('date')(date, 'MMMM'); //december-November like

                    $scope.monthNumber = Number($filter('date')(date, 'MM')); // 01-12 like

                    $scope.day = Number($filter('date')(date, 'dd')); //01-31 like

                    if (date.getFullYear().toString().length === 4) {
                      $scope.year = Number($filter('date')(date, 'yyyy')); //2014 like
                    }

                    setDaysInMonth($scope.monthNumber, $scope.year);
                  });
                }
              } catch (e) {
                return e;
              }
            }
          });
        } //check range dates


        if ($scope.dateMaxLimit && theNewYears && theNewYears.length && !$scope.isSelectableMaxYear(Number(theNewYears[theNewYears.length - 1]) + 1)) {
          $scope.paginationYearsNextDisabled = true;
        } else {
          $scope.paginationYearsNextDisabled = false;
        }

        if ($scope.dateMinLimit && theNewYears && theNewYears.length && !$scope.isSelectableMinYear(Number(theNewYears[0]) - 1)) {
          $scope.paginationYearsPrevDisabled = true;
        } else {
          $scope.paginationYearsPrevDisabled = false;
        }

        $scope.paginationYears = theNewYears;
      };

      $scope.isSelectableDay = function isSelectableDay(monthNumber, year, day) {
        var i = 0;

        if (dateDisabledWeekdays && dateDisabledWeekdays.length > 0) {
          for (i; i <= dateDisabledWeekdays.length; i += 1) {
            if (dateDisabledWeekdays[i] === new Date(monthNumber + '/' + day + '/' + year).getDay()) {
              return false;
            }
          }
        }

        return true;
      };

      $scope.isSelectableDate = function isSelectableDate(monthNumber, year, day) {
        var i = 0;

        if (dateDisabledDates && dateDisabledDates.length > 0) {
          for (i; i <= dateDisabledDates.length; i += 1) {
            if (new Date(dateDisabledDates[i]).getTime() === new Date(monthNumber + '/' + day + '/' + year).getTime()) {
              return false;
            }
          }
        }

        if (dateEnabledDates) {
          for (i; i <= dateEnabledDates.length; i += 1) {
            if (new Date(dateEnabledDates[i]).getTime() === new Date(monthNumber + '/' + day + '/' + year).getTime()) {
              return true;
            }
          }

          return false;
        }

        return true;
      };

      $scope.isSelectableMinDate = function isSelectableMinDate(aDate) {
        //if current date
        if (!!$scope.dateMinLimit && !!new Date($scope.dateMinLimit) && new Date(aDate).getTime() < new Date($scope.dateMinLimit).getTime()) {
          return false;
        }

        return true;
      };

      $scope.isSelectableMaxDate = function isSelectableMaxDate(aDate) {
        //if current date
        if (!!$scope.dateMaxLimit && !!new Date($scope.dateMaxLimit) && new Date(aDate).getTime() > new Date($scope.dateMaxLimit).getTime()) {
          return false;
        }

        return true;
      };

      $scope.isSelectableMaxYear = function isSelectableMaxYear(year) {
        if (!!$scope.dateMaxLimit && year > new Date($scope.dateMaxLimit).getFullYear()) {
          return false;
        }

        return true;
      };

      $scope.isSelectableMinYear = function isSelectableMinYear(year) {
        if (!!$scope.dateMinLimit && year < new Date($scope.dateMinLimit).getFullYear()) {
          return false;
        }

        return true;
      };

      $scope.validateWeekDay = function isValidWeekDay(weekDay) {
        var validWeekDay = Number(weekDay, 10); // making sure that the given option is valid

        if (!validWeekDay || validWeekDay < 0 || validWeekDay > 6) {
          validWeekDay = 0;
        }

        return validWeekDay;
      }; // respect previously configured interpolation symbols.


      htmlTemplate = htmlTemplate.replace(/{{/g, $interpolate.startSymbol()).replace(/}}/g, $interpolate.endSymbol());
      $scope.dateMonthTitle = $scope.dateMonthTitle || 'Select month';
      $scope.dateYearTitle = $scope.dateYearTitle || 'Select year';
      $scope.buttonNextTitle = $scope.buttonNextTitle || 'Next';
      $scope.buttonPrevTitle = $scope.buttonPrevTitle || 'Prev';
      $scope.month = $filter('date')(date, 'MMMM'); //december-November like

      $scope.monthNumber = Number($filter('date')(date, 'MM')); // 01-12 like

      $scope.day = Number($filter('date')(date, 'dd')); //01-31 like

      $scope.dateWeekStartDay = $scope.validateWeekDay($scope.dateWeekStartDay);

      if ($scope.dateMaxLimit) {
        $scope.year = Number($filter('date')(new Date($scope.dateMaxLimit), 'yyyy')); //2014 like
      } else {
        $scope.year = Number($filter('date')(date, 'yyyy')); //2014 like
      }

      $scope.months = datetime.MONTH;
      $scope.daysInString = [];

      for (n = $scope.dateWeekStartDay; n <= $scope.dateWeekStartDay + 6; n += 1) {
        $scope.daysInString.push(n % 7);
      }

      $scope.daysInString = $scope.daysInString.map(function mappingFunc(el) {
        return $filter('date')(new Date(new Date('06/08/2014').valueOf() + A_DAY_IN_MILLISECONDS * el), 'EEE');
      }); //create the calendar holder and append where needed

      if ($scope.datepickerAppendTo && $scope.datepickerAppendTo.indexOf('.') !== -1) {
        $scope.datepickerID = 'datepicker-id-' + new Date().getTime() + (Math.floor(Math.random() * 6) + 8);
        angular.element(document.getElementsByClassName($scope.datepickerAppendTo.replace('.', ''))[0]).append($compile(angular.element(htmlTemplate))($scope, function afterCompile(el) {
          theCalendar = angular.element(el)[0];
        }));
      } else if ($scope.datepickerAppendTo && $scope.datepickerAppendTo.indexOf('#') !== -1) {
        $scope.datepickerID = 'datepicker-id-' + new Date().getTime() + (Math.floor(Math.random() * 6) + 8);
        angular.element(document.getElementById($scope.datepickerAppendTo.replace('#', ''))).append($compile(angular.element(htmlTemplate))($scope, function afterCompile(el) {
          theCalendar = angular.element(el)[0];
        }));
      } else if ($scope.datepickerAppendTo && $scope.datepickerAppendTo === 'body') {
        $scope.datepickerID = 'datepicker-id-' + (new Date().getTime() + (Math.floor(Math.random() * 6) + 8));
        angular.element(document).find('body').append($compile(angular.element(htmlTemplate))($scope, function afterCompile(el) {
          theCalendar = angular.element(el)[0];
        }));
      } else {
        thisInput.after($compile(angular.element(htmlTemplate))($scope)); //get the calendar as element

        theCalendar = element[0].querySelector('._720kb-datepicker-calendar');
      } //if datepicker-toggle="" is not present or true by default


      if (checkToggle()) {
        thisInput.on('focus click focusin', function onFocusAndClick() {
          isMouseOnInput = true;

          if (!isMouseOn && !isMouseOnInput && theCalendar) {
            $scope.hideCalendar();
          } else {
            showCalendar();
          }
        });
      }

      thisInput.on('focusout blur', function onBlurAndFocusOut() {
        isMouseOnInput = false;
      }); //some tricky dirty events to fire if click is outside of the calendar and show/hide calendar when needed

      angular.element(theCalendar).on('mouseenter', function onMouseEnter() {
        isMouseOn = true;
      });
      angular.element(theCalendar).on('mouseleave', function onMouseLeave() {
        isMouseOn = false;
      });
      angular.element(theCalendar).on('focusin', function onCalendarFocus() {
        isMouseOn = true;
      });
      angular.element($window).on('click focus focusin', onClickOnWindow); //check always if given range of dates is ok

      if ($scope.dateMinLimit && !$scope.isSelectableMinYear($scope.year) || !$scope.isSelectableMinDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.day)) {
        resetToMinDate();
      }

      if ($scope.dateMaxLimit && !$scope.isSelectableMaxYear($scope.year) || !$scope.isSelectableMaxDate($scope.year + '/' + $scope.monthNumber + '/' + $scope.day)) {
        resetToMaxDate();
      } //datepicker boot start


      $scope.paginateYears($scope.year);
      setDaysInMonth($scope.monthNumber, $scope.year);
      $scope.checkVisibility = checkVisibility;
      $scope.$on('$destroy', function unregisterListener() {
        unregisterDataSetWatcher();
        unregisterDateMinLimitWatcher();
        unregisterDateMaxLimitWatcher();
        unregisterDateFormatWatcher();
        unregisterDateDisabledDatesWatcher();
        unregisterDateEnabledDatesWatcher();
        thisInput.off('focus click focusout blur');
        angular.element(theCalendar).off('mouseenter mouseleave focusin');
        angular.element($window).off('click focus focusin', onClickOnWindow);
      });
    };

    return {
      'restrict': 'AEC',
      'scope': {
        'dateSet': '@',
        'dateMinLimit': '@',
        'dateMaxLimit': '@',
        'dateMonthTitle': '@',
        'dateYearTitle': '@',
        'buttonNextTitle': '@',
        'buttonPrevTitle': '@',
        'dateDisabledDates': '@',
        'dateEnabledDates': '@',
        'dateDisabledWeekdays': '@',
        'dateSetHidden': '@',
        'dateTyper': '@',
        'dateWeekStartDay': '@',
        'datepickerAppendTo': '@',
        'datepickerToggle': '@',
        'datepickerClass': '@',
        'datepickerShow': '@'
      },
      'link': linkingFunction
    };
  };

  angular.module('720kb.datepicker', []).directive('datepicker', ['$window', '$compile', '$locale', '$filter', '$interpolate', '$timeout', datepickerDirective]);
})(angular, navigator);/**
 * State-based routing for AngularJS
 * @version v0.4.3
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

/* commonjs package manager support (eg componentjs) */
if (typeof module !== "undefined" && typeof exports !== "undefined" && module.exports === exports) {
  module.exports = 'ui.router';
}

(function (window, angular, undefined) {
  /*jshint globalstrict:true*/

  /*global angular:false*/
  'use strict';

  var isDefined = angular.isDefined,
      isFunction = angular.isFunction,
      isString = angular.isString,
      isObject = angular.isObject,
      isArray = angular.isArray,
      forEach = angular.forEach,
      extend = angular.extend,
      copy = angular.copy,
      toJson = angular.toJson;

  function inherit(parent, extra) {
    return extend(new (extend(function () {}, {
      prototype: parent
    }))(), extra);
  }

  function merge(dst) {
    forEach(arguments, function (obj) {
      if (obj !== dst) {
        forEach(obj, function (value, key) {
          if (!dst.hasOwnProperty(key)) dst[key] = value;
        });
      }
    });
    return dst;
  }
  /**
   * Finds the common ancestor path between two states.
   *
   * @param {Object} first The first state.
   * @param {Object} second The second state.
   * @return {Array} Returns an array of state names in descending order, not including the root.
   */


  function ancestors(first, second) {
    var path = [];

    for (var n in first.path) {
      if (first.path[n] !== second.path[n]) break;
      path.push(first.path[n]);
    }

    return path;
  }
  /**
   * IE8-safe wrapper for `Object.keys()`.
   *
   * @param {Object} object A JavaScript object.
   * @return {Array} Returns the keys of the object as an array.
   */


  function objectKeys(object) {
    if (Object.keys) {
      return Object.keys(object);
    }

    var result = [];
    forEach(object, function (val, key) {
      result.push(key);
    });
    return result;
  }
  /**
   * IE8-safe wrapper for `Array.prototype.indexOf()`.
   *
   * @param {Array} array A JavaScript array.
   * @param {*} value A value to search the array for.
   * @return {Number} Returns the array index value of `value`, or `-1` if not present.
   */


  function indexOf(array, value) {
    if (Array.prototype.indexOf) {
      return array.indexOf(value, Number(arguments[2]) || 0);
    }

    var len = array.length >>> 0,
        from = Number(arguments[2]) || 0;
    from = from < 0 ? Math.ceil(from) : Math.floor(from);
    if (from < 0) from += len;

    for (; from < len; from++) {
      if (from in array && array[from] === value) return from;
    }

    return -1;
  }
  /**
   * Merges a set of parameters with all parameters inherited between the common parents of the
   * current state and a given destination state.
   *
   * @param {Object} currentParams The value of the current state parameters ($stateParams).
   * @param {Object} newParams The set of parameters which will be composited with inherited params.
   * @param {Object} $current Internal definition of object representing the current state.
   * @param {Object} $to Internal definition of object representing state to transition to.
   */


  function inheritParams(currentParams, newParams, $current, $to) {
    var parents = ancestors($current, $to),
        parentParams,
        inherited = {},
        inheritList = [];

    for (var i in parents) {
      if (!parents[i] || !parents[i].params) continue;
      parentParams = objectKeys(parents[i].params);
      if (!parentParams.length) continue;

      for (var j in parentParams) {
        if (indexOf(inheritList, parentParams[j]) >= 0) continue;
        inheritList.push(parentParams[j]);
        inherited[parentParams[j]] = currentParams[parentParams[j]];
      }
    }

    return extend({}, inherited, newParams);
  }
  /**
   * Performs a non-strict comparison of the subset of two objects, defined by a list of keys.
   *
   * @param {Object} a The first object.
   * @param {Object} b The second object.
   * @param {Array} keys The list of keys within each object to compare. If the list is empty or not specified,
   *                     it defaults to the list of keys in `a`.
   * @return {Boolean} Returns `true` if the keys match, otherwise `false`.
   */


  function equalForKeys(a, b, keys) {
    if (!keys) {
      keys = [];

      for (var n in a) {
        keys.push(n);
      } // Used instead of Object.keys() for IE8 compatibility

    }

    for (var i = 0; i < keys.length; i++) {
      var k = keys[i];
      if (a[k] != b[k]) return false; // Not '===', values aren't necessarily normalized
    }

    return true;
  }
  /**
   * Returns the subset of an object, based on a list of keys.
   *
   * @param {Array} keys
   * @param {Object} values
   * @return {Boolean} Returns a subset of `values`.
   */


  function filterByKeys(keys, values) {
    var filtered = {};
    forEach(keys, function (name) {
      filtered[name] = values[name];
    });
    return filtered;
  } // like _.indexBy
  // when you know that your index values will be unique, or you want last-one-in to win


  function indexBy(array, propName) {
    var result = {};
    forEach(array, function (item) {
      result[item[propName]] = item;
    });
    return result;
  } // extracted from underscore.js
  // Return a copy of the object only containing the whitelisted properties.


  function pick(obj) {
    var copy = {};
    var keys = Array.prototype.concat.apply(Array.prototype, Array.prototype.slice.call(arguments, 1));
    forEach(keys, function (key) {
      if (key in obj) copy[key] = obj[key];
    });
    return copy;
  } // extracted from underscore.js
  // Return a copy of the object omitting the blacklisted properties.


  function omit(obj) {
    var copy = {};
    var keys = Array.prototype.concat.apply(Array.prototype, Array.prototype.slice.call(arguments, 1));

    for (var key in obj) {
      if (indexOf(keys, key) == -1) copy[key] = obj[key];
    }

    return copy;
  }

  function pluck(collection, key) {
    var result = isArray(collection) ? [] : {};
    forEach(collection, function (val, i) {
      result[i] = isFunction(key) ? key(val) : val[key];
    });
    return result;
  }

  function filter(collection, callback) {
    var array = isArray(collection);
    var result = array ? [] : {};
    forEach(collection, function (val, i) {
      if (callback(val, i)) {
        result[array ? result.length : i] = val;
      }
    });
    return result;
  }

  function map(collection, callback) {
    var result = isArray(collection) ? [] : {};
    forEach(collection, function (val, i) {
      result[i] = callback(val, i);
    });
    return result;
  } // issue #2676 #2889


  function silenceUncaughtInPromise(promise) {
    return promise.then(undefined, function () {}) && promise;
  }
  /**
   * @ngdoc overview
   * @name ui.router.util
   *
   * @description
   * # ui.router.util sub-module
   *
   * This module is a dependency of other sub-modules. Do not include this module as a dependency
   * in your angular app (use {@link ui.router} module instead).
   *
   */


  angular.module('ui.router.util', ['ng']);
  /**
   * @ngdoc overview
   * @name ui.router.router
   * 
   * @requires ui.router.util
   *
   * @description
   * # ui.router.router sub-module
   *
   * This module is a dependency of other sub-modules. Do not include this module as a dependency
   * in your angular app (use {@link ui.router} module instead).
   */

  angular.module('ui.router.router', ['ui.router.util']);
  /**
   * @ngdoc overview
   * @name ui.router.state
   * 
   * @requires ui.router.router
   * @requires ui.router.util
   *
   * @description
   * # ui.router.state sub-module
   *
   * This module is a dependency of the main ui.router module. Do not include this module as a dependency
   * in your angular app (use {@link ui.router} module instead).
   * 
   */

  angular.module('ui.router.state', ['ui.router.router', 'ui.router.util']);
  /**
   * @ngdoc overview
   * @name ui.router
   *
   * @requires ui.router.state
   *
   * @description
   * # ui.router
   * 
   * ## The main module for ui.router 
   * There are several sub-modules included with the ui.router module, however only this module is needed
   * as a dependency within your angular app. The other modules are for organization purposes. 
   *
   * The modules are:
   * * ui.router - the main "umbrella" module
   * * ui.router.router - 
   * 
   * *You'll need to include **only** this module as the dependency within your angular app.*
   * 
   * <pre>
   * <!doctype html>
   * <html ng-app="myApp">
   * <head>
   *   <script src="js/angular.js"></script>
   *   <!-- Include the ui-router script -->
   *   <script src="js/angular-ui-router.min.js"></script>
   *   <script>
   *     // ...and add 'ui.router' as a dependency
   *     var myApp = angular.module('myApp', ['ui.router']);
   *   </script>
   * </head>
   * <body>
   * </body>
   * </html>
   * </pre>
   */

  angular.module('ui.router', ['ui.router.state']);
  angular.module('ui.router.compat', ['ui.router']);
  /**
   * @ngdoc object
   * @name ui.router.util.$resolve
   *
   * @requires $q
   * @requires $injector
   *
   * @description
   * Manages resolution of (acyclic) graphs of promises.
   */

  $Resolve.$inject = ['$q', '$injector'];

  function $Resolve($q, $injector) {
    var VISIT_IN_PROGRESS = 1,
        VISIT_DONE = 2,
        NOTHING = {},
        NO_DEPENDENCIES = [],
        NO_LOCALS = NOTHING,
        NO_PARENT = extend($q.when(NOTHING), {
      $$promises: NOTHING,
      $$values: NOTHING
    });
    /**
     * @ngdoc function
     * @name ui.router.util.$resolve#study
     * @methodOf ui.router.util.$resolve
     *
     * @description
     * Studies a set of invocables that are likely to be used multiple times.
     * <pre>
     * $resolve.study(invocables)(locals, parent, self)
     * </pre>
     * is equivalent to
     * <pre>
     * $resolve.resolve(invocables, locals, parent, self)
     * </pre>
     * but the former is more efficient (in fact `resolve` just calls `study` 
     * internally).
     *
     * @param {object} invocables Invocable objects
     * @return {function} a function to pass in locals, parent and self
     */

    this.study = function (invocables) {
      if (!isObject(invocables)) throw new Error("'invocables' must be an object");
      var invocableKeys = objectKeys(invocables || {}); // Perform a topological sort of invocables to build an ordered plan

      var plan = [],
          cycle = [],
          visited = {};

      function visit(value, key) {
        if (visited[key] === VISIT_DONE) return;
        cycle.push(key);

        if (visited[key] === VISIT_IN_PROGRESS) {
          cycle.splice(0, indexOf(cycle, key));
          throw new Error("Cyclic dependency: " + cycle.join(" -> "));
        }

        visited[key] = VISIT_IN_PROGRESS;

        if (isString(value)) {
          plan.push(key, [function () {
            return $injector.get(value);
          }], NO_DEPENDENCIES);
        } else {
          var params = $injector.annotate(value);
          forEach(params, function (param) {
            if (param !== key && invocables.hasOwnProperty(param)) visit(invocables[param], param);
          });
          plan.push(key, value, params);
        }

        cycle.pop();
        visited[key] = VISIT_DONE;
      }

      forEach(invocables, visit);
      invocables = cycle = visited = null; // plan is all that's required

      function isResolve(value) {
        return isObject(value) && value.then && value.$$promises;
      }

      return function (locals, parent, self) {
        if (isResolve(locals) && self === undefined) {
          self = parent;
          parent = locals;
          locals = null;
        }

        if (!locals) locals = NO_LOCALS;else if (!isObject(locals)) {
          throw new Error("'locals' must be an object");
        }
        if (!parent) parent = NO_PARENT;else if (!isResolve(parent)) {
          throw new Error("'parent' must be a promise returned by $resolve.resolve()");
        } // To complete the overall resolution, we have to wait for the parent
        // promise and for the promise for each invokable in our plan.

        var resolution = $q.defer(),
            result = silenceUncaughtInPromise(resolution.promise),
            promises = result.$$promises = {},
            values = extend({}, locals),
            wait = 1 + plan.length / 3,
            merged = false;
        silenceUncaughtInPromise(result);

        function done() {
          // Merge parent values we haven't got yet and publish our own $$values
          if (! --wait) {
            if (!merged) merge(values, parent.$$values);
            result.$$values = values;
            result.$$promises = result.$$promises || true; // keep for isResolve()

            delete result.$$inheritedValues;
            resolution.resolve(values);
          }
        }

        function fail(reason) {
          result.$$failure = reason;
          resolution.reject(reason);
        } // Short-circuit if parent has already failed


        if (isDefined(parent.$$failure)) {
          fail(parent.$$failure);
          return result;
        }

        if (parent.$$inheritedValues) {
          merge(values, omit(parent.$$inheritedValues, invocableKeys));
        } // Merge parent values if the parent has already resolved, or merge
        // parent promises and wait if the parent resolve is still in progress.


        extend(promises, parent.$$promises);

        if (parent.$$values) {
          merged = merge(values, omit(parent.$$values, invocableKeys));
          result.$$inheritedValues = omit(parent.$$values, invocableKeys);
          done();
        } else {
          if (parent.$$inheritedValues) {
            result.$$inheritedValues = omit(parent.$$inheritedValues, invocableKeys);
          }

          parent.then(done, fail);
        } // Process each invocable in the plan, but ignore any where a local of the same name exists.


        for (var i = 0, ii = plan.length; i < ii; i += 3) {
          if (locals.hasOwnProperty(plan[i])) done();else invoke(plan[i], plan[i + 1], plan[i + 2]);
        }

        function invoke(key, invocable, params) {
          // Create a deferred for this invocation. Failures will propagate to the resolution as well.
          var invocation = $q.defer(),
              waitParams = 0;

          function onfailure(reason) {
            invocation.reject(reason);
            fail(reason);
          } // Wait for any parameter that we have a promise for (either from parent or from this
          // resolve; in that case study() will have made sure it's ordered before us in the plan).


          forEach(params, function (dep) {
            if (promises.hasOwnProperty(dep) && !locals.hasOwnProperty(dep)) {
              waitParams++;
              promises[dep].then(function (result) {
                values[dep] = result;
                if (! --waitParams) proceed();
              }, onfailure);
            }
          });
          if (!waitParams) proceed();

          function proceed() {
            if (isDefined(result.$$failure)) return;

            try {
              invocation.resolve($injector.invoke(invocable, self, values));
              invocation.promise.then(function (result) {
                values[key] = result;
                done();
              }, onfailure);
            } catch (e) {
              onfailure(e);
            }
          } // Publish promise synchronously; invocations further down in the plan may depend on it.


          promises[key] = silenceUncaughtInPromise(invocation.promise);
        }

        return result;
      };
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$resolve#resolve
     * @methodOf ui.router.util.$resolve
     *
     * @description
     * Resolves a set of invocables. An invocable is a function to be invoked via 
     * `$injector.invoke()`, and can have an arbitrary number of dependencies. 
     * An invocable can either return a value directly,
     * or a `$q` promise. If a promise is returned it will be resolved and the 
     * resulting value will be used instead. Dependencies of invocables are resolved 
     * (in this order of precedence)
     *
     * - from the specified `locals`
     * - from another invocable that is part of this `$resolve` call
     * - from an invocable that is inherited from a `parent` call to `$resolve` 
     *   (or recursively
     * - from any ancestor `$resolve` of that parent).
     *
     * The return value of `$resolve` is a promise for an object that contains 
     * (in this order of precedence)
     *
     * - any `locals` (if specified)
     * - the resolved return values of all injectables
     * - any values inherited from a `parent` call to `$resolve` (if specified)
     *
     * The promise will resolve after the `parent` promise (if any) and all promises 
     * returned by injectables have been resolved. If any invocable 
     * (or `$injector.invoke`) throws an exception, or if a promise returned by an 
     * invocable is rejected, the `$resolve` promise is immediately rejected with the 
     * same error. A rejection of a `parent` promise (if specified) will likewise be 
     * propagated immediately. Once the `$resolve` promise has been rejected, no 
     * further invocables will be called.
     * 
     * Cyclic dependencies between invocables are not permitted and will cause `$resolve`
     * to throw an error. As a special case, an injectable can depend on a parameter 
     * with the same name as the injectable, which will be fulfilled from the `parent` 
     * injectable of the same name. This allows inherited values to be decorated. 
     * Note that in this case any other injectable in the same `$resolve` with the same
     * dependency would see the decorated value, not the inherited value.
     *
     * Note that missing dependencies -- unlike cyclic dependencies -- will cause an 
     * (asynchronous) rejection of the `$resolve` promise rather than a (synchronous) 
     * exception.
     *
     * Invocables are invoked eagerly as soon as all dependencies are available. 
     * This is true even for dependencies inherited from a `parent` call to `$resolve`.
     *
     * As a special case, an invocable can be a string, in which case it is taken to 
     * be a service name to be passed to `$injector.get()`. This is supported primarily 
     * for backwards-compatibility with the `resolve` property of `$routeProvider` 
     * routes.
     *
     * @param {object} invocables functions to invoke or 
     * `$injector` services to fetch.
     * @param {object} locals  values to make available to the injectables
     * @param {object} parent  a promise returned by another call to `$resolve`.
     * @param {object} self  the `this` for the invoked methods
     * @return {object} Promise for an object that contains the resolved return value
     * of all invocables, as well as any inherited and local values.
     */


    this.resolve = function (invocables, locals, parent, self) {
      return this.study(invocables)(locals, parent, self);
    };
  }

  angular.module('ui.router.util').service('$resolve', $Resolve);
  /**
   * @ngdoc object
   * @name ui.router.util.$templateFactoryProvider
   *
   * @description
   * Provider for $templateFactory. Manages which template-loading mechanism to
   * use, and will default to the most recent one ($templateRequest on Angular
   * versions starting from 1.3, $http otherwise).
   */

  function TemplateFactoryProvider() {
    var shouldUnsafelyUseHttp = angular.version.minor < 3;
    /**
     * @ngdoc function
     * @name ui.router.util.$templateFactoryProvider#shouldUnsafelyUseHttp
     * @methodOf ui.router.util.$templateFactoryProvider
     *
     * @description
     * Forces $templateFactory to use $http instead of $templateRequest. This
     * might cause XSS, as $http doesn't enforce the regular security checks for
     * templates that have been introduced in Angular 1.3. Note that setting this
     * to false on Angular older than 1.3.x will crash, as the $templateRequest
     * service (and the security checks) are not implemented on these versions.
     *
     * See the $sce documentation, section
     * <a href="https://docs.angularjs.org/api/ng/service/$sce#impact-on-loading-templates">
     * Impact on loading templates</a> for more details about this mechanism.
     *
     * @param {boolean} value
     */

    this.shouldUnsafelyUseHttp = function (value) {
      shouldUnsafelyUseHttp = !!value;
    };
    /**
     * @ngdoc object
     * @name ui.router.util.$templateFactory
     *
     * @requires $http
     * @requires $templateCache
     * @requires $injector
     *
     * @description
     * Service. Manages loading of templates.
     */


    this.$get = ['$http', '$templateCache', '$injector', function ($http, $templateCache, $injector) {
      return new TemplateFactory($http, $templateCache, $injector, shouldUnsafelyUseHttp);
    }];
  }
  /**
   * @ngdoc object
   * @name ui.router.util.$templateFactory
   *
   * @requires $http
   * @requires $templateCache
   * @requires $injector
   *
   * @description
   * Service. Manages loading of templates.
   */


  function TemplateFactory($http, $templateCache, $injector, shouldUnsafelyUseHttp) {
    /**
     * @ngdoc function
     * @name ui.router.util.$templateFactory#fromConfig
     * @methodOf ui.router.util.$templateFactory
     *
     * @description
     * Creates a template from a configuration object. 
     *
     * @param {object} config Configuration object for which to load a template. 
     * The following properties are search in the specified order, and the first one 
     * that is defined is used to create the template:
     *
     * @param {string|object} config.template html string template or function to 
     * load via {@link ui.router.util.$templateFactory#fromString fromString}.
     * @param {string|object} config.templateUrl url to load or a function returning 
     * the url to load via {@link ui.router.util.$templateFactory#fromUrl fromUrl}.
     * @param {Function} config.templateProvider function to invoke via 
     * {@link ui.router.util.$templateFactory#fromProvider fromProvider}.
     * @param {object} params  Parameters to pass to the template function.
     * @param {object} locals Locals to pass to `invoke` if the template is loaded 
     * via a `templateProvider`. Defaults to `{ params: params }`.
     *
     * @return {string|object}  The template html as a string, or a promise for 
     * that string,or `null` if no template is configured.
     */
    this.fromConfig = function (config, params, locals) {
      return isDefined(config.template) ? this.fromString(config.template, params) : isDefined(config.templateUrl) ? this.fromUrl(config.templateUrl, params) : isDefined(config.templateProvider) ? this.fromProvider(config.templateProvider, params, locals) : null;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$templateFactory#fromString
     * @methodOf ui.router.util.$templateFactory
     *
     * @description
     * Creates a template from a string or a function returning a string.
     *
     * @param {string|object} template html template as a string or function that 
     * returns an html template as a string.
     * @param {object} params Parameters to pass to the template function.
     *
     * @return {string|object} The template html as a string, or a promise for that 
     * string.
     */


    this.fromString = function (template, params) {
      return isFunction(template) ? template(params) : template;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$templateFactory#fromUrl
     * @methodOf ui.router.util.$templateFactory
     * 
     * @description
     * Loads a template from the a URL via `$http` and `$templateCache`.
     *
     * @param {string|Function} url url of the template to load, or a function 
     * that returns a url.
     * @param {Object} params Parameters to pass to the url function.
     * @return {string|Promise.<string>} The template html as a string, or a promise 
     * for that string.
     */


    this.fromUrl = function (url, params) {
      if (isFunction(url)) url = url(params);
      if (url == null) return null;else {
        if (!shouldUnsafelyUseHttp) {
          return $injector.get('$templateRequest')(url);
        } else {
          return $http.get(url, {
            cache: $templateCache,
            headers: {
              Accept: 'text/html'
            }
          }).then(function (response) {
            return response.data;
          });
        }
      }
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$templateFactory#fromProvider
     * @methodOf ui.router.util.$templateFactory
     *
     * @description
     * Creates a template by invoking an injectable provider function.
     *
     * @param {Function} provider Function to invoke via `$injector.invoke`
     * @param {Object} params Parameters for the template.
     * @param {Object} locals Locals to pass to `invoke`. Defaults to 
     * `{ params: params }`.
     * @return {string|Promise.<string>} The template html as a string, or a promise 
     * for that string.
     */


    this.fromProvider = function (provider, params, locals) {
      return $injector.invoke(provider, null, locals || {
        params: params
      });
    };
  }

  angular.module('ui.router.util').provider('$templateFactory', TemplateFactoryProvider);
  var $$UMFP; // reference to $UrlMatcherFactoryProvider

  /**
   * @ngdoc object
   * @name ui.router.util.type:UrlMatcher
   *
   * @description
   * Matches URLs against patterns and extracts named parameters from the path or the search
   * part of the URL. A URL pattern consists of a path pattern, optionally followed by '?' and a list
   * of search parameters. Multiple search parameter names are separated by '&'. Search parameters
   * do not influence whether or not a URL is matched, but their values are passed through into
   * the matched parameters returned by {@link ui.router.util.type:UrlMatcher#methods_exec exec}.
   *
   * Path parameter placeholders can be specified using simple colon/catch-all syntax or curly brace
   * syntax, which optionally allows a regular expression for the parameter to be specified:
   *
   * * `':'` name - colon placeholder
   * * `'*'` name - catch-all placeholder
   * * `'{' name '}'` - curly placeholder
   * * `'{' name ':' regexp|type '}'` - curly placeholder with regexp or type name. Should the
   *   regexp itself contain curly braces, they must be in matched pairs or escaped with a backslash.
   *
   * Parameter names may contain only word characters (latin letters, digits, and underscore) and
   * must be unique within the pattern (across both path and search parameters). For colon
   * placeholders or curly placeholders without an explicit regexp, a path parameter matches any
   * number of characters other than '/'. For catch-all placeholders the path parameter matches
   * any number of characters.
   *
   * Examples:
   *
   * * `'/hello/'` - Matches only if the path is exactly '/hello/'. There is no special treatment for
   *   trailing slashes, and patterns have to match the entire path, not just a prefix.
   * * `'/user/:id'` - Matches '/user/bob' or '/user/1234!!!' or even '/user/' but not '/user' or
   *   '/user/bob/details'. The second path segment will be captured as the parameter 'id'.
   * * `'/user/{id}'` - Same as the previous example, but using curly brace syntax.
   * * `'/user/{id:[^/]*}'` - Same as the previous example.
   * * `'/user/{id:[0-9a-fA-F]{1,8}}'` - Similar to the previous example, but only matches if the id
   *   parameter consists of 1 to 8 hex digits.
   * * `'/files/{path:.*}'` - Matches any URL starting with '/files/' and captures the rest of the
   *   path into the parameter 'path'.
   * * `'/files/*path'` - ditto.
   * * `'/calendar/{start:date}'` - Matches "/calendar/2014-11-12" (because the pattern defined
   *   in the built-in  `date` Type matches `2014-11-12`) and provides a Date object in $stateParams.start
   *
   * @param {string} pattern  The pattern to compile into a matcher.
   * @param {Object} config  A configuration object hash:
   * @param {Object=} parentMatcher Used to concatenate the pattern/config onto
   *   an existing UrlMatcher
   *
   * * `caseInsensitive` - `true` if URL matching should be case insensitive, otherwise `false`, the default value (for backward compatibility) is `false`.
   * * `strict` - `false` if matching against a URL with a trailing slash should be treated as equivalent to a URL without a trailing slash, the default value is `true`.
   *
   * @property {string} prefix  A static prefix of this pattern. The matcher guarantees that any
   *   URL matching this matcher (i.e. any string for which {@link ui.router.util.type:UrlMatcher#methods_exec exec()} returns
   *   non-null) will start with this prefix.
   *
   * @property {string} source  The pattern that was passed into the constructor
   *
   * @property {string} sourcePath  The path portion of the source property
   *
   * @property {string} sourceSearch  The search portion of the source property
   *
   * @property {string} regex  The constructed regex that will be used to match against the url when
   *   it is time to determine which url will match.
   *
   * @returns {Object}  New `UrlMatcher` object
   */

  function UrlMatcher(pattern, config, parentMatcher) {
    config = extend({
      params: {}
    }, isObject(config) ? config : {}); // Find all placeholders and create a compiled pattern, using either classic or curly syntax:
    //   '*' name
    //   ':' name
    //   '{' name '}'
    //   '{' name ':' regexp '}'
    // The regular expression is somewhat complicated due to the need to allow curly braces
    // inside the regular expression. The placeholder regexp breaks down as follows:
    //    ([:*])([\w\[\]]+)              - classic placeholder ($1 / $2) (search version has - for snake-case)
    //    \{([\w\[\]]+)(?:\:\s*( ... ))?\}  - curly brace placeholder ($3) with optional regexp/type ... ($4) (search version has - for snake-case
    //    (?: ... | ... | ... )+         - the regexp consists of any number of atoms, an atom being either
    //    [^{}\\]+                       - anything other than curly braces or backslash
    //    \\.                            - a backslash escape
    //    \{(?:[^{}\\]+|\\.)*\}          - a matched set of curly braces containing other atoms

    var placeholder = /([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,
        searchPlaceholder = /([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,
        compiled = '^',
        last = 0,
        m,
        segments = this.segments = [],
        parentParams = parentMatcher ? parentMatcher.params : {},
        params = this.params = parentMatcher ? parentMatcher.params.$$new() : new $$UMFP.ParamSet(),
        paramNames = [];

    function addParameter(id, type, config, location) {
      paramNames.push(id);
      if (parentParams[id]) return parentParams[id];
      if (!/^\w+([-.]+\w+)*(?:\[\])?$/.test(id)) throw new Error("Invalid parameter name '" + id + "' in pattern '" + pattern + "'");
      if (params[id]) throw new Error("Duplicate parameter name '" + id + "' in pattern '" + pattern + "'");
      params[id] = new $$UMFP.Param(id, type, config, location);
      return params[id];
    }

    function quoteRegExp(string, pattern, squash, optional) {
      var surroundPattern = ['', ''],
          result = string.replace(/[\\\[\]\^$*+?.()|{}]/g, "\\$&");
      if (!pattern) return result;

      switch (squash) {
        case false:
          surroundPattern = ['(', ')' + (optional ? "?" : "")];
          break;

        case true:
          result = result.replace(/\/$/, '');
          surroundPattern = ['(?:\/(', ')|\/)?'];
          break;

        default:
          surroundPattern = ['(' + squash + "|", ')?'];
          break;
      }

      return result + surroundPattern[0] + pattern + surroundPattern[1];
    }

    this.source = pattern; // Split into static segments separated by path parameter placeholders.
    // The number of segments is always 1 more than the number of parameters.

    function matchDetails(m, isSearch) {
      var id, regexp, segment, type, cfg, arrayMode;
      id = m[2] || m[3]; // IE[78] returns '' for unmatched groups instead of null

      cfg = config.params[id];
      segment = pattern.substring(last, m.index);
      regexp = isSearch ? m[4] : m[4] || (m[1] == '*' ? '.*' : null);

      if (regexp) {
        type = $$UMFP.type(regexp) || inherit($$UMFP.type("string"), {
          pattern: new RegExp(regexp, config.caseInsensitive ? 'i' : undefined)
        });
      }

      return {
        id: id,
        regexp: regexp,
        segment: segment,
        type: type,
        cfg: cfg
      };
    }

    var p, param, segment;

    while (m = placeholder.exec(pattern)) {
      p = matchDetails(m, false);
      if (p.segment.indexOf('?') >= 0) break; // we're into the search part

      param = addParameter(p.id, p.type, p.cfg, "path");
      compiled += quoteRegExp(p.segment, param.type.pattern.source, param.squash, param.isOptional);
      segments.push(p.segment);
      last = placeholder.lastIndex;
    }

    segment = pattern.substring(last); // Find any search parameter names and remove them from the last segment

    var i = segment.indexOf('?');

    if (i >= 0) {
      var search = this.sourceSearch = segment.substring(i);
      segment = segment.substring(0, i);
      this.sourcePath = pattern.substring(0, last + i);

      if (search.length > 0) {
        last = 0;

        while (m = searchPlaceholder.exec(search)) {
          p = matchDetails(m, true);
          param = addParameter(p.id, p.type, p.cfg, "search");
          last = placeholder.lastIndex; // check if ?&
        }
      }
    } else {
      this.sourcePath = pattern;
      this.sourceSearch = '';
    }

    compiled += quoteRegExp(segment) + (config.strict === false ? '\/?' : '') + '$';
    segments.push(segment);
    this.regexp = new RegExp(compiled, config.caseInsensitive ? 'i' : undefined);
    this.prefix = segments[0];
    this.$$paramNames = paramNames;
  }
  /**
   * @ngdoc function
   * @name ui.router.util.type:UrlMatcher#concat
   * @methodOf ui.router.util.type:UrlMatcher
   *
   * @description
   * Returns a new matcher for a pattern constructed by appending the path part and adding the
   * search parameters of the specified pattern to this pattern. The current pattern is not
   * modified. This can be understood as creating a pattern for URLs that are relative to (or
   * suffixes of) the current pattern.
   *
   * @example
   * The following two matchers are equivalent:
   * <pre>
   * new UrlMatcher('/user/{id}?q').concat('/details?date');
   * new UrlMatcher('/user/{id}/details?q&date');
   * </pre>
   *
   * @param {string} pattern  The pattern to append.
   * @param {Object} config  An object hash of the configuration for the matcher.
   * @returns {UrlMatcher}  A matcher for the concatenated pattern.
   */


  UrlMatcher.prototype.concat = function (pattern, config) {
    // Because order of search parameters is irrelevant, we can add our own search
    // parameters to the end of the new pattern. Parse the new pattern by itself
    // and then join the bits together, but it's much easier to do this on a string level.
    var defaultConfig = {
      caseInsensitive: $$UMFP.caseInsensitive(),
      strict: $$UMFP.strictMode(),
      squash: $$UMFP.defaultSquashPolicy()
    };
    return new UrlMatcher(this.sourcePath + pattern + this.sourceSearch, extend(defaultConfig, config), this);
  };

  UrlMatcher.prototype.toString = function () {
    return this.source;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:UrlMatcher#exec
   * @methodOf ui.router.util.type:UrlMatcher
   *
   * @description
   * Tests the specified path against this matcher, and returns an object containing the captured
   * parameter values, or null if the path does not match. The returned object contains the values
   * of any search parameters that are mentioned in the pattern, but their value may be null if
   * they are not present in `searchParams`. This means that search parameters are always treated
   * as optional.
   *
   * @example
   * <pre>
   * new UrlMatcher('/user/{id}?q&r').exec('/user/bob', {
   *   x: '1', q: 'hello'
   * });
   * // returns { id: 'bob', q: 'hello', r: null }
   * </pre>
   *
   * @param {string} path  The URL path to match, e.g. `$location.path()`.
   * @param {Object} searchParams  URL search parameters, e.g. `$location.search()`.
   * @returns {Object}  The captured parameter values.
   */


  UrlMatcher.prototype.exec = function (path, searchParams) {
    var m = this.regexp.exec(path);
    if (!m) return null;
    searchParams = searchParams || {};
    var paramNames = this.parameters(),
        nTotal = paramNames.length,
        nPath = this.segments.length - 1,
        values = {},
        i,
        j,
        cfg,
        paramName;
    if (nPath !== m.length - 1) throw new Error("Unbalanced capture group in route '" + this.source + "'");

    function decodePathArray(string) {
      function reverseString(str) {
        return str.split("").reverse().join("");
      }

      function unquoteDashes(str) {
        return str.replace(/\\-/g, "-");
      }

      var split = reverseString(string).split(/-(?!\\)/);
      var allReversed = map(split, reverseString);
      return map(allReversed, unquoteDashes).reverse();
    }

    var param, paramVal;

    for (i = 0; i < nPath; i++) {
      paramName = paramNames[i];
      param = this.params[paramName];
      paramVal = m[i + 1]; // if the param value matches a pre-replace pair, replace the value before decoding.

      for (j = 0; j < param.replace.length; j++) {
        if (param.replace[j].from === paramVal) paramVal = param.replace[j].to;
      }

      if (paramVal && param.array === true) paramVal = decodePathArray(paramVal);
      if (isDefined(paramVal)) paramVal = param.type.decode(paramVal);
      values[paramName] = param.value(paramVal);
    }

    for (;
    /**/
    i < nTotal; i++) {
      paramName = paramNames[i];
      values[paramName] = this.params[paramName].value(searchParams[paramName]);
      param = this.params[paramName];
      paramVal = searchParams[paramName];

      for (j = 0; j < param.replace.length; j++) {
        if (param.replace[j].from === paramVal) paramVal = param.replace[j].to;
      }

      if (isDefined(paramVal)) paramVal = param.type.decode(paramVal);
      values[paramName] = param.value(paramVal);
    }

    return values;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:UrlMatcher#parameters
   * @methodOf ui.router.util.type:UrlMatcher
   *
   * @description
   * Returns the names of all path and search parameters of this pattern in an unspecified order.
   *
   * @returns {Array.<string>}  An array of parameter names. Must be treated as read-only. If the
   *    pattern has no parameters, an empty array is returned.
   */


  UrlMatcher.prototype.parameters = function (param) {
    if (!isDefined(param)) return this.$$paramNames;
    return this.params[param] || null;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:UrlMatcher#validates
   * @methodOf ui.router.util.type:UrlMatcher
   *
   * @description
   * Checks an object hash of parameters to validate their correctness according to the parameter
   * types of this `UrlMatcher`.
   *
   * @param {Object} params The object hash of parameters to validate.
   * @returns {boolean} Returns `true` if `params` validates, otherwise `false`.
   */


  UrlMatcher.prototype.validates = function (params) {
    return this.params.$$validates(params);
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:UrlMatcher#format
   * @methodOf ui.router.util.type:UrlMatcher
   *
   * @description
   * Creates a URL that matches this pattern by substituting the specified values
   * for the path and search parameters. Null values for path parameters are
   * treated as empty strings.
   *
   * @example
   * <pre>
   * new UrlMatcher('/user/{id}?q').format({ id:'bob', q:'yes' });
   * // returns '/user/bob?q=yes'
   * </pre>
   *
   * @param {Object} values  the values to substitute for the parameters in this pattern.
   * @returns {string}  the formatted URL (path and optionally search part).
   */


  UrlMatcher.prototype.format = function (values) {
    values = values || {};
    var segments = this.segments,
        params = this.parameters(),
        paramset = this.params;
    if (!this.validates(values)) return null;
    var i,
        search = false,
        nPath = segments.length - 1,
        nTotal = params.length,
        result = segments[0];

    function encodeDashes(str) {
      // Replace dashes with encoded "\-"
      return encodeURIComponent(str).replace(/-/g, function (c) {
        return '%5C%' + c.charCodeAt(0).toString(16).toUpperCase();
      });
    }

    for (i = 0; i < nTotal; i++) {
      var isPathParam = i < nPath;
      var name = params[i],
          param = paramset[name],
          value = param.value(values[name]);
      var isDefaultValue = param.isOptional && param.type.equals(param.value(), value);
      var squash = isDefaultValue ? param.squash : false;
      var encoded = param.type.encode(value);

      if (isPathParam) {
        var nextSegment = segments[i + 1];
        var isFinalPathParam = i + 1 === nPath;

        if (squash === false) {
          if (encoded != null) {
            if (isArray(encoded)) {
              result += map(encoded, encodeDashes).join("-");
            } else {
              result += encodeURIComponent(encoded);
            }
          }

          result += nextSegment;
        } else if (squash === true) {
          var capture = result.match(/\/$/) ? /\/?(.*)/ : /(.*)/;
          result += nextSegment.match(capture)[1];
        } else if (isString(squash)) {
          result += squash + nextSegment;
        }

        if (isFinalPathParam && param.squash === true && result.slice(-1) === '/') result = result.slice(0, -1);
      } else {
        if (encoded == null || isDefaultValue && squash !== false) continue;
        if (!isArray(encoded)) encoded = [encoded];
        if (encoded.length === 0) continue;
        encoded = map(encoded, encodeURIComponent).join('&' + name + '=');
        result += (search ? '&' : '?') + (name + '=' + encoded);
        search = true;
      }
    }

    return result;
  };
  /**
   * @ngdoc object
   * @name ui.router.util.type:Type
   *
   * @description
   * Implements an interface to define custom parameter types that can be decoded from and encoded to
   * string parameters matched in a URL. Used by {@link ui.router.util.type:UrlMatcher `UrlMatcher`}
   * objects when matching or formatting URLs, or comparing or validating parameter values.
   *
   * See {@link ui.router.util.$urlMatcherFactory#methods_type `$urlMatcherFactory#type()`} for more
   * information on registering custom types.
   *
   * @param {Object} config  A configuration object which contains the custom type definition.  The object's
   *        properties will override the default methods and/or pattern in `Type`'s public interface.
   * @example
   * <pre>
   * {
   *   decode: function(val) { return parseInt(val, 10); },
   *   encode: function(val) { return val && val.toString(); },
   *   equals: function(a, b) { return this.is(a) && a === b; },
   *   is: function(val) { return angular.isNumber(val) isFinite(val) && val % 1 === 0; },
   *   pattern: /\d+/
   * }
   * </pre>
   *
   * @property {RegExp} pattern The regular expression pattern used to match values of this type when
   *           coming from a substring of a URL.
   *
   * @returns {Object}  Returns a new `Type` object.
   */


  function Type(config) {
    extend(this, config);
  }
  /**
   * @ngdoc function
   * @name ui.router.util.type:Type#is
   * @methodOf ui.router.util.type:Type
   *
   * @description
   * Detects whether a value is of a particular type. Accepts a native (decoded) value
   * and determines whether it matches the current `Type` object.
   *
   * @param {*} val  The value to check.
   * @param {string} key  Optional. If the type check is happening in the context of a specific
   *        {@link ui.router.util.type:UrlMatcher `UrlMatcher`} object, this is the name of the
   *        parameter in which `val` is stored. Can be used for meta-programming of `Type` objects.
   * @returns {Boolean}  Returns `true` if the value matches the type, otherwise `false`.
   */


  Type.prototype.is = function (val, key) {
    return true;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:Type#encode
   * @methodOf ui.router.util.type:Type
   *
   * @description
   * Encodes a custom/native type value to a string that can be embedded in a URL. Note that the
   * return value does *not* need to be URL-safe (i.e. passed through `encodeURIComponent()`), it
   * only needs to be a representation of `val` that has been coerced to a string.
   *
   * @param {*} val  The value to encode.
   * @param {string} key  The name of the parameter in which `val` is stored. Can be used for
   *        meta-programming of `Type` objects.
   * @returns {string}  Returns a string representation of `val` that can be encoded in a URL.
   */


  Type.prototype.encode = function (val, key) {
    return val;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:Type#decode
   * @methodOf ui.router.util.type:Type
   *
   * @description
   * Converts a parameter value (from URL string or transition param) to a custom/native value.
   *
   * @param {string} val  The URL parameter value to decode.
   * @param {string} key  The name of the parameter in which `val` is stored. Can be used for
   *        meta-programming of `Type` objects.
   * @returns {*}  Returns a custom representation of the URL parameter value.
   */


  Type.prototype.decode = function (val, key) {
    return val;
  };
  /**
   * @ngdoc function
   * @name ui.router.util.type:Type#equals
   * @methodOf ui.router.util.type:Type
   *
   * @description
   * Determines whether two decoded values are equivalent.
   *
   * @param {*} a  A value to compare against.
   * @param {*} b  A value to compare against.
   * @returns {Boolean}  Returns `true` if the values are equivalent/equal, otherwise `false`.
   */


  Type.prototype.equals = function (a, b) {
    return a == b;
  };

  Type.prototype.$subPattern = function () {
    var sub = this.pattern.toString();
    return sub.substr(1, sub.length - 2);
  };

  Type.prototype.pattern = /.*/;

  Type.prototype.toString = function () {
    return "{Type:" + this.name + "}";
  };
  /** Given an encoded string, or a decoded object, returns a decoded object */


  Type.prototype.$normalize = function (val) {
    return this.is(val) ? val : this.decode(val);
  };
  /*
   * Wraps an existing custom Type as an array of Type, depending on 'mode'.
   * e.g.:
   * - urlmatcher pattern "/path?{queryParam[]:int}"
   * - url: "/path?queryParam=1&queryParam=2
   * - $stateParams.queryParam will be [1, 2]
   * if `mode` is "auto", then
   * - url: "/path?queryParam=1 will create $stateParams.queryParam: 1
   * - url: "/path?queryParam=1&queryParam=2 will create $stateParams.queryParam: [1, 2]
   */


  Type.prototype.$asArray = function (mode, isSearch) {
    if (!mode) return this;
    if (mode === "auto" && !isSearch) throw new Error("'auto' array mode is for query parameters only");

    function ArrayType(type, mode) {
      function bindTo(type, callbackName) {
        return function () {
          return type[callbackName].apply(type, arguments);
        };
      } // Wrap non-array value as array


      function arrayWrap(val) {
        return isArray(val) ? val : isDefined(val) ? [val] : [];
      } // Unwrap array value for "auto" mode. Return undefined for empty array.


      function arrayUnwrap(val) {
        switch (val.length) {
          case 0:
            return undefined;

          case 1:
            return mode === "auto" ? val[0] : val;

          default:
            return val;
        }
      }

      function falsey(val) {
        return !val;
      } // Wraps type (.is/.encode/.decode) functions to operate on each value of an array


      function arrayHandler(callback, allTruthyMode) {
        return function handleArray(val) {
          if (isArray(val) && val.length === 0) return val;
          val = arrayWrap(val);
          var result = map(val, callback);
          if (allTruthyMode === true) return filter(result, falsey).length === 0;
          return arrayUnwrap(result);
        };
      } // Wraps type (.equals) functions to operate on each value of an array


      function arrayEqualsHandler(callback) {
        return function handleArray(val1, val2) {
          var left = arrayWrap(val1),
              right = arrayWrap(val2);
          if (left.length !== right.length) return false;

          for (var i = 0; i < left.length; i++) {
            if (!callback(left[i], right[i])) return false;
          }

          return true;
        };
      }

      this.encode = arrayHandler(bindTo(type, 'encode'));
      this.decode = arrayHandler(bindTo(type, 'decode'));
      this.is = arrayHandler(bindTo(type, 'is'), true);
      this.equals = arrayEqualsHandler(bindTo(type, 'equals'));
      this.pattern = type.pattern;
      this.$normalize = arrayHandler(bindTo(type, '$normalize'));
      this.name = type.name;
      this.$arrayMode = mode;
    }

    return new ArrayType(this, mode);
  };
  /**
   * @ngdoc object
   * @name ui.router.util.$urlMatcherFactory
   *
   * @description
   * Factory for {@link ui.router.util.type:UrlMatcher `UrlMatcher`} instances. The factory
   * is also available to providers under the name `$urlMatcherFactoryProvider`.
   */


  function $UrlMatcherFactory() {
    $$UMFP = this;
    var isCaseInsensitive = false,
        isStrictMode = true,
        defaultSquashPolicy = false; // Use tildes to pre-encode slashes.
    // If the slashes are simply URLEncoded, the browser can choose to pre-decode them,
    // and bidirectional encoding/decoding fails.
    // Tilde was chosen because it's not a RFC 3986 section 2.2 Reserved Character

    function valToString(val) {
      return val != null ? val.toString().replace(/(~|\/)/g, function (m) {
        return {
          '~': '~~',
          '/': '~2F'
        }[m];
      }) : val;
    }

    function valFromString(val) {
      return val != null ? val.toString().replace(/(~~|~2F)/g, function (m) {
        return {
          '~~': '~',
          '~2F': '/'
        }[m];
      }) : val;
    }

    var $types = {},
        enqueue = true,
        typeQueue = [],
        injector,
        defaultTypes = {
      "string": {
        encode: valToString,
        decode: valFromString,
        // TODO: in 1.0, make string .is() return false if value is undefined/null by default.
        // In 0.2.x, string params are optional by default for backwards compat
        is: function is(val) {
          return val == null || !isDefined(val) || typeof val === "string";
        },
        pattern: /[^/]*/
      },
      "int": {
        encode: valToString,
        decode: function decode(val) {
          return parseInt(val, 10);
        },
        is: function is(val) {
          return val !== undefined && val !== null && this.decode(val.toString()) === val;
        },
        pattern: /-?\d+/
      },
      "bool": {
        encode: function encode(val) {
          return val ? 1 : 0;
        },
        decode: function decode(val) {
          return parseInt(val, 10) !== 0;
        },
        is: function is(val) {
          return val === true || val === false;
        },
        pattern: /0|1/
      },
      "date": {
        encode: function encode(val) {
          if (!this.is(val)) return undefined;
          return [val.getFullYear(), ('0' + (val.getMonth() + 1)).slice(-2), ('0' + val.getDate()).slice(-2)].join("-");
        },
        decode: function decode(val) {
          if (this.is(val)) return val;
          var match = this.capture.exec(val);
          return match ? new Date(match[1], match[2] - 1, match[3]) : undefined;
        },
        is: function is(val) {
          return val instanceof Date && !isNaN(val.valueOf());
        },
        equals: function equals(a, b) {
          return this.is(a) && this.is(b) && a.toISOString() === b.toISOString();
        },
        pattern: /[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,
        capture: /([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/
      },
      "json": {
        encode: angular.toJson,
        decode: angular.fromJson,
        is: angular.isObject,
        equals: angular.equals,
        pattern: /[^/]*/
      },
      "any": {
        // does not encode/decode
        encode: angular.identity,
        decode: angular.identity,
        equals: angular.equals,
        pattern: /.*/
      }
    };

    function getDefaultConfig() {
      return {
        strict: isStrictMode,
        caseInsensitive: isCaseInsensitive
      };
    }

    function isInjectable(value) {
      return isFunction(value) || isArray(value) && isFunction(value[value.length - 1]);
    }
    /**
     * [Internal] Get the default value of a parameter, which may be an injectable function.
     */


    $UrlMatcherFactory.$$getDefaultValue = function (config) {
      if (!isInjectable(config.value)) return config.value;
      if (!injector) throw new Error("Injectable functions cannot be called at configuration time");
      return injector.invoke(config.value);
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#caseInsensitive
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Defines whether URL matching should be case sensitive (the default behavior), or not.
     *
     * @param {boolean} value `false` to match URL in a case sensitive manner; otherwise `true`;
     * @returns {boolean} the current value of caseInsensitive
     */


    this.caseInsensitive = function (value) {
      if (isDefined(value)) isCaseInsensitive = value;
      return isCaseInsensitive;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#strictMode
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Defines whether URLs should match trailing slashes, or not (the default behavior).
     *
     * @param {boolean=} value `false` to match trailing slashes in URLs, otherwise `true`.
     * @returns {boolean} the current value of strictMode
     */


    this.strictMode = function (value) {
      if (isDefined(value)) isStrictMode = value;
      return isStrictMode;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#defaultSquashPolicy
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Sets the default behavior when generating or matching URLs with default parameter values.
     *
     * @param {string} value A string that defines the default parameter URL squashing behavior.
     *    `nosquash`: When generating an href with a default parameter value, do not squash the parameter value from the URL
     *    `slash`: When generating an href with a default parameter value, squash (remove) the parameter value, and, if the
     *             parameter is surrounded by slashes, squash (remove) one slash from the URL
     *    any other string, e.g. "~": When generating an href with a default parameter value, squash (remove)
     *             the parameter value from the URL and replace it with this string.
     */


    this.defaultSquashPolicy = function (value) {
      if (!isDefined(value)) return defaultSquashPolicy;
      if (value !== true && value !== false && !isString(value)) throw new Error("Invalid squash policy: " + value + ". Valid policies: false, true, arbitrary-string");
      defaultSquashPolicy = value;
      return value;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#compile
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Creates a {@link ui.router.util.type:UrlMatcher `UrlMatcher`} for the specified pattern.
     *
     * @param {string} pattern  The URL pattern.
     * @param {Object} config  The config object hash.
     * @returns {UrlMatcher}  The UrlMatcher.
     */


    this.compile = function (pattern, config) {
      return new UrlMatcher(pattern, extend(getDefaultConfig(), config));
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#isMatcher
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Returns true if the specified object is a `UrlMatcher`, or false otherwise.
     *
     * @param {Object} object  The object to perform the type check against.
     * @returns {Boolean}  Returns `true` if the object matches the `UrlMatcher` interface, by
     *          implementing all the same methods.
     */


    this.isMatcher = function (o) {
      if (!isObject(o)) return false;
      var result = true;
      forEach(UrlMatcher.prototype, function (val, name) {
        if (isFunction(val)) {
          result = result && isDefined(o[name]) && isFunction(o[name]);
        }
      });
      return result;
    };
    /**
     * @ngdoc function
     * @name ui.router.util.$urlMatcherFactory#type
     * @methodOf ui.router.util.$urlMatcherFactory
     *
     * @description
     * Registers a custom {@link ui.router.util.type:Type `Type`} object that can be used to
     * generate URLs with typed parameters.
     *
     * @param {string} name  The type name.
     * @param {Object|Function} definition   The type definition. See
     *        {@link ui.router.util.type:Type `Type`} for information on the values accepted.
     * @param {Object|Function} definitionFn (optional) A function that is injected before the app
     *        runtime starts.  The result of this function is merged into the existing `definition`.
     *        See {@link ui.router.util.type:Type `Type`} for information on the values accepted.
     *
     * @returns {Object}  Returns `$urlMatcherFactoryProvider`.
     *
     * @example
     * This is a simple example of a custom type that encodes and decodes items from an
     * array, using the array index as the URL-encoded value:
     *
     * <pre>
     * var list = ['John', 'Paul', 'George', 'Ringo'];
     *
     * $urlMatcherFactoryProvider.type('listItem', {
     *   encode: function(item) {
     *     // Represent the list item in the URL using its corresponding index
     *     return list.indexOf(item);
     *   },
     *   decode: function(item) {
     *     // Look up the list item by index
     *     return list[parseInt(item, 10)];
     *   },
     *   is: function(item) {
     *     // Ensure the item is valid by checking to see that it appears
     *     // in the list
     *     return list.indexOf(item) > -1;
     *   }
     * });
     *
     * $stateProvider.state('list', {
     *   url: "/list/{item:listItem}",
     *   controller: function($scope, $stateParams) {
     *     console.log($stateParams.item);
     *   }
     * });
     *
     * // ...
     *
     * // Changes URL to '/list/3', logs "Ringo" to the console
     * $state.go('list', { item: "Ringo" });
     * </pre>
     *
     * This is a more complex example of a type that relies on dependency injection to
     * interact with services, and uses the parameter name from the URL to infer how to
     * handle encoding and decoding parameter values:
     *
     * <pre>
     * // Defines a custom type that gets a value from a service,
     * // where each service gets different types of values from
     * // a backend API:
     * $urlMatcherFactoryProvider.type('dbObject', {}, function(Users, Posts) {
     *
     *   // Matches up services to URL parameter names
     *   var services = {
     *     user: Users,
     *     post: Posts
     *   };
     *
     *   return {
     *     encode: function(object) {
     *       // Represent the object in the URL using its unique ID
     *       return object.id;
     *     },
     *     decode: function(value, key) {
     *       // Look up the object by ID, using the parameter
     *       // name (key) to call the correct service
     *       return services[key].findById(value);
     *     },
     *     is: function(object, key) {
     *       // Check that object is a valid dbObject
     *       return angular.isObject(object) && object.id && services[key];
     *     }
     *     equals: function(a, b) {
     *       // Check the equality of decoded objects by comparing
     *       // their unique IDs
     *       return a.id === b.id;
     *     }
     *   };
     * });
     *
     * // In a config() block, you can then attach URLs with
     * // type-annotated parameters:
     * $stateProvider.state('users', {
     *   url: "/users",
     *   // ...
     * }).state('users.item', {
     *   url: "/{user:dbObject}",
     *   controller: function($scope, $stateParams) {
     *     // $stateParams.user will now be an object returned from
     *     // the Users service
     *   },
     *   // ...
     * });
     * </pre>
     */


    this.type = function (name, definition, definitionFn) {
      if (!isDefined(definition)) return $types[name];
      if ($types.hasOwnProperty(name)) throw new Error("A type named '" + name + "' has already been defined.");
      $types[name] = new Type(extend({
        name: name
      }, definition));

      if (definitionFn) {
        typeQueue.push({
          name: name,
          def: definitionFn
        });
        if (!enqueue) flushTypeQueue();
      }

      return this;
    }; // `flushTypeQueue()` waits until `$urlMatcherFactory` is injected before invoking the queued `definitionFn`s


    function flushTypeQueue() {
      while (typeQueue.length) {
        var type = typeQueue.shift();
        if (type.pattern) throw new Error("You cannot override a type's .pattern at runtime.");
        angular.extend($types[type.name], injector.invoke(type.def));
      }
    } // Register default types. Store them in the prototype of $types.


    forEach(defaultTypes, function (type, name) {
      $types[name] = new Type(extend({
        name: name
      }, type));
    });
    $types = inherit($types, {});
    /* No need to document $get, since it returns this */

    this.$get = ['$injector', function ($injector) {
      injector = $injector;
      enqueue = false;
      flushTypeQueue();
      forEach(defaultTypes, function (type, name) {
        if (!$types[name]) $types[name] = new Type(type);
      });
      return this;
    }];

    this.Param = function Param(id, type, config, location) {
      var self = this;
      config = unwrapShorthand(config);
      type = getType(config, type, location);
      var arrayMode = getArrayMode();
      type = arrayMode ? type.$asArray(arrayMode, location === "search") : type;
      if (type.name === "string" && !arrayMode && location === "path" && config.value === undefined) config.value = ""; // for 0.2.x; in 0.3.0+ do not automatically default to ""

      var isOptional = config.value !== undefined;
      var squash = getSquashPolicy(config, isOptional);
      var replace = getReplace(config, arrayMode, isOptional, squash);

      function unwrapShorthand(config) {
        var keys = isObject(config) ? objectKeys(config) : [];
        var isShorthand = indexOf(keys, "value") === -1 && indexOf(keys, "type") === -1 && indexOf(keys, "squash") === -1 && indexOf(keys, "array") === -1;
        if (isShorthand) config = {
          value: config
        };
        config.$$fn = isInjectable(config.value) ? config.value : function () {
          return config.value;
        };
        return config;
      }

      function getType(config, urlType, location) {
        if (config.type && urlType) throw new Error("Param '" + id + "' has two type configurations.");
        if (urlType) return urlType;
        if (!config.type) return location === "config" ? $types.any : $types.string;
        if (angular.isString(config.type)) return $types[config.type];
        if (config.type instanceof Type) return config.type;
        return new Type(config.type);
      } // array config: param name (param[]) overrides default settings.  explicit config overrides param name.


      function getArrayMode() {
        var arrayDefaults = {
          array: location === "search" ? "auto" : false
        };
        var arrayParamNomenclature = id.match(/\[\]$/) ? {
          array: true
        } : {};
        return extend(arrayDefaults, arrayParamNomenclature, config).array;
      }
      /**
       * returns false, true, or the squash value to indicate the "default parameter url squash policy".
       */


      function getSquashPolicy(config, isOptional) {
        var squash = config.squash;
        if (!isOptional || squash === false) return false;
        if (!isDefined(squash) || squash == null) return defaultSquashPolicy;
        if (squash === true || isString(squash)) return squash;
        throw new Error("Invalid squash policy: '" + squash + "'. Valid policies: false, true, or arbitrary string");
      }

      function getReplace(config, arrayMode, isOptional, squash) {
        var replace,
            configuredKeys,
            defaultPolicy = [{
          from: "",
          to: isOptional || arrayMode ? undefined : ""
        }, {
          from: null,
          to: isOptional || arrayMode ? undefined : ""
        }];
        replace = isArray(config.replace) ? config.replace : [];
        if (isString(squash)) replace.push({
          from: squash,
          to: undefined
        });
        configuredKeys = map(replace, function (item) {
          return item.from;
        });
        return filter(defaultPolicy, function (item) {
          return indexOf(configuredKeys, item.from) === -1;
        }).concat(replace);
      }
      /**
       * [Internal] Get the default value of a parameter, which may be an injectable function.
       */


      function $$getDefaultValue() {
        if (!injector) throw new Error("Injectable functions cannot be called at configuration time");
        var defaultValue = injector.invoke(config.$$fn);
        if (defaultValue !== null && defaultValue !== undefined && !self.type.is(defaultValue)) throw new Error("Default value (" + defaultValue + ") for parameter '" + self.id + "' is not an instance of Type (" + self.type.name + ")");
        return defaultValue;
      }
      /**
       * [Internal] Gets the decoded representation of a value if the value is defined, otherwise, returns the
       * default value, which may be the result of an injectable function.
       */


      function $value(value) {
        function hasReplaceVal(val) {
          return function (obj) {
            return obj.from === val;
          };
        }

        function $replace(value) {
          var replacement = map(filter(self.replace, hasReplaceVal(value)), function (obj) {
            return obj.to;
          });
          return replacement.length ? replacement[0] : value;
        }

        value = $replace(value);
        return !isDefined(value) ? $$getDefaultValue() : self.type.$normalize(value);
      }

      function toString() {
        return "{Param:" + id + " " + type + " squash: '" + squash + "' optional: " + isOptional + "}";
      }

      extend(this, {
        id: id,
        type: type,
        location: location,
        array: arrayMode,
        squash: squash,
        replace: replace,
        isOptional: isOptional,
        value: $value,
        dynamic: undefined,
        config: config,
        toString: toString
      });
    };

    function ParamSet(params) {
      extend(this, params || {});
    }

    ParamSet.prototype = {
      $$new: function $$new() {
        return inherit(this, extend(new ParamSet(), {
          $$parent: this
        }));
      },
      $$keys: function $$keys() {
        var keys = [],
            chain = [],
            parent = this,
            ignore = objectKeys(ParamSet.prototype);

        while (parent) {
          chain.push(parent);
          parent = parent.$$parent;
        }

        chain.reverse();
        forEach(chain, function (paramset) {
          forEach(objectKeys(paramset), function (key) {
            if (indexOf(keys, key) === -1 && indexOf(ignore, key) === -1) keys.push(key);
          });
        });
        return keys;
      },
      $$values: function $$values(paramValues) {
        var values = {},
            self = this;
        forEach(self.$$keys(), function (key) {
          values[key] = self[key].value(paramValues && paramValues[key]);
        });
        return values;
      },
      $$equals: function $$equals(paramValues1, paramValues2) {
        var equal = true,
            self = this;
        forEach(self.$$keys(), function (key) {
          var left = paramValues1 && paramValues1[key],
              right = paramValues2 && paramValues2[key];
          if (!self[key].type.equals(left, right)) equal = false;
        });
        return equal;
      },
      $$validates: function $$validate(paramValues) {
        var keys = this.$$keys(),
            i,
            param,
            rawVal,
            normalized,
            encoded;

        for (i = 0; i < keys.length; i++) {
          param = this[keys[i]];
          rawVal = paramValues[keys[i]];
          if ((rawVal === undefined || rawVal === null) && param.isOptional) break; // There was no parameter value, but the param is optional

          normalized = param.type.$normalize(rawVal);
          if (!param.type.is(normalized)) return false; // The value was not of the correct Type, and could not be decoded to the correct Type

          encoded = param.type.encode(normalized);
          if (angular.isString(encoded) && !param.type.pattern.exec(encoded)) return false; // The value was of the correct type, but when encoded, did not match the Type's regexp
        }

        return true;
      },
      $$parent: undefined
    };
    this.ParamSet = ParamSet;
  } // Register as a provider so it's available to other providers


  angular.module('ui.router.util').provider('$urlMatcherFactory', $UrlMatcherFactory);
  angular.module('ui.router.util').run(['$urlMatcherFactory', function ($urlMatcherFactory) {}]);
  /**
   * @ngdoc object
   * @name ui.router.router.$urlRouterProvider
   *
   * @requires ui.router.util.$urlMatcherFactoryProvider
   * @requires $locationProvider
   *
   * @description
   * `$urlRouterProvider` has the responsibility of watching `$location`. 
   * When `$location` changes it runs through a list of rules one by one until a 
   * match is found. `$urlRouterProvider` is used behind the scenes anytime you specify 
   * a url in a state configuration. All urls are compiled into a UrlMatcher object.
   *
   * There are several methods on `$urlRouterProvider` that make it useful to use directly
   * in your module config.
   */

  $UrlRouterProvider.$inject = ['$locationProvider', '$urlMatcherFactoryProvider'];

  function $UrlRouterProvider($locationProvider, $urlMatcherFactory) {
    var rules = [],
        otherwise = null,
        interceptDeferred = false,
        listener; // Returns a string that is a prefix of all strings matching the RegExp

    function regExpPrefix(re) {
      var prefix = /^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);
      return prefix != null ? prefix[1].replace(/\\(.)/g, "$1") : '';
    } // Interpolates matched values into a String.replace()-style pattern


    function interpolate(pattern, match) {
      return pattern.replace(/\$(\$|\d{1,2})/, function (m, what) {
        return match[what === '$' ? 0 : Number(what)];
      });
    }
    /**
     * @ngdoc function
     * @name ui.router.router.$urlRouterProvider#rule
     * @methodOf ui.router.router.$urlRouterProvider
     *
     * @description
     * Defines rules that are used by `$urlRouterProvider` to find matches for
     * specific URLs.
     *
     * @example
     * <pre>
     * var app = angular.module('app', ['ui.router.router']);
     *
     * app.config(function ($urlRouterProvider) {
     *   // Here's an example of how you might allow case insensitive urls
     *   $urlRouterProvider.rule(function ($injector, $location) {
     *     var path = $location.path(),
     *         normalized = path.toLowerCase();
     *
     *     if (path !== normalized) {
     *       return normalized;
     *     }
     *   });
     * });
     * </pre>
     *
     * @param {function} rule Handler function that takes `$injector` and `$location`
     * services as arguments. You can use them to return a valid path as a string.
     *
     * @return {object} `$urlRouterProvider` - `$urlRouterProvider` instance
     */


    this.rule = function (rule) {
      if (!isFunction(rule)) throw new Error("'rule' must be a function");
      rules.push(rule);
      return this;
    };
    /**
     * @ngdoc object
     * @name ui.router.router.$urlRouterProvider#otherwise
     * @methodOf ui.router.router.$urlRouterProvider
     *
     * @description
     * Defines a path that is used when an invalid route is requested.
     *
     * @example
     * <pre>
     * var app = angular.module('app', ['ui.router.router']);
     *
     * app.config(function ($urlRouterProvider) {
     *   // if the path doesn't match any of the urls you configured
     *   // otherwise will take care of routing the user to the
     *   // specified url
     *   $urlRouterProvider.otherwise('/index');
     *
     *   // Example of using function rule as param
     *   $urlRouterProvider.otherwise(function ($injector, $location) {
     *     return '/a/valid/url';
     *   });
     * });
     * </pre>
     *
     * @param {string|function} rule The url path you want to redirect to or a function 
     * rule that returns the url path. The function version is passed two params: 
     * `$injector` and `$location` services, and must return a url string.
     *
     * @return {object} `$urlRouterProvider` - `$urlRouterProvider` instance
     */


    this.otherwise = function (rule) {
      if (isString(rule)) {
        var redirect = rule;

        rule = function rule() {
          return redirect;
        };
      } else if (!isFunction(rule)) throw new Error("'rule' must be a function");

      otherwise = rule;
      return this;
    };

    function handleIfMatch($injector, handler, match) {
      if (!match) return false;
      var result = $injector.invoke(handler, handler, {
        $match: match
      });
      return isDefined(result) ? result : true;
    }
    /**
     * @ngdoc function
     * @name ui.router.router.$urlRouterProvider#when
     * @methodOf ui.router.router.$urlRouterProvider
     *
     * @description
     * Registers a handler for a given url matching. 
     * 
     * If the handler is a string, it is
     * treated as a redirect, and is interpolated according to the syntax of match
     * (i.e. like `String.replace()` for `RegExp`, or like a `UrlMatcher` pattern otherwise).
     *
     * If the handler is a function, it is injectable. It gets invoked if `$location`
     * matches. You have the option of inject the match object as `$match`.
     *
     * The handler can return
     *
     * - **falsy** to indicate that the rule didn't match after all, then `$urlRouter`
     *   will continue trying to find another one that matches.
     * - **string** which is treated as a redirect and passed to `$location.url()`
     * - **void** or any **truthy** value tells `$urlRouter` that the url was handled.
     *
     * @example
     * <pre>
     * var app = angular.module('app', ['ui.router.router']);
     *
     * app.config(function ($urlRouterProvider) {
     *   $urlRouterProvider.when($state.url, function ($match, $stateParams) {
     *     if ($state.$current.navigable !== state ||
     *         !equalForKeys($match, $stateParams) {
     *      $state.transitionTo(state, $match, false);
     *     }
     *   });
     * });
     * </pre>
     *
     * @param {string|object} what The incoming path that you want to redirect.
     * @param {string|function} handler The path you want to redirect your user to.
     */


    this.when = function (what, handler) {
      var redirect,
          handlerIsString = isString(handler);
      if (isString(what)) what = $urlMatcherFactory.compile(what);
      if (!handlerIsString && !isFunction(handler) && !isArray(handler)) throw new Error("invalid 'handler' in when()");
      var strategies = {
        matcher: function matcher(what, handler) {
          if (handlerIsString) {
            redirect = $urlMatcherFactory.compile(handler);
            handler = ['$match', function ($match) {
              return redirect.format($match);
            }];
          }

          return extend(function ($injector, $location) {
            return handleIfMatch($injector, handler, what.exec($location.path(), $location.search()));
          }, {
            prefix: isString(what.prefix) ? what.prefix : ''
          });
        },
        regex: function regex(what, handler) {
          if (what.global || what.sticky) throw new Error("when() RegExp must not be global or sticky");

          if (handlerIsString) {
            redirect = handler;
            handler = ['$match', function ($match) {
              return interpolate(redirect, $match);
            }];
          }

          return extend(function ($injector, $location) {
            return handleIfMatch($injector, handler, what.exec($location.path()));
          }, {
            prefix: regExpPrefix(what)
          });
        }
      };
      var check = {
        matcher: $urlMatcherFactory.isMatcher(what),
        regex: what instanceof RegExp
      };

      for (var n in check) {
        if (check[n]) return this.rule(strategies[n](what, handler));
      }

      throw new Error("invalid 'what' in when()");
    };
    /**
     * @ngdoc function
     * @name ui.router.router.$urlRouterProvider#deferIntercept
     * @methodOf ui.router.router.$urlRouterProvider
     *
     * @description
     * Disables (or enables) deferring location change interception.
     *
     * If you wish to customize the behavior of syncing the URL (for example, if you wish to
     * defer a transition but maintain the current URL), call this method at configuration time.
     * Then, at run time, call `$urlRouter.listen()` after you have configured your own
     * `$locationChangeSuccess` event handler.
     *
     * @example
     * <pre>
     * var app = angular.module('app', ['ui.router.router']);
     *
     * app.config(function ($urlRouterProvider) {
     *
     *   // Prevent $urlRouter from automatically intercepting URL changes;
     *   // this allows you to configure custom behavior in between
     *   // location changes and route synchronization:
     *   $urlRouterProvider.deferIntercept();
     *
     * }).run(function ($rootScope, $urlRouter, UserService) {
     *
     *   $rootScope.$on('$locationChangeSuccess', function(e) {
     *     // UserService is an example service for managing user state
     *     if (UserService.isLoggedIn()) return;
     *
     *     // Prevent $urlRouter's default handler from firing
     *     e.preventDefault();
     *
     *     UserService.handleLogin().then(function() {
     *       // Once the user has logged in, sync the current URL
     *       // to the router:
     *       $urlRouter.sync();
     *     });
     *   });
     *
     *   // Configures $urlRouter's listener *after* your custom listener
     *   $urlRouter.listen();
     * });
     * </pre>
     *
     * @param {boolean} defer Indicates whether to defer location change interception. Passing
              no parameter is equivalent to `true`.
     */


    this.deferIntercept = function (defer) {
      if (defer === undefined) defer = true;
      interceptDeferred = defer;
    };
    /**
     * @ngdoc object
     * @name ui.router.router.$urlRouter
     *
     * @requires $location
     * @requires $rootScope
     * @requires $injector
     * @requires $browser
     *
     * @description
     *
     */


    this.$get = $get;
    $get.$inject = ['$location', '$rootScope', '$injector', '$browser', '$sniffer'];

    function $get($location, $rootScope, $injector, $browser, $sniffer) {
      var baseHref = $browser.baseHref(),
          location = $location.url(),
          lastPushedUrl;

      function appendBasePath(url, isHtml5, absolute) {
        if (baseHref === '/') return url;
        if (isHtml5) return baseHref.slice(0, -1) + url;
        if (absolute) return baseHref.slice(1) + url;
        return url;
      } // TODO: Optimize groups of rules with non-empty prefix into some sort of decision tree


      function update(evt) {
        if (evt && evt.defaultPrevented) return;
        var ignoreUpdate = lastPushedUrl && $location.url() === lastPushedUrl;
        lastPushedUrl = undefined; // TODO: Re-implement this in 1.0 for https://github.com/angular-ui/ui-router/issues/1573
        //if (ignoreUpdate) return true;

        function check(rule) {
          var handled = rule($injector, $location);
          if (!handled) return false;
          if (isString(handled)) $location.replace().url(handled);
          return true;
        }

        var n = rules.length,
            i;

        for (i = 0; i < n; i++) {
          if (check(rules[i])) return;
        } // always check otherwise last to allow dynamic updates to the set of rules


        if (otherwise) check(otherwise);
      }

      function _listen() {
        listener = listener || $rootScope.$on('$locationChangeSuccess', update);
        return listener;
      }

      if (!interceptDeferred) _listen();
      return {
        /**
         * @ngdoc function
         * @name ui.router.router.$urlRouter#sync
         * @methodOf ui.router.router.$urlRouter
         *
         * @description
         * Triggers an update; the same update that happens when the address bar url changes, aka `$locationChangeSuccess`.
         * This method is useful when you need to use `preventDefault()` on the `$locationChangeSuccess` event,
         * perform some custom logic (route protection, auth, config, redirection, etc) and then finally proceed
         * with the transition by calling `$urlRouter.sync()`.
         *
         * @example
         * <pre>
         * angular.module('app', ['ui.router'])
         *   .run(function($rootScope, $urlRouter) {
         *     $rootScope.$on('$locationChangeSuccess', function(evt) {
         *       // Halt state change from even starting
         *       evt.preventDefault();
         *       // Perform custom logic
         *       var meetsRequirement = ...
         *       // Continue with the update and state transition if logic allows
         *       if (meetsRequirement) $urlRouter.sync();
         *     });
         * });
         * </pre>
         */
        sync: function sync() {
          update();
        },
        listen: function listen() {
          return _listen();
        },
        update: function update(read) {
          if (read) {
            location = $location.url();
            return;
          }

          if ($location.url() === location) return;
          $location.url(location);
          $location.replace();
        },
        push: function push(urlMatcher, params, options) {
          var url = urlMatcher.format(params || {}); // Handle the special hash param, if needed

          if (url !== null && params && params['#']) {
            url += '#' + params['#'];
          }

          $location.url(url);
          lastPushedUrl = options && options.$$avoidResync ? $location.url() : undefined;
          if (options && options.replace) $location.replace();
        },

        /**
         * @ngdoc function
         * @name ui.router.router.$urlRouter#href
         * @methodOf ui.router.router.$urlRouter
         *
         * @description
         * A URL generation method that returns the compiled URL for a given
         * {@link ui.router.util.type:UrlMatcher `UrlMatcher`}, populated with the provided parameters.
         *
         * @example
         * <pre>
         * $bob = $urlRouter.href(new UrlMatcher("/about/:person"), {
         *   person: "bob"
         * });
         * // $bob == "/about/bob";
         * </pre>
         *
         * @param {UrlMatcher} urlMatcher The `UrlMatcher` object which is used as the template of the URL to generate.
         * @param {object=} params An object of parameter values to fill the matcher's required parameters.
         * @param {object=} options Options object. The options are:
         *
         * - **`absolute`** - {boolean=false},  If true will generate an absolute url, e.g. "http://www.example.com/fullurl".
         *
         * @returns {string} Returns the fully compiled URL, or `null` if `params` fail validation against `urlMatcher`
         */
        href: function href(urlMatcher, params, options) {
          if (!urlMatcher.validates(params)) return null;
          var isHtml5 = $locationProvider.html5Mode();

          if (angular.isObject(isHtml5)) {
            isHtml5 = isHtml5.enabled;
          }

          isHtml5 = isHtml5 && $sniffer.history;
          var url = urlMatcher.format(params);
          options = options || {};

          if (!isHtml5 && url !== null) {
            url = "#" + $locationProvider.hashPrefix() + url;
          } // Handle special hash param, if needed


          if (url !== null && params && params['#']) {
            url += '#' + params['#'];
          }

          url = appendBasePath(url, isHtml5, options.absolute);

          if (!options.absolute || !url) {
            return url;
          }

          var slash = !isHtml5 && url ? '/' : '',
              port = $location.port();
          port = port === 80 || port === 443 ? '' : ':' + port;
          return [$location.protocol(), '://', $location.host(), port, slash, url].join('');
        }
      };
    }
  }

  angular.module('ui.router.router').provider('$urlRouter', $UrlRouterProvider);
  /**
   * @ngdoc object
   * @name ui.router.state.$stateProvider
   *
   * @requires ui.router.router.$urlRouterProvider
   * @requires ui.router.util.$urlMatcherFactoryProvider
   *
   * @description
   * The new `$stateProvider` works similar to Angular's v1 router, but it focuses purely
   * on state.
   *
   * A state corresponds to a "place" in the application in terms of the overall UI and
   * navigation. A state describes (via the controller / template / view properties) what
   * the UI looks like and does at that place.
   *
   * States often have things in common, and the primary way of factoring out these
   * commonalities in this model is via the state hierarchy, i.e. parent/child states aka
   * nested states.
   *
   * The `$stateProvider` provides interfaces to declare these states for your app.
   */

  $StateProvider.$inject = ['$urlRouterProvider', '$urlMatcherFactoryProvider'];

  function $StateProvider($urlRouterProvider, $urlMatcherFactory) {
    var root,
        states = {},
        $state,
        queue = {},
        abstractKey = 'abstract'; // Builds state properties from definition passed to registerState()

    var stateBuilder = {
      // Derive parent state from a hierarchical name only if 'parent' is not explicitly defined.
      // state.children = [];
      // if (parent) parent.children.push(state);
      parent: function parent(state) {
        if (isDefined(state.parent) && state.parent) return findState(state.parent); // regex matches any valid composite state name
        // would match "contact.list" but not "contacts"

        var compositeName = /^(.+)\.[^.]+$/.exec(state.name);
        return compositeName ? findState(compositeName[1]) : root;
      },
      // inherit 'data' from parent and override by own values (if any)
      data: function data(state) {
        if (state.parent && state.parent.data) {
          state.data = state.self.data = inherit(state.parent.data, state.data);
        }

        return state.data;
      },
      // Build a URLMatcher if necessary, either via a relative or absolute URL
      url: function url(state) {
        var url = state.url,
            config = {
          params: state.params || {}
        };

        if (isString(url)) {
          if (url.charAt(0) == '^') return $urlMatcherFactory.compile(url.substring(1), config);
          return (state.parent.navigable || root).url.concat(url, config);
        }

        if (!url || $urlMatcherFactory.isMatcher(url)) return url;
        throw new Error("Invalid url '" + url + "' in state '" + state + "'");
      },
      // Keep track of the closest ancestor state that has a URL (i.e. is navigable)
      navigable: function navigable(state) {
        return state.url ? state : state.parent ? state.parent.navigable : null;
      },
      // Own parameters for this state. state.url.params is already built at this point. Create and add non-url params
      ownParams: function ownParams(state) {
        var params = state.url && state.url.params || new $$UMFP.ParamSet();
        forEach(state.params || {}, function (config, id) {
          if (!params[id]) params[id] = new $$UMFP.Param(id, null, config, "config");
        });
        return params;
      },
      // Derive parameters for this state and ensure they're a super-set of parent's parameters
      params: function params(state) {
        var ownParams = pick(state.ownParams, state.ownParams.$$keys());
        return state.parent && state.parent.params ? extend(state.parent.params.$$new(), ownParams) : new $$UMFP.ParamSet();
      },
      // If there is no explicit multi-view configuration, make one up so we don't have
      // to handle both cases in the view directive later. Note that having an explicit
      // 'views' property will mean the default unnamed view properties are ignored. This
      // is also a good time to resolve view names to absolute names, so everything is a
      // straight lookup at link time.
      views: function views(state) {
        var views = {};
        forEach(isDefined(state.views) ? state.views : {
          '': state
        }, function (view, name) {
          if (name.indexOf('@') < 0) name += '@' + state.parent.name;
          view.resolveAs = view.resolveAs || state.resolveAs || '$resolve';
          views[name] = view;
        });
        return views;
      },
      // Keep a full path from the root down to this state as this is needed for state activation.
      path: function path(state) {
        return state.parent ? state.parent.path.concat(state) : []; // exclude root from path
      },
      // Speed up $state.contains() as it's used a lot
      includes: function includes(state) {
        var includes = state.parent ? extend({}, state.parent.includes) : {};
        includes[state.name] = true;
        return includes;
      },
      $delegates: {}
    };

    function isRelative(stateName) {
      return stateName.indexOf(".") === 0 || stateName.indexOf("^") === 0;
    }

    function findState(stateOrName, base) {
      if (!stateOrName) return undefined;
      var isStr = isString(stateOrName),
          name = isStr ? stateOrName : stateOrName.name,
          path = isRelative(name);

      if (path) {
        if (!base) throw new Error("No reference point given for path '" + name + "'");
        base = findState(base);
        var rel = name.split("."),
            i = 0,
            pathLength = rel.length,
            current = base;

        for (; i < pathLength; i++) {
          if (rel[i] === "" && i === 0) {
            current = base;
            continue;
          }

          if (rel[i] === "^") {
            if (!current.parent) throw new Error("Path '" + name + "' not valid for state '" + base.name + "'");
            current = current.parent;
            continue;
          }

          break;
        }

        rel = rel.slice(i).join(".");
        name = current.name + (current.name && rel ? "." : "") + rel;
      }

      var state = states[name];

      if (state && (isStr || !isStr && (state === stateOrName || state.self === stateOrName))) {
        return state;
      }

      return undefined;
    }

    function queueState(parentName, state) {
      if (!queue[parentName]) {
        queue[parentName] = [];
      }

      queue[parentName].push(state);
    }

    function flushQueuedChildren(parentName) {
      var queued = queue[parentName] || [];

      while (queued.length) {
        registerState(queued.shift());
      }
    }

    function registerState(state) {
      // Wrap a new object around the state so we can store our private details easily.
      state = inherit(state, {
        self: state,
        resolve: state.resolve || {},
        toString: function toString() {
          return this.name;
        }
      });
      var name = state.name;
      if (!isString(name) || name.indexOf('@') >= 0) throw new Error("State must have a valid name");
      if (states.hasOwnProperty(name)) throw new Error("State '" + name + "' is already defined"); // Get parent name

      var parentName = name.indexOf('.') !== -1 ? name.substring(0, name.lastIndexOf('.')) : isString(state.parent) ? state.parent : isObject(state.parent) && isString(state.parent.name) ? state.parent.name : ''; // If parent is not registered yet, add state to queue and register later

      if (parentName && !states[parentName]) {
        return queueState(parentName, state.self);
      }

      for (var key in stateBuilder) {
        if (isFunction(stateBuilder[key])) state[key] = stateBuilder[key](state, stateBuilder.$delegates[key]);
      }

      states[name] = state; // Register the state in the global state list and with $urlRouter if necessary.

      if (!state[abstractKey] && state.url) {
        $urlRouterProvider.when(state.url, ['$match', '$stateParams', function ($match, $stateParams) {
          if ($state.$current.navigable != state || !equalForKeys($match, $stateParams)) {
            $state.transitionTo(state, $match, {
              inherit: true,
              location: false
            });
          }
        }]);
      } // Register any queued children


      flushQueuedChildren(name);
      return state;
    } // Checks text to see if it looks like a glob.


    function isGlob(text) {
      return text.indexOf('*') > -1;
    } // Returns true if glob matches current $state name.


    function doesStateMatchGlob(glob) {
      var globSegments = glob.split('.'),
          segments = $state.$current.name.split('.'); //match single stars

      for (var i = 0, l = globSegments.length; i < l; i++) {
        if (globSegments[i] === '*') {
          segments[i] = '*';
        }
      } //match greedy starts


      if (globSegments[0] === '**') {
        segments = segments.slice(indexOf(segments, globSegments[1]));
        segments.unshift('**');
      } //match greedy ends


      if (globSegments[globSegments.length - 1] === '**') {
        segments.splice(indexOf(segments, globSegments[globSegments.length - 2]) + 1, Number.MAX_VALUE);
        segments.push('**');
      }

      if (globSegments.length != segments.length) {
        return false;
      }

      return segments.join('') === globSegments.join('');
    } // Implicit root state that is always active


    root = registerState({
      name: '',
      url: '^',
      views: null,
      'abstract': true
    });
    root.navigable = null;
    /**
     * @ngdoc function
     * @name ui.router.state.$stateProvider#decorator
     * @methodOf ui.router.state.$stateProvider
     *
     * @description
     * Allows you to extend (carefully) or override (at your own peril) the 
     * `stateBuilder` object used internally by `$stateProvider`. This can be used 
     * to add custom functionality to ui-router, for example inferring templateUrl 
     * based on the state name.
     *
     * When passing only a name, it returns the current (original or decorated) builder
     * function that matches `name`.
     *
     * The builder functions that can be decorated are listed below. Though not all
     * necessarily have a good use case for decoration, that is up to you to decide.
     *
     * In addition, users can attach custom decorators, which will generate new 
     * properties within the state's internal definition. There is currently no clear 
     * use-case for this beyond accessing internal states (i.e. $state.$current), 
     * however, expect this to become increasingly relevant as we introduce additional 
     * meta-programming features.
     *
     * **Warning**: Decorators should not be interdependent because the order of 
     * execution of the builder functions in non-deterministic. Builder functions 
     * should only be dependent on the state definition object and super function.
     *
     *
     * Existing builder functions and current return values:
     *
     * - **parent** `{object}` - returns the parent state object.
     * - **data** `{object}` - returns state data, including any inherited data that is not
     *   overridden by own values (if any).
     * - **url** `{object}` - returns a {@link ui.router.util.type:UrlMatcher UrlMatcher}
     *   or `null`.
     * - **navigable** `{object}` - returns closest ancestor state that has a URL (aka is 
     *   navigable).
     * - **params** `{object}` - returns an array of state params that are ensured to 
     *   be a super-set of parent's params.
     * - **views** `{object}` - returns a views object where each key is an absolute view 
     *   name (i.e. "viewName@stateName") and each value is the config object 
     *   (template, controller) for the view. Even when you don't use the views object 
     *   explicitly on a state config, one is still created for you internally.
     *   So by decorating this builder function you have access to decorating template 
     *   and controller properties.
     * - **ownParams** `{object}` - returns an array of params that belong to the state, 
     *   not including any params defined by ancestor states.
     * - **path** `{string}` - returns the full path from the root down to this state. 
     *   Needed for state activation.
     * - **includes** `{object}` - returns an object that includes every state that 
     *   would pass a `$state.includes()` test.
     *
     * @example
     * <pre>
     * // Override the internal 'views' builder with a function that takes the state
     * // definition, and a reference to the internal function being overridden:
     * $stateProvider.decorator('views', function (state, parent) {
     *   var result = {},
     *       views = parent(state);
     *
     *   angular.forEach(views, function (config, name) {
     *     var autoName = (state.name + '.' + name).replace('.', '/');
     *     config.templateUrl = config.templateUrl || '/partials/' + autoName + '.html';
     *     result[name] = config;
     *   });
     *   return result;
     * });
     *
     * $stateProvider.state('home', {
     *   views: {
     *     'contact.list': { controller: 'ListController' },
     *     'contact.item': { controller: 'ItemController' }
     *   }
     * });
     *
     * // ...
     *
     * $state.go('home');
     * // Auto-populates list and item views with /partials/home/contact/list.html,
     * // and /partials/home/contact/item.html, respectively.
     * </pre>
     *
     * @param {string} name The name of the builder function to decorate. 
     * @param {object} func A function that is responsible for decorating the original 
     * builder function. The function receives two parameters:
     *
     *   - `{object}` - state - The state config object.
     *   - `{object}` - super - The original builder function.
     *
     * @return {object} $stateProvider - $stateProvider instance
     */

    this.decorator = decorator;

    function decorator(name, func) {
      /*jshint validthis: true */
      if (isString(name) && !isDefined(func)) {
        return stateBuilder[name];
      }

      if (!isFunction(func) || !isString(name)) {
        return this;
      }

      if (stateBuilder[name] && !stateBuilder.$delegates[name]) {
        stateBuilder.$delegates[name] = stateBuilder[name];
      }

      stateBuilder[name] = func;
      return this;
    }
    /**
     * @ngdoc function
     * @name ui.router.state.$stateProvider#state
     * @methodOf ui.router.state.$stateProvider
     *
     * @description
     * Registers a state configuration under a given state name. The stateConfig object
     * has the following acceptable properties.
     *
     * @param {string} name A unique state name, e.g. "home", "about", "contacts".
     * To create a parent/child state use a dot, e.g. "about.sales", "home.newest".
     * @param {object} stateConfig State configuration object.
     * @param {string|function=} stateConfig.template
     * <a id='template'></a>
     *   html template as a string or a function that returns
     *   an html template as a string which should be used by the uiView directives. This property 
     *   takes precedence over templateUrl.
     *   
     *   If `template` is a function, it will be called with the following parameters:
     *
     *   - {array.&lt;object&gt;} - state parameters extracted from the current $location.path() by
     *     applying the current state
     *
     * <pre>template:
     *   "<h1>inline template definition</h1>" +
     *   "<div ui-view></div>"</pre>
     * <pre>template: function(params) {
     *       return "<h1>generated template</h1>"; }</pre>
     * </div>
     *
     * @param {string|function=} stateConfig.templateUrl
     * <a id='templateUrl'></a>
     *
     *   path or function that returns a path to an html
     *   template that should be used by uiView.
     *   
     *   If `templateUrl` is a function, it will be called with the following parameters:
     *
     *   - {array.&lt;object&gt;} - state parameters extracted from the current $location.path() by 
     *     applying the current state
     *
     * <pre>templateUrl: "home.html"</pre>
     * <pre>templateUrl: function(params) {
     *     return myTemplates[params.pageId]; }</pre>
     *
     * @param {function=} stateConfig.templateProvider
     * <a id='templateProvider'></a>
     *    Provider function that returns HTML content string.
     * <pre> templateProvider:
     *       function(MyTemplateService, params) {
     *         return MyTemplateService.getTemplate(params.pageId);
     *       }</pre>
     *
     * @param {string|function=} stateConfig.controller
     * <a id='controller'></a>
     *
     *  Controller fn that should be associated with newly
     *   related scope or the name of a registered controller if passed as a string.
     *   Optionally, the ControllerAs may be declared here.
     * <pre>controller: "MyRegisteredController"</pre>
     * <pre>controller:
     *     "MyRegisteredController as fooCtrl"}</pre>
     * <pre>controller: function($scope, MyService) {
     *     $scope.data = MyService.getData(); }</pre>
     *
     * @param {function=} stateConfig.controllerProvider
     * <a id='controllerProvider'></a>
     *
     * Injectable provider function that returns the actual controller or string.
     * <pre>controllerProvider:
     *   function(MyResolveData) {
     *     if (MyResolveData.foo)
     *       return "FooCtrl"
     *     else if (MyResolveData.bar)
     *       return "BarCtrl";
     *     else return function($scope) {
     *       $scope.baz = "Qux";
     *     }
     *   }</pre>
     *
     * @param {string=} stateConfig.controllerAs
     * <a id='controllerAs'></a>
     * 
     * A controller alias name. If present the controller will be
     *   published to scope under the controllerAs name.
     * <pre>controllerAs: "myCtrl"</pre>
     *
     * @param {string|object=} stateConfig.parent
     * <a id='parent'></a>
     * Optionally specifies the parent state of this state.
     *
     * <pre>parent: 'parentState'</pre>
     * <pre>parent: parentState // JS variable</pre>
     *
     * @param {object=} stateConfig.resolve
     * <a id='resolve'></a>
     *
     * An optional map&lt;string, function&gt; of dependencies which
     *   should be injected into the controller. If any of these dependencies are promises, 
     *   the router will wait for them all to be resolved before the controller is instantiated.
     *   If all the promises are resolved successfully, the $stateChangeSuccess event is fired
     *   and the values of the resolved promises are injected into any controllers that reference them.
     *   If any  of the promises are rejected the $stateChangeError event is fired.
     *
     *   The map object is:
     *   
     *   - key - {string}: name of dependency to be injected into controller
     *   - factory - {string|function}: If string then it is alias for service. Otherwise if function, 
     *     it is injected and return value it treated as dependency. If result is a promise, it is 
     *     resolved before its value is injected into controller.
     *
     * <pre>resolve: {
     *     myResolve1:
     *       function($http, $stateParams) {
     *         return $http.get("/api/foos/"+stateParams.fooID);
     *       }
     *     }</pre>
     *
     * @param {string=} stateConfig.url
     * <a id='url'></a>
     *
     *   A url fragment with optional parameters. When a state is navigated or
     *   transitioned to, the `$stateParams` service will be populated with any 
     *   parameters that were passed.
     *
     *   (See {@link ui.router.util.type:UrlMatcher UrlMatcher} `UrlMatcher`} for
     *   more details on acceptable patterns )
     *
     * examples:
     * <pre>url: "/home"
     * url: "/users/:userid"
     * url: "/books/{bookid:[a-zA-Z_-]}"
     * url: "/books/{categoryid:int}"
     * url: "/books/{publishername:string}/{categoryid:int}"
     * url: "/messages?before&after"
     * url: "/messages?{before:date}&{after:date}"
     * url: "/messages/:mailboxid?{before:date}&{after:date}"
     * </pre>
     *
     * @param {object=} stateConfig.views
     * <a id='views'></a>
     * an optional map&lt;string, object&gt; which defined multiple views, or targets views
     * manually/explicitly.
     *
     * Examples:
     *
     * Targets three named `ui-view`s in the parent state's template
     * <pre>views: {
     *     header: {
     *       controller: "headerCtrl",
     *       templateUrl: "header.html"
     *     }, body: {
     *       controller: "bodyCtrl",
     *       templateUrl: "body.html"
     *     }, footer: {
     *       controller: "footCtrl",
     *       templateUrl: "footer.html"
     *     }
     *   }</pre>
     *
     * Targets named `ui-view="header"` from grandparent state 'top''s template, and named `ui-view="body" from parent state's template.
     * <pre>views: {
     *     'header@top': {
     *       controller: "msgHeaderCtrl",
     *       templateUrl: "msgHeader.html"
     *     }, 'body': {
     *       controller: "messagesCtrl",
     *       templateUrl: "messages.html"
     *     }
     *   }</pre>
     *
     * @param {boolean=} [stateConfig.abstract=false]
     * <a id='abstract'></a>
     * An abstract state will never be directly activated,
     *   but can provide inherited properties to its common children states.
     * <pre>abstract: true</pre>
     *
     * @param {function=} stateConfig.onEnter
     * <a id='onEnter'></a>
     *
     * Callback function for when a state is entered. Good way
     *   to trigger an action or dispatch an event, such as opening a dialog.
     * If minifying your scripts, make sure to explicitly annotate this function,
     * because it won't be automatically annotated by your build tools.
     *
     * <pre>onEnter: function(MyService, $stateParams) {
     *     MyService.foo($stateParams.myParam);
     * }</pre>
     *
     * @param {function=} stateConfig.onExit
     * <a id='onExit'></a>
     *
     * Callback function for when a state is exited. Good way to
     *   trigger an action or dispatch an event, such as opening a dialog.
     * If minifying your scripts, make sure to explicitly annotate this function,
     * because it won't be automatically annotated by your build tools.
     *
     * <pre>onExit: function(MyService, $stateParams) {
     *     MyService.cleanup($stateParams.myParam);
     * }</pre>
     *
     * @param {boolean=} [stateConfig.reloadOnSearch=true]
     * <a id='reloadOnSearch'></a>
     *
     * If `false`, will not retrigger the same state
     *   just because a search/query parameter has changed (via $location.search() or $location.hash()). 
     *   Useful for when you'd like to modify $location.search() without triggering a reload.
     * <pre>reloadOnSearch: false</pre>
     *
     * @param {object=} stateConfig.data
     * <a id='data'></a>
     *
     * Arbitrary data object, useful for custom configuration.  The parent state's `data` is
     *   prototypally inherited.  In other words, adding a data property to a state adds it to
     *   the entire subtree via prototypal inheritance.
     *
     * <pre>data: {
     *     requiredRole: 'foo'
     * } </pre>
     *
     * @param {object=} stateConfig.params
     * <a id='params'></a>
     *
     * A map which optionally configures parameters declared in the `url`, or
     *   defines additional non-url parameters.  For each parameter being
     *   configured, add a configuration object keyed to the name of the parameter.
     *
     *   Each parameter configuration object may contain the following properties:
     *
     *   - ** value ** - {object|function=}: specifies the default value for this
     *     parameter.  This implicitly sets this parameter as optional.
     *
     *     When UI-Router routes to a state and no value is
     *     specified for this parameter in the URL or transition, the
     *     default value will be used instead.  If `value` is a function,
     *     it will be injected and invoked, and the return value used.
     *
     *     *Note*: `undefined` is treated as "no default value" while `null`
     *     is treated as "the default value is `null`".
     *
     *     *Shorthand*: If you only need to configure the default value of the
     *     parameter, you may use a shorthand syntax.   In the **`params`**
     *     map, instead mapping the param name to a full parameter configuration
     *     object, simply set map it to the default parameter value, e.g.:
     *
     * <pre>// define a parameter's default value
     * params: {
     *     param1: { value: "defaultValue" }
     * }
     * // shorthand default values
     * params: {
     *     param1: "defaultValue",
     *     param2: "param2Default"
     * }</pre>
     *
     *   - ** array ** - {boolean=}: *(default: false)* If true, the param value will be
     *     treated as an array of values.  If you specified a Type, the value will be
     *     treated as an array of the specified Type.  Note: query parameter values
     *     default to a special `"auto"` mode.
     *
     *     For query parameters in `"auto"` mode, if multiple  values for a single parameter
     *     are present in the URL (e.g.: `/foo?bar=1&bar=2&bar=3`) then the values
     *     are mapped to an array (e.g.: `{ foo: [ '1', '2', '3' ] }`).  However, if
     *     only one value is present (e.g.: `/foo?bar=1`) then the value is treated as single
     *     value (e.g.: `{ foo: '1' }`).
     *
     * <pre>params: {
     *     param1: { array: true }
     * }</pre>
     *
     *   - ** squash ** - {bool|string=}: `squash` configures how a default parameter value is represented in the URL when
     *     the current parameter value is the same as the default value. If `squash` is not set, it uses the
     *     configured default squash policy.
     *     (See {@link ui.router.util.$urlMatcherFactory#methods_defaultSquashPolicy `defaultSquashPolicy()`})
     *
     *   There are three squash settings:
     *
     *     - false: The parameter's default value is not squashed.  It is encoded and included in the URL
     *     - true: The parameter's default value is omitted from the URL.  If the parameter is preceeded and followed
     *       by slashes in the state's `url` declaration, then one of those slashes are omitted.
     *       This can allow for cleaner looking URLs.
     *     - `"<arbitrary string>"`: The parameter's default value is replaced with an arbitrary placeholder of  your choice.
     *
     * <pre>params: {
     *     param1: {
     *       value: "defaultId",
     *       squash: true
     * } }
     * // squash "defaultValue" to "~"
     * params: {
     *     param1: {
     *       value: "defaultValue",
     *       squash: "~"
     * } }
     * </pre>
     *
     *
     * @example
     * <pre>
     * // Some state name examples
     *
     * // stateName can be a single top-level name (must be unique).
     * $stateProvider.state("home", {});
     *
     * // Or it can be a nested state name. This state is a child of the
     * // above "home" state.
     * $stateProvider.state("home.newest", {});
     *
     * // Nest states as deeply as needed.
     * $stateProvider.state("home.newest.abc.xyz.inception", {});
     *
     * // state() returns $stateProvider, so you can chain state declarations.
     * $stateProvider
     *   .state("home", {})
     *   .state("about", {})
     *   .state("contacts", {});
     * </pre>
     *
     */


    this.state = state;

    function state(name, definition) {
      /*jshint validthis: true */
      if (isObject(name)) definition = name;else definition.name = name;
      registerState(definition);
      return this;
    }
    /**
     * @ngdoc object
     * @name ui.router.state.$state
     *
     * @requires $rootScope
     * @requires $q
     * @requires ui.router.state.$view
     * @requires $injector
     * @requires ui.router.util.$resolve
     * @requires ui.router.state.$stateParams
     * @requires ui.router.router.$urlRouter
     *
     * @property {object} params A param object, e.g. {sectionId: section.id)}, that 
     * you'd like to test against the current active state.
     * @property {object} current A reference to the state's config object. However 
     * you passed it in. Useful for accessing custom data.
     * @property {object} transition Currently pending transition. A promise that'll 
     * resolve or reject.
     *
     * @description
     * `$state` service is responsible for representing states as well as transitioning
     * between them. It also provides interfaces to ask for current state or even states
     * you're coming from.
     */


    this.$get = $get;
    $get.$inject = ['$rootScope', '$q', '$view', '$injector', '$resolve', '$stateParams', '$urlRouter', '$location', '$urlMatcherFactory'];

    function $get($rootScope, $q, $view, $injector, $resolve, $stateParams, $urlRouter, $location, $urlMatcherFactory) {
      var TransitionSupersededError = new Error('transition superseded');
      var TransitionSuperseded = silenceUncaughtInPromise($q.reject(TransitionSupersededError));
      var TransitionPrevented = silenceUncaughtInPromise($q.reject(new Error('transition prevented')));
      var TransitionAborted = silenceUncaughtInPromise($q.reject(new Error('transition aborted')));
      var TransitionFailed = silenceUncaughtInPromise($q.reject(new Error('transition failed'))); // Handles the case where a state which is the target of a transition is not found, and the user
      // can optionally retry or defer the transition

      function handleRedirect(redirect, state, params, options) {
        /**
         * @ngdoc event
         * @name ui.router.state.$state#$stateNotFound
         * @eventOf ui.router.state.$state
         * @eventType broadcast on root scope
         * @description
         * Fired when a requested state **cannot be found** using the provided state name during transition.
         * The event is broadcast allowing any handlers a single chance to deal with the error (usually by
         * lazy-loading the unfound state). A special `unfoundState` object is passed to the listener handler,
         * you can see its three properties in the example. You can use `event.preventDefault()` to abort the
         * transition and the promise returned from `go` will be rejected with a `'transition aborted'` value.
         *
         * @param {Object} event Event object.
         * @param {Object} unfoundState Unfound State information. Contains: `to, toParams, options` properties.
         * @param {State} fromState Current state object.
         * @param {Object} fromParams Current state params.
         *
         * @example
         *
         * <pre>
         * // somewhere, assume lazy.state has not been defined
         * $state.go("lazy.state", {a:1, b:2}, {inherit:false});
         *
         * // somewhere else
         * $scope.$on('$stateNotFound',
         * function(event, unfoundState, fromState, fromParams){
         *     console.log(unfoundState.to); // "lazy.state"
         *     console.log(unfoundState.toParams); // {a:1, b:2}
         *     console.log(unfoundState.options); // {inherit:false} + default options
         * })
         * </pre>
         */
        var evt = $rootScope.$broadcast('$stateNotFound', redirect, state, params);

        if (evt.defaultPrevented) {
          $urlRouter.update();
          return TransitionAborted;
        }

        if (!evt.retry) {
          return null;
        } // Allow the handler to return a promise to defer state lookup retry


        if (options.$retry) {
          $urlRouter.update();
          return TransitionFailed;
        }

        var retryTransition = $state.transition = $q.when(evt.retry);
        retryTransition.then(function () {
          if (retryTransition !== $state.transition) {
            $rootScope.$broadcast('$stateChangeCancel', redirect.to, redirect.toParams, state, params);
            return TransitionSuperseded;
          }

          redirect.options.$retry = true;
          return $state.transitionTo(redirect.to, redirect.toParams, redirect.options);
        }, function () {
          return TransitionAborted;
        });
        $urlRouter.update();
        return retryTransition;
      }

      root.locals = {
        resolve: null,
        globals: {
          $stateParams: {}
        }
      };
      $state = {
        params: {},
        current: root.self,
        $current: root,
        transition: null
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#reload
       * @methodOf ui.router.state.$state
       *
       * @description
       * A method that force reloads the current state. All resolves are re-resolved,
       * controllers reinstantiated, and events re-fired.
       *
       * @example
       * <pre>
       * var app angular.module('app', ['ui.router']);
       *
       * app.controller('ctrl', function ($scope, $state) {
       *   $scope.reload = function(){
       *     $state.reload();
       *   }
       * });
       * </pre>
       *
       * `reload()` is just an alias for:
       * <pre>
       * $state.transitionTo($state.current, $stateParams, { 
       *   reload: true, inherit: false, notify: true
       * });
       * </pre>
       *
       * @param {string=|object=} state - A state name or a state object, which is the root of the resolves to be re-resolved.
       * @example
       * <pre>
       * //assuming app application consists of 3 states: 'contacts', 'contacts.detail', 'contacts.detail.item' 
       * //and current state is 'contacts.detail.item'
       * var app angular.module('app', ['ui.router']);
       *
       * app.controller('ctrl', function ($scope, $state) {
       *   $scope.reload = function(){
       *     //will reload 'contact.detail' and 'contact.detail.item' states
       *     $state.reload('contact.detail');
       *   }
       * });
       * </pre>
       *
       * `reload()` is just an alias for:
       * <pre>
       * $state.transitionTo($state.current, $stateParams, { 
       *   reload: true, inherit: false, notify: true
       * });
       * </pre>
        * @returns {promise} A promise representing the state of the new transition. See
       * {@link ui.router.state.$state#methods_go $state.go}.
       */

      $state.reload = function reload(state) {
        return $state.transitionTo($state.current, $stateParams, {
          reload: state || true,
          inherit: false,
          notify: true
        });
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#go
       * @methodOf ui.router.state.$state
       *
       * @description
       * Convenience method for transitioning to a new state. `$state.go` calls 
       * `$state.transitionTo` internally but automatically sets options to 
       * `{ location: true, inherit: true, relative: $state.$current, notify: true }`. 
       * This allows you to easily use an absolute or relative to path and specify 
       * only the parameters you'd like to update (while letting unspecified parameters 
       * inherit from the currently active ancestor states).
       *
       * @example
       * <pre>
       * var app = angular.module('app', ['ui.router']);
       *
       * app.controller('ctrl', function ($scope, $state) {
       *   $scope.changeState = function () {
       *     $state.go('contact.detail');
       *   };
       * });
       * </pre>
       * <img src='../ngdoc_assets/StateGoExamples.png'/>
       *
       * @param {string} to Absolute state name or relative state path. Some examples:
       *
       * - `$state.go('contact.detail')` - will go to the `contact.detail` state
       * - `$state.go('^')` - will go to a parent state
       * - `$state.go('^.sibling')` - will go to a sibling state
       * - `$state.go('.child.grandchild')` - will go to grandchild state
       *
       * @param {object=} params A map of the parameters that will be sent to the state, 
       * will populate $stateParams. Any parameters that are not specified will be inherited from currently 
       * defined parameters. Only parameters specified in the state definition can be overridden, new 
       * parameters will be ignored. This allows, for example, going to a sibling state that shares parameters
       * specified in a parent state. Parameter inheritance only works between common ancestor states, I.e.
       * transitioning to a sibling will get you the parameters for all parents, transitioning to a child
       * will get you all current parameters, etc.
       * @param {object=} options Options object. The options are:
       *
       * - **`location`** - {boolean=true|string=} - If `true` will update the url in the location bar, if `false`
       *    will not. If string, must be `"replace"`, which will update url and also replace last history record.
       * - **`inherit`** - {boolean=true}, If `true` will inherit url parameters from current url.
       * - **`relative`** - {object=$state.$current}, When transitioning with relative path (e.g '^'), 
       *    defines which state to be relative from.
       * - **`notify`** - {boolean=true}, If `true` will broadcast $stateChangeStart and $stateChangeSuccess events.
       * - **`reload`** (v0.2.5) - {boolean=false|string|object}, If `true` will force transition even if no state or params
       *    have changed.  It will reload the resolves and views of the current state and parent states.
       *    If `reload` is a string (or state object), the state object is fetched (by name, or object reference); and \
       *    the transition reloads the resolves and views for that matched state, and all its children states.
       *
       * @returns {promise} A promise representing the state of the new transition.
       *
       * Possible success values:
       *
       * - $state.current
       *
       * <br/>Possible rejection values:
       *
       * - 'transition superseded' - when a newer transition has been started after this one
       * - 'transition prevented' - when `event.preventDefault()` has been called in a `$stateChangeStart` listener
       * - 'transition aborted' - when `event.preventDefault()` has been called in a `$stateNotFound` listener or
       *   when a `$stateNotFound` `event.retry` promise errors.
       * - 'transition failed' - when a state has been unsuccessfully found after 2 tries.
       * - *resolve error* - when an error has occurred with a `resolve`
       *
       */


      $state.go = function go(to, params, options) {
        return $state.transitionTo(to, params, extend({
          inherit: true,
          relative: $state.$current
        }, options));
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#transitionTo
       * @methodOf ui.router.state.$state
       *
       * @description
       * Low-level method for transitioning to a new state. {@link ui.router.state.$state#methods_go $state.go}
       * uses `transitionTo` internally. `$state.go` is recommended in most situations.
       *
       * @example
       * <pre>
       * var app = angular.module('app', ['ui.router']);
       *
       * app.controller('ctrl', function ($scope, $state) {
       *   $scope.changeState = function () {
       *     $state.transitionTo('contact.detail');
       *   };
       * });
       * </pre>
       *
       * @param {string} to State name.
       * @param {object=} toParams A map of the parameters that will be sent to the state,
       * will populate $stateParams.
       * @param {object=} options Options object. The options are:
       *
       * - **`location`** - {boolean=true|string=} - If `true` will update the url in the location bar, if `false`
       *    will not. If string, must be `"replace"`, which will update url and also replace last history record.
       * - **`inherit`** - {boolean=false}, If `true` will inherit url parameters from current url.
       * - **`relative`** - {object=}, When transitioning with relative path (e.g '^'), 
       *    defines which state to be relative from.
       * - **`notify`** - {boolean=true}, If `true` will broadcast $stateChangeStart and $stateChangeSuccess events.
       * - **`reload`** (v0.2.5) - {boolean=false|string=|object=}, If `true` will force transition even if the state or params 
       *    have not changed, aka a reload of the same state. It differs from reloadOnSearch because you'd
       *    use this when you want to force a reload when *everything* is the same, including search params.
       *    if String, then will reload the state with the name given in reload, and any children.
       *    if Object, then a stateObj is expected, will reload the state found in stateObj, and any children.
       *
       * @returns {promise} A promise representing the state of the new transition. See
       * {@link ui.router.state.$state#methods_go $state.go}.
       */


      $state.transitionTo = function transitionTo(to, toParams, options) {
        toParams = toParams || {};
        options = extend({
          location: true,
          inherit: false,
          relative: null,
          notify: true,
          reload: false,
          $retry: false
        }, options || {});
        var from = $state.$current,
            fromParams = $state.params,
            fromPath = from.path;
        var evt,
            toState = findState(to, options.relative); // Store the hash param for later (since it will be stripped out by various methods)

        var hash = toParams['#'];

        if (!isDefined(toState)) {
          var redirect = {
            to: to,
            toParams: toParams,
            options: options
          };
          var redirectResult = handleRedirect(redirect, from.self, fromParams, options);

          if (redirectResult) {
            return redirectResult;
          } // Always retry once if the $stateNotFound was not prevented
          // (handles either redirect changed or state lazy-definition)


          to = redirect.to;
          toParams = redirect.toParams;
          options = redirect.options;
          toState = findState(to, options.relative);

          if (!isDefined(toState)) {
            if (!options.relative) throw new Error("No such state '" + to + "'");
            throw new Error("Could not resolve '" + to + "' from state '" + options.relative + "'");
          }
        }

        if (toState[abstractKey]) throw new Error("Cannot transition to abstract state '" + to + "'");
        if (options.inherit) toParams = inheritParams($stateParams, toParams || {}, $state.$current, toState);
        if (!toState.params.$$validates(toParams)) return TransitionFailed;
        toParams = toState.params.$$values(toParams);
        to = toState;
        var toPath = to.path; // Starting from the root of the path, keep all levels that haven't changed

        var keep = 0,
            state = toPath[keep],
            locals = root.locals,
            toLocals = [];

        if (!options.reload) {
          while (state && state === fromPath[keep] && state.ownParams.$$equals(toParams, fromParams)) {
            locals = toLocals[keep] = state.locals;
            keep++;
            state = toPath[keep];
          }
        } else if (isString(options.reload) || isObject(options.reload)) {
          if (isObject(options.reload) && !options.reload.name) {
            throw new Error('Invalid reload state object');
          }

          var reloadState = options.reload === true ? fromPath[0] : findState(options.reload);

          if (options.reload && !reloadState) {
            throw new Error("No such reload state '" + (isString(options.reload) ? options.reload : options.reload.name) + "'");
          }

          while (state && state === fromPath[keep] && state !== reloadState) {
            locals = toLocals[keep] = state.locals;
            keep++;
            state = toPath[keep];
          }
        } // If we're going to the same state and all locals are kept, we've got nothing to do.
        // But clear 'transition', as we still want to cancel any other pending transitions.
        // TODO: We may not want to bump 'transition' if we're called from a location change
        // that we've initiated ourselves, because we might accidentally abort a legitimate
        // transition initiated from code?


        if (shouldSkipReload(to, toParams, from, fromParams, locals, options)) {
          if (hash) toParams['#'] = hash;
          $state.params = toParams;
          copy($state.params, $stateParams);
          copy(filterByKeys(to.params.$$keys(), $stateParams), to.locals.globals.$stateParams);

          if (options.location && to.navigable && to.navigable.url) {
            $urlRouter.push(to.navigable.url, toParams, {
              $$avoidResync: true,
              replace: options.location === 'replace'
            });
            $urlRouter.update(true);
          }

          $state.transition = null;
          return $q.when($state.current);
        } // Filter parameters before we pass them to event handlers etc.


        toParams = filterByKeys(to.params.$$keys(), toParams || {}); // Re-add the saved hash before we start returning things or broadcasting $stateChangeStart

        if (hash) toParams['#'] = hash; // Broadcast start event and cancel the transition if requested

        if (options.notify) {
          /**
           * @ngdoc event
           * @name ui.router.state.$state#$stateChangeStart
           * @eventOf ui.router.state.$state
           * @eventType broadcast on root scope
           * @description
           * Fired when the state transition **begins**. You can use `event.preventDefault()`
           * to prevent the transition from happening and then the transition promise will be
           * rejected with a `'transition prevented'` value.
           *
           * @param {Object} event Event object.
           * @param {State} toState The state being transitioned to.
           * @param {Object} toParams The params supplied to the `toState`.
           * @param {State} fromState The current state, pre-transition.
           * @param {Object} fromParams The params supplied to the `fromState`.
           *
           * @example
           *
           * <pre>
           * $rootScope.$on('$stateChangeStart',
           * function(event, toState, toParams, fromState, fromParams){
           *     event.preventDefault();
           *     // transitionTo() promise will be rejected with
           *     // a 'transition prevented' error
           * })
           * </pre>
           */
          if ($rootScope.$broadcast('$stateChangeStart', to.self, toParams, from.self, fromParams, options).defaultPrevented) {
            $rootScope.$broadcast('$stateChangeCancel', to.self, toParams, from.self, fromParams); //Don't update and resync url if there's been a new transition started. see issue #2238, #600

            if ($state.transition == null) $urlRouter.update();
            return TransitionPrevented;
          }
        } // Resolve locals for the remaining states, but don't update any global state just
        // yet -- if anything fails to resolve the current state needs to remain untouched.
        // We also set up an inheritance chain for the locals here. This allows the view directive
        // to quickly look up the correct definition for each view in the current state. Even
        // though we create the locals object itself outside resolveState(), it is initially
        // empty and gets filled asynchronously. We need to keep track of the promise for the
        // (fully resolved) current locals, and pass this down the chain.


        var resolved = $q.when(locals);

        for (var l = keep; l < toPath.length; l++, state = toPath[l]) {
          locals = toLocals[l] = inherit(locals);
          resolved = resolveState(state, toParams, state === to, resolved, locals, options);
        } // Once everything is resolved, we are ready to perform the actual transition
        // and return a promise for the new state. We also keep track of what the
        // current promise is, so that we can detect overlapping transitions and
        // keep only the outcome of the last transition.


        var transition = $state.transition = resolved.then(function () {
          var l, entering, exiting;

          if ($state.transition !== transition) {
            $rootScope.$broadcast('$stateChangeCancel', to.self, toParams, from.self, fromParams);
            return TransitionSuperseded;
          } // Exit 'from' states not kept


          for (l = fromPath.length - 1; l >= keep; l--) {
            exiting = fromPath[l];

            if (exiting.self.onExit) {
              $injector.invoke(exiting.self.onExit, exiting.self, exiting.locals.globals);
            }

            exiting.locals = null;
          } // Enter 'to' states not kept


          for (l = keep; l < toPath.length; l++) {
            entering = toPath[l];
            entering.locals = toLocals[l];

            if (entering.self.onEnter) {
              $injector.invoke(entering.self.onEnter, entering.self, entering.locals.globals);
            }
          } // Run it again, to catch any transitions in callbacks


          if ($state.transition !== transition) {
            $rootScope.$broadcast('$stateChangeCancel', to.self, toParams, from.self, fromParams);
            return TransitionSuperseded;
          } // Update globals in $state


          $state.$current = to;
          $state.current = to.self;
          $state.params = toParams;
          copy($state.params, $stateParams);
          $state.transition = null;

          if (options.location && to.navigable) {
            $urlRouter.push(to.navigable.url, to.navigable.locals.globals.$stateParams, {
              $$avoidResync: true,
              replace: options.location === 'replace'
            });
          }

          if (options.notify) {
            /**
             * @ngdoc event
             * @name ui.router.state.$state#$stateChangeSuccess
             * @eventOf ui.router.state.$state
             * @eventType broadcast on root scope
             * @description
             * Fired once the state transition is **complete**.
             *
             * @param {Object} event Event object.
             * @param {State} toState The state being transitioned to.
             * @param {Object} toParams The params supplied to the `toState`.
             * @param {State} fromState The current state, pre-transition.
             * @param {Object} fromParams The params supplied to the `fromState`.
             */
            $rootScope.$broadcast('$stateChangeSuccess', to.self, toParams, from.self, fromParams);
          }

          $urlRouter.update(true);
          return $state.current;
        }).then(null, function (error) {
          // propagate TransitionSuperseded error without emitting $stateChangeCancel
          // as it was already emitted in the success handler above
          if (error === TransitionSupersededError) return TransitionSuperseded;

          if ($state.transition !== transition) {
            $rootScope.$broadcast('$stateChangeCancel', to.self, toParams, from.self, fromParams);
            return TransitionSuperseded;
          }

          $state.transition = null;
          /**
           * @ngdoc event
           * @name ui.router.state.$state#$stateChangeError
           * @eventOf ui.router.state.$state
           * @eventType broadcast on root scope
           * @description
           * Fired when an **error occurs** during transition. It's important to note that if you
           * have any errors in your resolve functions (javascript errors, non-existent services, etc)
           * they will not throw traditionally. You must listen for this $stateChangeError event to
           * catch **ALL** errors.
           *
           * @param {Object} event Event object.
           * @param {State} toState The state being transitioned to.
           * @param {Object} toParams The params supplied to the `toState`.
           * @param {State} fromState The current state, pre-transition.
           * @param {Object} fromParams The params supplied to the `fromState`.
           * @param {Error} error The resolve error object.
           */

          evt = $rootScope.$broadcast('$stateChangeError', to.self, toParams, from.self, fromParams, error);

          if (!evt.defaultPrevented) {
            $urlRouter.update();
          }

          return $q.reject(error);
        });
        silenceUncaughtInPromise(transition);
        return transition;
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#is
       * @methodOf ui.router.state.$state
       *
       * @description
       * Similar to {@link ui.router.state.$state#methods_includes $state.includes},
       * but only checks for the full state name. If params is supplied then it will be
       * tested for strict equality against the current active params object, so all params
       * must match with none missing and no extras.
       *
       * @example
       * <pre>
       * $state.$current.name = 'contacts.details.item';
       *
       * // absolute name
       * $state.is('contact.details.item'); // returns true
       * $state.is(contactDetailItemStateObject); // returns true
       *
       * // relative name (. and ^), typically from a template
       * // E.g. from the 'contacts.details' template
       * <div ng-class="{highlighted: $state.is('.item')}">Item</div>
       * </pre>
       *
       * @param {string|object} stateOrName The state name (absolute or relative) or state object you'd like to check.
       * @param {object=} params A param object, e.g. `{sectionId: section.id}`, that you'd like
       * to test against the current active state.
       * @param {object=} options An options object.  The options are:
       *
       * - **`relative`** - {string|object} -  If `stateOrName` is a relative state name and `options.relative` is set, .is will
       * test relative to `options.relative` state (or name).
       *
       * @returns {boolean} Returns true if it is the state.
       */


      $state.is = function is(stateOrName, params, options) {
        options = extend({
          relative: $state.$current
        }, options || {});
        var state = findState(stateOrName, options.relative);

        if (!isDefined(state)) {
          return undefined;
        }

        if ($state.$current !== state) {
          return false;
        }

        return !params || objectKeys(params).reduce(function (acc, key) {
          var paramDef = state.params[key];
          return acc && (!paramDef || paramDef.type.equals($stateParams[key], params[key]));
        }, true);
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#includes
       * @methodOf ui.router.state.$state
       *
       * @description
       * A method to determine if the current active state is equal to or is the child of the
       * state stateName. If any params are passed then they will be tested for a match as well.
       * Not all the parameters need to be passed, just the ones you'd like to test for equality.
       *
       * @example
       * Partial and relative names
       * <pre>
       * $state.$current.name = 'contacts.details.item';
       *
       * // Using partial names
       * $state.includes("contacts"); // returns true
       * $state.includes("contacts.details"); // returns true
       * $state.includes("contacts.details.item"); // returns true
       * $state.includes("contacts.list"); // returns false
       * $state.includes("about"); // returns false
       *
       * // Using relative names (. and ^), typically from a template
       * // E.g. from the 'contacts.details' template
       * <div ng-class="{highlighted: $state.includes('.item')}">Item</div>
       * </pre>
       *
       * Basic globbing patterns
       * <pre>
       * $state.$current.name = 'contacts.details.item.url';
       *
       * $state.includes("*.details.*.*"); // returns true
       * $state.includes("*.details.**"); // returns true
       * $state.includes("**.item.**"); // returns true
       * $state.includes("*.details.item.url"); // returns true
       * $state.includes("*.details.*.url"); // returns true
       * $state.includes("*.details.*"); // returns false
       * $state.includes("item.**"); // returns false
       * </pre>
       *
       * @param {string} stateOrName A partial name, relative name, or glob pattern
       * to be searched for within the current state name.
       * @param {object=} params A param object, e.g. `{sectionId: section.id}`,
       * that you'd like to test against the current active state.
       * @param {object=} options An options object.  The options are:
       *
       * - **`relative`** - {string|object=} -  If `stateOrName` is a relative state reference and `options.relative` is set,
       * .includes will test relative to `options.relative` state (or name).
       *
       * @returns {boolean} Returns true if it does include the state
       */


      $state.includes = function includes(stateOrName, params, options) {
        options = extend({
          relative: $state.$current
        }, options || {});

        if (isString(stateOrName) && isGlob(stateOrName)) {
          if (!doesStateMatchGlob(stateOrName)) {
            return false;
          }

          stateOrName = $state.$current.name;
        }

        var state = findState(stateOrName, options.relative);

        if (!isDefined(state)) {
          return undefined;
        }

        if (!isDefined($state.$current.includes[state.name])) {
          return false;
        }

        if (!params) {
          return true;
        }

        var keys = objectKeys(params);

        for (var i = 0; i < keys.length; i++) {
          var key = keys[i],
              paramDef = state.params[key];

          if (paramDef && !paramDef.type.equals($stateParams[key], params[key])) {
            return false;
          }
        }

        return objectKeys(params).reduce(function (acc, key) {
          var paramDef = state.params[key];
          return acc && !paramDef || paramDef.type.equals($stateParams[key], params[key]);
        }, true);
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#href
       * @methodOf ui.router.state.$state
       *
       * @description
       * A url generation method that returns the compiled url for the given state populated with the given params.
       *
       * @example
       * <pre>
       * expect($state.href("about.person", { person: "bob" })).toEqual("/about/bob");
       * </pre>
       *
       * @param {string|object} stateOrName The state name or state object you'd like to generate a url from.
       * @param {object=} params An object of parameter values to fill the state's required parameters.
       * @param {object=} options Options object. The options are:
       *
       * - **`lossy`** - {boolean=true} -  If true, and if there is no url associated with the state provided in the
       *    first parameter, then the constructed href url will be built from the first navigable ancestor (aka
       *    ancestor with a valid url).
       * - **`inherit`** - {boolean=true}, If `true` will inherit url parameters from current url.
       * - **`relative`** - {object=$state.$current}, When transitioning with relative path (e.g '^'), 
       *    defines which state to be relative from.
       * - **`absolute`** - {boolean=false},  If true will generate an absolute url, e.g. "http://www.example.com/fullurl".
       * 
       * @returns {string} compiled state url
       */


      $state.href = function href(stateOrName, params, options) {
        options = extend({
          lossy: true,
          inherit: true,
          absolute: false,
          relative: $state.$current
        }, options || {});
        var state = findState(stateOrName, options.relative);
        if (!isDefined(state)) return null;
        if (options.inherit) params = inheritParams($stateParams, params || {}, $state.$current, state);
        var nav = state && options.lossy ? state.navigable : state;

        if (!nav || nav.url === undefined || nav.url === null) {
          return null;
        }

        return $urlRouter.href(nav.url, filterByKeys(state.params.$$keys().concat('#'), params || {}), {
          absolute: options.absolute
        });
      };
      /**
       * @ngdoc function
       * @name ui.router.state.$state#get
       * @methodOf ui.router.state.$state
       *
       * @description
       * Returns the state configuration object for any specific state or all states.
       *
       * @param {string|object=} stateOrName (absolute or relative) If provided, will only get the config for
       * the requested state. If not provided, returns an array of ALL state configs.
       * @param {string|object=} context When stateOrName is a relative state reference, the state will be retrieved relative to context.
       * @returns {Object|Array} State configuration object or array of all objects.
       */


      $state.get = function (stateOrName, context) {
        if (arguments.length === 0) return map(objectKeys(states), function (name) {
          return states[name].self;
        });
        var state = findState(stateOrName, context || $state.$current);
        return state && state.self ? state.self : null;
      };

      function resolveState(state, params, paramsAreFiltered, inherited, dst, options) {
        // Make a restricted $stateParams with only the parameters that apply to this state if
        // necessary. In addition to being available to the controller and onEnter/onExit callbacks,
        // we also need $stateParams to be available for any $injector calls we make during the
        // dependency resolution process.
        var $stateParams = paramsAreFiltered ? params : filterByKeys(state.params.$$keys(), params);
        var locals = {
          $stateParams: $stateParams
        }; // Resolve 'global' dependencies for the state, i.e. those not specific to a view.
        // We're also including $stateParams in this; that way the parameters are restricted
        // to the set that should be visible to the state, and are independent of when we update
        // the global $state and $stateParams values.

        dst.resolve = $resolve.resolve(state.resolve, locals, dst.resolve, state);
        var promises = [dst.resolve.then(function (globals) {
          dst.globals = globals;
        })];
        if (inherited) promises.push(inherited);

        function resolveViews() {
          var viewsPromises = []; // Resolve template and dependencies for all views.

          forEach(state.views, function (view, name) {
            var injectables = view.resolve && view.resolve !== state.resolve ? view.resolve : {};
            injectables.$template = [function () {
              return $view.load(name, {
                view: view,
                locals: dst.globals,
                params: $stateParams,
                notify: options.notify
              }) || '';
            }];
            viewsPromises.push($resolve.resolve(injectables, dst.globals, dst.resolve, state).then(function (result) {
              // References to the controller (only instantiated at link time)
              if (isFunction(view.controllerProvider) || isArray(view.controllerProvider)) {
                var injectLocals = angular.extend({}, injectables, dst.globals);
                result.$$controller = $injector.invoke(view.controllerProvider, null, injectLocals);
              } else {
                result.$$controller = view.controller;
              } // Provide access to the state itself for internal use


              result.$$state = state;
              result.$$controllerAs = view.controllerAs;
              result.$$resolveAs = view.resolveAs;
              dst[name] = result;
            }));
          });
          return $q.all(viewsPromises).then(function () {
            return dst.globals;
          });
        } // Wait for all the promises and then return the activation object


        return $q.all(promises).then(resolveViews).then(function (values) {
          return dst;
        });
      }

      return $state;
    }

    function shouldSkipReload(to, toParams, from, fromParams, locals, options) {
      // Return true if there are no differences in non-search (path/object) params, false if there are differences
      function nonSearchParamsEqual(fromAndToState, fromParams, toParams) {
        // Identify whether all the parameters that differ between `fromParams` and `toParams` were search params.
        function notSearchParam(key) {
          return fromAndToState.params[key].location != "search";
        }

        var nonQueryParamKeys = fromAndToState.params.$$keys().filter(notSearchParam);
        var nonQueryParams = pick.apply({}, [fromAndToState.params].concat(nonQueryParamKeys));
        var nonQueryParamSet = new $$UMFP.ParamSet(nonQueryParams);
        return nonQueryParamSet.$$equals(fromParams, toParams);
      } // If reload was not explicitly requested
      // and we're transitioning to the same state we're already in
      // and    the locals didn't change
      //     or they changed in a way that doesn't merit reloading
      //        (reloadOnParams:false, or reloadOnSearch.false and only search params changed)
      // Then return true.


      if (!options.reload && to === from && (locals === from.locals || to.self.reloadOnSearch === false && nonSearchParamsEqual(from, fromParams, toParams))) {
        return true;
      }
    }
  }

  angular.module('ui.router.state').factory('$stateParams', function () {
    return {};
  }).constant("$state.runtime", {
    autoinject: true
  }).provider('$state', $StateProvider) // Inject $state to initialize when entering runtime. #2574
  .run(['$injector', function ($injector) {
    // Allow tests (stateSpec.js) to turn this off by defining this constant
    if ($injector.get("$state.runtime").autoinject) {
      $injector.get('$state');
    }
  }]);
  $ViewProvider.$inject = [];

  function $ViewProvider() {
    this.$get = $get;
    /**
     * @ngdoc object
     * @name ui.router.state.$view
     *
     * @requires ui.router.util.$templateFactory
     * @requires $rootScope
     *
     * @description
     *
     */

    $get.$inject = ['$rootScope', '$templateFactory'];

    function $get($rootScope, $templateFactory) {
      return {
        // $view.load('full.viewName', { template: ..., controller: ..., resolve: ..., async: false, params: ... })

        /**
         * @ngdoc function
         * @name ui.router.state.$view#load
         * @methodOf ui.router.state.$view
         *
         * @description
         *
         * @param {string} name name
         * @param {object} options option object.
         */
        load: function load(name, options) {
          var result,
              defaults = {
            template: null,
            controller: null,
            view: null,
            locals: null,
            notify: true,
            async: true,
            params: {}
          };
          options = extend(defaults, options);

          if (options.view) {
            result = $templateFactory.fromConfig(options.view, options.params, options.locals);
          }

          return result;
        }
      };
    }
  }

  angular.module('ui.router.state').provider('$view', $ViewProvider);
  /**
   * @ngdoc object
   * @name ui.router.state.$uiViewScrollProvider
   *
   * @description
   * Provider that returns the {@link ui.router.state.$uiViewScroll} service function.
   */

  function $ViewScrollProvider() {
    var useAnchorScroll = false;
    /**
     * @ngdoc function
     * @name ui.router.state.$uiViewScrollProvider#useAnchorScroll
     * @methodOf ui.router.state.$uiViewScrollProvider
     *
     * @description
     * Reverts back to using the core [`$anchorScroll`](http://docs.angularjs.org/api/ng.$anchorScroll) service for
     * scrolling based on the url anchor.
     */

    this.useAnchorScroll = function () {
      useAnchorScroll = true;
    };
    /**
     * @ngdoc object
     * @name ui.router.state.$uiViewScroll
     *
     * @requires $anchorScroll
     * @requires $timeout
     *
     * @description
     * When called with a jqLite element, it scrolls the element into view (after a
     * `$timeout` so the DOM has time to refresh).
     *
     * If you prefer to rely on `$anchorScroll` to scroll the view to the anchor,
     * this can be enabled by calling {@link ui.router.state.$uiViewScrollProvider#methods_useAnchorScroll `$uiViewScrollProvider.useAnchorScroll()`}.
     */


    this.$get = ['$anchorScroll', '$timeout', function ($anchorScroll, $timeout) {
      if (useAnchorScroll) {
        return $anchorScroll;
      }

      return function ($element) {
        return $timeout(function () {
          $element[0].scrollIntoView();
        }, 0, false);
      };
    }];
  }

  angular.module('ui.router.state').provider('$uiViewScroll', $ViewScrollProvider);
  /**
   * @ngdoc directive
   * @name ui.router.state.directive:ui-view
   *
   * @requires ui.router.state.$state
   * @requires $compile
   * @requires $controller
   * @requires $injector
   * @requires ui.router.state.$uiViewScroll
   * @requires $document
   *
   * @restrict ECA
   *
   * @description
   * The ui-view directive tells $state where to place your templates.
   *
   * @param {string=} name A view name. The name should be unique amongst the other views in the
   * same state. You can have views of the same name that live in different states.
   *
   * @param {string=} autoscroll It allows you to set the scroll behavior of the browser window
   * when a view is populated. By default, $anchorScroll is overridden by ui-router's custom scroll
   * service, {@link ui.router.state.$uiViewScroll}. This custom service let's you
   * scroll ui-view elements into view when they are populated during a state activation.
   *
   * *Note: To revert back to old [`$anchorScroll`](http://docs.angularjs.org/api/ng.$anchorScroll)
   * functionality, call `$uiViewScrollProvider.useAnchorScroll()`.*
   *
   * @param {string=} onload Expression to evaluate whenever the view updates.
   *
   * @example
   * A view can be unnamed or named.
   * <pre>
   * <!-- Unnamed -->
   * <div ui-view></div>
   *
   * <!-- Named -->
   * <div ui-view="viewName"></div>
   * </pre>
   *
   * You can only have one unnamed view within any template (or root html). If you are only using a
   * single view and it is unnamed then you can populate it like so:
   * <pre>
   * <div ui-view></div>
   * $stateProvider.state("home", {
   *   template: "<h1>HELLO!</h1>"
   * })
   * </pre>
   *
   * The above is a convenient shortcut equivalent to specifying your view explicitly with the {@link ui.router.state.$stateProvider#methods_state `views`}
   * config property, by name, in this case an empty name:
   * <pre>
   * $stateProvider.state("home", {
   *   views: {
   *     "": {
   *       template: "<h1>HELLO!</h1>"
   *     }
   *   }    
   * })
   * </pre>
   *
   * But typically you'll only use the views property if you name your view or have more than one view
   * in the same template. There's not really a compelling reason to name a view if its the only one,
   * but you could if you wanted, like so:
   * <pre>
   * <div ui-view="main"></div>
   * </pre>
   * <pre>
   * $stateProvider.state("home", {
   *   views: {
   *     "main": {
   *       template: "<h1>HELLO!</h1>"
   *     }
   *   }    
   * })
   * </pre>
   *
   * Really though, you'll use views to set up multiple views:
   * <pre>
   * <div ui-view></div>
   * <div ui-view="chart"></div>
   * <div ui-view="data"></div>
   * </pre>
   *
   * <pre>
   * $stateProvider.state("home", {
   *   views: {
   *     "": {
   *       template: "<h1>HELLO!</h1>"
   *     },
   *     "chart": {
   *       template: "<chart_thing/>"
   *     },
   *     "data": {
   *       template: "<data_thing/>"
   *     }
   *   }    
   * })
   * </pre>
   *
   * Examples for `autoscroll`:
   *
   * <pre>
   * <!-- If autoscroll present with no expression,
   *      then scroll ui-view into view -->
   * <ui-view autoscroll/>
   *
   * <!-- If autoscroll present with valid expression,
   *      then scroll ui-view into view if expression evaluates to true -->
   * <ui-view autoscroll='true'/>
   * <ui-view autoscroll='false'/>
   * <ui-view autoscroll='scopeVariable'/>
   * </pre>
   *
   * Resolve data:
   *
   * The resolved data from the state's `resolve` block is placed on the scope as `$resolve` (this
   * can be customized using [[ViewDeclaration.resolveAs]]).  This can be then accessed from the template.
   *
   * Note that when `controllerAs` is being used, `$resolve` is set on the controller instance *after* the
   * controller is instantiated.  The `$onInit()` hook can be used to perform initialization code which
   * depends on `$resolve` data.
   *
   * Example usage of $resolve in a view template
   * <pre>
   * $stateProvider.state('home', {
   *   template: '<my-component user="$resolve.user"></my-component>',
   *   resolve: {
   *     user: function(UserService) { return UserService.fetchUser(); }
   *   }
   * });
   * </pre>
   */

  $ViewDirective.$inject = ['$state', '$injector', '$uiViewScroll', '$interpolate', '$q'];

  function $ViewDirective($state, $injector, $uiViewScroll, $interpolate, $q) {
    function getService() {
      return $injector.has ? function (service) {
        return $injector.has(service) ? $injector.get(service) : null;
      } : function (service) {
        try {
          return $injector.get(service);
        } catch (e) {
          return null;
        }
      };
    }

    var service = getService(),
        $animator = service('$animator'),
        $animate = service('$animate'); // Returns a set of DOM manipulation functions based on which Angular version
    // it should use

    function getRenderer(attrs, scope) {
      var statics = function statics() {
        return {
          enter: function enter(element, target, cb) {
            target.after(element);
            cb();
          },
          leave: function leave(element, cb) {
            element.remove();
            cb();
          }
        };
      };

      if ($animate) {
        return {
          enter: function enter(element, target, cb) {
            if (angular.version.minor > 2) {
              $animate.enter(element, null, target).then(cb);
            } else {
              $animate.enter(element, null, target, cb);
            }
          },
          leave: function leave(element, cb) {
            if (angular.version.minor > 2) {
              $animate.leave(element).then(cb);
            } else {
              $animate.leave(element, cb);
            }
          }
        };
      }

      if ($animator) {
        var animate = $animator && $animator(scope, attrs);
        return {
          enter: function enter(element, target, cb) {
            animate.enter(element, null, target);
            cb();
          },
          leave: function leave(element, cb) {
            animate.leave(element);
            cb();
          }
        };
      }

      return statics();
    }

    var directive = {
      restrict: 'ECA',
      terminal: true,
      priority: 400,
      transclude: 'element',
      compile: function compile(tElement, tAttrs, $transclude) {
        return function (scope, $element, attrs) {
          var previousEl,
              currentEl,
              currentScope,
              latestLocals,
              onloadExp = attrs.onload || '',
              autoScrollExp = attrs.autoscroll,
              renderer = getRenderer(attrs, scope),
              inherited = $element.inheritedData('$uiView');
          scope.$on('$stateChangeSuccess', function () {
            updateView(false);
          });
          updateView(true);

          function cleanupLastView() {
            if (previousEl) {
              previousEl.remove();
              previousEl = null;
            }

            if (currentScope) {
              currentScope.$destroy();
              currentScope = null;
            }

            if (currentEl) {
              var $uiViewData = currentEl.data('$uiViewAnim');
              renderer.leave(currentEl, function () {
                $uiViewData.$$animLeave.resolve();
                previousEl = null;
              });
              previousEl = currentEl;
              currentEl = null;
            }
          }

          function updateView(firstTime) {
            var newScope,
                name = getUiViewName(scope, attrs, $element, $interpolate),
                previousLocals = name && $state.$current && $state.$current.locals[name];
            if (!firstTime && previousLocals === latestLocals) return; // nothing to do

            newScope = scope.$new();
            latestLocals = $state.$current.locals[name];
            /**
             * @ngdoc event
             * @name ui.router.state.directive:ui-view#$viewContentLoading
             * @eventOf ui.router.state.directive:ui-view
             * @eventType emits on ui-view directive scope
             * @description
             *
             * Fired once the view **begins loading**, *before* the DOM is rendered.
             *
             * @param {Object} event Event object.
             * @param {string} viewName Name of the view.
             */

            newScope.$emit('$viewContentLoading', name);
            var clone = $transclude(newScope, function (clone) {
              var animEnter = $q.defer(),
                  animLeave = $q.defer();
              var viewAnimData = {
                $animEnter: animEnter.promise,
                $animLeave: animLeave.promise,
                $$animLeave: animLeave
              };
              clone.data('$uiViewAnim', viewAnimData);
              renderer.enter(clone, $element, function onUiViewEnter() {
                animEnter.resolve();

                if (currentScope) {
                  currentScope.$emit('$viewContentAnimationEnded');
                }

                if (angular.isDefined(autoScrollExp) && !autoScrollExp || scope.$eval(autoScrollExp)) {
                  $uiViewScroll(clone);
                }
              });
              cleanupLastView();
            });
            currentEl = clone;
            currentScope = newScope;
            /**
             * @ngdoc event
             * @name ui.router.state.directive:ui-view#$viewContentLoaded
             * @eventOf ui.router.state.directive:ui-view
             * @eventType emits on ui-view directive scope
             * @description
             * Fired once the view is **loaded**, *after* the DOM is rendered.
             *
             * @param {Object} event Event object.
             * @param {string} viewName Name of the view.
             */

            currentScope.$emit('$viewContentLoaded', name);
            currentScope.$eval(onloadExp);
          }
        };
      }
    };
    return directive;
  }

  $ViewDirectiveFill.$inject = ['$compile', '$controller', '$state', '$interpolate'];

  function $ViewDirectiveFill($compile, $controller, $state, $interpolate) {
    return {
      restrict: 'ECA',
      priority: -400,
      compile: function compile(tElement) {
        var initial = tElement.html();

        if (tElement.empty) {
          tElement.empty();
        } else {
          // ng 1.0.0 doesn't have empty(), which cleans up data and handlers
          tElement[0].innerHTML = null;
        }

        return function (scope, $element, attrs) {
          var current = $state.$current,
              name = getUiViewName(scope, attrs, $element, $interpolate),
              locals = current && current.locals[name];

          if (!locals) {
            $element.html(initial);
            $compile($element.contents())(scope);
            return;
          }

          $element.data('$uiView', {
            name: name,
            state: locals.$$state
          });
          $element.html(locals.$template ? locals.$template : initial);
          var resolveData = angular.extend({}, locals);
          scope[locals.$$resolveAs] = resolveData;
          var link = $compile($element.contents());

          if (locals.$$controller) {
            locals.$scope = scope;
            locals.$element = $element;
            var controller = $controller(locals.$$controller, locals);

            if (locals.$$controllerAs) {
              scope[locals.$$controllerAs] = controller;
              scope[locals.$$controllerAs][locals.$$resolveAs] = resolveData;
            }

            if (isFunction(controller.$onInit)) controller.$onInit();
            $element.data('$ngControllerController', controller);
            $element.children().data('$ngControllerController', controller);
          }

          link(scope);
        };
      }
    };
  }
  /**
   * Shared ui-view code for both directives:
   * Given scope, element, and its attributes, return the view's name
   */


  function getUiViewName(scope, attrs, element, $interpolate) {
    var name = $interpolate(attrs.uiView || attrs.name || '')(scope);
    var uiViewCreatedBy = element.inheritedData('$uiView');
    return name.indexOf('@') >= 0 ? name : name + '@' + (uiViewCreatedBy ? uiViewCreatedBy.state.name : '');
  }

  angular.module('ui.router.state').directive('uiView', $ViewDirective);
  angular.module('ui.router.state').directive('uiView', $ViewDirectiveFill);

  function parseStateRef(ref, current) {
    var preparsed = ref.match(/^\s*({[^}]*})\s*$/),
        parsed;
    if (preparsed) ref = current + '(' + preparsed[1] + ')';
    parsed = ref.replace(/\n/g, " ").match(/^([^(]+?)\s*(\((.*)\))?$/);
    if (!parsed || parsed.length !== 4) throw new Error("Invalid state ref '" + ref + "'");
    return {
      state: parsed[1],
      paramExpr: parsed[3] || null
    };
  }

  function stateContext(el) {
    var stateData = el.parent().inheritedData('$uiView');

    if (stateData && stateData.state && stateData.state.name) {
      return stateData.state;
    }
  }

  function getTypeInfo(el) {
    // SVGAElement does not use the href attribute, but rather the 'xlinkHref' attribute.
    var isSvg = Object.prototype.toString.call(el.prop('href')) === '[object SVGAnimatedString]';
    var isForm = el[0].nodeName === "FORM";
    return {
      attr: isForm ? "action" : isSvg ? 'xlink:href' : 'href',
      isAnchor: el.prop("tagName").toUpperCase() === "A",
      clickable: !isForm
    };
  }

  function clickHook(el, $state, $timeout, type, current) {
    return function (e) {
      var button = e.which || e.button,
          target = current();

      if (!(button > 1 || e.ctrlKey || e.metaKey || e.shiftKey || el.attr('target'))) {
        // HACK: This is to allow ng-clicks to be processed before the transition is initiated:
        var transition = $timeout(function () {
          $state.go(target.state, target.params, target.options);
        });
        e.preventDefault(); // if the state has no URL, ignore one preventDefault from the <a> directive.

        var ignorePreventDefaultCount = type.isAnchor && !target.href ? 1 : 0;

        e.preventDefault = function () {
          if (ignorePreventDefaultCount-- <= 0) $timeout.cancel(transition);
        };
      }
    };
  }

  function defaultOpts(el, $state) {
    return {
      relative: stateContext(el) || $state.$current,
      inherit: true
    };
  }
  /**
   * @ngdoc directive
   * @name ui.router.state.directive:ui-sref
   *
   * @requires ui.router.state.$state
   * @requires $timeout
   *
   * @restrict A
   *
   * @description
   * A directive that binds a link (`<a>` tag) to a state. If the state has an associated
   * URL, the directive will automatically generate & update the `href` attribute via
   * the {@link ui.router.state.$state#methods_href $state.href()} method. Clicking
   * the link will trigger a state transition with optional parameters.
   *
   * Also middle-clicking, right-clicking, and ctrl-clicking on the link will be
   * handled natively by the browser.
   *
   * You can also use relative state paths within ui-sref, just like the relative
   * paths passed to `$state.go()`. You just need to be aware that the path is relative
   * to the state that the link lives in, in other words the state that loaded the
   * template containing the link.
   *
   * You can specify options to pass to {@link ui.router.state.$state#methods_go $state.go()}
   * using the `ui-sref-opts` attribute. Options are restricted to `location`, `inherit`,
   * and `reload`.
   *
   * @example
   * Here's an example of how you'd use ui-sref and how it would compile. If you have the
   * following template:
   * <pre>
   * <a ui-sref="home">Home</a> | <a ui-sref="about">About</a> | <a ui-sref="{page: 2}">Next page</a>
   *
   * <ul>
   *     <li ng-repeat="contact in contacts">
   *         <a ui-sref="contacts.detail({ id: contact.id })">{{ contact.name }}</a>
   *     </li>
   * </ul>
   * </pre>
   *
   * Then the compiled html would be (assuming Html5Mode is off and current state is contacts):
   * <pre>
   * <a href="#/home" ui-sref="home">Home</a> | <a href="#/about" ui-sref="about">About</a> | <a href="#/contacts?page=2" ui-sref="{page: 2}">Next page</a>
   *
   * <ul>
   *     <li ng-repeat="contact in contacts">
   *         <a href="#/contacts/1" ui-sref="contacts.detail({ id: contact.id })">Joe</a>
   *     </li>
   *     <li ng-repeat="contact in contacts">
   *         <a href="#/contacts/2" ui-sref="contacts.detail({ id: contact.id })">Alice</a>
   *     </li>
   *     <li ng-repeat="contact in contacts">
   *         <a href="#/contacts/3" ui-sref="contacts.detail({ id: contact.id })">Bob</a>
   *     </li>
   * </ul>
   *
   * <a ui-sref="home" ui-sref-opts="{reload: true}">Home</a>
   * </pre>
   *
   * @param {string} ui-sref 'stateName' can be any valid absolute or relative state
   * @param {Object} ui-sref-opts options to pass to {@link ui.router.state.$state#methods_go $state.go()}
   */


  $StateRefDirective.$inject = ['$state', '$timeout'];

  function $StateRefDirective($state, $timeout) {
    return {
      restrict: 'A',
      require: ['?^uiSrefActive', '?^uiSrefActiveEq'],
      link: function link(scope, element, attrs, uiSrefActive) {
        var ref = parseStateRef(attrs.uiSref, $state.current.name);
        var def = {
          state: ref.state,
          href: null,
          params: null
        };
        var type = getTypeInfo(element);
        var active = uiSrefActive[1] || uiSrefActive[0];
        var unlinkInfoFn = null;
        var hookFn;
        def.options = extend(defaultOpts(element, $state), attrs.uiSrefOpts ? scope.$eval(attrs.uiSrefOpts) : {});

        var update = function update(val) {
          if (val) def.params = angular.copy(val);
          def.href = $state.href(ref.state, def.params, def.options);
          if (unlinkInfoFn) unlinkInfoFn();
          if (active) unlinkInfoFn = active.$$addStateInfo(ref.state, def.params);
          if (def.href !== null) attrs.$set(type.attr, def.href);
        };

        if (ref.paramExpr) {
          scope.$watch(ref.paramExpr, function (val) {
            if (val !== def.params) update(val);
          }, true);
          def.params = angular.copy(scope.$eval(ref.paramExpr));
        }

        update();
        if (!type.clickable) return;
        hookFn = clickHook(element, $state, $timeout, type, function () {
          return def;
        });
        element[element.on ? 'on' : 'bind']("click", hookFn);
        scope.$on('$destroy', function () {
          element[element.off ? 'off' : 'unbind']("click", hookFn);
        });
      }
    };
  }
  /**
   * @ngdoc directive
   * @name ui.router.state.directive:ui-state
   *
   * @requires ui.router.state.uiSref
   *
   * @restrict A
   *
   * @description
   * Much like ui-sref, but will accept named $scope properties to evaluate for a state definition,
   * params and override options.
   *
   * @param {string} ui-state 'stateName' can be any valid absolute or relative state
   * @param {Object} ui-state-params params to pass to {@link ui.router.state.$state#methods_href $state.href()}
   * @param {Object} ui-state-opts options to pass to {@link ui.router.state.$state#methods_go $state.go()}
   */


  $StateRefDynamicDirective.$inject = ['$state', '$timeout'];

  function $StateRefDynamicDirective($state, $timeout) {
    return {
      restrict: 'A',
      require: ['?^uiSrefActive', '?^uiSrefActiveEq'],
      link: function link(scope, element, attrs, uiSrefActive) {
        var type = getTypeInfo(element);
        var active = uiSrefActive[1] || uiSrefActive[0];
        var group = [attrs.uiState, attrs.uiStateParams || null, attrs.uiStateOpts || null];
        var watch = '[' + group.map(function (val) {
          return val || 'null';
        }).join(', ') + ']';
        var def = {
          state: null,
          params: null,
          options: null,
          href: null
        };
        var unlinkInfoFn = null;
        var hookFn;

        function runStateRefLink(group) {
          def.state = group[0];
          def.params = group[1];
          def.options = group[2];
          def.href = $state.href(def.state, def.params, def.options);
          if (unlinkInfoFn) unlinkInfoFn();
          if (active) unlinkInfoFn = active.$$addStateInfo(def.state, def.params);
          if (def.href) attrs.$set(type.attr, def.href);
        }

        scope.$watch(watch, runStateRefLink, true);
        runStateRefLink(scope.$eval(watch));
        if (!type.clickable) return;
        hookFn = clickHook(element, $state, $timeout, type, function () {
          return def;
        });
        element[element.on ? 'on' : 'bind']("click", hookFn);
        scope.$on('$destroy', function () {
          element[element.off ? 'off' : 'unbind']("click", hookFn);
        });
      }
    };
  }
  /**
   * @ngdoc directive
   * @name ui.router.state.directive:ui-sref-active
   *
   * @requires ui.router.state.$state
   * @requires ui.router.state.$stateParams
   * @requires $interpolate
   *
   * @restrict A
   *
   * @description
   * A directive working alongside ui-sref to add classes to an element when the
   * related ui-sref directive's state is active, and removing them when it is inactive.
   * The primary use-case is to simplify the special appearance of navigation menus
   * relying on `ui-sref`, by having the "active" state's menu button appear different,
   * distinguishing it from the inactive menu items.
   *
   * ui-sref-active can live on the same element as ui-sref or on a parent element. The first
   * ui-sref-active found at the same level or above the ui-sref will be used.
   *
   * Will activate when the ui-sref's target state or any child state is active. If you
   * need to activate only when the ui-sref target state is active and *not* any of
   * it's children, then you will use
   * {@link ui.router.state.directive:ui-sref-active-eq ui-sref-active-eq}
   *
   * @example
   * Given the following template:
   * <pre>
   * <ul>
   *   <li ui-sref-active="active" class="item">
   *     <a href ui-sref="app.user({user: 'bilbobaggins'})">@bilbobaggins</a>
   *   </li>
   * </ul>
   * </pre>
   *
   *
   * When the app state is "app.user" (or any children states), and contains the state parameter "user" with value "bilbobaggins",
   * the resulting HTML will appear as (note the 'active' class):
   * <pre>
   * <ul>
   *   <li ui-sref-active="active" class="item active">
   *     <a ui-sref="app.user({user: 'bilbobaggins'})" href="/users/bilbobaggins">@bilbobaggins</a>
   *   </li>
   * </ul>
   * </pre>
   *
   * The class name is interpolated **once** during the directives link time (any further changes to the
   * interpolated value are ignored).
   *
   * Multiple classes may be specified in a space-separated format:
   * <pre>
   * <ul>
   *   <li ui-sref-active='class1 class2 class3'>
   *     <a ui-sref="app.user">link</a>
   *   </li>
   * </ul>
   * </pre>
   *
   * It is also possible to pass ui-sref-active an expression that evaluates
   * to an object hash, whose keys represent active class names and whose
   * values represent the respective state names/globs.
   * ui-sref-active will match if the current active state **includes** any of
   * the specified state names/globs, even the abstract ones.
   *
   * @Example
   * Given the following template, with "admin" being an abstract state:
   * <pre>
   * <div ui-sref-active="{'active': 'admin.*'}">
   *   <a ui-sref-active="active" ui-sref="admin.roles">Roles</a>
   * </div>
   * </pre>
   *
   * When the current state is "admin.roles" the "active" class will be applied
   * to both the <div> and <a> elements. It is important to note that the state
   * names/globs passed to ui-sref-active shadow the state provided by ui-sref.
   */

  /**
   * @ngdoc directive
   * @name ui.router.state.directive:ui-sref-active-eq
   *
   * @requires ui.router.state.$state
   * @requires ui.router.state.$stateParams
   * @requires $interpolate
   *
   * @restrict A
   *
   * @description
   * The same as {@link ui.router.state.directive:ui-sref-active ui-sref-active} but will only activate
   * when the exact target state used in the `ui-sref` is active; no child states.
   *
   */


  $StateRefActiveDirective.$inject = ['$state', '$stateParams', '$interpolate'];

  function $StateRefActiveDirective($state, $stateParams, $interpolate) {
    return {
      restrict: "A",
      controller: ['$scope', '$element', '$attrs', '$timeout', function ($scope, $element, $attrs, $timeout) {
        var states = [],
            activeClasses = {},
            activeEqClass,
            uiSrefActive; // There probably isn't much point in $observing this
        // uiSrefActive and uiSrefActiveEq share the same directive object with some
        // slight difference in logic routing

        activeEqClass = $interpolate($attrs.uiSrefActiveEq || '', false)($scope);

        try {
          uiSrefActive = $scope.$eval($attrs.uiSrefActive);
        } catch (e) {// Do nothing. uiSrefActive is not a valid expression.
          // Fall back to using $interpolate below
        }

        uiSrefActive = uiSrefActive || $interpolate($attrs.uiSrefActive || '', false)($scope);

        if (isObject(uiSrefActive)) {
          forEach(uiSrefActive, function (stateOrName, activeClass) {
            if (isString(stateOrName)) {
              var ref = parseStateRef(stateOrName, $state.current.name);
              addState(ref.state, $scope.$eval(ref.paramExpr), activeClass);
            }
          });
        } // Allow uiSref to communicate with uiSrefActive[Equals]


        this.$$addStateInfo = function (newState, newParams) {
          // we already got an explicit state provided by ui-sref-active, so we
          // shadow the one that comes from ui-sref
          if (isObject(uiSrefActive) && states.length > 0) {
            return;
          }

          var deregister = addState(newState, newParams, uiSrefActive);
          update();
          return deregister;
        };

        $scope.$on('$stateChangeSuccess', update);

        function addState(stateName, stateParams, activeClass) {
          var state = $state.get(stateName, stateContext($element));
          var stateHash = createStateHash(stateName, stateParams);
          var stateInfo = {
            state: state || {
              name: stateName
            },
            params: stateParams,
            hash: stateHash
          };
          states.push(stateInfo);
          activeClasses[stateHash] = activeClass;
          return function removeState() {
            var idx = states.indexOf(stateInfo);
            if (idx !== -1) states.splice(idx, 1);
          };
        }
        /**
         * @param {string} state
         * @param {Object|string} [params]
         * @return {string}
         */


        function createStateHash(state, params) {
          if (!isString(state)) {
            throw new Error('state should be a string');
          }

          if (isObject(params)) {
            return state + toJson(params);
          }

          params = $scope.$eval(params);

          if (isObject(params)) {
            return state + toJson(params);
          }

          return state;
        } // Update route state


        function update() {
          for (var i = 0; i < states.length; i++) {
            if (anyMatch(states[i].state, states[i].params)) {
              addClass($element, activeClasses[states[i].hash]);
            } else {
              removeClass($element, activeClasses[states[i].hash]);
            }

            if (exactMatch(states[i].state, states[i].params)) {
              addClass($element, activeEqClass);
            } else {
              removeClass($element, activeEqClass);
            }
          }
        }

        function addClass(el, className) {
          $timeout(function () {
            el.addClass(className);
          });
        }

        function removeClass(el, className) {
          el.removeClass(className);
        }

        function anyMatch(state, params) {
          return $state.includes(state.name, params);
        }

        function exactMatch(state, params) {
          return $state.is(state.name, params);
        }

        update();
      }]
    };
  }

  angular.module('ui.router.state').directive('uiSref', $StateRefDirective).directive('uiSrefActive', $StateRefActiveDirective).directive('uiSrefActiveEq', $StateRefActiveDirective).directive('uiState', $StateRefDynamicDirective);
  /**
   * @ngdoc filter
   * @name ui.router.state.filter:isState
   *
   * @requires ui.router.state.$state
   *
   * @description
   * Translates to {@link ui.router.state.$state#methods_is $state.is("stateName")}.
   */

  $IsStateFilter.$inject = ['$state'];

  function $IsStateFilter($state) {
    var isFilter = function isFilter(state, params) {
      return $state.is(state, params);
    };

    isFilter.$stateful = true;
    return isFilter;
  }
  /**
   * @ngdoc filter
   * @name ui.router.state.filter:includedByState
   *
   * @requires ui.router.state.$state
   *
   * @description
   * Translates to {@link ui.router.state.$state#methods_includes $state.includes('fullOrPartialStateName')}.
   */


  $IncludedByStateFilter.$inject = ['$state'];

  function $IncludedByStateFilter($state) {
    var includesFilter = function includesFilter(state, params, options) {
      return $state.includes(state, params, options);
    };

    includesFilter.$stateful = true;
    return includesFilter;
  }

  angular.module('ui.router.state').filter('isState', $IsStateFilter).filter('includedByState', $IncludedByStateFilter);
})(window, window.angular);/*! 12.2.13 */
!function () {
  function a(a, b) {
    window.XMLHttpRequest.prototype[a] = b(window.XMLHttpRequest.prototype[a]);
  }

  function b(a, b, c) {
    try {
      Object.defineProperty(a, b, {
        get: c
      });
    } catch (d) {}
  }

  if (window.FileAPI || (window.FileAPI = {}), !window.XMLHttpRequest) throw "AJAX is not supported. XMLHttpRequest is not defined.";

  if (FileAPI.shouldLoad = !window.FormData || FileAPI.forceLoad, FileAPI.shouldLoad) {
    var c = function c(a) {
      if (!a.__listeners) {
        a.upload || (a.upload = {}), a.__listeners = [];
        var b = a.upload.addEventListener;

        a.upload.addEventListener = function (c, d) {
          a.__listeners[c] = d, b && b.apply(this, arguments);
        };
      }
    };

    a("open", function (a) {
      return function (b, d, e) {
        c(this), this.__url = d;

        try {
          a.apply(this, [b, d, e]);
        } catch (f) {
          f.message.indexOf("Access is denied") > -1 && (this.__origError = f, a.apply(this, [b, "_fix_for_ie_crossdomain__", e]));
        }
      };
    }), a("getResponseHeader", function (a) {
      return function (b) {
        return this.__fileApiXHR && this.__fileApiXHR.getResponseHeader ? this.__fileApiXHR.getResponseHeader(b) : null == a ? null : a.apply(this, [b]);
      };
    }), a("getAllResponseHeaders", function (a) {
      return function () {
        return this.__fileApiXHR && this.__fileApiXHR.getAllResponseHeaders ? this.__fileApiXHR.getAllResponseHeaders() : null == a ? null : a.apply(this);
      };
    }), a("abort", function (a) {
      return function () {
        return this.__fileApiXHR && this.__fileApiXHR.abort ? this.__fileApiXHR.abort() : null == a ? null : a.apply(this);
      };
    }), a("setRequestHeader", function (a) {
      return function (b, d) {
        if ("__setXHR_" === b) {
          c(this);
          var e = d(this);
          e instanceof Function && e(this);
        } else this.__requestHeaders = this.__requestHeaders || {}, this.__requestHeaders[b] = d, a.apply(this, arguments);
      };
    }), a("send", function (a) {
      return function () {
        var c = this;

        if (arguments[0] && arguments[0].__isFileAPIShim) {
          var d = arguments[0],
              e = {
            url: c.__url,
            jsonp: !1,
            cache: !0,
            complete: function complete(a, d) {
              a && angular.isString(a) && -1 !== a.indexOf("#2174") && (a = null), c.__completed = !0, !a && c.__listeners.load && c.__listeners.load({
                type: "load",
                loaded: c.__loaded,
                total: c.__total,
                target: c,
                lengthComputable: !0
              }), !a && c.__listeners.loadend && c.__listeners.loadend({
                type: "loadend",
                loaded: c.__loaded,
                total: c.__total,
                target: c,
                lengthComputable: !0
              }), "abort" === a && c.__listeners.abort && c.__listeners.abort({
                type: "abort",
                loaded: c.__loaded,
                total: c.__total,
                target: c,
                lengthComputable: !0
              }), void 0 !== d.status && b(c, "status", function () {
                return 0 === d.status && a && "abort" !== a ? 500 : d.status;
              }), void 0 !== d.statusText && b(c, "statusText", function () {
                return d.statusText;
              }), b(c, "readyState", function () {
                return 4;
              }), void 0 !== d.response && b(c, "response", function () {
                return d.response;
              });
              var e = d.responseText || (a && 0 === d.status && "abort" !== a ? a : void 0);
              b(c, "responseText", function () {
                return e;
              }), b(c, "response", function () {
                return e;
              }), a && b(c, "err", function () {
                return a;
              }), c.__fileApiXHR = d, c.onreadystatechange && c.onreadystatechange(), c.onload && c.onload();
            },
            progress: function progress(a) {
              if (a.target = c, c.__listeners.progress && c.__listeners.progress(a), c.__total = a.total, c.__loaded = a.loaded, a.total === a.loaded) {
                var b = this;
                setTimeout(function () {
                  c.__completed || (c.getAllResponseHeaders = function () {}, b.complete(null, {
                    status: 204,
                    statusText: "No Content"
                  }));
                }, FileAPI.noContentTimeout || 1e4);
              }
            },
            headers: c.__requestHeaders
          };
          e.data = {}, e.files = {};

          for (var f = 0; f < d.data.length; f++) {
            var g = d.data[f];
            null != g.val && null != g.val.name && null != g.val.size && null != g.val.type ? e.files[g.key] = g.val : e.data[g.key] = g.val;
          }

          setTimeout(function () {
            if (!FileAPI.hasFlash) throw 'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';
            c.__fileApiXHR = FileAPI.upload(e);
          }, 1);
        } else {
          if (this.__origError) throw this.__origError;
          a.apply(c, arguments);
        }
      };
    }), window.XMLHttpRequest.__isFileAPIShim = !0, window.FormData = FormData = function FormData() {
      return {
        append: function append(a, b, c) {
          b.__isFileAPIBlobShim && (b = b.data[0]), this.data.push({
            key: a,
            val: b,
            name: c
          });
        },
        data: [],
        __isFileAPIShim: !0
      };
    }, window.Blob = Blob = function Blob(a) {
      return {
        data: a,
        __isFileAPIBlobShim: !0
      };
    };
  }
}(), function () {
  function a(a) {
    return "input" === a[0].tagName.toLowerCase() && a.attr("type") && "file" === a.attr("type").toLowerCase();
  }

  function b() {
    try {
      var a = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
      if (a) return !0;
    } catch (b) {
      if (void 0 !== navigator.mimeTypes["application/x-shockwave-flash"]) return !0;
    }

    return !1;
  }

  function c(a) {
    var b = 0,
        c = 0;
    if (window.jQuery) return jQuery(a).offset();
    if (a.offsetParent) do {
      b += a.offsetLeft - a.scrollLeft, c += a.offsetTop - a.scrollTop, a = a.offsetParent;
    } while (a);
    return {
      left: b,
      top: c
    };
  }

  if (FileAPI.shouldLoad) {
    if (FileAPI.hasFlash = b(), FileAPI.forceLoad && (FileAPI.html5 = !1), !FileAPI.upload) {
      var d,
          e,
          f,
          g,
          h,
          i = document.createElement("script"),
          j = document.getElementsByTagName("script");
      if (window.FileAPI.jsUrl) d = window.FileAPI.jsUrl;else if (window.FileAPI.jsPath) e = window.FileAPI.jsPath;else for (f = 0; f < j.length; f++) {
        if (h = j[f].src, g = h.search(/\/ng\-file\-upload[\-a-zA-z0-9\.]*\.js/), g > -1) {
          e = h.substring(0, g + 1);
          break;
        }
      }
      null == FileAPI.staticPath && (FileAPI.staticPath = e), i.setAttribute("src", d || e + "FileAPI.min.js"), document.getElementsByTagName("head")[0].appendChild(i);
    }

    FileAPI.ngfFixIE = function (d, e, f) {
      if (!b()) throw 'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';

      var g = function g() {
        var b = e.parent();
        d.attr("disabled") ? b && b.removeClass("js-fileapi-wrapper") : (e.attr("__ngf_flash_") || (e.unbind("change"), e.unbind("click"), e.bind("change", function (a) {
          h.apply(this, [a]), f.apply(this, [a]);
        }), e.attr("__ngf_flash_", "true")), b.addClass("js-fileapi-wrapper"), a(d) || (b.css("position", "absolute").css("top", c(d[0]).top + "px").css("left", c(d[0]).left + "px").css("width", d[0].offsetWidth + "px").css("height", d[0].offsetHeight + "px").css("filter", "alpha(opacity=0)").css("display", d.css("display")).css("overflow", "hidden").css("z-index", "900000").css("visibility", "visible"), e.css("width", d[0].offsetWidth + "px").css("height", d[0].offsetHeight + "px").css("position", "absolute").css("top", "0px").css("left", "0px")));
      };

      d.bind("mouseenter", g);

      var h = function h(a) {
        for (var b = FileAPI.getFiles(a), c = 0; c < b.length; c++) {
          void 0 === b[c].size && (b[c].size = 0), void 0 === b[c].name && (b[c].name = "file"), void 0 === b[c].type && (b[c].type = "undefined");
        }

        a.target || (a.target = {}), a.target.files = b, a.target.files !== b && (a.__files_ = b), (a.__files_ || a.target.files).item = function (b) {
          return (a.__files_ || a.target.files)[b] || null;
        };
      };
    }, FileAPI.disableFileInput = function (a, b) {
      b ? a.removeClass("js-fileapi-wrapper") : a.addClass("js-fileapi-wrapper");
    };
  }
}(), window.FileReader || (window.FileReader = function () {
  var a = this,
      b = !1;
  this.listeners = {}, this.addEventListener = function (b, c) {
    a.listeners[b] = a.listeners[b] || [], a.listeners[b].push(c);
  }, this.removeEventListener = function (b, c) {
    a.listeners[b] && a.listeners[b].splice(a.listeners[b].indexOf(c), 1);
  }, this.dispatchEvent = function (b) {
    var c = a.listeners[b.type];
    if (c) for (var d = 0; d < c.length; d++) {
      c[d].call(a, b);
    }
  }, this.onabort = this.onerror = this.onload = this.onloadstart = this.onloadend = this.onprogress = null;

  var c = function c(b, _c) {
    var d = {
      type: b,
      target: a,
      loaded: _c.loaded,
      total: _c.total,
      error: _c.error
    };
    return null != _c.result && (d.target.result = _c.result), d;
  },
      d = function d(_d) {
    b || (b = !0, a.onloadstart && a.onloadstart(c("loadstart", _d)));
    var e;
    "load" === _d.type ? (a.onloadend && a.onloadend(c("loadend", _d)), e = c("load", _d), a.onload && a.onload(e), a.dispatchEvent(e)) : "progress" === _d.type ? (e = c("progress", _d), a.onprogress && a.onprogress(e), a.dispatchEvent(e)) : (e = c("error", _d), a.onerror && a.onerror(e), a.dispatchEvent(e));
  };

  this.readAsDataURL = function (a) {
    FileAPI.readAsDataURL(a, d);
  }, this.readAsText = function (a) {
    FileAPI.readAsText(a, d);
  };
});/*! 12.2.13 */
!window.XMLHttpRequest || window.FileAPI && FileAPI.shouldLoad || (window.XMLHttpRequest.prototype.setRequestHeader = function (a) {
  return function (b, c) {
    if ("__setXHR_" === b) {
      var d = c(this);
      d instanceof Function && d(this);
    } else a.apply(this, arguments);
  };
}(window.XMLHttpRequest.prototype.setRequestHeader));
var ngFileUpload = angular.module("ngFileUpload", []);
ngFileUpload.version = "12.2.13", ngFileUpload.service("UploadBase", ["$http", "$q", "$timeout", function (a, b, c) {
  function d(d) {
    function e(a) {
      j.notify && j.notify(a), k.progressFunc && c(function () {
        k.progressFunc(a);
      });
    }

    function h(a) {
      return null != d._start && g ? {
        loaded: a.loaded + d._start,
        total: d._file && d._file.size || a.total,
        type: a.type,
        config: d,
        lengthComputable: !0,
        target: a.target
      } : a;
    }

    function i() {
      a(d).then(function (a) {
        if (g && d._chunkSize && !d._finished && d._file) {
          var b = d._file && d._file.size || 0;
          e({
            loaded: Math.min(d._end, b),
            total: b,
            config: d,
            type: "progress"
          }), f.upload(d, !0);
        } else d._finished && delete d._finished, j.resolve(a);
      }, function (a) {
        j.reject(a);
      }, function (a) {
        j.notify(a);
      });
    }

    d.method = d.method || "POST", d.headers = d.headers || {};
    var j = d._deferred = d._deferred || b.defer(),
        k = j.promise;
    return d.disableProgress || (d.headers.__setXHR_ = function () {
      return function (a) {
        a && a.upload && a.upload.addEventListener && (d.__XHR = a, d.xhrFn && d.xhrFn(a), a.upload.addEventListener("progress", function (a) {
          a.config = d, e(h(a));
        }, !1), a.upload.addEventListener("load", function (a) {
          a.lengthComputable && (a.config = d, e(h(a)));
        }, !1));
      };
    }), g ? d._chunkSize && d._end && !d._finished ? (d._start = d._end, d._end += d._chunkSize, i()) : d.resumeSizeUrl ? a.get(d.resumeSizeUrl).then(function (a) {
      d._start = d.resumeSizeResponseReader ? d.resumeSizeResponseReader(a.data) : parseInt((null == a.data.size ? a.data : a.data.size).toString()), d._chunkSize && (d._end = d._start + d._chunkSize), i();
    }, function (a) {
      throw a;
    }) : d.resumeSize ? d.resumeSize().then(function (a) {
      d._start = a, d._chunkSize && (d._end = d._start + d._chunkSize), i();
    }, function (a) {
      throw a;
    }) : (d._chunkSize && (d._start = 0, d._end = d._start + d._chunkSize), i()) : i(), k.success = function (a) {
      return k.then(function (b) {
        a(b.data, b.status, b.headers, d);
      }), k;
    }, k.error = function (a) {
      return k.then(null, function (b) {
        a(b.data, b.status, b.headers, d);
      }), k;
    }, k.progress = function (a) {
      return k.progressFunc = a, k.then(null, null, function (b) {
        a(b);
      }), k;
    }, k.abort = k.pause = function () {
      return d.__XHR && c(function () {
        d.__XHR.abort();
      }), k;
    }, k.xhr = function (a) {
      return d.xhrFn = function (b) {
        return function () {
          b && b.apply(k, arguments), a.apply(k, arguments);
        };
      }(d.xhrFn), k;
    }, f.promisesCount++, k["finally"] && k["finally"] instanceof Function && k["finally"](function () {
      f.promisesCount--;
    }), k;
  }

  function e(a) {
    var b = {};

    for (var c in a) {
      a.hasOwnProperty(c) && (b[c] = a[c]);
    }

    return b;
  }

  var f = this;
  f.promisesCount = 0, this.isResumeSupported = function () {
    return window.Blob && window.Blob.prototype.slice;
  };
  var g = this.isResumeSupported();
  this.isUploadInProgress = function () {
    return f.promisesCount > 0;
  }, this.rename = function (a, b) {
    return a.ngfName = b, a;
  }, this.jsonBlob = function (a) {
    null == a || angular.isString(a) || (a = JSON.stringify(a));
    var b = new window.Blob([a], {
      type: "application/json"
    });
    return b._ngfBlob = !0, b;
  }, this.json = function (a) {
    return angular.toJson(a);
  }, this.isFile = function (a) {
    return null != a && (a instanceof window.Blob || a.flashId && a.name && a.size);
  }, this.upload = function (a, b) {
    function c(b, c) {
      if (b._ngfBlob) return b;

      if (a._file = a._file || b, null != a._start && g) {
        a._end && a._end >= b.size && (a._finished = !0, a._end = b.size);
        var d = b.slice(a._start, a._end || b.size);
        return d.name = b.name, d.ngfName = b.ngfName, a._chunkSize && (c.append("_chunkSize", a._chunkSize), c.append("_currentChunkSize", a._end - a._start), c.append("_chunkNumber", Math.floor(a._start / a._chunkSize)), c.append("_totalSize", a._file.size)), d;
      }

      return b;
    }

    function h(b, d, e) {
      if (void 0 !== d) if (angular.isDate(d) && (d = d.toISOString()), angular.isString(d)) b.append(e, d);else if (f.isFile(d)) {
        var g = c(d, b),
            i = e.split(",");
        i[1] && (g.ngfName = i[1].replace(/^\s+|\s+$/g, ""), e = i[0]), a._fileKey = a._fileKey || e, b.append(e, g, g.ngfName || g.name);
      } else if (angular.isObject(d)) {
        if (d.$$ngfCircularDetection) throw "ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: " + e;
        d.$$ngfCircularDetection = !0;

        try {
          for (var j in d) {
            if (d.hasOwnProperty(j) && "$$ngfCircularDetection" !== j) {
              var k = null == a.objectKey ? "[i]" : a.objectKey;
              d.length && parseInt(j) > -1 && (k = null == a.arrayKey ? k : a.arrayKey), h(b, d[j], e + k.replace(/[ik]/g, j));
            }
          }
        } finally {
          delete d.$$ngfCircularDetection;
        }
      } else b.append(e, d);
    }

    function i() {
      a._chunkSize = f.translateScalars(a.resumeChunkSize), a._chunkSize = a._chunkSize ? parseInt(a._chunkSize.toString()) : null, a.headers = a.headers || {}, a.headers["Content-Type"] = void 0, a.transformRequest = a.transformRequest ? angular.isArray(a.transformRequest) ? a.transformRequest : [a.transformRequest] : [], a.transformRequest.push(function (b) {
        var c,
            d = new window.FormData();
        b = b || a.fields || {}, a.file && (b.file = a.file);

        for (c in b) {
          if (b.hasOwnProperty(c)) {
            var e = b[c];
            a.formDataAppender ? a.formDataAppender(d, c, e) : h(d, e, c);
          }
        }

        return d;
      });
    }

    return b || (a = e(a)), a._isDigested || (a._isDigested = !0, i()), d(a);
  }, this.http = function (b) {
    return b = e(b), b.transformRequest = b.transformRequest || function (b) {
      return window.ArrayBuffer && b instanceof window.ArrayBuffer || b instanceof window.Blob ? b : a.defaults.transformRequest[0].apply(this, arguments);
    }, b._chunkSize = f.translateScalars(b.resumeChunkSize), b._chunkSize = b._chunkSize ? parseInt(b._chunkSize.toString()) : null, d(b);
  }, this.translateScalars = function (a) {
    if (angular.isString(a)) {
      if (a.search(/kb/i) === a.length - 2) return parseFloat(1024 * a.substring(0, a.length - 2));
      if (a.search(/mb/i) === a.length - 2) return parseFloat(1048576 * a.substring(0, a.length - 2));
      if (a.search(/gb/i) === a.length - 2) return parseFloat(1073741824 * a.substring(0, a.length - 2));
      if (a.search(/b/i) === a.length - 1) return parseFloat(a.substring(0, a.length - 1));
      if (a.search(/s/i) === a.length - 1) return parseFloat(a.substring(0, a.length - 1));
      if (a.search(/m/i) === a.length - 1) return parseFloat(60 * a.substring(0, a.length - 1));
      if (a.search(/h/i) === a.length - 1) return parseFloat(3600 * a.substring(0, a.length - 1));
    }

    return a;
  }, this.urlToBlob = function (c) {
    var d = b.defer();
    return a({
      url: c,
      method: "get",
      responseType: "arraybuffer"
    }).then(function (a) {
      var b = new Uint8Array(a.data),
          e = a.headers("content-type") || "image/WebP",
          f = new window.Blob([b], {
        type: e
      }),
          g = c.match(/.*\/(.+?)(\?.*)?$/);
      g.length > 1 && (f.name = g[1]), d.resolve(f);
    }, function (a) {
      d.reject(a);
    }), d.promise;
  }, this.setDefaults = function (a) {
    this.defaults = a || {};
  }, this.defaults = {}, this.version = ngFileUpload.version;
}]), ngFileUpload.service("Upload", ["$parse", "$timeout", "$compile", "$q", "UploadExif", function (a, b, c, d, e) {
  function f(a, b, c) {
    var e = [i.emptyPromise()];
    return angular.forEach(a, function (d, f) {
      0 === d.type.indexOf("image/jpeg") && i.attrGetter("ngfFixOrientation", b, c, {
        $file: d
      }) && e.push(i.happyPromise(i.applyExifRotation(d), d).then(function (b) {
        a.splice(f, 1, b);
      }));
    }), d.all(e);
  }

  function g(a, b, c, e) {
    var f = i.attrGetter("ngfResize", b, c);
    if (!f || !i.isResizeSupported() || !a.length) return i.emptyPromise();

    if (f instanceof Function) {
      var g = d.defer();
      return f(a).then(function (d) {
        h(d, a, b, c, e).then(function (a) {
          g.resolve(a);
        }, function (a) {
          g.reject(a);
        });
      }, function (a) {
        g.reject(a);
      });
    }

    return h(f, a, b, c, e);
  }

  function h(a, b, c, e, f) {
    function g(d, g) {
      if (0 === d.type.indexOf("image")) {
        if (a.pattern && !i.validatePattern(d, a.pattern)) return;

        a.resizeIf = function (a, b) {
          return i.attrGetter("ngfResizeIf", c, e, {
            $width: a,
            $height: b,
            $file: d
          });
        };

        var j = i.resize(d, a);
        h.push(j), j.then(function (a) {
          b.splice(g, 1, a);
        }, function (a) {
          d.$error = "resize", (d.$errorMessages = d.$errorMessages || {}).resize = !0, d.$errorParam = (a ? (a.message ? a.message : a) + ": " : "") + (d && d.name), f.$ngfValidations.push({
            name: "resize",
            valid: !1
          }), i.applyModelValidation(f, b);
        });
      }
    }

    for (var h = [i.emptyPromise()], j = 0; j < b.length; j++) {
      g(b[j], j);
    }

    return d.all(h);
  }

  var i = e;
  return i.getAttrWithDefaults = function (a, b) {
    if (null != a[b]) return a[b];
    var c = i.defaults[b];
    return null == c ? c : angular.isString(c) ? c : JSON.stringify(c);
  }, i.attrGetter = function (b, c, d, e) {
    var f = this.getAttrWithDefaults(c, b);
    if (!d) return f;

    try {
      return e ? a(f)(d, e) : a(f)(d);
    } catch (g) {
      if (b.search(/min|max|pattern/i)) return f;
      throw g;
    }
  }, i.shouldUpdateOn = function (a, b, c) {
    var d = i.attrGetter("ngfModelOptions", b, c);
    return d && d.updateOn ? d.updateOn.split(" ").indexOf(a) > -1 : !0;
  }, i.emptyPromise = function () {
    var a = d.defer(),
        c = arguments;
    return b(function () {
      a.resolve.apply(a, c);
    }), a.promise;
  }, i.rejectPromise = function () {
    var a = d.defer(),
        c = arguments;
    return b(function () {
      a.reject.apply(a, c);
    }), a.promise;
  }, i.happyPromise = function (a, c) {
    var e = d.defer();
    return a.then(function (a) {
      e.resolve(a);
    }, function (a) {
      b(function () {
        throw a;
      }), e.resolve(c);
    }), e.promise;
  }, i.updateModel = function (c, d, e, h, j, k, l) {
    function m(f, g, j, l, m) {
      d.$$ngfPrevValidFiles = f, d.$$ngfPrevInvalidFiles = g;
      var n = f && f.length ? f[0] : null,
          o = g && g.length ? g[0] : null;
      c && (i.applyModelValidation(c, f), c.$setViewValue(m ? n : f)), h && a(h)(e, {
        $files: f,
        $file: n,
        $newFiles: j,
        $duplicateFiles: l,
        $invalidFiles: g,
        $invalidFile: o,
        $event: k
      });
      var p = i.attrGetter("ngfModelInvalid", d);
      p && b(function () {
        a(p).assign(e, m ? o : g);
      }), b(function () {});
    }

    function n() {
      function a(a, b) {
        return a.name === b.name && (a.$ngfOrigSize || a.size) === (b.$ngfOrigSize || b.size) && a.type === b.type;
      }

      function b(b) {
        var c;

        for (c = 0; c < r.length; c++) {
          if (a(b, r[c])) return !0;
        }

        for (c = 0; c < s.length; c++) {
          if (a(b, s[c])) return !0;
        }

        return !1;
      }

      if (j) {
        q = [], t = [];

        for (var c = 0; c < j.length; c++) {
          b(j[c]) ? t.push(j[c]) : q.push(j[c]);
        }
      }
    }

    function o(a) {
      return angular.isArray(a) ? a : [a];
    }

    function p() {
      function a() {
        b(function () {
          m(w ? r.concat(v) : v, w ? s.concat(u) : u, j, t, x);
        }, z && z.debounce ? z.debounce.change || z.debounce : 0);
      }

      var f = y ? q : v;
      g(f, d, e, c).then(function () {
        y ? i.validate(q, w ? r.length : 0, c, d, e).then(function (b) {
          v = b.validsFiles, u = b.invalidsFiles, a();
        }) : a();
      }, function () {
        for (var b = 0; b < f.length; b++) {
          var c = f[b];

          if ("resize" === c.$error) {
            var d = v.indexOf(c);
            d > -1 && (v.splice(d, 1), u.push(c)), a();
          }
        }
      });
    }

    var q,
        r,
        s,
        t = [],
        u = [],
        v = [];
    r = d.$$ngfPrevValidFiles || [], s = d.$$ngfPrevInvalidFiles || [], c && c.$modelValue && (r = o(c.$modelValue));
    var w = i.attrGetter("ngfKeep", d, e);
    q = (j || []).slice(0), ("distinct" === w || i.attrGetter("ngfKeepDistinct", d, e) === !0) && n(d, e);
    var x = !w && !i.attrGetter("ngfMultiple", d, e) && !i.attrGetter("multiple", d);

    if (!w || q.length) {
      i.attrGetter("ngfBeforeModelChange", d, e, {
        $files: j,
        $file: j && j.length ? j[0] : null,
        $newFiles: q,
        $duplicateFiles: t,
        $event: k
      });
      var y = i.attrGetter("ngfValidateAfterResize", d, e),
          z = i.attrGetter("ngfModelOptions", d, e);
      i.validate(q, w ? r.length : 0, c, d, e).then(function (a) {
        l ? m(q, [], j, t, x) : (z && z.allowInvalid || y ? v = q : (v = a.validFiles, u = a.invalidFiles), i.attrGetter("ngfFixOrientation", d, e) && i.isExifSupported() ? f(v, d, e).then(function () {
          p();
        }) : p());
      });
    }
  }, i;
}]), ngFileUpload.directive("ngfSelect", ["$parse", "$timeout", "$compile", "Upload", function (a, b, c, d) {
  function e(a) {
    var b = a.match(/Android[^\d]*(\d+)\.(\d+)/);

    if (b && b.length > 2) {
      var c = d.defaults.androidFixMinorVersion || 4;
      return parseInt(b[1]) < 4 || parseInt(b[1]) === c && parseInt(b[2]) < c;
    }

    return -1 === a.indexOf("Chrome") && /.*Windows.*Safari.*/.test(a);
  }

  function f(a, b, c, d, f, h, i, j) {
    function k() {
      return "input" === b[0].tagName.toLowerCase() && c.type && "file" === c.type.toLowerCase();
    }

    function l() {
      return t("ngfChange") || t("ngfSelect");
    }

    function m(b) {
      if (j.shouldUpdateOn("change", c, a)) {
        var e = b.__files_ || b.target && b.target.files,
            f = [];
        if (!e) return;

        for (var g = 0; g < e.length; g++) {
          f.push(e[g]);
        }

        j.updateModel(d, c, a, l(), f.length ? f : null, b);
      }
    }

    function n(a, d) {
      function e(b) {
        a.attr("id", "ngf-" + b), d.attr("id", "ngf-label-" + b);
      }

      for (var f = 0; f < b[0].attributes.length; f++) {
        var g = b[0].attributes[f];
        "type" !== g.name && "class" !== g.name && "style" !== g.name && ("id" === g.name ? (e(g.value), u.push(c.$observe("id", e))) : a.attr(g.name, g.value || "required" !== g.name && "multiple" !== g.name ? g.value : g.name));
      }
    }

    function o() {
      if (k()) return b;
      var a = angular.element('<input type="file">'),
          c = angular.element("<label>upload</label>");
      return c.css("visibility", "hidden").css("position", "absolute").css("overflow", "hidden").css("width", "0px").css("height", "0px").css("border", "none").css("margin", "0px").css("padding", "0px").attr("tabindex", "-1"), n(a, c), g.push({
        el: b,
        ref: c
      }), document.body.appendChild(c.append(a)[0]), a;
    }

    function p(c) {
      if (b.attr("disabled")) return !1;

      if (!t("ngfSelectDisabled", a)) {
        var d = q(c);
        if (null != d) return d;
        r(c);

        try {
          k() || document.body.contains(x[0]) || (g.push({
            el: b,
            ref: x.parent()
          }), document.body.appendChild(x.parent()[0]), x.bind("change", m));
        } catch (f) {}

        return e(navigator.userAgent) ? setTimeout(function () {
          x[0].click();
        }, 0) : x[0].click(), !1;
      }
    }

    function q(a) {
      var b = a.changedTouches || a.originalEvent && a.originalEvent.changedTouches;

      if (b) {
        if ("touchstart" === a.type) return w = b[0].clientX, v = b[0].clientY, !0;

        if ("touchend" === a.type) {
          var c = b[0].clientX,
              d = b[0].clientY;
          if (Math.abs(c - w) > 20 || Math.abs(d - v) > 20) return a.stopPropagation(), a.preventDefault(), !1;
        }

        return !0;
      }
    }

    function r(b) {
      j.shouldUpdateOn("click", c, a) && x.val() && (x.val(null), j.updateModel(d, c, a, l(), null, b, !0));
    }

    function s(a) {
      if (x && !x.attr("__ngf_ie10_Fix_")) {
        if (!x[0].parentNode) return void (x = null);
        a.preventDefault(), a.stopPropagation(), x.unbind("click");
        var b = x.clone();
        return x.replaceWith(b), x = b, x.attr("__ngf_ie10_Fix_", "true"), x.bind("change", m), x.bind("click", s), x[0].click(), !1;
      }

      x.removeAttr("__ngf_ie10_Fix_");
    }

    var t = function t(a, b) {
      return j.attrGetter(a, c, b);
    };

    j.registerModelChangeValidator(d, c, a);
    var u = [];
    t("ngfMultiple") && u.push(a.$watch(t("ngfMultiple"), function () {
      x.attr("multiple", t("ngfMultiple", a));
    })), t("ngfCapture") && u.push(a.$watch(t("ngfCapture"), function () {
      x.attr("capture", t("ngfCapture", a));
    })), t("ngfAccept") && u.push(a.$watch(t("ngfAccept"), function () {
      x.attr("accept", t("ngfAccept", a));
    })), u.push(c.$observe("accept", function () {
      x.attr("accept", t("accept"));
    }));
    var v = 0,
        w = 0,
        x = b;
    k() || (x = o()), x.bind("change", m), k() ? b.bind("click", r) : b.bind("click touchstart touchend", p), -1 !== navigator.appVersion.indexOf("MSIE 10") && x.bind("click", s), d && d.$formatters.push(function (a) {
      return (null == a || 0 === a.length) && x.val() && x.val(null), a;
    }), a.$on("$destroy", function () {
      k() || x.parent().remove(), angular.forEach(u, function (a) {
        a();
      });
    }), h(function () {
      for (var a = 0; a < g.length; a++) {
        var b = g[a];
        document.body.contains(b.el[0]) || (g.splice(a, 1), b.ref.remove());
      }
    }), window.FileAPI && window.FileAPI.ngfFixIE && window.FileAPI.ngfFixIE(b, x, m);
  }

  var g = [];
  return {
    restrict: "AEC",
    require: "?ngModel",
    link: function link(e, g, h, i) {
      f(e, g, h, i, a, b, c, d);
    }
  };
}]), function () {
  function a(a) {
    return "img" === a.tagName.toLowerCase() ? "image" : "audio" === a.tagName.toLowerCase() ? "audio" : "video" === a.tagName.toLowerCase() ? "video" : /./;
  }

  function b(b, c, d, e, f, g, h, i) {
    function j(a) {
      var g = b.attrGetter("ngfNoObjectUrl", f, d);
      b.dataUrl(a, g)["finally"](function () {
        c(function () {
          var b = (g ? a.$ngfDataUrl : a.$ngfBlobUrl) || a.$ngfDataUrl;
          i ? e.css("background-image", "url('" + (b || "") + "')") : e.attr("src", b), b ? e.removeClass("ng-hide") : e.addClass("ng-hide");
        });
      });
    }

    c(function () {
      var c = d.$watch(f[g], function (c) {
        var k = h;

        if ("ngfThumbnail" === g && (k || (k = {
          width: e[0].naturalWidth || e[0].clientWidth,
          height: e[0].naturalHeight || e[0].clientHeight
        }), 0 === k.width && window.getComputedStyle)) {
          var l = getComputedStyle(e[0]);
          l.width && l.width.indexOf("px") > -1 && l.height && l.height.indexOf("px") > -1 && (k = {
            width: parseInt(l.width.slice(0, -2)),
            height: parseInt(l.height.slice(0, -2))
          });
        }

        return angular.isString(c) ? (e.removeClass("ng-hide"), i ? e.css("background-image", "url('" + c + "')") : e.attr("src", c)) : void (!c || !c.type || 0 !== c.type.search(a(e[0])) || i && 0 !== c.type.indexOf("image") ? e.addClass("ng-hide") : k && b.isResizeSupported() ? (k.resizeIf = function (a, e) {
          return b.attrGetter("ngfResizeIf", f, d, {
            $width: a,
            $height: e,
            $file: c
          });
        }, b.resize(c, k).then(function (a) {
          j(a);
        }, function (a) {
          throw a;
        })) : j(c));
      });
      d.$on("$destroy", function () {
        c();
      });
    });
  }

  ngFileUpload.service("UploadDataUrl", ["UploadBase", "$timeout", "$q", function (a, b, c) {
    var d = a;
    return d.base64DataUrl = function (a) {
      if (angular.isArray(a)) {
        var b = c.defer(),
            e = 0;
        return angular.forEach(a, function (c) {
          d.dataUrl(c, !0)["finally"](function () {
            if (e++, e === a.length) {
              var c = [];
              angular.forEach(a, function (a) {
                c.push(a.$ngfDataUrl);
              }), b.resolve(c, a);
            }
          });
        }), b.promise;
      }

      return d.dataUrl(a, !0);
    }, d.dataUrl = function (a, e) {
      if (!a) return d.emptyPromise(a, a);
      if (e && null != a.$ngfDataUrl || !e && null != a.$ngfBlobUrl) return d.emptyPromise(e ? a.$ngfDataUrl : a.$ngfBlobUrl, a);
      var f = e ? a.$$ngfDataUrlPromise : a.$$ngfBlobUrlPromise;
      if (f) return f;
      var g = c.defer();
      return b(function () {
        if (window.FileReader && a && (!window.FileAPI || -1 === navigator.userAgent.indexOf("MSIE 8") || a.size < 2e4) && (!window.FileAPI || -1 === navigator.userAgent.indexOf("MSIE 9") || a.size < 4e6)) {
          var c = window.URL || window.webkitURL;

          if (c && c.createObjectURL && !e) {
            var f;

            try {
              f = c.createObjectURL(a);
            } catch (h) {
              return void b(function () {
                a.$ngfBlobUrl = "", g.reject();
              });
            }

            b(function () {
              if (a.$ngfBlobUrl = f, f) {
                g.resolve(f, a), d.blobUrls = d.blobUrls || [], d.blobUrlsTotalSize = d.blobUrlsTotalSize || 0, d.blobUrls.push({
                  url: f,
                  size: a.size
                }), d.blobUrlsTotalSize += a.size || 0;

                for (var b = d.defaults.blobUrlsMaxMemory || 268435456, e = d.defaults.blobUrlsMaxQueueSize || 200; (d.blobUrlsTotalSize > b || d.blobUrls.length > e) && d.blobUrls.length > 1;) {
                  var h = d.blobUrls.splice(0, 1)[0];
                  c.revokeObjectURL(h.url), d.blobUrlsTotalSize -= h.size;
                }
              }
            });
          } else {
            var i = new FileReader();
            i.onload = function (c) {
              b(function () {
                a.$ngfDataUrl = c.target.result, g.resolve(c.target.result, a), b(function () {
                  delete a.$ngfDataUrl;
                }, 1e3);
              });
            }, i.onerror = function () {
              b(function () {
                a.$ngfDataUrl = "", g.reject();
              });
            }, i.readAsDataURL(a);
          }
        } else b(function () {
          a[e ? "$ngfDataUrl" : "$ngfBlobUrl"] = "", g.reject();
        });
      }), f = e ? a.$$ngfDataUrlPromise = g.promise : a.$$ngfBlobUrlPromise = g.promise, f["finally"](function () {
        delete a[e ? "$$ngfDataUrlPromise" : "$$ngfBlobUrlPromise"];
      }), f;
    }, d;
  }]), ngFileUpload.directive("ngfSrc", ["Upload", "$timeout", function (a, c) {
    return {
      restrict: "AE",
      link: function link(d, e, f) {
        b(a, c, d, e, f, "ngfSrc", a.attrGetter("ngfResize", f, d), !1);
      }
    };
  }]), ngFileUpload.directive("ngfBackground", ["Upload", "$timeout", function (a, c) {
    return {
      restrict: "AE",
      link: function link(d, e, f) {
        b(a, c, d, e, f, "ngfBackground", a.attrGetter("ngfResize", f, d), !0);
      }
    };
  }]), ngFileUpload.directive("ngfThumbnail", ["Upload", "$timeout", function (a, c) {
    return {
      restrict: "AE",
      link: function link(d, e, f) {
        var g = a.attrGetter("ngfSize", f, d);
        b(a, c, d, e, f, "ngfThumbnail", g, a.attrGetter("ngfAsBackground", f, d));
      }
    };
  }]), ngFileUpload.config(["$compileProvider", function (a) {
    a.imgSrcSanitizationWhitelist && a.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/), a.aHrefSanitizationWhitelist && a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/);
  }]), ngFileUpload.filter("ngfDataUrl", ["UploadDataUrl", "$sce", function (a, b) {
    return function (c, d, e) {
      if (angular.isString(c)) return b.trustAsResourceUrl(c);
      var f = c && ((d ? c.$ngfDataUrl : c.$ngfBlobUrl) || c.$ngfDataUrl);
      return c && !f ? (!c.$ngfDataUrlFilterInProgress && angular.isObject(c) && (c.$ngfDataUrlFilterInProgress = !0, a.dataUrl(c, d)), "") : (c && delete c.$ngfDataUrlFilterInProgress, (c && f ? e ? b.trustAsResourceUrl(f) : f : c) || "");
    };
  }]);
}(), ngFileUpload.service("UploadValidate", ["UploadDataUrl", "$q", "$timeout", function (a, b, c) {
  function d(a) {
    var b = "",
        c = [];
    if (a.length > 2 && "/" === a[0] && "/" === a[a.length - 1]) b = a.substring(1, a.length - 1);else {
      var e = a.split(",");
      if (e.length > 1) for (var f = 0; f < e.length; f++) {
        var g = d(e[f]);
        g.regexp ? (b += "(" + g.regexp + ")", f < e.length - 1 && (b += "|")) : c = c.concat(g.excludes);
      } else 0 === a.indexOf("!") ? c.push("^((?!" + d(a.substring(1)).regexp + ").)*$") : (0 === a.indexOf(".") && (a = "*" + a), b = "^" + a.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]", "g"), "\\$&") + "$", b = b.replace(/\\\*/g, ".*").replace(/\\\?/g, "."));
    }
    return {
      regexp: b,
      excludes: c
    };
  }

  function e(a, b) {
    null == b || a.$dirty || (a.$setDirty ? a.$setDirty() : a.$dirty = !0);
  }

  var f = a;
  return f.validatePattern = function (a, b) {
    if (!b) return !0;
    var c = d(b),
        e = !0;

    if (c.regexp && c.regexp.length) {
      var f = new RegExp(c.regexp, "i");
      e = null != a.type && f.test(a.type) || null != a.name && f.test(a.name);
    }

    for (var g = c.excludes.length; g--;) {
      var h = new RegExp(c.excludes[g], "i");
      e = e && (null == a.type || h.test(a.type)) && (null == a.name || h.test(a.name));
    }

    return e;
  }, f.ratioToFloat = function (a) {
    var b = a.toString(),
        c = b.search(/[x:]/i);
    return b = c > -1 ? parseFloat(b.substring(0, c)) / parseFloat(b.substring(c + 1)) : parseFloat(b);
  }, f.registerModelChangeValidator = function (a, b, c) {
    a && a.$formatters.push(function (d) {
      if (a.$dirty) {
        var e = d;
        d && !angular.isArray(d) && (e = [d]), f.validate(e, 0, a, b, c).then(function () {
          f.applyModelValidation(a, e);
        });
      }

      return d;
    });
  }, f.applyModelValidation = function (a, b) {
    e(a, b), angular.forEach(a.$ngfValidations, function (b) {
      a.$setValidity(b.name, b.valid);
    });
  }, f.getValidationAttr = function (a, b, c, d, e) {
    var g = "ngf" + c[0].toUpperCase() + c.substr(1),
        h = f.attrGetter(g, a, b, {
      $file: e
    });

    if (null == h && (h = f.attrGetter("ngfValidate", a, b, {
      $file: e
    }))) {
      var i = (d || c).split(".");
      h = h[i[0]], i.length > 1 && (h = h && h[i[1]]);
    }

    return h;
  }, f.validate = function (a, c, d, e, g) {
    function h(b, c, h) {
      if (a) {
        for (var i = a.length, j = null; i--;) {
          var n = a[i];

          if (n) {
            var o = f.getValidationAttr(e, g, b, c, n);
            null != o && (h(n, o, i) || (-1 === k.indexOf(b) ? (n.$error = b, (n.$errorMessages = n.$errorMessages || {})[b] = !0, n.$errorParam = o, -1 === m.indexOf(n) && m.push(n), l || a.splice(i, 1), j = !1) : a.splice(i, 1)));
          }
        }

        null !== j && d.$ngfValidations.push({
          name: b,
          valid: j
        });
      }
    }

    function i(c, h, i, n, o) {
      function p(b, d, e) {
        function f(f) {
          if (f()) {
            if (-1 === k.indexOf(c)) {
              if (d.$error = c, (d.$errorMessages = d.$errorMessages || {})[c] = !0, d.$errorParam = e, -1 === m.indexOf(d) && m.push(d), !l) {
                var g = a.indexOf(d);
                g > -1 && a.splice(g, 1);
              }

              b.resolve(!1);
            } else {
              var h = a.indexOf(d);
              h > -1 && a.splice(h, 1), b.resolve(!0);
            }
          } else b.resolve(!0);
        }

        null != e ? n(d, e).then(function (a) {
          f(function () {
            return !o(a, e);
          });
        }, function () {
          f(function () {
            return j("ngfValidateForce", {
              $file: d
            });
          });
        }) : b.resolve(!0);
      }

      var q = [f.emptyPromise(!0)];
      a && (a = void 0 === a.length ? [a] : a, angular.forEach(a, function (a) {
        var d = b.defer();
        return q.push(d.promise), !i || null != a.type && 0 === a.type.search(i) ? void ("dimensions" === c && null != f.attrGetter("ngfDimensions", e) ? f.imageDimensions(a).then(function (b) {
          p(d, a, j("ngfDimensions", {
            $file: a,
            $width: b.width,
            $height: b.height
          }));
        }, function () {
          d.resolve(!1);
        }) : "duration" === c && null != f.attrGetter("ngfDuration", e) ? f.mediaDuration(a).then(function (b) {
          p(d, a, j("ngfDuration", {
            $file: a,
            $duration: b
          }));
        }, function () {
          d.resolve(!1);
        }) : p(d, a, f.getValidationAttr(e, g, c, h, a))) : void d.resolve(!0);
      }));
      var r = b.defer();
      return b.all(q).then(function (a) {
        for (var b = !0, e = 0; e < a.length; e++) {
          if (!a[e]) {
            b = !1;
            break;
          }
        }

        d.$ngfValidations.push({
          name: c,
          valid: b
        }), r.resolve(b);
      }), r.promise;
    }

    d = d || {}, d.$ngfValidations = d.$ngfValidations || [], angular.forEach(d.$ngfValidations, function (a) {
      a.valid = !0;
    });

    var j = function j(a, b) {
      return f.attrGetter(a, e, g, b);
    },
        k = (f.attrGetter("ngfIgnoreInvalid", e, g) || "").split(" "),
        l = f.attrGetter("ngfRunAllValidations", e, g);

    if (null == a || 0 === a.length) return f.emptyPromise({
      validFiles: a,
      invalidFiles: []
    });
    a = void 0 === a.length ? [a] : a.slice(0);
    var m = [];
    h("pattern", null, f.validatePattern), h("minSize", "size.min", function (a, b) {
      return a.size + .1 >= f.translateScalars(b);
    }), h("maxSize", "size.max", function (a, b) {
      return a.size - .1 <= f.translateScalars(b);
    });
    var n = 0;
    if (h("maxTotalSize", null, function (b, c) {
      return n += b.size, n > f.translateScalars(c) ? (a.splice(0, a.length), !1) : !0;
    }), h("validateFn", null, function (a, b) {
      return b === !0 || null === b || "" === b;
    }), !a.length) return f.emptyPromise({
      validFiles: [],
      invalidFiles: m
    });
    var o = b.defer(),
        p = [];
    return p.push(i("maxHeight", "height.max", /image/, this.imageDimensions, function (a, b) {
      return a.height <= b;
    })), p.push(i("minHeight", "height.min", /image/, this.imageDimensions, function (a, b) {
      return a.height >= b;
    })), p.push(i("maxWidth", "width.max", /image/, this.imageDimensions, function (a, b) {
      return a.width <= b;
    })), p.push(i("minWidth", "width.min", /image/, this.imageDimensions, function (a, b) {
      return a.width >= b;
    })), p.push(i("dimensions", null, /image/, function (a, b) {
      return f.emptyPromise(b);
    }, function (a) {
      return a;
    })), p.push(i("ratio", null, /image/, this.imageDimensions, function (a, b) {
      for (var c = b.toString().split(","), d = !1, e = 0; e < c.length; e++) {
        Math.abs(a.width / a.height - f.ratioToFloat(c[e])) < .01 && (d = !0);
      }

      return d;
    })), p.push(i("maxRatio", "ratio.max", /image/, this.imageDimensions, function (a, b) {
      return a.width / a.height - f.ratioToFloat(b) < 1e-4;
    })), p.push(i("minRatio", "ratio.min", /image/, this.imageDimensions, function (a, b) {
      return a.width / a.height - f.ratioToFloat(b) > -1e-4;
    })), p.push(i("maxDuration", "duration.max", /audio|video/, this.mediaDuration, function (a, b) {
      return a <= f.translateScalars(b);
    })), p.push(i("minDuration", "duration.min", /audio|video/, this.mediaDuration, function (a, b) {
      return a >= f.translateScalars(b);
    })), p.push(i("duration", null, /audio|video/, function (a, b) {
      return f.emptyPromise(b);
    }, function (a) {
      return a;
    })), p.push(i("validateAsyncFn", null, null, function (a, b) {
      return b;
    }, function (a) {
      return a === !0 || null === a || "" === a;
    })), b.all(p).then(function () {
      if (l) for (var b = 0; b < a.length; b++) {
        var d = a[b];
        d.$error && a.splice(b--, 1);
      }
      l = !1, h("maxFiles", null, function (a, b, d) {
        return b > c + d;
      }), o.resolve({
        validFiles: a,
        invalidFiles: m
      });
    }), o.promise;
  }, f.imageDimensions = function (a) {
    if (a.$ngfWidth && a.$ngfHeight) {
      var d = b.defer();
      return c(function () {
        d.resolve({
          width: a.$ngfWidth,
          height: a.$ngfHeight
        });
      }), d.promise;
    }

    if (a.$ngfDimensionPromise) return a.$ngfDimensionPromise;
    var e = b.defer();
    return c(function () {
      return 0 !== a.type.indexOf("image") ? void e.reject("not image") : void f.dataUrl(a).then(function (b) {
        function d() {
          var b = h[0].naturalWidth || h[0].clientWidth,
              c = h[0].naturalHeight || h[0].clientHeight;
          h.remove(), a.$ngfWidth = b, a.$ngfHeight = c, e.resolve({
            width: b,
            height: c
          });
        }

        function f() {
          h.remove(), e.reject("load error");
        }

        function g() {
          c(function () {
            h[0].parentNode && (h[0].clientWidth ? d() : i++ > 10 ? f() : g());
          }, 1e3);
        }

        var h = angular.element("<img>").attr("src", b).css("visibility", "hidden").css("position", "fixed").css("max-width", "none !important").css("max-height", "none !important");
        h.on("load", d), h.on("error", f);
        var i = 0;
        g(), angular.element(document.getElementsByTagName("body")[0]).append(h);
      }, function () {
        e.reject("load error");
      });
    }), a.$ngfDimensionPromise = e.promise, a.$ngfDimensionPromise["finally"](function () {
      delete a.$ngfDimensionPromise;
    }), a.$ngfDimensionPromise;
  }, f.mediaDuration = function (a) {
    if (a.$ngfDuration) {
      var d = b.defer();
      return c(function () {
        d.resolve(a.$ngfDuration);
      }), d.promise;
    }

    if (a.$ngfDurationPromise) return a.$ngfDurationPromise;
    var e = b.defer();
    return c(function () {
      return 0 !== a.type.indexOf("audio") && 0 !== a.type.indexOf("video") ? void e.reject("not media") : void f.dataUrl(a).then(function (b) {
        function d() {
          var b = h[0].duration;
          a.$ngfDuration = b, h.remove(), e.resolve(b);
        }

        function f() {
          h.remove(), e.reject("load error");
        }

        function g() {
          c(function () {
            h[0].parentNode && (h[0].duration ? d() : i > 10 ? f() : g());
          }, 1e3);
        }

        var h = angular.element(0 === a.type.indexOf("audio") ? "<audio>" : "<video>").attr("src", b).css("visibility", "none").css("position", "fixed");
        h.on("loadedmetadata", d), h.on("error", f);
        var i = 0;
        g(), angular.element(document.body).append(h);
      }, function () {
        e.reject("load error");
      });
    }), a.$ngfDurationPromise = e.promise, a.$ngfDurationPromise["finally"](function () {
      delete a.$ngfDurationPromise;
    }), a.$ngfDurationPromise;
  }, f;
}]), ngFileUpload.service("UploadResize", ["UploadValidate", "$q", function (a, b) {
  var c = a,
      d = function d(a, b, c, _d, e) {
    var f = e ? Math.max(c / a, _d / b) : Math.min(c / a, _d / b);
    return {
      width: a * f,
      height: b * f,
      marginX: a * f - c,
      marginY: b * f - _d
    };
  },
      e = function e(a, _e, f, g, h, i, j, k) {
    var l = b.defer(),
        m = document.createElement("canvas"),
        n = document.createElement("img");
    return n.setAttribute("style", "visibility:hidden;position:fixed;z-index:-100000"), document.body.appendChild(n), n.onload = function () {
      var a = n.width,
          b = n.height;
      if (n.parentNode.removeChild(n), null != k && k(a, b) === !1) return void l.reject("resizeIf");

      try {
        if (i) {
          var o = c.ratioToFloat(i),
              p = a / b;
          o > p ? (_e = a, f = _e / o) : (f = b, _e = f * o);
        }

        _e || (_e = a), f || (f = b);
        var q = d(a, b, _e, f, j);
        m.width = Math.min(q.width, _e), m.height = Math.min(q.height, f);
        var r = m.getContext("2d");
        r.drawImage(n, Math.min(0, -q.marginX / 2), Math.min(0, -q.marginY / 2), q.width, q.height), l.resolve(m.toDataURL(h || "image/WebP", g || .934));
      } catch (s) {
        l.reject(s);
      }
    }, n.onerror = function () {
      n.parentNode.removeChild(n), l.reject();
    }, n.src = a, l.promise;
  };

  return c.dataUrltoBlob = function (a, b, c) {
    for (var d = a.split(","), e = d[0].match(/:(.*?);/)[1], f = atob(d[1]), g = f.length, h = new Uint8Array(g); g--;) {
      h[g] = f.charCodeAt(g);
    }

    var i = new window.Blob([h], {
      type: e
    });
    return i.name = b, i.$ngfOrigSize = c, i;
  }, c.isResizeSupported = function () {
    var a = document.createElement("canvas");
    return window.atob && a.getContext && a.getContext("2d") && window.Blob;
  }, c.isResizeSupported() && Object.defineProperty(window.Blob.prototype, "name", {
    get: function get() {
      return this.$ngfName;
    },
    set: function set(a) {
      this.$ngfName = a;
    },
    configurable: !0
  }), c.resize = function (a, d) {
    if (0 !== a.type.indexOf("image")) return c.emptyPromise(a);
    var f = b.defer();
    return c.dataUrl(a, !0).then(function (b) {
      e(b, d.width, d.height, d.quality, d.type || a.type, d.ratio, d.centerCrop, d.resizeIf).then(function (e) {
        if ("image/jpeg" === a.type && d.restoreExif !== !1) try {
          e = c.restoreExif(b, e);
        } catch (g) {
          setTimeout(function () {
            throw g;
          }, 1);
        }

        try {
          var h = c.dataUrltoBlob(e, a.name, a.size);
          f.resolve(h);
        } catch (g) {
          f.reject(g);
        }
      }, function (b) {
        "resizeIf" === b && f.resolve(a), f.reject(b);
      });
    }, function (a) {
      f.reject(a);
    }), f.promise;
  }, c;
}]), function () {
  function a(a, c, d, e, f, g, h, i, j, k) {
    function l() {
      return c.attr("disabled") || s("ngfDropDisabled", a);
    }

    function m(b, c, d) {
      if (b) {
        var e;

        try {
          e = b && b.getData && b.getData("text/html");
        } catch (f) {}

        q(b.items, b.files, s("ngfAllowDir", a) !== !1, s("multiple") || s("ngfMultiple", a)).then(function (a) {
          a.length ? n(a, c) : o(d, e).then(function (a) {
            n(a, c);
          });
        });
      }
    }

    function n(b, c) {
      i.updateModel(e, d, a, s("ngfChange") || s("ngfDrop"), b, c);
    }

    function o(b, c) {
      if (!i.shouldUpdateOn(b, d, a) || "string" != typeof c) return i.rejectPromise([]);
      var e = [];
      c.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi, function (a, b, c) {
        e.push(c);
      });
      var f = [],
          g = [];

      if (e.length) {
        angular.forEach(e, function (a) {
          f.push(i.urlToBlob(a).then(function (a) {
            g.push(a);
          }));
        });
        var h = k.defer();
        return k.all(f).then(function () {
          h.resolve(g);
        }, function (a) {
          h.reject(a);
        }), h.promise;
      }

      return i.emptyPromise();
    }

    function p(a, b, c, d) {
      var e = s("ngfDragOverClass", a, {
        $event: c
      }),
          f = "dragover";
      if (angular.isString(e)) f = e;else if (e && (e.delay && (w = e.delay), e.accept || e.reject)) {
        var g = c.dataTransfer.items;
        if (null != g && g.length) for (var h = e.pattern || s("ngfPattern", a, {
          $event: c
        }), j = g.length; j--;) {
          if (!i.validatePattern(g[j], h)) {
            f = e.reject;
            break;
          }

          f = e.accept;
        } else f = e.accept;
      }
      d(f);
    }

    function q(b, c, e, f) {
      function g(a, b) {
        var c = k.defer();
        if (null != a) if (a.isDirectory) {
          var d = [i.emptyPromise()];

          if (m) {
            var e = {
              type: "directory"
            };
            e.name = e.path = (b || "") + a.name, n.push(e);
          }

          var f = a.createReader(),
              h = [],
              p = function p() {
            f.readEntries(function (e) {
              try {
                e.length ? (h = h.concat(Array.prototype.slice.call(e || [], 0)), p()) : (angular.forEach(h.slice(0), function (c) {
                  n.length <= j && l >= o && d.push(g(c, (b ? b : "") + a.name + "/"));
                }), k.all(d).then(function () {
                  c.resolve();
                }, function (a) {
                  c.reject(a);
                }));
              } catch (f) {
                c.reject(f);
              }
            }, function (a) {
              c.reject(a);
            });
          };

          p();
        } else a.file(function (a) {
          try {
            a.path = (b ? b : "") + a.name, m && (a = i.rename(a, a.path)), n.push(a), o += a.size, c.resolve();
          } catch (d) {
            c.reject(d);
          }
        }, function (a) {
          c.reject(a);
        });
        return c.promise;
      }

      var j = i.getValidationAttr(d, a, "maxFiles");
      null == j && (j = Number.MAX_VALUE);
      var l = i.getValidationAttr(d, a, "maxTotalSize");
      null == l && (l = Number.MAX_VALUE);
      var m = s("ngfIncludeDir", a),
          n = [],
          o = 0,
          p = [i.emptyPromise()];
      if (b && b.length > 0 && "file:" !== h.location.protocol) for (var q = 0; q < b.length; q++) {
        if (b[q].webkitGetAsEntry && b[q].webkitGetAsEntry() && b[q].webkitGetAsEntry().isDirectory) {
          var r = b[q].webkitGetAsEntry();
          if (r.isDirectory && !e) continue;
          null != r && p.push(g(r));
        } else {
          var t = b[q].getAsFile();
          null != t && (n.push(t), o += t.size);
        }

        if (n.length > j || o > l || !f && n.length > 0) break;
      } else if (null != c) for (var u = 0; u < c.length; u++) {
        var v = c.item(u);
        if ((v.type || v.size > 0) && (n.push(v), o += v.size), n.length > j || o > l || !f && n.length > 0) break;
      }
      var w = k.defer();
      return k.all(p).then(function () {
        if (f || m || !n.length) w.resolve(n);else {
          for (var a = 0; n[a] && "directory" === n[a].type;) {
            a++;
          }

          w.resolve([n[a]]);
        }
      }, function (a) {
        w.reject(a);
      }), w.promise;
    }

    var r = b(),
        s = function s(a, b, c) {
      return i.attrGetter(a, d, b, c);
    };

    if (s("dropAvailable") && g(function () {
      a[s("dropAvailable")] ? a[s("dropAvailable")].value = r : a[s("dropAvailable")] = r;
    }), !r) return void (s("ngfHideOnDropNotAvailable", a) === !0 && c.css("display", "none"));
    null == s("ngfSelect") && i.registerModelChangeValidator(e, d, a);
    var t,
        u = null,
        v = f(s("ngfStopPropagation")),
        w = 1;
    c[0].addEventListener("dragover", function (b) {
      if (!l() && i.shouldUpdateOn("drop", d, a)) {
        if (b.preventDefault(), v(a) && b.stopPropagation(), navigator.userAgent.indexOf("Chrome") > -1) {
          var e = b.dataTransfer.effectAllowed;
          b.dataTransfer.dropEffect = "move" === e || "linkMove" === e ? "move" : "copy";
        }

        g.cancel(u), t || (t = "C", p(a, d, b, function (d) {
          t = d, c.addClass(t), s("ngfDrag", a, {
            $isDragging: !0,
            $class: t,
            $event: b
          });
        }));
      }
    }, !1), c[0].addEventListener("dragenter", function (b) {
      !l() && i.shouldUpdateOn("drop", d, a) && (b.preventDefault(), v(a) && b.stopPropagation());
    }, !1), c[0].addEventListener("dragleave", function (b) {
      !l() && i.shouldUpdateOn("drop", d, a) && (b.preventDefault(), v(a) && b.stopPropagation(), u = g(function () {
        t && c.removeClass(t), t = null, s("ngfDrag", a, {
          $isDragging: !1,
          $event: b
        });
      }, w || 100));
    }, !1), c[0].addEventListener("drop", function (b) {
      !l() && i.shouldUpdateOn("drop", d, a) && (b.preventDefault(), v(a) && b.stopPropagation(), t && c.removeClass(t), t = null, m(b.dataTransfer, b, "dropUrl"));
    }, !1), c[0].addEventListener("paste", function (b) {
      navigator.userAgent.toLowerCase().indexOf("firefox") > -1 && s("ngfEnableFirefoxPaste", a) && b.preventDefault(), !l() && i.shouldUpdateOn("paste", d, a) && m(b.clipboardData || b.originalEvent.clipboardData, b, "pasteUrl");
    }, !1), navigator.userAgent.toLowerCase().indexOf("firefox") > -1 && s("ngfEnableFirefoxPaste", a) && (c.attr("contenteditable", !0), c.on("keypress", function (a) {
      a.metaKey || a.ctrlKey || a.preventDefault();
    }));
  }

  function b() {
    var a = document.createElement("div");
    return "draggable" in a && "ondrop" in a && !/Edge\/12./i.test(navigator.userAgent);
  }

  ngFileUpload.directive("ngfDrop", ["$parse", "$timeout", "$window", "Upload", "$http", "$q", function (b, c, d, e, f, g) {
    return {
      restrict: "AEC",
      require: "?ngModel",
      link: function link(h, i, j, k) {
        a(h, i, j, k, b, c, d, e, f, g);
      }
    };
  }]), ngFileUpload.directive("ngfNoFileDrop", function () {
    return function (a, c) {
      b() && c.css("display", "none");
    };
  }), ngFileUpload.directive("ngfDropAvailable", ["$parse", "$timeout", "Upload", function (a, c, d) {
    return function (e, f, g) {
      if (b()) {
        var h = a(d.attrGetter("ngfDropAvailable", g));
        c(function () {
          h(e), h.assign && h.assign(e, !0);
        });
      }
    };
  }]);
}(), ngFileUpload.service("UploadExif", ["UploadResize", "$q", function (a, b) {
  function c(a, b, c, d) {
    switch (b) {
      case 2:
        return a.transform(-1, 0, 0, 1, c, 0);

      case 3:
        return a.transform(-1, 0, 0, -1, c, d);

      case 4:
        return a.transform(1, 0, 0, -1, 0, d);

      case 5:
        return a.transform(0, 1, 1, 0, 0, 0);

      case 6:
        return a.transform(0, 1, -1, 0, d, 0);

      case 7:
        return a.transform(0, -1, -1, 0, d, c);

      case 8:
        return a.transform(0, -1, 1, 0, 0, c);
    }
  }

  function d(a) {
    for (var b = "", c = new Uint8Array(a), d = c.byteLength, e = 0; d > e; e++) {
      b += String.fromCharCode(c[e]);
    }

    return window.btoa(b);
  }

  var e = a;
  return e.isExifSupported = function () {
    return window.FileReader && new FileReader().readAsArrayBuffer && e.isResizeSupported();
  }, e.readOrientation = function (a) {
    var c = b.defer(),
        d = new FileReader(),
        e = a.slice ? a.slice(0, 65536) : a;
    return d.readAsArrayBuffer(e), d.onerror = function (a) {
      return c.reject(a);
    }, d.onload = function (a) {
      var b = {
        orientation: 1
      },
          d = new DataView(this.result);
      if (65496 !== d.getUint16(0, !1)) return c.resolve(b);

      for (var e = d.byteLength, f = 2; e > f;) {
        var g = d.getUint16(f, !1);

        if (f += 2, 65505 === g) {
          if (1165519206 !== d.getUint32(f += 2, !1)) return c.resolve(b);
          var h = 18761 === d.getUint16(f += 6, !1);
          f += d.getUint32(f + 4, h);
          var i = d.getUint16(f, h);
          f += 2;

          for (var j = 0; i > j; j++) {
            if (274 === d.getUint16(f + 12 * j, h)) {
              var k = d.getUint16(f + 12 * j + 8, h);
              return k >= 2 && 8 >= k && (d.setUint16(f + 12 * j + 8, 1, h), b.fixedArrayBuffer = a.target.result), b.orientation = k, c.resolve(b);
            }
          }
        } else {
          if (65280 !== (65280 & g)) break;
          f += d.getUint16(f, !1);
        }
      }

      return c.resolve(b);
    }, c.promise;
  }, e.applyExifRotation = function (a) {
    if (0 !== a.type.indexOf("image/jpeg")) return e.emptyPromise(a);
    var f = b.defer();
    return e.readOrientation(a).then(function (b) {
      return b.orientation < 2 || b.orientation > 8 ? f.resolve(a) : void e.dataUrl(a, !0).then(function (g) {
        var h = document.createElement("canvas"),
            i = document.createElement("img");
        i.onload = function () {
          try {
            h.width = b.orientation > 4 ? i.height : i.width, h.height = b.orientation > 4 ? i.width : i.height;
            var g = h.getContext("2d");
            c(g, b.orientation, i.width, i.height), g.drawImage(i, 0, 0);
            var j = h.toDataURL(a.type || "image/WebP", .934);
            j = e.restoreExif(d(b.fixedArrayBuffer), j);
            var k = e.dataUrltoBlob(j, a.name);
            f.resolve(k);
          } catch (l) {
            return f.reject(l);
          }
        }, i.onerror = function () {
          f.reject();
        }, i.src = g;
      }, function (a) {
        f.reject(a);
      });
    }, function (a) {
      f.reject(a);
    }), f.promise;
  }, e.restoreExif = function (a, b) {
    var c = {};
    return c.KEY_STR = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", c.encode64 = function (a) {
      var b,
          c,
          d,
          e,
          f,
          g = "",
          h = "",
          i = "",
          j = 0;

      do {
        b = a[j++], c = a[j++], h = a[j++], d = b >> 2, e = (3 & b) << 4 | c >> 4, f = (15 & c) << 2 | h >> 6, i = 63 & h, isNaN(c) ? f = i = 64 : isNaN(h) && (i = 64), g = g + this.KEY_STR.charAt(d) + this.KEY_STR.charAt(e) + this.KEY_STR.charAt(f) + this.KEY_STR.charAt(i), b = c = h = "", d = e = f = i = "";
      } while (j < a.length);

      return g;
    }, c.restore = function (a, b) {
      a.match("data:image/jpeg;base64,") && (a = a.replace("data:image/jpeg;base64,", ""));
      var c = this.decode64(a),
          d = this.slice2Segments(c),
          e = this.exifManipulation(b, d);
      return "data:image/jpeg;base64," + this.encode64(e);
    }, c.exifManipulation = function (a, b) {
      var c = this.getExifArray(b),
          d = this.insertExif(a, c);
      return new Uint8Array(d);
    }, c.getExifArray = function (a) {
      for (var b, c = 0; c < a.length; c++) {
        if (b = a[c], 255 === b[0] & 225 === b[1]) return b;
      }

      return [];
    }, c.insertExif = function (a, b) {
      var c = a.replace("data:image/jpeg;base64,", ""),
          d = this.decode64(c),
          e = d.indexOf(255, 3),
          f = d.slice(0, e),
          g = d.slice(e),
          h = f;
      return h = h.concat(b), h = h.concat(g);
    }, c.slice2Segments = function (a) {
      for (var b = 0, c = [];;) {
        if (255 === a[b] & 218 === a[b + 1]) break;
        if (255 === a[b] & 216 === a[b + 1]) b += 2;else {
          var d = 256 * a[b + 2] + a[b + 3],
              e = b + d + 2,
              f = a.slice(b, e);
          c.push(f), b = e;
        }
        if (b > a.length) break;
      }

      return c;
    }, c.decode64 = function (a) {
      var b,
          c,
          d,
          e,
          f,
          g = "",
          h = "",
          i = 0,
          j = [],
          k = /[^A-Za-z0-9\+\/\=]/g;
      k.exec(a) && console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding."), a = a.replace(/[^A-Za-z0-9\+\/\=]/g, "");

      do {
        d = this.KEY_STR.indexOf(a.charAt(i++)), e = this.KEY_STR.indexOf(a.charAt(i++)), f = this.KEY_STR.indexOf(a.charAt(i++)), h = this.KEY_STR.indexOf(a.charAt(i++)), b = d << 2 | e >> 4, c = (15 & e) << 4 | f >> 2, g = (3 & f) << 6 | h, j.push(b), 64 !== f && j.push(c), 64 !== h && j.push(g), b = c = g = "", d = e = f = h = "";
      } while (i < a.length);

      return j;
    }, c.restore(a, b);
  }, e;
}]);function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/*! @flowjs/ng-flow 2.7.8 */
!function (a, b, c) {
  "use strict";

  function d(b) {
    if (this.support = !("undefined" == typeof File || "undefined" == typeof Blob || "undefined" == typeof FileList || !Blob.prototype.slice && !Blob.prototype.webkitSlice && !Blob.prototype.mozSlice), this.support) {
      this.supportDirectory = /Chrome/.test(a.navigator.userAgent) || /Firefox/.test(a.navigator.userAgent) || /Edge/.test(a.navigator.userAgent), this.files = [], this.defaults = {
        chunkSize: 1048576,
        forceChunkSize: !1,
        simultaneousUploads: 3,
        singleFile: !1,
        fileParameterName: "file",
        progressCallbacksInterval: 500,
        speedSmoothingFactor: .1,
        query: {},
        headers: {},
        withCredentials: !1,
        preprocess: null,
        method: "multipart",
        testMethod: "GET",
        uploadMethod: "POST",
        prioritizeFirstAndLastChunk: !1,
        allowDuplicateUploads: !1,
        target: "/",
        testChunks: !0,
        generateUniqueIdentifier: null,
        maxChunkRetries: 0,
        chunkRetryInterval: null,
        permanentErrors: [404, 413, 415, 500, 501],
        successStatuses: [200, 201, 202],
        onDropStopPropagation: !1,
        initFileFn: null,
        readFileFn: f
      }, this.opts = {}, this.events = {};
      var c = this;
      this.onDrop = function (a) {
        c.opts.onDropStopPropagation && a.stopPropagation(), a.preventDefault();
        var b = a.dataTransfer;
        b.items && b.items[0] && b.items[0].webkitGetAsEntry ? c.webkitReadDataTransfer(a) : c.addFiles(b.files, a);
      }, this.preventEvent = function (a) {
        a.preventDefault();
      }, this.opts = d.extend({}, this.defaults, b || {});
    }
  }

  function e(a, b, d) {
    this.flowObj = a, this.bytes = null, this.file = b, this.name = b.fileName || b.name, this.size = b.size, this.relativePath = b.relativePath || b.webkitRelativePath || this.name, this.uniqueIdentifier = d === c ? a.generateUniqueIdentifier(b) : d, this.chunks = [], this.paused = !1, this.error = !1, this.averageSpeed = 0, this.currentSpeed = 0, this._lastProgressCallback = Date.now(), this._prevUploadedSize = 0, this._prevProgress = 0, this.bootstrap();
  }

  function f(a, b, c, d, e) {
    var f = "slice";
    a.file.slice ? f = "slice" : a.file.mozSlice ? f = "mozSlice" : a.file.webkitSlice && (f = "webkitSlice"), e.readFinished(a.file[f](b, c, d));
  }

  function g(a, b, c) {
    this.flowObj = a, this.fileObj = b, this.offset = c, this.tested = !1, this.retries = 0, this.pendingRetry = !1, this.preprocessState = 0, this.readState = 0, this.loaded = 0, this.total = 0, this.chunkSize = this.flowObj.opts.chunkSize, this.startByte = this.offset * this.chunkSize, this.computeEndByte = function () {
      var a = Math.min(this.fileObj.size, (this.offset + 1) * this.chunkSize);
      return this.fileObj.size - a < this.chunkSize && !this.flowObj.opts.forceChunkSize && (a = this.fileObj.size), a;
    }, this.endByte = this.computeEndByte(), this.xhr = null;
    var d = this;
    this.event = function (a, b) {
      b = Array.prototype.slice.call(arguments), b.unshift(d), d.fileObj.chunkEvent.apply(d.fileObj, b);
    }, this.progressHandler = function (a) {
      a.lengthComputable && (d.loaded = a.loaded, d.total = a.total), d.event("progress", a);
    }, this.testHandler = function (a) {
      var b = d.status(!0);
      "error" === b ? (d.event(b, d.message()), d.flowObj.uploadNextChunk()) : "success" === b ? (d.tested = !0, d.event(b, d.message()), d.flowObj.uploadNextChunk()) : d.fileObj.paused || (d.tested = !0, d.send());
    }, this.doneHandler = function (a) {
      var b = d.status();
      if ("success" === b || "error" === b) delete this.data, d.event(b, d.message()), d.flowObj.uploadNextChunk();else {
        d.event("retry", d.message()), d.pendingRetry = !0, d.abort(), d.retries++;
        var c = d.flowObj.opts.chunkRetryInterval;
        null !== c ? setTimeout(function () {
          d.send();
        }, c) : d.send();
      }
    };
  }

  function h(a, b) {
    var c = a.indexOf(b);
    c > -1 && a.splice(c, 1);
  }

  function i(a, b) {
    return "function" == typeof a && (b = Array.prototype.slice.call(arguments), a = a.apply(null, b.slice(1))), a;
  }

  function j(a, b) {
    setTimeout(a.bind(b), 0);
  }

  function k(a, b) {
    return l(arguments, function (b) {
      b !== a && l(b, function (b, c) {
        a[c] = b;
      });
    }), a;
  }

  function l(a, b, c) {
    if (a) {
      var d;

      if ("undefined" != typeof a.length) {
        for (d = 0; d < a.length; d++) {
          if (b.call(c, a[d], d) === !1) return;
        }
      } else for (d in a) {
        if (a.hasOwnProperty(d) && b.call(c, a[d], d) === !1) return;
      }
    }
  }

  var m = a.navigator.msPointerEnabled;
  d.prototype = {
    on: function on(a, b) {
      a = a.toLowerCase(), this.events.hasOwnProperty(a) || (this.events[a] = []), this.events[a].push(b);
    },
    off: function off(a, b) {
      a !== c ? (a = a.toLowerCase(), b !== c ? this.events.hasOwnProperty(a) && h(this.events[a], b) : delete this.events[a]) : this.events = {};
    },
    fire: function fire(a, b) {
      b = Array.prototype.slice.call(arguments), a = a.toLowerCase();
      var c = !1;
      return this.events.hasOwnProperty(a) && l(this.events[a], function (a) {
        c = a.apply(this, b.slice(1)) === !1 || c;
      }, this), "catchall" != a && (b.unshift("catchAll"), c = this.fire.apply(this, b) === !1 || c), !c;
    },
    webkitReadDataTransfer: function webkitReadDataTransfer(a) {
      function b(a) {
        a.readEntries(function (f) {
          f.length ? (g += f.length, l(f, function (a) {
            if (a.isFile) {
              var e = a.fullPath;
              a.file(function (a) {
                c(a, e);
              }, d);
            } else a.isDirectory && b(a.createReader());
          }), b(a)) : e();
        }, d);
      }

      function c(a, b) {
        a.relativePath = b.substring(1), h.push(a), e();
      }

      function d(a) {
        throw a;
      }

      function e() {
        0 == --g && f.addFiles(h, a);
      }

      var f = this,
          g = a.dataTransfer.items.length,
          h = [];
      l(a.dataTransfer.items, function (a) {
        var d = a.webkitGetAsEntry();
        return d ? void (d.isFile ? c(a.getAsFile(), d.fullPath) : b(d.createReader())) : void e();
      });
    },
    generateUniqueIdentifier: function generateUniqueIdentifier(a) {
      var b = this.opts.generateUniqueIdentifier;
      if ("function" == typeof b) return b(a);
      var c = a.relativePath || a.webkitRelativePath || a.fileName || a.name;
      return a.size + "-" + c.replace(/[^0-9a-zA-Z_-]/gim, "");
    },
    uploadNextChunk: function uploadNextChunk(a) {
      var b = !1;
      if (this.opts.prioritizeFirstAndLastChunk && (l(this.files, function (a) {
        return !a.paused && a.chunks.length && "pending" === a.chunks[0].status() ? (a.chunks[0].send(), b = !0, !1) : !a.paused && a.chunks.length > 1 && "pending" === a.chunks[a.chunks.length - 1].status() ? (a.chunks[a.chunks.length - 1].send(), b = !0, !1) : void 0;
      }), b)) return b;
      if (l(this.files, function (a) {
        return a.paused || l(a.chunks, function (a) {
          return "pending" === a.status() ? (a.send(), b = !0, !1) : void 0;
        }), b ? !1 : void 0;
      }), b) return !0;
      var c = !1;
      return l(this.files, function (a) {
        return a.isComplete() ? void 0 : (c = !0, !1);
      }), c || a || j(function () {
        this.fire("complete");
      }, this), !1;
    },
    assignBrowse: function assignBrowse(a, c, d, e) {
      a instanceof Element && (a = [a]), l(a, function (a) {
        var f;
        "INPUT" === a.tagName && "file" === a.type ? f = a : (f = b.createElement("input"), f.setAttribute("type", "file"), k(f.style, {
          visibility: "hidden",
          position: "absolute",
          width: "1px",
          height: "1px"
        }), a.appendChild(f), a.addEventListener("click", function () {
          f.click();
        }, !1)), this.opts.singleFile || d || f.setAttribute("multiple", "multiple"), c && f.setAttribute("webkitdirectory", "webkitdirectory"), l(e, function (a, b) {
          f.setAttribute(b, a);
        });
        var g = this;
        f.addEventListener("change", function (a) {
          a.target.value && (g.addFiles(a.target.files, a), a.target.value = "");
        }, !1);
      }, this);
    },
    assignDrop: function assignDrop(a) {
      "undefined" == typeof a.length && (a = [a]), l(a, function (a) {
        a.addEventListener("dragover", this.preventEvent, !1), a.addEventListener("dragenter", this.preventEvent, !1), a.addEventListener("drop", this.onDrop, !1);
      }, this);
    },
    unAssignDrop: function unAssignDrop(a) {
      "undefined" == typeof a.length && (a = [a]), l(a, function (a) {
        a.removeEventListener("dragover", this.preventEvent), a.removeEventListener("dragenter", this.preventEvent), a.removeEventListener("drop", this.onDrop);
      }, this);
    },
    isUploading: function isUploading() {
      var a = !1;
      return l(this.files, function (b) {
        return b.isUploading() ? (a = !0, !1) : void 0;
      }), a;
    },
    _shouldUploadNext: function _shouldUploadNext() {
      var a = 0,
          b = !0,
          c = this.opts.simultaneousUploads;
      return l(this.files, function (d) {
        l(d.chunks, function (d) {
          return "uploading" === d.status() && (a++, a >= c) ? (b = !1, !1) : void 0;
        });
      }), b && a;
    },
    upload: function upload() {
      var a = this._shouldUploadNext();

      if (a !== !1) {
        this.fire("uploadStart");

        for (var b = !1, c = 1; c <= this.opts.simultaneousUploads - a; c++) {
          b = this.uploadNextChunk(!0) || b;
        }

        b || j(function () {
          this.fire("complete");
        }, this);
      }
    },
    resume: function resume() {
      l(this.files, function (a) {
        a.isComplete() || a.resume();
      });
    },
    pause: function pause() {
      l(this.files, function (a) {
        a.pause();
      });
    },
    cancel: function cancel() {
      for (var a = this.files.length - 1; a >= 0; a--) {
        this.files[a].cancel();
      }
    },
    progress: function progress() {
      var a = 0,
          b = 0;
      return l(this.files, function (c) {
        a += c.progress() * c.size, b += c.size;
      }), b > 0 ? a / b : 0;
    },
    addFile: function addFile(a, b) {
      this.addFiles([a], b);
    },
    addFiles: function addFiles(a, b) {
      var c = [];
      l(a, function (a) {
        if ((!m || m && a.size > 0) && (a.size % 4096 !== 0 || "." !== a.name && "." !== a.fileName)) {
          var d = this.generateUniqueIdentifier(a);

          if (this.opts.allowDuplicateUploads || !this.getFromUniqueIdentifier(d)) {
            var f = new e(this, a, d);
            this.fire("fileAdded", f, b) && c.push(f);
          }
        }
      }, this), this.fire("filesAdded", c, b) && (l(c, function (a) {
        this.opts.singleFile && this.files.length > 0 && this.removeFile(this.files[0]), this.files.push(a);
      }, this), this.fire("filesSubmitted", c, b));
    },
    removeFile: function removeFile(a) {
      for (var b = this.files.length - 1; b >= 0; b--) {
        this.files[b] === a && (this.files.splice(b, 1), a.abort(), this.fire("fileRemoved", a));
      }
    },
    getFromUniqueIdentifier: function getFromUniqueIdentifier(a) {
      var b = !1;
      return l(this.files, function (c) {
        c.uniqueIdentifier === a && (b = c);
      }), b;
    },
    getSize: function getSize() {
      var a = 0;
      return l(this.files, function (b) {
        a += b.size;
      }), a;
    },
    sizeUploaded: function sizeUploaded() {
      var a = 0;
      return l(this.files, function (b) {
        a += b.sizeUploaded();
      }), a;
    },
    timeRemaining: function timeRemaining() {
      var a = 0,
          b = 0;
      return l(this.files, function (c) {
        c.paused || c.error || (a += c.size - c.sizeUploaded(), b += c.averageSpeed);
      }), a && !b ? Number.POSITIVE_INFINITY : a || b ? Math.floor(a / b) : 0;
    }
  }, e.prototype = {
    measureSpeed: function measureSpeed() {
      var a = Date.now() - this._lastProgressCallback;

      if (a) {
        var b = this.flowObj.opts.speedSmoothingFactor,
            c = this.sizeUploaded();
        this.currentSpeed = Math.max((c - this._prevUploadedSize) / a * 1e3, 0), this.averageSpeed = b * this.currentSpeed + (1 - b) * this.averageSpeed, this._prevUploadedSize = c;
      }
    },
    chunkEvent: function chunkEvent(a, b, c) {
      switch (b) {
        case "progress":
          if (Date.now() - this._lastProgressCallback < this.flowObj.opts.progressCallbacksInterval) break;
          this.measureSpeed(), this.flowObj.fire("fileProgress", this, a), this.flowObj.fire("progress"), this._lastProgressCallback = Date.now();
          break;

        case "error":
          this.error = !0, this.abort(!0), this.flowObj.fire("fileError", this, c, a), this.flowObj.fire("error", c, this, a);
          break;

        case "success":
          if (this.error) return;
          this.measureSpeed(), this.flowObj.fire("fileProgress", this, a), this.flowObj.fire("progress"), this._lastProgressCallback = Date.now(), this.isComplete() && (this.currentSpeed = 0, this.averageSpeed = 0, this.flowObj.fire("fileSuccess", this, c, a));
          break;

        case "retry":
          this.flowObj.fire("fileRetry", this, a);
      }
    },
    pause: function pause() {
      this.paused = !0, this.abort();
    },
    resume: function resume() {
      this.paused = !1, this.flowObj.upload();
    },
    abort: function abort(a) {
      this.currentSpeed = 0, this.averageSpeed = 0;
      var b = this.chunks;
      a && (this.chunks = []), l(b, function (a) {
        "uploading" === a.status() && (a.abort(), this.flowObj.uploadNextChunk());
      }, this);
    },
    cancel: function cancel() {
      this.flowObj.removeFile(this);
    },
    retry: function retry() {
      this.bootstrap(), this.flowObj.upload();
    },
    bootstrap: function bootstrap() {
      "function" == typeof this.flowObj.opts.initFileFn && this.flowObj.opts.initFileFn(this), this.abort(!0), this.error = !1, this._prevProgress = 0;

      for (var a = this.flowObj.opts.forceChunkSize ? Math.ceil : Math.floor, b = Math.max(a(this.size / this.flowObj.opts.chunkSize), 1), c = 0; b > c; c++) {
        this.chunks.push(new g(this.flowObj, this, c));
      }
    },
    progress: function progress() {
      if (this.error) return 1;
      if (1 === this.chunks.length) return this._prevProgress = Math.max(this._prevProgress, this.chunks[0].progress()), this._prevProgress;
      var a = 0;
      l(this.chunks, function (b) {
        a += b.progress() * (b.endByte - b.startByte);
      });
      var b = a / this.size;
      return this._prevProgress = Math.max(this._prevProgress, b > .9999 ? 1 : b), this._prevProgress;
    },
    isUploading: function isUploading() {
      var a = !1;
      return l(this.chunks, function (b) {
        return "uploading" === b.status() ? (a = !0, !1) : void 0;
      }), a;
    },
    isComplete: function isComplete() {
      var a = !1;
      return l(this.chunks, function (b) {
        var c = b.status();
        return "pending" === c || "uploading" === c || "reading" === c || 1 === b.preprocessState || 1 === b.readState ? (a = !0, !1) : void 0;
      }), !a;
    },
    sizeUploaded: function sizeUploaded() {
      var a = 0;
      return l(this.chunks, function (b) {
        a += b.sizeUploaded();
      }), a;
    },
    timeRemaining: function timeRemaining() {
      if (this.paused || this.error) return 0;
      var a = this.size - this.sizeUploaded();
      return a && !this.averageSpeed ? Number.POSITIVE_INFINITY : a || this.averageSpeed ? Math.floor(a / this.averageSpeed) : 0;
    },
    getType: function getType() {
      return this.file.type && this.file.type.split("/")[1];
    },
    getExtension: function getExtension() {
      return this.name.substr((~-this.name.lastIndexOf(".") >>> 0) + 2).toLowerCase();
    }
  }, g.prototype = {
    getParams: function getParams() {
      return {
        flowChunkNumber: this.offset + 1,
        flowChunkSize: this.flowObj.opts.chunkSize,
        flowCurrentChunkSize: this.endByte - this.startByte,
        flowTotalSize: this.fileObj.size,
        flowIdentifier: this.fileObj.uniqueIdentifier,
        flowFilename: this.fileObj.name,
        flowRelativePath: this.fileObj.relativePath,
        flowTotalChunks: this.fileObj.chunks.length
      };
    },
    getTarget: function getTarget(a, b) {
      return a += a.indexOf("?") < 0 ? "?" : "&", a + b.join("&");
    },
    test: function test() {
      this.xhr = new XMLHttpRequest(), this.xhr.addEventListener("load", this.testHandler, !1), this.xhr.addEventListener("error", this.testHandler, !1);
      var a = i(this.flowObj.opts.testMethod, this.fileObj, this),
          b = this.prepareXhrRequest(a, !0);
      this.xhr.send(b);
    },
    preprocessFinished: function preprocessFinished() {
      this.endByte = this.computeEndByte(), this.preprocessState = 2, this.send();
    },
    readFinished: function readFinished(a) {
      this.readState = 2, this.bytes = a, this.send();
    },
    send: function send() {
      var a = this.flowObj.opts.preprocess,
          b = this.flowObj.opts.readFileFn;
      if ("function" == typeof a) switch (this.preprocessState) {
        case 0:
          return this.preprocessState = 1, void a(this);

        case 1:
          return;
      }

      switch (this.readState) {
        case 0:
          return this.readState = 1, void b(this.fileObj, this.startByte, this.endByte, this.fileObj.file.type, this);

        case 1:
          return;
      }

      if (this.flowObj.opts.testChunks && !this.tested) return void this.test();
      this.loaded = 0, this.total = 0, this.pendingRetry = !1, this.xhr = new XMLHttpRequest(), this.xhr.upload.addEventListener("progress", this.progressHandler, !1), this.xhr.addEventListener("load", this.doneHandler, !1), this.xhr.addEventListener("error", this.doneHandler, !1);
      var c = i(this.flowObj.opts.uploadMethod, this.fileObj, this),
          d = this.prepareXhrRequest(c, !1, this.flowObj.opts.method, this.bytes);
      this.xhr.send(d);
    },
    abort: function abort() {
      var a = this.xhr;
      this.xhr = null, a && a.abort();
    },
    status: function status(a) {
      return 1 === this.readState ? "reading" : this.pendingRetry || 1 === this.preprocessState ? "uploading" : this.xhr ? this.xhr.readyState < 4 ? "uploading" : this.flowObj.opts.successStatuses.indexOf(this.xhr.status) > -1 ? "success" : this.flowObj.opts.permanentErrors.indexOf(this.xhr.status) > -1 || !a && this.retries >= this.flowObj.opts.maxChunkRetries ? "error" : (this.abort(), "pending") : "pending";
    },
    message: function message() {
      return this.xhr ? this.xhr.responseText : "";
    },
    progress: function progress() {
      if (this.pendingRetry) return 0;
      var a = this.status();
      return "success" === a || "error" === a ? 1 : "pending" === a ? 0 : this.total > 0 ? this.loaded / this.total : 0;
    },
    sizeUploaded: function sizeUploaded() {
      var a = this.endByte - this.startByte;
      return "success" !== this.status() && (a = this.progress() * a), a;
    },
    prepareXhrRequest: function prepareXhrRequest(a, b, c, d) {
      var e = i(this.flowObj.opts.query, this.fileObj, this, b);
      e = k(e, this.getParams());
      var f = i(this.flowObj.opts.target, this.fileObj, this, b),
          g = null;

      if ("GET" === a || "octet" === c) {
        var h = [];
        l(e, function (a, b) {
          h.push([encodeURIComponent(b), encodeURIComponent(a)].join("="));
        }), f = this.getTarget(f, h), g = d || null;
      } else g = new FormData(), l(e, function (a, b) {
        g.append(b, a);
      }), "undefined" != typeof d && g.append(this.flowObj.opts.fileParameterName, d, this.fileObj.file.name);

      return this.xhr.open(a, f, !0), this.xhr.withCredentials = this.flowObj.opts.withCredentials, l(i(this.flowObj.opts.headers, this.fileObj, this, b), function (a, b) {
        this.xhr.setRequestHeader(b, a);
      }, this), g;
    }
  }, d.evalOpts = i, d.extend = k, d.each = l, d.FlowFile = e, d.FlowChunk = g, d.version = "2.13.0", "object" == (typeof module === "undefined" ? "undefined" : _typeof(module)) && module && "object" == _typeof(module.exports) ? module.exports = d : (a.Flow = d, "function" == typeof define && define.amd && define("flow", [], function () {
    return d;
  }));
}(window, document), angular.module("flow.provider", []).provider("flowFactory", function () {
  "use strict";

  this.defaults = {}, this.factory = function (a) {
    return new Flow(a);
  }, this.events = [], this.on = function (a, b) {
    this.events.push([a, b]);
  }, this.$get = function () {
    var a = this.factory,
        b = this.defaults,
        c = this.events;
    return {
      create: function create(d) {
        var e = a(angular.extend({}, b, d));
        return angular.forEach(c, function (a) {
          e.on(a[0], a[1]);
        }), e;
      }
    };
  };
}), angular.module("flow.init", ["flow.provider"]).controller("flowCtrl", ["$scope", "$attrs", "$parse", "flowFactory", function (a, b, c, d) {
  var e = angular.extend({}, a.$eval(b.flowInit)),
      f = a.$eval(b.flowObject) || d.create(e),
      g = function g(b) {
    var c = Array.prototype.slice.call(arguments);
    c.shift();
    var d = a.$broadcast.apply(a, ["flow::" + b, f].concat(c));
    return {
      progress: 1,
      filesSubmitted: 1,
      fileSuccess: 1,
      fileError: 1,
      complete: 1
    }[b] && a.$applyAsync(), d.defaultPrevented ? !1 : void 0;
  };

  f.on("catchAll", g), a.$on("$destroy", function () {
    f.off("catchAll", g);
  }), a.$flow = f, b.hasOwnProperty("flowName") && (c(b.flowName).assign(a, f), a.$on("$destroy", function () {
    c(b.flowName).assign(a);
  }));
}]).directive("flowInit", [function () {
  return {
    scope: !0,
    controller: "flowCtrl"
  };
}]), angular.module("flow.btn", ["flow.init"]).directive("flowBtn", [function () {
  return {
    restrict: "EA",
    scope: !1,
    require: "^flowInit",
    link: function link(a, b, c) {
      var d = c.hasOwnProperty("flowDirectory"),
          e = c.hasOwnProperty("flowSingleFile"),
          f = c.hasOwnProperty("flowAttrs") && a.$eval(c.flowAttrs);
      a.$flow.assignBrowse(b, d, e, f);
    }
  };
}]), angular.module("flow.dragEvents", ["flow.init"]).directive("flowPreventDrop", function () {
  return {
    scope: !1,
    link: function link(a, b, c) {
      b.bind("drop dragover", function (a) {
        a.preventDefault();
      });
    }
  };
}).directive("flowDragEnter", ["$timeout", function (a) {
  return {
    scope: !1,
    link: function link(b, c, d) {
      function e(a) {
        var b = !1,
            c = a.dataTransfer || a.originalEvent.dataTransfer;
        return angular.forEach(c && c.types, function (a) {
          "Files" === a && (b = !0);
        }), b;
      }

      var f,
          g = !1;
      c.bind("dragover", function (c) {
        e(c) && (g || (b.$apply(d.flowDragEnter), g = !0), a.cancel(f), c.preventDefault());
      }), c.bind("dragleave drop", function (c) {
        a.cancel(f), f = a(function () {
          b.$eval(d.flowDragLeave), f = null, g = !1;
        }, 100);
      });
    }
  };
}]), angular.module("flow.drop", ["flow.init"]).directive("flowDrop", function () {
  return {
    scope: !1,
    require: "^flowInit",
    link: function link(a, b, c) {
      function d() {
        a.$flow.assignDrop(b);
      }

      function e() {
        a.$flow.unAssignDrop(b);
      }

      c.flowDropEnabled ? a.$watch(c.flowDropEnabled, function (a) {
        a ? d() : e();
      }) : d();
    }
  };
}), !function (a) {
  "use strict";

  function b(a) {
    return a.charAt(0).toUpperCase() + a.slice(1);
  }

  var c = a.module("flow.events", ["flow.init"]),
      d = {
    fileSuccess: ["$file", "$message"],
    fileProgress: ["$file"],
    fileAdded: ["$file", "$event"],
    filesAdded: ["$files", "$event"],
    filesSubmitted: ["$files", "$event"],
    fileRetry: ["$file"],
    fileRemoved: ["$file"],
    fileError: ["$file", "$message"],
    uploadStart: [],
    complete: [],
    progress: [],
    error: ["$message", "$file"]
  };
  a.forEach(d, function (d, e) {
    var f = "flow" + b(e);
    "flowUploadStart" == f && (f = "flowUploadStarted"), c.directive(f, [function () {
      return {
        require: "^flowInit",
        controller: ["$scope", "$attrs", function (b, c) {
          b.$on("flow::" + e, function () {
            var e = Array.prototype.slice.call(arguments),
                g = e.shift();

            if (b.$flow === e.shift()) {
              var h = {};
              a.forEach(d, function (a, b) {
                h[a] = e[b];
              }), b.$eval(c[f], h) === !1 && g.preventDefault();
            }
          });
        }]
      };
    }]);
  });
}(angular), angular.module("flow.img", ["flow.init"]).directive("flowImg", [function () {
  return {
    scope: !1,
    require: "^flowInit",
    link: function link(a, b, c) {
      var d = c.flowImg;
      a.$watch(d, function (b) {
        if (b) {
          var d = new FileReader();
          d.readAsDataURL(b.file), d.onload = function (b) {
            a.$apply(function () {
              c.$set("src", b.target.result);
            });
          };
        }
      });
    }
  };
}]), angular.module("flow.transfers", ["flow.init"]).directive("flowTransfers", [function () {
  return {
    scope: !0,
    require: "^flowInit",
    link: function link(a) {
      a.transfers = a.$flow.files;
    }
  };
}]), angular.module("flow", ["flow.provider", "flow.init", "flow.events", "flow.btn", "flow.drop", "flow.transfers", "flow.img", "flow.dragEvents"]);"use strict";

function string2array(a) {
  return a.split(",").map(Function.prototype.call, String.prototype.trim);
}

function pasteHtmlAtCaret(a) {
  var b, c;

  if (window.getSelection) {
    if (b = window.getSelection(), b.getRangeAt && b.rangeCount) {
      c = b.getRangeAt(0), c.deleteContents();
      var d = document.createElement("div");
      d.innerHTML = a;

      for (var e, f, g = document.createDocumentFragment(); e = d.firstChild;) {
        f = g.appendChild(e);
      }

      c.insertNode(g), f && (c = c.cloneRange(), c.setStartAfter(f), c.collapse(!0), b.removeAllRanges(), b.addRange(c));
    }
  } else document.selection && "Control" != document.selection.type && document.selection.createRange().pasteHTML(a);
}

var VERSION = "3.0.16";
angular.module("ngWig", ["ngwig-app-templates"]), angular.ngWig = {
  version: VERSION
}, angular.module("ngWig").component("ngWig", {
  bindings: {
    content: "=ngModel",
    options: "<?",
    onPaste: "&",
    buttons: "@",
    beforeExecCommand: "&",
    afterExecCommand: "&",
    placeholder: "@?"
  },
  require: {
    ngModelController: "ngModel"
  },
  templateUrl: "ng-wig/views/ng-wig.html",
  controller: ["$scope", "$element", "$q", "$attrs", "$window", "$document", "ngWigToolbar", function (a, b, c, d, e, f, g) {
    var h = this,
        i = angular.element(b[0].querySelector("#ng-wig-editable"));
    this.required = "required" in d, this.isSourceModeAllowed = "sourceModeAllowed" in d, this.editMode = !1, d.$observe("disabled", function (a) {
      h.disabled = a, i.attr("contenteditable", !a);
    }), this.isEditorActive = function () {
      return i[0] === f[0].activeElement;
    }, this.toggleEditMode = function () {
      h.editMode = !h.editMode, e.getSelection().removeAllRanges && e.getSelection().removeAllRanges();
    }, this.execCommand = function (a, b) {
      if (h.editMode) return !1;
      if (f[0].queryCommandSupported && !f[0].queryCommandSupported(a)) throw 'The command "' + a + '" is not supported';

      if ("createlink" !== a && "insertImage" !== a || (b = e.prompt("Please enter the URL", "http://"))) {
        h.beforeExecCommand({
          command: a,
          options: b
        });
        var c = f[0].getSelection().toString();
        "createlink" === a && "" === c ? f[0].execCommand("insertHtml", !1, '<a href="' + b + '">' + b + "</a>") : f[0].execCommand(a, !1, b), h.afterExecCommand({
          command: a,
          options: b
        }), i.length && i[0].focus();
      }
    }, this.$onInit = function () {
      h.toolbarButtons = g.getToolbarButtons(h.buttons && string2array(h.buttons));
      var b = Boolean(h.placeholder);
      h.ngModelController.$render = function () {
        return h.ngModelController.$viewValue ? i.html(h.ngModelController.$viewValue) : b ? i.empty() : i.html("<p></p>");
      }, i.bind("blur keyup change focus click", function () {
        !b || i.html().length && "<br>" !== i.html() || i.empty(), h.ngModelController.$setViewValue(i.html()), a.$applyAsync();
      });
    }, i.on("paste", function (a) {
      if (d.onPaste) {
        var b = void 0;
        b = window.clipboardData && window.clipboardData.getData ? window.clipboardData.getData("Text") : (a.originalEvent || a).clipboardData.getData("text/plain"), a.preventDefault(), c.when(h.onPaste({
          $event: a,
          pasteContent: b
        })).then(function (a) {
          pasteHtmlAtCaret(a);
        });
      }
    });
  }]
}), angular.module("ngWig").provider("ngWigToolbar", function () {
  var a = {
    list1: {
      title: "Unordered List",
      command: "insertunorderedlist",
      styleClass: "list-ul"
    },
    list2: {
      title: "Ordered List",
      command: "insertorderedlist",
      styleClass: "list-ol"
    },
    bold: {
      title: "Bold",
      command: "bold",
      styleClass: "bold"
    },
    italic: {
      title: "Italic",
      command: "italic",
      styleClass: "italic"
    },
    link: {
      title: "Link",
      command: "createlink",
      styleClass: "link"
    }
  },
      b = ["list1", "list2", "bold", "italic", "link"],
      c = function c() {
    return !!this.command && document.queryCommandState(this.command);
  };

  this.setButtons = function (a) {
    if (!angular.isArray(a)) throw 'Argument "buttons" should be an array';
    b = a;
  }, this.addStandardButton = function (c, d, e, f) {
    if (!c || !d || !e) throw 'Arguments "name", "title" and "command" are required';
    f = f || "", a[c] = {
      title: d,
      command: e,
      styleClass: f
    }, b.push(c);
  }, this.addCustomButton = function (c, d) {
    if (!c || !d) throw 'Arguments "name" and "pluginName" are required';
    a[c] = {
      pluginName: d,
      isComplex: !0
    }, b.push(c);
  }, this.$get = function () {
    return {
      getToolbarButtons: function getToolbarButtons(d) {
        var e = [];
        return (d || b).forEach(function (b) {
          if (!a[b]) throw 'There is no "' + b + '" in your library. Possible variants: ' + Object.keys(a);
          var d = angular.copy(a[b]);
          d.isActive = c, e.push(d);
        }), e;
      }
    };
  };
}), angular.module("ngWig").component("ngWigPlugin", {
  bindings: {
    plugin: "<",
    execCommand: "=",
    editMode: "=",
    disabled: "=",
    options: "<",
    content: "="
  },
  controller: ["$scope", "$element", "$compile", function (a, b, c) {
    var d = this;

    this.$onInit = function () {
      b.replaceWith(c("<" + d.plugin.pluginName + ' plugin="$ctrl.plugin"exec-command="$ctrl.execCommand"edit-mode="$ctrl.editMode"disabled="$ctrl.disabled"options="$ctrl.options"content="$ctrl.content"/>')(a));
    };
  }]
}), angular.module("ngwig-app-templates", ["ng-wig/views/ng-wig.html"]), angular.module("ng-wig/views/ng-wig.html", []).run(["$templateCache", function (a) {
  a.put("ng-wig/views/ng-wig.html", '<div class="ng-wig">\n  <ul class="nw-toolbar">\n    <li class="nw-toolbar__item" ng-repeat="button in $ctrl.toolbarButtons">\n        <div ng-if="!button.isComplex">\n          <button type="button"\n                  class="nw-button {{button.styleClass}}"\n                  title="{{button.title}}"\n                  ng-click="$ctrl.execCommand(button.command)"\n                  ng-class="{ \'nw-button--active\': !$ctrl.disabled && $ctrl.isEditorActive() && button.isActive() }"\n                  ng-disabled="$ctrl.editMode || $ctrl.disabled">\n            {{ button.title }}\n          </button>\n        </div>\n        <div ng-if="button.isComplex">\n          <ng-wig-plugin\n              exec-command="$ctrl.execCommand"\n              plugin="button"\n              edit-mode="$ctrl.editMode"\n              disabled="$ctrl.disabled"\n              options="$ctrl.options"\n              content="$ctrl.content"></ng-wig-plugin>\n        </div>\n    </li><!--\n    --><li class="nw-toolbar__item">\n      <button type="button"\n              class="nw-button nw-button--source"\n              title="Edit HTML"\n              ng-class="{ \'nw-button--active\': $ctrl.editMode }"\n              ng-if="$ctrl.isSourceModeAllowed"\n              ng-click="$ctrl.toggleEditMode()"\n              ng-disabled="$ctrl.disabled">\n        Edit HTML\n      </button>\n    </li>\n  </ul>\n\n  <div class="nw-editor-container">\n    <div class="nw-editor__src-container" ng-show="$ctrl.editMode">\n      <textarea ng-model="$ctrl.content"\n                ng-disabled="$ctrl.disabled"\n                class="nw-editor__src"></textarea>\n    </div>\n    <div class="nw-editor" ng-class="{ \'nw-disabled\': $ctrl.disabled }">\n      <div id="ng-wig-editable"\n           class="nw-editor__res"\n           ng-class="{\'nw-invisible\': $ctrl.editMode}"\n           ng-disabled="$ctrl.disabled"\n           contenteditable\n           placeholder="{{$ctrl.placeholder}}">\n      </div>\n    </div>\n  </div>\n</div>\n');
}]);function _typeof2(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof2(obj); }

(function webpackUniversalModuleDefinition(root, factory) {
  if ((typeof exports === "undefined" ? "undefined" : _typeof2(exports)) === 'object' && (typeof module === "undefined" ? "undefined" : _typeof2(module)) === 'object') module.exports = factory(function webpackLoadOptionalExternalModule() {
    try {
      return require("fs");
    } catch (e) {}
  }(), require("path"));else if (typeof define === 'function' && define.amd) define(["fs", "path"], factory);else if ((typeof exports === "undefined" ? "undefined" : _typeof2(exports)) === 'object') exports["Twig"] = factory(function webpackLoadOptionalExternalModule() {
    try {
      return require("fs");
    } catch (e) {}
  }(), require("path"));else root["Twig"] = factory(root["fs"], root["path"]);
})(this, function (__WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_20__) {
  return (
    /******/
    function (modules) {
      // webpackBootstrap

      /******/
      // The module cache

      /******/
      var installedModules = {};
      /******/
      // The require function

      /******/

      function __webpack_require__(moduleId) {
        /******/
        // Check if module is in cache

        /******/
        if (installedModules[moduleId])
          /******/
          return installedModules[moduleId].exports;
        /******/
        // Create a new module (and put it into the cache)

        /******/

        var module = installedModules[moduleId] = {
          /******/
          exports: {},

          /******/
          id: moduleId,

          /******/
          loaded: false
          /******/

        };
        /******/
        // Execute the module function

        /******/

        modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
        /******/
        // Flag the module as loaded

        /******/

        module.loaded = true;
        /******/
        // Return the exports of the module

        /******/

        return module.exports;
        /******/
      }
      /******/
      // expose the modules object (__webpack_modules__)

      /******/


      __webpack_require__.m = modules;
      /******/
      // expose the module cache

      /******/

      __webpack_require__.c = installedModules;
      /******/
      // __webpack_public_path__

      /******/

      __webpack_require__.p = "";
      /******/
      // Load entry module and return exports

      /******/

      return __webpack_require__(0);
      /******/
    }(
    /************************************************************************/

    /******/
    [
    /* 0 */

    /***/
    function (module, exports, __webpack_require__) {
      /**
       * Twig.js
       *
       * @copyright 2011-2016 John Roepke and the Twig.js Contributors
       * @license   Available under the BSD 2-Clause License
       * @link      https://github.com/twigjs/twig.js
       */
      var Twig = {
        VERSION: '0.10.2'
      };

      __webpack_require__(1)(Twig);

      __webpack_require__(2)(Twig);

      __webpack_require__(3)(Twig);

      __webpack_require__(5)(Twig);

      __webpack_require__(6)(Twig);

      __webpack_require__(7)(Twig);

      __webpack_require__(17)(Twig);

      __webpack_require__(18)(Twig);

      __webpack_require__(21)(Twig);

      __webpack_require__(22)(Twig);

      __webpack_require__(23)(Twig);

      __webpack_require__(24)(Twig);

      __webpack_require__(25)(Twig);

      __webpack_require__(26)(Twig);

      __webpack_require__(27)(Twig);

      module.exports = Twig.exports;
      /***/
    },
    /* 1 */

    /***/
    function (module, exports) {
      // ## twig.core.js
      //
      // This file handles template level tokenizing, compiling and parsing.
      module.exports = function (Twig) {
        "use strict";

        Twig.trace = false;
        Twig.debug = false; // Default caching to true for the improved performance it offers

        Twig.cache = true;

        Twig.noop = function () {};

        Twig.placeholders = {
          parent: "{{|PARENT|}}"
        };
        /**
         * Fallback for Array.indexOf for IE8 et al
         */

        Twig.indexOf = function (arr, searchElement
        /*, fromIndex */
        ) {
          if (Array.prototype.hasOwnProperty("indexOf")) {
            return arr.indexOf(searchElement);
          }

          if (arr === void 0 || arr === null) {
            throw new TypeError();
          }

          var t = Object(arr);
          var len = t.length >>> 0;

          if (len === 0) {
            return -1;
          }

          var n = 0;

          if (arguments.length > 0) {
            n = Number(arguments[1]);

            if (n !== n) {
              // shortcut for verifying if it's NaN
              n = 0;
            } else if (n !== 0 && n !== Infinity && n !== -Infinity) {
              n = (n > 0 || -1) * Math.floor(Math.abs(n));
            }
          }

          if (n >= len) {
            // console.log("indexOf not found1 ", JSON.stringify(searchElement), JSON.stringify(arr));
            return -1;
          }

          var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);

          for (; k < len; k++) {
            if (k in t && t[k] === searchElement) {
              return k;
            }
          }

          if (arr == searchElement) {
            return 0;
          } // console.log("indexOf not found2 ", JSON.stringify(searchElement), JSON.stringify(arr));


          return -1;
        };

        Twig.forEach = function (arr, callback, thisArg) {
          if (Array.prototype.forEach) {
            return arr.forEach(callback, thisArg);
          }

          var T, k;

          if (arr == null) {
            throw new TypeError(" this is null or not defined");
          } // 1. Let O be the result of calling ToObject passing the |this| value as the argument.


          var O = Object(arr); // 2. Let lenValue be the result of calling the Get internal method of O with the argument "length".
          // 3. Let len be ToUint32(lenValue).

          var len = O.length >>> 0; // Hack to convert O.length to a UInt32
          // 4. If IsCallable(callback) is false, throw a TypeError exception.
          // See: http://es5.github.com/#x9.11

          if ({}.toString.call(callback) != "[object Function]") {
            throw new TypeError(callback + " is not a function");
          } // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.


          if (thisArg) {
            T = thisArg;
          } // 6. Let k be 0


          k = 0; // 7. Repeat, while k < len

          while (k < len) {
            var kValue; // a. Let Pk be ToString(k).
            //   This is implicit for LHS operands of the in operator
            // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
            //   This step can be combined with c
            // c. If kPresent is true, then

            if (k in O) {
              // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
              kValue = O[k]; // ii. Call the Call internal method of callback with T as the this value and
              // argument list containing kValue, k, and O.

              callback.call(T, kValue, k, O);
            } // d. Increase k by 1.


            k++;
          } // 8. return undefined

        };

        Twig.merge = function (target, source, onlyChanged) {
          Twig.forEach(Object.keys(source), function (key) {
            if (onlyChanged && !(key in target)) {
              return;
            }

            target[key] = source[key];
          });
          return target;
        };
        /**
         * Exception thrown by twig.js.
         */


        Twig.Error = function (message, file) {
          this.message = message;
          this.name = "TwigException";
          this.type = "TwigException";
          this.file = file;
        };
        /**
         * Get the string representation of a Twig error.
         */


        Twig.Error.prototype.toString = function () {
          var output = this.name + ": " + this.message;
          return output;
        };
        /**
         * Wrapper for logging to the console.
         */


        Twig.log = {
          trace: function trace() {
            if (Twig.trace && console) {
              console.log(Array.prototype.slice.call(arguments));
            }
          },
          debug: function debug() {
            if (Twig.debug && console) {
              console.log(Array.prototype.slice.call(arguments));
            }
          }
        };

        if (typeof console !== "undefined") {
          if (typeof console.error !== "undefined") {
            Twig.log.error = function () {
              console.error.apply(console, arguments);
            };
          } else if (typeof console.log !== "undefined") {
            Twig.log.error = function () {
              console.log.apply(console, arguments);
            };
          }
        } else {
          Twig.log.error = function () {};
        }
        /**
         * Wrapper for child context objects in Twig.
         *
         * @param {Object} context Values to initialize the context with.
         */


        Twig.ChildContext = function (context) {
          var ChildContext = function ChildContext() {};

          ChildContext.prototype = context;
          return new ChildContext();
        };
        /**
         * Container for methods related to handling high level template tokens
         *      (for example: {{ expression }}, {% logic %}, {# comment #}, raw data)
         */


        Twig.token = {};
        /**
         * Token types.
         */

        Twig.token.type = {
          output: 'output',
          logic: 'logic',
          comment: 'comment',
          raw: 'raw',
          output_whitespace_pre: 'output_whitespace_pre',
          output_whitespace_post: 'output_whitespace_post',
          output_whitespace_both: 'output_whitespace_both',
          logic_whitespace_pre: 'logic_whitespace_pre',
          logic_whitespace_post: 'logic_whitespace_post',
          logic_whitespace_both: 'logic_whitespace_both'
        };
        /**
         * Token syntax definitions.
         */

        Twig.token.definitions = [{
          type: Twig.token.type.raw,
          open: '{% raw %}',
          close: '{% endraw %}'
        }, {
          type: Twig.token.type.raw,
          open: '{% verbatim %}',
          close: '{% endverbatim %}'
        }, // *Whitespace type tokens*
        //
        // These typically take the form `{{- expression -}}` or `{{- expression }}` or `{{ expression -}}`.
        {
          type: Twig.token.type.output_whitespace_pre,
          open: '{{-',
          close: '}}'
        }, {
          type: Twig.token.type.output_whitespace_post,
          open: '{{',
          close: '-}}'
        }, {
          type: Twig.token.type.output_whitespace_both,
          open: '{{-',
          close: '-}}'
        }, {
          type: Twig.token.type.logic_whitespace_pre,
          open: '{%-',
          close: '%}'
        }, {
          type: Twig.token.type.logic_whitespace_post,
          open: '{%',
          close: '-%}'
        }, {
          type: Twig.token.type.logic_whitespace_both,
          open: '{%-',
          close: '-%}'
        }, // *Output type tokens*
        //
        // These typically take the form `{{ expression }}`.
        {
          type: Twig.token.type.output,
          open: '{{',
          close: '}}'
        }, // *Logic type tokens*
        //
        // These typically take a form like `{% if expression %}` or `{% endif %}`
        {
          type: Twig.token.type.logic,
          open: '{%',
          close: '%}'
        }, // *Comment type tokens*
        //
        // These take the form `{# anything #}`
        {
          type: Twig.token.type.comment,
          open: '{#',
          close: '#}'
        }];
        /**
         * What characters start "strings" in token definitions. We need this to ignore token close
         * strings inside an expression.
         */

        Twig.token.strings = ['"', "'"];

        Twig.token.findStart = function (template) {
          var output = {
            position: null,
            close_position: null,
            def: null
          },
              i,
              token_template,
              first_key_position,
              close_key_position;

          for (i = 0; i < Twig.token.definitions.length; i++) {
            token_template = Twig.token.definitions[i];
            first_key_position = template.indexOf(token_template.open);
            close_key_position = template.indexOf(token_template.close);
            Twig.log.trace("Twig.token.findStart: ", "Searching for ", token_template.open, " found at ", first_key_position); //Special handling for mismatched tokens

            if (first_key_position >= 0) {
              //This token matches the template
              if (token_template.open.length !== token_template.close.length) {
                //This token has mismatched closing and opening tags
                if (close_key_position < 0) {
                  //This token's closing tag does not match the template
                  continue;
                }
              }
            } // Does this token occur before any other types?


            if (first_key_position >= 0 && (output.position === null || first_key_position < output.position)) {
              output.position = first_key_position;
              output.def = token_template;
              output.close_position = close_key_position;
            } else if (first_key_position >= 0 && output.position !== null && first_key_position === output.position) {
              /*This token exactly matches another token,
              greedily match to check if this token has a greater specificity*/
              if (token_template.open.length > output.def.open.length) {
                //This token's opening tag is more specific than the previous match
                output.position = first_key_position;
                output.def = token_template;
                output.close_position = close_key_position;
              } else if (token_template.open.length === output.def.open.length) {
                if (token_template.close.length > output.def.close.length) {
                  //This token's opening tag is as specific as the previous match,
                  //but the closing tag has greater specificity
                  if (close_key_position >= 0 && close_key_position < output.close_position) {
                    //This token's closing tag exists in the template,
                    //and it occurs sooner than the previous match
                    output.position = first_key_position;
                    output.def = token_template;
                    output.close_position = close_key_position;
                  }
                } else if (close_key_position >= 0 && close_key_position < output.close_position) {
                  //This token's closing tag is not more specific than the previous match,
                  //but it occurs sooner than the previous match
                  output.position = first_key_position;
                  output.def = token_template;
                  output.close_position = close_key_position;
                }
              }
            }
          }

          delete output['close_position'];
          return output;
        };

        Twig.token.findEnd = function (template, token_def, start) {
          var end = null,
              found = false,
              offset = 0,
              // String position variables
          str_pos = null,
              str_found = null,
              pos = null,
              end_offset = null,
              this_str_pos = null,
              end_str_pos = null,
              // For loop variables
          i,
              l;

          while (!found) {
            str_pos = null;
            str_found = null;
            pos = template.indexOf(token_def.close, offset);

            if (pos >= 0) {
              end = pos;
              found = true;
            } else {
              // throw an exception
              throw new Twig.Error("Unable to find closing bracket '" + token_def.close + "'" + " opened near template position " + start);
            } // Ignore quotes within comments; just look for the next comment close sequence,
            // regardless of what comes before it. https://github.com/justjohn/twig.js/issues/95


            if (token_def.type === Twig.token.type.comment) {
              break;
            } // Ignore quotes within raw tag
            // Fixes #283


            if (token_def.type === Twig.token.type.raw) {
              break;
            }

            l = Twig.token.strings.length;

            for (i = 0; i < l; i += 1) {
              this_str_pos = template.indexOf(Twig.token.strings[i], offset);

              if (this_str_pos > 0 && this_str_pos < pos && (str_pos === null || this_str_pos < str_pos)) {
                str_pos = this_str_pos;
                str_found = Twig.token.strings[i];
              }
            } // We found a string before the end of the token, now find the string's end and set the search offset to it


            if (str_pos !== null) {
              end_offset = str_pos + 1;
              end = null;
              found = false;

              while (true) {
                end_str_pos = template.indexOf(str_found, end_offset);

                if (end_str_pos < 0) {
                  throw "Unclosed string in template";
                } // Ignore escaped quotes


                if (template.substr(end_str_pos - 1, 1) !== "\\") {
                  offset = end_str_pos + 1;
                  break;
                } else {
                  end_offset = end_str_pos + 1;
                }
              }
            }
          }

          return end;
        };
        /**
         * Convert a template into high-level tokens.
         */


        Twig.tokenize = function (template) {
          var tokens = [],
              // An offset for reporting errors locations in the template.
          error_offset = 0,
              // The start and type of the first token found in the template.
          found_token = null,
              // The end position of the matched token.
          end = null;

          while (template.length > 0) {
            // Find the first occurance of any token type in the template
            found_token = Twig.token.findStart(template);
            Twig.log.trace("Twig.tokenize: ", "Found token: ", found_token);

            if (found_token.position !== null) {
              // Add a raw type token for anything before the start of the token
              if (found_token.position > 0) {
                tokens.push({
                  type: Twig.token.type.raw,
                  value: template.substring(0, found_token.position)
                });
              }

              template = template.substr(found_token.position + found_token.def.open.length);
              error_offset += found_token.position + found_token.def.open.length; // Find the end of the token

              end = Twig.token.findEnd(template, found_token.def, error_offset);
              Twig.log.trace("Twig.tokenize: ", "Token ends at ", end);
              tokens.push({
                type: found_token.def.type,
                value: template.substring(0, end).trim()
              });

              if (template.substr(end + found_token.def.close.length, 1) === "\n") {
                switch (found_token.def.type) {
                  case "logic_whitespace_pre":
                  case "logic_whitespace_post":
                  case "logic_whitespace_both":
                  case "logic":
                    // Newlines directly after logic tokens are ignored
                    end += 1;
                    break;
                }
              }

              template = template.substr(end + found_token.def.close.length); // Increment the position in the template

              error_offset += end + found_token.def.close.length;
            } else {
              // No more tokens -> add the rest of the template as a raw-type token
              tokens.push({
                type: Twig.token.type.raw,
                value: template
              });
              template = '';
            }
          }

          return tokens;
        };

        Twig.compile = function (tokens) {
          try {
            // Output and intermediate stacks
            var output = [],
                stack = [],
                // The tokens between open and close tags
            intermediate_output = [],
                token = null,
                logic_token = null,
                unclosed_token = null,
                // Temporary previous token.
            prev_token = null,
                // Temporary previous output.
            prev_output = null,
                // Temporary previous intermediate output.
            prev_intermediate_output = null,
                // The previous token's template
            prev_template = null,
                // Token lookahead
            next_token = null,
                // The output token
            tok_output = null,
                // Logic Token values
            type = null,
                open = null,
                next = null;

            var compile_output = function compile_output(token) {
              Twig.expression.compile.apply(this, [token]);

              if (stack.length > 0) {
                intermediate_output.push(token);
              } else {
                output.push(token);
              }
            };

            var compile_logic = function compile_logic(token) {
              // Compile the logic token
              logic_token = Twig.logic.compile.apply(this, [token]);
              type = logic_token.type;
              open = Twig.logic.handler[type].open;
              next = Twig.logic.handler[type].next;
              Twig.log.trace("Twig.compile: ", "Compiled logic token to ", logic_token, " next is: ", next, " open is : ", open); // Not a standalone token, check logic stack to see if this is expected

              if (open !== undefined && !open) {
                prev_token = stack.pop();
                prev_template = Twig.logic.handler[prev_token.type];

                if (Twig.indexOf(prev_template.next, type) < 0) {
                  throw new Error(type + " not expected after a " + prev_token.type);
                }

                prev_token.output = prev_token.output || [];
                prev_token.output = prev_token.output.concat(intermediate_output);
                intermediate_output = [];
                tok_output = {
                  type: Twig.token.type.logic,
                  token: prev_token
                };

                if (stack.length > 0) {
                  intermediate_output.push(tok_output);
                } else {
                  output.push(tok_output);
                }
              } // This token requires additional tokens to complete the logic structure.


              if (next !== undefined && next.length > 0) {
                Twig.log.trace("Twig.compile: ", "Pushing ", logic_token, " to logic stack.");

                if (stack.length > 0) {
                  // Put any currently held output into the output list of the logic operator
                  // currently at the head of the stack before we push a new one on.
                  prev_token = stack.pop();
                  prev_token.output = prev_token.output || [];
                  prev_token.output = prev_token.output.concat(intermediate_output);
                  stack.push(prev_token);
                  intermediate_output = [];
                } // Push the new logic token onto the logic stack


                stack.push(logic_token);
              } else if (open !== undefined && open) {
                tok_output = {
                  type: Twig.token.type.logic,
                  token: logic_token
                }; // Standalone token (like {% set ... %}

                if (stack.length > 0) {
                  intermediate_output.push(tok_output);
                } else {
                  output.push(tok_output);
                }
              }
            };

            while (tokens.length > 0) {
              token = tokens.shift();
              prev_output = output[output.length - 1];
              prev_intermediate_output = intermediate_output[intermediate_output.length - 1];
              next_token = tokens[0];
              Twig.log.trace("Compiling token ", token);

              switch (token.type) {
                case Twig.token.type.raw:
                  if (stack.length > 0) {
                    intermediate_output.push(token);
                  } else {
                    output.push(token);
                  }

                  break;

                case Twig.token.type.logic:
                  compile_logic.call(this, token);
                  break;
                // Do nothing, comments should be ignored

                case Twig.token.type.comment:
                  break;

                case Twig.token.type.output:
                  compile_output.call(this, token);
                  break;
                //Kill whitespace ahead and behind this token

                case Twig.token.type.logic_whitespace_pre:
                case Twig.token.type.logic_whitespace_post:
                case Twig.token.type.logic_whitespace_both:
                case Twig.token.type.output_whitespace_pre:
                case Twig.token.type.output_whitespace_post:
                case Twig.token.type.output_whitespace_both:
                  if (token.type !== Twig.token.type.output_whitespace_post && token.type !== Twig.token.type.logic_whitespace_post) {
                    if (prev_output) {
                      //If the previous output is raw, pop it off
                      if (prev_output.type === Twig.token.type.raw) {
                        output.pop(); //If the previous output is not just whitespace, trim it

                        if (prev_output.value.match(/^\s*$/) === null) {
                          prev_output.value = prev_output.value.trim(); //Repush the previous output

                          output.push(prev_output);
                        }
                      }
                    }

                    if (prev_intermediate_output) {
                      //If the previous intermediate output is raw, pop it off
                      if (prev_intermediate_output.type === Twig.token.type.raw) {
                        intermediate_output.pop(); //If the previous output is not just whitespace, trim it

                        if (prev_intermediate_output.value.match(/^\s*$/) === null) {
                          prev_intermediate_output.value = prev_intermediate_output.value.trim(); //Repush the previous intermediate output

                          intermediate_output.push(prev_intermediate_output);
                        }
                      }
                    }
                  } //Compile this token


                  switch (token.type) {
                    case Twig.token.type.output_whitespace_pre:
                    case Twig.token.type.output_whitespace_post:
                    case Twig.token.type.output_whitespace_both:
                      compile_output.call(this, token);
                      break;

                    case Twig.token.type.logic_whitespace_pre:
                    case Twig.token.type.logic_whitespace_post:
                    case Twig.token.type.logic_whitespace_both:
                      compile_logic.call(this, token);
                      break;
                  }

                  if (token.type !== Twig.token.type.output_whitespace_pre && token.type !== Twig.token.type.logic_whitespace_pre) {
                    if (next_token) {
                      //If the next token is raw, shift it out
                      if (next_token.type === Twig.token.type.raw) {
                        tokens.shift(); //If the next token is not just whitespace, trim it

                        if (next_token.value.match(/^\s*$/) === null) {
                          next_token.value = next_token.value.trim(); //Unshift the next token

                          tokens.unshift(next_token);
                        }
                      }
                    }
                  }

                  break;
              }

              Twig.log.trace("Twig.compile: ", " Output: ", output, " Logic Stack: ", stack, " Pending Output: ", intermediate_output);
            } // Verify that there are no logic tokens left in the stack.


            if (stack.length > 0) {
              unclosed_token = stack.pop();
              throw new Error("Unable to find an end tag for " + unclosed_token.type + ", expecting one of " + unclosed_token.next);
            }

            return output;
          } catch (ex) {
            if (this.options.rethrow) {
              if (ex.type == 'TwigException' && !ex.file) {
                ex.file = this.id;
              }

              throw ex;
            } else {
              Twig.log.error("Error compiling twig template " + this.id + ": ");

              if (ex.stack) {
                Twig.log.error(ex.stack);
              } else {
                Twig.log.error(ex.toString());
              }
            }
          }
        };
        /**
         * Parse a compiled template.
         *
         * @param {Array} tokens The compiled tokens.
         * @param {Object} context The render context.
         *
         * @return {string} The parsed template.
         */


        Twig.parse = function (tokens, context, allow_async) {
          var that = this,
              output = [],
              // Store any error that might be thrown by the promise chain.
          err = null,
              // This will be set to is_async if template renders synchronously
          is_async = true,
              promise = null,
              // Track logic chains
          chain = true;

          function handleException(ex) {
            if (that.options.rethrow) {
              if (typeof ex === 'string') {
                ex = new Twig.Error(ex);
              }

              if (ex.type == 'TwigException' && !ex.file) {
                ex.file = that.id;
              }

              throw ex;
            } else {
              Twig.log.error("Error parsing twig template " + that.id + ": ");

              if (ex.stack) {
                Twig.log.error(ex.stack);
              } else {
                Twig.log.error(ex.toString());
              }

              if (Twig.debug) {
                return ex.toString();
              }
            }
          }

          promise = Twig.async.forEach(tokens, function parseToken(token) {
            Twig.log.debug("Twig.parse: ", "Parsing token: ", token);

            switch (token.type) {
              case Twig.token.type.raw:
                output.push(Twig.filters.raw(token.value));
                break;

              case Twig.token.type.logic:
                var logic_token = token.token;
                return Twig.logic.parseAsync.apply(that, [logic_token, context, chain]).then(function (logic) {
                  if (logic.chain !== undefined) {
                    chain = logic.chain;
                  }

                  if (logic.context !== undefined) {
                    context = logic.context;
                  }

                  if (logic.output !== undefined) {
                    output.push(logic.output);
                  }
                });
                break;

              case Twig.token.type.comment:
                // Do nothing, comments should be ignored
                break;
              //Fall through whitespace to output

              case Twig.token.type.output_whitespace_pre:
              case Twig.token.type.output_whitespace_post:
              case Twig.token.type.output_whitespace_both:
              case Twig.token.type.output:
                Twig.log.debug("Twig.parse: ", "Output token: ", token.stack); // Parse the given expression in the given context

                return Twig.expression.parseAsync.apply(that, [token.stack, context]).then(function (o) {
                  output.push(o);
                });
            }
          }).then(function () {
            output = Twig.output.apply(that, [output]);
            is_async = false;
            return output;
          }).catch(function (e) {
            if (allow_async) handleException(e);
            err = e;
          }); // If `allow_async` we will always return a promise since we do not
          // know in advance if we are going to run asynchronously or not.

          if (allow_async) return promise; // Handle errors here if we fail synchronously.

          if (err !== null) return handleException(err); // If `allow_async` is not true we should not allow the user
          // to use asynchronous functions or filters.

          if (is_async) throw new Twig.Error('You are using Twig.js in sync mode in combination with async extensions.');
          return output;
        };
        /**
         * Tokenize and compile a string template.
         *
         * @param {string} data The template.
         *
         * @return {Array} The compiled tokens.
         */


        Twig.prepare = function (data) {
          var tokens, raw_tokens; // Tokenize

          Twig.log.debug("Twig.prepare: ", "Tokenizing ", data);
          raw_tokens = Twig.tokenize.apply(this, [data]); // Compile

          Twig.log.debug("Twig.prepare: ", "Compiling ", raw_tokens);
          tokens = Twig.compile.apply(this, [raw_tokens]);
          Twig.log.debug("Twig.prepare: ", "Compiled ", tokens);
          return tokens;
        };
        /**
         * Join the output token's stack and escape it if needed
         *
         * @param {Array} Output token's stack
         *
         * @return {string|String} Autoescaped output
         */


        Twig.output = function (output) {
          if (!this.options.autoescape) {
            return output.join("");
          }

          var strategy = 'html';
          if (typeof this.options.autoescape == 'string') strategy = this.options.autoescape; // [].map would be better but it's not supported by IE8-

          var escaped_output = [];
          Twig.forEach(output, function (str) {
            if (str && str.twig_markup !== true && str.twig_markup != strategy) {
              str = Twig.filters.escape(str, [strategy]);
            }

            escaped_output.push(str);
          });
          return Twig.Markup(escaped_output.join(""));
        }; // Namespace for template storage and retrieval


        Twig.Templates = {
          /**
           * Registered template loaders - use Twig.Templates.registerLoader to add supported loaders
           * @type {Object}
           */
          loaders: {},

          /**
           * Registered template parsers - use Twig.Templates.registerParser to add supported parsers
           * @type {Object}
           */
          parsers: {},

          /**
           * Cached / loaded templates
           * @type {Object}
           */
          registry: {}
        };
        /**
         * Is this id valid for a twig template?
         *
         * @param {string} id The ID to check.
         *
         * @throws {Twig.Error} If the ID is invalid or used.
         * @return {boolean} True if the ID is valid.
         */

        Twig.validateId = function (id) {
          if (id === "prototype") {
            throw new Twig.Error(id + " is not a valid twig identifier");
          } else if (Twig.cache && Twig.Templates.registry.hasOwnProperty(id)) {
            throw new Twig.Error("There is already a template with the ID " + id);
          }

          return true;
        };
        /**
         * Register a template loader
         *
         * @example
         * Twig.extend(function(Twig) {
         *    Twig.Templates.registerLoader('custom_loader', function(location, params, callback, error_callback) {
         *        // ... load the template ...
         *        params.data = loadedTemplateData;
         *        // create and return the template
         *        var template = new Twig.Template(params);
         *        if (typeof callback === 'function') {
         *            callback(template);
         *        }
         *        return template;
         *    });
         * });
         *
         * @param {String} method_name The method this loader is intended for (ajax, fs)
         * @param {Function} func The function to execute when loading the template
         * @param {Object|undefined} scope Optional scope parameter to bind func to
         *
         * @throws Twig.Error
         *
         * @return {void}
         */


        Twig.Templates.registerLoader = function (method_name, func, scope) {
          if (typeof func !== 'function') {
            throw new Twig.Error('Unable to add loader for ' + method_name + ': Invalid function reference given.');
          }

          if (scope) {
            func = func.bind(scope);
          }

          this.loaders[method_name] = func;
        };
        /**
         * Remove a registered loader
         *
         * @param {String} method_name The method name for the loader you wish to remove
         *
         * @return {void}
         */


        Twig.Templates.unRegisterLoader = function (method_name) {
          if (this.isRegisteredLoader(method_name)) {
            delete this.loaders[method_name];
          }
        };
        /**
         * See if a loader is registered by its method name
         *
         * @param {String} method_name The name of the loader you are looking for
         *
         * @return {boolean}
         */


        Twig.Templates.isRegisteredLoader = function (method_name) {
          return this.loaders.hasOwnProperty(method_name);
        };
        /**
         * Register a template parser
         *
         * @example
         * Twig.extend(function(Twig) {
         *    Twig.Templates.registerParser('custom_parser', function(params) {
         *        // this template source can be accessed in params.data
         *        var template = params.data
         *
         *        // ... custom process that modifies the template
         *
         *        // return the parsed template
         *        return template;
         *    });
         * });
         *
         * @param {String} method_name The method this parser is intended for (twig, source)
         * @param {Function} func The function to execute when parsing the template
         * @param {Object|undefined} scope Optional scope parameter to bind func to
         *
         * @throws Twig.Error
         *
         * @return {void}
         */


        Twig.Templates.registerParser = function (method_name, func, scope) {
          if (typeof func !== 'function') {
            throw new Twig.Error('Unable to add parser for ' + method_name + ': Invalid function regerence given.');
          }

          if (scope) {
            func = func.bind(scope);
          }

          this.parsers[method_name] = func;
        };
        /**
         * Remove a registered parser
         *
         * @param {String} method_name The method name for the parser you wish to remove
         *
         * @return {void}
         */


        Twig.Templates.unRegisterParser = function (method_name) {
          if (this.isRegisteredParser(method_name)) {
            delete this.parsers[method_name];
          }
        };
        /**
         * See if a parser is registered by its method name
         *
         * @param {String} method_name The name of the parser you are looking for
         *
         * @return {boolean}
         */


        Twig.Templates.isRegisteredParser = function (method_name) {
          return this.parsers.hasOwnProperty(method_name);
        };
        /**
         * Save a template object to the store.
         *
         * @param {Twig.Template} template   The twig.js template to store.
         */


        Twig.Templates.save = function (template) {
          if (template.id === undefined) {
            throw new Twig.Error("Unable to save template with no id");
          }

          Twig.Templates.registry[template.id] = template;
        };
        /**
         * Load a previously saved template from the store.
         *
         * @param {string} id   The ID of the template to load.
         *
         * @return {Twig.Template} A twig.js template stored with the provided ID.
         */


        Twig.Templates.load = function (id) {
          if (!Twig.Templates.registry.hasOwnProperty(id)) {
            return null;
          }

          return Twig.Templates.registry[id];
        };
        /**
         * Load a template from a remote location using AJAX and saves in with the given ID.
         *
         * Available parameters:
         *
         *      async:       Should the HTTP request be performed asynchronously.
         *                      Defaults to true.
         *      method:      What method should be used to load the template
         *                      (fs or ajax)
         *      parser:      What method should be used to parse the template
         *                      (twig or source)
         *      precompiled: Has the template already been compiled.
         *
         * @param {string} location  The remote URL to load as a template.
         * @param {Object} params The template parameters.
         * @param {function} callback  A callback triggered when the template finishes loading.
         * @param {function} error_callback  A callback triggered if an error occurs loading the template.
         *
         *
         */


        Twig.Templates.loadRemote = function (location, params, callback, error_callback) {
          var loader; // Default to async

          if (params.async === undefined) {
            params.async = true;
          } // Default to the URL so the template is cached.


          if (params.id === undefined) {
            params.id = location;
          } // Check for existing template


          if (Twig.cache && Twig.Templates.registry.hasOwnProperty(params.id)) {
            // A template is already saved with the given id.
            if (typeof callback === 'function') {
              callback(Twig.Templates.registry[params.id]);
            } // TODO: if async, return deferred promise


            return Twig.Templates.registry[params.id];
          } //if the parser name hasn't been set, default it to twig


          params.parser = params.parser || 'twig'; // Assume 'fs' if the loader is not defined

          loader = this.loaders[params.method] || this.loaders.fs;
          return loader.apply(this, arguments);
        }; // Determine object type


        function is(type, obj) {
          var clas = Object.prototype.toString.call(obj).slice(8, -1);
          return obj !== undefined && obj !== null && clas === type;
        }
        /**
         * Create a new twig.js template.
         *
         * Parameters: {
         *      data:   The template, either pre-compiled tokens or a string template
         *      id:     The name of this template
         *      blocks: Any pre-existing block from a child template
         * }
         *
         * @param {Object} params The template parameters.
         */


        Twig.Template = function (params) {
          var data = params.data,
              id = params.id,
              blocks = params.blocks,
              macros = params.macros || {},
              base = params.base,
              path = params.path,
              url = params.url,
              name = params.name,
              method = params.method,
              // parser options
          options = params.options; // # What is stored in a Twig.Template
          //
          // The Twig Template hold several chucks of data.
          //
          //     {
          //          id:     The token ID (if any)
          //          tokens: The list of tokens that makes up this template.
          //          blocks: The list of block this template contains.
          //          base:   The base template (if any)
          //            options:  {
          //                Compiler/parser options
          //
          //                strict_variables: true/false
          //                    Should missing variable/keys emit an error message. If false, they default to null.
          //            }
          //     }
          //

          this.id = id;
          this.method = method;
          this.base = base;
          this.path = path;
          this.url = url;
          this.name = name;
          this.macros = macros;
          this.options = options;
          this.reset(blocks);

          if (is('String', data)) {
            this.tokens = Twig.prepare.apply(this, [data]);
          } else {
            this.tokens = data;
          }

          if (id !== undefined) {
            Twig.Templates.save(this);
          }
        };

        Twig.Template.prototype.reset = function (blocks) {
          Twig.log.debug("Twig.Template.reset", "Reseting template " + this.id);
          this.blocks = {};
          this.importedBlocks = [];
          this.originalBlockTokens = {};
          this.child = {
            blocks: blocks || {}
          };
          this.extend = null;
        };

        Twig.Template.prototype.render = function (context, params, allow_async) {
          params = params || {};
          var that = this,
              // Store any error that might be thrown by the promise chain.
          err = null,
              // This will be set to is_async if template renders synchronously
          is_async = true,
              promise = null,
              result,
              url;
          this.context = context || {}; // Clear any previous state

          this.reset();

          if (params.blocks) {
            this.blocks = params.blocks;
          }

          if (params.macros) {
            this.macros = params.macros;
          }

          var cb = function cb(output) {
            // Does this template extend another
            if (that.extend) {
              var ext_template; // check if the template is provided inline

              if (that.options.allowInlineIncludes) {
                ext_template = Twig.Templates.load(that.extend);

                if (ext_template) {
                  ext_template.options = that.options;
                }
              } // check for the template file via include


              if (!ext_template) {
                url = Twig.path.parsePath(that, that.extend);
                ext_template = Twig.Templates.loadRemote(url, {
                  method: that.getLoaderMethod(),
                  base: that.base,
                  async: false,
                  id: url,
                  options: that.options
                });
              }

              that.parent = ext_template;
              return that.parent.renderAsync(that.context, {
                blocks: that.blocks
              });
            }

            if (params.output == 'blocks') {
              return that.blocks;
            } else if (params.output == 'macros') {
              return that.macros;
            } else {
              return output;
            }
          };

          promise = Twig.parseAsync.apply(this, [this.tokens, this.context]).then(cb).then(function (v) {
            is_async = false;
            result = v;
            return v;
          }).catch(function (e) {
            if (allow_async) throw e;
            err = e;
          }); // If `allow_async` we will always return a promise since we do not
          // know in advance if we are going to run asynchronously or not.

          if (allow_async) return promise; // Handle errors here if we fail synchronously.

          if (err !== null) throw err; // If `allow_async` is not true we should not allow the user
          // to use asynchronous functions or filters.

          if (is_async) throw new Twig.Error('You are using Twig.js in sync mode in combination with async extensions.');
          return result;
        };

        Twig.Template.prototype.importFile = function (file) {
          var url, sub_template;

          if (!this.url && this.options.allowInlineIncludes) {
            file = this.path ? Twig.path.parsePath(this, file) : file;
            sub_template = Twig.Templates.load(file);

            if (!sub_template) {
              sub_template = Twig.Templates.loadRemote(url, {
                id: file,
                method: this.getLoaderMethod(),
                async: false,
                path: file,
                options: this.options
              });

              if (!sub_template) {
                throw new Twig.Error("Unable to find the template " + file);
              }
            }

            sub_template.options = this.options;
            return sub_template;
          }

          url = Twig.path.parsePath(this, file); // Load blocks from an external file

          sub_template = Twig.Templates.loadRemote(url, {
            method: this.getLoaderMethod(),
            base: this.base,
            async: false,
            options: this.options,
            id: url
          });
          return sub_template;
        };

        Twig.Template.prototype.importBlocks = function (file, override) {
          var sub_template = this.importFile(file),
              context = this.context,
              that = this,
              key;
          override = override || false;
          sub_template.render(context); // Mixin blocks

          Twig.forEach(Object.keys(sub_template.blocks), function (key) {
            if (override || that.blocks[key] === undefined) {
              that.blocks[key] = sub_template.blocks[key];
              that.importedBlocks.push(key);
            }
          });
        };

        Twig.Template.prototype.importMacros = function (file) {
          var url = Twig.path.parsePath(this, file); // load remote template

          var remoteTemplate = Twig.Templates.loadRemote(url, {
            method: this.getLoaderMethod(),
            async: false,
            id: url
          });
          return remoteTemplate;
        };

        Twig.Template.prototype.getLoaderMethod = function () {
          if (this.path) {
            return 'fs';
          }

          if (this.url) {
            return 'ajax';
          }

          return this.method || 'fs';
        };

        Twig.Template.prototype.compile = function (options) {
          // compile the template into raw JS
          return Twig.compiler.compile(this, options);
        };
        /**
         * Create safe output
         *
         * @param {string} Content safe to output
         *
         * @return {String} Content wrapped into a String
         */


        Twig.Markup = function (content, strategy) {
          if (typeof strategy == 'undefined') {
            strategy = true;
          }

          if (typeof content === 'string' && content.length > 0) {
            content = new String(content);
            content.twig_markup = strategy;
          }

          return content;
        };

        return Twig;
      };
      /***/

    },
    /* 2 */

    /***/
    function (module, exports) {
      // ## twig.compiler.js
      //
      // This file handles compiling templates into JS
      module.exports = function (Twig) {
        /**
         * Namespace for compilation.
         */
        Twig.compiler = {
          module: {}
        }; // Compile a Twig Template to output.

        Twig.compiler.compile = function (template, options) {
          // Get tokens
          var tokens = JSON.stringify(template.tokens),
              id = template.id,
              output;

          if (options.module) {
            if (Twig.compiler.module[options.module] === undefined) {
              throw new Twig.Error("Unable to find module type " + options.module);
            }

            output = Twig.compiler.module[options.module](id, tokens, options.twig);
          } else {
            output = Twig.compiler.wrap(id, tokens);
          }

          return output;
        };

        Twig.compiler.module = {
          amd: function amd(id, tokens, pathToTwig) {
            return 'define(["' + pathToTwig + '"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = ' + Twig.compiler.wrap(id, tokens) + '\n\treturn templates;\n});';
          },
          node: function node(id, tokens) {
            return 'var twig = require("twig").twig;\n' + 'exports.template = ' + Twig.compiler.wrap(id, tokens);
          },
          cjs2: function cjs2(id, tokens, pathToTwig) {
            return 'module.declare([{ twig: "' + pathToTwig + '" }], function (require, exports, module) {\n' + '\tvar twig = require("twig").twig;\n' + '\texports.template = ' + Twig.compiler.wrap(id, tokens) + '\n});';
          }
        };

        Twig.compiler.wrap = function (id, tokens) {
          return 'twig({id:"' + id.replace('"', '\\"') + '", data:' + tokens + ', precompiled: true});\n';
        };

        return Twig;
      };
      /***/

    },
    /* 3 */

    /***/
    function (module, exports, __webpack_require__) {
      // ## twig.expression.js
      //
      // This file handles tokenizing, compiling and parsing expressions.
      module.exports = function (Twig) {
        "use strict";

        function parseParams(thisArg, params, context) {
          if (params) return Twig.expression.parseAsync.apply(thisArg, [params, context]);
          return Twig.Promise.resolve(false);
        }
        /**
         * Namespace for expression handling.
         */


        Twig.expression = {};

        __webpack_require__(4)(Twig);
        /**
         * Reserved word that can't be used as variable names.
         */


        Twig.expression.reservedWords = ["true", "false", "null", "TRUE", "FALSE", "NULL", "_context", "and", "b-and", "or", "b-or", "b-xor", "in", "not in", "if"];
        /**
         * The type of tokens used in expressions.
         */

        Twig.expression.type = {
          comma: 'Twig.expression.type.comma',
          operator: {
            unary: 'Twig.expression.type.operator.unary',
            binary: 'Twig.expression.type.operator.binary'
          },
          string: 'Twig.expression.type.string',
          bool: 'Twig.expression.type.bool',
          slice: 'Twig.expression.type.slice',
          array: {
            start: 'Twig.expression.type.array.start',
            end: 'Twig.expression.type.array.end'
          },
          object: {
            start: 'Twig.expression.type.object.start',
            end: 'Twig.expression.type.object.end'
          },
          parameter: {
            start: 'Twig.expression.type.parameter.start',
            end: 'Twig.expression.type.parameter.end'
          },
          subexpression: {
            start: 'Twig.expression.type.subexpression.start',
            end: 'Twig.expression.type.subexpression.end'
          },
          key: {
            period: 'Twig.expression.type.key.period',
            brackets: 'Twig.expression.type.key.brackets'
          },
          filter: 'Twig.expression.type.filter',
          _function: 'Twig.expression.type._function',
          variable: 'Twig.expression.type.variable',
          number: 'Twig.expression.type.number',
          _null: 'Twig.expression.type.null',
          context: 'Twig.expression.type.context',
          test: 'Twig.expression.type.test'
        };
        Twig.expression.set = {
          // What can follow an expression (in general)
          operations: [Twig.expression.type.filter, Twig.expression.type.operator.unary, Twig.expression.type.operator.binary, Twig.expression.type.array.end, Twig.expression.type.object.end, Twig.expression.type.parameter.end, Twig.expression.type.subexpression.end, Twig.expression.type.comma, Twig.expression.type.test],
          expressions: [Twig.expression.type._function, Twig.expression.type.bool, Twig.expression.type.string, Twig.expression.type.variable, Twig.expression.type.number, Twig.expression.type._null, Twig.expression.type.context, Twig.expression.type.parameter.start, Twig.expression.type.array.start, Twig.expression.type.object.start, Twig.expression.type.subexpression.start, Twig.expression.type.operator.unary]
        }; // Most expressions allow a '.' or '[' after them, so we provide a convenience set

        Twig.expression.set.operations_extended = Twig.expression.set.operations.concat([Twig.expression.type.key.period, Twig.expression.type.key.brackets, Twig.expression.type.slice]); // Some commonly used compile and parse functions.

        Twig.expression.fn = {
          compile: {
            push: function push(token, stack, output) {
              output.push(token);
            },
            push_both: function push_both(token, stack, output) {
              output.push(token);
              stack.push(token);
            }
          },
          parse: {
            push: function push(token, stack, context) {
              stack.push(token);
            },
            push_value: function push_value(token, stack, context) {
              stack.push(token.value);
            }
          }
        }; // The regular expressions and compile/parse logic used to match tokens in expressions.
        //
        // Properties:
        //
        //      type:  The type of expression this matches
        //
        //      regex: One or more regular expressions that matche the format of the token.
        //
        //      next:  Valid tokens that can occur next in the expression.
        //
        // Functions:
        //
        //      compile: A function that compiles the raw regular expression match into a token.
        //
        //      parse:   A function that parses the compiled token into output.
        //

        Twig.expression.definitions = [{
          type: Twig.expression.type.test,
          regex: /^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*(\s?as)?)/,
          next: Twig.expression.set.operations.concat([Twig.expression.type.parameter.start]),
          compile: function compile(token, stack, output) {
            token.filter = token.match[2];
            token.modifier = token.match[1];
            delete token.match;
            delete token.value;
            output.push(token);
          },
          parse: function parse(token, stack, context) {
            var value = stack.pop();
            return parseParams(this, token.params, context).then(function (params) {
              var result = Twig.test(token.filter, value, params);

              if (token.modifier == 'not') {
                stack.push(!result);
              } else {
                stack.push(result);
              }
            });
          }
        }, {
          type: Twig.expression.type.comma,
          // Match a comma
          regex: /^,/,
          next: Twig.expression.set.expressions.concat([Twig.expression.type.array.end, Twig.expression.type.object.end]),
          compile: function compile(token, stack, output) {
            var i = stack.length - 1,
                stack_token;
            delete token.match;
            delete token.value; // pop tokens off the stack until the start of the object

            for (; i >= 0; i--) {
              stack_token = stack.pop();

              if (stack_token.type === Twig.expression.type.object.start || stack_token.type === Twig.expression.type.parameter.start || stack_token.type === Twig.expression.type.array.start) {
                stack.push(stack_token);
                break;
              }

              output.push(stack_token);
            }

            output.push(token);
          }
        }, {
          /**
           * Match a number (integer or decimal)
           */
          type: Twig.expression.type.number,
          // match a number
          regex: /^\-?\d+(\.\d+)?/,
          next: Twig.expression.set.operations,
          compile: function compile(token, stack, output) {
            token.value = Number(token.value);
            output.push(token);
          },
          parse: Twig.expression.fn.parse.push_value
        }, {
          type: Twig.expression.type.operator.binary,
          // Match any of ?:, +, *, /, -, %, ~, <, <=, >, >=, !=, ==, **, ?, :, and, b-and, or, b-or, b-xor, in, not in
          // and, or, in, not in can be followed by a space or parenthesis
          regex: /(^\?\:|^(b\-and)|^(b\-or)|^(b\-xor)|^[\+\-~%\?]|^[\:](?!\d\])|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^(and)[\(|\s+]|^(or)[\(|\s+]|^(in)[\(|\s+]|^(not in)[\(|\s+]|^\.\.)/,
          next: Twig.expression.set.expressions,
          transform: function transform(match, tokens) {
            switch (match[0]) {
              case 'and(':
              case 'or(':
              case 'in(':
              case 'not in(':
                //Strip off the ( if it exists
                tokens[tokens.length - 1].value = match[2];
                return match[0];
                break;

              default:
                return '';
            }
          },
          compile: function compile(token, stack, output) {
            delete token.match;
            token.value = token.value.trim();
            var value = token.value,
                operator = Twig.expression.operator.lookup(value, token);
            Twig.log.trace("Twig.expression.compile: ", "Operator: ", operator, " from ", value);

            while (stack.length > 0 && (stack[stack.length - 1].type == Twig.expression.type.operator.unary || stack[stack.length - 1].type == Twig.expression.type.operator.binary) && (operator.associativity === Twig.expression.operator.leftToRight && operator.precidence >= stack[stack.length - 1].precidence || operator.associativity === Twig.expression.operator.rightToLeft && operator.precidence > stack[stack.length - 1].precidence)) {
              var temp = stack.pop();
              output.push(temp);
            }

            if (value === ":") {
              // Check if this is a ternary or object key being set
              if (stack[stack.length - 1] && stack[stack.length - 1].value === "?") {// Continue as normal for a ternary
              } else {
                // This is not a ternary so we push the token to the output where it can be handled
                //   when the assocated object is closed.
                var key_token = output.pop();

                if (key_token.type === Twig.expression.type.string || key_token.type === Twig.expression.type.variable) {
                  token.key = key_token.value;
                } else if (key_token.type === Twig.expression.type.number) {
                  // Convert integer keys into string keys
                  token.key = key_token.value.toString();
                } else if (key_token.expression && (key_token.type === Twig.expression.type.parameter.end || key_token.type == Twig.expression.type.subexpression.end)) {
                  token.params = key_token.params;
                } else {
                  throw new Twig.Error("Unexpected value before ':' of " + key_token.type + " = " + key_token.value);
                }

                output.push(token);
                return;
              }
            } else {
              stack.push(operator);
            }
          },
          parse: function parse(token, stack, context) {
            if (token.key) {
              // handle ternary ':' operator
              stack.push(token);
            } else if (token.params) {
              // handle "{(expression):value}"
              return Twig.expression.parseAsync.apply(this, [token.params, context]).then(function (key) {
                token.key = key;
                stack.push(token); //If we're in a loop, we might need token.params later, especially in this form of "(expression):value"

                if (!context.loop) {
                  delete token.params;
                }
              });
            } else {
              Twig.expression.operator.parse(token.value, stack);
            }
          }
        }, {
          type: Twig.expression.type.operator.unary,
          // Match any of not
          regex: /(^not\s+)/,
          next: Twig.expression.set.expressions,
          compile: function compile(token, stack, output) {
            delete token.match;
            token.value = token.value.trim();
            var value = token.value,
                operator = Twig.expression.operator.lookup(value, token);
            Twig.log.trace("Twig.expression.compile: ", "Operator: ", operator, " from ", value);

            while (stack.length > 0 && (stack[stack.length - 1].type == Twig.expression.type.operator.unary || stack[stack.length - 1].type == Twig.expression.type.operator.binary) && (operator.associativity === Twig.expression.operator.leftToRight && operator.precidence >= stack[stack.length - 1].precidence || operator.associativity === Twig.expression.operator.rightToLeft && operator.precidence > stack[stack.length - 1].precidence)) {
              var temp = stack.pop();
              output.push(temp);
            }

            stack.push(operator);
          },
          parse: function parse(token, stack, context) {
            Twig.expression.operator.parse(token.value, stack);
          }
        }, {
          /**
           * Match a string. This is anything between a pair of single or double quotes.
           */
          type: Twig.expression.type.string,
          // See: http://blog.stevenlevithan.com/archives/match-quoted-string
          regex: /^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,
          next: Twig.expression.set.operations_extended,
          compile: function compile(token, stack, output) {
            var value = token.value;
            delete token.match; // Remove the quotes from the string

            if (value.substring(0, 1) === '"') {
              value = value.replace('\\"', '"');
            } else {
              value = value.replace("\\'", "'");
            }

            token.value = value.substring(1, value.length - 1).replace(/\\n/g, "\n").replace(/\\r/g, "\r");
            Twig.log.trace("Twig.expression.compile: ", "String value: ", token.value);
            output.push(token);
          },
          parse: Twig.expression.fn.parse.push_value
        }, {
          /**
           * Match a subexpression set start.
           */
          type: Twig.expression.type.subexpression.start,
          regex: /^\(/,
          next: Twig.expression.set.expressions.concat([Twig.expression.type.subexpression.end]),
          compile: function compile(token, stack, output) {
            token.value = '(';
            output.push(token);
            stack.push(token);
          },
          parse: Twig.expression.fn.parse.push
        }, {
          /**
           * Match a subexpression set end.
           */
          type: Twig.expression.type.subexpression.end,
          regex: /^\)/,
          next: Twig.expression.set.operations_extended,
          validate: function validate(match, tokens) {
            // Iterate back through previous tokens to ensure we follow a subexpression start
            var i = tokens.length - 1,
                found_subexpression_start = false,
                next_subexpression_start_invalid = false,
                unclosed_parameter_count = 0;

            while (!found_subexpression_start && i >= 0) {
              var token = tokens[i];
              found_subexpression_start = token.type === Twig.expression.type.subexpression.start; // If we have previously found a subexpression end, then this subexpression start is the start of
              // that subexpression, not the subexpression we are searching for

              if (found_subexpression_start && next_subexpression_start_invalid) {
                next_subexpression_start_invalid = false;
                found_subexpression_start = false;
              } // Count parameter tokens to ensure we dont return truthy for a parameter opener


              if (token.type === Twig.expression.type.parameter.start) {
                unclosed_parameter_count++;
              } else if (token.type === Twig.expression.type.parameter.end) {
                unclosed_parameter_count--;
              } else if (token.type === Twig.expression.type.subexpression.end) {
                next_subexpression_start_invalid = true;
              }

              i--;
            } // If we found unclosed parameters, return false
            // If we didnt find subexpression start, return false
            // Otherwise return true


            return found_subexpression_start && unclosed_parameter_count === 0;
          },
          compile: function compile(token, stack, output) {
            // This is basically a copy of parameter end compilation
            var stack_token,
                end_token = token;
            stack_token = stack.pop();

            while (stack.length > 0 && stack_token.type != Twig.expression.type.subexpression.start) {
              output.push(stack_token);
              stack_token = stack.pop();
            } // Move contents of parens into preceding filter


            var param_stack = [];

            while (token.type !== Twig.expression.type.subexpression.start) {
              // Add token to arguments stack
              param_stack.unshift(token);
              token = output.pop();
            }

            param_stack.unshift(token);
            var is_expression = false; //If the token at the top of the *stack* is a function token, pop it onto the output queue.
            // Get the token preceding the parameters

            stack_token = stack[stack.length - 1];

            if (stack_token === undefined || stack_token.type !== Twig.expression.type._function && stack_token.type !== Twig.expression.type.filter && stack_token.type !== Twig.expression.type.test && stack_token.type !== Twig.expression.type.key.brackets) {
              end_token.expression = true; // remove start and end token from stack

              param_stack.pop();
              param_stack.shift();
              end_token.params = param_stack;
              output.push(end_token);
            } else {
              // This should never be hit
              end_token.expression = false;
              stack_token.params = param_stack;
            }
          },
          parse: function parse(token, stack, context) {
            var new_array = [],
                array_ended = false,
                value = null;

            if (token.expression) {
              return Twig.expression.parseAsync.apply(this, [token.params, context]).then(function (value) {
                stack.push(value);
              });
            } else {
              throw new Twig.Error("Unexpected subexpression end when token is not marked as an expression");
            }
          }
        }, {
          /**
           * Match a parameter set start.
           */
          type: Twig.expression.type.parameter.start,
          regex: /^\(/,
          next: Twig.expression.set.expressions.concat([Twig.expression.type.parameter.end]),
          validate: function validate(match, tokens) {
            var last_token = tokens[tokens.length - 1]; // We can't use the regex to test if we follow a space because expression is trimmed

            return last_token && Twig.indexOf(Twig.expression.reservedWords, last_token.value.trim()) < 0;
          },
          compile: Twig.expression.fn.compile.push_both,
          parse: Twig.expression.fn.parse.push
        }, {
          /**
           * Match a parameter set end.
           */
          type: Twig.expression.type.parameter.end,
          regex: /^\)/,
          next: Twig.expression.set.operations_extended,
          compile: function compile(token, stack, output) {
            var stack_token,
                end_token = token;
            stack_token = stack.pop();

            while (stack.length > 0 && stack_token.type != Twig.expression.type.parameter.start) {
              output.push(stack_token);
              stack_token = stack.pop();
            } // Move contents of parens into preceding filter


            var param_stack = [];

            while (token.type !== Twig.expression.type.parameter.start) {
              // Add token to arguments stack
              param_stack.unshift(token);
              token = output.pop();
            }

            param_stack.unshift(token);
            var is_expression = false; // Get the token preceding the parameters

            token = output[output.length - 1];

            if (token === undefined || token.type !== Twig.expression.type._function && token.type !== Twig.expression.type.filter && token.type !== Twig.expression.type.test && token.type !== Twig.expression.type.key.brackets) {
              end_token.expression = true; // remove start and end token from stack

              param_stack.pop();
              param_stack.shift();
              end_token.params = param_stack;
              output.push(end_token);
            } else {
              end_token.expression = false;
              token.params = param_stack;
            }
          },
          parse: function parse(token, stack, context) {
            var new_array = [],
                array_ended = false,
                value = null;

            if (token.expression) {
              return Twig.expression.parseAsync.apply(this, [token.params, context]).then(function (value) {
                stack.push(value);
              });
            } else {
              while (stack.length > 0) {
                value = stack.pop(); // Push values into the array until the start of the array

                if (value && value.type && value.type == Twig.expression.type.parameter.start) {
                  array_ended = true;
                  break;
                }

                new_array.unshift(value);
              }

              if (!array_ended) {
                throw new Twig.Error("Expected end of parameter set.");
              }

              stack.push(new_array);
            }
          }
        }, {
          type: Twig.expression.type.slice,
          regex: /^\[(\d*\:\d*)\]/,
          next: Twig.expression.set.operations_extended,
          compile: function compile(token, stack, output) {
            var sliceRange = token.match[1].split(':'); //sliceStart can be undefined when we pass parameters to the slice filter later

            var sliceStart = sliceRange[0] ? parseInt(sliceRange[0]) : undefined;
            var sliceEnd = sliceRange[1] ? parseInt(sliceRange[1]) : undefined;
            token.value = 'slice';
            token.params = [sliceStart, sliceEnd]; //sliceEnd can't be undefined as the slice filter doesn't check for this, but it does check the length
            //of the params array, so just shorten it.

            if (!sliceEnd) {
              token.params = [sliceStart];
            }

            output.push(token);
          },
          parse: function parse(token, stack, context) {
            var input = stack.pop(),
                params = token.params;
            stack.push(Twig.filter.apply(this, [token.value, input, params]));
          }
        }, {
          /**
           * Match an array start.
           */
          type: Twig.expression.type.array.start,
          regex: /^\[/,
          next: Twig.expression.set.expressions.concat([Twig.expression.type.array.end]),
          compile: Twig.expression.fn.compile.push_both,
          parse: Twig.expression.fn.parse.push
        }, {
          /**
           * Match an array end.
           */
          type: Twig.expression.type.array.end,
          regex: /^\]/,
          next: Twig.expression.set.operations_extended,
          compile: function compile(token, stack, output) {
            var i = stack.length - 1,
                stack_token; // pop tokens off the stack until the start of the object

            for (; i >= 0; i--) {
              stack_token = stack.pop();

              if (stack_token.type === Twig.expression.type.array.start) {
                break;
              }

              output.push(stack_token);
            }

            output.push(token);
          },
          parse: function parse(token, stack, context) {
            var new_array = [],
                array_ended = false,
                value = null;

            while (stack.length > 0) {
              value = stack.pop(); // Push values into the array until the start of the array

              if (value.type && value.type == Twig.expression.type.array.start) {
                array_ended = true;
                break;
              }

              new_array.unshift(value);
            }

            if (!array_ended) {
              throw new Twig.Error("Expected end of array.");
            }

            stack.push(new_array);
          }
        }, // Token that represents the start of a hash map '}'
        //
        // Hash maps take the form:
        //    { "key": 'value', "another_key": item }
        //
        // Keys must be quoted (either single or double) and values can be any expression.
        {
          type: Twig.expression.type.object.start,
          regex: /^\{/,
          next: Twig.expression.set.expressions.concat([Twig.expression.type.object.end]),
          compile: Twig.expression.fn.compile.push_both,
          parse: Twig.expression.fn.parse.push
        }, // Token that represents the end of a Hash Map '}'
        //
        // This is where the logic for building the internal
        // representation of a hash map is defined.
        {
          type: Twig.expression.type.object.end,
          regex: /^\}/,
          next: Twig.expression.set.operations_extended,
          compile: function compile(token, stack, output) {
            var i = stack.length - 1,
                stack_token; // pop tokens off the stack until the start of the object

            for (; i >= 0; i--) {
              stack_token = stack.pop();

              if (stack_token && stack_token.type === Twig.expression.type.object.start) {
                break;
              }

              output.push(stack_token);
            }

            output.push(token);
          },
          parse: function parse(end_token, stack, context) {
            var new_object = {},
                object_ended = false,
                token = null,
                token_key = null,
                has_value = false,
                value = null;

            while (stack.length > 0) {
              token = stack.pop(); // Push values into the array until the start of the object

              if (token && token.type && token.type === Twig.expression.type.object.start) {
                object_ended = true;
                break;
              }

              if (token && token.type && (token.type === Twig.expression.type.operator.binary || token.type === Twig.expression.type.operator.unary) && token.key) {
                if (!has_value) {
                  throw new Twig.Error("Missing value for key '" + token.key + "' in object definition.");
                }

                new_object[token.key] = value; // Preserve the order that elements are added to the map
                // This is necessary since JavaScript objects don't
                // guarantee the order of keys

                if (new_object._keys === undefined) new_object._keys = [];

                new_object._keys.unshift(token.key); // reset value check


                value = null;
                has_value = false;
              } else {
                has_value = true;
                value = token;
              }
            }

            if (!object_ended) {
              throw new Twig.Error("Unexpected end of object.");
            }

            stack.push(new_object);
          }
        }, // Token representing a filter
        //
        // Filters can follow any expression and take the form:
        //    expression|filter(optional, args)
        //
        // Filter parsing is done in the Twig.filters namespace.
        {
          type: Twig.expression.type.filter,
          // match a | then a letter or _, then any number of letters, numbers, _ or -
          regex: /^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,
          next: Twig.expression.set.operations_extended.concat([Twig.expression.type.parameter.start]),
          compile: function compile(token, stack, output) {
            token.value = token.match[1];
            output.push(token);
          },
          parse: function parse(token, stack, context) {
            var that = this,
                input = stack.pop();
            return parseParams(this, token.params, context).then(function (params) {
              return Twig.filter.apply(that, [token.value, input, params]);
            }).then(function (value) {
              stack.push(value);
            });
          }
        }, {
          type: Twig.expression.type._function,
          // match any letter or _, then any number of letters, numbers, _ or - followed by (
          regex: /^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,
          next: Twig.expression.type.parameter.start,
          validate: function validate(match, tokens) {
            // Make sure this function is not a reserved word
            return match[1] && Twig.indexOf(Twig.expression.reservedWords, match[1]) < 0;
          },
          transform: function transform(match, tokens) {
            return '(';
          },
          compile: function compile(token, stack, output) {
            var fn = token.match[1];
            token.fn = fn; // cleanup token

            delete token.match;
            delete token.value;
            output.push(token);
          },
          parse: function parse(token, stack, context) {
            var that = this,
                fn = token.fn,
                value;
            return parseParams(this, token.params, context).then(function (params) {
              if (Twig.functions[fn]) {
                // Get the function from the built-in functions
                value = Twig.functions[fn].apply(that, params);
              } else if (typeof context[fn] == 'function') {
                // Get the function from the user/context defined functions
                value = context[fn].apply(context, params);
              } else {
                throw new Twig.Error(fn + ' function does not exist and is not defined in the context');
              }

              return value;
            }).then(function (result) {
              stack.push(result);
            });
          }
        }, // Token representing a variable.
        //
        // Variables can contain letters, numbers, underscores and
        // dashes, but must start with a letter or underscore.
        //
        // Variables are retrieved from the render context and take
        // the value of 'undefined' if the given variable doesn't
        // exist in the context.
        {
          type: Twig.expression.type.variable,
          // match any letter or _, then any number of letters, numbers, _ or -
          regex: /^[a-zA-Z_][a-zA-Z0-9_]*/,
          next: Twig.expression.set.operations_extended.concat([Twig.expression.type.parameter.start]),
          compile: Twig.expression.fn.compile.push,
          validate: function validate(match, tokens) {
            return Twig.indexOf(Twig.expression.reservedWords, match[0]) < 0;
          },
          parse: function parse(token, stack, context) {
            // Get the variable from the context
            return Twig.expression.resolveAsync.apply(this, [context[token.value], context]).then(function (value) {
              stack.push(value);
            });
          }
        }, {
          type: Twig.expression.type.key.period,
          regex: /^\.([a-zA-Z0-9_]+)/,
          next: Twig.expression.set.operations_extended.concat([Twig.expression.type.parameter.start]),
          compile: function compile(token, stack, output) {
            token.key = token.match[1];
            delete token.match;
            delete token.value;
            output.push(token);
          },
          parse: function parse(token, stack, context, next_token) {
            var that = this,
                key = token.key,
                object = stack.pop(),
                value;
            return parseParams(this, token.params, context).then(function (params) {
              if (object === null || object === undefined) {
                if (that.options.strict_variables) {
                  throw new Twig.Error("Can't access a key " + key + " on an null or undefined object.");
                } else {
                  value = undefined;
                }
              } else {
                var capitalize = function capitalize(value) {
                  return value.substr(0, 1).toUpperCase() + value.substr(1);
                }; // Get the variable from the context


                if (_typeof2(object) === 'object' && key in object) {
                  value = object[key];
                } else if (object["get" + capitalize(key)] !== undefined) {
                  value = object["get" + capitalize(key)];
                } else if (object["is" + capitalize(key)] !== undefined) {
                  value = object["is" + capitalize(key)];
                } else {
                  value = undefined;
                }
              } // When resolving an expression we need to pass next_token in case the expression is a function


              return Twig.expression.resolveAsync.apply(that, [value, context, params, next_token, object]);
            }).then(function (result) {
              stack.push(result);
            });
          }
        }, {
          type: Twig.expression.type.key.brackets,
          regex: /^\[([^\]\:]*)\]/,
          next: Twig.expression.set.operations_extended.concat([Twig.expression.type.parameter.start]),
          compile: function compile(token, stack, output) {
            var match = token.match[1];
            delete token.value;
            delete token.match; // The expression stack for the key

            token.stack = Twig.expression.compile({
              value: match
            }).stack;
            output.push(token);
          },
          parse: function parse(token, stack, context, next_token) {
            // Evaluate key
            var that = this,
                params = null,
                object,
                value;
            return parseParams(this, token.params, context).then(function (parameters) {
              params = parameters;
              return Twig.expression.parseAsync.apply(that, [token.stack, context]);
            }).then(function (key) {
              object = stack.pop();

              if (object === null || object === undefined) {
                if (that.options.strict_variables) {
                  throw new Twig.Error("Can't access a key " + key + " on an null or undefined object.");
                } else {
                  return null;
                }
              } // Get the variable from the context


              if (_typeof2(object) === 'object' && key in object) {
                value = object[key];
              } else {
                value = null;
              } // When resolving an expression we need to pass next_token in case the expression is a function


              return Twig.expression.resolveAsync.apply(that, [value, object, params, next_token]);
            }).then(function (result) {
              stack.push(result);
            });
          }
        }, {
          /**
           * Match a null value.
           */
          type: Twig.expression.type._null,
          // match a number
          regex: /^(null|NULL|none|NONE)/,
          next: Twig.expression.set.operations,
          compile: function compile(token, stack, output) {
            delete token.match;
            token.value = null;
            output.push(token);
          },
          parse: Twig.expression.fn.parse.push_value
        }, {
          /**
           * Match the context
           */
          type: Twig.expression.type.context,
          regex: /^_context/,
          next: Twig.expression.set.operations_extended.concat([Twig.expression.type.parameter.start]),
          compile: Twig.expression.fn.compile.push,
          parse: function parse(token, stack, context) {
            stack.push(context);
          }
        }, {
          /**
           * Match a boolean
           */
          type: Twig.expression.type.bool,
          regex: /^(true|TRUE|false|FALSE)/,
          next: Twig.expression.set.operations,
          compile: function compile(token, stack, output) {
            token.value = token.match[0].toLowerCase() === "true";
            delete token.match;
            output.push(token);
          },
          parse: Twig.expression.fn.parse.push_value
        }];
        /**
         * Resolve a context value.
         *
         * If the value is a function, it is executed with a context parameter.
         *
         * @param {string} key The context object key.
         * @param {Object} context The render context.
         */

        Twig.expression.resolveAsync = function (value, context, params, next_token, object) {
          if (typeof value == 'function') {
            var promise = Twig.Promise.resolve(params);
            /*
            If value is a function, it will have been impossible during the compile stage to determine that a following
            set of parentheses were parameters for this function.
             Those parentheses will have therefore been marked as an expression, with their own parameters, which really
            belong to this function.
             Those parameters will also need parsing in case they are actually an expression to pass as parameters.
             */

            if (next_token && next_token.type === Twig.expression.type.parameter.end) {
              //When parsing these parameters, we need to get them all back, not just the last item on the stack.
              var tokens_are_parameters = true;
              promise = promise.then(function () {
                return next_token.params && Twig.expression.parseAsync.apply(this, [next_token.params, context, tokens_are_parameters]);
              }).then(function (p) {
                //Clean up the parentheses tokens on the next loop
                next_token.cleanup = true;
                return p;
              });
            }

            return promise.then(function (params) {
              return value.apply(object || context, params || []);
            });
          } else {
            return Twig.Promise.resolve(value);
          }
        };

        Twig.expression.resolve = function (value, context, params, next_token, object) {
          var is_async = true,
              result;
          Twig.expression.resolveAsync.apply(this, [value, context, params, next_token, object]).then(function (r) {
            is_async = false;
            result = r;
          });
          if (is_async) throw new Twig.Error('You are using Twig.js in sync mode in combination with async extensions.');
          return result;
        };
        /**
         * Registry for logic handlers.
         */


        Twig.expression.handler = {};
        /**
         * Define a new expression type, available at Twig.logic.type.{type}
         *
         * @param {string} type The name of the new type.
         */

        Twig.expression.extendType = function (type) {
          Twig.expression.type[type] = "Twig.expression.type." + type;
        };
        /**
         * Extend the expression parsing functionality with a new definition.
         *
         * Token definitions follow this format:
         *  {
         *      type:     One of Twig.expression.type.[type], either pre-defined or added using
         *                    Twig.expression.extendType
         *
         *      next:     Array of types from Twig.expression.type that can follow this token,
         *
         *      regex:    A regex or array of regex's that should match the token.
         *
         *      compile: function(token, stack, output) called when this token is being compiled.
         *                   Should return an object with stack and output set.
         *
         *      parse:   function(token, stack, context) called when this token is being parsed.
         *                   Should return an object with stack and context set.
         *  }
         *
         * @param {Object} definition A token definition.
         */


        Twig.expression.extend = function (definition) {
          if (!definition.type) {
            throw new Twig.Error("Unable to extend logic definition. No type provided for " + definition);
          }

          Twig.expression.handler[definition.type] = definition;
        }; // Extend with built-in expressions


        while (Twig.expression.definitions.length > 0) {
          Twig.expression.extend(Twig.expression.definitions.shift());
        }
        /**
         * Break an expression into tokens defined in Twig.expression.definitions.
         *
         * @param {string} expression The string to tokenize.
         *
         * @return {Array} An array of tokens.
         */


        Twig.expression.tokenize = function (expression) {
          var tokens = [],
              // Keep an offset of the location in the expression for error messages.
          exp_offset = 0,
              // The valid next tokens of the previous token
          next = null,
              // Match information
          type,
              regex,
              regex_array,
              // The possible next token for the match
          token_next,
              // Has a match been found from the definitions
          match_found,
              invalid_matches = [],
              match_function;

          match_function = function match_function() {
            var match = Array.prototype.slice.apply(arguments),
                string = match.pop(),
                offset = match.pop();
            Twig.log.trace("Twig.expression.tokenize", "Matched a ", type, " regular expression of ", match);

            if (next && Twig.indexOf(next, type) < 0) {
              invalid_matches.push(type + " cannot follow a " + tokens[tokens.length - 1].type + " at template:" + exp_offset + " near '" + match[0].substring(0, 20) + "...'"); // Not a match, don't change the expression

              return match[0];
            } // Validate the token if a validation function is provided


            if (Twig.expression.handler[type].validate && !Twig.expression.handler[type].validate(match, tokens)) {
              return match[0];
            }

            invalid_matches = [];
            tokens.push({
              type: type,
              value: match[0],
              match: match
            });
            match_found = true;
            next = token_next;
            exp_offset += match[0].length; // Does the token need to return output back to the expression string
            // e.g. a function match of cycle( might return the '(' back to the expression
            // This allows look-ahead to differentiate between token types (e.g. functions and variable names)

            if (Twig.expression.handler[type].transform) {
              return Twig.expression.handler[type].transform(match, tokens);
            }

            return '';
          };

          Twig.log.debug("Twig.expression.tokenize", "Tokenizing expression ", expression);

          while (expression.length > 0) {
            expression = expression.trim();

            for (type in Twig.expression.handler) {
              if (Twig.expression.handler.hasOwnProperty(type)) {
                token_next = Twig.expression.handler[type].next;
                regex = Twig.expression.handler[type].regex;
                Twig.log.trace("Checking type ", type, " on ", expression);

                if (regex instanceof Array) {
                  regex_array = regex;
                } else {
                  regex_array = [regex];
                }

                match_found = false;

                while (regex_array.length > 0) {
                  regex = regex_array.pop();
                  expression = expression.replace(regex, match_function);
                } // An expression token has been matched. Break the for loop and start trying to
                //  match the next template (if expression isn't empty.)


                if (match_found) {
                  break;
                }
              }
            }

            if (!match_found) {
              if (invalid_matches.length > 0) {
                throw new Twig.Error(invalid_matches.join(" OR "));
              } else {
                throw new Twig.Error("Unable to parse '" + expression + "' at template position" + exp_offset);
              }
            }
          }

          Twig.log.trace("Twig.expression.tokenize", "Tokenized to ", tokens);
          return tokens;
        };
        /**
         * Compile an expression token.
         *
         * @param {Object} raw_token The uncompiled token.
         *
         * @return {Object} The compiled token.
         */


        Twig.expression.compile = function (raw_token) {
          var expression = raw_token.value,
              // Tokenize expression
          tokens = Twig.expression.tokenize(expression),
              token = null,
              output = [],
              stack = [],
              token_template = null;
          Twig.log.trace("Twig.expression.compile: ", "Compiling ", expression); // Push tokens into RPN stack using the Shunting-yard algorithm
          // See http://en.wikipedia.org/wiki/Shunting_yard_algorithm

          while (tokens.length > 0) {
            token = tokens.shift();
            token_template = Twig.expression.handler[token.type];
            Twig.log.trace("Twig.expression.compile: ", "Compiling ", token); // Compile the template

            token_template.compile && token_template.compile(token, stack, output);
            Twig.log.trace("Twig.expression.compile: ", "Stack is", stack);
            Twig.log.trace("Twig.expression.compile: ", "Output is", output);
          }

          while (stack.length > 0) {
            output.push(stack.pop());
          }

          Twig.log.trace("Twig.expression.compile: ", "Final output is", output);
          raw_token.stack = output;
          delete raw_token.value;
          return raw_token;
        };
        /**
         * Parse an RPN expression stack within a context.
         *
         * @param {Array} tokens An array of compiled expression tokens.
         * @param {Object} context The render context to parse the tokens with.
         *
         * @return {Object} The result of parsing all the tokens. The result
         *                  can be anything, String, Array, Object, etc... based on
         *                  the given expression.
         */


        Twig.expression.parse = function (tokens, context, tokens_are_parameters, allow_async) {
          var that = this; // If the token isn't an array, make it one.

          if (!(tokens instanceof Array)) {
            tokens = [tokens];
          } // The output stack


          var stack = [],
              next_token,
              output = null,
              promise = null,
              is_async = true,
              token_template = null,
              loop_token_fixups = [];
          promise = Twig.async.forEach(tokens, function (token, index) {
            //If the token is marked for cleanup, we don't need to parse it
            if (token.cleanup) {
              return;
            }

            var result = null; //Determine the token that follows this one so that we can pass it to the parser

            if (tokens.length > index + 1) {
              next_token = tokens[index + 1];
            }

            token_template = Twig.expression.handler[token.type];
            if (token_template.parse) result = token_template.parse.apply(that, [token, stack, context, next_token]); //Store any binary tokens for later if we are in a loop.

            if (context.loop && token.type === Twig.expression.type.operator.binary) {
              loop_token_fixups.push(token);
            }

            return result;
          }).then(function () {
            //Check every fixup and remove "key" as long as they still have "params". This covers the use case where
            //a ":" operator is used in a loop with a "(expression):" statement. We need to be able to evaluate the expression
            Twig.forEach(loop_token_fixups, function (loop_token_fixup) {
              if (loop_token_fixup.params && loop_token_fixup.key) {
                delete loop_token_fixup["key"];
              }
            }); //If parse has been called with a set of tokens that are parameters, we need to return the whole stack,
            //wrapped in an Array.

            if (tokens_are_parameters) {
              var params = [];

              while (stack.length > 0) {
                params.unshift(stack.pop());
              }

              stack.push(params);
            }

            if (allow_async) return Twig.Promise.resolve(stack.pop());
          }).then(function (v) {
            is_async = false;
            return v;
          });
          if (allow_async) return promise;
          if (is_async) throw new Twig.Error('You are using Twig.js in sync mode in combination with async extensions.'); // Pop the final value off the stack

          return stack.pop();
        };

        return Twig;
      };
      /***/

    },
    /* 4 */

    /***/
    function (module, exports) {
      // ## twig.expression.operator.js
      //
      // This file handles operator lookups and parsing.
      module.exports = function (Twig) {
        "use strict";
        /**
         * Operator associativity constants.
         */

        Twig.expression.operator = {
          leftToRight: 'leftToRight',
          rightToLeft: 'rightToLeft'
        };

        var containment = function containment(a, b) {
          if (b === undefined || b === null) {
            return null;
          } else if (b.indexOf !== undefined) {
            // String
            return a === b || a !== '' && b.indexOf(a) > -1;
          } else {
            var el;

            for (el in b) {
              if (b.hasOwnProperty(el) && b[el] === a) {
                return true;
              }
            }

            return false;
          }
        };
        /**
         * Get the precidence and associativity of an operator. These follow the order that C/C++ use.
         * See http://en.wikipedia.org/wiki/Operators_in_C_and_C++ for the table of values.
         */


        Twig.expression.operator.lookup = function (operator, token) {
          switch (operator) {
            case "..":
              token.precidence = 20;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case ',':
              token.precidence = 18;
              token.associativity = Twig.expression.operator.leftToRight;
              break;
            // Ternary

            case '?:':
            case '?':
            case ':':
              token.precidence = 16;
              token.associativity = Twig.expression.operator.rightToLeft;
              break;

            case 'or':
              token.precidence = 14;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case 'and':
              token.precidence = 13;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case 'b-or':
              token.precidence = 12;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case 'b-xor':
              token.precidence = 11;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case 'b-and':
              token.precidence = 10;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case '==':
            case '!=':
              token.precidence = 9;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case '<':
            case '<=':
            case '>':
            case '>=':
            case 'not in':
            case 'in':
              token.precidence = 8;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case '~': // String concatination

            case '+':
            case '-':
              token.precidence = 6;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case '//':
            case '**':
            case '*':
            case '/':
            case '%':
              token.precidence = 5;
              token.associativity = Twig.expression.operator.leftToRight;
              break;

            case 'not':
              token.precidence = 3;
              token.associativity = Twig.expression.operator.rightToLeft;
              break;

            default:
              throw new Twig.Error("Failed to lookup operator: " + operator + " is an unknown operator.");
          }

          token.operator = operator;
          return token;
        };
        /**
         * Handle operations on the RPN stack.
         *
         * Returns the updated stack.
         */


        Twig.expression.operator.parse = function (operator, stack) {
          Twig.log.trace("Twig.expression.operator.parse: ", "Handling ", operator);
          var a, b, c;

          if (operator === '?') {
            c = stack.pop();
          }

          b = stack.pop();

          if (operator !== 'not') {
            a = stack.pop();
          }

          if (operator !== 'in' && operator !== 'not in') {
            if (a && Array.isArray(a)) {
              a = a.length;
            }

            if (b && Array.isArray(b)) {
              b = b.length;
            }
          }

          switch (operator) {
            case ':':
              // Ignore
              break;

            case '?:':
              if (Twig.lib.boolval(a)) {
                stack.push(a);
              } else {
                stack.push(b);
              }

              break;

            case '?':
              if (a === undefined) {
                //An extended ternary.
                a = b;
                b = c;
                c = undefined;
              }

              if (Twig.lib.boolval(a)) {
                stack.push(b);
              } else {
                stack.push(c);
              }

              break;

            case '+':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(a + b);
              break;

            case '-':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(a - b);
              break;

            case '*':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(a * b);
              break;

            case '/':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(a / b);
              break;

            case '//':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(Math.floor(a / b));
              break;

            case '%':
              b = parseFloat(b);
              a = parseFloat(a);
              stack.push(a % b);
              break;

            case '~':
              stack.push((a != null ? a.toString() : "") + (b != null ? b.toString() : ""));
              break;

            case 'not':
            case '!':
              stack.push(!Twig.lib.boolval(b));
              break;

            case '<':
              stack.push(a < b);
              break;

            case '<=':
              stack.push(a <= b);
              break;

            case '>':
              stack.push(a > b);
              break;

            case '>=':
              stack.push(a >= b);
              break;

            case '===':
              stack.push(a === b);
              break;

            case '==':
              stack.push(a == b);
              break;

            case '!==':
              stack.push(a !== b);
              break;

            case '!=':
              stack.push(a != b);
              break;

            case 'or':
              stack.push(Twig.lib.boolval(a) || Twig.lib.boolval(b));
              break;

            case 'b-or':
              stack.push(a | b);
              break;

            case 'b-xor':
              stack.push(a ^ b);
              break;

            case 'and':
              stack.push(Twig.lib.boolval(a) && Twig.lib.boolval(b));
              break;

            case 'b-and':
              stack.push(a & b);
              break;

            case '**':
              stack.push(Math.pow(a, b));
              break;

            case 'not in':
              stack.push(!containment(a, b));
              break;

            case 'in':
              stack.push(containment(a, b));
              break;

            case '..':
              stack.push(Twig.functions.range(a, b));
              break;

            default:
              debugger;
              throw new Twig.Error("Failed to parse operator: " + operator + " is an unknown operator.");
          }
        };

        return Twig;
      };
      /***/

    },
    /* 5 */

    /***/
    function (module, exports) {
      // ## twig.filters.js
      //
      // This file handles parsing filters.
      module.exports = function (Twig) {
        // Determine object type
        function is(type, obj) {
          var clas = Object.prototype.toString.call(obj).slice(8, -1);
          return obj !== undefined && obj !== null && clas === type;
        }

        Twig.filters = {
          // String Filters
          upper: function upper(value) {
            if (typeof value !== "string") {
              return value;
            }

            return value.toUpperCase();
          },
          lower: function lower(value) {
            if (typeof value !== "string") {
              return value;
            }

            return value.toLowerCase();
          },
          capitalize: function capitalize(value) {
            if (typeof value !== "string") {
              return value;
            }

            return value.substr(0, 1).toUpperCase() + value.toLowerCase().substr(1);
          },
          title: function title(value) {
            if (typeof value !== "string") {
              return value;
            }

            return value.toLowerCase().replace(/(^|\s)([a-z])/g, function (m, p1, p2) {
              return p1 + p2.toUpperCase();
            });
          },
          length: function length(value) {
            if (Twig.lib.is("Array", value) || typeof value === "string") {
              return value.length;
            } else if (Twig.lib.is("Object", value)) {
              if (value._keys === undefined) {
                return Object.keys(value).length;
              } else {
                return value._keys.length;
              }
            } else {
              return 0;
            }
          },
          // Array/Object Filters
          reverse: function reverse(value) {
            if (is("Array", value)) {
              return value.reverse();
            } else if (is("String", value)) {
              return value.split("").reverse().join("");
            } else if (is("Object", value)) {
              var keys = value._keys || Object.keys(value).reverse();
              value._keys = keys;
              return value;
            }
          },
          sort: function sort(value) {
            if (is("Array", value)) {
              return value.sort();
            } else if (is('Object', value)) {
              // Sorting objects isn't obvious since the order of
              // returned keys isn't guaranteed in JavaScript.
              // Because of this we use a "hidden" key called _keys to
              // store the keys in the order we want to return them.
              delete value._keys;
              var keys = Object.keys(value),
                  sorted_keys = keys.sort(function (a, b) {
                var a1, a2; // if a and b are comparable, we're fine :-)

                if (value[a] > value[b] == !(value[a] <= value[b])) {
                  return value[a] > value[b] ? 1 : value[a] < value[b] ? -1 : 0;
                } // if a and b can be parsed as numbers, we can compare
                // their numeric value
                else if (!isNaN(a1 = parseFloat(value[a])) && !isNaN(b1 = parseFloat(value[b]))) {
                    return a1 > b1 ? 1 : a1 < b1 ? -1 : 0;
                  } // if one of the values is a string, we convert the
                  // other value to string as well
                  else if (typeof value[a] == 'string') {
                      return value[a] > value[b].toString() ? 1 : value[a] < value[b].toString() ? -1 : 0;
                    } else if (typeof value[b] == 'string') {
                      return value[a].toString() > value[b] ? 1 : value[a].toString() < value[b] ? -1 : 0;
                    } // everything failed - return 'null' as sign, that
                    // the values are not comparable
                    else {
                        return null;
                      }
              });
              value._keys = sorted_keys;
              return value;
            }
          },
          keys: function keys(value) {
            if (value === undefined || value === null) {
              return;
            }

            var keyset = value._keys || Object.keys(value),
                output = [];
            Twig.forEach(keyset, function (key) {
              if (key === "_keys") return; // Ignore the _keys property

              if (value.hasOwnProperty(key)) {
                output.push(key);
              }
            });
            return output;
          },
          url_encode: function url_encode(value) {
            if (value === undefined || value === null) {
              return;
            }

            var result = encodeURIComponent(value);
            result = result.replace("'", "%27");
            return result;
          },
          join: function join(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            var join_str = "",
                output = [],
                keyset = null;

            if (params && params[0]) {
              join_str = params[0];
            }

            if (is("Array", value)) {
              output = value;
            } else {
              keyset = value._keys || Object.keys(value);
              Twig.forEach(keyset, function (key) {
                if (key === "_keys") return; // Ignore the _keys property

                if (value.hasOwnProperty(key)) {
                  output.push(value[key]);
                }
              });
            }

            return output.join(join_str);
          },
          "default": function _default(value, params) {
            if (params !== undefined && params.length > 1) {
              throw new Twig.Error("default filter expects one argument");
            }

            if (value === undefined || value === null || value === '') {
              if (params === undefined) {
                return '';
              }

              return params[0];
            } else {
              return value;
            }
          },
          json_encode: function json_encode(value) {
            if (value === undefined || value === null) {
              return "null";
            } else if (_typeof2(value) == 'object' && is("Array", value)) {
              output = [];
              Twig.forEach(value, function (v) {
                output.push(Twig.filters.json_encode(v));
              });
              return "[" + output.join(",") + "]";
            } else if (_typeof2(value) == 'object') {
              var keyset = value._keys || Object.keys(value),
                  output = [];
              Twig.forEach(keyset, function (key) {
                output.push(JSON.stringify(key) + ":" + Twig.filters.json_encode(value[key]));
              });
              return "{" + output.join(",") + "}";
            } else {
              return JSON.stringify(value);
            }
          },
          merge: function merge(value, params) {
            var obj = [],
                arr_index = 0,
                keyset = []; // Check to see if all the objects being merged are arrays

            if (!is("Array", value)) {
              // Create obj as an Object
              obj = {};
            } else {
              Twig.forEach(params, function (param) {
                if (!is("Array", param)) {
                  obj = {};
                }
              });
            }

            if (!is("Array", obj)) {
              obj._keys = [];
            }

            if (is("Array", value)) {
              Twig.forEach(value, function (val) {
                if (obj._keys) obj._keys.push(arr_index);
                obj[arr_index] = val;
                arr_index++;
              });
            } else {
              keyset = value._keys || Object.keys(value);
              Twig.forEach(keyset, function (key) {
                obj[key] = value[key];

                obj._keys.push(key); // Handle edge case where a number index in an object is greater than
                //   the array counter. In such a case, the array counter is increased
                //   one past the index.
                //
                // Example {{ ["a", "b"]|merge({"4":"value"}, ["c", "d"])
                // Without this, d would have an index of "4" and overwrite the value
                //   of "value"


                var int_key = parseInt(key, 10);

                if (!isNaN(int_key) && int_key >= arr_index) {
                  arr_index = int_key + 1;
                }
              });
            } // mixin the merge arrays


            Twig.forEach(params, function (param) {
              if (is("Array", param)) {
                Twig.forEach(param, function (val) {
                  if (obj._keys) obj._keys.push(arr_index);
                  obj[arr_index] = val;
                  arr_index++;
                });
              } else {
                keyset = param._keys || Object.keys(param);
                Twig.forEach(keyset, function (key) {
                  if (!obj[key]) obj._keys.push(key);
                  obj[key] = param[key];
                  var int_key = parseInt(key, 10);

                  if (!isNaN(int_key) && int_key >= arr_index) {
                    arr_index = int_key + 1;
                  }
                });
              }
            });

            if (params.length === 0) {
              throw new Twig.Error("Filter merge expects at least one parameter");
            }

            return obj;
          },
          date: function date(value, params) {
            var date = Twig.functions.date(value);
            var format = params && params.length ? params[0] : 'F j, Y H:i';
            return Twig.lib.date(format, date);
          },
          date_modify: function date_modify(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            if (params === undefined || params.length !== 1) {
              throw new Twig.Error("date_modify filter expects 1 argument");
            }

            var modifyText = params[0],
                time;

            if (Twig.lib.is("Date", value)) {
              time = Twig.lib.strtotime(modifyText, value.getTime() / 1000);
            }

            if (Twig.lib.is("String", value)) {
              time = Twig.lib.strtotime(modifyText, Twig.lib.strtotime(value));
            }

            if (Twig.lib.is("Number", value)) {
              time = Twig.lib.strtotime(modifyText, value);
            }

            return new Date(time * 1000);
          },
          replace: function replace(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            var pairs = params[0],
                tag;

            for (tag in pairs) {
              if (pairs.hasOwnProperty(tag) && tag !== "_keys") {
                value = Twig.lib.replaceAll(value, tag, pairs[tag]);
              }
            }

            return value;
          },
          format: function format(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            return Twig.lib.vsprintf(value, params);
          },
          striptags: function striptags(value) {
            if (value === undefined || value === null) {
              return;
            }

            return Twig.lib.strip_tags(value);
          },
          escape: function escape(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            var strategy = "html";
            if (params && params.length && params[0] !== true) strategy = params[0];

            if (strategy == "html") {
              var raw_value = value.toString().replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
              return Twig.Markup(raw_value, 'html');
            } else if (strategy == "js") {
              var raw_value = value.toString();
              var result = "";

              for (var i = 0; i < raw_value.length; i++) {
                if (raw_value[i].match(/^[a-zA-Z0-9,\._]$/)) result += raw_value[i];else {
                  var char_code = raw_value.charCodeAt(i);
                  if (char_code < 0x80) result += "\\x" + char_code.toString(16).toUpperCase();else result += Twig.lib.sprintf("\\u%04s", char_code.toString(16).toUpperCase());
                }
              }

              return Twig.Markup(result, 'js');
            } else if (strategy == "css") {
              var raw_value = value.toString();
              var result = "";

              for (var i = 0; i < raw_value.length; i++) {
                if (raw_value[i].match(/^[a-zA-Z0-9]$/)) result += raw_value[i];else {
                  var char_code = raw_value.charCodeAt(i);
                  result += "\\" + char_code.toString(16).toUpperCase() + " ";
                }
              }

              return Twig.Markup(result, 'css');
            } else if (strategy == "url") {
              var result = Twig.filters.url_encode(value);
              return Twig.Markup(result, 'url');
            } else if (strategy == "html_attr") {
              var raw_value = value.toString();
              var result = "";

              for (var i = 0; i < raw_value.length; i++) {
                if (raw_value[i].match(/^[a-zA-Z0-9,\.\-_]$/)) result += raw_value[i];else if (raw_value[i].match(/^[&<>"]$/)) result += raw_value[i].replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");else {
                  var char_code = raw_value.charCodeAt(i); // The following replaces characters undefined in HTML with
                  // the hex entity for the Unicode replacement character.

                  if (char_code <= 0x1f && char_code != 0x09 && char_code != 0x0a && char_code != 0x0d) result += "&#xFFFD;";else if (char_code < 0x80) result += Twig.lib.sprintf("&#x%02s;", char_code.toString(16).toUpperCase());else result += Twig.lib.sprintf("&#x%04s;", char_code.toString(16).toUpperCase());
                }
              }

              return Twig.Markup(result, 'html_attr');
            } else {
              throw new Twig.Error("escape strategy unsupported");
            }
          },

          /* Alias of escape */
          "e": function e(value, params) {
            return Twig.filters.escape(value, params);
          },
          nl2br: function nl2br(value) {
            if (value === undefined || value === null) {
              return;
            }

            var linebreak_tag = "BACKSLASH_n_replace",
                br = "<br />" + linebreak_tag;
            value = Twig.filters.escape(value).replace(/\r\n/g, br).replace(/\r/g, br).replace(/\n/g, br);
            value = Twig.lib.replaceAll(value, linebreak_tag, "\n");
            return Twig.Markup(value);
          },

          /**
           * Adapted from: http://phpjs.org/functions/number_format:481
           */
          number_format: function number_format(value, params) {
            var number = value,
                decimals = params && params[0] ? params[0] : undefined,
                dec = params && params[1] !== undefined ? params[1] : ".",
                sep = params && params[2] !== undefined ? params[2] : ",";
            number = (number + '').replace(/[^0-9+\-Ee.]/g, '');

            var n = !isFinite(+number) ? 0 : +number,
                prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
                s = '',
                toFixedFix = function toFixedFix(n, prec) {
              var k = Math.pow(10, prec);
              return '' + Math.round(n * k) / k;
            }; // Fix for IE parseFloat(0.55).toFixed(0) = 0;


            s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');

            if (s[0].length > 3) {
              s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep);
            }

            if ((s[1] || '').length < prec) {
              s[1] = s[1] || '';
              s[1] += new Array(prec - s[1].length + 1).join('0');
            }

            return s.join(dec);
          },
          trim: function trim(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            var str = Twig.filters.escape('' + value),
                whitespace;

            if (params && params[0]) {
              whitespace = '' + params[0];
            } else {
              whitespace = " \n\r\t\f\x0B\xA0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u200B\u2028\u2029\u3000";
            }

            for (var i = 0; i < str.length; i++) {
              if (whitespace.indexOf(str.charAt(i)) === -1) {
                str = str.substring(i);
                break;
              }
            }

            for (i = str.length - 1; i >= 0; i--) {
              if (whitespace.indexOf(str.charAt(i)) === -1) {
                str = str.substring(0, i + 1);
                break;
              }
            }

            return whitespace.indexOf(str.charAt(0)) === -1 ? str : '';
          },
          truncate: function truncate(value, params) {
            var length = 30,
                preserve = false,
                separator = '...';
            value = value + '';

            if (params) {
              if (params[0]) {
                length = params[0];
              }

              if (params[1]) {
                preserve = params[1];
              }

              if (params[2]) {
                separator = params[2];
              }
            }

            if (value.length > length) {
              if (preserve) {
                length = value.indexOf(' ', length);

                if (length === -1) {
                  return value;
                }
              }

              value = value.substr(0, length) + separator;
            }

            return value;
          },
          slice: function slice(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            if (params === undefined || params.length < 1) {
              throw new Twig.Error("slice filter expects at least 1 argument");
            } // default to start of string


            var start = params[0] || 0; // default to length of string

            var length = params.length > 1 ? params[1] : value.length; // handle negative start values

            var startIndex = start >= 0 ? start : Math.max(value.length + start, 0);

            if (Twig.lib.is("Array", value)) {
              var output = [];

              for (var i = startIndex; i < startIndex + length && i < value.length; i++) {
                output.push(value[i]);
              }

              return output;
            } else if (Twig.lib.is("String", value)) {
              return value.substr(startIndex, length);
            } else {
              throw new Twig.Error("slice filter expects value to be an array or string");
            }
          },
          abs: function abs(value) {
            if (value === undefined || value === null) {
              return;
            }

            return Math.abs(value);
          },
          first: function first(value) {
            if (is("Array", value)) {
              return value[0];
            } else if (is("Object", value)) {
              if ('_keys' in value) {
                return value[value._keys[0]];
              }
            } else if (typeof value === "string") {
              return value.substr(0, 1);
            }

            return;
          },
          split: function split(value, params) {
            if (value === undefined || value === null) {
              return;
            }

            if (params === undefined || params.length < 1 || params.length > 2) {
              throw new Twig.Error("split filter expects 1 or 2 argument");
            }

            if (Twig.lib.is("String", value)) {
              var delimiter = params[0],
                  limit = params[1],
                  split = value.split(delimiter);

              if (limit === undefined) {
                return split;
              } else if (limit < 0) {
                return value.split(delimiter, split.length + limit);
              } else {
                var limitedSplit = [];

                if (delimiter == '') {
                  // empty delimiter
                  // "aabbcc"|split('', 2)
                  //     -> ['aa', 'bb', 'cc']
                  while (split.length > 0) {
                    var temp = "";

                    for (var i = 0; i < limit && split.length > 0; i++) {
                      temp += split.shift();
                    }

                    limitedSplit.push(temp);
                  }
                } else {
                  // non-empty delimiter
                  // "one,two,three,four,five"|split(',', 3)
                  //     -> ['one', 'two', 'three,four,five']
                  for (var i = 0; i < limit - 1 && split.length > 0; i++) {
                    limitedSplit.push(split.shift());
                  }

                  if (split.length > 0) {
                    limitedSplit.push(split.join(delimiter));
                  }
                }

                return limitedSplit;
              }
            } else {
              throw new Twig.Error("split filter expects value to be a string");
            }
          },
          last: function last(value) {
            if (Twig.lib.is('Object', value)) {
              var keys;

              if (value._keys === undefined) {
                keys = Object.keys(value);
              } else {
                keys = value._keys;
              }

              return value[keys[keys.length - 1]];
            } // string|array


            return value[value.length - 1];
          },
          raw: function raw(value) {
            return Twig.Markup(value);
          },
          batch: function batch(items, params) {
            var size = params.shift(),
                fill = params.shift(),
                result,
                last,
                missing;

            if (!Twig.lib.is("Array", items)) {
              throw new Twig.Error("batch filter expects items to be an array");
            }

            if (!Twig.lib.is("Number", size)) {
              throw new Twig.Error("batch filter expects size to be a number");
            }

            size = Math.ceil(size);
            result = Twig.lib.chunkArray(items, size);

            if (fill && items.length % size != 0) {
              last = result.pop();
              missing = size - last.length;

              while (missing--) {
                last.push(fill);
              }

              result.push(last);
            }

            return result;
          },
          round: function round(value, params) {
            params = params || [];
            var precision = params.length > 0 ? params[0] : 0,
                method = params.length > 1 ? params[1] : "common";
            value = parseFloat(value);

            if (precision && !Twig.lib.is("Number", precision)) {
              throw new Twig.Error("round filter expects precision to be a number");
            }

            if (method === "common") {
              return Twig.lib.round(value, precision);
            }

            if (!Twig.lib.is("Function", Math[method])) {
              throw new Twig.Error("round filter expects method to be 'floor', 'ceil', or 'common'");
            }

            return Math[method](value * Math.pow(10, precision)) / Math.pow(10, precision);
          }
        };

        Twig.filter = function (filter, value, params) {
          if (!Twig.filters[filter]) {
            throw "Unable to find filter " + filter;
          }

          return Twig.filters[filter].apply(this, [value, params]);
        };

        Twig.filter.extend = function (filter, definition) {
          Twig.filters[filter] = definition;
        };

        return Twig;
      };
      /***/

    },
    /* 6 */

    /***/
    function (module, exports) {
      // ## twig.functions.js
      //
      // This file handles parsing filters.
      module.exports = function (Twig) {
        /**
         * @constant
         * @type {string}
         */
        var TEMPLATE_NOT_FOUND_MESSAGE = 'Template "{name}" is not defined.'; // Determine object type

        function is(type, obj) {
          var clas = Object.prototype.toString.call(obj).slice(8, -1);
          return obj !== undefined && obj !== null && clas === type;
        }

        Twig.functions = {
          //  attribute, block, constant, date, dump, parent, random,.
          // Range function from http://phpjs.org/functions/range:499
          // Used under an MIT License
          range: function range(low, high, step) {
            // http://kevin.vanzonneveld.net
            // +   original by: Waldo Malqui Silva
            // *     example 1: range ( 0, 12 );
            // *     returns 1: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
            // *     example 2: range( 0, 100, 10 );
            // *     returns 2: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]
            // *     example 3: range( 'a', 'i' );
            // *     returns 3: ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i']
            // *     example 4: range( 'c', 'a' );
            // *     returns 4: ['c', 'b', 'a']
            var matrix = [];
            var inival, endval, plus;
            var walker = step || 1;
            var chars = false;

            if (!isNaN(low) && !isNaN(high)) {
              inival = parseInt(low, 10);
              endval = parseInt(high, 10);
            } else if (isNaN(low) && isNaN(high)) {
              chars = true;
              inival = low.charCodeAt(0);
              endval = high.charCodeAt(0);
            } else {
              inival = isNaN(low) ? 0 : low;
              endval = isNaN(high) ? 0 : high;
            }

            plus = inival > endval ? false : true;

            if (plus) {
              while (inival <= endval) {
                matrix.push(chars ? String.fromCharCode(inival) : inival);
                inival += walker;
              }
            } else {
              while (inival >= endval) {
                matrix.push(chars ? String.fromCharCode(inival) : inival);
                inival -= walker;
              }
            }

            return matrix;
          },
          cycle: function cycle(arr, i) {
            var pos = i % arr.length;
            return arr[pos];
          },
          dump: function dump() {
            var EOL = '\n',
                indentChar = '  ',
                indentTimes = 0,
                out = '',
                args = Array.prototype.slice.call(arguments),
                indent = function indent(times) {
              var ind = '';

              while (times > 0) {
                times--;
                ind += indentChar;
              }

              return ind;
            },
                displayVar = function displayVar(variable) {
              out += indent(indentTimes);

              if (_typeof2(variable) === 'object') {
                dumpVar(variable);
              } else if (typeof variable === 'function') {
                out += 'function()' + EOL;
              } else if (typeof variable === 'string') {
                out += 'string(' + variable.length + ') "' + variable + '"' + EOL;
              } else if (typeof variable === 'number') {
                out += 'number(' + variable + ')' + EOL;
              } else if (typeof variable === 'boolean') {
                out += 'bool(' + variable + ')' + EOL;
              }
            },
                dumpVar = function dumpVar(variable) {
              var i;

              if (variable === null) {
                out += 'NULL' + EOL;
              } else if (variable === undefined) {
                out += 'undefined' + EOL;
              } else if (_typeof2(variable) === 'object') {
                out += indent(indentTimes) + _typeof2(variable);
                indentTimes++;

                out += '(' + function (obj) {
                  var size = 0,
                      key;

                  for (key in obj) {
                    if (obj.hasOwnProperty(key)) {
                      size++;
                    }
                  }

                  return size;
                }(variable) + ') {' + EOL;

                for (i in variable) {
                  out += indent(indentTimes) + '[' + i + ']=> ' + EOL;
                  displayVar(variable[i]);
                }

                indentTimes--;
                out += indent(indentTimes) + '}' + EOL;
              } else {
                displayVar(variable);
              }
            }; // handle no argument case by dumping the entire render context


            if (args.length == 0) args.push(this.context);
            Twig.forEach(args, function (variable) {
              dumpVar(variable);
            });
            return out;
          },
          date: function date(_date2, time) {
            var dateObj;

            if (_date2 === undefined || _date2 === null || _date2 === "") {
              dateObj = new Date();
            } else if (Twig.lib.is("Date", _date2)) {
              dateObj = _date2;
            } else if (Twig.lib.is("String", _date2)) {
              if (_date2.match(/^[0-9]+$/)) {
                dateObj = new Date(_date2 * 1000);
              } else {
                dateObj = new Date(Twig.lib.strtotime(_date2) * 1000);
              }
            } else if (Twig.lib.is("Number", _date2)) {
              // timestamp
              dateObj = new Date(_date2 * 1000);
            } else {
              throw new Twig.Error("Unable to parse date " + _date2);
            }

            return dateObj;
          },
          block: function block(_block) {
            if (this.originalBlockTokens[_block]) {
              return Twig.logic.parse.apply(this, [this.originalBlockTokens[_block], this.context]).output;
            } else {
              return this.blocks[_block];
            }
          },
          parent: function parent() {
            // Add a placeholder
            return Twig.placeholders.parent;
          },
          attribute: function attribute(object, method, params) {
            if (Twig.lib.is('Object', object)) {
              if (object.hasOwnProperty(method)) {
                if (typeof object[method] === "function") {
                  return object[method].apply(undefined, params);
                } else {
                  return object[method];
                }
              }
            } // Array will return element 0-index


            return object[method] || undefined;
          },
          max: function max(values) {
            if (Twig.lib.is("Object", values)) {
              delete values["_keys"];
              return Twig.lib.max(values);
            }

            return Twig.lib.max.apply(null, arguments);
          },
          min: function min(values) {
            if (Twig.lib.is("Object", values)) {
              delete values["_keys"];
              return Twig.lib.min(values);
            }

            return Twig.lib.min.apply(null, arguments);
          },
          template_from_string: function template_from_string(template) {
            if (template === undefined) {
              template = '';
            }

            return Twig.Templates.parsers.twig({
              options: this.options,
              data: template
            });
          },
          random: function random(value) {
            var LIMIT_INT31 = 0x80000000;

            function getRandomNumber(n) {
              var random = Math.floor(Math.random() * LIMIT_INT31);
              var limits = [0, n];
              var min = Math.min.apply(null, limits),
                  max = Math.max.apply(null, limits);
              return min + Math.floor((max - min + 1) * random / LIMIT_INT31);
            }

            if (Twig.lib.is("Number", value)) {
              return getRandomNumber(value);
            }

            if (Twig.lib.is("String", value)) {
              return value.charAt(getRandomNumber(value.length - 1));
            }

            if (Twig.lib.is("Array", value)) {
              return value[getRandomNumber(value.length - 1)];
            }

            if (Twig.lib.is("Object", value)) {
              var keys = Object.keys(value);
              return value[keys[getRandomNumber(keys.length - 1)]];
            }

            return getRandomNumber(LIMIT_INT31 - 1);
          },

          /**
           * Returns the content of a template without rendering it
           * @param {string} name
           * @param {boolean} [ignore_missing=false]
           * @returns {string}
           */
          source: function source(name, ignore_missing) {
            var templateSource;
            var templateFound = false;
            var isNodeEnvironment = typeof module !== 'undefined' && typeof module.exports !== 'undefined' && typeof window === 'undefined';
            var loader;
            var path; //if we are running in a node.js environment, set the loader to 'fs' and ensure the
            // path is relative to the CWD of the running script
            //else, set the loader to 'ajax' and set the path to the value of name

            if (isNodeEnvironment) {
              loader = 'fs';
              path = __dirname + '/' + name;
            } else {
              loader = 'ajax';
              path = name;
            } //build the params object


            var params = {
              id: name,
              path: path,
              method: loader,
              parser: 'source',
              async: false,
              fetchTemplateSource: true
            }; //default ignore_missing to false

            if (typeof ignore_missing === 'undefined') {
              ignore_missing = false;
            } //try to load the remote template
            //
            //on exception, log it


            try {
              templateSource = Twig.Templates.loadRemote(name, params); //if the template is undefined or null, set the template to an empty string and do NOT flip the
              // boolean indicating we found the template
              //
              //else, all is good! flip the boolean indicating we found the template

              if (typeof templateSource === 'undefined' || templateSource === null) {
                templateSource = '';
              } else {
                templateFound = true;
              }
            } catch (e) {
              Twig.log.debug('Twig.functions.source: ', 'Problem loading template  ', e);
            } //if the template was NOT found AND we are not ignoring missing templates, return the same message
            // that is returned by the PHP implementation of the twig source() function
            //
            //else, return the template source


            if (!templateFound && !ignore_missing) {
              return TEMPLATE_NOT_FOUND_MESSAGE.replace('{name}', name);
            } else {
              return templateSource;
            }
          }
        };

        Twig._function = function (_function, value, params) {
          if (!Twig.functions[_function]) {
            throw "Unable to find function " + _function;
          }

          return Twig.functions[_function](value, params);
        };

        Twig._function.extend = function (_function, definition) {
          Twig.functions[_function] = definition;
        };

        return Twig;
      };
      /***/

    },
    /* 7 */

    /***/
    function (module, exports, __webpack_require__) {
      // ## twig.lib.js
      //
      // This file contains 3rd party libraries used within twig.
      //
      // Copies of the licenses for the code included here can be found in the
      // LICENSES.md file.
      //
      module.exports = function (Twig) {
        // Namespace for libraries
        Twig.lib = {};
        Twig.lib.sprintf = __webpack_require__(8);
        Twig.lib.vsprintf = __webpack_require__(9);
        Twig.lib.round = __webpack_require__(10);
        Twig.lib.max = __webpack_require__(11);
        Twig.lib.min = __webpack_require__(12);
        Twig.lib.strip_tags = __webpack_require__(13);
        Twig.lib.strtotime = __webpack_require__(14);
        Twig.lib.date = __webpack_require__(15);
        Twig.lib.boolval = __webpack_require__(16);

        Twig.lib.is = function (type, obj) {
          var clas = Object.prototype.toString.call(obj).slice(8, -1);
          return obj !== undefined && obj !== null && clas === type;
        }; // shallow-copy an object


        Twig.lib.copy = function (src) {
          var target = {},
              key;

          for (key in src) {
            target[key] = src[key];
          }

          return target;
        };

        Twig.lib.extend = function (src, add) {
          var keys = Object.keys(add),
              i;
          i = keys.length;

          while (i--) {
            src[keys[i]] = add[keys[i]];
          }

          return src;
        };

        Twig.lib.replaceAll = function (string, search, replace) {
          return string.split(search).join(replace);
        }; // chunk an array (arr) into arrays of (size) items, returns an array of arrays, or an empty array on invalid input


        Twig.lib.chunkArray = function (arr, size) {
          var returnVal = [],
              x = 0,
              len = arr.length;

          if (size < 1 || !Twig.lib.is("Array", arr)) {
            return [];
          }

          while (x < len) {
            returnVal.push(arr.slice(x, x += size));
          }

          return returnVal;
        };

        return Twig;
      };
      /***/

    },
    /* 8 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function sprintf() {
        //  discuss at: http://locutus.io/php/sprintf/
        // original by: Ash Searle (http://hexmen.com/blog/)
        // improved by: Michael White (http://getsprink.com)
        // improved by: Jack
        // improved by: Kevin van Zonneveld (http://kvz.io)
        // improved by: Kevin van Zonneveld (http://kvz.io)
        // improved by: Kevin van Zonneveld (http://kvz.io)
        // improved by: Dj
        // improved by: Allidylls
        //    input by: Paulo Freitas
        //    input by: Brett Zamir (http://brett-zamir.me)
        //   example 1: sprintf("%01.2f", 123.1)
        //   returns 1: '123.10'
        //   example 2: sprintf("[%10s]", 'monkey')
        //   returns 2: '[    monkey]'
        //   example 3: sprintf("[%'#10s]", 'monkey')
        //   returns 3: '[####monkey]'
        //   example 4: sprintf("%d", 123456789012345)
        //   returns 4: '123456789012345'
        //   example 5: sprintf('%-03s', 'E')
        //   returns 5: 'E00'
        var regex = /%%|%(\d+\$)?([\-+'#0 ]*)(\*\d+\$|\*|\d+)?(?:\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g;
        var a = arguments;
        var i = 0;
        var format = a[i++];

        var _pad = function _pad(str, len, chr, leftJustify) {
          if (!chr) {
            chr = ' ';
          }

          var padding = str.length >= len ? '' : new Array(1 + len - str.length >>> 0).join(chr);
          return leftJustify ? str + padding : padding + str;
        };

        var justify = function justify(value, prefix, leftJustify, minWidth, zeroPad, customPadChar) {
          var diff = minWidth - value.length;

          if (diff > 0) {
            if (leftJustify || !zeroPad) {
              value = _pad(value, minWidth, customPadChar, leftJustify);
            } else {
              value = [value.slice(0, prefix.length), _pad('', diff, '0', true), value.slice(prefix.length)].join('');
            }
          }

          return value;
        };

        var _formatBaseX = function _formatBaseX(value, base, prefix, leftJustify, minWidth, precision, zeroPad) {
          // Note: casts negative numbers to positive ones
          var number = value >>> 0;
          prefix = prefix && number && {
            '2': '0b',
            '8': '0',
            '16': '0x'
          }[base] || '';
          value = prefix + _pad(number.toString(base), precision || 0, '0', false);
          return justify(value, prefix, leftJustify, minWidth, zeroPad);
        }; // _formatString()


        var _formatString = function _formatString(value, leftJustify, minWidth, precision, zeroPad, customPadChar) {
          if (precision !== null && precision !== undefined) {
            value = value.slice(0, precision);
          }

          return justify(value, '', leftJustify, minWidth, zeroPad, customPadChar);
        }; // doFormat()


        var doFormat = function doFormat(substring, valueIndex, flags, minWidth, precision, type) {
          var number, prefix, method, textTransform, value;

          if (substring === '%%') {
            return '%';
          } // parse flags


          var leftJustify = false;
          var positivePrefix = '';
          var zeroPad = false;
          var prefixBaseX = false;
          var customPadChar = ' ';
          var flagsl = flags.length;
          var j;

          for (j = 0; j < flagsl; j++) {
            switch (flags.charAt(j)) {
              case ' ':
                positivePrefix = ' ';
                break;

              case '+':
                positivePrefix = '+';
                break;

              case '-':
                leftJustify = true;
                break;

              case "'":
                customPadChar = flags.charAt(j + 1);
                break;

              case '0':
                zeroPad = true;
                customPadChar = '0';
                break;

              case '#':
                prefixBaseX = true;
                break;
            }
          } // parameters may be null, undefined, empty-string or real valued
          // we want to ignore null, undefined and empty-string values


          if (!minWidth) {
            minWidth = 0;
          } else if (minWidth === '*') {
            minWidth = +a[i++];
          } else if (minWidth.charAt(0) === '*') {
            minWidth = +a[minWidth.slice(1, -1)];
          } else {
            minWidth = +minWidth;
          } // Note: undocumented perl feature:


          if (minWidth < 0) {
            minWidth = -minWidth;
            leftJustify = true;
          }

          if (!isFinite(minWidth)) {
            throw new Error('sprintf: (minimum-)width must be finite');
          }

          if (!precision) {
            precision = 'fFeE'.indexOf(type) > -1 ? 6 : type === 'd' ? 0 : undefined;
          } else if (precision === '*') {
            precision = +a[i++];
          } else if (precision.charAt(0) === '*') {
            precision = +a[precision.slice(1, -1)];
          } else {
            precision = +precision;
          } // grab value using valueIndex if required?


          value = valueIndex ? a[valueIndex.slice(0, -1)] : a[i++];

          switch (type) {
            case 's':
              return _formatString(value + '', leftJustify, minWidth, precision, zeroPad, customPadChar);

            case 'c':
              return _formatString(String.fromCharCode(+value), leftJustify, minWidth, precision, zeroPad);

            case 'b':
              return _formatBaseX(value, 2, prefixBaseX, leftJustify, minWidth, precision, zeroPad);

            case 'o':
              return _formatBaseX(value, 8, prefixBaseX, leftJustify, minWidth, precision, zeroPad);

            case 'x':
              return _formatBaseX(value, 16, prefixBaseX, leftJustify, minWidth, precision, zeroPad);

            case 'X':
              return _formatBaseX(value, 16, prefixBaseX, leftJustify, minWidth, precision, zeroPad).toUpperCase();

            case 'u':
              return _formatBaseX(value, 10, prefixBaseX, leftJustify, minWidth, precision, zeroPad);

            case 'i':
            case 'd':
              number = +value || 0; // Plain Math.round doesn't just truncate

              number = Math.round(number - number % 1);
              prefix = number < 0 ? '-' : positivePrefix;
              value = prefix + _pad(String(Math.abs(number)), precision, '0', false);
              return justify(value, prefix, leftJustify, minWidth, zeroPad);

            case 'e':
            case 'E':
            case 'f': // @todo: Should handle locales (as per setlocale)

            case 'F':
            case 'g':
            case 'G':
              number = +value;
              prefix = number < 0 ? '-' : positivePrefix;
              method = ['toExponential', 'toFixed', 'toPrecision']['efg'.indexOf(type.toLowerCase())];
              textTransform = ['toString', 'toUpperCase']['eEfFgG'.indexOf(type) % 2];
              value = prefix + Math.abs(number)[method](precision);
              return justify(value, prefix, leftJustify, minWidth, zeroPad)[textTransform]();

            default:
              return substring;
          }
        };

        return format.replace(regex, doFormat);
      };
      /***/

    },
    /* 9 */

    /***/
    function (module, exports, __webpack_require__) {
      'use strict';

      module.exports = function vsprintf(format, args) {
        //  discuss at: http://locutus.io/php/vsprintf/
        // original by: ejsanders
        //   example 1: vsprintf('%04d-%02d-%02d', [1988, 8, 1])
        //   returns 1: '1988-08-01'
        var sprintf = __webpack_require__(8);

        return sprintf.apply(this, [format].concat(args));
      };
      /***/

    },
    /* 10 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function round(value, precision, mode) {
        //  discuss at: http://locutus.io/php/round/
        // original by: Philip Peterson
        //  revised by: Onno Marsman (https://twitter.com/onnomarsman)
        //  revised by: T.Wild
        //  revised by: Rafał Kukawski (http://blog.kukawski.pl)
        //    input by: Greenseed
        //    input by: meo
        //    input by: William
        //    input by: Josep Sanz (http://www.ws3.es/)
        // bugfixed by: Brett Zamir (http://brett-zamir.me)
        //      note 1: Great work. Ideas for improvement:
        //      note 1: - code more compliant with developer guidelines
        //      note 1: - for implementing PHP constant arguments look at
        //      note 1: the pathinfo() function, it offers the greatest
        //      note 1: flexibility & compatibility possible
        //   example 1: round(1241757, -3)
        //   returns 1: 1242000
        //   example 2: round(3.6)
        //   returns 2: 4
        //   example 3: round(2.835, 2)
        //   returns 3: 2.84
        //   example 4: round(1.1749999999999, 2)
        //   returns 4: 1.17
        //   example 5: round(58551.799999999996, 2)
        //   returns 5: 58551.8
        var m, f, isHalf, sgn; // helper variables
        // making sure precision is integer

        precision |= 0;
        m = Math.pow(10, precision);
        value *= m; // sign of the number

        sgn = value > 0 | -(value < 0);
        isHalf = value % 1 === 0.5 * sgn;
        f = Math.floor(value);

        if (isHalf) {
          switch (mode) {
            case 'PHP_ROUND_HALF_DOWN':
              // rounds .5 toward zero
              value = f + (sgn < 0);
              break;

            case 'PHP_ROUND_HALF_EVEN':
              // rouds .5 towards the next even integer
              value = f + f % 2 * sgn;
              break;

            case 'PHP_ROUND_HALF_ODD':
              // rounds .5 towards the next odd integer
              value = f + !(f % 2);
              break;

            default:
              // rounds .5 away from zero
              value = f + (sgn > 0);
          }
        }

        return (isHalf ? value : Math.round(value)) / m;
      };
      /***/

    },
    /* 11 */

    /***/
    function (module, exports) {
      'use strict';

      var _typeof = typeof Symbol === "function" && _typeof2(Symbol.iterator) === "symbol" ? function (obj) {
        return _typeof2(obj);
      } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : _typeof2(obj);
      };

      module.exports = function max() {
        //  discuss at: http://locutus.io/php/max/
        // original by: Onno Marsman (https://twitter.com/onnomarsman)
        //  revised by: Onno Marsman (https://twitter.com/onnomarsman)
        // improved by: Jack
        //      note 1: Long code cause we're aiming for maximum PHP compatibility
        //   example 1: max(1, 3, 5, 6, 7)
        //   returns 1: 7
        //   example 2: max([2, 4, 5])
        //   returns 2: 5
        //   example 3: max(0, 'hello')
        //   returns 3: 0
        //   example 4: max('hello', 0)
        //   returns 4: 'hello'
        //   example 5: max(-1, 'hello')
        //   returns 5: 'hello'
        //   example 6: max([2, 4, 8], [2, 5, 7])
        //   returns 6: [2, 5, 7]
        var ar;
        var retVal;
        var i = 0;
        var n = 0;
        var argv = arguments;
        var argc = argv.length;

        var _obj2Array = function _obj2Array(obj) {
          if (Object.prototype.toString.call(obj) === '[object Array]') {
            return obj;
          } else {
            var ar = [];

            for (var i in obj) {
              if (obj.hasOwnProperty(i)) {
                ar.push(obj[i]);
              }
            }

            return ar;
          }
        };

        var _compare = function _compare(current, next) {
          var i = 0;
          var n = 0;
          var tmp = 0;
          var nl = 0;
          var cl = 0;

          if (current === next) {
            return 0;
          } else if ((typeof current === 'undefined' ? 'undefined' : _typeof(current)) === 'object') {
            if ((typeof next === 'undefined' ? 'undefined' : _typeof(next)) === 'object') {
              current = _obj2Array(current);
              next = _obj2Array(next);
              cl = current.length;
              nl = next.length;

              if (nl > cl) {
                return 1;
              } else if (nl < cl) {
                return -1;
              }

              for (i = 0, n = cl; i < n; ++i) {
                tmp = _compare(current[i], next[i]);

                if (tmp === 1) {
                  return 1;
                } else if (tmp === -1) {
                  return -1;
                }
              }

              return 0;
            }

            return -1;
          } else if ((typeof next === 'undefined' ? 'undefined' : _typeof(next)) === 'object') {
            return 1;
          } else if (isNaN(next) && !isNaN(current)) {
            if (current === 0) {
              return 0;
            }

            return current < 0 ? 1 : -1;
          } else if (isNaN(current) && !isNaN(next)) {
            if (next === 0) {
              return 0;
            }

            return next > 0 ? 1 : -1;
          }

          if (next === current) {
            return 0;
          }

          return next > current ? 1 : -1;
        };

        if (argc === 0) {
          throw new Error('At least one value should be passed to max()');
        } else if (argc === 1) {
          if (_typeof(argv[0]) === 'object') {
            ar = _obj2Array(argv[0]);
          } else {
            throw new Error('Wrong parameter count for max()');
          }

          if (ar.length === 0) {
            throw new Error('Array must contain at least one element for max()');
          }
        } else {
          ar = argv;
        }

        retVal = ar[0];

        for (i = 1, n = ar.length; i < n; ++i) {
          if (_compare(retVal, ar[i]) === 1) {
            retVal = ar[i];
          }
        }

        return retVal;
      };
      /***/

    },
    /* 12 */

    /***/
    function (module, exports) {
      'use strict';

      var _typeof = typeof Symbol === "function" && _typeof2(Symbol.iterator) === "symbol" ? function (obj) {
        return _typeof2(obj);
      } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : _typeof2(obj);
      };

      module.exports = function min() {
        //  discuss at: http://locutus.io/php/min/
        // original by: Onno Marsman (https://twitter.com/onnomarsman)
        //  revised by: Onno Marsman (https://twitter.com/onnomarsman)
        // improved by: Jack
        //      note 1: Long code cause we're aiming for maximum PHP compatibility
        //   example 1: min(1, 3, 5, 6, 7)
        //   returns 1: 1
        //   example 2: min([2, 4, 5])
        //   returns 2: 2
        //   example 3: min(0, 'hello')
        //   returns 3: 0
        //   example 4: min('hello', 0)
        //   returns 4: 'hello'
        //   example 5: min(-1, 'hello')
        //   returns 5: -1
        //   example 6: min([2, 4, 8], [2, 5, 7])
        //   returns 6: [2, 4, 8]
        var ar;
        var retVal;
        var i = 0;
        var n = 0;
        var argv = arguments;
        var argc = argv.length;

        var _obj2Array = function _obj2Array(obj) {
          if (Object.prototype.toString.call(obj) === '[object Array]') {
            return obj;
          }

          var ar = [];

          for (var i in obj) {
            if (obj.hasOwnProperty(i)) {
              ar.push(obj[i]);
            }
          }

          return ar;
        };

        var _compare = function _compare(current, next) {
          var i = 0;
          var n = 0;
          var tmp = 0;
          var nl = 0;
          var cl = 0;

          if (current === next) {
            return 0;
          } else if ((typeof current === 'undefined' ? 'undefined' : _typeof(current)) === 'object') {
            if ((typeof next === 'undefined' ? 'undefined' : _typeof(next)) === 'object') {
              current = _obj2Array(current);
              next = _obj2Array(next);
              cl = current.length;
              nl = next.length;

              if (nl > cl) {
                return 1;
              } else if (nl < cl) {
                return -1;
              }

              for (i = 0, n = cl; i < n; ++i) {
                tmp = _compare(current[i], next[i]);

                if (tmp === 1) {
                  return 1;
                } else if (tmp === -1) {
                  return -1;
                }
              }

              return 0;
            }

            return -1;
          } else if ((typeof next === 'undefined' ? 'undefined' : _typeof(next)) === 'object') {
            return 1;
          } else if (isNaN(next) && !isNaN(current)) {
            if (current === 0) {
              return 0;
            }

            return current < 0 ? 1 : -1;
          } else if (isNaN(current) && !isNaN(next)) {
            if (next === 0) {
              return 0;
            }

            return next > 0 ? 1 : -1;
          }

          if (next === current) {
            return 0;
          }

          return next > current ? 1 : -1;
        };

        if (argc === 0) {
          throw new Error('At least one value should be passed to min()');
        } else if (argc === 1) {
          if (_typeof(argv[0]) === 'object') {
            ar = _obj2Array(argv[0]);
          } else {
            throw new Error('Wrong parameter count for min()');
          }

          if (ar.length === 0) {
            throw new Error('Array must contain at least one element for min()');
          }
        } else {
          ar = argv;
        }

        retVal = ar[0];

        for (i = 1, n = ar.length; i < n; ++i) {
          if (_compare(retVal, ar[i]) === -1) {
            retVal = ar[i];
          }
        }

        return retVal;
      };
      /***/

    },
    /* 13 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function strip_tags(input, allowed) {
        // eslint-disable-line camelcase
        //  discuss at: http://locutus.io/php/strip_tags/
        // original by: Kevin van Zonneveld (http://kvz.io)
        // improved by: Luke Godfrey
        // improved by: Kevin van Zonneveld (http://kvz.io)
        //    input by: Pul
        //    input by: Alex
        //    input by: Marc Palau
        //    input by: Brett Zamir (http://brett-zamir.me)
        //    input by: Bobby Drake
        //    input by: Evertjan Garretsen
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: Eric Nagel
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: Tomasz Wesolowski
        //  revised by: Rafał Kukawski (http://blog.kukawski.pl)
        //   example 1: strip_tags('<p>Kevin</p> <br /><b>van</b> <i>Zonneveld</i>', '<i><b>')
        //   returns 1: 'Kevin <b>van</b> <i>Zonneveld</i>'
        //   example 2: strip_tags('<p>Kevin <img src="someimage.png" onmouseover="someFunction()">van <i>Zonneveld</i></p>', '<p>')
        //   returns 2: '<p>Kevin van Zonneveld</p>'
        //   example 3: strip_tags("<a href='http://kvz.io'>Kevin van Zonneveld</a>", "<a>")
        //   returns 3: "<a href='http://kvz.io'>Kevin van Zonneveld</a>"
        //   example 4: strip_tags('1 < 5 5 > 1')
        //   returns 4: '1 < 5 5 > 1'
        //   example 5: strip_tags('1 <br/> 1')
        //   returns 5: '1  1'
        //   example 6: strip_tags('1 <br/> 1', '<br>')
        //   returns 6: '1 <br/> 1'
        //   example 7: strip_tags('1 <br/> 1', '<br><br/>')
        //   returns 7: '1 <br/> 1'
        // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)
        allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');
        var tags = /<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;
        var commentsAndPhpTags = /<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;
        return input.replace(commentsAndPhpTags, '').replace(tags, function ($0, $1) {
          return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';
        });
      };
      /***/

    },
    /* 14 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function strtotime(text, now) {
        //  discuss at: http://locutus.io/php/strtotime/
        // original by: Caio Ariede (http://caioariede.com)
        // improved by: Kevin van Zonneveld (http://kvz.io)
        // improved by: Caio Ariede (http://caioariede.com)
        // improved by: A. Matías Quezada (http://amatiasq.com)
        // improved by: preuter
        // improved by: Brett Zamir (http://brett-zamir.me)
        // improved by: Mirko Faber
        //    input by: David
        // bugfixed by: Wagner B. Soares
        // bugfixed by: Artur Tchernychev
        // bugfixed by: Stephan Bösch-Plepelits (http://github.com/plepe)
        //      note 1: Examples all have a fixed timestamp to prevent
        //      note 1: tests to fail because of variable time(zones)
        //   example 1: strtotime('+1 day', 1129633200)
        //   returns 1: 1129719600
        //   example 2: strtotime('+1 week 2 days 4 hours 2 seconds', 1129633200)
        //   returns 2: 1130425202
        //   example 3: strtotime('last month', 1129633200)
        //   returns 3: 1127041200
        //   example 4: strtotime('2009-05-04 08:30:00 GMT')
        //   returns 4: 1241425800
        //   example 5: strtotime('2009-05-04 08:30:00+00')
        //   returns 5: 1241425800
        //   example 6: strtotime('2009-05-04 08:30:00+02:00')
        //   returns 6: 1241418600
        //   example 7: strtotime('2009-05-04T08:30:00Z')
        //   returns 7: 1241425800
        var parsed;
        var match;
        var today;
        var year;
        var date;
        var days;
        var ranges;
        var len;
        var times;
        var regex;
        var i;
        var fail = false;

        if (!text) {
          return fail;
        } // Unecessary spaces


        text = text.replace(/^\s+|\s+$/g, '').replace(/\s{2,}/g, ' ').replace(/[\t\r\n]/g, '').toLowerCase(); // in contrast to php, js Date.parse function interprets:
        // dates given as yyyy-mm-dd as in timezone: UTC,
        // dates with "." or "-" as MDY instead of DMY
        // dates with two-digit years differently
        // etc...etc...
        // ...therefore we manually parse lots of common date formats

        var pattern = new RegExp(['^(\\d{1,4})', '([\\-\\.\\/:])', '(\\d{1,2})', '([\\-\\.\\/:])', '(\\d{1,4})', '(?:\\s(\\d{1,2}):(\\d{2})?:?(\\d{2})?)?', '(?:\\s([A-Z]+)?)?$'].join(''));
        match = text.match(pattern);

        if (match && match[2] === match[4]) {
          if (match[1] > 1901) {
            switch (match[2]) {
              case '-':
                // YYYY-M-D
                if (match[3] > 12 || match[5] > 31) {
                  return fail;
                }

                return new Date(match[1], parseInt(match[3], 10) - 1, match[5], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;

              case '.':
                // YYYY.M.D is not parsed by strtotime()
                return fail;

              case '/':
                // YYYY/M/D
                if (match[3] > 12 || match[5] > 31) {
                  return fail;
                }

                return new Date(match[1], parseInt(match[3], 10) - 1, match[5], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;
            }
          } else if (match[5] > 1901) {
            switch (match[2]) {
              case '-':
                // D-M-YYYY
                if (match[3] > 12 || match[1] > 31) {
                  return fail;
                }

                return new Date(match[5], parseInt(match[3], 10) - 1, match[1], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;

              case '.':
                // D.M.YYYY
                if (match[3] > 12 || match[1] > 31) {
                  return fail;
                }

                return new Date(match[5], parseInt(match[3], 10) - 1, match[1], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;

              case '/':
                // M/D/YYYY
                if (match[1] > 12 || match[3] > 31) {
                  return fail;
                }

                return new Date(match[5], parseInt(match[1], 10) - 1, match[3], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;
            }
          } else {
            switch (match[2]) {
              case '-':
                // YY-M-D
                if (match[3] > 12 || match[5] > 31 || match[1] < 70 && match[1] > 38) {
                  return fail;
                }

                year = match[1] >= 0 && match[1] <= 38 ? +match[1] + 2000 : match[1];
                return new Date(year, parseInt(match[3], 10) - 1, match[5], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;

              case '.':
                // D.M.YY or H.MM.SS
                if (match[5] >= 70) {
                  // D.M.YY
                  if (match[3] > 12 || match[1] > 31) {
                    return fail;
                  }

                  return new Date(match[5], parseInt(match[3], 10) - 1, match[1], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;
                }

                if (match[5] < 60 && !match[6]) {
                  // H.MM.SS
                  if (match[1] > 23 || match[3] > 59) {
                    return fail;
                  }

                  today = new Date();
                  return new Date(today.getFullYear(), today.getMonth(), today.getDate(), match[1] || 0, match[3] || 0, match[5] || 0, match[9] || 0) / 1000;
                } // invalid format, cannot be parsed


                return fail;

              case '/':
                // M/D/YY
                if (match[1] > 12 || match[3] > 31 || match[5] < 70 && match[5] > 38) {
                  return fail;
                }

                year = match[5] >= 0 && match[5] <= 38 ? +match[5] + 2000 : match[5];
                return new Date(year, parseInt(match[1], 10) - 1, match[3], match[6] || 0, match[7] || 0, match[8] || 0, match[9] || 0) / 1000;

              case ':':
                // HH:MM:SS
                if (match[1] > 23 || match[3] > 59 || match[5] > 59) {
                  return fail;
                }

                today = new Date();
                return new Date(today.getFullYear(), today.getMonth(), today.getDate(), match[1] || 0, match[3] || 0, match[5] || 0) / 1000;
            }
          }
        } // other formats and "now" should be parsed by Date.parse()


        if (text === 'now') {
          return now === null || isNaN(now) ? new Date().getTime() / 1000 | 0 : now | 0;
        }

        if (!isNaN(parsed = Date.parse(text))) {
          return parsed / 1000 | 0;
        } // Browsers !== Chrome have problems parsing ISO 8601 date strings, as they do
        // not accept lower case characters, space, or shortened time zones.
        // Therefore, fix these problems and try again.
        // Examples:
        //   2015-04-15 20:33:59+02
        //   2015-04-15 20:33:59z
        //   2015-04-15t20:33:59+02:00


        pattern = new RegExp(['^([0-9]{4}-[0-9]{2}-[0-9]{2})', '[ t]', '([0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?)', '([\\+-][0-9]{2}(:[0-9]{2})?|z)'].join(''));
        match = text.match(pattern);

        if (match) {
          // @todo: time zone information
          if (match[4] === 'z') {
            match[4] = 'Z';
          } else if (match[4].match(/^([\+-][0-9]{2})$/)) {
            match[4] = match[4] + ':00';
          }

          if (!isNaN(parsed = Date.parse(match[1] + 'T' + match[2] + match[4]))) {
            return parsed / 1000 | 0;
          }
        }

        date = now ? new Date(now * 1000) : new Date();
        days = {
          'sun': 0,
          'mon': 1,
          'tue': 2,
          'wed': 3,
          'thu': 4,
          'fri': 5,
          'sat': 6
        };
        ranges = {
          'yea': 'FullYear',
          'mon': 'Month',
          'day': 'Date',
          'hou': 'Hours',
          'min': 'Minutes',
          'sec': 'Seconds'
        };

        function lastNext(type, range, modifier) {
          var diff;
          var day = days[range];

          if (typeof day !== 'undefined') {
            diff = day - date.getDay();

            if (diff === 0) {
              diff = 7 * modifier;
            } else if (diff > 0 && type === 'last') {
              diff -= 7;
            } else if (diff < 0 && type === 'next') {
              diff += 7;
            }

            date.setDate(date.getDate() + diff);
          }
        }

        function process(val) {
          // @todo: Reconcile this with regex using \s, taking into account
          // browser issues with split and regexes
          var splt = val.split(' ');
          var type = splt[0];
          var range = splt[1].substring(0, 3);
          var typeIsNumber = /\d+/.test(type);
          var ago = splt[2] === 'ago';
          var num = (type === 'last' ? -1 : 1) * (ago ? -1 : 1);

          if (typeIsNumber) {
            num *= parseInt(type, 10);
          }

          if (ranges.hasOwnProperty(range) && !splt[1].match(/^mon(day|\.)?$/i)) {
            return date['set' + ranges[range]](date['get' + ranges[range]]() + num);
          }

          if (range === 'wee') {
            return date.setDate(date.getDate() + num * 7);
          }

          if (type === 'next' || type === 'last') {
            lastNext(type, range, num);
          } else if (!typeIsNumber) {
            return false;
          }

          return true;
        }

        times = '(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec' + '|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?' + '|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)';
        regex = '([+-]?\\d+\\s' + times + '|' + '(last|next)\\s' + times + ')(\\sago)?';
        match = text.match(new RegExp(regex, 'gi'));

        if (!match) {
          return fail;
        }

        for (i = 0, len = match.length; i < len; i++) {
          if (!process(match[i])) {
            return fail;
          }
        }

        return date.getTime() / 1000;
      };
      /***/

    },
    /* 15 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function date(format, timestamp) {
        //  discuss at: http://locutus.io/php/date/
        // original by: Carlos R. L. Rodrigues (http://www.jsfromhell.com)
        // original by: gettimeofday
        //    parts by: Peter-Paul Koch (http://www.quirksmode.org/js/beat.html)
        // improved by: Kevin van Zonneveld (http://kvz.io)
        // improved by: MeEtc (http://yass.meetcweb.com)
        // improved by: Brad Touesnard
        // improved by: Tim Wiel
        // improved by: Bryan Elliott
        // improved by: David Randall
        // improved by: Theriault (https://github.com/Theriault)
        // improved by: Theriault (https://github.com/Theriault)
        // improved by: Brett Zamir (http://brett-zamir.me)
        // improved by: Theriault (https://github.com/Theriault)
        // improved by: Thomas Beaucourt (http://www.webapp.fr)
        // improved by: JT
        // improved by: Theriault (https://github.com/Theriault)
        // improved by: Rafał Kukawski (http://blog.kukawski.pl)
        // improved by: Theriault (https://github.com/Theriault)
        //    input by: Brett Zamir (http://brett-zamir.me)
        //    input by: majak
        //    input by: Alex
        //    input by: Martin
        //    input by: Alex Wilson
        //    input by: Haravikk
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: majak
        // bugfixed by: Kevin van Zonneveld (http://kvz.io)
        // bugfixed by: Brett Zamir (http://brett-zamir.me)
        // bugfixed by: omid (http://locutus.io/php/380:380#comment_137122)
        // bugfixed by: Chris (http://www.devotis.nl/)
        //      note 1: Uses global: locutus to store the default timezone
        //      note 1: Although the function potentially allows timezone info
        //      note 1: (see notes), it currently does not set
        //      note 1: per a timezone specified by date_default_timezone_set(). Implementers might use
        //      note 1: $locutus.currentTimezoneOffset and
        //      note 1: $locutus.currentTimezoneDST set by that function
        //      note 1: in order to adjust the dates in this function
        //      note 1: (or our other date functions!) accordingly
        //   example 1: date('H:m:s \\m \\i\\s \\m\\o\\n\\t\\h', 1062402400)
        //   returns 1: '07:09:40 m is month'
        //   example 2: date('F j, Y, g:i a', 1062462400)
        //   returns 2: 'September 2, 2003, 12:26 am'
        //   example 3: date('Y W o', 1062462400)
        //   returns 3: '2003 36 2003'
        //   example 4: var $x = date('Y m d', (new Date()).getTime() / 1000)
        //   example 4: $x = $x + ''
        //   example 4: var $result = $x.length // 2009 01 09
        //   returns 4: 10
        //   example 5: date('W', 1104534000)
        //   returns 5: '52'
        //   example 6: date('B t', 1104534000)
        //   returns 6: '999 31'
        //   example 7: date('W U', 1293750000.82); // 2010-12-31
        //   returns 7: '52 1293750000'
        //   example 8: date('W', 1293836400); // 2011-01-01
        //   returns 8: '52'
        //   example 9: date('W Y-m-d', 1293974054); // 2011-01-02
        //   returns 9: '52 2011-01-02'
        //        test: skip-1 skip-2 skip-5
        var jsdate, f; // Keep this here (works, but for code commented-out below for file size reasons)
        // var tal= [];

        var txtWords = ['Sun', 'Mon', 'Tues', 'Wednes', 'Thurs', 'Fri', 'Satur', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']; // trailing backslash -> (dropped)
        // a backslash followed by any character (including backslash) -> the character
        // empty string -> empty string

        var formatChr = /\\?(.?)/gi;

        var formatChrCb = function formatChrCb(t, s) {
          return f[t] ? f[t]() : s;
        };

        var _pad = function _pad(n, c) {
          n = String(n);

          while (n.length < c) {
            n = '0' + n;
          }

          return n;
        };

        f = {
          // Day
          d: function d() {
            // Day of month w/leading 0; 01..31
            return _pad(f.j(), 2);
          },
          D: function D() {
            // Shorthand day name; Mon...Sun
            return f.l().slice(0, 3);
          },
          j: function j() {
            // Day of month; 1..31
            return jsdate.getDate();
          },
          l: function l() {
            // Full day name; Monday...Sunday
            return txtWords[f.w()] + 'day';
          },
          N: function N() {
            // ISO-8601 day of week; 1[Mon]..7[Sun]
            return f.w() || 7;
          },
          S: function S() {
            // Ordinal suffix for day of month; st, nd, rd, th
            var j = f.j();
            var i = j % 10;

            if (i <= 3 && parseInt(j % 100 / 10, 10) === 1) {
              i = 0;
            }

            return ['st', 'nd', 'rd'][i - 1] || 'th';
          },
          w: function w() {
            // Day of week; 0[Sun]..6[Sat]
            return jsdate.getDay();
          },
          z: function z() {
            // Day of year; 0..365
            var a = new Date(f.Y(), f.n() - 1, f.j());
            var b = new Date(f.Y(), 0, 1);
            return Math.round((a - b) / 864e5);
          },
          // Week
          W: function W() {
            // ISO-8601 week number
            var a = new Date(f.Y(), f.n() - 1, f.j() - f.N() + 3);
            var b = new Date(a.getFullYear(), 0, 4);
            return _pad(1 + Math.round((a - b) / 864e5 / 7), 2);
          },
          // Month
          F: function F() {
            // Full month name; January...December
            return txtWords[6 + f.n()];
          },
          m: function m() {
            // Month w/leading 0; 01...12
            return _pad(f.n(), 2);
          },
          M: function M() {
            // Shorthand month name; Jan...Dec
            return f.F().slice(0, 3);
          },
          n: function n() {
            // Month; 1...12
            return jsdate.getMonth() + 1;
          },
          t: function t() {
            // Days in month; 28...31
            return new Date(f.Y(), f.n(), 0).getDate();
          },
          // Year
          L: function L() {
            // Is leap year?; 0 or 1
            var j = f.Y();
            return j % 4 === 0 & j % 100 !== 0 | j % 400 === 0;
          },
          o: function o() {
            // ISO-8601 year
            var n = f.n();
            var W = f.W();
            var Y = f.Y();
            return Y + (n === 12 && W < 9 ? 1 : n === 1 && W > 9 ? -1 : 0);
          },
          Y: function Y() {
            // Full year; e.g. 1980...2010
            return jsdate.getFullYear();
          },
          y: function y() {
            // Last two digits of year; 00...99
            return f.Y().toString().slice(-2);
          },
          // Time
          a: function a() {
            // am or pm
            return jsdate.getHours() > 11 ? 'pm' : 'am';
          },
          A: function A() {
            // AM or PM
            return f.a().toUpperCase();
          },
          B: function B() {
            // Swatch Internet time; 000..999
            var H = jsdate.getUTCHours() * 36e2; // Hours

            var i = jsdate.getUTCMinutes() * 60; // Minutes
            // Seconds

            var s = jsdate.getUTCSeconds();
            return _pad(Math.floor((H + i + s + 36e2) / 86.4) % 1e3, 3);
          },
          g: function g() {
            // 12-Hours; 1..12
            return f.G() % 12 || 12;
          },
          G: function G() {
            // 24-Hours; 0..23
            return jsdate.getHours();
          },
          h: function h() {
            // 12-Hours w/leading 0; 01..12
            return _pad(f.g(), 2);
          },
          H: function H() {
            // 24-Hours w/leading 0; 00..23
            return _pad(f.G(), 2);
          },
          i: function i() {
            // Minutes w/leading 0; 00..59
            return _pad(jsdate.getMinutes(), 2);
          },
          s: function s() {
            // Seconds w/leading 0; 00..59
            return _pad(jsdate.getSeconds(), 2);
          },
          u: function u() {
            // Microseconds; 000000-999000
            return _pad(jsdate.getMilliseconds() * 1000, 6);
          },
          // Timezone
          e: function e() {
            // Timezone identifier; e.g. Atlantic/Azores, ...
            // The following works, but requires inclusion of the very large
            // timezone_abbreviations_list() function.

            /*              return that.date_default_timezone_get();
             */
            var msg = 'Not supported (see source code of date() for timezone on how to add support)';
            throw new Error(msg);
          },
          I: function I() {
            // DST observed?; 0 or 1
            // Compares Jan 1 minus Jan 1 UTC to Jul 1 minus Jul 1 UTC.
            // If they are not equal, then DST is observed.
            var a = new Date(f.Y(), 0); // Jan 1

            var c = Date.UTC(f.Y(), 0); // Jan 1 UTC

            var b = new Date(f.Y(), 6); // Jul 1
            // Jul 1 UTC

            var d = Date.UTC(f.Y(), 6);
            return a - c !== b - d ? 1 : 0;
          },
          O: function O() {
            // Difference to GMT in hour format; e.g. +0200
            var tzo = jsdate.getTimezoneOffset();
            var a = Math.abs(tzo);
            return (tzo > 0 ? '-' : '+') + _pad(Math.floor(a / 60) * 100 + a % 60, 4);
          },
          P: function P() {
            // Difference to GMT w/colon; e.g. +02:00
            var O = f.O();
            return O.substr(0, 3) + ':' + O.substr(3, 2);
          },
          T: function T() {
            // The following works, but requires inclusion of the very
            // large timezone_abbreviations_list() function.

            /*              var abbr, i, os, _default;
            if (!tal.length) {
              tal = that.timezone_abbreviations_list();
            }
            if ($locutus && $locutus.default_timezone) {
              _default = $locutus.default_timezone;
              for (abbr in tal) {
                for (i = 0; i < tal[abbr].length; i++) {
                  if (tal[abbr][i].timezone_id === _default) {
                    return abbr.toUpperCase();
                  }
                }
              }
            }
            for (abbr in tal) {
              for (i = 0; i < tal[abbr].length; i++) {
                os = -jsdate.getTimezoneOffset() * 60;
                if (tal[abbr][i].offset === os) {
                  return abbr.toUpperCase();
                }
              }
            }
            */
            return 'UTC';
          },
          Z: function Z() {
            // Timezone offset in seconds (-43200...50400)
            return -jsdate.getTimezoneOffset() * 60;
          },
          // Full Date/Time
          c: function c() {
            // ISO-8601 date.
            return 'Y-m-d\\TH:i:sP'.replace(formatChr, formatChrCb);
          },
          r: function r() {
            // RFC 2822
            return 'D, d M Y H:i:s O'.replace(formatChr, formatChrCb);
          },
          U: function U() {
            // Seconds since UNIX epoch
            return jsdate / 1000 | 0;
          }
        };

        var _date = function _date(format, timestamp) {
          jsdate = timestamp === undefined ? new Date() // Not provided
          : timestamp instanceof Date ? new Date(timestamp) // JS Date()
          : new Date(timestamp * 1000) // UNIX timestamp (auto-convert to int)
          ;
          return format.replace(formatChr, formatChrCb);
        };

        return _date(format, timestamp);
      };
      /***/

    },
    /* 16 */

    /***/
    function (module, exports) {
      'use strict';

      module.exports = function boolval(mixedVar) {
        // original by: Will Rowe
        //   example 1: boolval(true)
        //   returns 1: true
        //   example 2: boolval(false)
        //   returns 2: false
        //   example 3: boolval(0)
        //   returns 3: false
        //   example 4: boolval(0.0)
        //   returns 4: false
        //   example 5: boolval('')
        //   returns 5: false
        //   example 6: boolval('0')
        //   returns 6: false
        //   example 7: boolval([])
        //   returns 7: false
        //   example 8: boolval('')
        //   returns 8: false
        //   example 9: boolval(null)
        //   returns 9: false
        //   example 10: boolval(undefined)
        //   returns 10: false
        //   example 11: boolval('true')
        //   returns 11: true
        if (mixedVar === false) {
          return false;
        }

        if (mixedVar === 0 || mixedVar === 0.0) {
          return false;
        }

        if (mixedVar === '' || mixedVar === '0') {
          return false;
        }

        if (Array.isArray(mixedVar) && mixedVar.length === 0) {
          return false;
        }

        if (mixedVar === null || mixedVar === undefined) {
          return false;
        }

        return true;
      };
      /***/

    },
    /* 17 */

    /***/
    function (module, exports) {
      module.exports = function (Twig) {
        'use strict';

        Twig.Templates.registerLoader('ajax', function (location, params, callback, error_callback) {
          var template,
              xmlhttp,
              precompiled = params.precompiled,
              parser = this.parsers[params.parser] || this.parser.twig;

          if (typeof XMLHttpRequest === "undefined") {
            throw new Twig.Error('Unsupported platform: Unable to do ajax requests ' + 'because there is no "XMLHTTPRequest" implementation');
          }

          xmlhttp = new XMLHttpRequest();

          xmlhttp.onreadystatechange = function () {
            var data = null;

            if (xmlhttp.readyState === 4) {
              if (xmlhttp.status === 200 || window.cordova && xmlhttp.status == 0) {
                Twig.log.debug("Got template ", xmlhttp.responseText);

                if (precompiled === true) {
                  data = JSON.parse(xmlhttp.responseText);
                } else {
                  data = xmlhttp.responseText;
                }

                params.url = location;
                params.data = data;
                template = parser.call(this, params);

                if (typeof callback === 'function') {
                  callback(template);
                }
              } else {
                if (typeof error_callback === 'function') {
                  error_callback(xmlhttp);
                }
              }
            }
          };

          xmlhttp.open("GET", location, !!params.async);
          xmlhttp.send();

          if (params.async) {
            // TODO: return deferred promise
            return true;
          } else {
            return template;
          }
        });
      };
      /***/

    },
    /* 18 */

    /***/
    function (module, exports, __webpack_require__) {
      module.exports = function (Twig) {
        'use strict';

        var fs, path;

        try {
          // require lib dependencies at runtime
          fs = __webpack_require__(19);
          path = __webpack_require__(20);
        } catch (e) {// NOTE: this is in a try/catch to avoid errors cross platform
        }

        Twig.Templates.registerLoader('fs', function (location, params, callback, error_callback) {
          var template,
              data = null,
              precompiled = params.precompiled,
              parser = this.parsers[params.parser] || this.parser.twig;

          if (!fs || !path) {
            throw new Twig.Error('Unsupported platform: Unable to load from file ' + 'because there is no "fs" or "path" implementation');
          }

          var loadTemplateFn = function loadTemplateFn(err, data) {
            if (err) {
              if (typeof error_callback === 'function') {
                error_callback(err);
              }

              return;
            }

            if (precompiled === true) {
              data = JSON.parse(data);
            }

            params.data = data;
            params.path = params.path || location; // template is in data

            template = parser.call(this, params);

            if (typeof callback === 'function') {
              callback(template);
            }
          };

          params.path = params.path || location;

          if (params.async) {
            fs.stat(params.path, function (err, stats) {
              if (err || !stats.isFile()) {
                if (typeof error_callback === 'function') {
                  error_callback(new Twig.Error('Unable to find template file ' + params.path));
                }

                return;
              }

              fs.readFile(params.path, 'utf8', loadTemplateFn);
            }); // TODO: return deferred promise

            return true;
          } else {
            try {
              if (!fs.statSync(params.path).isFile()) {
                throw new Twig.Error('Unable to find template file ' + params.path);
              }
            } catch (err) {
              throw new Twig.Error('Unable to find template file ' + params.path);
            }

            data = fs.readFileSync(params.path, 'utf8');
            loadTemplateFn(undefined, data);
            return template;
          }
        });
      };
      /***/

    },
    /* 19 */

    /***/
    function (module, exports) {
      module.exports = require("fs");
      /***/
    },
    /* 20 */

    /***/
    function (module, exports) {
      module.exports = require("path");
      /***/
    },
    /* 21 */

    /***/
    function (module, exports) {
      // ## twig.logic.js
      //
      // This file handles tokenizing, compiling and parsing logic tokens. {% ... %}
      module.exports = function (Twig) {
        "use strict";
        /**
         * Namespace for logic handling.
         */

        Twig.logic = {};
        /**
         * Logic token types.
         */

        Twig.logic.type = {
          if_: 'Twig.logic.type.if',
          endif: 'Twig.logic.type.endif',
          for_: 'Twig.logic.type.for',
          endfor: 'Twig.logic.type.endfor',
          else_: 'Twig.logic.type.else',
          elseif: 'Twig.logic.type.elseif',
          set: 'Twig.logic.type.set',
          setcapture: 'Twig.logic.type.setcapture',
          endset: 'Twig.logic.type.endset',
          filter: 'Twig.logic.type.filter',
          endfilter: 'Twig.logic.type.endfilter',
          shortblock: 'Twig.logic.type.shortblock',
          block: 'Twig.logic.type.block',
          endblock: 'Twig.logic.type.endblock',
          extends_: 'Twig.logic.type.extends',
          use: 'Twig.logic.type.use',
          include: 'Twig.logic.type.include',
          spaceless: 'Twig.logic.type.spaceless',
          endspaceless: 'Twig.logic.type.endspaceless',
          macro: 'Twig.logic.type.macro',
          endmacro: 'Twig.logic.type.endmacro',
          import_: 'Twig.logic.type.import',
          from: 'Twig.logic.type.from',
          embed: 'Twig.logic.type.embed',
          endembed: 'Twig.logic.type.endembed'
        }; // Regular expressions for handling logic tokens.
        //
        // Properties:
        //
        //      type:  The type of expression this matches
        //
        //      regex: A regular expression that matches the format of the token
        //
        //      next:  What logic tokens (if any) pop this token off the logic stack. If empty, the
        //             logic token is assumed to not require an end tag and isn't push onto the stack.
        //
        //      open:  Does this tag open a logic expression or is it standalone. For example,
        //             {% endif %} cannot exist without an opening {% if ... %} tag, so open = false.
        //
        //  Functions:
        //
        //      compile: A function that handles compiling the token into an output token ready for
        //               parsing with the parse function.
        //
        //      parse:   A function that parses the compiled token into output (HTML / whatever the
        //               template represents).

        Twig.logic.definitions = [{
          /**
           * If type logic tokens.
           *
           *  Format: {% if expression %}
           */
          type: Twig.logic.type.if_,
          regex: /^if\s+([\s\S]+)$/,
          next: [Twig.logic.type.else_, Twig.logic.type.elseif, Twig.logic.type.endif],
          open: true,
          compile: function compile(token) {
            var expression = token.match[1]; // Compile the expression.

            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this;
            return Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (result) {
              chain = true;

              if (Twig.lib.boolval(result)) {
                chain = false;
                return Twig.parseAsync.apply(that, [token.output, context]);
              }

              return '';
            }).then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          /**
           * Else if type logic tokens.
           *
           *  Format: {% elseif expression %}
           */
          type: Twig.logic.type.elseif,
          regex: /^elseif\s+([^\s].*)$/,
          next: [Twig.logic.type.else_, Twig.logic.type.elseif, Twig.logic.type.endif],
          open: false,
          compile: function compile(token) {
            var expression = token.match[1]; // Compile the expression.

            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this;
            return Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (result) {
              if (chain && Twig.lib.boolval(result)) {
                chain = false;
                return Twig.parseAsync.apply(that, [token.output, context]);
              }

              return '';
            }).then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          /**
           * Else if type logic tokens.
           *
           *  Format: {% elseif expression %}
           */
          type: Twig.logic.type.else_,
          regex: /^else$/,
          next: [Twig.logic.type.endif, Twig.logic.type.endfor],
          open: false,
          parse: function parse(token, context, chain) {
            var promise = Twig.Promise.resolve('');

            if (chain) {
              promise = Twig.parseAsync.apply(this, [token.output, context]);
            }

            return promise.then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          /**
           * End if type logic tokens.
           *
           *  Format: {% endif %}
           */
          type: Twig.logic.type.endif,
          regex: /^endif$/,
          next: [],
          open: false
        }, {
          /**
           * For type logic tokens.
           *
           *  Format: {% for expression %}
           */
          type: Twig.logic.type.for_,
          regex: /^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,
          next: [Twig.logic.type.else_, Twig.logic.type.endfor],
          open: true,
          compile: function compile(token) {
            var key_value = token.match[1],
                expression = token.match[2],
                conditional = token.match[3],
                kv_split = null;
            token.key_var = null;
            token.value_var = null;

            if (key_value.indexOf(",") >= 0) {
              kv_split = key_value.split(',');

              if (kv_split.length === 2) {
                token.key_var = kv_split[0].trim();
                token.value_var = kv_split[1].trim();
              } else {
                throw new Twig.Error("Invalid expression in for loop: " + key_value);
              }
            } else {
              token.value_var = key_value;
            } // Valid expressions for a for loop
            //   for item     in expression
            //   for key,item in expression
            // Compile the expression.


            token.expression = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack; // Compile the conditional (if available)

            if (conditional) {
              token.conditional = Twig.expression.compile.apply(this, [{
                type: Twig.expression.type.expression,
                value: conditional
              }]).stack;
            }

            delete token.match;
            return token;
          },
          parse: function parse(token, context, continue_chain) {
            // Parse expression
            var output = [],
                len,
                index = 0,
                keyset,
                that = this,
                conditional = token.conditional,
                buildLoop = function buildLoop(index, len) {
              var isConditional = conditional !== undefined;
              return {
                index: index + 1,
                index0: index,
                revindex: isConditional ? undefined : len - index,
                revindex0: isConditional ? undefined : len - index - 1,
                first: index === 0,
                last: isConditional ? undefined : index === len - 1,
                length: isConditional ? undefined : len,
                parent: context
              };
            },
                // run once for each iteration of the loop
            loop = function loop(key, value) {
              var inner_context = Twig.ChildContext(context);
              inner_context[token.value_var] = value;

              if (token.key_var) {
                inner_context[token.key_var] = key;
              } // Loop object


              inner_context.loop = buildLoop(index, len);
              var promise = conditional === undefined ? Twig.Promise.resolve(true) : Twig.expression.parseAsync.apply(that, [conditional, inner_context]);
              promise.then(function (condition) {
                if (!condition) return;
                return Twig.parseAsync.apply(that, [token.output, inner_context]).then(function (o) {
                  output.push(o);
                  index += 1;
                });
              }).then(function () {
                // Delete loop-related variables from the context
                delete inner_context['loop'];
                delete inner_context[token.value_var];
                delete inner_context[token.key_var]; // Merge in values that exist in context but have changed
                // in inner_context.

                Twig.merge(context, inner_context, true);
              });
            };

            return Twig.expression.parseAsync.apply(this, [token.expression, context]).then(function (result) {
              if (Twig.lib.is('Array', result)) {
                len = result.length;
                Twig.async.forEach(result, function (value) {
                  var key = index;
                  return loop(key, value);
                });
              } else if (Twig.lib.is('Object', result)) {
                if (result._keys !== undefined) {
                  keyset = result._keys;
                } else {
                  keyset = Object.keys(result);
                }

                len = keyset.length;
                Twig.forEach(keyset, function (key) {
                  // Ignore the _keys property, it's internal to twig.js
                  if (key === "_keys") return;
                  loop(key, result[key]);
                });
              } // Only allow else statements if no output was generated


              continue_chain = output.length === 0;
              return {
                chain: continue_chain,
                output: Twig.output.apply(that, [output])
              };
            });
          }
        }, {
          /**
           * End if type logic tokens.
           *
           *  Format: {% endif %}
           */
          type: Twig.logic.type.endfor,
          regex: /^endfor$/,
          next: [],
          open: false
        }, {
          /**
           * Set type logic tokens.
           *
           *  Format: {% set key = expression %}
           */
          type: Twig.logic.type.set,
          regex: /^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var key = token.match[1].trim(),
                expression = token.match[2],
                // Compile the expression.
            expression_stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            token.key = key;
            token.expression = expression_stack;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, continue_chain) {
            var key = token.key;
            return Twig.expression.parseAsync.apply(this, [token.expression, context]).then(function (value) {
              if (value === context) {
                /*  If storing the context in a variable, it needs to be a clone of the current state of context.
                    Otherwise we have a context with infinite recursion.
                    Fixes #341
                */
                value = Twig.lib.copy(value);
              }

              context[key] = value;
              return {
                chain: continue_chain,
                context: context
              };
            });
          }
        }, {
          /**
           * Set capture type logic tokens.
           *
           *  Format: {% set key %}
           */
          type: Twig.logic.type.setcapture,
          regex: /^set\s+([a-zA-Z0-9_,\s]+)$/,
          next: [Twig.logic.type.endset],
          open: true,
          compile: function compile(token) {
            var key = token.match[1].trim();
            token.key = key;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, continue_chain) {
            var that = this,
                key = token.key;
            return Twig.parseAsync.apply(this, [token.output, context]).then(function (value) {
              // set on both the global and local context
              that.context[key] = value;
              context[key] = value;
              return {
                chain: continue_chain,
                context: context
              };
            });
          }
        }, {
          /**
           * End set type block logic tokens.
           *
           *  Format: {% endset %}
           */
          type: Twig.logic.type.endset,
          regex: /^endset$/,
          next: [],
          open: false
        }, {
          /**
           * Filter logic tokens.
           *
           *  Format: {% filter upper %} or {% filter lower|escape %}
           */
          type: Twig.logic.type.filter,
          regex: /^filter\s+(.+)$/,
          next: [Twig.logic.type.endfilter],
          open: true,
          compile: function compile(token) {
            var expression = "|" + token.match[1].trim(); // Compile the expression.

            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            return Twig.parseAsync.apply(this, [token.output, context]).then(function (unfiltered) {
              var stack = [{
                type: Twig.expression.type.string,
                value: unfiltered
              }].concat(token.stack);
              return Twig.expression.parseAsync.apply(that, [stack, context]);
            }).then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          /**
           * End filter logic tokens.
           *
           *  Format: {% endfilter %}
           */
          type: Twig.logic.type.endfilter,
          regex: /^endfilter$/,
          next: [],
          open: false
        }, {
          /**
           * Block logic tokens.
           *
           *  Format: {% block title %}
           */
          type: Twig.logic.type.block,
          regex: /^block\s+([a-zA-Z0-9_]+)$/,
          next: [Twig.logic.type.endblock],
          open: true,
          compile: function compile(token) {
            token.block = token.match[1].trim();
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this,
                block_output,
                output,
                promise = Twig.Promise.resolve(),
                isImported = Twig.indexOf(this.importedBlocks, token.block) > -1,
                hasParent = this.blocks[token.block] && Twig.indexOf(this.blocks[token.block], Twig.placeholders.parent) > -1; // Don't override previous blocks unless they're imported with "use"
            // Loops should be exempted as well.

            if (this.blocks[token.block] === undefined || isImported || hasParent || context.loop || token.overwrite) {
              if (token.expression) {
                promise = Twig.expression.parseAsync.apply(this, [token.output, context]).then(function (value) {
                  return Twig.expression.parseAsync.apply(that, [{
                    type: Twig.expression.type.string,
                    value: value
                  }, context]);
                });
              } else {
                promise = Twig.parseAsync.apply(this, [token.output, context]).then(function (value) {
                  return Twig.expression.parseAsync.apply(that, [{
                    type: Twig.expression.type.string,
                    value: value
                  }, context]);
                });
              }

              promise = promise.then(function (block_output) {
                if (isImported) {
                  // once the block is overridden, remove it from the list of imported blocks
                  that.importedBlocks.splice(that.importedBlocks.indexOf(token.block), 1);
                }

                if (hasParent) {
                  that.blocks[token.block] = Twig.Markup(that.blocks[token.block].replace(Twig.placeholders.parent, block_output));
                } else {
                  that.blocks[token.block] = block_output;
                }

                that.originalBlockTokens[token.block] = {
                  type: token.type,
                  block: token.block,
                  output: token.output,
                  overwrite: true
                };
              });
            }

            return promise.then(function () {
              // Check if a child block has been set from a template extending this one.
              if (that.child.blocks[token.block]) {
                output = that.child.blocks[token.block];
              } else {
                output = that.blocks[token.block];
              }

              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          /**
           * Block shorthand logic tokens.
           *
           *  Format: {% block title expression %}
           */
          type: Twig.logic.type.shortblock,
          regex: /^block\s+([a-zA-Z0-9_]+)\s+(.+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            token.expression = token.match[2].trim();
            token.output = Twig.expression.compile({
              type: Twig.expression.type.expression,
              value: token.expression
            }).stack;
            token.block = token.match[1].trim();
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            return Twig.logic.handler[Twig.logic.type.block].parse.apply(this, arguments);
          }
        }, {
          /**
           * End block logic tokens.
           *
           *  Format: {% endblock %}
           */
          type: Twig.logic.type.endblock,
          regex: /^endblock(?:\s+([a-zA-Z0-9_]+))?$/,
          next: [],
          open: false
        }, {
          /**
           * Block logic tokens.
           *
           *  Format: {% extends "template.twig" %}
           */
          type: Twig.logic.type.extends_,
          regex: /^extends\s+(.+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var expression = token.match[1].trim();
            delete token.match;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            return token;
          },
          parse: function parse(token, context, chain) {
            var template,
                that = this,
                innerContext = Twig.ChildContext(context); // Resolve filename

            return Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (file) {
              // Set parent template
              that.extend = file;

              if (file instanceof Twig.Template) {
                template = file;
              } else {
                // Import file
                template = that.importFile(file);
              } // Render the template in case it puts anything in its context


              return template.renderAsync(innerContext);
            }).then(function () {
              // Extend the parent context with the extended context
              Twig.lib.extend(context, innerContext);
              return {
                chain: chain,
                output: ''
              };
            });
          }
        }, {
          /**
           * Block logic tokens.
           *
           *  Format: {% use "template.twig" %}
           */
          type: Twig.logic.type.use,
          regex: /^use\s+(.+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var expression = token.match[1].trim();
            delete token.match;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this; // Resolve filename

            return Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (file) {
              // Import blocks
              that.importBlocks(file);
              return {
                chain: chain,
                output: ''
              };
            });
          }
        }, {
          /**
           * Block logic tokens.
           *
           *  Format: {% includes "template.twig" [with {some: 'values'} only] %}
           */
          type: Twig.logic.type.include,
          regex: /^include\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var match = token.match,
                expression = match[1].trim(),
                ignoreMissing = match[2] !== undefined,
                withContext = match[3],
                only = match[4] !== undefined && match[4].length;
            delete token.match;
            token.only = only;
            token.ignoreMissing = ignoreMissing;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;

            if (withContext !== undefined) {
              token.withStack = Twig.expression.compile.apply(this, [{
                type: Twig.expression.type.expression,
                value: withContext.trim()
              }]).stack;
            }

            return token;
          },
          parse: function parse(token, context, chain) {
            // Resolve filename
            var innerContext = {},
                i,
                template,
                that = this,
                promise = Twig.Promise.resolve();

            if (!token.only) {
              innerContext = Twig.ChildContext(context);
            }

            if (token.withStack !== undefined) {
              promise = Twig.expression.parseAsync.apply(this, [token.withStack, context]).then(function (withContext) {
                for (i in withContext) {
                  if (withContext.hasOwnProperty(i)) innerContext[i] = withContext[i];
                }
              });
            }

            return promise.then(function () {
              return Twig.expression.parseAsync.apply(that, [token.stack, context]);
            }).then(function (file) {
              if (file instanceof Twig.Template) {
                template = file;
              } else {
                // Import file
                try {
                  template = that.importFile(file);
                } catch (err) {
                  if (token.ignoreMissing) {
                    return '';
                  }

                  throw err;
                }
              }

              return template.renderAsync(innerContext);
            }).then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, {
          type: Twig.logic.type.spaceless,
          regex: /^spaceless$/,
          next: [Twig.logic.type.endspaceless],
          open: true,
          // Parse the html and return it without any spaces between tags
          parse: function parse(token, context, chain) {
            // Parse the output without any filter
            return Twig.parseAsync.apply(this, [token.output, context]).then(function (unfiltered) {
              var // A regular expression to find closing and opening tags with spaces between them
              rBetweenTagSpaces = />\s+</g,
                  // Replace all space between closing and opening html tags
              output = unfiltered.replace(rBetweenTagSpaces, '><').trim(); // Rewrap output as a Twig.Markup

              output = Twig.Markup(output);
              return {
                chain: chain,
                output: output
              };
            });
          }
        }, // Add the {% endspaceless %} token
        {
          type: Twig.logic.type.endspaceless,
          regex: /^endspaceless$/,
          next: [],
          open: false
        }, {
          /**
           * Macro logic tokens.
           *
           * Format: {% maro input(name, value, type, size) %}
           *
           */
          type: Twig.logic.type.macro,
          regex: /^macro\s+([a-zA-Z0-9_]+)\s*\(\s*((?:[a-zA-Z0-9_]+(?:,\s*)?)*)\s*\)$/,
          next: [Twig.logic.type.endmacro],
          open: true,
          compile: function compile(token) {
            var macroName = token.match[1],
                parameters = token.match[2].split(/[\s,]+/); //TODO: Clean up duplicate check

            for (var i = 0; i < parameters.length; i++) {
              for (var j = 0; j < parameters.length; j++) {
                if (parameters[i] === parameters[j] && i !== j) {
                  throw new Twig.Error("Duplicate arguments for parameter: " + parameters[i]);
                }
              }
            }

            token.macroName = macroName;
            token.parameters = parameters;
            delete token.match;
            return token;
          },
          parse: function parse(token, context, chain) {
            var template = this;

            this.macros[token.macroName] = function () {
              // Pass global context and other macros
              var macroContext = {
                _self: template.macros // Add parameters from context to macroContext

              };

              for (var i = 0; i < token.parameters.length; i++) {
                var prop = token.parameters[i];

                if (typeof arguments[i] !== 'undefined') {
                  macroContext[prop] = arguments[i];
                } else {
                  macroContext[prop] = undefined;
                }
              } // Render


              return Twig.parseAsync.apply(template, [token.output, macroContext]);
            };

            return {
              chain: chain,
              output: ''
            };
          }
        }, {
          /**
           * End macro logic tokens.
           *
           * Format: {% endmacro %}
           */
          type: Twig.logic.type.endmacro,
          regex: /^endmacro$/,
          next: [],
          open: false
        }, {
          /*
          * import logic tokens.
          *
          * Format: {% import "template.twig" as form %}
          */
          type: Twig.logic.type.import_,
          regex: /^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var expression = token.match[1].trim(),
                contextName = token.match[2].trim();
            delete token.match;
            token.expression = expression;
            token.contextName = contextName;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this,
                output = {
              chain: chain,
              output: ''
            };

            if (token.expression === '_self') {
              context[token.contextName] = this.macros;
              return Twig.Promise.resolve(output);
            }

            return Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (file) {
              return that.importFile(file || token.expression);
            }).then(function (template) {
              context[token.contextName] = template.renderAsync({}, {
                output: 'macros'
              });
              return output;
            });
          }
        }, {
          /*
          * from logic tokens.
          *
          * Format: {% from "template.twig" import func as form %}
          */
          type: Twig.logic.type.from,
          regex: /^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,
          next: [],
          open: true,
          compile: function compile(token) {
            var expression = token.match[1].trim(),
                macroExpressions = token.match[2].trim().split(/\s*,\s*/),
                macroNames = {};

            for (var i = 0; i < macroExpressions.length; i++) {
              var res = macroExpressions[i]; // match function as variable

              var macroMatch = res.match(/^([a-zA-Z0-9_]+)\s+as\s+([a-zA-Z0-9_]+)$/);

              if (macroMatch) {
                macroNames[macroMatch[1].trim()] = macroMatch[2].trim();
              } else if (res.match(/^([a-zA-Z0-9_]+)$/)) {
                macroNames[res] = res;
              } else {// ignore import
              }
            }

            delete token.match;
            token.expression = expression;
            token.macroNames = macroNames;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;
            return token;
          },
          parse: function parse(token, context, chain) {
            var that = this,
                promise = Twig.Promise.resolve(this.macros);

            if (token.expression !== "_self") {
              promise = Twig.expression.parseAsync.apply(this, [token.stack, context]).then(function (file) {
                return that.importFile(file || token.expression);
              }).then(function (template) {
                return template.renderAsync({}, {
                  output: 'macros'
                });
              });
            }

            return promise.then(function (macros) {
              for (var macroName in token.macroNames) {
                if (macros.hasOwnProperty(macroName)) {
                  context[token.macroNames[macroName]] = macros[macroName];
                }
              }

              return {
                chain: chain,
                output: ''
              };
            });
          }
        }, {
          /**
           * The embed tag combines the behaviour of include and extends.
           * It allows you to include another template's contents, just like include does.
           *
           *  Format: {% embed "template.twig" [with {some: 'values'} only] %}
           */
          type: Twig.logic.type.embed,
          regex: /^embed\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,
          next: [Twig.logic.type.endembed],
          open: true,
          compile: function compile(token) {
            var match = token.match,
                expression = match[1].trim(),
                ignoreMissing = match[2] !== undefined,
                withContext = match[3],
                only = match[4] !== undefined && match[4].length;
            delete token.match;
            token.only = only;
            token.ignoreMissing = ignoreMissing;
            token.stack = Twig.expression.compile.apply(this, [{
              type: Twig.expression.type.expression,
              value: expression
            }]).stack;

            if (withContext !== undefined) {
              token.withStack = Twig.expression.compile.apply(this, [{
                type: Twig.expression.type.expression,
                value: withContext.trim()
              }]).stack;
            }

            return token;
          },
          parse: function parse(token, context, chain) {
            // Resolve filename
            var innerContext = {},
                that = this,
                i,
                template,
                promise = Twig.Promise.resolve();

            if (!token.only) {
              for (i in context) {
                if (context.hasOwnProperty(i)) innerContext[i] = context[i];
              }
            }

            if (token.withStack !== undefined) {
              promise = Twig.expression.parseAsync.apply(this, [token.withStack, context]).then(function (withContext) {
                for (i in withContext) {
                  if (withContext.hasOwnProperty(i)) innerContext[i] = withContext[i];
                }
              });
            }

            return promise.then(function () {
              return Twig.expression.parseAsync.apply(that, [token.stack, innerContext]);
            }).then(function (file) {
              if (file instanceof Twig.Template) {
                template = file;
              } else {
                // Import file
                try {
                  template = that.importFile(file);
                } catch (err) {
                  if (token.ignoreMissing) {
                    return '';
                  }

                  throw err;
                }
              } // reset previous blocks


              that.blocks = {}; // parse tokens. output will be not used

              return Twig.parseAsync.apply(that, [token.output, innerContext]).then(function () {
                // render tempalte with blocks defined in embed block
                return template.renderAsync(innerContext, {
                  'blocks': that.blocks
                });
              });
            }).then(function (output) {
              return {
                chain: chain,
                output: output
              };
            });
          }
        },
        /* Add the {% endembed %} token
         *
         */
        {
          type: Twig.logic.type.endembed,
          regex: /^endembed$/,
          next: [],
          open: false
        }];
        /**
         * Registry for logic handlers.
         */

        Twig.logic.handler = {};
        /**
         * Define a new token type, available at Twig.logic.type.{type}
         */

        Twig.logic.extendType = function (type, value) {
          value = value || "Twig.logic.type" + type;
          Twig.logic.type[type] = value;
        };
        /**
         * Extend the logic parsing functionality with a new token definition.
         *
         * // Define a new tag
         * Twig.logic.extend({
         *     type: Twig.logic.type.{type},
         *     // The pattern to match for this token
         *     regex: ...,
         *     // What token types can follow this token, leave blank if any.
         *     next: [ ... ]
         *     // Create and return compiled version of the token
         *     compile: function(token) { ... }
         *     // Parse the compiled token with the context provided by the render call
         *     //   and whether this token chain is complete.
         *     parse: function(token, context, chain) { ... }
         * });
         *
         * @param {Object} definition The new logic expression.
         */


        Twig.logic.extend = function (definition) {
          if (!definition.type) {
            throw new Twig.Error("Unable to extend logic definition. No type provided for " + definition);
          } else {
            Twig.logic.extendType(definition.type);
          }

          Twig.logic.handler[definition.type] = definition;
        }; // Extend with built-in expressions


        while (Twig.logic.definitions.length > 0) {
          Twig.logic.extend(Twig.logic.definitions.shift());
        }
        /**
         * Compile a logic token into an object ready for parsing.
         *
         * @param {Object} raw_token An uncompiled logic token.
         *
         * @return {Object} A compiled logic token, ready for parsing.
         */


        Twig.logic.compile = function (raw_token) {
          var expression = raw_token.value.trim(),
              token = Twig.logic.tokenize.apply(this, [expression]),
              token_template = Twig.logic.handler[token.type]; // Check if the token needs compiling

          if (token_template.compile) {
            token = token_template.compile.apply(this, [token]);
            Twig.log.trace("Twig.logic.compile: ", "Compiled logic token to ", token);
          }

          return token;
        };
        /**
         * Tokenize logic expressions. This function matches token expressions against regular
         * expressions provided in token definitions provided with Twig.logic.extend.
         *
         * @param {string} expression the logic token expression to tokenize
         *                (i.e. what's between {% and %})
         *
         * @return {Object} The matched token with type set to the token type and match to the regex match.
         */


        Twig.logic.tokenize = function (expression) {
          var token = {},
              token_template_type = null,
              token_type = null,
              token_regex = null,
              regex_array = null,
              regex = null,
              match = null; // Ignore whitespace around expressions.

          expression = expression.trim();

          for (token_template_type in Twig.logic.handler) {
            if (Twig.logic.handler.hasOwnProperty(token_template_type)) {
              // Get the type and regex for this template type
              token_type = Twig.logic.handler[token_template_type].type;
              token_regex = Twig.logic.handler[token_template_type].regex; // Handle multiple regular expressions per type.

              regex_array = [];

              if (token_regex instanceof Array) {
                regex_array = token_regex;
              } else {
                regex_array.push(token_regex);
              } // Check regular expressions in the order they were specified in the definition.


              while (regex_array.length > 0) {
                regex = regex_array.shift();
                match = regex.exec(expression.trim());

                if (match !== null) {
                  token.type = token_type;
                  token.match = match;
                  Twig.log.trace("Twig.logic.tokenize: ", "Matched a ", token_type, " regular expression of ", match);
                  return token;
                }
              }
            }
          } // No regex matches


          throw new Twig.Error("Unable to parse '" + expression.trim() + "'");
        };
        /**
         * Parse a logic token within a given context.
         *
         * What are logic chains?
         *      Logic chains represent a series of tokens that are connected,
         *          for example:
         *          {% if ... %} {% else %} {% endif %}
         *
         *      The chain parameter is used to signify if a chain is open of closed.
         *      open:
         *          More tokens in this chain should be parsed.
         *      closed:
         *          This token chain has completed parsing and any additional
         *          tokens (else, elseif, etc...) should be ignored.
         *
         * @param {Object} token The compiled token.
         * @param {Object} context The render context.
         * @param {boolean} chain Is this an open logic chain. If false, that means a
         *                        chain is closed and no further cases should be parsed.
         */


        Twig.logic.parse = function (token, context, chain, allow_async) {
          var output = '',
              promise,
              is_async = true,
              token_template;
          context = context || {};
          Twig.log.debug("Twig.logic.parse: ", "Parsing logic token ", token);
          token_template = Twig.logic.handler[token.type];

          if (token_template.parse) {
            output = token_template.parse.apply(this, [token, context, chain]);
          }

          promise = Twig.isPromise(output) ? output : Twig.Promise.resolve(output);
          promise.then(function (o) {
            is_async = false;
            output = o;
          });
          if (allow_async) return promise || Twig.Promise.resolve(output);
          if (is_async) throw new Twig.Error('You are using Twig.js in sync mode in combination with async extensions.');
          return output;
        };

        return Twig;
      };
      /***/

    },
    /* 22 */

    /***/
    function (module, exports) {
      module.exports = function (Twig) {
        'use strict';

        Twig.Templates.registerParser('source', function (params) {
          return params.data || '';
        });
      };
      /***/

    },
    /* 23 */

    /***/
    function (module, exports) {
      module.exports = function (Twig) {
        'use strict';

        Twig.Templates.registerParser('twig', function (params) {
          return new Twig.Template(params);
        });
      };
      /***/

    },
    /* 24 */

    /***/
    function (module, exports, __webpack_require__) {
      // ## twig.path.js
      //
      // This file handles path parsing
      module.exports = function (Twig) {
        "use strict";
        /**
         * Namespace for path handling.
         */

        Twig.path = {};
        /**
         * Generate the canonical version of a url based on the given base path and file path and in
         * the previously registered namespaces.
         *
         * @param  {string} template The Twig Template
         * @param  {string} file     The file path, may be relative and may contain namespaces.
         *
         * @return {string}          The canonical version of the path
         */

        Twig.path.parsePath = function (template, file) {
          var namespaces = null,
              file = file || "";

          if (_typeof2(template) === 'object' && _typeof2(template.options) === 'object') {
            namespaces = template.options.namespaces;
          }

          if (_typeof2(namespaces) === 'object' && file.indexOf('::') > 0 || file.indexOf('@') >= 0) {
            for (var k in namespaces) {
              if (namespaces.hasOwnProperty(k)) {
                file = file.replace(k + '::', namespaces[k]);
                file = file.replace('@' + k, namespaces[k]);
              }
            }

            return file;
          }

          return Twig.path.relativePath(template, file);
        };
        /**
         * Generate the relative canonical version of a url based on the given base path and file path.
         *
         * @param {Twig.Template} template The Twig.Template.
         * @param {string} file The file path, relative to the base path.
         *
         * @return {string} The canonical version of the path.
         */


        Twig.path.relativePath = function (template, file) {
          var base,
              base_path,
              sep_chr = "/",
              new_path = [],
              file = file || "",
              val;

          if (template.url) {
            if (typeof template.base !== 'undefined') {
              base = template.base + (template.base.charAt(template.base.length - 1) === '/' ? '' : '/');
            } else {
              base = template.url;
            }
          } else if (template.path) {
            // Get the system-specific path separator
            var path = __webpack_require__(20),
                sep = path.sep || sep_chr,
                relative = new RegExp("^\\.{1,2}" + sep.replace("\\", "\\\\"));

            file = file.replace(/\//g, sep);

            if (template.base !== undefined && file.match(relative) == null) {
              file = file.replace(template.base, '');
              base = template.base + sep;
            } else {
              base = path.normalize(template.path);
            }

            base = base.replace(sep + sep, sep);
            sep_chr = sep;
          } else if ((template.name || template.id) && template.method && template.method !== 'fs' && template.method !== 'ajax') {
            // Custom registered loader
            base = template.base || template.name || template.id;
          } else {
            throw new Twig.Error("Cannot extend an inline template.");
          }

          base_path = base.split(sep_chr); // Remove file from url

          base_path.pop();
          base_path = base_path.concat(file.split(sep_chr));

          while (base_path.length > 0) {
            val = base_path.shift();

            if (val == ".") {// Ignore
            } else if (val == ".." && new_path.length > 0 && new_path[new_path.length - 1] != "..") {
              new_path.pop();
            } else {
              new_path.push(val);
            }
          }

          return new_path.join(sep_chr);
        };

        return Twig;
      };
      /***/

    },
    /* 25 */

    /***/
    function (module, exports) {
      // ## twig.tests.js
      //
      // This file handles expression tests. (is empty, is not defined, etc...)
      module.exports = function (Twig) {
        "use strict";

        Twig.tests = {
          empty: function empty(value) {
            if (value === null || value === undefined) return true; // Handler numbers

            if (typeof value === "number") return false; // numbers are never "empty"
            // Handle strings and arrays

            if (value.length && value.length > 0) return false; // Handle objects

            for (var key in value) {
              if (value.hasOwnProperty(key)) return false;
            }

            return true;
          },
          odd: function odd(value) {
            return value % 2 === 1;
          },
          even: function even(value) {
            return value % 2 === 0;
          },
          divisibleby: function divisibleby(value, params) {
            return value % params[0] === 0;
          },
          defined: function defined(value) {
            return value !== undefined;
          },
          none: function none(value) {
            return value === null;
          },
          'null': function _null(value) {
            return this.none(value); // Alias of none
          },
          'same as': function sameAs(value, params) {
            return value === params[0];
          },
          sameas: function sameas(value, params) {
            console.warn('`sameas` is deprecated use `same as`');
            return Twig.tests['same as'](value, params);
          },
          iterable: function iterable(value) {
            return value && (Twig.lib.is("Array", value) || Twig.lib.is("Object", value));
          }
          /*
          constant ?
           */

        };

        Twig.test = function (test, value, params) {
          if (!Twig.tests[test]) {
            throw "Test " + test + " is not defined.";
          }

          return Twig.tests[test](value, params);
        };

        Twig.test.extend = function (test, definition) {
          Twig.tests[test] = definition;
        };

        return Twig;
      };
      /***/

    },
    /* 26 */

    /***/
    function (module, exports) {
      // ## twig.async.js
      //
      // This file handles asynchronous tasks within twig.
      module.exports = function (Twig) {
        "use strict";

        Twig.parseAsync = function (tokens, context) {
          return Twig.parse.apply(this, [tokens, context, true]);
        };

        Twig.expression.parseAsync = function (tokens, context, tokens_are_parameters) {
          return Twig.expression.parse.apply(this, [tokens, context, tokens_are_parameters, true]);
        };

        Twig.logic.parseAsync = function (token, context, chain) {
          return Twig.logic.parse.apply(this, [token, context, chain, true]);
        };

        Twig.Template.prototype.renderAsync = function (context, params) {
          return this.render(context, params, true);
        };

        Twig.async = {};
        /**
         * Checks for `thenable` objects
         */

        Twig.isPromise = function (obj) {
          return obj && typeof obj.then == 'function';
        };
        /**
         * An alternate implementation of a Promise that does not fully follow
         * the spec, but instead works fully synchronous while still being
         * thenable.
         *
         * These promises can be mixed with regular promises at which point
         * the synchronous behaviour is lost.
         */


        Twig.Promise = function (executor) {
          // State
          var state = 'unknown';
          var value = null;
          var handlers = null;

          function changeState(newState, v) {
            state = newState;
            value = v;
            notify();
          }

          ;

          function onResolve(v) {
            changeState('resolve', v);
          }

          function onReject(e) {
            changeState('reject', e);
          }

          function notify() {
            if (!handlers) return;
            Twig.forEach(handlers, function (h) {
              append(h.resolve, h.reject);
            });
            handlers = null;
          }

          function append(onResolved, onRejected) {
            var h = {
              resolve: onResolved,
              reject: onRejected
            }; // The promise has yet to be rejected or resolved.

            if (state == 'unknown') {
              handlers = handlers || [];
              return handlers.push(h);
            } // The state has been changed to either resolve, or reject
            // which means we should call the handler.


            if (h[state]) h[state](value);
          }

          function run(fn, resolve, reject) {
            var done = false;

            try {
              fn(function (v) {
                if (done) return;
                done = true;
                resolve(v);
              }, function (e) {
                if (done) return;
                done = true;
                reject(e);
              });
            } catch (e) {
              done = true;
              reject(e);
            }
          }

          function ready(result) {
            try {
              if (!Twig.isPromise(result)) {
                return onResolve(result);
              }

              run(result.then.bind(result), ready, onReject);
            } catch (e) {
              onReject(e);
            }
          }

          run(executor, ready, onReject);
          return {
            then: function then(onResolved, onRejected) {
              var hasResolved = typeof onResolved == 'function';
              var hasRejected = typeof onRejected == 'function';
              return new Twig.Promise(function (resolve, reject) {
                append(function (result) {
                  if (hasResolved) {
                    try {
                      resolve(onResolved(result));
                    } catch (e) {
                      reject(e);
                    }
                  } else {
                    resolve(result);
                  }
                }, function (err) {
                  if (hasRejected) {
                    try {
                      resolve(onRejected(err));
                    } catch (e) {
                      reject(e);
                    }
                  } else {
                    reject(err);
                  }
                });
              });
            },
            catch: function _catch(onRejected) {
              return this.then(null, onRejected);
            }
          };
        };

        Twig.Promise.resolve = function (value) {
          return new Twig.Promise(function (resolve) {
            resolve(value);
          });
        };

        Twig.Promise.reject = function (e) {
          return new Twig.Promise(function (resolve, reject) {
            reject(e);
          });
        };

        Twig.Promise.all = function (promises) {
          var results = [];
          return Twig.async.forEach(promises, function (p, index) {
            if (!Twig.isPromise(p)) {
              results[index] = p;
              return;
            }

            return p.then(function (v) {
              results[index] = v;
            });
          }).then(function () {
            return results;
          });
        };
        /**
        * Go over each item in a fashion compatible with Twig.forEach,
        * allow the function to return a promise or call the third argument
        * to signal it is finished.
        *
        * Each item in the array will be called sequentially.
        */


        Twig.async.forEach = function forEachAsync(arr, callback) {
          var arg_index = 0;
          var callbacks = {};
          var promise = new Twig.Promise(function (resolve, reject) {
            callbacks = {
              resolve: resolve,
              reject: reject
            };
          });

          function fail(err) {
            callbacks.reject(err);
          }

          function next(value) {
            if (!Twig.isPromise(value)) return iterate();
            value.then(next, fail);
          }

          function iterate() {
            var index = arg_index++;

            if (index == arr.length) {
              callbacks.resolve();
              return;
            }

            next(callback(arr[index], index));
          }

          iterate();
          return promise;
        };

        return Twig;
      };
      /***/

    },
    /* 27 */

    /***/
    function (module, exports) {
      // ## twig.exports.js
      //
      // This file provides extension points and other hooks into the twig functionality.
      module.exports = function (Twig) {
        "use strict";

        Twig.exports = {
          VERSION: Twig.VERSION
        };
        /**
         * Create and compile a twig.js template.
         *
         * @param {Object} param Paramteres for creating a Twig template.
         *
         * @return {Twig.Template} A Twig template ready for rendering.
         */

        Twig.exports.twig = function twig(params) {
          'use strict';

          var id = params.id,
              options = {
            strict_variables: params.strict_variables || false,
            // TODO: turn autoscape on in the next major version
            autoescape: params.autoescape != null && params.autoescape || false,
            allowInlineIncludes: params.allowInlineIncludes || false,
            rethrow: params.rethrow || false,
            namespaces: params.namespaces
          };

          if (Twig.cache && id) {
            Twig.validateId(id);
          }

          if (params.debug !== undefined) {
            Twig.debug = params.debug;
          }

          if (params.trace !== undefined) {
            Twig.trace = params.trace;
          }

          if (params.data !== undefined) {
            return Twig.Templates.parsers.twig({
              data: params.data,
              path: params.hasOwnProperty('path') ? params.path : undefined,
              module: params.module,
              id: id,
              options: options
            });
          } else if (params.ref !== undefined) {
            if (params.id !== undefined) {
              throw new Twig.Error("Both ref and id cannot be set on a twig.js template.");
            }

            return Twig.Templates.load(params.ref);
          } else if (params.method !== undefined) {
            if (!Twig.Templates.isRegisteredLoader(params.method)) {
              throw new Twig.Error('Loader for "' + params.method + '" is not defined.');
            }

            return Twig.Templates.loadRemote(params.name || params.href || params.path || id || undefined, {
              id: id,
              method: params.method,
              parser: params.parser || 'twig',
              base: params.base,
              module: params.module,
              precompiled: params.precompiled,
              async: params.async,
              options: options
            }, params.load, params.error);
          } else if (params.href !== undefined) {
            return Twig.Templates.loadRemote(params.href, {
              id: id,
              method: 'ajax',
              parser: params.parser || 'twig',
              base: params.base,
              module: params.module,
              precompiled: params.precompiled,
              async: params.async,
              options: options
            }, params.load, params.error);
          } else if (params.path !== undefined) {
            return Twig.Templates.loadRemote(params.path, {
              id: id,
              method: 'fs',
              parser: params.parser || 'twig',
              base: params.base,
              module: params.module,
              precompiled: params.precompiled,
              async: params.async,
              options: options
            }, params.load, params.error);
          }
        }; // Extend Twig with a new filter.


        Twig.exports.extendFilter = function (filter, definition) {
          Twig.filter.extend(filter, definition);
        }; // Extend Twig with a new function.


        Twig.exports.extendFunction = function (fn, definition) {
          Twig._function.extend(fn, definition);
        }; // Extend Twig with a new test.


        Twig.exports.extendTest = function (test, definition) {
          Twig.test.extend(test, definition);
        }; // Extend Twig with a new definition.


        Twig.exports.extendTag = function (definition) {
          Twig.logic.extend(definition);
        }; // Provide an environment for extending Twig core.
        // Calls fn with the internal Twig object.


        Twig.exports.extend = function (fn) {
          fn(Twig);
        };
        /**
         * Provide an extension for use with express 2.
         *
         * @param {string} markup The template markup.
         * @param {array} options The express options.
         *
         * @return {string} The rendered template.
         */


        Twig.exports.compile = function (markup, options) {
          var id = options.filename,
              path = options.filename,
              template; // Try to load the template from the cache

          template = new Twig.Template({
            data: markup,
            path: path,
            id: id,
            options: options.settings['twig options']
          }); // Twig.Templates.load(id) ||

          return function (context) {
            return template.render(context);
          };
        };
        /**
         * Provide an extension for use with express 3.
         *
         * @param {string} path The location of the template file on disk.
         * @param {Object|Function} The options or callback.
         * @param {Function} fn callback.
         * 
         * @throws Twig.Error
         */


        Twig.exports.renderFile = function (path, options, fn) {
          // handle callback in options
          if (typeof options === 'function') {
            fn = options;
            options = {};
          }

          options = options || {};
          var settings = options.settings || {};
          var params = {
            path: path,
            base: settings.views,
            load: function load(template) {
              // render and return template as a simple string, see https://github.com/twigjs/twig.js/pull/348 for more information
              fn(null, '' + template.render(options));
            }
          }; // mixin any options provided to the express app.

          var view_options = settings['twig options'];

          if (view_options) {
            for (var option in view_options) {
              if (view_options.hasOwnProperty(option)) {
                params[option] = view_options[option];
              }
            }
          }

          Twig.exports.twig(params);
        }; // Express 3 handler


        Twig.exports.__express = Twig.exports.renderFile;
        /**
         * Shoud Twig.js cache templates.
         * Disable during development to see changes to templates without
         * reloading, and disable in production to improve performance.
         *
         * @param {boolean} cache
         */

        Twig.exports.cache = function (cache) {
          Twig.cache = cache;
        }; //We need to export the path module so we can effectively test it


        Twig.exports.path = Twig.path; //Export our filters.
        //Resolves #307

        Twig.exports.filters = Twig.filters;
        return Twig;
      };
      /***/

    }
    /******/
    ])
  );
});

;/**
 * Bunch of useful filters for angularJS(with no external dependencies!)
 * @version v0.5.17 - 2017-09-22 * @link https://github.com/a8m/angular-filter
 * @author Ariel Mashraki <ariel@mashraki.co.il>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function (a, b, c) {
  "use strict";

  function d(a) {
    return E(a) ? a : Object.keys(a).map(function (b) {
      return a[b];
    });
  }

  function e(a) {
    return null === a;
  }

  function f(a, b) {
    var d = Object.keys(a);
    return d.map(function (d) {
      return b[d] !== c && b[d] == a[d];
    }).indexOf(!1) == -1;
  }

  function g(a, b) {
    function c(a, b, c) {
      for (var d = 0; b + d <= a.length;) {
        if (a.charAt(b + d) == c) return d;
        d++;
      }

      return -1;
    }

    for (var d = 0, e = 0; e <= b.length; e++) {
      var f = c(a, d, b.charAt(e));
      if (f == -1) return !1;
      d += f + 1;
    }

    return !0;
  }

  function h(a, b, c) {
    var d = 0;
    return a.filter(function (a) {
      var e = y(c) ? d < b && c(a) : d < b;
      return d = e ? d + 1 : d, e;
    });
  }

  function i(a, b) {
    return Math.round(a * Math.pow(10, b)) / Math.pow(10, b);
  }

  function j(a, b, c) {
    b = b || [];
    var d = Object.keys(a);
    return d.forEach(function (d) {
      if (D(a[d]) && !E(a[d])) {
        var e = c ? c + "." + d : c;
        j(a[d], b, e || d);
      } else {
        var f = c ? c + "." + d : d;
        b.push(f);
      }
    }), b;
  }

  function k(a) {
    return a && a.$evalAsync && a.$watch;
  }

  function l() {
    return function (a, b) {
      return a > b;
    };
  }

  function m() {
    return function (a, b) {
      return a >= b;
    };
  }

  function n() {
    return function (a, b) {
      return a < b;
    };
  }

  function o() {
    return function (a, b) {
      return a <= b;
    };
  }

  function p() {
    return function (a, b) {
      return a == b;
    };
  }

  function q() {
    return function (a, b) {
      return a != b;
    };
  }

  function r() {
    return function (a, b) {
      return a === b;
    };
  }

  function s() {
    return function (a, b) {
      return a !== b;
    };
  }

  function t(a) {
    return function (b, c) {
      return b = D(b) ? d(b) : b, !(!E(b) || z(c)) && b.some(function (b) {
        return B(c) && D(b) || A(c) ? a(c)(b) : b === c;
      });
    };
  }

  function u(a, b) {
    return b = b || 0, b >= a.length ? a : E(a[b]) ? u(a.slice(0, b).concat(a[b], a.slice(b + 1)), b) : u(a, b + 1);
  }

  function v(a) {
    return function (b, c) {
      function e(a, b) {
        return !z(b) && a.some(function (a) {
          return I(a, b);
        });
      }

      if (b = D(b) ? d(b) : b, !E(b)) return b;
      var f = [],
          g = a(c);
      return z(c) ? b.filter(function (a, b, c) {
        return c.indexOf(a) === b;
      }) : b.filter(function (a) {
        var b = g(a);
        return !e(f, b) && (f.push(b), !0);
      });
    };
  }

  function w(a, b, c) {
    return b ? a + c + w(a, --b, c) : a;
  }

  function x() {
    return function (a) {
      return B(a) ? a.split(" ").map(function (a) {
        return a.charAt(0).toUpperCase() + a.substring(1);
      }).join(" ") : a;
    };
  }

  var y = b.isDefined,
      z = b.isUndefined,
      A = b.isFunction,
      B = b.isString,
      C = b.isNumber,
      D = b.isObject,
      E = b.isArray,
      F = b.forEach,
      G = b.extend,
      H = b.copy,
      I = b.equals;
  String.prototype.contains || (String.prototype.contains = function () {
    return String.prototype.indexOf.apply(this, arguments) !== -1;
  }), b.module("a8m.angular", []).filter("isUndefined", function () {
    return function (a) {
      return b.isUndefined(a);
    };
  }).filter("isDefined", function () {
    return function (a) {
      return b.isDefined(a);
    };
  }).filter("isFunction", function () {
    return function (a) {
      return b.isFunction(a);
    };
  }).filter("isString", function () {
    return function (a) {
      return b.isString(a);
    };
  }).filter("isNumber", function () {
    return function (a) {
      return b.isNumber(a);
    };
  }).filter("isArray", function () {
    return function (a) {
      return b.isArray(a);
    };
  }).filter("isObject", function () {
    return function (a) {
      return b.isObject(a);
    };
  }).filter("isEqual", function () {
    return function (a, c) {
      return b.equals(a, c);
    };
  }), b.module("a8m.conditions", []).filter({
    isGreaterThan: l,
    ">": l,
    isGreaterThanOrEqualTo: m,
    ">=": m,
    isLessThan: n,
    "<": n,
    isLessThanOrEqualTo: o,
    "<=": o,
    isEqualTo: p,
    "==": p,
    isNotEqualTo: q,
    "!=": q,
    isIdenticalTo: r,
    "===": r,
    isNotIdenticalTo: s,
    "!==": s
  }), b.module("a8m.is-null", []).filter("isNull", function () {
    return function (a) {
      return e(a);
    };
  }), b.module("a8m.after-where", []).filter("afterWhere", function () {
    return function (a, b) {
      if (a = D(a) ? d(a) : a, !E(a) || z(b)) return a;
      var c = a.map(function (a) {
        return f(b, a);
      }).indexOf(!0);
      return a.slice(c === -1 ? 0 : c);
    };
  }), b.module("a8m.after", []).filter("after", function () {
    return function (a, b) {
      return a = D(a) ? d(a) : a, E(a) ? a.slice(b) : a;
    };
  }), b.module("a8m.before-where", []).filter("beforeWhere", function () {
    return function (a, b) {
      if (a = D(a) ? d(a) : a, !E(a) || z(b)) return a;
      var c = a.map(function (a) {
        return f(b, a);
      }).indexOf(!0);
      return a.slice(0, c === -1 ? a.length : ++c);
    };
  }), b.module("a8m.before", []).filter("before", function () {
    return function (a, b) {
      return a = D(a) ? d(a) : a, E(a) ? a.slice(0, b ? --b : b) : a;
    };
  }), b.module("a8m.chunk-by", ["a8m.filter-watcher"]).filter("chunkBy", ["filterWatcher", function (a) {
    return function (b, c, d) {
      function e(a, b) {
        for (var c = []; a--;) {
          c[a] = b;
        }

        return c;
      }

      function f(a, b, c) {
        return E(a) ? a.map(function (a, d, f) {
          return d *= b, a = f.slice(d, d + b), !z(c) && a.length < b ? a.concat(e(b - a.length, c)) : a;
        }).slice(0, Math.ceil(a.length / b)) : a;
      }

      return a.isMemoized("chunkBy", arguments) || a.memoize("chunkBy", arguments, this, f(b, c, d));
    };
  }]), b.module("a8m.concat", []).filter("concat", [function () {
    return function (a, b) {
      if (z(b)) return a;
      if (E(a)) return D(b) ? a.concat(d(b)) : a.concat(b);

      if (D(a)) {
        var c = d(a);
        return D(b) ? c.concat(d(b)) : c.concat(b);
      }

      return a;
    };
  }]), b.module("a8m.contains", []).filter({
    contains: ["$parse", t],
    some: ["$parse", t]
  }), b.module("a8m.count-by", []).filter("countBy", ["$parse", function (a) {
    return function (b, c) {
      var e,
          f = {},
          g = a(c);
      return b = D(b) ? d(b) : b, !E(b) || z(c) ? b : (b.forEach(function (a) {
        e = g(a), f[e] || (f[e] = 0), f[e]++;
      }), f);
    };
  }]), b.module("a8m.defaults", []).filter("defaults", ["$parse", function (a) {
    return function (b, c) {
      if (b = D(b) ? d(b) : b, !E(b) || !D(c)) return b;
      var e = j(c);
      return b.forEach(function (b) {
        e.forEach(function (d) {
          var e = a(d),
              f = e.assign;
          z(e(b)) && f(b, e(c));
        });
      }), b;
    };
  }]), b.module("a8m.every", []).filter("every", ["$parse", function (a) {
    return function (b, c) {
      return b = D(b) ? d(b) : b, !(E(b) && !z(c)) || b.every(function (b) {
        return D(b) || A(c) ? a(c)(b) : b === c;
      });
    };
  }]), b.module("a8m.filter-by", []).filter("filterBy", ["$parse", function (a) {
    return function (b, e, f, g) {
      var h;
      return f = B(f) || C(f) ? String(f).toLowerCase() : c, b = D(b) ? d(b) : b, !E(b) || z(f) ? b : b.filter(function (b) {
        return e.some(function (c) {
          if (~c.indexOf("+")) {
            var d = c.replace(/\s+/g, "").split("+");
            h = d.map(function (c) {
              return a(c)(b);
            }).join(" ");
          } else h = a(c)(b);

          return !(!B(h) && !C(h)) && (h = String(h).toLowerCase(), g ? h === f : h.contains(f));
        });
      });
    };
  }]), b.module("a8m.first", []).filter("first", ["$parse", function (a) {
    return function (b) {
      var e, f, g;
      return b = D(b) ? d(b) : b, E(b) ? (g = Array.prototype.slice.call(arguments, 1), e = C(g[0]) ? g[0] : 1, f = C(g[0]) ? C(g[1]) ? c : g[1] : g[0], g.length ? h(b, e, f ? a(f) : f) : b[0]) : b;
    };
  }]), b.module("a8m.flatten", []).filter("flatten", function () {
    return function (a, b) {
      return b = b || !1, a = D(a) ? d(a) : a, E(a) ? b ? [].concat.apply([], a) : u(a, 0) : a;
    };
  }), b.module("a8m.fuzzy-by", []).filter("fuzzyBy", ["$parse", function (a) {
    return function (b, c, e, f) {
      var h,
          i,
          j = f || !1;
      return b = D(b) ? d(b) : b, !E(b) || z(c) || z(e) ? b : (i = a(c), b.filter(function (a) {
        return h = i(a), !!B(h) && (h = j ? h : h.toLowerCase(), e = j ? e : e.toLowerCase(), g(h, e) !== !1);
      }));
    };
  }]), b.module("a8m.fuzzy", []).filter("fuzzy", function () {
    return function (a, b, c) {
      function e(a, b) {
        var c,
            d,
            e = Object.keys(a);
        return 0 < e.filter(function (e) {
          return c = a[e], !!d || !!B(c) && (c = f ? c : c.toLowerCase(), d = g(c, b) !== !1);
        }).length;
      }

      var f = c || !1;
      return a = D(a) ? d(a) : a, !E(a) || z(b) ? a : (b = f ? b : b.toLowerCase(), a.filter(function (a) {
        return B(a) ? (a = f ? a : a.toLowerCase(), g(a, b) !== !1) : !!D(a) && e(a, b);
      }));
    };
  }), b.module("a8m.group-by", ["a8m.filter-watcher"]).filter("groupBy", ["$parse", "filterWatcher", function (a, b) {
    return function (c, d) {
      function e(a, b) {
        var c,
            d = {};
        return F(a, function (a) {
          c = b(a), d[c] || (d[c] = []), d[c].push(a);
        }), d;
      }

      return !D(c) || z(d) ? c : b.isMemoized("groupBy", arguments) || b.memoize("groupBy", arguments, this, e(c, a(d)));
    };
  }]), b.module("a8m.is-empty", []).filter("isEmpty", function () {
    return function (a) {
      return D(a) ? !d(a).length : !a.length;
    };
  }), b.module("a8m.join", []).filter("join", function () {
    return function (a, b) {
      return z(a) || !E(a) ? a : (z(b) && (b = " "), a.join(b));
    };
  }), b.module("a8m.last", []).filter("last", ["$parse", function (a) {
    return function (b) {
      var e,
          f,
          g,
          i = H(b);
      return i = D(i) ? d(i) : i, E(i) ? (g = Array.prototype.slice.call(arguments, 1), e = C(g[0]) ? g[0] : 1, f = C(g[0]) ? C(g[1]) ? c : g[1] : g[0], g.length ? h(i.reverse(), e, f ? a(f) : f).reverse() : i[i.length - 1]) : i;
    };
  }]), b.module("a8m.map", []).filter("map", ["$parse", function (a) {
    return function (b, c) {
      return b = D(b) ? d(b) : b, !E(b) || z(c) ? b : b.map(function (b) {
        return a(c)(b);
      });
    };
  }]), b.module("a8m.omit", []).filter("omit", ["$parse", function (a) {
    return function (b, c) {
      return b = D(b) ? d(b) : b, !E(b) || z(c) ? b : b.filter(function (b) {
        return !a(c)(b);
      });
    };
  }]), b.module("a8m.pick", []).filter("pick", ["$parse", function (a) {
    return function (b, c) {
      return b = D(b) ? d(b) : b, !E(b) || z(c) ? b : b.filter(function (b) {
        return a(c)(b);
      });
    };
  }]), b.module("a8m.range", []).filter("range", function () {
    return function (a, b, c, d, e) {
      c = c || 0, d = d || 1;

      for (var f = 0; f < parseInt(b); f++) {
        var g = c + f * d;
        a.push(A(e) ? e(g) : g);
      }

      return a;
    };
  }), b.module("a8m.remove-with", []).filter("removeWith", function () {
    return function (a, b) {
      return z(b) ? a : (a = D(a) ? d(a) : a, a.filter(function (a) {
        return !f(b, a);
      }));
    };
  }), b.module("a8m.remove", []).filter("remove", function () {
    return function (a) {
      a = D(a) ? d(a) : a;
      var b = Array.prototype.slice.call(arguments, 1);
      return E(a) ? a.filter(function (a) {
        return !b.some(function (b) {
          return I(b, a);
        });
      }) : a;
    };
  }), b.module("a8m.reverse", []).filter("reverse", [function () {
    return function (a) {
      return a = D(a) ? d(a) : a, B(a) ? a.split("").reverse().join("") : E(a) ? a.slice().reverse() : a;
    };
  }]), b.module("a8m.search-field", []).filter("searchField", ["$parse", function (a) {
    return function (b) {
      var c, e;
      b = D(b) ? d(b) : b;
      var f = Array.prototype.slice.call(arguments, 1);
      return E(b) && f.length ? b.map(function (b) {
        return e = f.map(function (d) {
          return (c = a(d))(b);
        }).join(" "), G(b, {
          searchField: e
        });
      }) : b;
    };
  }]), b.module("a8m.to-array", []).filter("toArray", function () {
    return function (a, b) {
      return D(a) ? b ? Object.keys(a).map(function (b) {
        return G(a[b], {
          $key: b
        });
      }) : d(a) : a;
    };
  }), b.module("a8m.unique", []).filter({
    unique: ["$parse", v],
    uniq: ["$parse", v]
  }), b.module("a8m.where", []).filter("where", function () {
    return function (a, b) {
      return z(b) ? a : (a = D(a) ? d(a) : a, a.filter(function (a) {
        return f(b, a);
      }));
    };
  }), b.module("a8m.xor", []).filter("xor", ["$parse", function (a) {
    return function (b, c, e) {
      function f(b, c) {
        var d = a(e);
        return c.some(function (a) {
          return e ? I(d(a), d(b)) : I(a, b);
        });
      }

      return e = e || !1, b = D(b) ? d(b) : b, c = D(c) ? d(c) : c, E(b) && E(c) ? b.concat(c).filter(function (a) {
        return !(f(a, b) && f(a, c));
      }) : b;
    };
  }]), b.module("a8m.math.abs", []).filter("abs", function () {
    return function (a) {
      return Math.abs(a);
    };
  }), b.module("a8m.math.byteFmt", []).filter("byteFmt", function () {
    var a = [{
      str: "B",
      val: 1024
    }];
    return ["KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"].forEach(function (b, c) {
      a.push({
        str: b,
        val: 1024 * a[c].val
      });
    }), function (b, c) {
      if (C(c) && isFinite(c) && c % 1 === 0 && c >= 0 && C(b) && isFinite(b)) {
        for (var d = 0; d < a.length - 1 && b >= a[d].val;) {
          d++;
        }

        return b /= d > 0 ? a[d - 1].val : 1, i(b, c) + " " + a[d].str;
      }

      return "NaN";
    };
  }), b.module("a8m.math.degrees", []).filter("degrees", function () {
    return function (a, b) {
      if (C(b) && isFinite(b) && b % 1 === 0 && b >= 0 && C(a) && isFinite(a)) {
        var c = 180 * a / Math.PI;
        return Math.round(c * Math.pow(10, b)) / Math.pow(10, b);
      }

      return "NaN";
    };
  }), b.module("a8m.math.kbFmt", []).filter("kbFmt", function () {
    var a = [{
      str: "KB",
      val: 1024
    }];
    return ["MB", "GB", "TB", "PB", "EB", "ZB", "YB"].forEach(function (b, c) {
      a.push({
        str: b,
        val: 1024 * a[c].val
      });
    }), function (b, c) {
      if (C(c) && isFinite(c) && c % 1 === 0 && c >= 0 && C(b) && isFinite(b)) {
        for (var d = 0; d < a.length - 1 && b >= a[d].val;) {
          d++;
        }

        return b /= d > 0 ? a[d - 1].val : 1, i(b, c) + " " + a[d].str;
      }

      return "NaN";
    };
  }), b.module("a8m.math.max", []).filter("max", ["$parse", function (a) {
    function b(b, c) {
      var d = b.map(function (b) {
        return a(c)(b);
      });
      return d.indexOf(Math.max.apply(Math, d));
    }

    return function (a, c) {
      return E(a) ? z(c) ? Math.max.apply(Math, a) : a[b(a, c)] : a;
    };
  }]), b.module("a8m.math.min", []).filter("min", ["$parse", function (a) {
    function b(b, c) {
      var d = b.map(function (b) {
        return a(c)(b);
      });
      return d.indexOf(Math.min.apply(Math, d));
    }

    return function (a, c) {
      return E(a) ? z(c) ? Math.min.apply(Math, a) : a[b(a, c)] : a;
    };
  }]), b.module("a8m.math.percent", []).filter("percent", function () {
    return function (a, b, c) {
      var d = B(a) ? Number(a) : a;
      return b = b || 100, c = c || !1, !C(d) || isNaN(d) ? a : c ? Math.round(d / b * 100) : d / b * 100;
    };
  }), b.module("a8m.math.radians", []).filter("radians", function () {
    return function (a, b) {
      if (C(b) && isFinite(b) && b % 1 === 0 && b >= 0 && C(a) && isFinite(a)) {
        var c = 3.14159265359 * a / 180;
        return Math.round(c * Math.pow(10, b)) / Math.pow(10, b);
      }

      return "NaN";
    };
  }), b.module("a8m.math.radix", []).filter("radix", function () {
    return function (a, b) {
      var c = /^[2-9]$|^[1-2]\d$|^3[0-6]$/;
      return C(a) && c.test(b) ? a.toString(b).toUpperCase() : a;
    };
  }), b.module("a8m.math.shortFmt", []).filter("shortFmt", function () {
    return function (a, b) {
      return C(b) && isFinite(b) && b % 1 === 0 && b >= 0 && C(a) && isFinite(a) ? a < 1e3 ? "" + a : a < 1e6 ? i(a / 1e3, b) + " K" : a < 1e9 ? i(a / 1e6, b) + " M" : i(a / 1e9, b) + " B" : "NaN";
    };
  }), b.module("a8m.math.sum", []).filter("sum", function () {
    return function (a, b) {
      return E(a) ? a.reduce(function (a, b) {
        return a + b;
      }, b || 0) : a;
    };
  }), b.module("a8m.ends-with", []).filter("endsWith", function () {
    return function (a, b, c) {
      var d,
          e = c || !1;
      return !B(a) || z(b) ? a : (a = e ? a : a.toLowerCase(), d = a.length - b.length, a.indexOf(e ? b : b.toLowerCase(), d) !== -1);
    };
  }), b.module("a8m.latinize", []).filter("latinize", [function () {
    function a(a) {
      return a.replace(/[^\u0000-\u007E]/g, function (a) {
        return c[a] || a;
      });
    }

    for (var b = [{
      base: "A",
      letters: "AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"
    }, {
      base: "AA",
      letters: "Ꜳ"
    }, {
      base: "AE",
      letters: "ÆǼǢ"
    }, {
      base: "AO",
      letters: "Ꜵ"
    }, {
      base: "AU",
      letters: "Ꜷ"
    }, {
      base: "AV",
      letters: "ꜸꜺ"
    }, {
      base: "AY",
      letters: "Ꜽ"
    }, {
      base: "B",
      letters: "BⒷＢḂḄḆɃƂƁ"
    }, {
      base: "C",
      letters: "CⒸＣĆĈĊČÇḈƇȻꜾ"
    }, {
      base: "D",
      letters: "DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"
    }, {
      base: "DZ",
      letters: "ǱǄ"
    }, {
      base: "Dz",
      letters: "ǲǅ"
    }, {
      base: "E",
      letters: "EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"
    }, {
      base: "F",
      letters: "FⒻＦḞƑꝻ"
    }, {
      base: "G",
      letters: "GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"
    }, {
      base: "H",
      letters: "HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"
    }, {
      base: "I",
      letters: "IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"
    }, {
      base: "J",
      letters: "JⒿＪĴɈ"
    }, {
      base: "K",
      letters: "KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"
    }, {
      base: "L",
      letters: "LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"
    }, {
      base: "LJ",
      letters: "Ǉ"
    }, {
      base: "Lj",
      letters: "ǈ"
    }, {
      base: "M",
      letters: "MⓂＭḾṀṂⱮƜ"
    }, {
      base: "N",
      letters: "NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"
    }, {
      base: "NJ",
      letters: "Ǌ"
    }, {
      base: "Nj",
      letters: "ǋ"
    }, {
      base: "O",
      letters: "OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"
    }, {
      base: "OI",
      letters: "Ƣ"
    }, {
      base: "OO",
      letters: "Ꝏ"
    }, {
      base: "OU",
      letters: "Ȣ"
    }, {
      base: "OE",
      letters: "Œ"
    }, {
      base: "oe",
      letters: "œ"
    }, {
      base: "P",
      letters: "PⓅＰṔṖƤⱣꝐꝒꝔ"
    }, {
      base: "Q",
      letters: "QⓆＱꝖꝘɊ"
    }, {
      base: "R",
      letters: "RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"
    }, {
      base: "S",
      letters: "SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"
    }, {
      base: "T",
      letters: "TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"
    }, {
      base: "TZ",
      letters: "Ꜩ"
    }, {
      base: "U",
      letters: "UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"
    }, {
      base: "V",
      letters: "VⓋＶṼṾƲꝞɅ"
    }, {
      base: "VY",
      letters: "Ꝡ"
    }, {
      base: "W",
      letters: "WⓌＷẀẂŴẆẄẈⱲ"
    }, {
      base: "X",
      letters: "XⓍＸẊẌ"
    }, {
      base: "Y",
      letters: "YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"
    }, {
      base: "Z",
      letters: "ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"
    }, {
      base: "a",
      letters: "aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"
    }, {
      base: "aa",
      letters: "ꜳ"
    }, {
      base: "ae",
      letters: "æǽǣ"
    }, {
      base: "ao",
      letters: "ꜵ"
    }, {
      base: "au",
      letters: "ꜷ"
    }, {
      base: "av",
      letters: "ꜹꜻ"
    }, {
      base: "ay",
      letters: "ꜽ"
    }, {
      base: "b",
      letters: "bⓑｂḃḅḇƀƃɓ"
    }, {
      base: "c",
      letters: "cⓒｃćĉċčçḉƈȼꜿↄ"
    }, {
      base: "d",
      letters: "dⓓｄḋďḍḑḓḏđƌɖɗꝺ"
    }, {
      base: "dz",
      letters: "ǳǆ"
    }, {
      base: "e",
      letters: "eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"
    }, {
      base: "f",
      letters: "fⓕｆḟƒꝼ"
    }, {
      base: "g",
      letters: "gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"
    }, {
      base: "h",
      letters: "hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"
    }, {
      base: "hv",
      letters: "ƕ"
    }, {
      base: "i",
      letters: "iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"
    }, {
      base: "j",
      letters: "jⓙｊĵǰɉ"
    }, {
      base: "k",
      letters: "kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"
    }, {
      base: "l",
      letters: "lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"
    }, {
      base: "lj",
      letters: "ǉ"
    }, {
      base: "m",
      letters: "mⓜｍḿṁṃɱɯ"
    }, {
      base: "n",
      letters: "nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"
    }, {
      base: "nj",
      letters: "ǌ"
    }, {
      base: "o",
      letters: "oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"
    }, {
      base: "oi",
      letters: "ƣ"
    }, {
      base: "ou",
      letters: "ȣ"
    }, {
      base: "oo",
      letters: "ꝏ"
    }, {
      base: "p",
      letters: "pⓟｐṕṗƥᵽꝑꝓꝕ"
    }, {
      base: "q",
      letters: "qⓠｑɋꝗꝙ"
    }, {
      base: "r",
      letters: "rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"
    }, {
      base: "s",
      letters: "sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"
    }, {
      base: "t",
      letters: "tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"
    }, {
      base: "tz",
      letters: "ꜩ"
    }, {
      base: "u",
      letters: "uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"
    }, {
      base: "v",
      letters: "vⓥｖṽṿʋꝟʌ"
    }, {
      base: "vy",
      letters: "ꝡ"
    }, {
      base: "w",
      letters: "wⓦｗẁẃŵẇẅẘẉⱳ"
    }, {
      base: "x",
      letters: "xⓧｘẋẍ"
    }, {
      base: "y",
      letters: "yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"
    }, {
      base: "z",
      letters: "zⓩｚźẑżžẓẕƶȥɀⱬꝣ"
    }], c = {}, d = 0; d < b.length; d++) {
      for (var e = b[d].letters.split(""), f = 0; f < e.length; f++) {
        c[e[f]] = b[d].base;
      }
    }

    return function (b) {
      return B(b) ? a(b) : b;
    };
  }]), b.module("a8m.ltrim", []).filter("ltrim", function () {
    return function (a, b) {
      var c = b || "\\s";
      return B(a) ? a.replace(new RegExp("^" + c + "+"), "") : a;
    };
  }), b.module("a8m.match", []).filter("match", function () {
    return function (a, b, c) {
      var d = new RegExp(b, c);
      return B(a) ? a.match(d) : null;
    };
  }), b.module("a8m.phoneUS", []).filter("phoneUS", function () {
    return function (a) {
      return a += "", "(" + a.slice(0, 3) + ") " + a.slice(3, 6) + "-" + a.slice(6);
    };
  }), b.module("a8m.repeat", []).filter("repeat", [function () {
    return function (a, b, c) {
      var d = ~~b;
      return B(a) && d ? w(a, --b, c || "") : a;
    };
  }]), b.module("a8m.rtrim", []).filter("rtrim", function () {
    return function (a, b) {
      var c = b || "\\s";
      return B(a) ? a.replace(new RegExp(c + "+$"), "") : a;
    };
  }), b.module("a8m.slugify", []).filter("slugify", [function () {
    return function (a, b) {
      var c = z(b) ? "-" : b;
      return B(a) ? a.toLowerCase().replace(/\s+/g, c) : a;
    };
  }]), b.module("a8m.split", []).filter("split", function () {
    function a(a) {
      return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
    }

    return function (b, c, d) {
      var f, g, h, i;
      return z(b) || !B(b) ? null : (z(c) && (c = ""), isNaN(d) && (d = 0), f = new RegExp(a(c), "g"), g = b.match(f), e(g) || d >= g.length ? [b] : 0 === d ? b.split(c) : (h = b.split(c), i = h.splice(0, d + 1), h.unshift(i.join(c)), h));
    };
  }), b.module("a8m.starts-with", []).filter("startsWith", function () {
    return function (a, b, c) {
      var d = c || !1;
      return !B(a) || z(b) ? a : (a = d ? a : a.toLowerCase(), !a.indexOf(d ? b : b.toLowerCase()));
    };
  }), b.module("a8m.stringular", []).filter("stringular", function () {
    return function (a) {
      var b = Array.prototype.slice.call(arguments, 1);
      return a.replace(/{(\d+)}/g, function (a, c) {
        return z(b[c]) ? a : b[c];
      });
    };
  }), b.module("a8m.strip-tags", []).filter("stripTags", function () {
    return function (a) {
      return B(a) ? a.replace(/<\S[^><]*>/g, "") : a;
    };
  }), b.module("a8m.test", []).filter("test", function () {
    return function (a, b, c) {
      var d = new RegExp(b, c);
      return B(a) ? d.test(a) : a;
    };
  }), b.module("a8m.trim", []).filter("trim", function () {
    return function (a, b) {
      var c = b || "\\s";
      return B(a) ? a.replace(new RegExp("^" + c + "+|" + c + "+$", "g"), "") : a;
    };
  }), b.module("a8m.truncate", []).filter("truncate", function () {
    return function (a, b, c, d) {
      return b = z(b) ? a.length : b, d = d || !1, c = c || "", !B(a) || a.length <= b ? a : a.substring(0, d ? a.indexOf(" ", b) === -1 ? a.length : a.indexOf(" ", b) : b) + c;
    };
  }), b.module("a8m.ucfirst", []).filter({
    ucfirst: x,
    titleize: x
  }), b.module("a8m.uri-component-encode", []).filter("uriComponentEncode", ["$window", function (a) {
    return function (b) {
      return B(b) ? a.encodeURIComponent(b) : b;
    };
  }]), b.module("a8m.uri-encode", []).filter("uriEncode", ["$window", function (a) {
    return function (b) {
      return B(b) ? a.encodeURI(b) : b;
    };
  }]), b.module("a8m.wrap", []).filter("wrap", function () {
    return function (a, b, c) {
      return B(a) && y(b) ? [b, a, c || b].join("") : a;
    };
  }), b.module("a8m.filter-watcher", []).provider("filterWatcher", function () {
    this.$get = ["$window", "$rootScope", function (a, b) {
      function c(b, c) {
        function d() {
          var b = [];
          return function (c, d) {
            if (D(d) && !e(d)) {
              if (~b.indexOf(d)) return "[Circular]";
              b.push(d);
            }

            return a == d ? "$WINDOW" : a.document == d ? "$DOCUMENT" : k(d) ? "$SCOPE" : d;
          };
        }

        return [b, JSON.stringify(c, d())].join("#").replace(/"/g, "");
      }

      function d(a) {
        var b = a.targetScope.$id;
        F(l[b], function (a) {
          delete j[a];
        }), delete l[b];
      }

      function f() {
        m(function () {
          b.$$phase || (j = {});
        }, 2e3);
      }

      function g(a, b) {
        var c = a.$id;
        return z(l[c]) && (a.$on("$destroy", d), l[c] = []), l[c].push(b);
      }

      function h(a, b) {
        var d = c(a, b);
        return j[d];
      }

      function i(a, b, d, e) {
        var h = c(a, b);
        return j[h] = e, k(d) ? g(d, h) : f(), e;
      }

      var j = {},
          l = {},
          m = a.setTimeout;
      return {
        isMemoized: h,
        memoize: i
      };
    }];
  }), b.module("angular.filter", ["a8m.ucfirst", "a8m.uri-encode", "a8m.uri-component-encode", "a8m.slugify", "a8m.latinize", "a8m.strip-tags", "a8m.stringular", "a8m.truncate", "a8m.starts-with", "a8m.ends-with", "a8m.wrap", "a8m.trim", "a8m.ltrim", "a8m.rtrim", "a8m.repeat", "a8m.test", "a8m.match", "a8m.split", "a8m.phoneUS", "a8m.to-array", "a8m.concat", "a8m.contains", "a8m.unique", "a8m.is-empty", "a8m.after", "a8m.after-where", "a8m.before", "a8m.before-where", "a8m.defaults", "a8m.where", "a8m.reverse", "a8m.remove", "a8m.remove-with", "a8m.group-by", "a8m.count-by", "a8m.chunk-by", "a8m.search-field", "a8m.fuzzy-by", "a8m.fuzzy", "a8m.omit", "a8m.pick", "a8m.every", "a8m.filter-by", "a8m.xor", "a8m.map", "a8m.first", "a8m.last", "a8m.flatten", "a8m.join", "a8m.range", "a8m.math.max", "a8m.math.min", "a8m.math.abs", "a8m.math.percent", "a8m.math.radix", "a8m.math.sum", "a8m.math.degrees", "a8m.math.radians", "a8m.math.byteFmt", "a8m.math.kbFmt", "a8m.math.shortFmt", "a8m.angular", "a8m.conditions", "a8m.is-null", "a8m.filter-watcher"]);
}(window, window.angular);/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function (root, name, definition) {
  if (typeof module != 'undefined' && module.exports) module.exports = definition();else if (typeof define == 'function' && define.amd) define(name, definition);else root[name] = definition();
}(this, 'bowser', function () {
  /**
    * See useragents.js for examples of navigator.userAgent
    */
  var t = true;

  function detect(ua) {
    function getFirstMatch(regex) {
      var match = ua.match(regex);
      return match && match.length > 1 && match[1] || '';
    }

    function getSecondMatch(regex) {
      var match = ua.match(regex);
      return match && match.length > 1 && match[2] || '';
    }

    var iosdevice = getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase(),
        likeAndroid = /like android/i.test(ua),
        android = !likeAndroid && /android/i.test(ua),
        nexusMobile = /nexus\s*[0-6]\s*/i.test(ua),
        nexusTablet = !nexusMobile && /nexus\s*[0-9]+/i.test(ua),
        chromeos = /CrOS/.test(ua),
        silk = /silk/i.test(ua),
        sailfish = /sailfish/i.test(ua),
        tizen = /tizen/i.test(ua),
        webos = /(web|hpw)(o|0)s/i.test(ua),
        windowsphone = /windows phone/i.test(ua),
        samsungBrowser = /SamsungBrowser/i.test(ua),
        windows = !windowsphone && /windows/i.test(ua),
        mac = !iosdevice && !silk && /macintosh/i.test(ua),
        linux = !android && !sailfish && !tizen && !webos && /linux/i.test(ua),
        edgeVersion = getSecondMatch(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),
        versionIdentifier = getFirstMatch(/version\/(\d+(\.\d+)?)/i),
        tablet = /tablet/i.test(ua) && !/tablet pc/i.test(ua),
        mobile = !tablet && /[^-]mobi/i.test(ua),
        xbox = /xbox/i.test(ua),
        result;

    if (/opera/i.test(ua)) {
      //  an old Opera
      result = {
        name: 'Opera',
        opera: t,
        version: versionIdentifier || getFirstMatch(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)
      };
    } else if (/opr\/|opios/i.test(ua)) {
      // a new Opera
      result = {
        name: 'Opera',
        opera: t,
        version: getFirstMatch(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i) || versionIdentifier
      };
    } else if (/SamsungBrowser/i.test(ua)) {
      result = {
        name: 'Samsung Internet for Android',
        samsungBrowser: t,
        version: versionIdentifier || getFirstMatch(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)
      };
    } else if (/Whale/i.test(ua)) {
      result = {
        name: 'NAVER Whale browser',
        whale: t,
        version: getFirstMatch(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/MZBrowser/i.test(ua)) {
      result = {
        name: 'MZ Browser',
        mzbrowser: t,
        version: getFirstMatch(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/coast/i.test(ua)) {
      result = {
        name: 'Opera Coast',
        coast: t,
        version: versionIdentifier || getFirstMatch(/(?:coast)[\s\/](\d+(\.\d+)?)/i)
      };
    } else if (/focus/i.test(ua)) {
      result = {
        name: 'Focus',
        focus: t,
        version: getFirstMatch(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/yabrowser/i.test(ua)) {
      result = {
        name: 'Yandex Browser',
        yandexbrowser: t,
        version: versionIdentifier || getFirstMatch(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)
      };
    } else if (/ucbrowser/i.test(ua)) {
      result = {
        name: 'UC Browser',
        ucbrowser: t,
        version: getFirstMatch(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/mxios/i.test(ua)) {
      result = {
        name: 'Maxthon',
        maxthon: t,
        version: getFirstMatch(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/epiphany/i.test(ua)) {
      result = {
        name: 'Epiphany',
        epiphany: t,
        version: getFirstMatch(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/puffin/i.test(ua)) {
      result = {
        name: 'Puffin',
        puffin: t,
        version: getFirstMatch(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)
      };
    } else if (/sleipnir/i.test(ua)) {
      result = {
        name: 'Sleipnir',
        sleipnir: t,
        version: getFirstMatch(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (/k-meleon/i.test(ua)) {
      result = {
        name: 'K-Meleon',
        kMeleon: t,
        version: getFirstMatch(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)
      };
    } else if (windowsphone) {
      result = {
        name: 'Windows Phone',
        osname: 'Windows Phone',
        windowsphone: t
      };

      if (edgeVersion) {
        result.msedge = t;
        result.version = edgeVersion;
      } else {
        result.msie = t;
        result.version = getFirstMatch(/iemobile\/(\d+(\.\d+)?)/i);
      }
    } else if (/msie|trident/i.test(ua)) {
      result = {
        name: 'Internet Explorer',
        msie: t,
        version: getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)
      };
    } else if (chromeos) {
      result = {
        name: 'Chrome',
        osname: 'Chrome OS',
        chromeos: t,
        chromeBook: t,
        chrome: t,
        version: getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)
      };
    } else if (/edg([ea]|ios)/i.test(ua)) {
      result = {
        name: 'Microsoft Edge',
        msedge: t,
        version: edgeVersion
      };
    } else if (/vivaldi/i.test(ua)) {
      result = {
        name: 'Vivaldi',
        vivaldi: t,
        version: getFirstMatch(/vivaldi\/(\d+(\.\d+)?)/i) || versionIdentifier
      };
    } else if (sailfish) {
      result = {
        name: 'Sailfish',
        osname: 'Sailfish OS',
        sailfish: t,
        version: getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i)
      };
    } else if (/seamonkey\//i.test(ua)) {
      result = {
        name: 'SeaMonkey',
        seamonkey: t,
        version: getFirstMatch(/seamonkey\/(\d+(\.\d+)?)/i)
      };
    } else if (/firefox|iceweasel|fxios/i.test(ua)) {
      result = {
        name: 'Firefox',
        firefox: t,
        version: getFirstMatch(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)
      };

      if (/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(ua)) {
        result.firefoxos = t;
        result.osname = 'Firefox OS';
      }
    } else if (silk) {
      result = {
        name: 'Amazon Silk',
        silk: t,
        version: getFirstMatch(/silk\/(\d+(\.\d+)?)/i)
      };
    } else if (/phantom/i.test(ua)) {
      result = {
        name: 'PhantomJS',
        phantom: t,
        version: getFirstMatch(/phantomjs\/(\d+(\.\d+)?)/i)
      };
    } else if (/slimerjs/i.test(ua)) {
      result = {
        name: 'SlimerJS',
        slimer: t,
        version: getFirstMatch(/slimerjs\/(\d+(\.\d+)?)/i)
      };
    } else if (/blackberry|\bbb\d+/i.test(ua) || /rim\stablet/i.test(ua)) {
      result = {
        name: 'BlackBerry',
        osname: 'BlackBerry OS',
        blackberry: t,
        version: versionIdentifier || getFirstMatch(/blackberry[\d]+\/(\d+(\.\d+)?)/i)
      };
    } else if (webos) {
      result = {
        name: 'WebOS',
        osname: 'WebOS',
        webos: t,
        version: versionIdentifier || getFirstMatch(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)
      };
      /touchpad\//i.test(ua) && (result.touchpad = t);
    } else if (/bada/i.test(ua)) {
      result = {
        name: 'Bada',
        osname: 'Bada',
        bada: t,
        version: getFirstMatch(/dolfin\/(\d+(\.\d+)?)/i)
      };
    } else if (tizen) {
      result = {
        name: 'Tizen',
        osname: 'Tizen',
        tizen: t,
        version: getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i) || versionIdentifier
      };
    } else if (/qupzilla/i.test(ua)) {
      result = {
        name: 'QupZilla',
        qupzilla: t,
        version: getFirstMatch(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i) || versionIdentifier
      };
    } else if (/chromium/i.test(ua)) {
      result = {
        name: 'Chromium',
        chromium: t,
        version: getFirstMatch(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i) || versionIdentifier
      };
    } else if (/chrome|crios|crmo/i.test(ua)) {
      result = {
        name: 'Chrome',
        chrome: t,
        version: getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)
      };
    } else if (android) {
      result = {
        name: 'Android',
        version: versionIdentifier
      };
    } else if (/safari|applewebkit/i.test(ua)) {
      result = {
        name: 'Safari',
        safari: t
      };

      if (versionIdentifier) {
        result.version = versionIdentifier;
      }
    } else if (iosdevice) {
      result = {
        name: iosdevice == 'iphone' ? 'iPhone' : iosdevice == 'ipad' ? 'iPad' : 'iPod' // WTF: version is not part of user agent in web apps

      };

      if (versionIdentifier) {
        result.version = versionIdentifier;
      }
    } else if (/googlebot/i.test(ua)) {
      result = {
        name: 'Googlebot',
        googlebot: t,
        version: getFirstMatch(/googlebot\/(\d+(\.\d+))/i) || versionIdentifier
      };
    } else {
      result = {
        name: getFirstMatch(/^(.*)\/(.*) /),
        version: getSecondMatch(/^(.*)\/(.*) /)
      };
    } // set webkit or gecko flag for browsers based on these engines


    if (!result.msedge && /(apple)?webkit/i.test(ua)) {
      if (/(apple)?webkit\/537\.36/i.test(ua)) {
        result.name = result.name || "Blink";
        result.blink = t;
      } else {
        result.name = result.name || "Webkit";
        result.webkit = t;
      }

      if (!result.version && versionIdentifier) {
        result.version = versionIdentifier;
      }
    } else if (!result.opera && /gecko\//i.test(ua)) {
      result.name = result.name || "Gecko";
      result.gecko = t;
      result.version = result.version || getFirstMatch(/gecko\/(\d+(\.\d+)?)/i);
    } // set OS flags for platforms that have multiple browsers


    if (!result.windowsphone && (android || result.silk)) {
      result.android = t;
      result.osname = 'Android';
    } else if (!result.windowsphone && iosdevice) {
      result[iosdevice] = t;
      result.ios = t;
      result.osname = 'iOS';
    } else if (mac) {
      result.mac = t;
      result.osname = 'macOS';
    } else if (xbox) {
      result.xbox = t;
      result.osname = 'Xbox';
    } else if (windows) {
      result.windows = t;
      result.osname = 'Windows';
    } else if (linux) {
      result.linux = t;
      result.osname = 'Linux';
    }

    function getWindowsVersion(s) {
      switch (s) {
        case 'NT':
          return 'NT';

        case 'XP':
          return 'XP';

        case 'NT 5.0':
          return '2000';

        case 'NT 5.1':
          return 'XP';

        case 'NT 5.2':
          return '2003';

        case 'NT 6.0':
          return 'Vista';

        case 'NT 6.1':
          return '7';

        case 'NT 6.2':
          return '8';

        case 'NT 6.3':
          return '8.1';

        case 'NT 10.0':
          return '10';

        default:
          return undefined;
      }
    } // OS version extraction


    var osVersion = '';

    if (result.windows) {
      osVersion = getWindowsVersion(getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i));
    } else if (result.windowsphone) {
      osVersion = getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i);
    } else if (result.mac) {
      osVersion = getFirstMatch(/Mac OS X (\d+([_\.\s]\d+)*)/i);
      osVersion = osVersion.replace(/[_\s]/g, '.');
    } else if (iosdevice) {
      osVersion = getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i);
      osVersion = osVersion.replace(/[_\s]/g, '.');
    } else if (android) {
      osVersion = getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i);
    } else if (result.webos) {
      osVersion = getFirstMatch(/(?:web|hpw)os\/(\d+(\.\d+)*)/i);
    } else if (result.blackberry) {
      osVersion = getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i);
    } else if (result.bada) {
      osVersion = getFirstMatch(/bada\/(\d+(\.\d+)*)/i);
    } else if (result.tizen) {
      osVersion = getFirstMatch(/tizen[\/\s](\d+(\.\d+)*)/i);
    }

    if (osVersion) {
      result.osversion = osVersion;
    } // device type extraction


    var osMajorVersion = !result.windows && osVersion.split('.')[0];

    if (tablet || nexusTablet || iosdevice == 'ipad' || android && (osMajorVersion == 3 || osMajorVersion >= 4 && !mobile) || result.silk) {
      result.tablet = t;
    } else if (mobile || iosdevice == 'iphone' || iosdevice == 'ipod' || android || nexusMobile || result.blackberry || result.webos || result.bada) {
      result.mobile = t;
    } // Graded Browser Support
    // http://developer.yahoo.com/yui/articles/gbs


    if (result.msedge || result.msie && result.version >= 10 || result.yandexbrowser && result.version >= 15 || result.vivaldi && result.version >= 1.0 || result.chrome && result.version >= 20 || result.samsungBrowser && result.version >= 4 || result.whale && compareVersions([result.version, '1.0']) === 1 || result.mzbrowser && compareVersions([result.version, '6.0']) === 1 || result.focus && compareVersions([result.version, '1.0']) === 1 || result.firefox && result.version >= 20.0 || result.safari && result.version >= 6 || result.opera && result.version >= 10.0 || result.ios && result.osversion && result.osversion.split(".")[0] >= 6 || result.blackberry && result.version >= 10.1 || result.chromium && result.version >= 20) {
      result.a = t;
    } else if (result.msie && result.version < 10 || result.chrome && result.version < 20 || result.firefox && result.version < 20.0 || result.safari && result.version < 6 || result.opera && result.version < 10.0 || result.ios && result.osversion && result.osversion.split(".")[0] < 6 || result.chromium && result.version < 20) {
      result.c = t;
    } else result.x = t;

    return result;
  }

  var bowser = detect(typeof navigator !== 'undefined' ? navigator.userAgent || '' : '');

  bowser.test = function (browserList) {
    for (var i = 0; i < browserList.length; ++i) {
      var browserItem = browserList[i];

      if (typeof browserItem === 'string') {
        if (browserItem in bowser) {
          return true;
        }
      }
    }

    return false;
  };
  /**
   * Get version precisions count
   *
   * @example
   *   getVersionPrecision("1.10.3") // 3
   *
   * @param  {string} version
   * @return {number}
   */


  function getVersionPrecision(version) {
    return version.split(".").length;
  }
  /**
   * Array::map polyfill
   *
   * @param  {Array} arr
   * @param  {Function} iterator
   * @return {Array}
   */


  function map(arr, iterator) {
    var result = [],
        i;

    if (Array.prototype.map) {
      return Array.prototype.map.call(arr, iterator);
    }

    for (i = 0; i < arr.length; i++) {
      result.push(iterator(arr[i]));
    }

    return result;
  }
  /**
   * Calculate browser version weight
   *
   * @example
   *   compareVersions(['1.10.2.1',  '1.8.2.1.90'])    // 1
   *   compareVersions(['1.010.2.1', '1.09.2.1.90']);  // 1
   *   compareVersions(['1.10.2.1',  '1.10.2.1']);     // 0
   *   compareVersions(['1.10.2.1',  '1.0800.2']);     // -1
   *
   * @param  {Array<String>} versions versions to compare
   * @return {Number} comparison result
   */


  function compareVersions(versions) {
    // 1) get common precision for both versions, for example for "10.0" and "9" it should be 2
    var precision = Math.max(getVersionPrecision(versions[0]), getVersionPrecision(versions[1]));
    var chunks = map(versions, function (version) {
      var delta = precision - getVersionPrecision(version); // 2) "9" -> "9.0" (for precision = 2)

      version = version + new Array(delta + 1).join(".0"); // 3) "9.0" -> ["000000000"", "000000009"]

      return map(version.split("."), function (chunk) {
        return new Array(20 - chunk.length).join("0") + chunk;
      }).reverse();
    }); // iterate in reverse order by reversed chunks array

    while (--precision >= 0) {
      // 4) compare: "000000009" > "000000010" = false (but "9" > "10" = true)
      if (chunks[0][precision] > chunks[1][precision]) {
        return 1;
      } else if (chunks[0][precision] === chunks[1][precision]) {
        if (precision === 0) {
          // all version chunks are same
          return 0;
        }
      } else {
        return -1;
      }
    }
  }
  /**
   * Check if browser is unsupported
   *
   * @example
   *   bowser.isUnsupportedBrowser({
   *     msie: "10",
   *     firefox: "23",
   *     chrome: "29",
   *     safari: "5.1",
   *     opera: "16",
   *     phantom: "534"
   *   });
   *
   * @param  {Object}  minVersions map of minimal version to browser
   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map
   * @param  {String}  [ua] user agent string
   * @return {Boolean}
   */


  function isUnsupportedBrowser(minVersions, strictMode, ua) {
    var _bowser = bowser; // make strictMode param optional with ua param usage

    if (typeof strictMode === 'string') {
      ua = strictMode;
      strictMode = void 0;
    }

    if (strictMode === void 0) {
      strictMode = false;
    }

    if (ua) {
      _bowser = detect(ua);
    }

    var version = "" + _bowser.version;

    for (var browser in minVersions) {
      if (minVersions.hasOwnProperty(browser)) {
        if (_bowser[browser]) {
          if (typeof minVersions[browser] !== 'string') {
            throw new Error('Browser version in the minVersion map should be a string: ' + browser + ': ' + String(minVersions));
          } // browser version and min supported version.


          return compareVersions([version, minVersions[browser]]) < 0;
        }
      }
    }

    return strictMode; // not found
  }
  /**
   * Check if browser is supported
   *
   * @param  {Object} minVersions map of minimal version to browser
   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map
   * @param  {String}  [ua] user agent string
   * @return {Boolean}
   */


  function check(minVersions, strictMode, ua) {
    return !isUnsupportedBrowser(minVersions, strictMode, ua);
  }

  bowser.isUnsupportedBrowser = isUnsupportedBrowser;
  bowser.compareVersions = compareVersions;
  bowser.check = check;
  /*
   * Set our detect method to the main bowser object so we can
   * reuse it to test other user agents.
   * This is needed to implement future tests.
   */

  bowser._detect = detect;
  /*
   * Set our detect public method to the main bowser object
   * This is needed to implement bowser in server side
   */

  bowser.detect = detect;
  return bowser;
});function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}/*
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing,
* software distributed under the License is distributed on an
* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
* KIND, either express or implied.  See the License for the
* specific language governing permissions and limitations
* under the License.
*/!function(t,e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.echarts={});}(this,function(t){"use strict";var e=2311,n=function n(){return e++;},v="object"==(typeof wx==="undefined"?"undefined":_typeof(wx))&&"function"==typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0,domSupported:!1}:"undefined"==typeof document&&"undefined"!=typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0,domSupported:!1}:"undefined"==typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0,domSupported:!1}:function(t){var e={},i=t.match(/Firefox\/([\d.]+)/),n=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),a=t.match(/Edge\/([\d.]+)/),o=/micromessenger/i.test(t);i&&(e.firefox=!0,e.version=i[1]);n&&(e.ie=!0,e.version=n[1]);a&&(e.edge=!0,e.version=a[1]);o&&(e.weChat=!0);return{browser:e,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!e.ie&&!e.edge,pointerEventsSupported:"onpointerdown"in window&&(e.edge||e.ie&&11<=e.version),domSupported:"undefined"!=typeof document};}(navigator.userAgent);var s={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},l={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},u=Object.prototype.toString,i=Array.prototype,r=i.forEach,h=i.filter,a=i.slice,c=i.map,d=i.reduce,o={};function f(t,e){"createCanvas"===t&&(y=null),o[t]=e;}function D(t){if(null==t||"object"!=_typeof(t))return t;var e=t,i=u.call(t);if("[object Array]"===i){if(!$(t)){e=[];for(var n=0,a=t.length;n<a;n++){e[n]=D(t[n]);}}}else if(l[i]){if(!$(t)){var o=t.constructor;if(t.constructor.from)e=o.from(t);else{e=new o(t.length);for(n=0,a=t.length;n<a;n++){e[n]=D(t[n]);}}}}else if(!s[i]&&!$(t)&&!G(t))for(var r in e={},t){t.hasOwnProperty(r)&&(e[r]=D(t[r]));}return e;}function m(t,e,i){if(!z(e)||!z(t))return i?D(e):t;for(var n in e){if(e.hasOwnProperty(n)){var a=t[n],o=e[n];!z(o)||!z(a)||k(o)||k(a)||G(o)||G(a)||B(o)||B(a)||$(o)||$(a)?!i&&n in t||(t[n]=D(e[n])):m(a,o,i);}}return t;}function p(t,e){for(var i=t[0],n=1,a=t.length;n<a;n++){i=m(i,t[n],e);}return i;}function L(t,e){for(var i in e){e.hasOwnProperty(i)&&(t[i]=e[i]);}return t;}function C(t,e,i){for(var n in e){e.hasOwnProperty(n)&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n]);}return t;}function g(){return o.createCanvas();}var y;function x(){return y=y||g().getContext("2d");}function _(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++){if(t[i]===e)return i;}}return-1;}function w(t,e){var i=t.prototype;function n(){}for(var a in n.prototype=e.prototype,t.prototype=new n(),i){i.hasOwnProperty(a)&&(t.prototype[a]=i[a]);}(t.prototype.constructor=t).superClass=e;}function b(t,e,i){C(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,i);}function P(t){if(t)return"string"!=typeof t&&"number"==typeof t.length;}function E(t,e,i){if(t&&e)if(t.forEach&&t.forEach===r)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,a=t.length;n<a;n++){e.call(i,t[n],n,t);}else for(var o in t){t.hasOwnProperty(o)&&e.call(i,t[o],o,t);}}function N(t,e,i){if(t&&e){if(t.map&&t.map===c)return t.map(e,i);for(var n=[],a=0,o=t.length;a<o;a++){n.push(e.call(i,t[a],a,t));}return n;}}function S(t,e,i,n){if(t&&e){if(t.reduce&&t.reduce===d)return t.reduce(e,i,n);for(var a=0,o=t.length;a<o;a++){i=e.call(n,i,t[a],a,t);}return i;}}function M(t,e,i){if(t&&e){if(t.filter&&t.filter===h)return t.filter(e,i);for(var n=[],a=0,o=t.length;a<o;a++){e.call(i,t[a],a,t)&&n.push(t[a]);}return n;}}function I(t,e,i){if(t&&e)for(var n=0,a=t.length;n<a;n++){if(e.call(i,t[n],n,t))return t[n];}}function T(t,e){var i=a.call(arguments,2);return function(){return t.apply(e,i.concat(a.call(arguments)));};}function A(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)));};}function k(t){return"[object Array]"===u.call(t);}function O(t){return"function"==typeof t;}function R(t){return"[object String]"===u.call(t);}function z(t){var e=_typeof(t);return"function"==e||!!t&&"object"==e;}function B(t){return!!s[u.call(t)];}function V(t){return!!l[u.call(t)];}function G(t){return"object"==_typeof(t)&&"number"==typeof t.nodeType&&"object"==_typeof(t.ownerDocument);}function F(t){return t!=t;}function W(t){for(var e=0,i=arguments.length;e<i;e++){if(null!=arguments[e])return arguments[e];}}function H(t,e){return null!=t?t:e;}function Z(t,e,i){return null!=t?t:null!=e?e:i;}function U(){return Function.call.apply(a,arguments);}function X(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t;}function Y(t,e){if(!t)throw new Error(e);}function j(t){return null==t?null:"function"==typeof t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");}o.createCanvas=function(){return document.createElement("canvas");};var q="__ec_primitive__";function K(t){t[q]=!0;}function $(t){return t[q];}function J(t){var i=k(t);this.data={};var n=this;function e(t,e){i?n.set(t,e):n.set(e,t);}t instanceof J?t.each(e):t&&E(t,e);}function Q(t){return new J(t);}function tt(t,e){for(var i=new t.constructor(t.length+e.length),n=0;n<t.length;n++){i[n]=t[n];}var a=t.length;for(n=0;n<e.length;n++){i[n+a]=e[n];}return i;}function et(){}J.prototype={constructor:J,get:function get(t){return this.data.hasOwnProperty(t)?this.data[t]:null;},set:function set(t,e){return this.data[t]=e;},each:function each(t,e){for(var i in void 0!==e&&(t=T(t,e)),this.data){this.data.hasOwnProperty(i)&&t(this.data[i],i);}},removeKey:function removeKey(t){delete this.data[t];}};var it=(Object.freeze||Object)({$override:f,clone:D,merge:m,mergeAll:p,extend:L,defaults:C,createCanvas:g,getContext:x,indexOf:_,inherits:w,mixin:b,isArrayLike:P,each:E,map:N,reduce:S,filter:M,find:I,bind:T,curry:A,isArray:k,isFunction:O,isString:R,isObject:z,isBuiltInObject:B,isTypedArray:V,isDom:G,eqNaN:F,retrieve:W,retrieve2:H,retrieve3:Z,slice:U,normalizeCssArray:X,assert:Y,trim:j,setAsPrimitive:K,isPrimitive:$,createHashMap:Q,concatArray:tt,noop:et}),nt="undefined"==typeof Float32Array?Array:Float32Array;function at(t,e){var i=new nt(2);return null==t&&(t=0),null==e&&(e=0),i[0]=t,i[1]=e,i;}function ot(t,e){return t[0]=e[0],t[1]=e[1],t;}function rt(t){var e=new nt(2);return e[0]=t[0],e[1]=t[1],e;}function st(t,e,i){return t[0]=e,t[1]=i,t;}function lt(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t;}function ut(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t;}function ht(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t;}function ct(t){return Math.sqrt(ft(t));}var dt=ct;function ft(t){return t[0]*t[0]+t[1]*t[1];}var pt=ft;function gt(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t;}function mt(t,e){var i=ct(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t;}function vt(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]));}var yt=vt;function xt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]);}var _t=xt;function wt(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t;}function bt(t,e,i){var n=e[0],a=e[1];return t[0]=i[0]*n+i[2]*a+i[4],t[1]=i[1]*n+i[3]*a+i[5],t;}function St(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t;}function Mt(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t;}var It=(Object.freeze||Object)({create:at,copy:ot,clone:rt,set:st,add:lt,scaleAndAdd:ut,sub:ht,len:ct,length:dt,lenSquare:ft,lengthSquare:pt,mul:function mul(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t;},div:function div(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t;},dot:function dot(t,e){return t[0]*e[0]+t[1]*e[1];},scale:gt,normalize:mt,distance:vt,dist:yt,distanceSquare:xt,distSquare:_t,negate:function negate(t,e){return t[0]=-e[0],t[1]=-e[1],t;},lerp:wt,applyTransform:bt,min:St,max:Mt});function At(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this);}function Tt(t,e){return{target:t,topTarget:e&&e.topTarget};}At.prototype={constructor:At,_dragStart:function _dragStart(t){var e=t.target;e&&e.draggable&&((this._draggingTarget=e).dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(Tt(e,t),"dragstart",t.event));},_drag:function _drag(t){var e=this._draggingTarget;if(e){var i=t.offsetX,n=t.offsetY,a=i-this._x,o=n-this._y;this._x=i,this._y=n,e.drift(a,o,t),this.dispatchToElement(Tt(e,t),"drag",t.event);var r=this.findHover(i,n,e).target,s=this._dropTarget;e!==(this._dropTarget=r)&&(s&&r!==s&&this.dispatchToElement(Tt(s,t),"dragleave",t.event),r&&r!==s&&this.dispatchToElement(Tt(r,t),"dragenter",t.event));}},_dragEnd:function _dragEnd(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(Tt(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(Tt(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null;}};var Dt=Array.prototype.slice,Ct=function Ct(t){this._$handlers={},this._$eventProcessor=t;};function Lt(t,e,i,n,a,o){var r=t._$handlers;if("function"==typeof i&&(a=n,n=i,i=null),!n||!e)return t;i=function(t,e){var i=t._$eventProcessor;return null!=e&&i&&i.normalizeQuery&&(e=i.normalizeQuery(e)),e;}(t,i),r[e]||(r[e]=[]);for(var s=0;s<r[e].length;s++){if(r[e][s].h===n)return t;}var l={h:n,one:o,query:i,ctx:a||t,callAtLast:n.zrEventfulCallAtLast},u=r[e].length-1,h=r[e][u];return h&&h.callAtLast?r[e].splice(u,0,l):r[e].push(l),t;}Ct.prototype={constructor:Ct,one:function one(t,e,i,n){return Lt(this,t,e,i,n,!0);},on:function on(t,e,i,n){return Lt(this,t,e,i,n,!1);},isSilent:function isSilent(t){var e=this._$handlers;return!e[t]||!e[t].length;},off:function off(t,e){var i=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],a=0,o=i[t].length;a<o;a++){i[t][a].h!==e&&n.push(i[t][a]);}i[t]=n;}i[t]&&0===i[t].length&&delete i[t];}else delete i[t];return this;},trigger:function trigger(t){var e=this._$handlers[t],i=this._$eventProcessor;if(e){var n=arguments,a=n.length;3<a&&(n=Dt.call(n,1));for(var o=e.length,r=0;r<o;){var s=e[r];if(i&&i.filter&&null!=s.query&&!i.filter(t,s.query))r++;else{switch(a){case 1:s.h.call(s.ctx);break;case 2:s.h.call(s.ctx,n[1]);break;case 3:s.h.call(s.ctx,n[1],n[2]);break;default:s.h.apply(s.ctx,n);}s.one?(e.splice(r,1),o--):r++;}}}return i&&i.afterTrigger&&i.afterTrigger(t),this;},triggerWithContext:function triggerWithContext(t){var e=this._$handlers[t],i=this._$eventProcessor;if(e){var n=arguments,a=n.length;4<a&&(n=Dt.call(n,1,n.length-1));for(var o=n[n.length-1],r=e.length,s=0;s<r;){var l=e[s];if(i&&i.filter&&null!=l.query&&!i.filter(t,l.query))s++;else{switch(a){case 1:l.h.call(o);break;case 2:l.h.call(o,n[1]);break;case 3:l.h.call(o,n[1],n[2]);break;default:l.h.apply(o,n);}l.one?(e.splice(s,1),r--):s++;}}}return i&&i.afterTrigger&&i.afterTrigger(t),this;}};var kt=Math.log(2);function Pt(t,e,i,n,a,o){var r=n+"-"+a,s=t.length;if(o.hasOwnProperty(r))return o[r];if(1===e){var l=Math.round(Math.log((1<<s)-1&~a)/kt);return t[i][l];}for(var u=n|1<<i,h=i+1;n&1<<h;){h++;}for(var c=0,d=0,f=0;d<s;d++){var p=1<<d;p&a||(c+=(f%2?-1:1)*t[i][d]*Pt(t,e-1,h,u,a|p,o),f++);}return o[r]=c;}var Nt="undefined"!=typeof window&&!!window.addEventListener,Ot=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Et="___zrEVENTSAVED",Rt=[];function zt(t,e,i,n){return i=i||{},n||!v.canvasSupported?Bt(t,e,i):v.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(i.zrX=e.layerX,i.zrY=e.layerY):null!=e.offsetX?(i.zrX=e.offsetX,i.zrY=e.offsetY):Bt(t,e,i),i;}function Bt(t,e,i){if(t.getBoundingClientRect&&v.domSupported){var n=e.clientX,a=e.clientY;if("CANVAS"===t.nodeName.toUpperCase()){var o=t.getBoundingClientRect();return i.zrX=n-o.left,void(i.zrY=a-o.top);}var r=t[Et]||(t[Et]={}),s=function(t,e){for(var i=e.transformer,n=e.srcCoords,a=!0,o=[],r=[],s=0;s<4;s++){var l=t[s].getBoundingClientRect(),u=2*s,h=l.left,c=l.top;o.push(h,c),a&=n&&h===n[u]&&c===n[1+u],r.push(t[s].offsetLeft,t[s].offsetTop);}return a?i:(e.srcCoords=o,e.transformer=function(t,e){var i=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],n={},a=Pt(i,8,0,0,0,n);if(0!==a){for(var o=[],r=0;r<8;r++){for(var s=0;s<8;s++){null==o[s]&&(o[s]=0),o[s]+=((r+s)%2?-1:1)*Pt(i,7,0===r?1:0,1<<r,1<<s,n)/a*e[r];}}return function(t,e,i){var n=e*o[6]+i*o[7]+1;t[0]=(e*o[0]+i*o[1]+o[2])/n,t[1]=(e*o[3]+i*o[4]+o[5])/n;};}}(o,r));}(function(t,e){var i=e.markers;if(i)return i;i=e.markers=[];for(var n=["left","right"],a=["top","bottom"],o=0;o<4;o++){var r=document.createElement("div"),s=r.style,l=o%2,u=(o>>1)%2;s.cssText=["position:absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","width:0","height:0",n[l]+":0",a[u]+":0",n[1-l]+":auto",a[1-u]+":auto",""].join("!important;"),t.appendChild(r),i.push(r);}return i;}(t,r),r);if(s)return s(Rt,n,a),i.zrX=Rt[0],void(i.zrY=Rt[1]);}i.zrX=i.zrY=0;}function Vt(t,e,i){if(null!=(e=e||window.event).zrX)return e;var n=e.type;if(n&&0<=n.indexOf("touch")){var a="touchend"!==n?e.targetTouches[0]:e.changedTouches[0];a&&zt(t,a,e,i);}else zt(t,e,e,i),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var o=e.button;return null==e.which&&void 0!==o&&Ot.test(e.type)&&(e.which=1&o?1:2&o?3:4&o?2:0),e;}function Gt(t,e,i){Nt?t.addEventListener(e,i):t.attachEvent("on"+e,i);}var Ft=Nt?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0;}:function(t){t.returnValue=!1,t.cancelBubble=!0;};function Wt(t){return 2===t.which||3===t.which;}function Ht(){this._track=[];}function Zt(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i);}Ht.prototype={constructor:Ht,recognize:function recognize(t,e,i){return this._doTrack(t,e,i),this._recognize(t);},clear:function clear(){return this._track.length=0,this;},_doTrack:function _doTrack(t,e,i){var n=t.touches;if(n){for(var a={points:[],touches:[],target:e,event:t},o=0,r=n.length;o<r;o++){var s=n[o],l=zt(i,s,{});a.points.push([l.zrX,l.zrY]),a.touches.push(s);}this._track.push(a);}},_recognize:function _recognize(t){for(var e in Ut){if(Ut.hasOwnProperty(e)){var i=Ut[e](this._track,t);if(i)return i;}}}};var Ut={pinch:function pinch(t,e){var i=t.length;if(i){var n=(t[i-1]||{}).points,a=(t[i-2]||{}).points||n;if(a&&1<a.length&&n&&1<n.length){var o=Zt(n)/Zt(a);isFinite(o)||(o=1),e.pinchScale=o;var r=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2];}(n);return e.pinchX=r[0],e.pinchY=r[1],{type:"pinch",target:t[0].target,event:e};}}}},Xt="silent";function Yt(t){Ft(this.event);}function jt(){}jt.prototype.dispose=function(){};function qt(t,e,i,n){Ct.call(this),this.storage=t,this.painter=e,this.painterRoot=n,i=i||new jt(),this.proxy=null,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,this._gestureMgr,At.call(this),this.setHandlerProxy(i);}var Kt=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function $t(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n,a=t;a;){if(a.clipPath&&!a.clipPath.contain(e,i))return!1;a.silent&&(n=!0),a=a.parent;}return!n||Xt;}return!1;}qt.prototype={constructor:qt,setHandlerProxy:function setHandlerProxy(e){this.proxy&&this.proxy.dispose(),e&&(E(Kt,function(t){e.on&&e.on(t,this[t],this);},this),e.handler=this),this.proxy=e;},mousemove:function mousemove(t){var e=t.zrX,i=t.zrY,n=this._hovered,a=n.target;a&&!a.__zr&&(a=(n=this.findHover(n.x,n.y)).target);var o=this._hovered=this.findHover(e,i),r=o.target,s=this.proxy;s.setCursor&&s.setCursor(r?r.cursor:"default"),a&&r!==a&&this.dispatchToElement(n,"mouseout",t),this.dispatchToElement(o,"mousemove",t),r&&r!==a&&this.dispatchToElement(o,"mouseover",t);},mouseout:function mouseout(t){this.dispatchToElement(this._hovered,"mouseout",t);for(var e,i=t.toElement||t.relatedTarget;(i=i&&i.parentNode)&&9!==i.nodeType&&!(e=i===this.painterRoot);){;}e||this.trigger("globalout",{event:t});},resize:function resize(t){this._hovered={};},dispatch:function dispatch(t,e){var i=this[t];i&&i.call(this,e);},dispose:function dispose(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null;},setCursorStyle:function setCursorStyle(t){var e=this.proxy;e.setCursor&&e.setCursor(t);},dispatchToElement:function dispatchToElement(t,e,i){var n=(t=t||{}).target;if(!n||!n.silent){for(var a="on"+e,o=function(t,e,i){return{type:t,event:i,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta,zrByTouch:i.zrByTouch,which:i.which,stop:Yt};}(e,t,i);n&&(n[a]&&(o.cancelBubble=n[a].call(n,o)),n.trigger(e,o),n=n.parent,!o.cancelBubble);){;}o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[a]&&t[a].call(t,o),t.trigger&&t.trigger(e,o);}));}},findHover:function findHover(t,e,i){for(var n=this.storage.getDisplayList(),a={x:t,y:e},o=n.length-1;0<=o;o--){var r;if(n[o]!==i&&!n[o].ignore&&(r=$t(n[o],t,e))&&(a.topTarget||(a.topTarget=n[o]),r!==Xt)){a.target=n[o];break;}}return a;},processGesture:function processGesture(t,e){this._gestureMgr||(this._gestureMgr=new Ht());var i=this._gestureMgr;"start"===e&&i.clear();var n=i.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if("end"===e&&i.clear(),n){var a=n.type;t.gestureEvent=a,this.dispatchToElement({target:n.target},a,n.event);}}},E(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){qt.prototype[n]=function(t){var e=this.findHover(t.zrX,t.zrY),i=e.target;if("mousedown"===n)this._downEl=i,this._downPoint=[t.zrX,t.zrY],this._upEl=i;else if("mouseup"===n)this._upEl=i;else if("click"===n){if(this._downEl!==this._upEl||!this._downPoint||4<yt(this._downPoint,[t.zrX,t.zrY]))return;this._downPoint=null;}this.dispatchToElement(e,n,t);};}),b(qt,Ct),b(qt,At);var Jt="undefined"==typeof Float32Array?Array:Float32Array;function Qt(){var t=new Jt(6);return te(t),t;}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t;}function ee(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t;}function ie(t,e,i){var n=e[0]*i[0]+e[2]*i[1],a=e[1]*i[0]+e[3]*i[1],o=e[0]*i[2]+e[2]*i[3],r=e[1]*i[2]+e[3]*i[3],s=e[0]*i[4]+e[2]*i[5]+e[4],l=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=a,t[2]=o,t[3]=r,t[4]=s,t[5]=l,t;}function ne(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t;}function ae(t,e,i){var n=e[0],a=e[2],o=e[4],r=e[1],s=e[3],l=e[5],u=Math.sin(i),h=Math.cos(i);return t[0]=n*h+r*u,t[1]=-n*u+r*h,t[2]=a*h+s*u,t[3]=-a*u+h*s,t[4]=h*o+u*l,t[5]=h*l-u*o,t;}function oe(t,e,i){var n=i[0],a=i[1];return t[0]=e[0]*n,t[1]=e[1]*a,t[2]=e[2]*n,t[3]=e[3]*a,t[4]=e[4]*n,t[5]=e[5]*a,t;}function re(t,e){var i=e[0],n=e[2],a=e[4],o=e[1],r=e[3],s=e[5],l=i*r-o*n;return l?(l=1/l,t[0]=r*l,t[1]=-o*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*s-r*a)*l,t[5]=(o*a-i*s)*l,t):null;}function se(t){var e=Qt();return ee(e,t),e;}var le=(Object.freeze||Object)({create:Qt,identity:te,copy:ee,mul:ie,translate:ne,rotate:ae,scale:oe,invert:re,clone:se}),ue=te;function he(t){return 5e-5<t||t<-5e-5;}var ce=function ce(t){(t=t||{}).position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null;},de=ce.prototype;de.transform=null,de.needLocalTransform=function(){return he(this.rotation)||he(this.position[0])||he(this.position[1])||he(this.scale[0]-1)||he(this.scale[1]-1);};var fe=[];de.updateTransform=function(){var t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;if(i||e){n=n||Qt(),i?this.getLocalTransform(n):ue(n),e&&(i?ie(n,t.transform,n):ee(n,t.transform)),this.transform=n;var a=this.globalScaleRatio;if(null!=a&&1!==a){this.getGlobalScale(fe);var o=fe[0]<0?-1:1,r=fe[1]<0?-1:1,s=((fe[0]-o)*a+o)/fe[0]||0,l=((fe[1]-r)*a+r)/fe[1]||0;n[0]*=s,n[1]*=s,n[2]*=l,n[3]*=l;}this.invTransform=this.invTransform||Qt(),re(this.invTransform,n);}else n&&ue(n);},de.getLocalTransform=function(t){return ce.getLocalTransform(this,t);},de.setTransform=function(t){var e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0);},de.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0);};var pe=[],ge=Qt();de.setLocalTransform=function(t){if(t){var e=t[0]*t[0]+t[1]*t[1],i=t[2]*t[2]+t[3]*t[3],n=this.position,a=this.scale;he(e-1)&&(e=Math.sqrt(e)),he(i-1)&&(i=Math.sqrt(i)),t[0]<0&&(e=-e),t[3]<0&&(i=-i),n[0]=t[4],n[1]=t[5],a[0]=e,a[1]=i,this.rotation=Math.atan2(-t[1]/i,t[0]/e);}},de.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(ie(pe,t.invTransform,e),e=pe);var i=this.origin;i&&(i[0]||i[1])&&(ge[4]=i[0],ge[5]=i[1],ie(pe,e,ge),pe[4]-=i[0],pe[5]-=i[1],e=pe),this.setLocalTransform(e);}},de.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1])):(t[0]=1,t[1]=1),t;},de.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&bt(i,i,n),i;},de.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&bt(i,i,n),i;},ce.getLocalTransform=function(t,e){ue(e=e||[]);var i=t.origin,n=t.scale||[1,1],a=t.rotation||0,o=t.position||[0,0];return i&&(e[4]-=i[0],e[5]-=i[1]),oe(e,e,n),a&&ae(e,e,a),i&&(e[4]+=i[0],e[5]+=i[1]),e[4]+=o[0],e[5]+=o[1],e;};var me={linear:function linear(t){return t;},quadraticIn:function quadraticIn(t){return t*t;},quadraticOut:function quadraticOut(t){return t*(2-t);},quadraticInOut:function quadraticInOut(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1);},cubicIn:function cubicIn(t){return t*t*t;},cubicOut:function cubicOut(t){return--t*t*t+1;},cubicInOut:function cubicInOut(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2);},quarticIn:function quarticIn(t){return t*t*t*t;},quarticOut:function quarticOut(t){return 1- --t*t*t*t;},quarticInOut:function quarticInOut(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2);},quinticIn:function quinticIn(t){return t*t*t*t*t;},quinticOut:function quinticOut(t){return--t*t*t*t*t+1;},quinticInOut:function quinticInOut(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2);},sinusoidalIn:function sinusoidalIn(t){return 1-Math.cos(t*Math.PI/2);},sinusoidalOut:function sinusoidalOut(t){return Math.sin(t*Math.PI/2);},sinusoidalInOut:function sinusoidalInOut(t){return .5*(1-Math.cos(Math.PI*t));},exponentialIn:function exponentialIn(t){return 0===t?0:Math.pow(1024,t-1);},exponentialOut:function exponentialOut(t){return 1===t?1:1-Math.pow(2,-10*t);},exponentialInOut:function exponentialInOut(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)));},circularIn:function circularIn(t){return 1-Math.sqrt(1-t*t);},circularOut:function circularOut(t){return Math.sqrt(1- --t*t);},circularInOut:function circularInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1);},elasticIn:function elasticIn(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4));},elasticOut:function elasticOut(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1);},elasticInOut:function elasticInOut(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1);},backIn:function backIn(t){return t*t*(2.70158*t-1.70158);},backOut:function backOut(t){return--t*t*(2.70158*t+1.70158)+1;},backInOut:function backInOut(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2);},bounceIn:function bounceIn(t){return 1-me.bounceOut(1-t);},bounceOut:function bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375;},bounceInOut:function bounceInOut(t){return t<.5?.5*me.bounceIn(2*t):.5*me.bounceOut(2*t-1)+.5;}};function ve(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1;}ve.prototype={constructor:ve,step:function step(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)this._pausedTime+=e;else{var i=(t-this._startTime-this._pausedTime)/this._life;if(!(i<0)){i=Math.min(i,1);var n=this.easing,a="string"==typeof n?me[n]:n,o="function"==typeof a?a(i):i;return this.fire("frame",o),1===i?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null;}}},restart:function restart(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1;},fire:function fire(t,e){this[t="on"+t]&&this[t](this._target,e);},pause:function pause(){this._paused=!0;},resume:function resume(){this._paused=!1;}};function ye(){this.head=null,this.tail=null,this._len=0;}var xe=ye.prototype;xe.insert=function(t){var e=new we(t);return this.insertEntry(e),e;},xe.insertEntry=function(t){this.head?((this.tail.next=t).prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++;},xe.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--;},xe.len=function(){return this._len;},xe.clear=function(){this.head=this.tail=null,this._len=0;};function _e(t){this._list=new ye(),this._map={},this._maxSize=t||10,this._lastRemovedEntry=null;}var we=function we(t){this.value=t,this.next,this.prev;},be=_e.prototype;be.put=function(t,e){var i=this._list,n=this._map,a=null;if(null==n[t]){var o=i.len(),r=this._lastRemovedEntry;if(o>=this._maxSize&&0<o){var s=i.head;i.remove(s),delete n[s.key],a=s.value,this._lastRemovedEntry=s;}r?r.value=e:r=new we(e),r.key=t,i.insertEntry(r),n[t]=r;}return a;},be.get=function(t){var e=this._map[t],i=this._list;if(null!=e)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value;},be.clear=function(){this._list.clear(),this._map={};};var Se={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Me(t){return(t=Math.round(t))<0?0:255<t?255:t;}function Ie(t){return t<0?0:1<t?1:t;}function Ae(t){return t.length&&"%"===t.charAt(t.length-1)?Me(parseFloat(t)/100*255):Me(parseInt(t,10));}function Te(t){return t.length&&"%"===t.charAt(t.length-1)?Ie(parseFloat(t)/100):Ie(parseFloat(t));}function De(t,e,i){return i<0?i+=1:1<i&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t;}function Ce(t,e,i){return t+(e-t)*i;}function Le(t,e,i,n,a){return t[0]=e,t[1]=i,t[2]=n,t[3]=a,t;}function ke(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t;}var Pe=new _e(20),Ne=null;function Oe(t,e){Ne&&ke(Ne,e),Ne=Pe.put(t,Ne||e.slice());}function Ee(t,e){if(t){e=e||[];var i=Pe.get(t);if(i)return ke(e,i);var n,a=(t+="").replace(/ /g,"").toLowerCase();if(a in Se)return ke(e,Se[a]),Oe(t,e),e;if("#"===a.charAt(0))return 4===a.length?0<=(n=parseInt(a.substr(1),16))&&n<=4095?(Le(e,(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1),Oe(t,e),e):void Le(e,0,0,0,1):7===a.length?0<=(n=parseInt(a.substr(1),16))&&n<=16777215?(Le(e,(16711680&n)>>16,(65280&n)>>8,255&n,1),Oe(t,e),e):void Le(e,0,0,0,1):void 0;var o=a.indexOf("("),r=a.indexOf(")");if(-1!==o&&r+1===a.length){var s=a.substr(0,o),l=a.substr(o+1,r-(o+1)).split(","),u=1;switch(s){case"rgba":if(4!==l.length)return void Le(e,0,0,0,1);u=Te(l.pop());case"rgb":return 3!==l.length?void Le(e,0,0,0,1):(Le(e,Ae(l[0]),Ae(l[1]),Ae(l[2]),u),Oe(t,e),e);case"hsla":return 4!==l.length?void Le(e,0,0,0,1):(l[3]=Te(l[3]),Re(l,e),Oe(t,e),e);case"hsl":return 3!==l.length?void Le(e,0,0,0,1):(Re(l,e),Oe(t,e),e);default:return;}}Le(e,0,0,0,1);}}function Re(t,e){var i=(parseFloat(t[0])%360+360)%360/360,n=Te(t[1]),a=Te(t[2]),o=a<=.5?a*(n+1):a+n-a*n,r=2*a-o;return Le(e=e||[],Me(255*De(r,o,i+1/3)),Me(255*De(r,o,i)),Me(255*De(r,o,i-1/3)),1),4===t.length&&(e[3]=t[3]),e;}function ze(t,e){var i=Ee(t);if(i){for(var n=0;n<3;n++){i[n]=e<0?i[n]*(1-e)|0:(255-i[n])*e+i[n]|0,255<i[n]?i[n]=255:t[n]<0&&(i[n]=0);}return Ue(i,4===i.length?"rgba":"rgb");}}function Be(t){var e=Ee(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1);}function Ve(t,e,i){if(e&&e.length&&0<=t&&t<=1){i=i||[];var n=t*(e.length-1),a=Math.floor(n),o=Math.ceil(n),r=e[a],s=e[o],l=n-a;return i[0]=Me(Ce(r[0],s[0],l)),i[1]=Me(Ce(r[1],s[1],l)),i[2]=Me(Ce(r[2],s[2],l)),i[3]=Ie(Ce(r[3],s[3],l)),i;}}var Ge=Ve;function Fe(t,e,i){if(e&&e.length&&0<=t&&t<=1){var n=t*(e.length-1),a=Math.floor(n),o=Math.ceil(n),r=Ee(e[a]),s=Ee(e[o]),l=n-a,u=Ue([Me(Ce(r[0],s[0],l)),Me(Ce(r[1],s[1],l)),Me(Ce(r[2],s[2],l)),Ie(Ce(r[3],s[3],l))],"rgba");return i?{color:u,leftIndex:a,rightIndex:o,value:n}:u;}}var We=Fe;function He(t,e,i,n){if(t=Ee(t))return t=function(t){if(t){var e,i,n=t[0]/255,a=t[1]/255,o=t[2]/255,r=Math.min(n,a,o),s=Math.max(n,a,o),l=s-r,u=(s+r)/2;if(0==l)i=e=0;else{i=u<.5?l/(s+r):l/(2-s-r);var h=((s-n)/6+l/2)/l,c=((s-a)/6+l/2)/l,d=((s-o)/6+l/2)/l;n===s?e=d-c:a===s?e=1/3+h-d:o===s&&(e=2/3+c-h),e<0&&(e+=1),1<e&&(e-=1);}var f=[360*e,i,u];return null!=t[3]&&f.push(t[3]),f;}}(t),null!=e&&(t[0]=function(t){return(t=Math.round(t))<0?0:360<t?360:t;}(e)),null!=i&&(t[1]=Te(i)),null!=n&&(t[2]=Te(n)),Ue(Re(t),"rgba");}function Ze(t,e){if((t=Ee(t))&&null!=e)return t[3]=Ie(e),Ue(t,"rgba");}function Ue(t,e){if(t&&t.length){var i=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(i+=","+t[3]),e+"("+i+")";}}var Xe=(Object.freeze||Object)({parse:Ee,lift:ze,toHex:Be,fastLerp:Ve,fastMapToColor:Ge,lerp:Fe,mapToColor:We,modifyHSL:He,modifyAlpha:Ze,stringify:Ue}),Ye=Array.prototype.slice;function je(t,e){return t[e];}function qe(t,e,i){t[e]=i;}function Ke(t,e,i){return(e-t)*i+t;}function $e(t,e,i){return .5<i?e:t;}function Je(t,e,i,n,a){var o=t.length;if(1===a)for(var r=0;r<o;r++){n[r]=Ke(t[r],e[r],i);}else{var s=o&&t[0].length;for(r=0;r<o;r++){for(var l=0;l<s;l++){n[r][l]=Ke(t[r][l],e[r][l],i);}}}}function Qe(t,e,i){var n=t.length,a=e.length;if(n!==a)if(a<n)t.length=a;else for(var o=n;o<a;o++){t.push(1===i?e[o]:Ye.call(e[o]));}var r=t[0]&&t[0].length;for(o=0;o<t.length;o++){if(1===i)isNaN(t[o])&&(t[o]=e[o]);else for(var s=0;s<r;s++){isNaN(t[o][s])&&(t[o][s]=e[o][s]);}}}function ti(t,e,i){if(t===e)return!0;var n=t.length;if(n!==e.length)return!1;if(1===i){for(var a=0;a<n;a++){if(t[a]!==e[a])return!1;}}else{var o=t[0].length;for(a=0;a<n;a++){for(var r=0;r<o;r++){if(t[a][r]!==e[a][r])return!1;}}}return!0;}function ei(t,e,i,n,a,o,r,s,l){var u=t.length;if(1===l)for(var h=0;h<u;h++){s[h]=ii(t[h],e[h],i[h],n[h],a,o,r);}else{var c=t[0].length;for(h=0;h<u;h++){for(var d=0;d<c;d++){s[h][d]=ii(t[h][d],e[h][d],i[h][d],n[h][d],a,o,r);}}}}function ii(t,e,i,n,a,o,r){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*r+(-3*(e-i)-2*s-l)*o+s*a+e;}function ni(t){if(P(t)){var e=t.length;if(P(t[0])){for(var i=[],n=0;n<e;n++){i.push(Ye.call(t[n]));}return i;}return Ye.call(t);}return t;}function ai(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")";}function oi(t,e,i,n,o,a){var r=t._getter,s=t._setter,l="spline"===e,u=n.length;if(u){var h,c=P(n[0].value),d=!1,f=!1,p=c?function(t){var e=t[t.length-1].value;return P(e&&e[0])?2:1;}(n):0;n.sort(function(t,e){return t.time-e.time;}),h=n[u-1].time;for(var g=[],m=[],v=n[0].value,y=!0,x=0;x<u;x++){g.push(n[x].time/h);var _=n[x].value;if(c&&ti(_,v,p)||!c&&_===v||(y=!1),"string"==typeof(v=_)){var w=Ee(_);w?(_=w,d=!0):f=!0;}m.push(_);}if(a||!y){var b=m[u-1];for(x=0;x<u-1;x++){c?Qe(m[x],b,p):!isNaN(m[x])||isNaN(b)||f||d||(m[x]=b);}c&&Qe(r(t._target,o),b,p);var S,M,I,A,T,D=0,C=0;if(d)var L=[0,0,0,0];var k=new ve({target:t._target,life:h,loop:t._loop,delay:t._delay,onframe:function onframe(t,e){var i;if(e<0)i=0;else if(e<C){for(i=Math.min(D+1,u-1);0<=i&&!(g[i]<=e);i--){;}i=Math.min(i,u-2);}else{for(i=D;i<u&&!(g[i]>e);i++){;}i=Math.min(i-1,u-2);}C=e;var n=g[(D=i)+1]-g[i];if(0!=n)if(S=(e-g[i])/n,l){if(I=m[i],M=m[0===i?i:i-1],A=m[u-2<i?u-1:i+1],T=m[u-3<i?u-1:i+2],c)ei(M,I,A,T,S,S*S,S*S*S,r(t,o),p);else{if(d)a=ei(M,I,A,T,S,S*S,S*S*S,L,1),a=ai(L);else{if(f)return $e(I,A,S);a=ii(M,I,A,T,S,S*S,S*S*S);}s(t,o,a);}}else if(c)Je(m[i],m[i+1],S,r(t,o),p);else{var a;if(d)Je(m[i],m[i+1],S,L,1),a=ai(L);else{if(f)return $e(m[i],m[i+1],S);a=Ke(m[i],m[i+1],S);}s(t,o,a);}},ondestroy:i});return e&&"spline"!==e&&(k.easing=e),k;}}}function ri(t,e,i,n){this._tracks={},this._target=t,this._loop=e||!1,this._getter=i||je,this._setter=n||qe,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[];}ri.prototype={when:function when(t,e){var i=this._tracks;for(var n in e){if(e.hasOwnProperty(n)){if(!i[n]){i[n]=[];var a=this._getter(this._target,n);if(null==a)continue;0!==t&&i[n].push({time:0,value:ni(a)});}i[n].push({time:t,value:e[n]});}}return this;},during:function during(t){return this._onframeList.push(t),this;},pause:function pause(){for(var t=0;t<this._clipList.length;t++){this._clipList[t].pause();}this._paused=!0;},resume:function resume(){for(var t=0;t<this._clipList.length;t++){this._clipList[t].resume();}this._paused=!1;},isPaused:function isPaused(){return!!this._paused;},_doneCallback:function _doneCallback(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,i=0;i<e;i++){t[i].call(this);}},start:function start(t,e){function i(){--o||a._doneCallback();}var n,a=this,o=0;for(var r in this._tracks){if(this._tracks.hasOwnProperty(r)){var s=oi(this,t,i,this._tracks[r],r,e);s&&(this._clipList.push(s),o++,this.animation&&this.animation.addClip(s),n=s);}}if(n){var l=n.onframe;n.onframe=function(t,e){l(t,e);for(var i=0;i<a._onframeList.length;i++){a._onframeList[i](t,e);}};}return o||this._doneCallback(),this;},stop:function stop(t){for(var e=this._clipList,i=this.animation,n=0;n<e.length;n++){var a=e[n];t&&a.onframe(this._target,1),i&&i.removeClip(a);}e.length=0;},delay:function delay(t){return this._delay=t,this;},done:function done(t){return t&&this._doneList.push(t),this;},getClips:function getClips(){return this._clipList;}};var si=1;"undefined"!=typeof window&&(si=Math.max(window.devicePixelRatio||1,1));var li=si,ui=function ui(){};function hi(){this.animators=[];}var ci=ui;function di(t,e,i,n,a,o,r,s){R(n)?(o=a,a=n,n=0):O(a)?(o=a,a="linear",n=0):O(n)?(o=n,n=0):i=O(i)?(o=i,500):i||500,t.stopAnimation(),function t(e,i,n,a,o,r,s){var l={};var u=0;for(var h in a){a.hasOwnProperty(h)&&(null!=n[h]?z(a[h])&&!P(a[h])?t(e,i?i+"."+h:h,n[h],a[h],o,r,s):(s?(l[h]=n[h],fi(e,i,h,a[h])):l[h]=a[h],u++):null==a[h]||s||fi(e,i,h,a[h]));}0<u&&e.animate(i,!1).when(null==o?500:o,l).delay(r||0);}(t,"",t,e,i,n,s);var l=t.animators.slice(),u=l.length;function h(){--u||o&&o();}u||o&&o();for(var c=0;c<l.length;c++){l[c].done(h).start(a,r);}}function fi(t,e,i,n){if(e){var a={};a[e]={},a[e][i]=n,t.attr(a);}else t.attr(i,n);}hi.prototype={constructor:hi,animate:function animate(t,e){var i,n=!1,a=this,o=this.__zr;if(t){var r=t.split("."),s=a;n="shape"===r[0];for(var l=0,u=r.length;l<u;l++){s=s&&s[r[l]];}s&&(i=s);}else i=a;if(i){var h=a.animators,c=new ri(i,e);return c.during(function(t){a.dirty(n);}).done(function(){h.splice(_(h,c),1);}),h.push(c),o&&o.animation.addAnimator(c),c;}ci('Property "'+t+'" is not existed in element '+a.id);},stopAnimation:function stopAnimation(t){for(var e=this.animators,i=e.length,n=0;n<i;n++){e[n].stop(t);}return e.length=0,this;},animateTo:function animateTo(t,e,i,n,a,o){di(this,t,e,i,n,a,o);},animateFrom:function animateFrom(t,e,i,n,a,o){di(this,t,e,i,n,a,o,!0);}};var pi=function pi(t){ce.call(this,t),Ct.call(this,t),hi.call(this,t),this.id=t.id||n();};pi.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,isGroup:!1,drift:function drift(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0;}var i=this.transform;(i=i||(this.transform=[1,0,0,1,0,0]))[4]+=t,i[5]+=e,this.decomposeTransform(),this.dirty(!1);},beforeUpdate:function beforeUpdate(){},afterUpdate:function afterUpdate(){},update:function update(){this.updateTransform();},traverse:function traverse(t,e){},attrKV:function attrKV(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var i=this[t];(i=i||(this[t]=[]))[0]=e[0],i[1]=e[1];}}else this[t]=e;},hide:function hide(){this.ignore=!0,this.__zr&&this.__zr.refresh();},show:function show(){this.ignore=!1,this.__zr&&this.__zr.refresh();},attr:function attr(t,e){if("string"==typeof t)this.attrKV(t,e);else if(z(t))for(var i in t){t.hasOwnProperty(i)&&this.attrKV(i,t[i]);}return this.dirty(!1),this;},setClipPath:function setClipPath(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),(this.clipPath=t).__zr=e,(t.__clipTarget=this).dirty(!1);},removeClipPath:function removeClipPath(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1));},addSelfToZr:function addSelfToZr(t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.addAnimator(e[i]);}this.clipPath&&this.clipPath.addSelfToZr(t);},removeSelfFromZr:function removeSelfFromZr(t){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.removeAnimator(e[i]);}this.clipPath&&this.clipPath.removeSelfFromZr(t);}},b(pi,hi),b(pi,ce),b(pi,Ct);var gi,mi,vi,yi,xi=bt,_i=Math.min,wi=Math.max;function bi(t,e,i,n){i<0&&(t+=i,i=-i),n<0&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n;}bi.prototype={constructor:bi,union:function union(t){var e=_i(t.x,this.x),i=_i(t.y,this.y);this.width=wi(t.x+t.width,this.x+this.width)-e,this.height=wi(t.y+t.height,this.y+this.height)-i,this.x=e,this.y=i;},applyTransform:(gi=[],mi=[],vi=[],yi=[],function(t){if(t){gi[0]=vi[0]=this.x,gi[1]=yi[1]=this.y,mi[0]=yi[0]=this.x+this.width,mi[1]=vi[1]=this.y+this.height,xi(gi,gi,t),xi(mi,mi,t),xi(vi,vi,t),xi(yi,yi,t),this.x=_i(gi[0],mi[0],vi[0],yi[0]),this.y=_i(gi[1],mi[1],vi[1],yi[1]);var e=wi(gi[0],mi[0],vi[0],yi[0]),i=wi(gi[1],mi[1],vi[1],yi[1]);this.width=e-this.x,this.height=i-this.y;}}),calculateTransform:function calculateTransform(t){var e=t.width/this.width,i=t.height/this.height,n=Qt();return ne(n,n,[-this.x,-this.y]),oe(n,n,[e,i]),ne(n,n,[t.x,t.y]),n;},intersect:function intersect(t){if(!t)return!1;t instanceof bi||(t=bi.create(t));var e=this,i=e.x,n=e.x+e.width,a=e.y,o=e.y+e.height,r=t.x,s=t.x+t.width,l=t.y,u=t.y+t.height;return!(n<r||s<i||o<l||u<a);},contain:function contain(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height;},clone:function clone(){return new bi(this.x,this.y,this.width,this.height);},copy:function copy(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height;},plain:function plain(){return{x:this.x,y:this.y,width:this.width,height:this.height};}},bi.create=function(t){return new bi(t.x,t.y,t.width,t.height);};var Si=function Si(t){for(var e in t=t||{},pi.call(this,t),t){t.hasOwnProperty(e)&&(this[e]=t[e]);}this._children=[],this.__storage=null,this.__dirty=!0;};Si.prototype={constructor:Si,isGroup:!0,type:"group",silent:!1,children:function children(){return this._children.slice();},childAt:function childAt(t){return this._children[t];},childOfName:function childOfName(t){for(var e=this._children,i=0;i<e.length;i++){if(e[i].name===t)return e[i];}},childCount:function childCount(){return this._children.length;},add:function add(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this;},addBefore:function addBefore(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);0<=n&&(i.splice(n,0,t),this._doAdd(t));}return this;},_doAdd:function _doAdd(t){t.parent&&t.parent.remove(t);var e=(t.parent=this).__storage,i=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof Si&&t.addChildrenToStorage(e)),i&&i.refresh();},remove:function remove(t){var e=this.__zr,i=this.__storage,n=this._children,a=_(n,t);return a<0||(n.splice(a,1),t.parent=null,i&&(i.delFromStorage(t),t instanceof Si&&t.delChildrenFromStorage(i)),e&&e.refresh()),this;},removeAll:function removeAll(){var t,e,i=this._children,n=this.__storage;for(e=0;e<i.length;e++){t=i[e],n&&(n.delFromStorage(t),t instanceof Si&&t.delChildrenFromStorage(n)),t.parent=null;}return i.length=0,this;},eachChild:function eachChild(t,e){for(var i=this._children,n=0;n<i.length;n++){var a=i[n];t.call(e,a,n);}return this;},traverse:function traverse(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i];t.call(e,n),"group"===n.type&&n.traverse(t,e);}return this;},addChildrenToStorage:function addChildrenToStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.addToStorage(i),i instanceof Si&&i.addChildrenToStorage(t);}},delChildrenFromStorage:function delChildrenFromStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.delFromStorage(i),i instanceof Si&&i.delChildrenFromStorage(t);}},dirty:function dirty(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this;},getBoundingRect:function getBoundingRect(t){for(var e=null,i=new bi(0,0,0,0),n=t||this._children,a=[],o=0;o<n.length;o++){var r=n[o];if(!r.ignore&&!r.invisible){var s=r.getBoundingRect(),l=r.getLocalTransform(a);l?(i.copy(s),i.applyTransform(l),(e=e||i.clone()).union(i)):(e=e||s.clone()).union(s);}}return e||i;}},w(Si,pi);var Mi=32,Ii=7;function Ai(t,e,i,n){var a=e+1;if(a===i)return 1;if(n(t[a++],t[e])<0){for(;a<i&&n(t[a],t[a-1])<0;){a++;}!function(t,e,i){i--;for(;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n;}}(t,e,a);}else for(;a<i&&0<=n(t[a],t[a-1]);){a++;}return a-e;}function Ti(t,e,i,n,a){for(n===e&&n++;n<i;n++){for(var o,r=t[n],s=e,l=n;s<l;){a(r,t[o=s+l>>>1])<0?l=o:s=1+o;}var u=n-s;switch(u){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;0<u;){t[s+u]=t[s+u-1],u--;}}t[s]=r;}}function Di(t,e,i,n,a,o){var r=0,s=0,l=1;if(0<o(t,e[i+a])){for(s=n-a;l<s&&0<o(t,e[i+a+l]);){(l=1+((r=l)<<1))<=0&&(l=s);}s<l&&(l=s),r+=a,l+=a;}else{for(s=a+1;l<s&&o(t,e[i+a-l])<=0;){(l=1+((r=l)<<1))<=0&&(l=s);}s<l&&(l=s);var u=r;r=a-l,l=a-u;}for(r++;r<l;){var h=r+(l-r>>>1);0<o(t,e[i+h])?r=h+1:l=h;}return l;}function Ci(t,e,i,n,a,o){var r=0,s=0,l=1;if(o(t,e[i+a])<0){for(s=a+1;l<s&&o(t,e[i+a-l])<0;){(l=1+((r=l)<<1))<=0&&(l=s);}s<l&&(l=s);var u=r;r=a-l,l=a-u;}else{for(s=n-a;l<s&&0<=o(t,e[i+a+l]);){(l=1+((r=l)<<1))<=0&&(l=s);}s<l&&(l=s),r+=a,l+=a;}for(r++;r<l;){var h=r+(l-r>>>1);o(t,e[i+h])<0?l=h:r=h+1;}return l;}function Li(p,g){var r,s,m=Ii,l=0,v=[];function e(t){var e=r[t],i=s[t],n=r[t+1],a=s[t+1];s[t]=i+a,t===l-3&&(r[t+1]=r[t+2],s[t+1]=s[t+2]),l--;var o=Ci(p[n],p,e,i,0,g);e+=o,0!==(i-=o)&&0!==(a=Di(p[e+i-1],p,n,a,a-1,g))&&(i<=a?function(t,e,i,n){var a=0;for(a=0;a<e;a++){v[a]=p[t+a];}var o=0,r=i,s=t;if(p[s++]=p[r++],0==--n){for(a=0;a<e;a++){p[s+a]=v[o+a];}return;}if(1===e){for(a=0;a<n;a++){p[s+a]=p[r+a];}return p[s+n]=v[o];}var l,u,h,c=m;for(;;){u=l=0,h=!1;do{if(g(p[r],v[o])<0){if(p[s++]=p[r++],u++,(l=0)==--n){h=!0;break;}}else if(p[s++]=v[o++],l++,u=0,1==--e){h=!0;break;}}while((l|u)<c);if(h)break;do{if(0!==(l=Ci(p[r],v,o,e,0,g))){for(a=0;a<l;a++){p[s+a]=v[o+a];}if(s+=l,o+=l,(e-=l)<=1){h=!0;break;}}if(p[s++]=p[r++],0==--n){h=!0;break;}if(0!==(u=Di(v[o],p,r,n,0,g))){for(a=0;a<u;a++){p[s+a]=p[r+a];}if(s+=u,r+=u,0===(n-=u)){h=!0;break;}}if(p[s++]=v[o++],1==--e){h=!0;break;}c--;}while(Ii<=l||Ii<=u);if(h)break;c<0&&(c=0),c+=2;}if((m=c)<1&&(m=1),1===e){for(a=0;a<n;a++){p[s+a]=p[r+a];}p[s+n]=v[o];}else{if(0===e)throw new Error();for(a=0;a<e;a++){p[s+a]=v[o+a];}}}(e,i,n,a):function(t,e,i,n){var a=0;for(a=0;a<n;a++){v[a]=p[i+a];}var o=t+e-1,r=n-1,s=i+n-1,l=0,u=0;if(p[s--]=p[o--],0==--e){for(l=s-(n-1),a=0;a<n;a++){p[l+a]=v[a];}return;}if(1===n){for(u=(s-=e)+1,l=(o-=e)+1,a=e-1;0<=a;a--){p[u+a]=p[l+a];}return p[s]=v[r];}var h=m;for(;;){var c=0,d=0,f=!1;do{if(g(v[r],p[o])<0){if(p[s--]=p[o--],c++,(d=0)==--e){f=!0;break;}}else if(p[s--]=v[r--],d++,c=0,1==--n){f=!0;break;}}while((c|d)<h);if(f)break;do{if(0!==(c=e-Ci(v[r],p,t,e,e-1,g))){for(e-=c,u=(s-=c)+1,l=(o-=c)+1,a=c-1;0<=a;a--){p[u+a]=p[l+a];}if(0===e){f=!0;break;}}if(p[s--]=v[r--],1==--n){f=!0;break;}if(0!==(d=n-Di(p[o],v,0,n,n-1,g))){for(n-=d,u=(s-=d)+1,l=(r-=d)+1,a=0;a<d;a++){p[u+a]=v[l+a];}if(n<=1){f=!0;break;}}if(p[s--]=p[o--],0==--e){f=!0;break;}h--;}while(Ii<=c||Ii<=d);if(f)break;h<0&&(h=0),h+=2;}(m=h)<1&&(m=1);if(1===n){for(u=(s-=e)+1,l=(o-=e)+1,a=e-1;0<=a;a--){p[u+a]=p[l+a];}p[s]=v[r];}else{if(0===n)throw new Error();for(l=s-(n-1),a=0;a<n;a++){p[l+a]=v[a];}}}(e,i,n,a));}r=[],s=[],this.mergeRuns=function(){for(;1<l;){var t=l-2;if(1<=t&&s[t-1]<=s[t]+s[t+1]||2<=t&&s[t-2]<=s[t]+s[t-1])s[t-1]<s[t+1]&&t--;else if(s[t]>s[t+1])break;e(t);}},this.forceMergeRuns=function(){for(;1<l;){var t=l-2;0<t&&s[t-1]<s[t+1]&&t--,e(t);}},this.pushRun=function(t,e){r[l]=t,s[l]=e,l+=1;};}function ki(t,e,i,n){i=i||0;var a=(n=n||t.length)-i;if(!(a<2)){var o=0;if(a<Mi)Ti(t,i,n,i+(o=Ai(t,i,n,e)),e);else{var r=new Li(t,e),s=function(t){for(var e=0;Mi<=t;){e|=1&t,t>>=1;}return t+e;}(a);do{if((o=Ai(t,i,n,e))<s){var l=a;s<l&&(l=s),Ti(t,i,i+l,i+o,e),o=l;}r.pushRun(i,o),r.mergeRuns(),a-=o,i+=o;}while(0!==a);r.forceMergeRuns();}}}function Pi(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel;}function Ni(){this._roots=[],this._displayList=[],this._displayListLen=0;}Ni.prototype={constructor:Ni,traverse:function traverse(t,e){for(var i=0;i<this._roots.length;i++){this._roots[i].traverse(t,e);}},getDisplayList:function getDisplayList(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList;},updateDisplayList:function updateDisplayList(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,n=0,a=e.length;n<a;n++){this._updateAndAddDisplayable(e[n],null,t);}i.length=this._displayListLen,v.canvasSupported&&ki(i,Pi);},_updateAndAddDisplayable:function _updateAndAddDisplayable(t,e,i){if(!t.ignore||i){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var n=t.clipPath;if(n){e=e?e.slice():[];for(var a=n,o=t;a;){a.parent=o,a.updateTransform(),e.push(a),a=(o=a).clipPath;}}if(t.isGroup){for(var r=t._children,s=0;s<r.length;s++){var l=r[s];t.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,e,i);}t.__dirty=!1;}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t;}},addRoot:function addRoot(t){t.__storage!==this&&(t instanceof Si&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t));},delRoot:function delRoot(t){if(null==t){for(var e=0;e<this._roots.length;e++){var i=this._roots[e];i instanceof Si&&i.delChildrenFromStorage(this);}return this._roots=[],this._displayList=[],void(this._displayListLen=0);}if(t instanceof Array){e=0;for(var n=t.length;e<n;e++){this.delRoot(t[e]);}}else{var a=_(this._roots,t);0<=a&&(this.delFromStorage(t),this._roots.splice(a,1),t instanceof Si&&t.delChildrenFromStorage(this));}},addToStorage:function addToStorage(t){return t&&(t.__storage=this,t.dirty(!1)),this;},delFromStorage:function delFromStorage(t){return t&&(t.__storage=null),this;},dispose:function dispose(){this._renderList=this._roots=null;},displayableSortFunc:Pi};var Oi={shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1,textShadowBlur:1,textShadowOffsetX:1,textShadowOffsetY:1,textBoxShadowBlur:1,textBoxShadowOffsetX:1,textBoxShadowOffsetY:1},Ei=function Ei(t,e,i){return Oi.hasOwnProperty(e)?i*t.dpr:i;},Ri={NONE:0,STYLE_BIND:1,PLAIN_TEXT:2},zi=9,Bi=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],Vi=function Vi(t){this.extendFrom(t,!1);};function Gi(t,e,i){var n=null==e.x?0:e.x,a=null==e.x2?1:e.x2,o=null==e.y?0:e.y,r=null==e.y2?0:e.y2;return e.global||(n=n*i.width+i.x,a=a*i.width+i.x,o=o*i.height+i.y,r=r*i.height+i.y),n=isNaN(n)?0:n,a=isNaN(a)?1:a,o=isNaN(o)?0:o,r=isNaN(r)?0:r,t.createLinearGradient(n,o,a,r);}function Fi(t,e,i){var n=i.width,a=i.height,o=Math.min(n,a),r=null==e.x?.5:e.x,s=null==e.y?.5:e.y,l=null==e.r?.5:e.r;return e.global||(r=r*n+i.x,s=s*a+i.y,l*=o),t.createRadialGradient(r,s,0,r,s,l);}Vi.prototype={constructor:Vi,fill:"#000",stroke:null,opacity:1,fillOpacity:null,strokeOpacity:null,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function bind(t,e,i){var n=this,a=i&&i.style,o=!a||t.__attrCachedBy!==Ri.STYLE_BIND;t.__attrCachedBy=Ri.STYLE_BIND;for(var r=0;r<Bi.length;r++){var s=Bi[r],l=s[0];!o&&n[l]===a[l]||(t[l]=Ei(t,l,n[l]||s[1]));}if(!o&&n.fill===a.fill||(t.fillStyle=n.fill),!o&&n.stroke===a.stroke||(t.strokeStyle=n.stroke),!o&&n.opacity===a.opacity||(t.globalAlpha=null==n.opacity?1:n.opacity),!o&&n.blend===a.blend||(t.globalCompositeOperation=n.blend||"source-over"),this.hasStroke()){var u=n.lineWidth;t.lineWidth=u/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1);}},hasFill:function hasFill(){var t=this.fill;return null!=t&&"none"!==t;},hasStroke:function hasStroke(){var t=this.stroke;return null!=t&&"none"!==t&&0<this.lineWidth;},extendFrom:function extendFrom(t,e){if(t)for(var i in t){!t.hasOwnProperty(i)||!0!==e&&(!1===e?this.hasOwnProperty(i):null==t[i])||(this[i]=t[i]);}},set:function set(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0);},clone:function clone(){var t=new this.constructor();return t.extendFrom(this,!0),t;},getGradient:function getGradient(t,e,i){for(var n=("radial"===e.type?Fi:Gi)(t,e,i),a=e.colorStops,o=0;o<a.length;o++){n.addColorStop(a[o].offset,a[o].color);}return n;}};for(var Wi=Vi.prototype,Hi=0;Hi<Bi.length;Hi++){var Zi=Bi[Hi];Zi[0]in Wi||(Wi[Zi[0]]=Zi[1]);}Vi.getGradient=Wi.getGradient;function Ui(t,e){this.image=t,this.repeat=e,this.type="pattern";}function Xi(){return!1;}function Yi(t,e,i){var n=g(),a=e.getWidth(),o=e.getHeight(),r=n.style;return r&&(r.position="absolute",r.left=0,r.top=0,r.width=a+"px",r.height=o+"px",n.setAttribute("data-zr-dom-id",t)),n.width=a*i,n.height=o*i,n;}function ji(t,e,i){var n;i=i||li,"string"==typeof t?n=Yi(t,e,i):z(t)&&(t=(n=t).id),this.id=t;var a=(this.dom=n).style;a&&(n.onselectstart=Xi,a["-webkit-user-select"]="none",a["user-select"]="none",a["-webkit-touch-callout"]="none",a["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",a.padding=0,a.margin=0,a["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=i;}ji.prototype={constructor:ji,__dirty:!0,__used:!(Ui.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat");}),__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function getElementCount(){return this.__endIndex-this.__startIndex;},initContext:function initContext(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr;},createBackBuffer:function createBackBuffer(){var t=this.dpr;this.domBack=Yi("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!==t&&this.ctxBack.scale(t,t);},resize:function resize(t,e){var i=this.dpr,n=this.dom,a=n.style,o=this.domBack;a&&(a.width=t+"px",a.height=e+"px"),n.width=t*i,n.height=e*i,o&&(o.width=t*i,o.height=e*i,1!==i&&this.ctxBack.scale(i,i));},clear:function clear(t,e){var i,n=this.dom,a=this.ctx,o=n.width,r=n.height,s=(e=e||this.clearColor,this.motionBlur&&!t),l=this.lastFrameAlpha,u=this.dpr;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,o/u,r/u)),a.clearRect(0,0,o,r),e&&"transparent"!==e&&(e.colorStops?(i=e.__canvasGradient||Vi.getGradient(a,e,{x:0,y:0,width:o,height:r}),e.__canvasGradient=i):e.image&&(i=Ui.prototype.getCanvasPattern.call(e,a)),a.save(),a.fillStyle=i||e,a.fillRect(0,0,o,r),a.restore());if(s){var h=this.domBack;a.save(),a.globalAlpha=l,a.drawImage(h,0,0,o,r),a.restore();}}};var qi="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16);},Ki=new _e(50);function $i(t){if("string"!=typeof t)return t;var e=Ki.get(t);return e&&e.image;}function Ji(t,e,i,n,a){if(t){if("string"!=typeof t)return t;if(e&&e.__zrImageSrc===t||!i)return e;var o=Ki.get(t),r={hostEl:i,cb:n,cbPayload:a};return o?tn(e=o.image)||o.pending.push(r):((e=new Image()).onload=e.onerror=Qi,Ki.put(t,e.__cachedImgObj={image:e,pending:[r]}),e.src=e.__zrImageSrc=t),e;}return e;}function Qi(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var i=t.pending[e],n=i.cb;n&&n(this,i.cbPayload),i.hostEl.dirty();}t.pending.length=0;}function tn(t){return t&&t.width&&t.height;}var en={},nn=0,an=5e3,on=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,rn="12px sans-serif",sn={};function ln(t,e){var i=t+":"+(e=e||rn);if(en[i])return en[i];for(var n,a,o=(t+"").split("\n"),r=0,s=0,l=o.length;s<l;s++){r=Math.max((n=o[s],a=e,sn.measureText(n,a)).width,r);}return an<nn&&(nn=0,en={}),nn++,en[i]=r;}function un(t,e,i,n,a,o,r,s){return r?function(t,e,i,n,a,o,r,s){var l=xn(t,{rich:r,truncate:s,font:e,textAlign:i,textPadding:a,textLineHeight:o}),u=l.outerWidth,h=l.outerHeight,c=hn(0,u,i),d=cn(0,h,n);return new bi(c,d,u,h);}(t,e,i,n,a,o,r,s):function(t,e,i,n,a,o,r){var s=yn(t,e,a,o,r),l=ln(t,e);a&&(l+=a[1]+a[3]);var u=s.outerHeight,h=hn(0,l,i),c=cn(0,u,n),d=new bi(h,c,l,u);return d.lineHeight=s.lineHeight,d;}(t,e,i,n,a,o,s);}function hn(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t;}function cn(t,e,i){return"middle"===i?t-=e/2:"bottom"===i&&(t-=e),t;}function dn(t,e,i){var n=e.textPosition,a=e.textDistance,o=i.x,r=i.y;a=a||0;var s=i.height,l=i.width,u=s/2,h="left",c="top";switch(n){case"left":o-=a,r+=u,h="right",c="middle";break;case"right":o+=a+l,r+=u,c="middle";break;case"top":o+=l/2,r-=a,h="center",c="bottom";break;case"bottom":o+=l/2,r+=s+a,h="center";break;case"inside":o+=l/2,r+=u,h="center",c="middle";break;case"insideLeft":o+=a,r+=u,c="middle";break;case"insideRight":o+=l-a,r+=u,h="right",c="middle";break;case"insideTop":o+=l/2,r+=a,h="center";break;case"insideBottom":o+=l/2,r+=s-a,h="center",c="bottom";break;case"insideTopLeft":o+=a,r+=a;break;case"insideTopRight":o+=l-a,r+=a,h="right";break;case"insideBottomLeft":o+=a,r+=s-a,c="bottom";break;case"insideBottomRight":o+=l-a,r+=s-a,h="right",c="bottom";}return(t=t||{}).x=o,t.y=r,t.textAlign=h,t.textVerticalAlign=c,t;}function fn(t,e,i,n,a){if(!e)return"";var o=(t+"").split("\n");a=pn(e,i,n,a);for(var r=0,s=o.length;r<s;r++){o[r]=gn(o[r],a);}return o.join("\n");}function pn(t,e,i,n){(n=L({},n)).font=e;i=H(i,"...");n.maxIterations=H(n.maxIterations,2);var a=n.minChar=H(n.minChar,0);n.cnCharWidth=ln("国",e);var o=n.ascCharWidth=ln("a",e);n.placeholder=H(n.placeholder,"");for(var r=t=Math.max(0,t-1),s=0;s<a&&o<=r;s++){r-=o;}var l=ln(i,e);return r<l&&(i="",l=0),r=t-l,n.ellipsis=i,n.ellipsisWidth=l,n.contentWidth=r,n.containerWidth=t,n;}function gn(t,e){var i=e.containerWidth,n=e.font,a=e.contentWidth;if(!i)return"";var o=ln(t,n);if(o<=i)return t;for(var r=0;;r++){if(o<=a||r>=e.maxIterations){t+=e.ellipsis;break;}var s=0===r?mn(t,a,e.ascCharWidth,e.cnCharWidth):0<o?Math.floor(t.length*a/o):0;o=ln(t=t.substr(0,s),n);}return""===t&&(t=e.placeholder),t;}function mn(t,e,i,n){for(var a=0,o=0,r=t.length;o<r&&a<e;o++){var s=t.charCodeAt(o);a+=0<=s&&s<=127?i:n;}return o;}function vn(t){return ln("国",t);}function yn(t,e,i,n,a){null!=t&&(t+="");var o=H(n,vn(e)),r=t?t.split("\n"):[],s=r.length*o,l=s,u=!0;if(i&&(l+=i[0]+i[2]),t&&a){u=!1;var h=a.outerHeight,c=a.outerWidth;if(null!=h&&h<l)t="",r=[];else if(null!=c)for(var d=pn(c-(i?i[1]+i[3]:0),e,a.ellipsis,{minChar:a.minChar,placeholder:a.placeholder}),f=0,p=r.length;f<p;f++){r[f]=gn(r[f],d);}}return{lines:r,height:s,outerHeight:l,lineHeight:o,canCacheByTextString:u};}function xn(t,e){var i={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return i;for(var n,a=on.lastIndex=0;null!=(n=on.exec(t));){var o=n.index;a<o&&_n(i,t.substring(a,o)),_n(i,n[2],n[1]),a=on.lastIndex;}a<t.length&&_n(i,t.substring(a,t.length));var r=i.lines,s=0,l=0,u=[],h=e.textPadding,c=e.truncate,d=c&&c.outerWidth,f=c&&c.outerHeight;h&&(null!=d&&(d-=h[1]+h[3]),null!=f&&(f-=h[0]+h[2]));for(var p=0;p<r.length;p++){for(var g=r[p],m=0,v=0,y=0;y<g.tokens.length;y++){var x=(C=g.tokens[y]).styleName&&e.rich[C.styleName]||{},_=C.textPadding=x.textPadding,w=C.font=x.font||e.font,b=C.textHeight=H(x.textHeight,vn(w));if(_&&(b+=_[0]+_[2]),C.height=b,C.lineHeight=Z(x.textLineHeight,e.textLineHeight,b),C.textAlign=x&&x.textAlign||e.textAlign,C.textVerticalAlign=x&&x.textVerticalAlign||"middle",null!=f&&s+C.lineHeight>f)return{lines:[],width:0,height:0};C.textWidth=ln(C.text,w);var S=x.textWidth,M=null==S||"auto"===S;if("string"==typeof S&&"%"===S.charAt(S.length-1))C.percentWidth=S,u.push(C),S=0;else{if(M){S=C.textWidth;var I=x.textBackgroundColor,A=I&&I.image;A&&tn(A=$i(A))&&(S=Math.max(S,A.width*b/A.height));}var T=_?_[1]+_[3]:0;S+=T;var D=null!=d?d-v:null;null!=D&&D<S&&(!M||D<T?(C.text="",C.textWidth=S=0):(C.text=fn(C.text,D-T,w,c.ellipsis,{minChar:c.minChar}),C.textWidth=ln(C.text,w),S=C.textWidth+T));}v+=C.width=S,x&&(m=Math.max(m,C.lineHeight));}g.width=v,s+=g.lineHeight=m,l=Math.max(l,v);}i.outerWidth=i.width=H(e.textWidth,l),i.outerHeight=i.height=H(e.textHeight,s),h&&(i.outerWidth+=h[1]+h[3],i.outerHeight+=h[0]+h[2]);for(p=0;p<u.length;p++){var C,L=(C=u[p]).percentWidth;C.width=parseInt(L,10)/100*l;}return i;}function _n(t,e,i){for(var n=""===e,a=e.split("\n"),o=t.lines,r=0;r<a.length;r++){var s=a[r],l={styleName:i,text:s,isLineHolder:!s&&!n};if(r)o.push({tokens:[l]});else{var u=(o[o.length-1]||(o[0]={tokens:[]})).tokens,h=u.length;1===h&&u[0].isLineHolder?u[0]=l:!s&&h&&!n||u.push(l);}}}function wn(t){var e=(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ");return e&&j(e)||t.textFont||t.font;}function bn(t,e){var i,n,a,o,r,s=e.x,l=e.y,u=e.width,h=e.height,c=e.r;u<0&&(s+=u,u=-u),h<0&&(l+=h,h=-h),"number"==typeof c?i=n=a=o=c:c instanceof Array?1===c.length?i=n=a=o=c[0]:2===c.length?(i=a=c[0],n=o=c[1]):3===c.length?(i=c[0],n=o=c[1],a=c[2]):(i=c[0],n=c[1],a=c[2],o=c[3]):i=n=a=o=0,u<i+n&&(i*=u/(r=i+n),n*=u/r),u<a+o&&(a*=u/(r=a+o),o*=u/r),h<n+a&&(n*=h/(r=n+a),a*=h/r),h<i+o&&(i*=h/(r=i+o),o*=h/r),t.moveTo(s+i,l),t.lineTo(s+u-n,l),0!==n&&t.arc(s+u-n,l+n,n,-Math.PI/2,0),t.lineTo(s+u,l+h-a),0!==a&&t.arc(s+u-a,l+h-a,a,0,Math.PI/2),t.lineTo(s+o,l+h),0!==o&&t.arc(s+o,l+h-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+i),0!==i&&t.arc(s+i,l+i,i,Math.PI,1.5*Math.PI);}sn.measureText=function(t,e){var i=x();return i.font=e||rn,i.measureText(t);};var Sn=rn,Mn={left:1,right:1,center:1},In={top:1,bottom:1,middle:1},An=[["textShadowBlur","shadowBlur",0],["textShadowOffsetX","shadowOffsetX",0],["textShadowOffsetY","shadowOffsetY",0],["textShadowColor","shadowColor","transparent"]],Tn={},Dn={};function Cn(t){return Ln(t),E(t.rich,Ln),t;}function Ln(t){if(t){t.font=wn(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||Mn[e]?e:"left";var i=t.textVerticalAlign||t.textBaseline;"center"===i&&(i="middle"),t.textVerticalAlign=null==i||In[i]?i:"top",t.textPadding&&(t.textPadding=X(t.textPadding));}}function kn(t,e,i,n,a,o){n.rich?function(t,e,i,n,a,o){o!==zi&&(e.__attrCachedBy=Ri.NONE);var r=t.__textCotentBlock;r&&!t.__dirtyText||(r=t.__textCotentBlock=xn(i,n));!function(t,e,i,n,a){var o=i.width,r=i.outerWidth,s=i.outerHeight,l=n.textPadding,u=zn(Dn,t,n,a),h=u.baseX,c=u.baseY,d=u.textAlign,f=u.textVerticalAlign;Pn(e,n,a,h,c);var p=hn(h,r,d),g=cn(c,s,f),m=p,v=g;l&&(m+=l[3],v+=l[0]);var y=m+o;On(n)&&En(t,e,n,p,g,r,s);for(var x=0;x<i.lines.length;x++){for(var _,w=i.lines[x],b=w.tokens,S=b.length,M=w.lineHeight,I=w.width,A=0,T=m,D=y,C=S-1;A<S&&(!(_=b[A]).textAlign||"left"===_.textAlign);){Nn(t,e,_,n,M,v,T,"left"),I-=_.width,T+=_.width,A++;}for(;0<=C&&"right"===(_=b[C]).textAlign;){Nn(t,e,_,n,M,v,D,"right"),I-=_.width,D-=_.width,C--;}for(T+=(o-(T-m)-(y-D)-I)/2;A<=C;){_=b[A],Nn(t,e,_,n,M,v,T+_.width/2,"center"),T+=_.width,A++;}v+=M;}}(t,e,r,n,a);}(t,e,i,n,a,o):function(t,e,i,n,a,o){var r,s=On(n),l=!1,u=e.__attrCachedBy===Ri.PLAIN_TEXT;o!==zi?(o&&(r=o.style,l=!s&&u&&r),e.__attrCachedBy=s?Ri.NONE:Ri.PLAIN_TEXT):u&&(e.__attrCachedBy=Ri.NONE);var h=n.font||Sn;l&&h===(r.font||Sn)||(e.font=h);var c=t.__computedFont;t.__styleFont!==h&&(t.__styleFont=h,c=t.__computedFont=e.font);var d=n.textPadding,f=n.textLineHeight,p=t.__textCotentBlock;p&&!t.__dirtyText||(p=t.__textCotentBlock=yn(i,c,d,f,n.truncate));var g=p.outerHeight,m=p.lines,v=p.lineHeight,y=zn(Dn,t,n,a),x=y.baseX,_=y.baseY,w=y.textAlign||"left",b=y.textVerticalAlign;Pn(e,n,a,x,_);var S=cn(_,g,b),M=x,I=S;if(s||d){var A=ln(i,c);d&&(A+=d[1]+d[3]);var T=hn(x,A,w);s&&En(t,e,n,T,S,A,g),d&&(M=Wn(x,w,d),I+=d[0]);}e.textAlign=w,e.textBaseline="middle",e.globalAlpha=n.opacity||1;for(var D=0;D<An.length;D++){var C=An[D],L=C[0],k=C[1],P=n[L];l&&P===r[L]||(e[k]=Ei(e,k,P||C[2]));}I+=v/2;var N=n.textStrokeWidth,O=l?r.textStrokeWidth:null,E=!l||N!==O,R=!l||E||n.textStroke!==r.textStroke,z=Vn(n.textStroke,N),B=Gn(n.textFill);z&&(E&&(e.lineWidth=N),R&&(e.strokeStyle=z));B&&(l&&n.textFill===r.textFill||(e.fillStyle=B));if(1===m.length)z&&e.strokeText(m[0],M,I),B&&e.fillText(m[0],M,I);else for(D=0;D<m.length;D++){z&&e.strokeText(m[D],M,I),B&&e.fillText(m[D],M,I),I+=v;}}(t,e,i,n,a,o);}function Pn(t,e,i,n,a){if(i&&e.textRotation){var o=e.textOrigin;"center"===o?(n=i.width/2+i.x,a=i.height/2+i.y):o&&(n=o[0]+i.x,a=o[1]+i.y),t.translate(n,a),t.rotate(-e.textRotation),t.translate(-n,-a);}}function Nn(t,e,i,n,a,o,r,s){var l=n.rich[i.styleName]||{};l.text=i.text;var u=i.textVerticalAlign,h=o+a/2;"top"===u?h=o+i.height/2:"bottom"===u&&(h=o+a-i.height/2),!i.isLineHolder&&On(l)&&En(t,e,l,"right"===s?r-i.width:"center"===s?r-i.width/2:r,h-i.height/2,i.width,i.height);var c=i.textPadding;c&&(r=Wn(r,s,c),h-=i.height/2-c[2]-i.textHeight/2),Bn(e,"shadowBlur",Z(l.textShadowBlur,n.textShadowBlur,0)),Bn(e,"shadowColor",l.textShadowColor||n.textShadowColor||"transparent"),Bn(e,"shadowOffsetX",Z(l.textShadowOffsetX,n.textShadowOffsetX,0)),Bn(e,"shadowOffsetY",Z(l.textShadowOffsetY,n.textShadowOffsetY,0)),Bn(e,"textAlign",s),Bn(e,"textBaseline","middle"),Bn(e,"font",i.font||Sn);var d=Vn(l.textStroke||n.textStroke,p),f=Gn(l.textFill||n.textFill),p=H(l.textStrokeWidth,n.textStrokeWidth);d&&(Bn(e,"lineWidth",p),Bn(e,"strokeStyle",d),e.strokeText(i.text,r,h)),f&&(Bn(e,"fillStyle",f),e.fillText(i.text,r,h));}function On(t){return!!(t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor);}function En(t,e,i,n,a,o,r){var s=i.textBackgroundColor,l=i.textBorderWidth,u=i.textBorderColor,h=R(s);if(Bn(e,"shadowBlur",i.textBoxShadowBlur||0),Bn(e,"shadowColor",i.textBoxShadowColor||"transparent"),Bn(e,"shadowOffsetX",i.textBoxShadowOffsetX||0),Bn(e,"shadowOffsetY",i.textBoxShadowOffsetY||0),h||l&&u){e.beginPath();var c=i.textBorderRadius;c?bn(e,{x:n,y:a,width:o,height:r,r:c}):e.rect(n,a,o,r),e.closePath();}if(h){if(Bn(e,"fillStyle",s),null!=i.fillOpacity){var d=e.globalAlpha;e.globalAlpha=i.fillOpacity*i.opacity,e.fill(),e.globalAlpha=d;}else e.fill();}else if(z(s)){var f=s.image;(f=Ji(f,null,t,Rn,s))&&tn(f)&&e.drawImage(f,n,a,o,r);}if(l&&u)if(Bn(e,"lineWidth",l),Bn(e,"strokeStyle",u),null!=i.strokeOpacity){d=e.globalAlpha;e.globalAlpha=i.strokeOpacity*i.opacity,e.stroke(),e.globalAlpha=d;}else e.stroke();}function Rn(t,e){e.image=t;}function zn(t,e,i,n){var a=i.x||0,o=i.y||0,r=i.textAlign,s=i.textVerticalAlign;if(n){var l=i.textPosition;if(l instanceof Array)a=n.x+Fn(l[0],n.width),o=n.y+Fn(l[1],n.height);else{var u=e&&e.calculateTextPosition?e.calculateTextPosition(Tn,i,n):dn(Tn,i,n);a=u.x,o=u.y,r=r||u.textAlign,s=s||u.textVerticalAlign;}var h=i.textOffset;h&&(a+=h[0],o+=h[1]);}return(t=t||{}).baseX=a,t.baseY=o,t.textAlign=r,t.textVerticalAlign=s,t;}function Bn(t,e,i){return t[e]=Ei(t,e,i),t[e];}function Vn(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t;}function Gn(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t;}function Fn(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t;}function Wn(t,e,i){return"right"===e?t-i[1]:"center"===e?t+i[3]/2-i[1]/2:t+i[3];}function Hn(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding);}function Zn(){}var Un=new bi();function Xn(t){for(var e in t=t||{},pi.call(this,t),t){t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);}this.style=new Vi(t.style,this),this._rect=null,this.__clipPaths=null;}function Yn(t){Xn.call(this,t);}Xn.prototype={constructor:Xn,type:"displayable",__dirty:!0,invisible:!(Zn.prototype={constructor:Zn,drawRectText:function drawRectText(t,e){var i=this.style;e=i.textRect||e,this.__dirty&&Cn(i);var n=i.text;if(null!=n&&(n+=""),Hn(n,i)){t.save();var a=this.transform;i.transformText?this.setTransform(t):a&&(Un.copy(e),Un.applyTransform(a),e=Un),kn(this,t,n,i,e,zi),t.restore();}}}),z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:!1,incremental:!1,globalScaleRatio:1,beforeBrush:function beforeBrush(t){},afterBrush:function afterBrush(t){},brush:function brush(t,e){},getBoundingRect:function getBoundingRect(){},contain:function contain(t,e){return this.rectContain(t,e);},traverse:function traverse(t,e){t.call(e,this);},rectContain:function rectContain(t,e){var i=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(i[0],i[1]);},dirty:function dirty(){this.__dirty=this.__dirtyText=!0,this._rect=null,this.__zr&&this.__zr.refresh();},animateStyle:function animateStyle(t){return this.animate("style",t);},attrKV:function attrKV(t,e){"style"!==t?pi.prototype.attrKV.call(this,t,e):this.style.set(e);},setStyle:function setStyle(t,e){return this.style.set(t,e),this.dirty(!1),this;},useStyle:function useStyle(t){return this.style=new Vi(t,this),this.dirty(!1),this;},calculateTextPosition:null},w(Xn,pi),b(Xn,Zn),Yn.prototype={constructor:Yn,type:"image",brush:function brush(t,e){var i=this.style,n=i.image;i.bind(t,this,e);var a=this._image=Ji(n,this._image,this,this.onload);if(a&&tn(a)){var o=i.x||0,r=i.y||0,s=i.width,l=i.height,u=a.width/a.height;if(null==s&&null!=l?s=l*u:null==l&&null!=s?l=s/u:null==s&&null==l&&(s=a.width,l=a.height),this.setTransform(t),i.sWidth&&i.sHeight){var h=i.sx||0,c=i.sy||0;t.drawImage(a,h,c,i.sWidth,i.sHeight,o,r,s,l);}else if(i.sx&&i.sy){var d=s-(h=i.sx),f=l-(c=i.sy);t.drawImage(a,h,c,d,f,o,r,s,l);}else t.drawImage(a,o,r,s,l);null!=i.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect()));}},getBoundingRect:function getBoundingRect(){var t=this.style;return this._rect||(this._rect=new bi(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect;}},w(Yn,Xn);var jn=314159;function qn(t){return parseInt(t,10);}var Kn=new bi(0,0,0,0),$n=new bi(0,0,0,0);function Jn(t,e,i){this.type="canvas";var n=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=L({},i||{}),this.dpr=i.devicePixelRatio||li,this._singleCanvas=n;var a=(this.root=t).style;a&&(a["-webkit-tap-highlight-color"]="transparent",a["-webkit-user-select"]=a["user-select"]=a["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],r=this._layers={};if(this._layerConfig={},this._needsManuallyCompositing=!1,n){var s=t.width,l=t.height;null!=i.width&&(s=i.width),null!=i.height&&(l=i.height),this.dpr=i.devicePixelRatio||1,t.width=s*this.dpr,t.height=l*this.dpr,this._width=s,this._height=l;var u=new ji(t,this,this.dpr);u.__builtin__=!0,u.initContext(),(r[jn]=u).zlevel=jn,o.push(jn),this._domRoot=t;}else{this._width=this._getSize(0),this._height=this._getSize(1);var h=this._domRoot=function(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",i;}(this._width,this._height);t.appendChild(h);}this._hoverlayer=null,this._hoverElements=[];}Jn.prototype={constructor:Jn,getType:function getType(){return"canvas";},isSingleCanvas:function isSingleCanvas(){return this._singleCanvas;},getViewportRoot:function getViewportRoot(){return this._domRoot;},getViewportRootOffset:function getViewportRootOffset(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0};},refresh:function refresh(t){var e=this.storage.getDisplayList(!0),i=this._zlevelList;this._redrawId=Math.random(),this._paintList(e,t,this._redrawId);for(var n=0;n<i.length;n++){var a=i[n],o=this._layers[a];if(!o.__builtin__&&o.refresh){var r=0===n?this._backgroundColor:null;o.refresh(r);}}return this.refreshHover(),this;},addHover:function addHover(t,e){if(!t.__hoverMir){var i=new t.constructor({style:t.style,shape:t.shape,z:t.z,z2:t.z2,silent:t.silent});return(i.__from=t).__hoverMir=i,e&&i.setStyle(e),this._hoverElements.push(i),i;}},removeHover:function removeHover(t){var e=t.__hoverMir,i=this._hoverElements,n=_(i,e);0<=n&&i.splice(n,1),t.__hoverMir=null;},clearHover:function clearHover(t){for(var e=this._hoverElements,i=0;i<e.length;i++){var n=e[i].__from;n&&(n.__hoverMir=null);}e.length=0;},refreshHover:function refreshHover(){var t=this._hoverElements,e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){ki(t,this.storage.displayableSortFunc);var n={};(i=i||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var a=0;a<e;){var o=t[a],r=o.__from;r&&r.__zr?(a++,r.invisible||(o.transform=r.transform,o.invTransform=r.invTransform,o.__clipPaths=r.__clipPaths,this._doPaintEl(o,i,!0,n))):(t.splice(a,1),r.__hoverMir=null,e--);}i.ctx.restore();}},getHoverLayer:function getHoverLayer(){return this.getLayer(1e5);},_paintList:function _paintList(t,e,i){if(this._redrawId===i){e=e||!1,this._updateLayerStatus(t);var n=this._doPaintList(t,e);if(this._needsManuallyCompositing&&this._compositeManually(),!n){var a=this;qi(function(){a._paintList(t,e,i);});}}},_compositeManually:function _compositeManually(){var e=this.getLayer(jn).ctx,i=this._domRoot.width,n=this._domRoot.height;e.clearRect(0,0,i,n),this.eachBuiltinLayer(function(t){t.virtual&&e.drawImage(t.dom,0,0,i,n);});},_doPaintList:function _doPaintList(t,e){for(var i=[],n=0;n<this._zlevelList.length;n++){var a=this._zlevelList[n];(s=this._layers[a]).__builtin__&&s!==this._hoverlayer&&(s.__dirty||e)&&i.push(s);}for(var o=!0,r=0;r<i.length;r++){var s,l=(s=i[r]).ctx,u={};l.save();var h=e?s.__startIndex:s.__drawIndex,c=!e&&s.incremental&&Date.now,d=c&&Date.now(),f=s.zlevel===this._zlevelList[0]?this._backgroundColor:null;if(s.__startIndex===s.__endIndex)s.clear(!1,f);else if(h===s.__startIndex){var p=t[h];p.incremental&&p.notClear&&!e||s.clear(!1,f);}-1===h&&(console.error("For some unknown reason. drawIndex is -1"),h=s.__startIndex);for(var g=h;g<s.__endIndex;g++){var m=t[g];if(this._doPaintEl(m,s,e,u),m.__dirty=m.__dirtyText=!1,c)if(15<Date.now()-d)break;}s.__drawIndex=g,s.__drawIndex<s.__endIndex&&(o=!1),u.prevElClipPaths&&l.restore(),l.restore();}return v.wxa&&E(this._layers,function(t){t&&t.ctx&&t.ctx.draw&&t.ctx.draw();}),o;},_doPaintEl:function _doPaintEl(t,e,i,n){var a=e.ctx,o=t.transform;if((e.__dirty||i)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!function(t,e,i){return Kn.copy(t.getBoundingRect()),t.transform&&Kn.applyTransform(t.transform),$n.width=e,$n.height=i,!Kn.intersect($n);}(t,this._width,this._height))){var r=t.__clipPaths,s=n.prevElClipPaths;s&&!function(t,e){if(t===e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++){if(t[i]!==e[i])return!0;}return!1;}(r,s)||(s&&(a.restore(),n.prevElClipPaths=null,n.prevEl=null),r&&(a.save(),function(t,e){for(var i=0;i<t.length;i++){var n=t[i];n.setTransform(e),e.beginPath(),n.buildPath(e,n.shape),e.clip(),n.restoreTransform(e);}}(r,a),n.prevElClipPaths=r)),t.beforeBrush&&t.beforeBrush(a),t.brush(a,n.prevEl||null),(n.prevEl=t).afterBrush&&t.afterBrush(a);}},getLayer:function getLayer(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=jn);var i=this._layers[t];return i||((i=new ji("zr_"+t,this,this.dpr)).zlevel=t,i.__builtin__=!0,this._layerConfig[t]&&m(i,this._layerConfig[t],!0),e&&(i.virtual=e),this.insertLayer(t,i),i.initContext()),i;},insertLayer:function insertLayer(t,e){var i=this._layers,n=this._zlevelList,a=n.length,o=null,r=-1,s=this._domRoot;if(i[t])ci("ZLevel "+t+" has been used already");else if(function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh);}(e)){if(0<a&&t>n[0]){for(r=0;r<a-1&&!(n[r]<t&&n[r+1]>t);r++){;}o=i[n[r]];}if(n.splice(r+1,0,t),!(i[t]=e).virtual)if(o){var l=o.dom;l.nextSibling?s.insertBefore(e.dom,l.nextSibling):s.appendChild(e.dom);}else s.firstChild?s.insertBefore(e.dom,s.firstChild):s.appendChild(e.dom);}else ci("Layer of zlevel "+t+" is not valid");},eachLayer:function eachLayer(t,e){var i,n,a=this._zlevelList;for(n=0;n<a.length;n++){i=a[n],t.call(e,this._layers[i],i);}},eachBuiltinLayer:function eachBuiltinLayer(t,e){var i,n,a,o=this._zlevelList;for(a=0;a<o.length;a++){n=o[a],(i=this._layers[n]).__builtin__&&t.call(e,i,n);}},eachOtherLayer:function eachOtherLayer(t,e){var i,n,a,o=this._zlevelList;for(a=0;a<o.length;a++){n=o[a],(i=this._layers[n]).__builtin__||t.call(e,i,n);}},getLayers:function getLayers(){return this._layers;},_updateLayerStatus:function _updateLayerStatus(t){function e(t){n&&(n.__endIndex!==t&&(n.__dirty=!0),n.__endIndex=t);}if(this.eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1;}),this._singleCanvas)for(var i=1;i<t.length;i++){if((o=t[i]).zlevel!==t[i-1].zlevel||o.incremental){this._needsManuallyCompositing=!0;break;}}var n=null,a=0;for(i=0;i<t.length;i++){var o,r,s=(o=t[i]).zlevel;o.incremental?((r=this.getLayer(s+.001,this._needsManuallyCompositing)).incremental=!0,a=1):r=this.getLayer(s+(0<a?.01:0),this._needsManuallyCompositing),r.__builtin__||ci("ZLevel "+s+" has been used by unkown layer "+r.id),r!==n&&(r.__used=!0,r.__startIndex!==i&&(r.__dirty=!0),r.__startIndex=i,r.incremental?r.__drawIndex=-1:r.__drawIndex=i,e(i),n=r),o.__dirty&&(r.__dirty=!0,r.incremental&&r.__drawIndex<0&&(r.__drawIndex=i));}e(i),this.eachBuiltinLayer(function(t,e){!t.__used&&0<t.getElementCount()&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex);});},clear:function clear(){return this.eachBuiltinLayer(this._clearLayer),this;},_clearLayer:function _clearLayer(t){t.clear();},setBackgroundColor:function setBackgroundColor(t){this._backgroundColor=t;},configLayer:function configLayer(t,e){if(e){var i=this._layerConfig;i[t]?m(i[t],e,!0):i[t]=e;for(var n=0;n<this._zlevelList.length;n++){var a=this._zlevelList[n];if(a===t||a===t+.01)m(this._layers[a],i[t],!0);}}},delLayer:function delLayer(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(_(i,t),1));},resize:function resize(e,i){if(this._domRoot.style){var t=this._domRoot;t.style.display="none";var n=this._opts;if(null!=e&&(n.width=e),null!=i&&(n.height=i),e=this._getSize(0),i=this._getSize(1),t.style.display="",this._width!==e||i!==this._height){for(var a in t.style.width=e+"px",t.style.height=i+"px",this._layers){this._layers.hasOwnProperty(a)&&this._layers[a].resize(e,i);}E(this._progressiveLayers,function(t){t.resize(e,i);}),this.refresh(!0);}this._width=e,this._height=i;}else{if(null==e||null==i)return;this._width=e,this._height=i,this.getLayer(jn).resize(e,i);}return this;},clearLayer:function clearLayer(t){var e=this._layers[t];e&&e.clear();},dispose:function dispose(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null;},getRenderedCanvas:function getRenderedCanvas(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[jn].dom;var e=new ji("image",this,t.pixelRatio||this.dpr);if(e.initContext(),e.clear(!1,t.backgroundColor||this._backgroundColor),t.pixelRatio<=this.dpr){this.refresh();var i=e.dom.width,n=e.dom.height,a=e.ctx;this.eachLayer(function(t){t.__builtin__?a.drawImage(t.dom,0,0,i,n):t.renderToCanvas&&(e.ctx.save(),t.renderToCanvas(e.ctx),e.ctx.restore());});}else for(var o={},r=this.storage.getDisplayList(!0),s=0;s<r.length;s++){var l=r[s];this._doPaintEl(l,e,!0,o);}return e.dom;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},_getSize:function _getSize(t){var e=this._opts,i=["width","height"][t],n=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var r=this.root,s=document.defaultView.getComputedStyle(r);return(r[n]||qn(s[i])||qn(r.style[i]))-(qn(s[a])||0)-(qn(s[o])||0)|0;},pathToImage:function pathToImage(t,e){e=e||this.dpr;var i=document.createElement("canvas"),n=i.getContext("2d"),a=t.getBoundingRect(),o=t.style,r=o.shadowBlur*e,s=o.shadowOffsetX*e,l=o.shadowOffsetY*e,u=o.hasStroke()?o.lineWidth:0,h=Math.max(u/2,r-s),c=Math.max(u/2,s+r),d=Math.max(u/2,r-l),f=Math.max(u/2,l+r),p=a.width+h+c,g=a.height+d+f;i.width=p*e,i.height=g*e,n.scale(e,e),n.clearRect(0,0,p,g),n.dpr=e;var m={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[h-a.x,d-a.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(n);var v=new Yn({style:{x:0,y:0,image:i}});return null!=m.position&&(v.position=t.position=m.position),null!=m.rotation&&(v.rotation=t.rotation=m.rotation),null!=m.scale&&(v.scale=t.scale=m.scale),v;}};function Qn(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,Ct.call(this);}Qn.prototype={constructor:Qn,addClip:function addClip(t){this._clips.push(t);},addAnimator:function addAnimator(t){t.animation=this;for(var e=t.getClips(),i=0;i<e.length;i++){this.addClip(e[i]);}},removeClip:function removeClip(t){var e=_(this._clips,t);0<=e&&this._clips.splice(e,1);},removeAnimator:function removeAnimator(t){for(var e=t.getClips(),i=0;i<e.length;i++){this.removeClip(e[i]);}t.animation=null;},_update:function _update(){for(var t=new Date().getTime()-this._pausedTime,e=t-this._time,i=this._clips,n=i.length,a=[],o=[],r=0;r<n;r++){var s=i[r],l=s.step(t,e);l&&(a.push(l),o.push(s));}for(r=0;r<n;){i[r]._needsRemove?(i[r]=i[n-1],i.pop(),n--):r++;}n=a.length;for(r=0;r<n;r++){o[r].fire(a[r]);}this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update();},_startLoop:function _startLoop(){var e=this;this._running=!0,qi(function t(){e._running&&(qi(t),e._paused||e._update());});},start:function start(){this._time=new Date().getTime(),this._pausedTime=0,this._startLoop();},stop:function stop(){this._running=!1;},pause:function pause(){this._paused||(this._pauseStart=new Date().getTime(),this._paused=!0);},resume:function resume(){this._paused&&(this._pausedTime+=new Date().getTime()-this._pauseStart,this._paused=!1);},clear:function clear(){this._clips=[];},isFinished:function isFinished(){return!this._clips.length;},animate:function animate(t,e){var i=new ri(t,(e=e||{}).loop,e.getter,e.setter);return this.addAnimator(i),i;}},b(Qn,Ct);var ta=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],ea=["touchstart","touchend","touchmove"],ia={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},na=N(ta,function(t){var e=t.replace("mouse","pointer");return ia[e]?e:t;});function aa(t){return"mousewheel"===t&&v.browser.firefox?"DOMMouseScroll":t;}function oa(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1;},700);}var ra={mousemove:function mousemove(t){t=Vt(this.dom,t),this.trigger("mousemove",t);},mouseout:function mouseout(t){var e=(t=Vt(this.dom,t)).toElement||t.relatedTarget;if(e!==this.dom)for(;e&&9!==e.nodeType;){if(e===this.dom)return;e=e.parentNode;}this.trigger("mouseout",t);},touchstart:function touchstart(t){(t=Vt(this.dom,t)).zrByTouch=!0,this._lastTouchMoment=new Date(),this.handler.processGesture(t,"start"),ra.mousemove.call(this,t),ra.mousedown.call(this,t),oa(this);},touchmove:function touchmove(t){(t=Vt(this.dom,t)).zrByTouch=!0,this.handler.processGesture(t,"change"),ra.mousemove.call(this,t),oa(this);},touchend:function touchend(t){(t=Vt(this.dom,t)).zrByTouch=!0,this.handler.processGesture(t,"end"),ra.mouseup.call(this,t),+new Date()-this._lastTouchMoment<300&&ra.click.call(this,t),oa(this);},pointerdown:function pointerdown(t){ra.mousedown.call(this,t);},pointermove:function pointermove(t){sa(t)||ra.mousemove.call(this,t);},pointerup:function pointerup(t){ra.mouseup.call(this,t);},pointerout:function pointerout(t){sa(t)||ra.mouseout.call(this,t);}};function sa(t){var e=t.pointerType;return"pen"===e||"touch"===e;}function la(i){function t(t,e){E(t,function(t){Gt(i,aa(t),e._handlers[t]);},e);}Ct.call(this),this.dom=i,this._touching=!1,this._touchTimer,this._handlers={},function(e){E(ea,function(t){e._handlers[t]=T(ra[t],e);}),E(na,function(t){e._handlers[t]=T(ra[t],e);}),E(ta,function(t){e._handlers[t]=function(t,e){return function(){if(!e._touching)return t.apply(e,arguments);};}(ra[t],e);});}(this),v.pointerEventsSupported?t(na,this):(v.touchEventsSupported&&t(ea,this),t(ta,this));}E(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){ra[e]=function(t){t=Vt(this.dom,t),this.trigger(e,t);};});var ua=la.prototype;ua.dispose=function(){for(var t,e,i,n=ta.concat(ea),a=0;a<n.length;a++){var o=n[a];t=this.dom,e=aa(o),i=this._handlers[o],Nt?t.removeEventListener(e,i):t.detachEvent("on"+e,i);}},ua.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default");},b(la,Ct);var ha=!v.canvasSupported,ca={canvas:Jn},da={};function fa(t,e){var i=new ga(n(),t,e);return da[i.id]=i;}function pa(t,e){ca[t]=e;}var ga=function ga(t,e,i){i=i||{},this.dom=e,this.id=t;var n=this,a=new Ni(),o=i.renderer;if(ha){if(!ca.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");o="vml";}else o&&ca[o]||(o="canvas");var r=new ca[o](e,a,i,t);this.storage=a,this.painter=r;var s=v.node||v.worker?null:new la(r.getViewportRoot());this.handler=new qt(a,r,s,r.root),this.animation=new Qn({stage:{update:T(this.flush,this)}}),this.animation.start(),this._needsRefresh;var l=a.delFromStorage,u=a.addToStorage;a.delFromStorage=function(t){l.call(a,t),t&&t.removeSelfFromZr(n);},a.addToStorage=function(t){u.call(a,t),t.addSelfToZr(n);};};ga.prototype={constructor:ga,getId:function getId(){return this.id;},add:function add(t){this.storage.addRoot(t),this._needsRefresh=!0;},remove:function remove(t){this.storage.delRoot(t),this._needsRefresh=!0;},configLayer:function configLayer(t,e){this.painter.configLayer&&this.painter.configLayer(t,e),this._needsRefresh=!0;},setBackgroundColor:function setBackgroundColor(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this._needsRefresh=!0;},refreshImmediately:function refreshImmediately(){this._needsRefresh=this._needsRefreshHover=!1,this.painter.refresh(),this._needsRefresh=this._needsRefreshHover=!1;},refresh:function refresh(){this._needsRefresh=!0;},flush:function flush(){var t;this._needsRefresh&&(t=!0,this.refreshImmediately()),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately()),t&&this.trigger("rendered");},addHover:function addHover(t,e){if(this.painter.addHover){var i=this.painter.addHover(t,e);return this.refreshHover(),i;}},removeHover:function removeHover(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover());},clearHover:function clearHover(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover());},refreshHover:function refreshHover(){this._needsRefreshHover=!0;},refreshHoverImmediately:function refreshHoverImmediately(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover();},resize:function resize(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize();},clearAnimation:function clearAnimation(){this.animation.clear();},getWidth:function getWidth(){return this.painter.getWidth();},getHeight:function getHeight(){return this.painter.getHeight();},pathToImage:function pathToImage(t,e){return this.painter.pathToImage(t,e);},setCursorStyle:function setCursorStyle(t){this.handler.setCursorStyle(t);},findHover:function findHover(t,e){return this.handler.findHover(t,e);},on:function on(t,e,i){this.handler.on(t,e,i);},off:function off(t,e){this.handler.off(t,e);},trigger:function trigger(t,e){this.handler.trigger(t,e);},clear:function clear(){this.storage.delRoot(),this.painter.clear();},dispose:function dispose(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,function(t){delete da[t];}(this.id);}};var ma=(Object.freeze||Object)({version:"4.1.2",init:fa,dispose:function dispose(t){if(t)t.dispose();else{for(var e in da){da.hasOwnProperty(e)&&da[e].dispose();}da={};}return this;},getInstance:function getInstance(t){return da[t];},registerPainter:pa}),va=E,ya=z,xa=k,_a="series\0";function wa(t){return t instanceof Array?t:null==t?[]:[t];}function ba(t,e,i){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var n=0,a=i.length;n<a;n++){var o=i[n];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o]);}}}var Sa=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Ma(t){return!ya(t)||xa(t)||t instanceof Date?t:t.value;}function Ia(t,a){a=(a||[]).slice();var o=N(t||[],function(t,e){return{exist:t};});return va(a,function(t,e){if(ya(t)){for(var i=0;i<o.length;i++){if(!o[i].option&&null!=t.id&&o[i].exist.id===t.id+"")return o[i].option=t,void(a[e]=null);}for(i=0;i<o.length;i++){var n=o[i].exist;if(!(o[i].option||null!=n.id&&null!=t.id||null==t.name||Da(t)||Da(n)||n.name!==t.name+""))return o[i].option=t,void(a[e]=null);}}}),va(a,function(t,e){if(ya(t)){for(var i=0;i<o.length;i++){var n=o[i].exist;if(!o[i].option&&!Da(n)&&null==t.id){o[i].option=t;break;}}i>=o.length&&o.push({option:t});}}),o;}function Aa(t){var r=Q();va(t,function(t,e){var i=t.exist;i&&r.set(i.id,t);}),va(t,function(t,e){var i=t.option;Y(!i||null==i.id||!r.get(i.id)||r.get(i.id)===t,"id duplicates: "+(i&&i.id)),i&&null!=i.id&&r.set(i.id,t),t.keyInfo||(t.keyInfo={});}),va(t,function(t,e){var i=t.exist,n=t.option,a=t.keyInfo;if(ya(n)){if(a.name=null!=n.name?n.name+"":i?i.name:_a+e,i)a.id=i.id;else if(null!=n.id)a.id=n.id+"";else for(var o=0;a.id="\0"+a.name+"\0"+o++,r.get(a.id);){;}r.set(a.id,t);}});}function Ta(t){var e=t.name;return!(!e||!e.indexOf(_a));}function Da(t){return ya(t)&&t.id&&0===(t.id+"").indexOf("\0_ec_\0");}function Ca(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?k(t.dataIndex)?N(t.dataIndex,function(t){return e.indexOfRawIndex(t);}):e.indexOfRawIndex(t.dataIndex):null!=t.name?k(t.name)?N(t.name,function(t){return e.indexOfName(t);}):e.indexOfName(t.name):void 0;}function La(){var e="__\0ec_inner_"+ka++ +"_"+Math.random().toFixed(5);return function(t){return t[e]||(t[e]={});};}var ka=0;function Pa(s,l,u){if(R(l)){var t={};t[l+"Index"]=0,l=t;}var e=u&&u.defaultMainType;!e||Na(l,e+"Index")||Na(l,e+"Id")||Na(l,e+"Name")||(l[e+"Index"]=0);var h={};return va(l,function(t,e){t=l[e];if("dataIndex"!==e&&"dataIndexInside"!==e){var i=e.match(/^(\w+)(Index|Id|Name)$/)||[],n=i[1],a=(i[2]||"").toLowerCase();if(!(!n||!a||null==t||"index"===a&&"none"===t||u&&u.includeMainTypes&&_(u.includeMainTypes,n)<0)){var o={mainType:n};"index"===a&&"all"===t||(o[a]=t);var r=s.queryComponents(o);h[n+"Models"]=r,h[n+"Model"]=r[0];}}else h[e]=t;}),h;}function Na(t,e){return t&&t.hasOwnProperty(e);}function Oa(t,e,i){t.setAttribute?t.setAttribute(e,i):t[e]=i;}function Ea(t){return"auto"===t?v.domSupported?"html":"richText":t||"html";}function Ra(t,i){var n=Q(),a=[];return E(t,function(t){var e=i(t);(n.get(e)||(a.push(e),n.set(e,[]))).push(t);}),{keys:a,buckets:n};}var za=".",Ba="___EC__COMPONENT__CONTAINER___";function Va(t){var e={main:"",sub:""};return t&&(t=t.split(za),e.main=t[0]||"",e.sub=t[1]||""),e;}function Ga(t){(t.$constructor=t).extend=function(t){function e(){t.$constructor?t.$constructor.apply(this,arguments):i.apply(this,arguments);}var i=this;return L(e.prototype,t),e.extend=this.extend,e.superCall=Ha,e.superApply=Za,w(e,this),e.superClass=i,e;};}var Fa=0;function Wa(t){var e=["__\0is_clz",Fa++,Math.random().toFixed(3)].join("_");t.prototype[e]=!0,t.isInstance=function(t){return!(!t||!t[e]);};}function Ha(t,e){var i=U(arguments,2);return this.superClass.prototype[e].apply(t,i);}function Za(t,e,i){return this.superClass.prototype[e].apply(t,i);}function Ua(i,t){t=t||{};var a={};if(i.registerClass=function(t,e){if(e)if(function(t){Y(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(t),'componentType "'+t+'" illegal');}(e),(e=Va(e)).sub){if(e.sub!==Ba){(function(t){var e=a[t.main];e&&e[Ba]||((e=a[t.main]={})[Ba]=!0);return e;})(e)[e.sub]=t;}}else a[e.main]=t;return t;},i.getClass=function(t,e,i){var n=a[t];if(n&&n[Ba]&&(n=e?n[e]:null),i&&!n)throw new Error(e?"Component "+t+"."+(e||"")+" not exists. Load it first.":t+".type should be specified.");return n;},i.getClassesByMainType=function(t){t=Va(t);var i=[],e=a[t.main];return e&&e[Ba]?E(e,function(t,e){e!==Ba&&i.push(t);}):i.push(e),i;},i.hasClass=function(t){return t=Va(t),!!a[t.main];},i.getAllClassMainTypes=function(){var i=[];return E(a,function(t,e){i.push(e);}),i;},i.hasSubTypes=function(t){t=Va(t);var e=a[t.main];return e&&e[Ba];},i.parseClassType=Va,t.registerWhenExtend){var n=i.extend;n&&(i.extend=function(t){var e=n.call(this,t);return i.registerClass(e,t.type);});}return i;}function Xa(s){for(var t=0;t<s.length;t++){s[t][1]||(s[t][1]=s[t][0]);}return function(t,e,i){for(var n={},a=0;a<s.length;a++){var o=s[a][1];if(!(e&&0<=_(e,o)||i&&_(i,o)<0)){var r=t.getShallow(o);null!=r&&(n[s[a][0]]=r);}}return n;};}var Ya=Xa([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),ja={getLineStyle:function getLineStyle(t){var e=Ya(this,t);return e.lineDash=this.getLineDash(e.lineWidth),e;},getLineDash:function getLineDash(t){null==t&&(t=1);var e=this.get("type"),i=Math.max(t,2),n=4*t;return"solid"!==e&&null!=e&&("dashed"===e?[n,n]:[i,i]);}},qa=Xa([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),Ka={getAreaStyle:function getAreaStyle(t,e){return qa(this,t,e);}},$a=Math.pow,Ja=Math.sqrt,Qa=1e-8,to=1e-4,eo=Ja(3),io=1/3,no=at(),ao=at(),oo=at();function ro(t){return-Qa<t&&t<Qa;}function so(t){return Qa<t||t<-Qa;}function lo(t,e,i,n,a){var o=1-a;return o*o*(o*t+3*a*e)+a*a*(a*n+3*o*i);}function uo(t,e,i,n,a){var o=1-a;return 3*(((e-t)*o+2*(i-e)*a)*o+(n-i)*a*a);}function ho(t,e,i,n,a){var o=6*i-12*e+6*t,r=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(ro(r)){if(so(o))0<=(h=-s/o)&&h<=1&&(a[l++]=h);}else{var u=o*o-4*r*s;if(ro(u))a[0]=-o/(2*r);else if(0<u){var h,c=Ja(u),d=(-o-c)/(2*r);0<=(h=(-o+c)/(2*r))&&h<=1&&(a[l++]=h),0<=d&&d<=1&&(a[l++]=d);}}return l;}function co(t,e,i,n,a,o){var r=(e-t)*a+t,s=(i-e)*a+e,l=(n-i)*a+i,u=(s-r)*a+r,h=(l-s)*a+s,c=(h-u)*a+u;o[0]=t,o[1]=r,o[2]=u,o[3]=c,o[4]=c,o[5]=h,o[6]=l,o[7]=n;}function fo(t,e,i,n){var a=1-n;return a*(a*t+2*n*e)+n*n*i;}function po(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e));}function go(t,e,i){var n=t+i-2*e;return 0==n?.5:(t-e)/n;}function mo(t,e,i,n,a){var o=(e-t)*n+t,r=(i-e)*n+e,s=(r-o)*n+o;a[0]=t,a[1]=o,a[2]=s,a[3]=s,a[4]=r,a[5]=i;}var vo=Math.min,yo=Math.max,xo=Math.sin,_o=Math.cos,wo=2*Math.PI,bo=at(),So=at(),Mo=at();function Io(t,e,i){if(0!==t.length){var n,a=t[0],o=a[0],r=a[0],s=a[1],l=a[1];for(n=1;n<t.length;n++){a=t[n],o=vo(o,a[0]),r=yo(r,a[0]),s=vo(s,a[1]),l=yo(l,a[1]);}e[0]=o,e[1]=s,i[0]=r,i[1]=l;}}function Ao(t,e,i,n,a,o){a[0]=vo(t,i),a[1]=vo(e,n),o[0]=yo(t,i),o[1]=yo(e,n);}var To=[],Do=[];function Co(t,e,i,n,a,o,r,s,l,u){var h,c=ho,d=lo,f=c(t,i,a,r,To);for(l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0,h=0;h<f;h++){var p=d(t,i,a,r,To[h]);l[0]=vo(p,l[0]),u[0]=yo(p,u[0]);}for(f=c(e,n,o,s,Do),h=0;h<f;h++){var g=d(e,n,o,s,Do[h]);l[1]=vo(g,l[1]),u[1]=yo(g,u[1]);}l[0]=vo(t,l[0]),u[0]=yo(t,u[0]),l[0]=vo(r,l[0]),u[0]=yo(r,u[0]),l[1]=vo(e,l[1]),u[1]=yo(e,u[1]),l[1]=vo(s,l[1]),u[1]=yo(s,u[1]);}function Lo(t,e,i,n,a,o,r,s,l){var u=St,h=Mt,c=Math.abs(a-o);if(c%wo<1e-4&&1e-4<c)return s[0]=t-i,s[1]=e-n,l[0]=t+i,void(l[1]=e+n);if(bo[0]=_o(a)*i+t,bo[1]=xo(a)*n+e,So[0]=_o(o)*i+t,So[1]=xo(o)*n+e,u(s,bo,So),h(l,bo,So),(a%=wo)<0&&(a+=wo),(o%=wo)<0&&(o+=wo),o<a&&!r?o+=wo:a<o&&r&&(a+=wo),r){var d=o;o=a,a=d;}for(var f=0;f<o;f+=Math.PI/2){a<f&&(Mo[0]=_o(f)*i+t,Mo[1]=xo(f)*n+e,u(s,Mo,s),h(l,Mo,l));}}var ko={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Po=[],No=[],Oo=[],Eo=[],Ro=Math.min,zo=Math.max,Bo=Math.cos,Vo=Math.sin,Go=Math.sqrt,Fo=Math.abs,Wo="undefined"!=typeof Float32Array,Ho=function Ho(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null;};function Zo(t,e,i,n,a,o,r){if(0===a)return!1;var s=a,l=0;if(e+s<r&&n+s<r||r<e-s&&r<n-s||t+s<o&&i+s<o||o<t-s&&o<i-s)return!1;if(t===i)return Math.abs(o-t)<=s/2;var u=(l=(e-n)/(t-i))*o-r+(t*n-i*e)/(t-i);return u*u/(l*l+1)<=s/2*s/2;}function Uo(t,e,i,n,a,o,r,s,l,u,h){if(0===l)return!1;var c=l;return!(e+c<h&&n+c<h&&o+c<h&&s+c<h||h<e-c&&h<n-c&&h<o-c&&h<s-c||t+c<u&&i+c<u&&a+c<u&&r+c<u||u<t-c&&u<i-c&&u<a-c&&u<r-c)&&function(t,e,i,n,a,o,r,s,l,u,h){var c,d,f,p,g,m=.005,v=1/0;no[0]=l,no[1]=u;for(var y=0;y<1;y+=.05){ao[0]=lo(t,i,a,r,y),ao[1]=lo(e,n,o,s,y),(p=_t(no,ao))<v&&(c=y,v=p);}v=1/0;for(var x=0;x<32&&!(m<to);x++){d=c-m,f=c+m,ao[0]=lo(t,i,a,r,d),ao[1]=lo(e,n,o,s,d),p=_t(ao,no),0<=d&&p<v?(c=d,v=p):(oo[0]=lo(t,i,a,r,f),oo[1]=lo(e,n,o,s,f),g=_t(oo,no),f<=1&&g<v?(c=f,v=g):m*=.5);}return h&&(h[0]=lo(t,i,a,r,c),h[1]=lo(e,n,o,s,c)),Ja(v);}(t,e,i,n,a,o,r,s,u,h,null)<=c/2;}function Xo(t,e,i,n,a,o,r,s,l){if(0===r)return!1;var u=r;return!(e+u<l&&n+u<l&&o+u<l||l<e-u&&l<n-u&&l<o-u||t+u<s&&i+u<s&&a+u<s||s<t-u&&s<i-u&&s<a-u)&&function(t,e,i,n,a,o,r,s,l){var u,h=.005,c=1/0;no[0]=r,no[1]=s;for(var d=0;d<1;d+=.05){ao[0]=fo(t,i,a,d),ao[1]=fo(e,n,o,d),(m=_t(no,ao))<c&&(u=d,c=m);}c=1/0;for(var f=0;f<32&&!(h<to);f++){var p=u-h,g=u+h;ao[0]=fo(t,i,a,p),ao[1]=fo(e,n,o,p);var m=_t(ao,no);if(0<=p&&m<c)u=p,c=m;else{oo[0]=fo(t,i,a,g),oo[1]=fo(e,n,o,g);var v=_t(oo,no);g<=1&&v<c?(u=g,c=v):h*=.5;}}return l&&(l[0]=fo(t,i,a,u),l[1]=fo(e,n,o,u)),Ja(c);}(t,e,i,n,a,o,s,l,null)<=u/2;}Ho.prototype={constructor:Ho,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function setScale(t,e,i){i=i||0,this._ux=Fo(i/li/t)||0,this._uy=Fo(i/li/e)||0;},getContext:function getContext(){return this._ctx;},beginPath:function beginPath(t){return(this._ctx=t)&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this;},moveTo:function moveTo(t,e){return this.addData(ko.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this;},lineTo:function lineTo(t,e){var i=Fo(t-this._xi)>this._ux||Fo(e-this._yi)>this._uy||this._len<5;return this.addData(ko.L,t,e),this._ctx&&i&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),i&&(this._xi=t,this._yi=e),this;},bezierCurveTo:function bezierCurveTo(t,e,i,n,a,o){return this.addData(ko.C,t,e,i,n,a,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,a,o):this._ctx.bezierCurveTo(t,e,i,n,a,o)),this._xi=a,this._yi=o,this;},quadraticCurveTo:function quadraticCurveTo(t,e,i,n){return this.addData(ko.Q,t,e,i,n),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this;},arc:function arc(t,e,i,n,a,o){return this.addData(ko.A,t,e,i,i,n,a-n,0,o?0:1),this._ctx&&this._ctx.arc(t,e,i,n,a,o),this._xi=Bo(a)*i+t,this._yi=Vo(a)*i+e,this;},arcTo:function arcTo(t,e,i,n,a){return this._ctx&&this._ctx.arcTo(t,e,i,n,a),this;},rect:function rect(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this.addData(ko.R,t,e,i,n),this;},closePath:function closePath(){this.addData(ko.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this;},fill:function fill(t){t&&t.fill(),this.toStatic();},stroke:function stroke(t){t&&t.stroke(),this.toStatic();},setLineDash:function setLineDash(t){if(t instanceof Array){this._lineDash=t;for(var e=this._dashIdx=0,i=0;i<t.length;i++){e+=t[i];}this._dashSum=e;}return this;},setLineDashOffset:function setLineDashOffset(t){return this._dashOffset=t,this;},len:function len(){return this._len;},setData:function setData(t){var e=t.length;this.data&&this.data.length===e||!Wo||(this.data=new Float32Array(e));for(var i=0;i<e;i++){this.data[i]=t[i];}this._len=e;},appendPath:function appendPath(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,a=0;a<e;a++){i+=t[a].len();}Wo&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i));for(a=0;a<e;a++){for(var o=t[a].data,r=0;r<o.length;r++){this.data[n++]=o[r];}}this._len=n;},addData:function addData(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++){e[this._len++]=arguments[i];}this._prevCmd=t;}},_expandData:function _expandData(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++){t[e]=this.data[e];}this.data=t;}},_needsDash:function _needsDash(){return this._lineDash;},_dashedLineTo:function _dashedLineTo(t,e){var i,n,a=this._dashSum,o=this._dashOffset,r=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,h=t-l,c=e-u,d=Go(h*h+c*c),f=l,p=u,g=r.length;for(o<0&&(o=a+o),f-=(o%=a)*(h/=d),p-=o*(c/=d);0<h&&f<=t||h<0&&t<=f||0===h&&(0<c&&p<=e||c<0&&e<=p);){f+=h*(i=r[n=this._dashIdx]),p+=c*i,this._dashIdx=(n+1)%g,0<h&&f<l||h<0&&l<f||0<c&&p<u||c<0&&u<p||s[n%2?"moveTo":"lineTo"](0<=h?Ro(f,t):zo(f,t),0<=c?Ro(p,e):zo(p,e));}h=f-t,c=p-e,this._dashOffset=-Go(h*h+c*c);},_dashedBezierTo:function _dashedBezierTo(t,e,i,n,a,o){var r,s,l,u,h,c=this._dashSum,d=this._dashOffset,f=this._lineDash,p=this._ctx,g=this._xi,m=this._yi,v=lo,y=0,x=this._dashIdx,_=f.length,w=0;for(d<0&&(d=c+d),d%=c,r=0;r<1;r+=.1){s=v(g,t,i,a,r+.1)-v(g,t,i,a,r),l=v(m,e,n,o,r+.1)-v(m,e,n,o,r),y+=Go(s*s+l*l);}for(;x<_&&!(d<(w+=f[x]));x++){;}for(r=(w-d)/y;r<=1;){u=v(g,t,i,a,r),h=v(m,e,n,o,r),x%2?p.moveTo(u,h):p.lineTo(u,h),r+=f[x]/y,x=(x+1)%_;}x%2!=0&&p.lineTo(a,o),s=a-u,l=o-h,this._dashOffset=-Go(s*s+l*l);},_dashedQuadraticTo:function _dashedQuadraticTo(t,e,i,n){var a=i,o=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,a,o);},toStatic:function toStatic(){var t=this.data;t instanceof Array&&(t.length=this._len,Wo&&(this.data=new Float32Array(t)));},getBoundingRect:function getBoundingRect(){Po[0]=Po[1]=Oo[0]=Oo[1]=Number.MAX_VALUE,No[0]=No[1]=Eo[0]=Eo[1]=-Number.MAX_VALUE;for(var t,e,i,n,a,o,r,s,l,u,h,c,d,f,p=this.data,g=0,m=0,v=0,y=0,x=0;x<p.length;){var _=p[x++];switch(1===x&&(v=g=p[x],y=m=p[x+1]),_){case ko.M:g=v=p[x++],m=y=p[x++],Oo[0]=v,Oo[1]=y,Eo[0]=v,Eo[1]=y;break;case ko.L:Ao(g,m,p[x],p[x+1],Oo,Eo),g=p[x++],m=p[x++];break;case ko.C:Co(g,m,p[x++],p[x++],p[x++],p[x++],p[x],p[x+1],Oo,Eo),g=p[x++],m=p[x++];break;case ko.Q:t=g,e=m,i=p[x++],n=p[x++],a=p[x],o=p[x+1],r=Oo,s=Eo,u=l=void 0,u=fo,h=yo(vo((l=go)(t,i,a),1),0),c=yo(vo(l(e,n,o),1),0),d=u(t,i,a,h),f=u(e,n,o,c),r[0]=vo(t,a,d),r[1]=vo(e,o,f),s[0]=yo(t,a,d),s[1]=yo(e,o,f),g=p[x++],m=p[x++];break;case ko.A:var w=p[x++],b=p[x++],S=p[x++],M=p[x++],I=p[x++],A=p[x++]+I;x+=1;var T=1-p[x++];1===x&&(v=Bo(I)*S+w,y=Vo(I)*M+b),Lo(w,b,S,M,I,A,T,Oo,Eo),g=Bo(A)*S+w,m=Vo(A)*M+b;break;case ko.R:Ao(v=g=p[x++],y=m=p[x++],v+p[x++],y+p[x++],Oo,Eo);break;case ko.Z:g=v,m=y;}St(Po,Po,Oo),Mt(No,No,Eo);}return 0===x&&(Po[0]=Po[1]=No[0]=No[1]=0),new bi(Po[0],Po[1],No[0]-Po[0],No[1]-Po[1]);},rebuildPath:function rebuildPath(t){for(var e,i,n,a,o,r,s=this.data,l=this._ux,u=this._uy,h=this._len,c=0;c<h;){var d=s[c++];switch(1===c&&(e=n=s[c],i=a=s[c+1]),d){case ko.M:e=n=s[c++],i=a=s[c++],t.moveTo(n,a);break;case ko.L:o=s[c++],r=s[c++],(Fo(o-n)>l||Fo(r-a)>u||c===h-1)&&(t.lineTo(o,r),n=o,a=r);break;case ko.C:t.bezierCurveTo(s[c++],s[c++],s[c++],s[c++],s[c++],s[c++]),n=s[c-2],a=s[c-1];break;case ko.Q:t.quadraticCurveTo(s[c++],s[c++],s[c++],s[c++]),n=s[c-2],a=s[c-1];break;case ko.A:var f=s[c++],p=s[c++],g=s[c++],m=s[c++],v=s[c++],y=s[c++],x=s[c++],_=s[c++],w=m<g?g:m,b=m<g?1:g/m,S=m<g?m/g:1,M=v+y;.001<Math.abs(g-m)?(t.translate(f,p),t.rotate(x),t.scale(b,S),t.arc(0,0,w,v,M,1-_),t.scale(1/b,1/S),t.rotate(-x),t.translate(-f,-p)):t.arc(f,p,w,v,M,1-_),1===c&&(e=Bo(v)*g+f,i=Vo(v)*m+p),n=Bo(M)*g+f,a=Vo(M)*m+p;break;case ko.R:e=n=s[c],i=a=s[c+1],t.rect(s[c++],s[c++],s[c++],s[c++]);break;case ko.Z:t.closePath(),n=e,a=i;}}}},Ho.CMD=ko;var Yo=2*Math.PI;function jo(t){return(t%=Yo)<0&&(t+=Yo),t;}var qo=2*Math.PI;function Ko(t,e,i,n,a,o,r,s,l){if(0===r)return!1;var u=r;s-=t,l-=e;var h=Math.sqrt(s*s+l*l);if(i<h-u||h+u<i)return!1;if(Math.abs(n-a)%qo<1e-4)return!0;if(o){var c=n;n=jo(a),a=jo(c);}else n=jo(n),a=jo(a);a<n&&(a+=qo);var d=Math.atan2(l,s);return d<0&&(d+=qo),n<=d&&d<=a||n<=d+qo&&d+qo<=a;}function $o(t,e,i,n,a,o){if(e<o&&n<o||o<e&&o<n)return 0;if(n===e)return 0;var r=n<e?1:-1,s=(o-e)/(n-e);1!=s&&0!=s||(r=n<e?.5:-.5);var l=s*(i-t)+t;return l===a?1/0:a<l?r:0;}var Jo=Ho.CMD,Qo=2*Math.PI,tr=1e-4;var er=[-1,-1,-1],ir=[-1,-1];function nr(t,e,i,n,a,o,r,s,l,u){if(e<u&&n<u&&o<u&&s<u||u<e&&u<n&&u<o&&u<s)return 0;var h,c=function(t,e,i,n,a,o){var r=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-a,h=s*s-3*r*l,c=s*l-9*r*u,d=l*l-3*s*u,f=0;if(ro(h)&&ro(c)){if(ro(s))o[0]=0;else 0<=(M=-l/s)&&M<=1&&(o[f++]=M);}else{var p=c*c-4*h*d;if(ro(p)){var g=c/h,m=-g/2;0<=(M=-s/r+g)&&M<=1&&(o[f++]=M),0<=m&&m<=1&&(o[f++]=m);}else if(0<p){var v=Ja(p),y=h*s+1.5*r*(-c+v),x=h*s+1.5*r*(-c-v);0<=(M=(-s-((y=y<0?-$a(-y,io):$a(y,io))+(x=x<0?-$a(-x,io):$a(x,io))))/(3*r))&&M<=1&&(o[f++]=M);}else{var _=(2*h*s-3*r*c)/(2*Ja(h*h*h)),w=Math.acos(_)/3,b=Ja(h),S=Math.cos(w),M=(-s-2*b*S)/(3*r),I=(m=(-s+b*(S+eo*Math.sin(w)))/(3*r),(-s+b*(S-eo*Math.sin(w)))/(3*r));0<=M&&M<=1&&(o[f++]=M),0<=m&&m<=1&&(o[f++]=m),0<=I&&I<=1&&(o[f++]=I);}}return f;}(e,n,o,s,u,er);if(0===c)return 0;for(var d,f,p=0,g=-1,m=0;m<c;m++){var v=er[m],y=0===v||1===v?.5:1;lo(t,i,a,r,v)<l||(g<0&&(g=ho(e,n,o,s,ir),ir[1]<ir[0]&&1<g&&(void 0,h=ir[0],ir[0]=ir[1],ir[1]=h),d=lo(e,n,o,s,ir[0]),1<g&&(f=lo(e,n,o,s,ir[1]))),2===g?v<ir[0]?p+=d<e?y:-y:v<ir[1]?p+=f<d?y:-y:p+=s<f?y:-y:v<ir[0]?p+=d<e?y:-y:p+=s<d?y:-y);}return p;}function ar(t,e,i,n,a,o,r,s){if(e<s&&n<s&&o<s||s<e&&s<n&&s<o)return 0;var l=function(t,e,i,n,a){var o=t-2*e+i,r=2*(e-t),s=t-n,l=0;if(ro(o)){if(so(r))0<=(h=-s/r)&&h<=1&&(a[l++]=h);}else{var u=r*r-4*o*s;if(ro(u))0<=(h=-r/(2*o))&&h<=1&&(a[l++]=h);else if(0<u){var h,c=Ja(u),d=(-r-c)/(2*o);0<=(h=(-r+c)/(2*o))&&h<=1&&(a[l++]=h),0<=d&&d<=1&&(a[l++]=d);}}return l;}(e,n,o,s,er);if(0===l)return 0;var u=go(e,n,o);if(0<=u&&u<=1){for(var h=0,c=fo(e,n,o,u),d=0;d<l;d++){var f=0===er[d]||1===er[d]?.5:1;fo(t,i,a,er[d])<r||(er[d]<u?h+=c<e?f:-f:h+=o<c?f:-f);}return h;}f=0===er[0]||1===er[0]?.5:1;return fo(t,i,a,er[0])<r?0:o<e?f:-f;}function or(t,e,i,n,a,o,r,s){if(i<(s-=e)||s<-i)return 0;var l=Math.sqrt(i*i-s*s);er[0]=-l,er[1]=l;var u=Math.abs(n-a);if(u<1e-4)return 0;if(u%Qo<1e-4){a=Qo;var h=o?1:-1;return r>=er[n=0]+t&&r<=er[1]+t?h:0;}if(o){l=n;n=jo(a),a=jo(l);}else n=jo(n),a=jo(a);a<n&&(a+=Qo);for(var c=0,d=0;d<2;d++){var f=er[d];if(r<f+t){var p=Math.atan2(s,f);h=o?1:-1;p<0&&(p=Qo+p),(n<=p&&p<=a||n<=p+Qo&&p+Qo<=a)&&(p>Math.PI/2&&p<1.5*Math.PI&&(h=-h),c+=h);}}return c;}function rr(t,e,i,n,a){for(var o=0,r=0,s=0,l=0,u=0,h=0;h<t.length;){var c=t[h++];switch(c===Jo.M&&1<h&&(i||(o+=$o(r,s,l,u,n,a))),1===h&&(l=r=t[h],u=s=t[h+1]),c){case Jo.M:r=l=t[h++],s=u=t[h++];break;case Jo.L:if(i){if(Zo(r,s,t[h],t[h+1],e,n,a))return!0;}else o+=$o(r,s,t[h],t[h+1],n,a)||0;r=t[h++],s=t[h++];break;case Jo.C:if(i){if(Uo(r,s,t[h++],t[h++],t[h++],t[h++],t[h],t[h+1],e,n,a))return!0;}else o+=nr(r,s,t[h++],t[h++],t[h++],t[h++],t[h],t[h+1],n,a)||0;r=t[h++],s=t[h++];break;case Jo.Q:if(i){if(Xo(r,s,t[h++],t[h++],t[h],t[h+1],e,n,a))return!0;}else o+=ar(r,s,t[h++],t[h++],t[h],t[h+1],n,a)||0;r=t[h++],s=t[h++];break;case Jo.A:var d=t[h++],f=t[h++],p=t[h++],g=t[h++],m=t[h++],v=t[h++];h+=1;var y=1-t[h++],x=Math.cos(m)*p+d,_=Math.sin(m)*g+f;1<h?o+=$o(r,s,x,_,n,a):(l=x,u=_);var w=(n-d)*g/p+d;if(i){if(Ko(d,f,g,m,m+v,y,e,w,a))return!0;}else o+=or(d,f,g,m,m+v,y,w,a);r=Math.cos(m+v)*p+d,s=Math.sin(m+v)*g+f;break;case Jo.R:l=r=t[h++],u=s=t[h++];x=l+t[h++],_=u+t[h++];if(i){if(Zo(l,u,x,u,e,n,a)||Zo(x,u,x,_,e,n,a)||Zo(x,_,l,_,e,n,a)||Zo(l,_,l,u,e,n,a))return!0;}else o+=$o(x,u,x,_,n,a),o+=$o(l,_,l,u,n,a);break;case Jo.Z:if(i){if(Zo(r,s,l,u,e,n,a))return!0;}else o+=$o(r,s,l,u,n,a);r=l,s=u;}}return i||function(t,e){return Math.abs(t-e)<tr;}(s,u)||(o+=$o(r,s,l,u,n,a)||0),0!==o;}var sr=Ui.prototype.getCanvasPattern,lr=Math.abs,ur=new Ho(!0);function hr(t){Xn.call(this,t),this.path=null;}hr.prototype={constructor:hr,type:"path",__dirtyPath:!0,strokeContainThreshold:5,segmentIgnoreThreshold:0,subPixelOptimize:!1,brush:function brush(t,e){var i,n=this.style,a=this.path||ur,o=n.hasStroke(),r=n.hasFill(),s=n.fill,l=n.stroke,u=r&&!!s.colorStops,h=o&&!!l.colorStops,c=r&&!!s.image,d=o&&!!l.image;n.bind(t,this,e),this.setTransform(t),this.__dirty&&(u&&(i=i||this.getBoundingRect(),this._fillGradient=n.getGradient(t,s,i)),h&&(i=i||this.getBoundingRect(),this._strokeGradient=n.getGradient(t,l,i)));u?t.fillStyle=this._fillGradient:c&&(t.fillStyle=sr.call(s,t)),h?t.strokeStyle=this._strokeGradient:d&&(t.strokeStyle=sr.call(l,t));var f=n.lineDash,p=n.lineDashOffset,g=!!t.setLineDash,m=this.getGlobalScale();if(a.setScale(m[0],m[1],this.segmentIgnoreThreshold),this.__dirtyPath||f&&!g&&o?(a.beginPath(t),f&&!g&&(a.setLineDash(f),a.setLineDashOffset(p)),this.buildPath(a,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),r)if(null!=n.fillOpacity){var v=t.globalAlpha;t.globalAlpha=n.fillOpacity*n.opacity,a.fill(t),t.globalAlpha=v;}else a.fill(t);if(f&&g&&(t.setLineDash(f),t.lineDashOffset=p),o)if(null!=n.strokeOpacity){v=t.globalAlpha;t.globalAlpha=n.strokeOpacity*n.opacity,a.stroke(t),t.globalAlpha=v;}else a.stroke(t);f&&g&&t.setLineDash([]),null!=n.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect()));},buildPath:function buildPath(t,e,i){},createPathProxy:function createPathProxy(){this.path=new Ho();},getBoundingRect:function getBoundingRect(){var t=this._rect,e=this.style,i=!t;if(i){var n=this.path;n=n||(this.path=new Ho()),this.__dirtyPath&&(n.beginPath(),this.buildPath(n,this.shape,!1)),t=n.getBoundingRect();}if(this._rect=t,e.hasStroke()){var a=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){a.copy(t);var o=e.lineWidth,r=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),1e-10<r&&(a.width+=o/r,a.height+=o/r,a.x-=o/r/2,a.y-=o/r/2);}return a;}return t;},contain:function contain(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),a=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var o=this.path.data;if(a.hasStroke()){var r=a.lineWidth,s=a.strokeNoScale?this.getLineScale():1;if(1e-10<s&&(a.hasFill()||(r=Math.max(r,this.strokeContainThreshold)),function(t,e,i,n){return rr(t,e,!0,i,n);}(o,r/s,t,e)))return!0;}if(a.hasFill())return function(t,e,i){return rr(t,0,!1,e,i);}(o,t,e);}return!1;},dirty:function dirty(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=this.__dirtyText=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty();},animateShape:function animateShape(t){return this.animate("shape",t);},attrKV:function attrKV(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):Xn.prototype.attrKV.call(this,t,e);},setShape:function setShape(t,e){var i=this.shape;if(i){if(z(t))for(var n in t){t.hasOwnProperty(n)&&(i[n]=t[n]);}else i[t]=e;this.dirty(!0);}return this;},getLineScale:function getLineScale(){var t=this.transform;return t&&1e-10<lr(t[0]-1)&&1e-10<lr(t[3]-1)?Math.sqrt(lr(t[0]*t[3]-t[2]*t[1])):1;}},hr.extend=function(a){function t(t){hr.call(this,t),a.style&&this.style.extendFrom(a.style,!1);var e=a.shape;if(e){this.shape=this.shape||{};var i=this.shape;for(var n in e){!i.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(i[n]=e[n]);}}a.init&&a.init.call(this,t);}for(var e in w(t,hr),a){"style"!==e&&"shape"!==e&&(t.prototype[e]=a[e]);}return t;},w(hr,Xn);function cr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}var dr=Ho.CMD,fr=[[],[],[]],pr=Math.sqrt,gr=Math.atan2,mr=function mr(t,e){var i,n,a,o,r,s=t.data,l=dr.M,u=dr.C,h=dr.L,c=dr.R,d=dr.A,f=dr.Q;for(o=a=0;a<s.length;){switch(i=s[a++],o=a,n=0,i){case l:case h:n=1;break;case u:n=3;break;case f:n=2;break;case d:var p=e[4],g=e[5],m=pr(e[0]*e[0]+e[1]*e[1]),v=pr(e[2]*e[2]+e[3]*e[3]),y=gr(-e[1]/v,e[0]/m);s[a]*=m,s[a++]+=p,s[a]*=v,s[a++]+=g,s[a++]*=m,s[a++]*=v,s[a++]+=y,s[a++]+=y,o=a+=2;break;case c:x[0]=s[a++],x[1]=s[a++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1],x[0]+=s[a++],x[1]+=s[a++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1];}for(r=0;r<n;r++){var x;(x=fr[r])[0]=s[a++],x[1]=s[a++],bt(x,x,e),s[o++]=x[0],s[o++]=x[1];}}},vr=Math.sqrt,yr=Math.sin,xr=Math.cos,_r=Math.PI,wr=function wr(t,e){return(t[0]*e[0]+t[1]*e[1])/(cr(t)*cr(e));},br=function br(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(wr(t,e));};function Sr(t,e,i,n,a,o,r,s,l,u,h){var c=l*(_r/180),d=xr(c)*(t-i)/2+yr(c)*(e-n)/2,f=-1*yr(c)*(t-i)/2+xr(c)*(e-n)/2,p=d*d/(r*r)+f*f/(s*s);1<p&&(r*=vr(p),s*=vr(p));var g=(a===o?-1:1)*vr((r*r*(s*s)-r*r*(f*f)-s*s*(d*d))/(r*r*(f*f)+s*s*(d*d)))||0,m=g*r*f/s,v=g*-s*d/r,y=(t+i)/2+xr(c)*m-yr(c)*v,x=(e+n)/2+yr(c)*m+xr(c)*v,_=br([1,0],[(d-m)/r,(f-v)/s]),w=[(d-m)/r,(f-v)/s],b=[(-1*d-m)/r,(-1*f-v)/s],S=br(w,b);wr(w,b)<=-1&&(S=_r),1<=wr(w,b)&&(S=0),0===o&&0<S&&(S-=2*_r),1===o&&S<0&&(S+=2*_r),h.addData(u,y,x,r,s,_,S,c,o);}var Mr=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Ir=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function Ar(t,e){var i=function(t){if(!t)return new Ho();for(var e,i=0,n=0,a=i,o=n,r=new Ho(),s=Ho.CMD,l=t.match(Mr),u=0;u<l.length;u++){for(var h,c=l[u],d=c.charAt(0),f=c.match(Ir)||[],p=f.length,g=0;g<p;g++){f[g]=parseFloat(f[g]);}for(var m=0;m<p;){var v,y,x,_,w,b,S,M=i,I=n;switch(d){case"l":i+=f[m++],n+=f[m++],h=s.L,r.addData(h,i,n);break;case"L":i=f[m++],n=f[m++],h=s.L,r.addData(h,i,n);break;case"m":i+=f[m++],n+=f[m++],h=s.M,r.addData(h,i,n),a=i,o=n,d="l";break;case"M":i=f[m++],n=f[m++],h=s.M,r.addData(h,i,n),a=i,o=n,d="L";break;case"h":i+=f[m++],h=s.L,r.addData(h,i,n);break;case"H":i=f[m++],h=s.L,r.addData(h,i,n);break;case"v":n+=f[m++],h=s.L,r.addData(h,i,n);break;case"V":n=f[m++],h=s.L,r.addData(h,i,n);break;case"C":h=s.C,r.addData(h,f[m++],f[m++],f[m++],f[m++],f[m++],f[m++]),i=f[m-2],n=f[m-1];break;case"c":h=s.C,r.addData(h,f[m++]+i,f[m++]+n,f[m++]+i,f[m++]+n,f[m++]+i,f[m++]+n),i+=f[m-2],n+=f[m-1];break;case"S":v=i,y=n;var A=r.len(),T=r.data;e===s.C&&(v+=i-T[A-4],y+=n-T[A-3]),h=s.C,M=f[m++],I=f[m++],i=f[m++],n=f[m++],r.addData(h,v,y,M,I,i,n);break;case"s":v=i,y=n;A=r.len(),T=r.data;e===s.C&&(v+=i-T[A-4],y+=n-T[A-3]),h=s.C,M=i+f[m++],I=n+f[m++],i+=f[m++],n+=f[m++],r.addData(h,v,y,M,I,i,n);break;case"Q":M=f[m++],I=f[m++],i=f[m++],n=f[m++],h=s.Q,r.addData(h,M,I,i,n);break;case"q":M=f[m++]+i,I=f[m++]+n,i+=f[m++],n+=f[m++],h=s.Q,r.addData(h,M,I,i,n);break;case"T":v=i,y=n;A=r.len(),T=r.data;e===s.Q&&(v+=i-T[A-4],y+=n-T[A-3]),i=f[m++],n=f[m++],h=s.Q,r.addData(h,v,y,i,n);break;case"t":v=i,y=n;A=r.len(),T=r.data;e===s.Q&&(v+=i-T[A-4],y+=n-T[A-3]),i+=f[m++],n+=f[m++],h=s.Q,r.addData(h,v,y,i,n);break;case"A":x=f[m++],_=f[m++],w=f[m++],b=f[m++],S=f[m++],Sr(M=i,I=n,i=f[m++],n=f[m++],b,S,x,_,w,h=s.A,r);break;case"a":x=f[m++],_=f[m++],w=f[m++],b=f[m++],S=f[m++],Sr(M=i,I=n,i+=f[m++],n+=f[m++],b,S,x,_,w,h=s.A,r);}}"z"!==d&&"Z"!==d||(h=s.Z,r.addData(h),i=a,n=o),e=h;}return r.toStatic(),r;}(t);return(e=e||{}).buildPath=function(t){if(t.setData){t.setData(i.data),(e=t.getContext())&&t.rebuildPath(e);}else{var e=t;i.rebuildPath(e);}},e.applyTransform=function(t){mr(i,t),this.dirty(!0);},e;}function Tr(t,e){return new hr(Ar(t,e));}var Dr=function Dr(t){Xn.call(this,t);};Dr.prototype={constructor:Dr,type:"text",brush:function brush(t,e){var i=this.style;this.__dirty&&Cn(i),i.fill=i.stroke=i.shadowBlur=i.shadowColor=i.shadowOffsetX=i.shadowOffsetY=null;var n=i.text;null!=n&&(n+=""),Hn(n,i)?(this.setTransform(t),kn(this,t,n,i,null,e),this.restoreTransform(t)):t.__attrCachedBy=Ri.NONE;},getBoundingRect:function getBoundingRect(){var t=this.style;if(this.__dirty&&Cn(t),!this._rect){var e=t.text;null!=e?e+="":e="";var i=un(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.textLineHeight,t.rich);if(i.x+=t.x||0,i.y+=t.y||0,Vn(t.textStroke,t.textStrokeWidth)){var n=t.textStrokeWidth;i.x-=n/2,i.y-=n/2,i.width+=n,i.height+=n;}this._rect=i;}return this._rect;}},w(Dr,Xn);function Cr(l){return v.browser.ie&&11<=v.browser.version?function(){var t,e=this.__clipPaths,i=this.style;if(e)for(var n=0;n<e.length;n++){var a=e[n],o=a&&a.shape,r=a&&a.type;if(o&&("sector"===r&&o.startAngle===o.endAngle||"rect"===r&&(!o.width||!o.height))){for(var s=0;s<kr.length;s++){kr[s][2]=i[kr[s][0]],i[kr[s][0]]=kr[s][1];}t=!0;break;}}if(l.apply(this,arguments),t)for(s=0;s<kr.length;s++){i[kr[s][0]]=kr[s][2];}}:l;}var Lr=hr.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function buildPath(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0);}}),kr=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]],Pr=hr.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:Cr(hr.prototype.brush),buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=Math.max(e.r0||0,0),o=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,l=e.clockwise,u=Math.cos(r),h=Math.sin(r);t.moveTo(u*a+i,h*a+n),t.lineTo(u*o+i,h*o+n),t.arc(i,n,o,r,s,!l),t.lineTo(Math.cos(s)*a+i,Math.sin(s)*a+n),0!==a&&t.arc(i,n,a,s,r,l),t.closePath();}}),Nr=hr.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,a,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,a,!0);}});function Or(t,e,i,n,a,o,r){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*r+(-3*(e-i)-2*s-l)*o+s*a+e;}function Er(t,e,i){var n=e.points,a=e.smooth;if(n&&2<=n.length){if(a&&"spline"!==a){var o=function(t,e,i,n){var a,o,r,s,l=[],u=[],h=[],c=[];if(n){r=[1/0,1/0],s=[-1/0,-1/0];for(var d=0,f=t.length;d<f;d++){St(r,r,t[d]),Mt(s,s,t[d]);}St(r,r,n[0]),Mt(s,s,n[1]);}for(d=0,f=t.length;d<f;d++){var p=t[d];if(i)a=t[d?d-1:f-1],o=t[(d+1)%f];else{if(0===d||d===f-1){l.push(rt(t[d]));continue;}a=t[d-1],o=t[d+1];}ht(u,o,a),gt(u,u,e);var g=vt(p,a),m=vt(p,o),v=g+m;0!==v&&(g/=v,m/=v),gt(h,u,-g),gt(c,u,m);var y=lt([],p,h),x=lt([],p,c);n&&(Mt(y,y,r),St(y,y,s),Mt(x,x,r),St(x,x,s)),l.push(y),l.push(x);}return i&&l.push(l.shift()),l;}(n,a,i,e.smoothConstraint);t.moveTo(n[0][0],n[0][1]);for(var r=n.length,s=0;s<(i?r:r-1);s++){var l=o[2*s],u=o[2*s+1],h=n[(s+1)%r];t.bezierCurveTo(l[0],l[1],u[0],u[1],h[0],h[1]);}}else{"spline"===a&&(n=function(t,e){for(var i=t.length,n=[],a=0,o=1;o<i;o++){a+=vt(t[o-1],t[o]);}var r=a/2;r=r<i?i:r;for(o=0;o<r;o++){var s,l,u,h=o/(r-1)*(e?i:i-1),c=Math.floor(h),d=h-c,f=t[c%i];u=e?(s=t[(c-1+i)%i],l=t[(c+1)%i],t[(c+2)%i]):(s=t[0===c?c:c-1],l=t[i-2<c?i-1:c+1],t[i-3<c?i-1:c+2]);var p=d*d,g=d*p;n.push([Or(s[0],f[0],l[0],u[0],d,p,g),Or(s[1],f[1],l[1],u[1],d,p,g)]);}return n;}(n,i)),t.moveTo(n[0][0],n[0][1]);s=1;for(var c=n.length;s<c;s++){t.lineTo(n[s][0],n[s][1]);}}i&&t.closePath();}}var Rr=hr.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function buildPath(t,e){Er(t,e,!0);}}),zr=hr.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){Er(t,e,!1);}}),Br=Math.round;function Vr(t,e,i){var n=i&&i.lineWidth;if(e&&n){var a=e.x1,o=e.x2,r=e.y1,s=e.y2;Br(2*a)===Br(2*o)?t.x1=t.x2=Fr(a,n,!0):(t.x1=a,t.x2=o),Br(2*r)===Br(2*s)?t.y1=t.y2=Fr(r,n,!0):(t.y1=r,t.y2=s);}}function Gr(t,e,i){var n=i&&i.lineWidth;if(e&&n){var a=e.x,o=e.y,r=e.width,s=e.height;t.x=Fr(a,n,!0),t.y=Fr(o,n,!0),t.width=Math.max(Fr(a+r,n,!1)-t.x,0===r?0:1),t.height=Math.max(Fr(o+s,n,!1)-t.y,0===s?0:1);}}function Fr(t,e,i){var n=Br(2*t);return(n+Br(e))%2==0?n/2:(n+(i?1:-1))/2;}var Wr={},Hr=hr.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i,n,a,o;this.subPixelOptimize?(Gr(Wr,e,this.style),i=Wr.x,n=Wr.y,a=Wr.width,o=Wr.height,Wr.r=e.r,e=Wr):(i=e.x,n=e.y,a=e.width,o=e.height),e.r?bn(t,e):t.rect(i,n,a,o),t.closePath();}}),Zr={},Ur=hr.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i,n,a,o;o=this.subPixelOptimize?(Vr(Zr,e,this.style),i=Zr.x1,n=Zr.y1,a=Zr.x2,Zr.y2):(i=e.x1,n=e.y1,a=e.x2,e.y2);var r=e.percent;0!==r&&(t.moveTo(i,n),r<1&&(a=i*(1-r)+a*r,o=n*(1-r)+o*r),t.lineTo(a,o));},pointAt:function pointAt(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t];}}),Xr=[];function Yr(t,e,i){var n=t.cpx2,a=t.cpy2;return null===n||null===a?[(i?uo:lo)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?uo:lo)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?po:fo)(t.x1,t.cpx1,t.x2,e),(i?po:fo)(t.y1,t.cpy1,t.y2,e)];}function jr(t){this.colorStops=t||[];}var qr=hr.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.x1,n=e.y1,a=e.x2,o=e.y2,r=e.cpx1,s=e.cpy1,l=e.cpx2,u=e.cpy2,h=e.percent;0!==h&&(t.moveTo(i,n),null==l||null==u?(h<1&&(mo(i,r,a,h,Xr),r=Xr[1],a=Xr[2],mo(n,s,o,h,Xr),s=Xr[1],o=Xr[2]),t.quadraticCurveTo(r,s,a,o)):(h<1&&(co(i,r,l,a,h,Xr),r=Xr[1],l=Xr[2],a=Xr[3],co(n,s,u,o,h,Xr),s=Xr[1],u=Xr[2],o=Xr[3]),t.bezierCurveTo(r,s,l,u,a,o)));},pointAt:function pointAt(t){return Yr(this.shape,t,!1);},tangentAt:function tangentAt(t){var e=Yr(this.shape,t,!0);return mt(e,e);}}),Kr=hr.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=Math.max(e.r,0),o=e.startAngle,r=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*a+i,u*a+n),t.arc(i,n,a,o,r,!s);}}),$r=hr.extend({type:"compound",shape:{paths:null},_updatePathDirty:function _updatePathDirty(){for(var t=this.__dirtyPath,e=this.shape.paths,i=0;i<e.length;i++){t=t||e[i].__dirtyPath;}this.__dirtyPath=t,this.__dirty=this.__dirty||t;},beforeBrush:function beforeBrush(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),i=0;i<t.length;i++){t[i].path||t[i].createPathProxy(),t[i].path.setScale(e[0],e[1],t[i].segmentIgnoreThreshold);}},buildPath:function buildPath(t,e){for(var i=e.paths||[],n=0;n<i.length;n++){i[n].buildPath(t,i[n].shape,!0);}},afterBrush:function afterBrush(){for(var t=this.shape.paths||[],e=0;e<t.length;e++){t[e].__dirtyPath=!1;}},getBoundingRect:function getBoundingRect(){return this._updatePathDirty(),hr.prototype.getBoundingRect.call(this);}});jr.prototype={constructor:jr,addColorStop:function addColorStop(t,e){this.colorStops.push({offset:t,color:e});}};function Jr(t,e,i,n,a,o){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==i?1:i,this.y2=null==n?0:n,this.type="linear",this.global=o||!1,jr.call(this,a);}Jr.prototype={constructor:Jr},w(Jr,jr);function Qr(t,e,i,n,a){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==i?.5:i,this.type="radial",this.global=a||!1,jr.call(this,n);}function ts(t){Xn.call(this,t),this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.notClear=!0;}Qr.prototype={constructor:Qr},w(Qr,jr),ts.prototype.incremental=!0,ts.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.dirty(),this.notClear=!1;},ts.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.dirty();},ts.prototype.addDisplayables=function(t,e){e=e||!1;for(var i=0;i<t.length;i++){this.addDisplayable(t[i],e);}},ts.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++){t&&t(this._displayables[e]);}for(e=0;e<this._temporaryDisplayables.length;e++){t&&t(this._temporaryDisplayables[e]);}},ts.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){(e=this._displayables[t]).parent=this,e.update(),e.parent=null;}for(t=0;t<this._temporaryDisplayables.length;t++){var e;(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null;}},ts.prototype.brush=function(t,e){for(var i=this._cursor;i<this._displayables.length;i++){(n=this._displayables[i]).beforeBrush&&n.beforeBrush(t),n.brush(t,i===this._cursor?null:this._displayables[i-1]),n.afterBrush&&n.afterBrush(t);}this._cursor=i;for(i=0;i<this._temporaryDisplayables.length;i++){var n;(n=this._temporaryDisplayables[i]).beforeBrush&&n.beforeBrush(t),n.brush(t,0===i?null:this._temporaryDisplayables[i-1]),n.afterBrush&&n.afterBrush(t);}this._temporaryDisplayables=[],this.notClear=!0;};var es=[];ts.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new bi(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var i=this._displayables[e],n=i.getBoundingRect().clone();i.needLocalTransform()&&n.applyTransform(i.getLocalTransform(es)),t.union(n);}this._rect=t;}return this._rect;},ts.prototype.contain=function(t,e){var i=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(i[0],i[1]))for(var n=0;n<this._displayables.length;n++){if(this._displayables[n].contain(t,e))return!0;}return!1;},w(ts,Xn);var is=Math.max,ns=Math.min,as={},os=1,rs={color:"textFill",textBorderColor:"textStroke",textBorderWidth:"textStrokeWidth"},ss="emphasis",ls="normal",us=1,hs={},cs={};function ds(t){return hr.extend(t);}function fs(t,e){cs[t]=e;}function ps(t){if(cs.hasOwnProperty(t))return cs[t];}function gs(t,e,i,n){var a=Tr(t,e);return i&&("center"===n&&(i=vs(i,a.getBoundingRect())),xs(a,i)),a;}function ms(t,i,n){var a=new Yn({style:{image:t,x:i.x,y:i.y,width:i.width,height:i.height},onload:function onload(t){if("center"===n){var e={width:t.width,height:t.height};a.setStyle(vs(i,e));}}});return a;}function vs(t,e){var i,n=e.width/e.height,a=t.height*n;return i=a<=t.width?t.height:(a=t.width)/n,{x:t.x+t.width/2-a/2,y:t.y+t.height/2-i/2,width:a,height:i};}var ys=function ys(t,e){for(var i=[],n=t.length,a=0;a<n;a++){var o=t[a];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),i.push(o.path);}var r=new hr(e);return r.createPathProxy(),r.buildPath=function(t){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e);},r;};function xs(t,e){if(t.applyTransform){var i=t.getBoundingRect().calculateTransform(e);t.applyTransform(i);}}var _s=Fr;function ws(t){return null!=t&&"none"!==t;}var bs=Q(),Ss=0;function Ms(t){var e=t.__hoverStl;if(e&&!t.__highlighted){var i=t.__zr,n=t.useHoverLayer&&i&&"canvas"===i.painter.type;if(t.__highlighted=n?"layer":"plain",!(t.isGroup||!i&&t.useHoverLayer)){var a=t,o=t.style;n&&(o=(a=i.addHover(t)).style),Us(o),n||function(t){if(t.__hoverStlDirty){t.__hoverStlDirty=!1;var e=t.__hoverStl;if(e){var i=t.__cachedNormalStl={};t.__cachedNormalZ2=t.z2;var n=t.style;for(var a in e){null!=e[a]&&(i[a]=n[a]);}i.fill=n.fill,i.stroke=n.stroke;}else t.__cachedNormalStl=t.__cachedNormalZ2=null;}}(a),o.extendFrom(e),Is(o,e,"fill"),Is(o,e,"stroke"),Zs(o),n||(t.dirty(!1),t.z2+=os);}}}function Is(t,e,i){!ws(e[i])&&ws(t[i])&&(t[i]=function(t){if("string"!=typeof t)return t;var e=bs.get(t);return e||(e=ze(t,-.1),Ss<1e4&&(bs.set(t,e),Ss++)),e;}(t[i]));}function As(t){var e=t.__highlighted;if(e&&(t.__highlighted=!1,!t.isGroup))if("layer"===e)t.__zr&&t.__zr.removeHover(t);else{var i=t.style,n=t.__cachedNormalStl;n&&(Us(i),t.setStyle(n),Zs(i));var a=t.__cachedNormalZ2;null!=a&&t.z2-a===os&&(t.z2=a);}}function Ts(t,e,i){var n,a=ls,o=ls;t.__highlighted&&(a=ss,n=!0),e(t,i),t.__highlighted&&(o=ss,n=!0),t.isGroup&&t.traverse(function(t){t.isGroup||e(t,i);}),n&&t.__highDownOnUpdate&&t.__highDownOnUpdate(a,o);}function Ds(t,e){e=t.__hoverStl=!1!==e&&(t.hoverStyle||e||{}),t.__hoverStlDirty=!0,t.__highlighted&&(t.__cachedNormalStl=null,As(t),Ms(t));}function Cs(t){Ns(this,t)||this.__highByOuter||Ts(this,Ms);}function Ls(t){Ns(this,t)||this.__highByOuter||Ts(this,As);}function ks(t){this.__highByOuter|=1<<(t||0),Ts(this,Ms);}function Ps(t){(this.__highByOuter&=~(1<<(t||0)))||Ts(this,As);}function Ns(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch;}function Os(t,e){Es(t,!0),Ts(t,Ds,e);}function Es(t,e){var i=!1===e;if(t.__highDownSilentOnTouch=t.highDownSilentOnTouch,t.__highDownOnUpdate=t.highDownOnUpdate,!i||t.__highDownDispatcher){var n=i?"off":"on";t[n]("mouseover",Cs)[n]("mouseout",Ls),t[n]("emphasis",ks)[n]("normal",Ps),t.__highByOuter=t.__highByOuter||0,t.__highDownDispatcher=!i;}}function Rs(t){return!(!t||!t.__highDownDispatcher);}function zs(t){var e=hs[t];return null==e&&us<=32&&(e=hs[t]=us++),e;}function Bs(t,e,i,n,a,o,r){var s,l=(a=a||as).labelFetcher,u=a.labelDataIndex,h=a.labelDimIndex,c=i.getShallow("show"),d=n.getShallow("show");(c||d)&&(l&&(s=l.getFormattedLabel(u,"normal",null,h)),null==s&&(s=O(a.defaultText)?a.defaultText(u,a):a.defaultText));var f=c?s:null,p=d?H(l?l.getFormattedLabel(u,"emphasis",null,h):null,s):null;null==f&&null==p||(Gs(t,i,o,a),Gs(e,n,r,a,!0)),t.text=f,e.text=p;}function Vs(t,e,i){var n=t.style;e&&(Us(n),t.setStyle(e),Zs(n)),n=t.__hoverStl,i&&n&&(Us(n),L(n,i),Zs(n));}function Gs(t,e,i,n,a){return Fs(t,e,n,a),i&&L(t,i),t;}function Fs(t,e,i,n){if((i=i||as).isRectText){var a;i.getTextPosition?a=i.getTextPosition(e,n):"outside"===(a=e.getShallow("position")||(n?null:"inside"))&&(a="top"),t.textPosition=a,t.textOffset=e.getShallow("offset");var o=e.getShallow("rotate");null!=o&&(o*=Math.PI/180),t.textRotation=o,t.textDistance=H(e.getShallow("distance"),n?null:5);}var r,s=e.ecModel,l=s&&s.option.textStyle,u=function(t){var e;for(;t&&t!==t.ecModel;){var i=(t.option||as).rich;if(i)for(var n in e=e||{},i){i.hasOwnProperty(n)&&(e[n]=1);}t=t.parentModel;}return e;}(e);if(u)for(var h in r={},u){if(u.hasOwnProperty(h)){var c=e.getModel(["rich",h]);Ws(r[h]={},c,l,i,n);}}return t.rich=r,Ws(t,e,l,i,n,!0),i.forceRich&&!i.textStyle&&(i.textStyle={}),t;}function Ws(t,e,i,n,a,o){i=!a&&i||as,t.textFill=Hs(e.getShallow("color"),n)||i.color,t.textStroke=Hs(e.getShallow("textBorderColor"),n)||i.textBorderColor,t.textStrokeWidth=H(e.getShallow("textBorderWidth"),i.textBorderWidth),a||(o&&(t.insideRollbackOpt=n,Zs(t)),null==t.textFill&&(t.textFill=n.autoColor)),t.fontStyle=e.getShallow("fontStyle")||i.fontStyle,t.fontWeight=e.getShallow("fontWeight")||i.fontWeight,t.fontSize=e.getShallow("fontSize")||i.fontSize,t.fontFamily=e.getShallow("fontFamily")||i.fontFamily,t.textAlign=e.getShallow("align"),t.textVerticalAlign=e.getShallow("verticalAlign")||e.getShallow("baseline"),t.textLineHeight=e.getShallow("lineHeight"),t.textWidth=e.getShallow("width"),t.textHeight=e.getShallow("height"),t.textTag=e.getShallow("tag"),o&&n.disableBox||(t.textBackgroundColor=Hs(e.getShallow("backgroundColor"),n),t.textPadding=e.getShallow("padding"),t.textBorderColor=Hs(e.getShallow("borderColor"),n),t.textBorderWidth=e.getShallow("borderWidth"),t.textBorderRadius=e.getShallow("borderRadius"),t.textBoxShadowColor=e.getShallow("shadowColor"),t.textBoxShadowBlur=e.getShallow("shadowBlur"),t.textBoxShadowOffsetX=e.getShallow("shadowOffsetX"),t.textBoxShadowOffsetY=e.getShallow("shadowOffsetY")),t.textShadowColor=e.getShallow("textShadowColor")||i.textShadowColor,t.textShadowBlur=e.getShallow("textShadowBlur")||i.textShadowBlur,t.textShadowOffsetX=e.getShallow("textShadowOffsetX")||i.textShadowOffsetX,t.textShadowOffsetY=e.getShallow("textShadowOffsetY")||i.textShadowOffsetY;}function Hs(t,e){return"auto"!==t?t:e&&e.autoColor?e.autoColor:null;}function Zs(t){var e,i=t.textPosition,n=t.insideRollbackOpt;if(n&&null==t.textFill){var a=n.autoColor,o=n.isRectText,r=n.useInsideStyle,s=!1!==r&&(!0===r||o&&i&&"string"==typeof i&&0<=i.indexOf("inside")),l=!s&&null!=a;(s||l)&&(e={textFill:t.textFill,textStroke:t.textStroke,textStrokeWidth:t.textStrokeWidth}),s&&(t.textFill="#fff",null==t.textStroke&&(t.textStroke=a,null==t.textStrokeWidth&&(t.textStrokeWidth=2))),l&&(t.textFill=a);}t.insideRollback=e;}function Us(t){var e=t.insideRollback;e&&(t.textFill=e.textFill,t.textStroke=e.textStroke,t.textStrokeWidth=e.textStrokeWidth,t.insideRollback=null);}function Xs(t,e){var i=e||e.getModel("textStyle");return j([t.fontStyle||i&&i.getShallow("fontStyle")||"",t.fontWeight||i&&i.getShallow("fontWeight")||"",(t.fontSize||i&&i.getShallow("fontSize")||12)+"px",t.fontFamily||i&&i.getShallow("fontFamily")||"sans-serif"].join(" "));}function Ys(t,e,i,n,a,o){if("function"==typeof a&&(o=a,a=null),n&&n.isAnimationEnabled()){var r=t?"Update":"",s=n.getShallow("animationDuration"+r),l=n.getShallow("animationEasing"+r),u=n.getShallow("animationDelay"+r);"function"==typeof u&&(u=u(a,n.getAnimationDelayParams?n.getAnimationDelayParams(e,a):null)),"function"==typeof s&&(s=s(a)),0<s?e.animateTo(i,s,u||0,l,o,!!o):(e.stopAnimation(),e.attr(i),o&&o());}else e.stopAnimation(),e.attr(i),o&&o();}function js(t,e,i,n,a){Ys(!0,t,e,i,n,a);}function qs(t,e,i,n,a){Ys(!1,t,e,i,n,a);}function Ks(t,e){for(var i=te([]);t&&t!==e;){ie(i,t.getLocalTransform(),i),t=t.parent;}return i;}function $s(t,e,i){return e&&!P(e)&&(e=ce.getLocalTransform(e)),i&&(e=re([],e)),bt([],t,e);}function Js(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),a=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-n:"right"===t?n:0,"top"===t?-a:"bottom"===t?a:0];return o=$s(o,e,i),Math.abs(o[0])>Math.abs(o[1])?0<o[0]?"right":"left":0<o[1]?"bottom":"top";}function Qs(t,e,n,i){if(t&&e){var a,o=(a={},t.traverse(function(t){!t.isGroup&&t.anid&&(a[t.anid]=t);}),a);e.traverse(function(t){if(!t.isGroup&&t.anid){var e=o[t.anid];if(e){var i=r(t);t.attr(r(e)),js(t,i,n,t.dataIndex);}}});}function r(t){var e={position:rt(t.position),rotation:t.rotation};return t.shape&&(e.shape=L({},t.shape)),e;}}function tl(t,n){return N(t,function(t){var e=t[0];e=is(e,n.x),e=ns(e,n.x+n.width);var i=t[1];return i=is(i,n.y),[e,i=ns(i,n.y+n.height)];});}function el(t,e,i){var n=(e=L({rectHover:!0},e)).style={strokeNoScale:!0};if(i=i||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(n.image=t.slice(8),C(n,i),new Yn(e)):gs(t.replace("path://",""),e,i,"center");}function il(t,e,i,n,a){for(var o=0,r=a[a.length-1];o<a.length;o++){var s=a[o];if(nl(t,e,i,n,s[0],s[1],r[0],r[1]))return!0;r=s;}}function nl(t,e,i,n,a,o,r,s){var l=i-t,u=n-e,h=r-a,c=s-o,d=al(h,c,l,u);if(function(t){return t<=1e-6&&-1e-6<=t;}(d))return!1;var f=t-a,p=e-o,g=al(f,p,l,u)/d;if(g<0||1<g)return!1;var m=al(f,p,h,c)/d;return!(m<0||1<m);}function al(t,e,i,n){return t*n-i*e;}fs("circle",Lr),fs("sector",Pr),fs("ring",Nr),fs("polygon",Rr),fs("polyline",zr),fs("rect",Hr),fs("line",Ur),fs("bezierCurve",qr),fs("arc",Kr);var ol=(Object.freeze||Object)({Z2_EMPHASIS_LIFT:os,CACHED_LABEL_STYLE_PROPERTIES:rs,extendShape:ds,extendPath:function extendPath(t,e){return function(t,e){return hr.extend(Ar(t,e));}(t,e);},registerShape:fs,getShapeClass:ps,makePath:gs,makeImage:ms,mergePath:ys,resizePath:xs,subPixelOptimizeLine:function subPixelOptimizeLine(t){return Vr(t.shape,t.shape,t.style),t;},subPixelOptimizeRect:function subPixelOptimizeRect(t){return Gr(t.shape,t.shape,t.style),t;},subPixelOptimize:_s,setElementHoverStyle:Ds,setHoverStyle:Os,setAsHighDownDispatcher:Es,isHighDownDispatcher:Rs,getHighlightDigit:zs,setLabelStyle:Bs,modifyLabelStyle:Vs,setTextStyle:Gs,setText:function setText(t,e,i){var n,a={isRectText:!0};!1===i?n=!0:a.autoColor=i,Fs(t,e,a,n);},getFont:Xs,updateProps:js,initProps:qs,getTransform:Ks,applyTransform:$s,transformDirection:Js,groupTransition:Qs,clipPointsByRect:tl,clipRectByRect:function clipRectByRect(t,e){var i=is(t.x,e.x),n=ns(t.x+t.width,e.x+e.width),a=is(t.y,e.y),o=ns(t.y+t.height,e.y+e.height);if(i<=n&&a<=o)return{x:i,y:a,width:n-i,height:o-a};},createIcon:el,linePolygonIntersect:il,lineLineIntersect:nl,Group:Si,Image:Yn,Text:Dr,Circle:Lr,Sector:Pr,Ring:Nr,Polygon:Rr,Polyline:zr,Rect:Hr,Line:Ur,BezierCurve:qr,Arc:Kr,IncrementalDisplayable:ts,CompoundPath:$r,LinearGradient:Jr,RadialGradient:Qr,BoundingRect:bi}),rl=["textStyle","color"],sl={getTextColor:function getTextColor(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(rl):null);},getFont:function getFont(){return Xs({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel);},getTextRect:function getTextRect(t){return un(t,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("lineHeight"),this.getShallow("rich"),this.getShallow("truncateText"));}},ll=Xa([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),ul={getItemStyle:function getItemStyle(t,e){var i=ll(this,t,e),n=this.getBorderLineDash();return n&&(i.lineDash=n),i;},getBorderLineDash:function getBorderLineDash(){var t=this.get("borderType");return"solid"===t||null==t?null:"dashed"===t?[5,5]:[1,1];}},hl=b,cl=La();function dl(t,e,i){this.parentModel=e,this.ecModel=i,this.option=t;}function fl(t,e,i){for(var n=0;n<e.length&&(!e[n]||null!=(t=t&&"object"==_typeof(t)?t[e[n]]:null));n++){;}return null==t&&i&&(t=i.get(e)),t;}function pl(t,e){var i=cl(t).getParent;return i?i.call(t,e):t.parentModel;}dl.prototype={constructor:dl,init:null,mergeOption:function mergeOption(t){m(this.option,t,!0);},get:function get(t,e){return null==t?this.option:fl(this.option,this.parsePath(t),!e&&pl(this,t));},getShallow:function getShallow(t,e){var i=this.option,n=null==i?i:i[t],a=!e&&pl(this,t);return null==n&&a&&(n=a.getShallow(t)),n;},getModel:function getModel(t,e){var i;return new dl(null==t?this.option:fl(this.option,t=this.parsePath(t)),e=e||(i=pl(this,t))&&i.getModel(t),this.ecModel);},isEmpty:function isEmpty(){return null==this.option;},restoreData:function restoreData(){},clone:function clone(){return new this.constructor(D(this.option));},setReadOnly:function setReadOnly(t){},parsePath:function parsePath(t){return"string"==typeof t&&(t=t.split(".")),t;},customizeGetParent:function customizeGetParent(t){cl(this).getParent=t;},isAnimationEnabled:function isAnimationEnabled(){if(!v.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled();}}},Ga(dl),Wa(dl),hl(dl,ja),hl(dl,Ka),hl(dl,sl),hl(dl,ul);var gl=0;function ml(t){return[t||"",gl++,Math.random().toFixed(5)].join("_");}var vl=1e-4;function yl(t,e,i,n){var a=e[1]-e[0],o=i[1]-i[0];if(0==a)return 0==o?i[0]:(i[0]+i[1])/2;if(n){if(0<a){if(t<=e[0])return i[0];if(t>=e[1])return i[1];}else{if(t>=e[0])return i[0];if(t<=e[1])return i[1];}}else{if(t===e[0])return i[0];if(t===e[1])return i[1];}return(t-e[0])/a*o+i[0];}function xl(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%";}return"string"==typeof t?function(t){return t.replace(/^\s+|\s+$/g,"");}(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t;}function _l(t,e,i){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),i?t:+t;}function wl(t){return t.sort(function(t,e){return t-e;}),t;}function bl(t){if(t=+t,isNaN(t))return 0;for(var e=1,i=0;Math.round(t*e)/e!==t;){e*=10,i++;}return i;}function Sl(t){var e=t.toString(),i=e.indexOf("e");if(0<i){var n=+e.slice(i+1);return n<0?-n:0;}var a=e.indexOf(".");return a<0?0:e.length-1-a;}function Ml(t,e){var i=Math.log,n=Math.LN10,a=Math.floor(i(t[1]-t[0])/n),o=Math.round(i(Math.abs(e[1]-e[0]))/n),r=Math.min(Math.max(-a+o,0),20);return isFinite(r)?r:20;}function Il(t,e,i){if(!t[e])return 0;var n=S(t,function(t,e){return t+(isNaN(e)?0:e);},0);if(0===n)return 0;for(var a=Math.pow(10,i),o=N(t,function(t){return(isNaN(t)?0:t)/n*a*100;}),r=100*a,s=N(o,function(t){return Math.floor(t);}),l=S(s,function(t,e){return t+e;},0),u=N(o,function(t,e){return t-s[e];});l<r;){for(var h=Number.NEGATIVE_INFINITY,c=null,d=0,f=u.length;d<f;++d){u[d]>h&&(h=u[d],c=d);}++s[c],u[c]=0,++l;}return s[e]/a;}var Al=9007199254740991;function Tl(t){var e=2*Math.PI;return(t%e+e)%e;}function Dl(t){return-vl<t&&t<vl;}var Cl=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Ll(t){if(t instanceof Date)return t;if("string"!=typeof t)return null==t?new Date(NaN):new Date(Math.round(t));var e=Cl.exec(t);if(!e)return new Date(NaN);if(e[8]){var i=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(i-=e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,i,+(e[5]||0),+e[6]||0,+e[7]||0));}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,+e[7]||0);}function kl(t){return Math.pow(10,Pl(t));}function Pl(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return 10<=t/Math.pow(10,e)&&e++,e;}function Nl(t,e){var i=Pl(t),n=Math.pow(10,i),a=t/n;return t=(e?a<1.5?1:a<2.5?2:a<4?3:a<7?5:10:a<1?1:a<2?2:a<3?3:a<5?5:10)*n,-20<=i?+t.toFixed(i<0?-i:0):t;}function Ol(t){t.sort(function(t,e){return function t(e,i,n){return e.interval[n]<i.interval[n]||e.interval[n]===i.interval[n]&&(e.close[n]-i.close[n]==(n?-1:1)||!n&&t(e,i,1));}(t,e,0)?-1:1;});for(var e=-1/0,i=1,n=0;n<t.length;){for(var a=t[n].interval,o=t[n].close,r=0;r<2;r++){a[r]<=e&&(a[r]=e,o[r]=r?1:1-i),e=a[r],i=o[r];}a[0]===a[1]&&o[0]*o[1]!=1?t.splice(n,1):n++;}return t;}function El(t){return 0<=t-parseFloat(t);}var Rl=(Object.freeze||Object)({linearMap:yl,parsePercent:xl,round:_l,asc:wl,getPrecision:bl,getPrecisionSafe:Sl,getPixelPrecision:Ml,getPercentWithPrecision:Il,MAX_SAFE_INTEGER:Al,remRadian:Tl,isRadianAroundZero:Dl,parseDate:Ll,quantity:kl,quantityExponent:Pl,nice:Nl,quantile:function quantile(t,e){var i=(t.length-1)*e+1,n=Math.floor(i),a=+t[n-1],o=i-n;return o?a+o*(t[n]-a):a;},reformIntervals:Ol,isNumeric:El});function zl(t){return isNaN(t)?"-":(t=(t+"").split("."))[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(1<t.length?"."+t[1]:"");}function Bl(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase();}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t;}var Vl=X,Gl=/([&<>"'])/g,Fl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Wl(t){return null==t?"":(t+"").replace(Gl,function(t,e){return Fl[e];});}function Hl(t,e){return"{"+t+(null==e?"":e)+"}";}var Zl=["a","b","c","d","e","f","g"];function Ul(t,e,i){k(e)||(e=[e]);var n=e.length;if(!n)return"";for(var a=e[0].$vars||[],o=0;o<a.length;o++){var r=Zl[o];t=t.replace(Hl(r),Hl(r,0));}for(var s=0;s<n;s++){for(var l=0;l<a.length;l++){var u=e[s][a[l]];t=t.replace(Hl(Zl[l],s),i?Wl(u):u);}}return t;}function Xl(i,t,n){return E(t,function(t,e){i=i.replace("{"+e+"}",n?Wl(t):t);}),i;}function Yl(t,e){var i=(t=R(t)?{color:t,extraCssText:e}:t||{}).color,n=t.type,a=(e=t.extraCssText,t.renderMode||"html"),o=t.markerId||"X";return i?"html"===a?"subItem"===n?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Wl(i)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+Wl(i)+";"+(e||"")+'"></span>':{renderMode:a,content:"{marker"+o+"|}  ",style:{color:i}}:"";}function jl(t,e){return"0000".substr(0,e-(t+="").length)+t;}function ql(t,e,i){"week"!==t&&"month"!==t&&"quarter"!==t&&"half-year"!==t&&"year"!==t||(t="MM-dd\nyyyy");var n=Ll(e),a=i?"UTC":"",o=n["get"+a+"FullYear"](),r=n["get"+a+"Month"]()+1,s=n["get"+a+"Date"](),l=n["get"+a+"Hours"](),u=n["get"+a+"Minutes"](),h=n["get"+a+"Seconds"](),c=n["get"+a+"Milliseconds"]();return t=t.replace("MM",jl(r,2)).replace("M",r).replace("yyyy",o).replace("yy",o%100).replace("dd",jl(s,2)).replace("d",s).replace("hh",jl(l,2)).replace("h",l).replace("mm",jl(u,2)).replace("m",u).replace("ss",jl(h,2)).replace("s",h).replace("SSS",jl(c,3));}function Kl(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t;}var $l=fn;var Jl=(Object.freeze||Object)({addCommas:zl,toCamelCase:Bl,normalizeCssArray:Vl,encodeHTML:Wl,formatTpl:Ul,formatTplSimple:Xl,getTooltipMarker:Yl,formatTime:ql,capitalFirst:Kl,truncateText:$l,getTextBoundingRect:function getTextBoundingRect(t){return un(t.text,t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.textLineHeight,t.rich,t.truncate);},getTextRect:function getTextRect(t,e,i,n,a,o,r,s){return un(t,e,i,n,a,s,o,r);}}),Ql=E,tu=["left","right","top","bottom","width","height"],eu=[["width","left","right"],["height","top","bottom"]];function iu(h,c,d,f,p){var g=0,m=0;null==f&&(f=1/0),null==p&&(p=1/0);var v=0;c.eachChild(function(t,e){var i,n,a=t.position,o=t.getBoundingRect(),r=c.childAt(e+1),s=r&&r.getBoundingRect();if("horizontal"===h){var l=o.width+(s?-s.x+o.x:0);v=f<(i=g+l)||t.newline?(g=0,i=l,m+=v+d,o.height):Math.max(v,o.height);}else{var u=o.height+(s?-s.y+o.y:0);v=p<(n=m+u)||t.newline?(g+=v+d,m=0,n=u,o.width):Math.max(v,o.width);}t.newline||(a[0]=g,a[1]=m,"horizontal"===h?g=i+d:m=n+d);});}var nu=iu;A(iu,"vertical"),A(iu,"horizontal");function au(t,e,i){i=Vl(i||0);var n=e.width,a=e.height,o=xl(t.left,n),r=xl(t.top,a),s=xl(t.right,n),l=xl(t.bottom,a),u=xl(t.width,n),h=xl(t.height,a),c=i[2]+i[0],d=i[1]+i[3],f=t.aspect;switch(isNaN(u)&&(u=n-s-d-o),isNaN(h)&&(h=a-l-c-r),null!=f&&(isNaN(u)&&isNaN(h)&&(n/a<f?u=.8*n:h=.8*a),isNaN(u)&&(u=f*h),isNaN(h)&&(h=u/f)),isNaN(o)&&(o=n-s-u-d),isNaN(r)&&(r=a-l-h-c),t.left||t.right){case"center":o=n/2-u/2-i[3];break;case"right":o=n-u-d;}switch(t.top||t.bottom){case"middle":case"center":r=a/2-h/2-i[0];break;case"bottom":r=a-h-c;}o=o||0,r=r||0,isNaN(u)&&(u=n-d-o-(s||0)),isNaN(h)&&(h=a-c-r-(l||0));var p=new bi(o+i[3],r+i[0],u,h);return p.margin=i,p;}function ou(t,e,i,n,a){var o=!a||!a.hv||a.hv[0],r=!a||!a.hv||a.hv[1],s=a&&a.boundingMode||"all";if(o||r){var l;if("raw"===s)l="group"===t.type?new bi(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(l=t.getBoundingRect(),t.needLocalTransform()){var u=t.getLocalTransform();(l=l.clone()).applyTransform(u);}e=au(C({width:l.width,height:l.height},e),i,n);var h=t.position,c=o?e.x-l.x:0,d=r?e.y-l.y:0;t.attr("position","raw"===s?[c,d]:[h[0]+c,h[1]+d]);}}function ru(l,u,t){z(t)||(t={});var h=t.ignoreSize;k(h)||(h=[h,h]);var e=n(eu[0],0),i=n(eu[1],1);function n(t,e){var i={},n=0,a={},o=0;if(Ql(t,function(t){a[t]=l[t];}),Ql(t,function(t){c(u,t)&&(i[t]=a[t]=u[t]),d(i,t)&&n++,d(a,t)&&o++;}),h[e])return d(u,t[1])?a[t[2]]=null:d(u,t[2])&&(a[t[1]]=null),a;if(2!==o&&n){if(2<=n)return i;for(var r=0;r<t.length;r++){var s=t[r];if(!c(i,s)&&c(l,s)){i[s]=l[s];break;}}return i;}return a;}function c(t,e){return t.hasOwnProperty(e);}function d(t,e){return null!=t[e]&&"auto"!==t[e];}function a(t,e,i){Ql(t,function(t){e[t]=i[t];});}a(eu[0],l,e),a(eu[1],l,i);}function su(t){return lu({},t);}function lu(e,i){return i&&e&&Ql(tu,function(t){i.hasOwnProperty(t)&&(e[t]=i[t]);}),e;}var uu,hu,cu,du=La(),fu=dl.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function $constructor(t,e,i,n){dl.call(this,t,e,i,n),this.uid=ml("ec_cpt_model");},init:function init(t,e,i,n){this.mergeDefaultAndTheme(t,i);},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){var i=this.layoutMode,n=i?su(t):{};m(t,e.getTheme().get(this.mainType)),m(t,this.getDefaultOption()),i&&ru(t,n,i);},mergeOption:function mergeOption(t,e){m(this.option,t,!0);var i=this.layoutMode;i&&ru(this.option,t,i);},optionUpdated:function optionUpdated(t,e){},getDefaultOption:function getDefaultOption(){var t=du(this);if(!t.defaultOption){for(var e=[],i=this.constructor;i;){var n=i.prototype.defaultOption;n&&e.push(n),i=i.superClass;}for(var a={},o=e.length-1;0<=o;o--){a=m(a,e[o],!0);}t.defaultOption=a;}return t.defaultOption;},getReferringComponents:function getReferringComponents(t){return this.ecModel.queryComponents({mainType:t,index:this.get(t+"Index",!0),id:this.get(t+"Id",!0)});}});function pu(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e];}Ua(fu,{registerWhenExtend:!0}),hu={},(uu=fu).registerSubTypeDefaulter=function(t,e){t=Va(t),hu[t.main]=e;},uu.determineSubType=function(t,e){var i=e.type;if(!i){var n=Va(t).main;uu.hasSubTypes(t)&&hu[n]&&(i=hu[n](e));}return i;},cu=function cu(t){var e=[];E(fu.getClassesByMainType(t),function(t){e=e.concat(t.prototype.dependencies||[]);}),e=N(e,function(t){return Va(t).main;}),"dataset"!==t&&_(e,"dataset")<=0&&e.unshift("dataset");return e;},fu.topologicalTravel=function(t,e,i,n){if(t.length){var a=function(e){var a={},o=[];return E(e,function(i){var n=pu(a,i),t=function(t,e){var i=[];return E(t,function(t){0<=_(e,t)&&i.push(t);}),i;}(n.originalDeps=cu(i),e);n.entryCount=t.length,0===n.entryCount&&o.push(i),E(t,function(t){_(n.predecessor,t)<0&&n.predecessor.push(t);var e=pu(a,t);_(e.successor,t)<0&&e.successor.push(i);});}),{graph:a,noEntryList:o};}(e),o=a.graph,r=a.noEntryList,s={};for(E(t,function(t){s[t]=!0;});r.length;){var l=r.pop(),u=o[l],h=!!s[l];h&&(i.call(n,l,u.originalDeps.slice()),delete s[l]),E(u.successor,h?d:c);}E(s,function(){throw new Error("Circle dependency may exists");});}function c(t){o[t].entryCount--,0===o[t].entryCount&&r.push(t);}function d(t){s[t]=!0,c(t);}},b(fu,{getBoxLayoutParams:function getBoxLayoutParams(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")};}});var gu="";"undefined"!=typeof navigator&&(gu=navigator.platform||"");var mu={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],gradientColor:["#f6efa6","#d88273","#bf444c"],textStyle:{fontFamily:gu.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},vu=La();var yu={clearColorPalette:function clearColorPalette(){vu(this).colorIdx=0,vu(this).colorNameMap={};},getColorFromPalette:function getColorFromPalette(t,e,i){var n=vu(e=e||this),a=n.colorIdx||0,o=n.colorNameMap=n.colorNameMap||{};if(o.hasOwnProperty(t))return o[t];var r=wa(this.get("color",!0)),s=this.get("colorLayer",!0),l=null!=i&&s?function(t,e){for(var i=t.length,n=0;n<i;n++){if(t[n].length>e)return t[n];}return t[i-1];}(s,i):r;if((l=l||r)&&l.length){var u=l[a];return t&&(o[t]=u),n.colorIdx=(a+1)%l.length,u;}}};function xu(t){var e=t.get("coordinateSystem"),i={coordSysName:e,coordSysDims:[],axisMap:Q(),categoryAxisMap:Q()},n=_u[e];if(n)return n(t,i,i.axisMap,i.categoryAxisMap),i;}var _u={cartesian2d:function cartesian2d(t,e,i,n){var a=t.getReferringComponents("xAxis")[0],o=t.getReferringComponents("yAxis")[0];e.coordSysDims=["x","y"],i.set("x",a),i.set("y",o),wu(a)&&(n.set("x",a),e.firstCategoryDimIndex=0),wu(o)&&(n.set("y",o),e.firstCategoryDimIndex=1);},singleAxis:function singleAxis(t,e,i,n){var a=t.getReferringComponents("singleAxis")[0];e.coordSysDims=["single"],i.set("single",a),wu(a)&&(n.set("single",a),e.firstCategoryDimIndex=0);},polar:function polar(t,e,i,n){var a=t.getReferringComponents("polar")[0],o=a.findAxisModel("radiusAxis"),r=a.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],i.set("radius",o),i.set("angle",r),wu(o)&&(n.set("radius",o),e.firstCategoryDimIndex=0),wu(r)&&(n.set("angle",r),e.firstCategoryDimIndex=1);},geo:function geo(t,e,i,n){e.coordSysDims=["lng","lat"];},parallel:function parallel(t,a,o,r){var s=t.ecModel,e=s.getComponent("parallel",t.get("parallelIndex")),l=a.coordSysDims=e.dimensions.slice();E(e.parallelAxisIndex,function(t,e){var i=s.getComponent("parallelAxis",t),n=l[e];o.set(n,i),wu(i)&&null==a.firstCategoryDimIndex&&(r.set(n,i),a.firstCategoryDimIndex=e);});}};function wu(t){return"category"===t.get("type");}var bu="original",Su="arrayRows",Mu="objectRows",Iu="keyedColumns",Au="unknown",Tu="typedArray",Du="column",Cu="row";function Lu(t){this.fromDataset=t.fromDataset,this.data=t.data||(t.sourceFormat===Iu?{}:[]),this.sourceFormat=t.sourceFormat||Au,this.seriesLayoutBy=t.seriesLayoutBy||Du,this.dimensionsDefine=t.dimensionsDefine,this.encodeDefine=t.encodeDefine&&Q(t.encodeDefine),this.startIndex=t.startIndex||0,this.dimensionsDetectCount=t.dimensionsDetectCount;}Lu.seriesDataToSource=function(t){return new Lu({data:t,sourceFormat:V(t)?Tu:bu,fromDataset:!1});},Wa(Lu);var ku=La();function Pu(t){var e=t.option,i=e.data,n=V(i)?Tu:bu,a=!1,o=e.seriesLayoutBy,r=e.sourceHeader,s=e.dimensions,l=function(t){var e=t.option;if(!e.data)return t.ecModel.getComponent("dataset",e.datasetIndex||0);}(t);if(l){var u=l.option;i=u.source,n=ku(l).sourceFormat,a=!0,o=o||u.seriesLayoutBy,null==r&&(r=u.sourceHeader),s=s||u.dimensions;}var h=function(t,e,i,n,a){if(!t)return{dimensionsDefine:Nu(a)};var o,r,s,l;if(e===Su)"auto"===n||null==n?Ou(function(t){null!=t&&"-"!==t&&(R(t)?null==r&&(r=1):r=0);},i,t,10):r=n?1:0,a||1!==r||(a=[],Ou(function(t,e){a[e]=null!=t?t:"";},i,t)),o=a?a.length:i===Cu?t.length:t[0]?t[0].length:null;else if(e===Mu)a||(a=function(t){var e,i=0;for(;i<t.length&&!(e=t[i++]);){;}if(e){var n=[];return E(e,function(t,e){n.push(e);}),n;}}(t),s=!0);else if(e===Iu)a||(a=[],s=!0,E(t,function(t,e){a.push(e);}));else if(e===bu){var u=Ma(t[0]);o=k(u)&&u.length||1;}s&&E(a,function(t,e){"name"===(z(t)?t.name:t)&&(l=e);});return{startIndex:r,dimensionsDefine:Nu(a),dimensionsDetectCount:o,potentialNameDimIndex:l};}(i,n,o,r,s),c=e.encode;!c&&l&&(c=function(t,e,i,n,a,o){var r=xu(t),s={},l=[],u=[],h=t.subType,c=Q(["pie","map","funnel"]),d=Q(["line","bar","pictorialBar","scatter","effectScatter","candlestick","boxplot"]);if(r&&null!=d.get(h)){var f=t.ecModel,p=ku(f).datasetMap,g=e.uid+"_"+a,m=p.get(g)||p.set(g,{categoryWayDim:1,valueWayDim:0});E(r.coordSysDims,function(t){if(null==r.firstCategoryDimIndex){var e=m.valueWayDim++;s[t]=e,u.push(e);}else if(r.categoryAxisMap.get(t))s[t]=0,l.push(0);else{e=m.categoryWayDim++;s[t]=e,u.push(e);}});}else if(null!=c.get(h)){for(var v,y=0;y<5&&null==v;y++){Eu(i,n,a,o.dimensionsDefine,o.startIndex,y)||(v=y);}if(null!=v){s.value=v;var x=o.potentialNameDimIndex||Math.max(v-1,0);u.push(x),l.push(x);}}return l.length&&(s.itemName=l),u.length&&(s.seriesName=u),s;}(t,l,i,n,o,h)),ku(t).source=new Lu({data:i,fromDataset:a,seriesLayoutBy:o,sourceFormat:n,dimensionsDefine:h.dimensionsDefine,startIndex:h.startIndex,dimensionsDetectCount:h.dimensionsDetectCount,encodeDefine:c});}function Nu(t){if(t){var n=Q();return N(t,function(t,e){if(null==(t=L({},z(t)?t:{name:t})).name)return t;t.name+="",null==t.displayName&&(t.displayName=t.name);var i=n.get(t.name);return i?t.name+="-"+i.count++:n.set(t.name,{count:1}),t;});}}function Ou(t,e,i,n){if(null==n&&(n=1/0),e===Cu)for(var a=0;a<i.length&&a<n;a++){t(i[a]?i[a][0]:null,a);}else{var o=i[0]||[];for(a=0;a<o.length&&a<n;a++){t(o[a],a);}}}function Eu(t,e,i,n,a,o){var r,s;if(V(t))return!1;if(n&&(s=z(s=n[o])?s.name:s),e===Su){if(i===Cu){for(var l=t[o],u=0;u<(l||[]).length&&u<5;u++){if(null!=(r=f(l[a+u])))return r;}}else for(u=0;u<t.length&&u<5;u++){var h=t[a+u];if(h&&null!=(r=f(h[o])))return r;}}else if(e===Mu){if(!s)return;for(u=0;u<t.length&&u<5;u++){if((c=t[u])&&null!=(r=f(c[s])))return r;}}else if(e===Iu){if(!s)return;if(!(l=t[s])||V(l))return!1;for(u=0;u<l.length&&u<5;u++){if(null!=(r=f(l[u])))return r;}}else if(e===bu)for(u=0;u<t.length&&u<5;u++){var c,d=Ma(c=t[u]);if(!k(d))return!1;if(null!=(r=f(d[o])))return r;}function f(t){return(null==t||!isFinite(t)||""===t)&&(!(!R(t)||"-"===t)||void 0);}return!1;}var Ru="\0_ec_inner",zu=dl.extend({init:function init(t,e,i,n){i=i||{},this.option=null,this._theme=new dl(i),this._optionManager=n;},setOption:function setOption(t,e){Y(!(Ru in t),"please use chart.getOption()"),this._optionManager.setOption(t,e),this.resetOption(null);},resetOption:function resetOption(t){var e=!1,i=this._optionManager;if(!t||"recreate"===t){var n=i.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this.mergeOption(n)):function(t){t=t,this.option={},this.option[Ru]=1,this._componentsMap=Q({series:[]}),this._seriesIndices,this._seriesIndicesMap,function(i,t){var n=i.color&&!i.colorLayer;E(t,function(t,e){"colorLayer"===e&&n||fu.hasClass(e)||("object"==_typeof(t)?i[e]=i[e]?m(i[e],t,!1):D(t):null==i[e]&&(i[e]=t));});}(t,this._theme.option),m(t,mu,!1),this.mergeOption(t);}.call(this,n),e=!0;}if("timeline"!==t&&"media"!==t||this.restoreData(),!t||"recreate"===t||"timeline"===t){var a=i.getTimelineOption(this);a&&(this.mergeOption(a),e=!0);}if(!t||"recreate"===t||"media"===t){var o=i.getMediaOption(this,this._api);o.length&&E(o,function(t){this.mergeOption(t,e=!0);},this);}return e;},mergeOption:function mergeOption(n){var l=this.option,u=this._componentsMap,i=[];!function(t){ku(t).datasetMap=Q();}(this),E(n,function(t,e){null!=t&&(fu.hasClass(e)?e&&i.push(e):l[e]=null==l[e]?D(t):m(l[e],t,!0));}),fu.topologicalTravel(i,fu.getAllClassMainTypes(),function(r,t){var e=wa(n[r]),i=Ia(u.get(r),e);Aa(i),E(i,function(t,e){var i=t.option;z(i)&&(t.keyInfo.mainType=r,t.keyInfo.subType=function(t,e,i){return e.type?e.type:i?i.subType:fu.determineSubType(t,e);}(r,i,t.exist));});var s=function(e,t){k(t)||(t=t?[t]:[]);var i={};return E(t,function(t){i[t]=(e.get(t)||[]).slice();}),i;}(u,t);l[r]=[],u.set(r,[]),E(i,function(t,e){var i=t.exist,n=t.option;if(Y(z(n)||i,"Empty component definition"),n){var a=fu.getClass(r,t.keyInfo.subType,!0);if(i&&i.constructor===a)i.name=t.keyInfo.name,i.mergeOption(n,this),i.optionUpdated(n,!1);else{var o=L({dependentModels:s,componentIndex:e},t.keyInfo);L(i=new a(n,this,this,o),o),i.init(n,this,this,o),i.optionUpdated(null,!0);}}else i.mergeOption({},this),i.optionUpdated({},!1);u.get(r)[e]=i,l[r][e]=i.option;},this),"series"===r&&Bu(this,u.get("series"));},this),this._seriesIndicesMap=Q(this._seriesIndices=this._seriesIndices||[]);},getOption:function getOption(){var n=D(this.option);return E(n,function(t,e){if(fu.hasClass(e)){for(var i=(t=wa(t)).length-1;0<=i;i--){Da(t[i])&&t.splice(i,1);}n[e]=t;}}),delete n[Ru],n;},getTheme:function getTheme(){return this._theme;},getComponent:function getComponent(t,e){var i=this._componentsMap.get(t);if(i)return i[e||0];},queryComponents:function queryComponents(t){var e=t.mainType;if(!e)return[];var i,n=t.index,a=t.id,o=t.name,r=this._componentsMap.get(e);if(!r||!r.length)return[];if(null!=n)k(n)||(n=[n]),i=M(N(n,function(t){return r[t];}),function(t){return!!t;});else if(null!=a){var s=k(a);i=M(r,function(t){return s&&0<=_(a,t.id)||!s&&t.id===a;});}else if(null!=o){var l=k(o);i=M(r,function(t){return l&&0<=_(o,t.name)||!l&&t.name===o;});}else i=r.slice();return Vu(i,t);},findComponents:function findComponents(t){var e,i,n,a,o,r=t.query,s=t.mainType,l=(i=s+"Index",n=s+"Id",a=s+"Name",!(e=r)||null==e[i]&&null==e[n]&&null==e[a]?null:{mainType:s,index:e[i],id:e[n],name:e[a]}),u=l?this.queryComponents(l):this._componentsMap.get(s);return o=Vu(u,t),t.filter?M(o,t.filter):o;},eachComponent:function eachComponent(t,n,a){var e=this._componentsMap;if("function"==typeof t)a=n,n=t,e.each(function(t,i){E(t,function(t,e){n.call(a,i,t,e);});});else if(R(t))E(e.get(t),n,a);else if(z(t)){E(this.findComponents(t),n,a);}},getSeriesByName:function getSeriesByName(e){return M(this._componentsMap.get("series"),function(t){return t.name===e;});},getSeriesByIndex:function getSeriesByIndex(t){return this._componentsMap.get("series")[t];},getSeriesByType:function getSeriesByType(e){return M(this._componentsMap.get("series"),function(t){return t.subType===e;});},getSeries:function getSeries(){return this._componentsMap.get("series").slice();},getSeriesCount:function getSeriesCount(){return this._componentsMap.get("series").length;},eachSeries:function eachSeries(i,n){E(this._seriesIndices,function(t){var e=this._componentsMap.get("series")[t];i.call(n,e,t);},this);},eachRawSeries:function eachRawSeries(t,e){E(this._componentsMap.get("series"),t,e);},eachSeriesByType:function eachSeriesByType(i,n,a){E(this._seriesIndices,function(t){var e=this._componentsMap.get("series")[t];e.subType===i&&n.call(a,e,t);},this);},eachRawSeriesByType:function eachRawSeriesByType(t,e,i){return E(this.getSeriesByType(t),e,i);},isSeriesFiltered:function isSeriesFiltered(t){return null==this._seriesIndicesMap.get(t.componentIndex);},getCurrentSeriesIndices:function getCurrentSeriesIndices(){return(this._seriesIndices||[]).slice();},filterSeries:function filterSeries(t,e){var i=M(this._componentsMap.get("series"),t,e);Bu(this,i);},restoreData:function restoreData(i){var n=this._componentsMap;Bu(this,n.get("series"));var a=[];n.each(function(t,e){a.push(e);}),fu.topologicalTravel(a,fu.getAllClassMainTypes(),function(e,t){E(n.get(e),function(t){"series"===e&&function(t,e){if(e){var i=e.seiresIndex,n=e.seriesId,a=e.seriesName;return null!=i&&t.componentIndex!==i||null!=n&&t.id!==n||null!=a&&t.name!==a;}}(t,i)||t.restoreData();});});}});function Bu(t,e){t._seriesIndicesMap=Q(t._seriesIndices=N(e,function(t){return t.componentIndex;})||[]);}function Vu(t,e){return e.hasOwnProperty("subType")?M(t,function(t){return t.subType===e.subType;}):t;}b(zu,yu);var Gu=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"];function Fu(e){E(Gu,function(t){this[t]=T(e[t],e);},this);}var Wu={};function Hu(){this._coordinateSystems=[];}Hu.prototype={constructor:Hu,create:function create(n,a){var o=[];E(Wu,function(t,e){var i=t.create(n,a);o=o.concat(i||[]);}),this._coordinateSystems=o;},update:function update(e,i){E(this._coordinateSystems,function(t){t.update&&t.update(e,i);});},getCoordinateSystems:function getCoordinateSystems(){return this._coordinateSystems.slice();}},Hu.register=function(t,e){Wu[t]=e;},Hu.get=function(t){return Wu[t];};var Zu=E,Uu=D,Xu=N,Yu=m,ju=/^(min|max)?(.+)$/;function qu(t){this._api=t,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption;}function Ku(t,e,i){var o={width:e,height:i,aspectratio:e/i},r=!0;return E(t,function(t,e){var i=e.match(ju);if(i&&i[1]&&i[2]){var n=i[1],a=i[2].toLowerCase();!function(t,e,i){return"min"===i?e<=t:"max"===i?t<=e:t===e;}(o[a],t,n)&&(r=!1);}}),r;}qu.prototype={constructor:qu,setOption:function setOption(t,e){t&&E(wa(t.series),function(t){t&&t.data&&V(t.data)&&K(t.data);}),t=Uu(t);var i=this._optionBackup,n=function(t,i,n){var e,a,o=[],r=[],s=t.timeline;t.baseOption&&(a=t.baseOption);(s||t.options)&&(a=a||{},o=(t.options||[]).slice());if(t.media){a=a||{};var l=t.media;Zu(l,function(t){t&&t.option&&(t.query?r.push(t):e=e||t);});}a=a||t;a.timeline||(a.timeline=s);return Zu([a].concat(o).concat(N(r,function(t){return t.option;})),function(e){Zu(i,function(t){t(e,n);});}),{baseOption:a,timelineOptions:o,mediaDefault:e,mediaList:r};}.call(this,t,e,!i);this._newBaseOption=n.baseOption,i?(function(a,t){Zu(t=t||{},function(t,e){if(null!=t){var i=a[e];if(fu.hasClass(e)){t=wa(t);var n=Ia(i=wa(i),t);a[e]=Xu(n,function(t){return t.option&&t.exist?Yu(t.exist,t.option,!0):t.exist||t.option;});}else a[e]=Yu(i,t,!0);}});}(i.baseOption,n.baseOption),n.timelineOptions.length&&(i.timelineOptions=n.timelineOptions),n.mediaList.length&&(i.mediaList=n.mediaList),n.mediaDefault&&(i.mediaDefault=n.mediaDefault)):this._optionBackup=n;},mountOption:function mountOption(t){var e=this._optionBackup;return this._timelineOptions=Xu(e.timelineOptions,Uu),this._mediaList=Xu(e.mediaList,Uu),this._mediaDefault=Uu(e.mediaDefault),this._currentMediaIndices=[],Uu(t?e.baseOption:this._newBaseOption);},getTimelineOption:function getTimelineOption(t){var e,i=this._timelineOptions;if(i.length){var n=t.getComponent("timeline");n&&(e=Uu(i[n.getCurrentIndex()],!0));}return e;},getMediaOption:function getMediaOption(t){var e=this._api.getWidth(),i=this._api.getHeight(),n=this._mediaList,a=this._mediaDefault,o=[],r=[];if(!n.length&&!a)return r;for(var s=0,l=n.length;s<l;s++){Ku(n[s].query,e,i)&&o.push(s);}return!o.length&&a&&(o=[-1]),o.length&&!function(t,e){return t.join(",")===e.join(",");}(o,this._currentMediaIndices)&&(r=Xu(o,function(t){return Uu(-1===t?a.option:n[t].option);})),this._currentMediaIndices=o,r;}};var $u=E,Ju=z,Qu=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function th(t){var e=t&&t.itemStyle;if(e)for(var i=0,n=Qu.length;i<n;i++){var a=Qu[i],o=e.normal,r=e.emphasis;o&&o[a]&&(t[a]=t[a]||{},t[a].normal?m(t[a].normal,o[a]):t[a].normal=o[a],o[a]=null),r&&r[a]&&(t[a]=t[a]||{},t[a].emphasis?m(t[a].emphasis,r[a]):t[a].emphasis=r[a],r[a]=null);}}function eh(t,e,i){if(t&&t[e]&&(t[e].normal||t[e].emphasis)){var n=t[e].normal,a=t[e].emphasis;n&&(i?(t[e].normal=t[e].emphasis=null,C(t[e],n)):t[e]=n),a&&(t.emphasis=t.emphasis||{},t.emphasis[e]=a);}}function ih(t){eh(t,"itemStyle"),eh(t,"lineStyle"),eh(t,"areaStyle"),eh(t,"label"),eh(t,"labelLine"),eh(t,"upperLabel"),eh(t,"edgeLabel");}function nh(t,e){var i=Ju(t)&&t[e],n=Ju(i)&&i.textStyle;if(n)for(var a=0,o=Sa.length;a<o;a++){e=Sa[a];n.hasOwnProperty(e)&&(i[e]=n[e]);}}function ah(t){t&&(ih(t),nh(t,"label"),t.emphasis&&nh(t.emphasis,"label"));}function oh(t){return k(t)?t:t?[t]:[];}function rh(t){return(k(t)?t[0]:t)||{};}function sh(e,t){$u(oh(e.series),function(t){Ju(t)&&function(t){if(Ju(t)){th(t),ih(t),nh(t,"label"),nh(t,"upperLabel"),nh(t,"edgeLabel"),t.emphasis&&(nh(t.emphasis,"label"),nh(t.emphasis,"upperLabel"),nh(t.emphasis,"edgeLabel")),(i=t.markPoint)&&(th(i),ah(i)),(n=t.markLine)&&(th(n),ah(n));var e=t.markArea;e&&ah(e);var i,n,a=t.data;if("graph"===t.type){a=a||t.nodes;var o=t.links||t.edges;if(o&&!V(o))for(var r=0;r<o.length;r++){ah(o[r]);}E(t.categories,function(t){ih(t);});}if(a&&!V(a))for(r=0;r<a.length;r++){ah(a[r]);}if((i=t.markPoint)&&i.data){var s=i.data;for(r=0;r<s.length;r++){ah(s[r]);}}if((n=t.markLine)&&n.data){var l=n.data;for(r=0;r<l.length;r++){k(l[r])?(ah(l[r][0]),ah(l[r][1])):ah(l[r]);}}"gauge"===t.type?(nh(t,"axisLabel"),nh(t,"title"),nh(t,"detail")):"treemap"===t.type?(eh(t.breadcrumb,"itemStyle"),E(t.levels,function(t){ih(t);})):"tree"===t.type&&ih(t.leaves);}}(t);});var i=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&i.push("valueAxis","categoryAxis","logAxis","timeAxis"),$u(i,function(t){$u(oh(e[t]),function(t){t&&(nh(t,"axisLabel"),nh(t.axisPointer,"label"));});}),$u(oh(e.parallel),function(t){var e=t&&t.parallelAxisDefault;nh(e,"axisLabel"),nh(e&&e.axisPointer,"label");}),$u(oh(e.calendar),function(t){eh(t,"itemStyle"),nh(t,"dayLabel"),nh(t,"monthLabel"),nh(t,"yearLabel");}),$u(oh(e.radar),function(t){nh(t,"name");}),$u(oh(e.geo),function(t){Ju(t)&&(ah(t),$u(oh(t.regions),function(t){ah(t);}));}),$u(oh(e.timeline),function(t){ah(t),eh(t,"label"),eh(t,"itemStyle"),eh(t,"controlStyle",!0);var e=t.data;k(e)&&E(e,function(t){z(t)&&(eh(t,"label"),eh(t,"itemStyle"));});}),$u(oh(e.toolbox),function(t){eh(t,"iconStyle"),$u(t.feature,function(t){eh(t,"iconStyle");});}),nh(rh(e.axisPointer),"label"),nh(rh(e.tooltip).axisPointer,"label");}function lh(e){E(uh,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]]);});}var uh=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],hh=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],ch=function ch(i,t){sh(i,t),i.series=wa(i.series),E(i.series,function(t){if(z(t)){var e=t.type;if("line"===e)null!=t.clipOverflow&&(t.clip=t.clipOverflow);else if("pie"===e||"gauge"===e)null!=t.clockWise&&(t.clockwise=t.clockWise);else if("gauge"===e){var i=function(t,e){e=e.split(",");for(var i=t,n=0;n<e.length&&null!=(i=i&&i[e[n]]);n++){;}return i;}(t,"pointer.color");null!=i&&function(t,e,i,n){e=e.split(",");for(var a,o=t,r=0;r<e.length-1;r++){null==o[a=e[r]]&&(o[a]={}),o=o[a];}!n&&null!=o[e[r]]||(o[e[r]]=i);}(t,"itemStyle.color",i);}lh(t);}}),i.dataRange&&(i.visualMap=i.dataRange),E(hh,function(t){var e=i[t];e&&(k(e)||(e=[e]),E(e,function(t){lh(t);}));});};function dh(m){E(m,function(h,c){var d=[],f=[NaN,NaN],t=[h.stackResultDimension,h.stackedOverDimension],p=h.data,g=h.isStackedByIndex,e=p.map(t,function(t,e,i){var n,a,o=p.get(h.stackedDimension,i);if(isNaN(o))return f;g?a=p.getRawIndex(i):n=p.get(h.stackedByDimension,i);for(var r=NaN,s=c-1;0<=s;s--){var l=m[s];if(g||(a=l.data.rawIndexOf(l.stackedByDimension,n)),0<=a){var u=l.data.getByRawIndex(l.stackResultDimension,a);if(0<=o&&0<u||o<=0&&u<0){o+=u,r=u;break;}}}return d[0]=o,d[1]=r,d;});p.hostModel.setData(e),h.data=e;});}function fh(t,e){Lu.isInstance(t)||(t=Lu.seriesDataToSource(t)),this._source=t;var i=this._data=t.data,n=t.sourceFormat;n===Tu&&(this._offset=0,this._dimSize=e,this._data=i),L(this,gh[n===Su?n+"_"+t.seriesLayoutBy:n]);}var ph=fh.prototype;ph.pure=!1;var gh={arrayRows_column:{pure:ph.persistent=!0,count:function count(){return Math.max(0,this._data.length-this._source.startIndex);},getItem:function getItem(t){return this._data[t+this._source.startIndex];},appendData:yh},arrayRows_row:{pure:!0,count:function count(){var t=this._data[0];return t?Math.max(0,t.length-this._source.startIndex):0;},getItem:function getItem(t){t+=this._source.startIndex;for(var e=[],i=this._data,n=0;n<i.length;n++){var a=i[n];e.push(a?a[t]:null);}return e;},appendData:function appendData(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".');}},objectRows:{pure:!0,count:mh,getItem:vh,appendData:yh},keyedColumns:{pure:!0,count:function count(){var t=this._source.dimensionsDefine[0].name,e=this._data[t];return e?e.length:0;},getItem:function getItem(t){for(var e=[],i=this._source.dimensionsDefine,n=0;n<i.length;n++){var a=this._data[i[n].name];e.push(a?a[t]:null);}return e;},appendData:function appendData(t){var a=this._data;E(t,function(t,e){for(var i=a[e]||(a[e]=[]),n=0;n<(t||[]).length;n++){i.push(t[n]);}});}},original:{count:mh,getItem:vh,appendData:yh},typedArray:{persistent:!(ph.getSource=function(){return this._source;}),pure:!0,count:function count(){return this._data?this._data.length/this._dimSize:0;},getItem:function getItem(t,e){t-=this._offset,e=e||[];for(var i=this._dimSize*t,n=0;n<this._dimSize;n++){e[n]=this._data[i+n];}return e;},appendData:function appendData(t){this._data=t;},clean:function clean(){this._offset+=this.count(),this._data=null;}}};function mh(){return this._data.length;}function vh(t){return this._data[t];}function yh(t){for(var e=0;e<t.length;e++){this._data.push(t[e]);}}var xh={arrayRows:_h,objectRows:function objectRows(t,e,i,n){return null!=i?t[n]:t;},keyedColumns:_h,original:function original(t,e,i,n){var a=Ma(t);return null!=i&&a instanceof Array?a[i]:a;},typedArray:_h};function _h(t,e,i,n){return null!=i?t[i]:t;}var wh={arrayRows:bh,objectRows:function objectRows(t,e,i,n){return Sh(t[e],this._dimensionInfos[e]);},keyedColumns:bh,original:function original(t,e,i,n){var a=t&&(null==t.value?t:t.value);return!this._rawData.pure&&function(t){return ya(t)&&!(t instanceof Array);}(t)&&(this.hasItemOption=!0),Sh(a instanceof Array?a[n]:a,this._dimensionInfos[e]);},typedArray:function typedArray(t,e,i,n){return t[n];}};function bh(t,e,i,n){return Sh(t[n],this._dimensionInfos[e]);}function Sh(t,e){var i=e&&e.type;if("ordinal"!==i)return"time"===i&&"number"!=typeof t&&null!=t&&"-"!==t&&(t=+Ll(t)),null==t||""===t?NaN:+t;var n=e&&e.ordinalMeta;return n?n.parseAndCollect(t):t;}function Mh(t,e,i){if(t){var n=t.getRawDataItem(e);if(null!=n){var a,o,r=t.getProvider().getSource().sourceFormat,s=t.getDimensionInfo(i);return s&&(a=s.name,o=s.index),xh[r](n,e,o,a);}}}function Ih(t,e,i){if(t){var n=t.getProvider().getSource().sourceFormat;if(n===bu||n===Mu){var a=t.getRawDataItem(e);return n!==bu||z(a)||(a=null),a?a[i]:void 0;}}}var Ah=/\{@(.+?)\}/g,Th={getDataParams:function getDataParams(t,e){var i=this.getData(e),n=this.getRawValue(t,e),a=i.getRawIndex(t),o=i.getName(t),r=i.getRawDataItem(t),s=i.getItemVisual(t,"color"),l=i.getItemVisual(t,"borderColor"),u=this.ecModel.getComponent("tooltip"),h=Ea(u&&u.get("renderMode")),c=this.mainType,d="series"===c,f=i.userOutput;return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:d?this.subType:null,seriesIndex:this.seriesIndex,seriesId:d?this.id:null,seriesName:d?this.name:null,name:o,dataIndex:a,data:r,dataType:e,value:n,color:s,borderColor:l,dimensionNames:f?f.dimensionNames:null,encode:f?f.encode:null,marker:Yl({color:s,renderMode:h}),$vars:["seriesName","name","value"]};},getFormattedLabel:function getFormattedLabel(n,t,e,i,a){t=t||"normal";var o=this.getData(e),r=o.getItemModel(n),s=this.getDataParams(n,e);null!=i&&s.value instanceof Array&&(s.value=s.value[i]);var l=r.get("normal"===t?[a||"label","formatter"]:[t,a||"label","formatter"]);return"function"==typeof l?(s.status=t,s.dimensionIndex=i,l(s)):"string"==typeof l?Ul(l,s).replace(Ah,function(t,e){var i=e.length;return"["===e.charAt(0)&&"]"===e.charAt(i-1)&&(e=+e.slice(1,i-1)),Mh(o,n,e);}):void 0;},getRawValue:function getRawValue(t,e){return Mh(this.getData(e),t);},formatTooltip:function formatTooltip(){}};function Dh(t){return new Ch(t);}function Ch(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0,this.context;}var Lh=Ch.prototype;Lh.perform=function(t){var e,i=this._upstream,n=t&&t.skip;if(this._dirty&&i){var a=this.context;a.data=a.outputData=i.context.outputData;}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!n&&(e=this._plan(this.context));var o,r=h(this._modBy),s=this._modDataCount||0,l=h(t&&t.modBy),u=t&&t.modDataCount||0;function h(t){return 1<=t||(t=1),t;}r===l&&s===u||(e="reset"),!this._dirty&&"reset"!==e||(this._dirty=!1,o=function(t,e){var i,n;t._dueIndex=t._outputDueEnd=t._dueEnd=0,t._settedOutputEnd=null,!e&&t._reset&&((i=t._reset(t.context))&&i.progress&&(n=i.forceFirstProgress,i=i.progress),k(i)&&!i.length&&(i=null));t._progress=i,t._modBy=t._modDataCount=null;var a=t._downstream;return a&&a.dirty(),n;}(this,n)),this._modBy=l,this._modDataCount=u;var c=t&&t.step;if(this._dueEnd=i?i._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,f=Math.min(null!=c?this._dueIndex+c:1/0,this._dueEnd);if(!n&&(o||d<f)){var p=this._progress;if(k(p))for(var g=0;g<p.length;g++){Gh(this,p[g],d,f,l,u);}else Gh(this,p,d,f,l,u);}this._dueIndex=f;var m=null!=this._settedOutputEnd?this._settedOutputEnd:f;this._outputDueEnd=m;}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished();};var kh,Ph,Nh,Oh,Eh,Rh,zh=Rh={reset:function reset(t,e,i,n){Ph=t,kh=e,Nh=i,Oh=n,Eh=Math.ceil(Oh/Nh),Rh.next=1<Nh&&0<Oh?Vh:Bh;}};function Bh(){return Ph<kh?Ph++:null;}function Vh(){var t=Ph%Eh*Nh+Math.ceil(Ph/Eh),e=kh<=Ph?null:t<Oh?t:Ph;return Ph++,e;}function Gh(t,e,i,n,a,o){zh.reset(i,n,a,o),t._callingProgress=e,t._callingProgress({start:i,end:n,count:n-i,next:zh.next},t.context);}Lh.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context);},Lh.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd;},Lh.pipe=function(t){this._downstream===t&&!this._dirty||((this._downstream=t)._upstream=this,t.dirty());},Lh.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0);},Lh.getUpstream=function(){return this._upstream;},Lh.getDownstream=function(){return this._downstream;},Lh.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t;};var Fh=La(),Wh=fu.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendDataProvider:null,visualColorAccessPath:"itemStyle.color",visualBorderColorAccessPath:"itemStyle.borderColor",layoutMode:null,init:function init(t,e,i,n){this.seriesIndex=this.componentIndex,this.dataTask=Dh({count:Zh,reset:Uh}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,i),Pu(this);var a=this.getInitialData(t,i);Yh(a,this),this.dataTask.context.data=a,Fh(this).dataBeforeProcessed=a,Hh(this);},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){var i=this.layoutMode,n=i?su(t):{},a=this.subType;fu.hasClass(a)&&(a+="Series"),m(t,e.getTheme().get(this.subType)),m(t,this.getDefaultOption()),ba(t,"label",["show"]),this.fillDataTextStyle(t.data),i&&ru(t,n,i);},mergeOption:function mergeOption(t,e){t=m(this.option,t,!0),this.fillDataTextStyle(t.data);var i=this.layoutMode;i&&ru(this.option,t,i),Pu(this);var n=this.getInitialData(t,e);Yh(n,this),this.dataTask.dirty(),this.dataTask.context.data=n,Fh(this).dataBeforeProcessed=n,Hh(this);},fillDataTextStyle:function fillDataTextStyle(t){if(t&&!V(t))for(var e=["show"],i=0;i<t.length;i++){t[i]&&t[i].label&&ba(t[i],"label",e);}},getInitialData:function getInitialData(){},appendData:function appendData(t){this.getRawData().appendData(t.data);},getData:function getData(t){var e=qh(this);if(e){var i=e.context.data;return null==t?i:i.getLinkedData(t);}return Fh(this).data;},setData:function setData(t){var e=qh(this);if(e){var i=e.context;i.data!==t&&e.modifyOutputEnd&&e.setOutputEnd(t.count()),i.outputData=t,e!==this.dataTask&&(i.data=t);}Fh(this).data=t;},getSource:function getSource(){return function(t){return ku(t).source;}(this);},getRawData:function getRawData(){return Fh(this).dataBeforeProcessed;},getBaseAxis:function getBaseAxis(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis();},formatTooltip:function formatTooltip(a,h,t,c){var d=this,e="html"===(c=c||"html")?"<br/>":"\n",f="richText"===c,p={},g=0;function i(t){return{renderMode:c,content:Wl(zl(t)),style:p};}var m=this.getData(),o=m.mapDimension("defaultedTooltip",!0),n=o.length,r=this.getRawValue(a),s=k(r),v=m.getItemVisual(a,"color");z(v)&&v.colorStops&&(v=(v.colorStops[0]||{}).color),v=v||"transparent";var l=(1<n||s&&!n?function(t){var l=S(t,function(t,e,i){var n=m.getDimensionInfo(i);return t|(n&&!1!==n.tooltip&&null!=n.displayName);},0),u=[];function e(t,e){var i=m.getDimensionInfo(e);if(i&&!1!==i.otherDims.tooltip){var n=i.type,a="sub"+d.seriesIndex+"at"+g,o=Yl({color:v,type:"subItem",renderMode:c,markerId:a}),r="string"==typeof o?o:o.content,s=(l?r+Wl(i.displayName||"-")+": ":"")+Wl("ordinal"===n?t+"":"time"===n?h?"":ql("yyyy/MM/dd hh:mm:ss",t):zl(t));s&&u.push(s),f&&(p[a]=v,++g);}}o.length?E(o,function(t){e(Mh(m,a,t),t);}):E(t,e);var i=l?f?"\n":"<br/>":"",n=i+u.join(i||", ");return{renderMode:c,content:n,style:p};}(r):i(n?Mh(m,a,o[0]):s?r[0]:r)).content,u=d.seriesIndex+"at"+g,y=Yl({color:v,type:"item",renderMode:c,markerId:u});p[u]=v,++g;var x=m.getName(a),_=this.name;Ta(this)||(_=""),_=_?Wl(_)+(h?": ":e):"";var w="string"==typeof y?y:y.content;return{html:h?w+_+l:_+w+(x?Wl(x)+": "+l:l),markers:p};},isAnimationEnabled:function isAnimationEnabled(){if(v.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),t;},restoreData:function restoreData(){this.dataTask.dirty();},getColorFromPalette:function getColorFromPalette(t,e,i){var n=this.ecModel,a=yu.getColorFromPalette.call(this,t,e,i);return a=a||n.getColorFromPalette(t,e,i);},coordDimToDataDim:function coordDimToDataDim(t){return this.getRawData().mapDimension(t,!0);},getProgressive:function getProgressive(){return this.get("progressive");},getProgressiveThreshold:function getProgressiveThreshold(){return this.get("progressiveThreshold");},getAxisTooltipData:null,getTooltipPosition:null,pipeTask:null,preventIncremental:null,pipelineContext:null});function Hh(t){var e=t.name;Ta(t)||(t.name=function(t){var i=t.getRawData(),e=i.mapDimension("seriesName",!0),n=[];return E(e,function(t){var e=i.getDimensionInfo(t);e.displayName&&n.push(e.displayName);}),n.join(" ");}(t)||e);}function Zh(t){return t.model.getRawData().count();}function Uh(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),Xh;}function Xh(t,e){t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData);}function Yh(e,i){E(e.CHANGABLE_METHODS,function(t){e.wrapMethod(t,A(jh,i));});}function jh(t){var e=qh(t);e&&e.setOutputEnd(this.count());}function qh(t){var e=(t.ecModel||{}).scheduler,i=e&&e.getPipeline(t.uid);if(i){var n=i.currentTask;if(n){var a=n.agentStubMap;a&&(n=a.get(t.uid));}return n;}}b(Wh,Th),b(Wh,yu);var Kh=function Kh(){this.group=new Si(),this.uid=ml("viewComponent");};Kh.prototype={constructor:Kh,init:function init(t,e){},render:function render(t,e,i,n){},dispose:function dispose(){},filterForExposedEvent:null};var $h=Kh.prototype;$h.updateView=$h.updateLayout=$h.updateVisual=function(t,e,i,n){},Ga(Kh),Ua(Kh,{registerWhenExtend:!0});function Jh(){var s=La();return function(t){var e=s(t),i=t.pipelineContext,n=e.large,a=e.progressiveRender,o=e.large=i.large,r=e.progressiveRender=i.progressiveRender;return!!(n^o||a^r)&&"reset";};}var Qh=La(),tc=Jh();function ec(){this.group=new Si(),this.uid=ml("viewChart"),this.renderTask=Dh({plan:oc,reset:rc}),this.renderTask.context={view:this};}var ic=ec.prototype={type:"chart",init:function init(t,e){},render:function render(t,e,i,n){},highlight:function highlight(t,e,i,n){ac(t.getData(),n,"emphasis");},downplay:function downplay(t,e,i,n){ac(t.getData(),n,"normal");},remove:function remove(t,e){this.group.removeAll();},dispose:function dispose(){},incrementalPrepareRender:null,incrementalRender:null,updateTransform:null,filterForExposedEvent:null};function nc(t,e,i){if(t&&(t.trigger(e,i),t.isGroup&&!Rs(t)))for(var n=0,a=t.childCount();n<a;n++){nc(t.childAt(n),e,i);}}function ac(e,t,i){var n=Ca(e,t),a=t&&null!=t.highlightKey?zs(t.highlightKey):null;null!=n?E(wa(n),function(t){nc(e.getItemGraphicEl(t),i,a);}):e.eachItemGraphicEl(function(t){nc(t,i,a);});}function oc(t){return tc(t.model);}function rc(t){var e=t.model,i=t.ecModel,n=t.api,a=t.payload,o=e.pipelineContext.progressiveRender,r=t.view,s=a&&Qh(a).updateMethod,l=o?"incrementalPrepareRender":s&&r[s]?s:"render";return"render"!==l&&r[l](e,i,n,a),sc[l];}ic.updateView=ic.updateLayout=ic.updateVisual=function(t,e,i,n){this.render(t,e,i,n);},Ga(ec),Ua(ec,{registerWhenExtend:!0}),ec.markUpdateMethod=function(t,e){Qh(t).updateMethod=e;};var sc={incrementalPrepareRender:{progress:function progress(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload);}},render:{forceFirstProgress:!0,progress:function progress(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload);}}},lc="\0__throttleOriginMethod",uc="\0__throttleRate",hc="\0__throttleType";function cc(t,i,n){var a,o,r,s,l,u=0,h=0,c=null;function d(){h=new Date().getTime(),c=null,t.apply(r,s||[]);}i=i||0;function e(){a=new Date().getTime(),r=this,s=arguments;var t=l||i,e=l||n;l=null,o=a-(e?u:h)-t,clearTimeout(c),e?c=setTimeout(d,t):0<=o?d():c=setTimeout(d,-o),u=a;}return e.clear=function(){c&&(clearTimeout(c),c=null);},e.debounceNextCall=function(t){l=t;},e;}function dc(t,e,i,n){var a=t[e];if(a){var o=a[lc]||a,r=a[hc];if(a[uc]!==i||r!==n){if(null==i||!n)return t[e]=o;(a=t[e]=cc(o,i,"debounce"===n))[lc]=o,a[hc]=n,a[uc]=i;}return a;}}function fc(t,e){var i=t[e];i&&i[lc]&&(t[e]=i[lc]);}var pc={createOnAllSeries:!0,performRawSeries:!0,reset:function reset(e,t){var i=e.getData(),o=(e.visualColorAccessPath||"itemStyle.color").split("."),n=e.get(o)||e.getColorFromPalette(e.name,null,t.getSeriesCount());i.setVisual("color",n);var r=(e.visualBorderColorAccessPath||"itemStyle.borderColor").split("."),a=e.get(r);if(i.setVisual("borderColor",a),!t.isSeriesFiltered(e)){"function"!=typeof n||n instanceof jr||i.each(function(t){i.setItemVisual(t,"color",n(e.getDataParams(t)));});return{dataEach:i.hasItemOption?function(t,e){var i=t.getItemModel(e),n=i.get(o,!0),a=i.get(r,!0);null!=n&&t.setItemVisual(e,"color",n),null!=a&&t.setItemVisual(e,"borderColor",a);}:null};}}},gc={legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}},mc=function mc(t,e){var o=e.getModel("aria");if(o.get("show"))if(o.get("description"))t.setAttribute("aria-label",o.get("description"));else{var h=0;e.eachSeries(function(t,e){++h;},this);var i,c=o.get("data.maxCount")||10,n=o.get("series.maxCount")||10,d=Math.min(h,n);if(!(h<1)){var a=function(){var t=e.getModel("title").option;t&&t.length&&(t=t[0]);return t&&t.text;}();i=a?p(g("general.withTitle"),{title:a}):g("general.withoutTitle");var f=[];i+=p(g(1<h?"series.multiple.prefix":"series.single.prefix"),{seriesCount:h}),e.eachSeries(function(t,e){if(e<d){var i,n=t.get("name"),a="series."+(1<h?"multiple":"single")+".";i=p(i=g(n?a+"withName":a+"withoutName"),{seriesId:t.seriesIndex,seriesName:t.get("name"),seriesType:function(t){return gc.series.typeNames[t]||"自定义图";}(t.subType)});var o=t.getData();(window.data=o).count()>c?i+=p(g("data.partialData"),{displayCnt:c}):i+=g("data.allData");for(var r=[],s=0;s<o.count();s++){if(s<c){var l=o.getName(s),u=Mh(o,s);r.push(p(g(l?"data.withName":"data.withoutName"),{name:l,value:u}));}}i+=r.join(g("data.separator.middle"))+g("data.separator.end"),f.push(i);}}),i+=f.join(g("series.multiple.separator.middle"))+g("series.multiple.separator.end"),t.setAttribute("aria-label",i);}}function p(t,e){if("string"!=typeof t)return t;var i=t;return E(e,function(t,e){i=i.replace(new RegExp("\\{\\s*"+e+"\\s*\\}","g"),t);}),i;}function g(t){var e=o.get(t);if(null!=e)return e;for(var i=t.split("."),n=gc.aria,a=0;a<i.length;++a){n=n[i[a]];}return n;}},vc=Math.PI;function yc(t,e,i,n){this.ecInstance=t,this.api=e,this.unfinished;i=this._dataProcessorHandlers=i.slice(),n=this._visualHandlers=n.slice();this._allHandlers=i.concat(n),this._stageTaskMap=Q();}var xc=yc.prototype;function _c(l,t,u,h,c){var d;function f(t,e){return t.setDirty&&(!t.dirtyMap||t.dirtyMap.get(e.__pipeline.id));}c=c||{},E(t,function(n,t){if(!c.visualType||c.visualType===n.visualType){var e=l._stageTaskMap.get(n.uid),i=e.seriesTaskMap,a=e.overallTask;if(a){var o,r=a.agentStubMap;r.each(function(t){f(c,t)&&(t.dirty(),o=!0);}),o&&a.dirty(),wc(a,h);var s=l.getPerformArgs(a,c.block);r.each(function(t){t.perform(s);}),d|=a.perform(s);}else i&&i.each(function(t,e){f(c,t)&&t.dirty();var i=l.getPerformArgs(t,c.block);i.skip=!n.performRawSeries&&u.isSeriesFiltered(t.context.model),wc(t,h),d|=t.perform(i);});}}),l.unfinished|=d;}xc.restoreData=function(t,e){t.restoreData(e),this._stageTaskMap.each(function(t){var e=t.overallTask;e&&e.dirty();});},xc.getPerformArgs=function(t,e){if(t.__pipeline){var i=this._pipelineMap.get(t.__pipeline.id),n=i.context,a=!e&&i.progressiveEnabled&&(!n||n.progressiveRender)&&t.__idxInPipeline>i.blockIndex?i.step:null,o=n&&n.modDataCount;return{step:a,modBy:null!=o?Math.ceil(o/a):null,modDataCount:o};}},xc.getPipeline=function(t){return this._pipelineMap.get(t);},xc.updateStreamModes=function(t,e){var i=this._pipelineMap.get(t.uid),n=t.getData().count(),a=i.progressiveEnabled&&e.incrementalPrepareRender&&n>=i.threshold,o=t.get("large")&&n>=t.get("largeThreshold"),r="mod"===t.get("progressiveChunkMode")?n:null;t.pipelineContext=i.context={progressiveRender:a,modDataCount:r,large:o};},xc.restorePipelines=function(t){var n=this,a=n._pipelineMap=Q();t.eachSeries(function(t){var e=t.getProgressive(),i=t.uid;a.set(i,{id:i,head:null,tail:null,threshold:t.getProgressiveThreshold(),progressiveEnabled:e&&!(t.preventIncremental&&t.preventIncremental()),blockIndex:-1,step:Math.round(e||700),count:0}),kc(n,t,t.dataTask);});},xc.prepareStageTasks=function(){var i=this._stageTaskMap,n=this.ecInstance.getModel(),a=this.api;E(this._allHandlers,function(t){var e=i.get(t.uid)||i.set(t.uid,[]);t.reset&&function(n,a,t,o,r){var s=t.seriesTaskMap||(t.seriesTaskMap=Q()),e=a.seriesType,i=a.getTargetSeries;a.createOnAllSeries?o.eachRawSeries(l):e?o.eachRawSeriesByType(e,l):i&&i(o,r).each(l);function l(t){var e=t.uid,i=s.get(e)||s.set(e,Dh({plan:Ac,reset:Tc,count:Lc}));i.context={model:t,ecModel:o,api:r,useClearVisual:a.isVisual&&!a.isLayout,plan:a.plan,reset:a.reset,scheduler:n},kc(n,t,i);}var u=n._pipelineMap;s.each(function(t,e){u.get(e)||(t.dispose(),s.removeKey(e));});}(this,t,e,n,a),t.overallReset&&function(n,t,e,i,a){var o=e.overallTask=e.overallTask||Dh({reset:bc});o.context={ecModel:i,api:a,overallReset:t.overallReset,scheduler:n};var r=o.agentStubMap=o.agentStubMap||Q(),s=t.seriesType,l=t.getTargetSeries,u=!0,h=t.modifyOutputEnd;s?i.eachRawSeriesByType(s,c):l?l(i,a).each(c):(u=!1,E(i.getSeries(),c));function c(t){var e=t.uid,i=r.get(e);i||(i=r.set(e,Dh({reset:Sc,onDirty:Ic})),o.dirty()),i.context={model:t,overallProgress:u,modifyOutputEnd:h},i.agent=o,i.__block=u,kc(n,t,i);}var d=n._pipelineMap;r.each(function(t,e){d.get(e)||(t.dispose(),o.dirty(),r.removeKey(e));});}(this,t,e,n,a);},this);},xc.prepareView=function(t,e,i,n){var a=t.renderTask,o=a.context;o.model=e,o.ecModel=i,o.api=n,a.__block=!t.incrementalPrepareRender,kc(this,e,a);},xc.performDataProcessorTasks=function(t,e){_c(this,this._dataProcessorHandlers,t,e,{block:!0});},xc.performVisualTasks=function(t,e,i){_c(this,this._visualHandlers,t,e,i);},xc.performSeriesTasks=function(t){var e;t.eachSeries(function(t){e|=t.dataTask.perform();}),this.unfinished|=e;},xc.plan=function(){this._pipelineMap.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break;}e=e.getUpstream();}while(e);});};var wc=xc.updatePayload=function(t,e){"remain"!==e&&(t.context.payload=e);};function bc(t){t.overallReset(t.ecModel,t.api,t.payload);}function Sc(t,e){return t.overallProgress&&Mc;}function Mc(){this.agent.dirty(),this.getDownstream().dirty();}function Ic(){this.agent&&this.agent.dirty();}function Ac(t){return t.plan&&t.plan(t.model,t.ecModel,t.api,t.payload);}function Tc(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=wa(t.reset(t.model,t.ecModel,t.api,t.payload));return 1<e.length?N(e,function(t,e){return Cc(e);}):Dc;}var Dc=Cc(0);function Cc(o){return function(t,e){var i=e.data,n=e.resetDefines[o];if(n&&n.dataEach)for(var a=t.start;a<t.end;a++){n.dataEach(i,a);}else n&&n.progress&&n.progress(t,i);};}function Lc(t){return t.data.count();}function kc(t,e,i){var n=e.uid,a=t._pipelineMap.get(n);a.head||(a.head=i),a.tail&&a.tail.pipe(i),(a.tail=i).__idxInPipeline=a.count++,i.__pipeline=a;}yc.wrapStageHandler=function(t,e){return O(t)&&(t={overallReset:t,seriesType:function(t){Pc=null;try{t(Nc,Oc);}catch(t){}return Pc;}(t)}),t.uid=ml("stageHandler"),e&&(t.visualType=e),t;};var Pc,Nc={},Oc={};function Ec(t,e){for(var i in e.prototype){t[i]=et;}}Ec(Nc,zu),Ec(Oc,Fu),Nc.eachSeriesByType=Nc.eachRawSeriesByType=function(t){Pc=t;},Nc.eachComponent=function(t){"series"===t.mainType&&t.subType&&(Pc=t.subType);};function Rc(){return{axisLine:{lineStyle:{color:Vc}},axisTick:{lineStyle:{color:Vc}},axisLabel:{textStyle:{color:Vc}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:Vc}}};}var zc=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],Bc={color:zc,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],zc]},Vc="#eee",Gc=["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],Fc={color:Gc,backgroundColor:"#333",tooltip:{axisPointer:{lineStyle:{color:Vc},crossStyle:{color:Vc}}},legend:{textStyle:{color:Vc}},textStyle:{color:Vc},title:{textStyle:{color:Vc}},toolbox:{iconStyle:{normal:{borderColor:Vc}}},dataZoom:{textStyle:{color:Vc}},visualMap:{textStyle:{color:Vc}},timeline:{lineStyle:{color:Vc},itemStyle:{normal:{color:Gc[1]}},label:{normal:{textStyle:{color:Vc}}},controlStyle:{normal:{color:Vc,borderColor:Vc}}},timeAxis:Rc(),logAxis:Rc(),valueAxis:Rc(),categoryAxis:Rc(),line:{symbol:"circle"},graph:{color:Gc},gauge:{title:{textStyle:{color:Vc}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}}};Fc.categoryAxis.splitLine.show=!1,fu.extend({type:"dataset",defaultOption:{seriesLayoutBy:Du,sourceHeader:null,dimensions:null,source:null},optionUpdated:function optionUpdated(){!function(t){var e=t.option.source,i=Au;if(V(e))i=Tu;else if(k(e)){0===e.length&&(i=Su);for(var n=0,a=e.length;n<a;n++){var o=e[n];if(null!=o){if(k(o)){i=Su;break;}if(z(o)){i=Mu;break;}}}}else if(z(e)){for(var r in e){if(e.hasOwnProperty(r)&&P(e[r])){i=Iu;break;}}}else if(null!=e)throw new Error("Invalid data");ku(t).sourceFormat=i;}(this);}}),Kh.extend({type:"dataset"});var Wc=hr.extend({type:"ellipse",shape:{cx:0,cy:0,rx:0,ry:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=e.rx,o=e.ry,r=.5522848*a,s=.5522848*o;t.moveTo(i-a,n),t.bezierCurveTo(i-a,n-s,i-r,n-o,i,n-o),t.bezierCurveTo(i+r,n-o,i+a,n-s,i+a,n),t.bezierCurveTo(i+a,n+s,i+r,n+o,i,n+o),t.bezierCurveTo(i-r,n+o,i-a,n+s,i-a,n),t.closePath();}}),Hc=/[\s,]+/;function Zc(t){R(t)&&(t=new DOMParser().parseFromString(t,"text/xml"));for(9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;){t=t.nextSibling;}return t;}function Uc(){this._defs={},this._root=null,this._isDefine=!1,this._isText=!1;}Uc.prototype.parse=function(t,e){e=e||{};var i=Zc(t);if(!i)throw new Error("Illegal svg");var n=new Si();this._root=n;var a=i.getAttribute("viewBox")||"",o=parseFloat(i.getAttribute("width")||e.width),r=parseFloat(i.getAttribute("height")||e.height);isNaN(o)&&(o=null),isNaN(r)&&(r=null),$c(i,n,null,!0);for(var s,l,u=i.firstChild;u;){this._parseNode(u,n),u=u.nextSibling;}if(a){var h=j(a).split(Hc);4<=h.length&&(s={x:parseFloat(h[0]||0),y:parseFloat(h[1]||0),width:parseFloat(h[2]),height:parseFloat(h[3])});}if(s&&null!=o&&null!=r&&(l=id(s,o,r),!e.ignoreViewBox)){var c=n;(n=new Si()).add(c),c.scale=l.scale.slice(),c.position=l.position.slice();}return e.ignoreRootClip||null==o||null==r||n.setClipPath(new Hr({shape:{x:0,y:0,width:o,height:r}})),{root:n,width:o,height:r,viewBoxRect:s,viewBoxTransform:l};},Uc.prototype._parseNode=function(t,e){var i,n,a=t.nodeName.toLowerCase();if("defs"===a?this._isDefine=!0:"text"===a&&(this._isText=!0),this._isDefine){if(n=Yc[a]){var o=n.call(this,t),r=t.getAttribute("id");r&&(this._defs[r]=o);}}else(n=Xc[a])&&(i=n.call(this,t,e),e.add(i));for(var s=t.firstChild;s;){1===s.nodeType&&this._parseNode(s,i),3===s.nodeType&&this._isText&&this._parseText(s,i),s=s.nextSibling;}"defs"===a?this._isDefine=!1:"text"===a&&(this._isText=!1);},Uc.prototype._parseText=function(t,e){if(1===t.nodeType){var i=t.getAttribute("dx")||0,n=t.getAttribute("dy")||0;this._textX+=parseFloat(i),this._textY+=parseFloat(n);}var a=new Dr({style:{text:t.textContent,transformText:!0},position:[this._textX||0,this._textY||0]});jc(e,a),$c(t,a,this._defs);var o=a.style.fontSize;o&&o<9&&(a.style.fontSize=9,a.scale=a.scale||[1,1],a.scale[0]*=o/9,a.scale[1]*=o/9);var r=a.getBoundingRect();return this._textX+=r.width,e.add(a),a;};var Xc={g:function g(t,e){var i=new Si();return jc(e,i),$c(t,i,this._defs),i;},rect:function rect(t,e){var i=new Hr();return jc(e,i),$c(t,i,this._defs),i.setShape({x:parseFloat(t.getAttribute("x")||0),y:parseFloat(t.getAttribute("y")||0),width:parseFloat(t.getAttribute("width")||0),height:parseFloat(t.getAttribute("height")||0)}),i;},circle:function circle(t,e){var i=new Lr();return jc(e,i),$c(t,i,this._defs),i.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),r:parseFloat(t.getAttribute("r")||0)}),i;},line:function line(t,e){var i=new Ur();return jc(e,i),$c(t,i,this._defs),i.setShape({x1:parseFloat(t.getAttribute("x1")||0),y1:parseFloat(t.getAttribute("y1")||0),x2:parseFloat(t.getAttribute("x2")||0),y2:parseFloat(t.getAttribute("y2")||0)}),i;},ellipse:function ellipse(t,e){var i=new Wc();return jc(e,i),$c(t,i,this._defs),i.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),rx:parseFloat(t.getAttribute("rx")||0),ry:parseFloat(t.getAttribute("ry")||0)}),i;},polygon:function polygon(t,e){var i=t.getAttribute("points");i=i&&qc(i);var n=new Rr({shape:{points:i||[]}});return jc(e,n),$c(t,n,this._defs),n;},polyline:function polyline(t,e){var i=new hr();jc(e,i),$c(t,i,this._defs);var n=t.getAttribute("points");return n=n&&qc(n),new zr({shape:{points:n||[]}});},image:function image(t,e){var i=new Yn();return jc(e,i),$c(t,i,this._defs),i.setStyle({image:t.getAttribute("xlink:href"),x:t.getAttribute("x"),y:t.getAttribute("y"),width:t.getAttribute("width"),height:t.getAttribute("height")}),i;},text:function text(t,e){var i=t.getAttribute("x")||0,n=t.getAttribute("y")||0,a=t.getAttribute("dx")||0,o=t.getAttribute("dy")||0;this._textX=parseFloat(i)+parseFloat(a),this._textY=parseFloat(n)+parseFloat(o);var r=new Si();return jc(e,r),$c(t,r,this._defs),r;},tspan:function tspan(t,e){var i=t.getAttribute("x"),n=t.getAttribute("y");null!=i&&(this._textX=parseFloat(i)),null!=n&&(this._textY=parseFloat(n));var a=t.getAttribute("dx")||0,o=t.getAttribute("dy")||0,r=new Si();return jc(e,r),$c(t,r,this._defs),this._textX+=a,this._textY+=o,r;},path:function path(t,e){var i=Tr(t.getAttribute("d")||"");return jc(e,i),$c(t,i,this._defs),i;}},Yc={lineargradient:function lineargradient(t){var e=parseInt(t.getAttribute("x1")||0,10),i=parseInt(t.getAttribute("y1")||0,10),n=parseInt(t.getAttribute("x2")||10,10),a=parseInt(t.getAttribute("y2")||0,10),o=new Jr(e,i,n,a);return function(t,e){var i=t.firstChild;for(;i;){if(1===i.nodeType){var n=i.getAttribute("offset");n=0<n.indexOf("%")?parseInt(n,10)/100:n?parseFloat(n):0;var a=i.getAttribute("stop-color")||"#000000";e.addColorStop(n,a);}i=i.nextSibling;}}(t,o),o;},radialgradient:function radialgradient(t){}};function jc(t,e){t&&t.__inheritedStyle&&(e.__inheritedStyle||(e.__inheritedStyle={}),C(e.__inheritedStyle,t.__inheritedStyle));}function qc(t){for(var e=j(t).split(Hc),i=[],n=0;n<e.length;n+=2){var a=parseFloat(e[n]),o=parseFloat(e[n+1]);i.push([a,o]);}return i;}var Kc={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-align":"textAlign","alignment-baseline":"textBaseline"};function $c(t,e,i,n){var a=e.__inheritedStyle||{},o="text"===e.type;if(1===t.nodeType&&(function(t,e){var i=t.getAttribute("transform");if(i){i=i.replace(/,/g," ");var n=null,a=[];i.replace(td,function(t,e,i){a.push(e,i);});for(var o=a.length-1;0<o;o-=2){var r=a[o],s=a[o-1];switch(n=n||Qt(),s){case"translate":r=j(r).split(Hc),ne(n,n,[parseFloat(r[0]),parseFloat(r[1]||0)]);break;case"scale":r=j(r).split(Hc),oe(n,n,[parseFloat(r[0]),parseFloat(r[1]||r[0])]);break;case"rotate":r=j(r).split(Hc),ae(n,n,parseFloat(r[0]));break;case"skew":r=j(r).split(Hc),console.warn("Skew transform is not supported yet");break;case"matrix":r=j(r).split(Hc);n[0]=parseFloat(r[0]),n[1]=parseFloat(r[1]),n[2]=parseFloat(r[2]),n[3]=parseFloat(r[3]),n[4]=parseFloat(r[4]),n[5]=parseFloat(r[5]);}}e.setLocalTransform(n);}}(t,e),L(a,function(t){var e=t.getAttribute("style"),i={};if(!e)return i;var n,a={};ed.lastIndex=0;for(;null!=(n=ed.exec(e));){a[n[1]]=n[2];}for(var o in Kc){Kc.hasOwnProperty(o)&&null!=a[o]&&(i[Kc[o]]=a[o]);}return i;}(t)),!n))for(var r in Kc){if(Kc.hasOwnProperty(r)){var s=t.getAttribute(r);null!=s&&(a[Kc[r]]=s);}}var l=o?"textFill":"fill",u=o?"textStroke":"stroke";e.style=e.style||new Vi();var h=e.style;null!=a.fill&&h.set(l,Qc(a.fill,i)),null!=a.stroke&&h.set(u,Qc(a.stroke,i)),E(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(t){var e="lineWidth"===t&&o?"textStrokeWidth":t;null!=a[t]&&h.set(e,parseFloat(a[t]));}),a.textBaseline&&"auto"!==a.textBaseline||(a.textBaseline="alphabetic"),"alphabetic"===a.textBaseline&&(a.textBaseline="bottom"),"start"===a.textAlign&&(a.textAlign="left"),"end"===a.textAlign&&(a.textAlign="right"),E(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign","textBaseline"],function(t){null!=a[t]&&h.set(t,a[t]);}),a.lineDash&&(e.style.lineDash=j(a.lineDash).split(Hc)),h[u]&&"none"!==h[u]&&(e[u]=!0),e.__inheritedStyle=a;}var Jc=/url\(\s*#(.*?)\)/;function Qc(t,e){var i=e&&t&&t.match(Jc);return i?e[j(i[1])]:t;}var td=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.e,]*)\)/g;var ed=/([^\s:;]+)\s*:\s*([^:;]+)/g;function id(t,e,i){var n=e/t.width,a=i/t.height,o=Math.min(n,a);return{scale:[o,o],position:[-(t.x+t.width/2)*o+e/2,-(t.y+t.height/2)*o+i/2]};}var nd=Q(),ad={registerMap:function registerMap(t,e,i){var n;return E(n=k(e)?e:e.svg?[{type:"svg",source:e.svg,specialAreas:e.specialAreas}]:(e.geoJson&&!e.features&&(i=e.specialAreas,e=e.geoJson),[{type:"geoJSON",source:e,specialAreas:i}]),function(t){var e=t.type;"geoJson"===e&&(e=t.type="geoJSON"),(0,od[e])(t);}),nd.set(t,n);},retrieveMap:function retrieveMap(t){return nd.get(t);}},od={geoJSON:function geoJSON(t){var e=t.source;t.geoJSON=R(e)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")():e;},svg:function svg(t){t.svgXML=Zc(t.source);}},rd=Y,sd=E,ld=O,ud=z,hd=fu.parseClassType,cd={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:3500,COMPONENT:4e3,BRUSH:5e3}},dd="__flagInMainProcess",fd="__optionUpdated",pd=/^[a-zA-Z0-9_]+$/;function gd(n,a){return function(t,e,i){!a&&this._disposed||(t=t&&t.toLowerCase(),Ct.prototype[n].call(this,t,e,i));};}function md(){Ct.call(this);}function vd(t,e,i){i=i||{},"string"==typeof e&&(e=Fd[e]),this.id,this.group,this._dom=t;var n=this._zr=fa(t,{renderer:i.renderer||"canvas",devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height});this._throttledZrFlush=cc(T(n.flush,n),17),(e=D(e))&&ch(e,!0),this._theme=e,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new Hu();var a=this._api=function(i){var t=i._coordSysMgr;return L(new Fu(i),{getCoordinateSystems:T(t.getCoordinateSystems,t),getComponentByElement:function getComponentByElement(t){for(;t;){var e=t.__ecComponentInfo;if(null!=e)return i._model.getComponent(e.mainType,e.index);t=t.parent;}}});}(this);function o(t,e){return t.__prio-e.__prio;}ki(Gd,o),ki(zd,o),this._scheduler=new yc(this,a,zd,Gd),Ct.call(this,this._ecEventProcessor=new Od()),this._messageCenter=new md(),this._initEvents(),this.resize=T(this.resize,this),this._pendingActions=[],n.animation.on("frame",this._onframe,this),function(t,e){t.on("rendered",function(){e.trigger("rendered"),!t.animation.isFinished()||e[fd]||e._scheduler.unfinished||e._pendingActions.length||e.trigger("finished");});}(n,this),K(this);}md.prototype.on=gd("on",!0),md.prototype.off=gd("off",!0),md.prototype.one=gd("one",!0),b(md,Ct);var yd=vd.prototype;function xd(t,e,i){if(!this._disposed){var n,a=this._model,o=this._coordSysMgr.getCoordinateSystems();e=Pa(a,e);for(var r=0;r<o.length;r++){var s=o[r];if(s[t]&&null!=(n=s[t](a,e,i)))return n;}}}yd._onframe=function(){if(!this._disposed){var t=this._scheduler;if(this[fd]){var e=this[fd].silent;this[dd]=!0,wd(this),_d.update.call(this),this[dd]=!1,this[fd]=!1,Id.call(this,e),Ad.call(this,e);}else if(t.unfinished){var i=1,n=this._model,a=this._api;t.unfinished=!1;do{var o=+new Date();t.performSeriesTasks(n),t.performDataProcessorTasks(n),Sd(this,n),t.performVisualTasks(n),Ld(this,this._model,a,"remain"),i-=+new Date()-o;}while(0<i&&t.unfinished);t.unfinished||this._zr.flush();}}},yd.getDom=function(){return this._dom;},yd.getZr=function(){return this._zr;},yd.setOption=function(t,e,i){if(!this._disposed){var n;if(ud(e)&&(i=e.lazyUpdate,n=e.silent,e=e.notMerge),this[dd]=!0,!this._model||e){var a=new qu(this._api),o=this._theme,r=this._model=new zu();r.scheduler=this._scheduler,r.init(null,null,o,a);}this._model.setOption(t,Bd),i?(this[fd]={silent:n},this[dd]=!1):(wd(this),_d.update.call(this),this._zr.flush(),this[fd]=!1,this[dd]=!1,Id.call(this,n),Ad.call(this,n));}},yd.setTheme=function(){console.error("ECharts#setTheme() is DEPRECATED in ECharts 3.0");},yd.getModel=function(){return this._model;},yd.getOption=function(){return this._model&&this._model.getOption();},yd.getWidth=function(){return this._zr.getWidth();},yd.getHeight=function(){return this._zr.getHeight();},yd.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1;},yd.getRenderedCanvas=function(t){if(v.canvasSupported)return(t=t||{}).pixelRatio=t.pixelRatio||1,t.backgroundColor=t.backgroundColor||this._model.get("backgroundColor"),this._zr.painter.getRenderedCanvas(t);},yd.getSvgDataUrl=function(){if(v.svgSupported){var t=this._zr;return E(t.storage.getDisplayList(),function(t){t.stopAnimation(!0);}),t.painter.pathToDataUrl();}},yd.getDataURL=function(t){if(!this._disposed){var e=(t=t||{}).excludeComponents,i=this._model,n=[],a=this;sd(e,function(t){i.eachComponent({mainType:t},function(t){var e=a._componentsMap[t.__viewId];e.group.ignore||(n.push(e),e.group.ignore=!0);});});var o="svg"===this._zr.painter.getType()?this.getSvgDataUrl():this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return sd(n,function(t){t.group.ignore=!1;}),o;}},yd.getConnectedDataURL=function(a){if(!this._disposed&&v.canvasSupported){var o=this.group,r=Math.min,s=Math.max;if(Zd[o]){var l=1/0,u=1/0,h=-1/0,c=-1/0,d=[],i=a&&a.pixelRatio||1;E(Hd,function(t,e){if(t.group===o){var i=t.getRenderedCanvas(D(a)),n=t.getDom().getBoundingClientRect();l=r(n.left,l),u=r(n.top,u),h=s(n.right,h),c=s(n.bottom,c),d.push({dom:i,left:n.left,top:n.top});}});var t=(h*=i)-(l*=i),e=(c*=i)-(u*=i),n=g();n.width=t,n.height=e;var f=fa(n);return a.connectedBackgroundColor&&f.add(new Hr({shape:{x:0,y:0,width:t,height:e},style:{fill:a.connectedBackgroundColor}})),sd(d,function(t){var e=new Yn({style:{x:t.left*i-l,y:t.top*i-u,image:t.dom}});f.add(e);}),f.refreshImmediately(),n.toDataURL("image/"+(a&&a.type||"png"));}return this.getDataURL(a);}},yd.convertToPixel=A(xd,"convertToPixel"),yd.convertFromPixel=A(xd,"convertFromPixel"),yd.containPixel=function(t,a){var o;if(!this._disposed)return E(t=Pa(this._model,t),function(t,n){0<=n.indexOf("Models")&&E(t,function(t){var e=t.coordinateSystem;if(e&&e.containPoint)o|=!!e.containPoint(a);else if("seriesModels"===n){var i=this._chartsMap[t.__viewId];i&&i.containPoint&&(o|=i.containPoint(a,t));}},this);},this),!!o;},yd.getVisual=function(t,e){var i=(t=Pa(this._model,t,{defaultMainType:"series"})).seriesModel.getData(),n=t.hasOwnProperty("dataIndexInside")?t.dataIndexInside:t.hasOwnProperty("dataIndex")?i.indexOfRawIndex(t.dataIndex):null;return null!=n?i.getItemVisual(n,e):i.getVisual(e);},yd.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId];},yd.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId];};var _d={prepareAndUpdate:function prepareAndUpdate(t){wd(this),_d.update.call(this,t);},update:function update(t){var e=this._model,i=this._api,n=this._zr,a=this._coordSysMgr,o=this._scheduler;if(e){o.restoreData(e,t),o.performSeriesTasks(e),a.create(e,i),o.performDataProcessorTasks(e,t),Sd(this,e),a.update(e,i),Dd(e),o.performVisualTasks(e,t),Cd(this,e,i,t);var r=e.get("backgroundColor")||"transparent";if(v.canvasSupported)n.setBackgroundColor(r);else{var s=Ee(r);r=Ue(s,"rgb"),0===s[3]&&(r="transparent");}kd(e,i);}},updateTransform:function updateTransform(a){var o=this._model,r=this,s=this._api;if(o){var l=[];o.eachComponent(function(t,e){var i=r.getViewOfComponentModel(e);if(i&&i.__alive)if(i.updateTransform){var n=i.updateTransform(e,o,s,a);n&&n.update&&l.push(i);}else l.push(i);});var n=Q();o.eachSeries(function(t){var e=r._chartsMap[t.__viewId];if(e.updateTransform){var i=e.updateTransform(t,o,s,a);i&&i.update&&n.set(t.uid,1);}else n.set(t.uid,1);}),Dd(o),this._scheduler.performVisualTasks(o,a,{setDirty:!0,dirtyMap:n}),Ld(r,o,s,a,n),kd(o,this._api);}},updateView:function updateView(t){var e=this._model;e&&(ec.markUpdateMethod(t,"updateView"),Dd(e),this._scheduler.performVisualTasks(e,t,{setDirty:!0}),Cd(this,this._model,this._api,t),kd(e,this._api));},updateVisual:function updateVisual(t){_d.update.call(this,t);},updateLayout:function updateLayout(t){_d.update.call(this,t);}};function wd(t){var e=t._model,i=t._scheduler;i.restorePipelines(e),i.prepareStageTasks(),Td(t,"component",e,i),Td(t,"chart",e,i),i.plan();}function bd(e,i,n,a,t){var o=e._model;if(a){var r={};r[a+"Id"]=n[a+"Id"],r[a+"Index"]=n[a+"Index"],r[a+"Name"]=n[a+"Name"];var s={mainType:a,query:r};t&&(s.subType=t);var l=n.excludeSeriesId;null!=l&&(l=Q(wa(l))),o&&o.eachComponent(s,function(t){l&&null!=l.get(t.id)||u(e["series"===a?"_chartsMap":"_componentsMap"][t.__viewId]);},e);}else sd(e._componentsViews.concat(e._chartsViews),u);function u(t){t&&t.__alive&&t[i]&&t[i](t.__model,o,e._api,n);}}function Sd(t,e){var i=t._chartsMap,n=t._scheduler;e.eachSeries(function(t){n.updateStreamModes(t,i[t.__viewId]);});}function Md(e,t){var i=e.type,n=e.escapeConnect,a=Ed[i],o=a.actionInfo,r=(o.update||"update").split(":"),s=r.pop();r=null!=r[0]&&hd(r[0]),this[dd]=!0;var l=[e],u=!1;e.batch&&(u=!0,l=N(e.batch,function(t){return(t=C(L({},t),e)).batch=null,t;}));var h,c=[],d="highlight"===i||"downplay"===i;sd(l,function(t){(h=(h=a.action(t,this._model,this._api))||L({},t)).type=o.event||h.type,c.push(h),d?bd(this,s,t,"series"):r&&bd(this,s,t,r.main,r.sub);},this),"none"===s||d||r||(this[fd]?(wd(this),_d.update.call(this,e),this[fd]=!1):_d[s].call(this,e)),h=u?{type:o.event||i,escapeConnect:n,batch:c}:c[0],this[dd]=!1,t||this._messageCenter.trigger(h.type,h);}function Id(t){for(var e=this._pendingActions;e.length;){var i=e.shift();Md.call(this,i,t);}}function Ad(t){t||this.trigger("updated");}function Td(t,e,a,o){for(var r="component"===e,s=r?t._componentsViews:t._chartsViews,l=r?t._componentsMap:t._chartsMap,u=t._zr,h=t._api,i=0;i<s.length;i++){s[i].__alive=!1;}function n(t){var e="_ec_"+t.id+"_"+t.type,i=l[e];if(!i){var n=hd(t.type);(i=new(r?Kh.getClass(n.main,n.sub):ec.getClass(n.sub))()).init(a,h),l[e]=i,s.push(i),u.add(i.group);}t.__viewId=i.__id=e,i.__alive=!0,i.__model=t,i.group.__ecComponentInfo={mainType:t.mainType,index:t.componentIndex},r||o.prepareView(i,t,a,h);}r?a.eachComponent(function(t,e){"series"!==t&&n(e);}):a.eachSeries(n);for(i=0;i<s.length;){var c=s[i];c.__alive?i++:(r||c.renderTask.dispose(),u.remove(c.group),c.dispose(a,h),s.splice(i,1),delete l[c.__id],c.__id=c.group.__ecComponentInfo=null);}}function Dd(t){t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette();});}function Cd(t,e,i,n){!function(t,i,n,a,e){sd(e||t._componentsViews,function(t){var e=t.__model;t.render(e,i,n,a),Nd(e,t);});}(t,e,i,n),sd(t._chartsViews,function(t){t.__alive=!1;}),Ld(t,e,i,n),sd(t._chartsViews,function(t){t.__alive||t.remove(e,i);});}function Ld(n,t,e,a,o){var r,s=n._scheduler;t.eachSeries(function(t){var e=n._chartsMap[t.__viewId];e.__alive=!0;var i=e.renderTask;s.updatePayload(i,a),o&&o.get(t.uid)&&i.dirty(),r|=i.perform(s.getPerformArgs(i)),e.group.silent=!!t.get("silent"),Nd(t,e),function(t,e){var i=t.get("blendMode")||null;e.group.traverse(function(t){t.isGroup||t.style.blend!==i&&t.setStyle("blend",i),t.eachPendingDisplayable&&t.eachPendingDisplayable(function(t){t.setStyle("blend",i);});});}(t,e);}),s.unfinished|=r,function(i,t){var e=i._zr.storage,n=0;e.traverse(function(t){n++;}),n>t.get("hoverLayerThreshold")&&!v.node&&t.eachSeries(function(t){if(!t.preventUsingHoverLayer){var e=i._chartsMap[t.__viewId];e.__alive&&e.group.traverse(function(t){t.useHoverLayer=!0;});}});}(n,t),mc(n._zr.dom,t);}function kd(e,i){sd(Vd,function(t){t(e,i);});}yd.resize=function(t){if(!this._disposed){this._zr.resize(t);var e=this._model;if(this._loadingFX&&this._loadingFX.resize(),e){var i=e.resetOption("media"),n=t&&t.silent;this[dd]=!0,i&&wd(this),_d.update.call(this),this[dd]=!1,Id.call(this,n),Ad.call(this,n);}}},yd.showLoading=function(t,e){if(!this._disposed&&(ud(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),Wd[t])){var i=Wd[t](this._api,e),n=this._zr;this._loadingFX=i,n.add(i);}},yd.hideLoading=function(){this._disposed||(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null);},yd.makeActionFromEvent=function(t){var e=L({},t);return e.type=Rd[t.type],e;},yd.dispatchAction=function(t,e){this._disposed||(ud(e)||(e={silent:!!e}),Ed[t.type]&&this._model&&(this[dd]?this._pendingActions.push(t):(Md.call(this,t,e.silent),e.flush?this._zr.flush(!0):!1!==e.flush&&v.browser.weChat&&this._throttledZrFlush(),Id.call(this,e.silent),Ad.call(this,e.silent))));},yd.appendData=function(t){if(!this._disposed){var e=t.seriesIndex;this.getModel().getSeriesByIndex(e).appendData(t),this._scheduler.unfinished=!0;}},yd.on=gd("on",!1),yd.off=gd("off",!1),yd.one=gd("one",!1);var Pd=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function Nd(t,e){var i=t.get("z"),n=t.get("zlevel");e.group.traverse(function(t){"group"!==t.type&&(null!=i&&(t.z=i),null!=n&&(t.zlevel=n));});}function Od(){this.eventInfo;}yd._initEvents=function(){sd(Pd,function(u){function t(t){var e,i=this.getModel(),n=t.target;if("globalout"===u)e={};else if(n&&null!=n.dataIndex){var a=n.dataModel||i.getSeriesByIndex(n.seriesIndex);e=a&&a.getDataParams(n.dataIndex,n.dataType,n)||{};}else n&&n.eventData&&(e=L({},n.eventData));if(e){var o=e.componentType,r=e.componentIndex;"markLine"!==o&&"markPoint"!==o&&"markArea"!==o||(o="series",r=e.seriesIndex);var s=o&&null!=r&&i.getComponent(o,r),l=s&&this["series"===s.mainType?"_chartsMap":"_componentsMap"][s.__viewId];e.event=t,e.type=u,this._ecEventProcessor.eventInfo={targetEl:n,packedEvent:e,model:s,view:l},this.trigger(u,e);}}t.zrEventfulCallAtLast=!0,this._zr.on(u,t,this);},this),sd(Rd,function(t,e){this._messageCenter.on(e,function(t){this.trigger(e,t);},this);},this);},yd.isDisposed=function(){return this._disposed;},yd.clear=function(){this._disposed||this.setOption({series:[]},!0);},yd.dispose=function(){if(!this._disposed){this._disposed=!0,Oa(this.getDom(),Yd,"");var e=this._api,i=this._model;sd(this._componentsViews,function(t){t.dispose(i,e);}),sd(this._chartsViews,function(t){t.dispose(i,e);}),this._zr.dispose(),delete Hd[this.id];}},b(vd,Ct),Od.prototype={constructor:Od,normalizeQuery:function normalizeQuery(t){var s={},l={},u={};if(R(t)){var e=hd(t);s.mainType=e.main||null,s.subType=e.sub||null;}else{var h=["Index","Name","Id"],c={name:1,dataIndex:1,dataType:1};E(t,function(t,e){for(var i=!1,n=0;n<h.length;n++){var a=h[n],o=e.lastIndexOf(a);if(0<o&&o===e.length-a.length){var r=e.slice(0,o);"data"!==r&&(s.mainType=r,s[a.toLowerCase()]=t,i=!0);}}c.hasOwnProperty(e)&&(l[e]=t,i=!0),i||(u[e]=t);});}return{cptQuery:s,dataQuery:l,otherQuery:u};},filter:function filter(t,e,i){var n=this.eventInfo;if(!n)return!0;var a=n.targetEl,o=n.packedEvent,r=n.model,s=n.view;if(!r||!s)return!0;var l=e.cptQuery,u=e.dataQuery;return h(l,r,"mainType")&&h(l,r,"subType")&&h(l,r,"index","componentIndex")&&h(l,r,"name")&&h(l,r,"id")&&h(u,o,"name")&&h(u,o,"dataIndex")&&h(u,o,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,e.otherQuery,a,o));function h(t,e,i,n){return null==t[i]||e[n||i]===t[i];}},afterTrigger:function afterTrigger(){this.eventInfo=null;}};var Ed={},Rd={},zd=[],Bd=[],Vd=[],Gd=[],Fd={},Wd={},Hd={},Zd={},Ud=new Date()-0,Xd=new Date()-0,Yd="_echarts_instance_";function jd(t){Zd[t]=!1;}var qd=jd;function Kd(t){return Hd[function(t,e){return t.getAttribute?t.getAttribute(e):t[e];}(t,Yd)];}function $d(t,e){Fd[t]=e;}function Jd(t){Bd.push(t);}function Qd(t,e){of(zd,t,e,1e3);}function tf(t,e,i){"function"==typeof e&&(i=e,e="");var n=ud(t)?t.type:[t,t={event:e}][0];t.event=(t.event||n).toLowerCase(),e=t.event,rd(pd.test(n)&&pd.test(e)),Ed[n]||(Ed[n]={action:i,actionInfo:t}),Rd[e]=n;}function ef(t,e){Hu.register(t,e);}function nf(t,e){of(Gd,t,e,1e3,"layout");}function af(t,e){of(Gd,t,e,3e3,"visual");}function of(t,e,i,n,a){(ld(e)||ud(e))&&(i=e,e=n);var o=yc.wrapStageHandler(i,a);return o.__prio=e,o.__raw=i,t.push(o),o;}function rf(t,e){Wd[t]=e;}function sf(t){return fu.extend(t);}function lf(t){return Kh.extend(t);}function uf(t){return Wh.extend(t);}function hf(t){return ec.extend(t);}af(2e3,pc),Jd(ch),Qd(900,function(t){var o=Q();t.eachSeries(function(t){var e=t.get("stack");if(e){var i=o.get(e)||o.set(e,[]),n=t.getData(),a={stackResultDimension:n.getCalculationInfo("stackResultDimension"),stackedOverDimension:n.getCalculationInfo("stackedOverDimension"),stackedDimension:n.getCalculationInfo("stackedDimension"),stackedByDimension:n.getCalculationInfo("stackedByDimension"),isStackedByIndex:n.getCalculationInfo("isStackedByIndex"),data:n,seriesModel:t};if(!a.stackedDimension||!a.isStackedByIndex&&!a.stackedByDimension)return;i.length&&n.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(a);}}),o.each(dh);}),rf("default",function(n,t){C(t=t||{},{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var a=new Hr({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4}),o=new Kr({shape:{startAngle:-vc/2,endAngle:-vc/2+.1,r:10},style:{stroke:t.color,lineCap:"round",lineWidth:5},zlevel:t.zlevel,z:10001}),r=new Hr({style:{fill:"none",text:t.text,textPosition:"right",textDistance:10,textFill:t.textColor},zlevel:t.zlevel,z:10001});o.animateShape(!0).when(1e3,{endAngle:3*vc/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:3*vc/2}).delay(300).start("circularInOut");var e=new Si();return e.add(o),e.add(r),e.add(a),e.resize=function(){var t=n.getWidth()/2,e=n.getHeight()/2;o.setShape({cx:t,cy:e});var i=o.shape.r;r.setShape({x:t-i,y:e-i,width:2*i,height:2*i}),a.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()});},e.resize(),e;}),tf({type:"highlight",event:"highlight",update:"highlight"},et),tf({type:"downplay",event:"downplay",update:"downplay"},et),$d("light",Bc),$d("dark",Fc);function cf(t){return t;}function df(t,e,i,n,a){this._old=t,this._new=e,this._oldKeyGetter=i||cf,this._newKeyGetter=n||cf,this.context=a;}function ff(t,e,i,n,a){for(var o=0;o<t.length;o++){var r="_ec_"+a[n](t[o],o),s=e[r];null==s?(i.push(r),e[r]=o):(s.length||(e[r]=s=[s]),s.push(o));}}df.prototype={constructor:df,add:function add(t){return this._add=t,this;},update:function update(t){return this._update=t,this;},remove:function remove(t){return this._remove=t,this;},execute:function execute(){var t=this._old,e=this._new,i={},n=[],a=[];for(ff(t,{},n,"_oldKeyGetter",this),ff(e,i,a,"_newKeyGetter",this),o=0;o<t.length;o++){if(null!=(s=i[r=n[o]]))(u=s.length)?(1===u&&(i[r]=null),s=s.shift()):i[r]=null,this._update&&this._update(s,o);else this._remove&&this._remove(o);}for(var o=0;o<a.length;o++){var r=a[o];if(i.hasOwnProperty(r)){var s;if(null==(s=i[r]))continue;if(s.length)for(var l=0,u=s.length;l<u;l++){this._add&&this._add(s[l]);}else this._add&&this._add(s);}}}};var pf=Q(["tooltip","label","itemName","itemId","seriesName"]);function gf(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e];}function mf(t){return"category"===t?"ordinal":"time"===t?"time":"float";}var vf=z,yf="undefined",xf={float:(typeof Float64Array==="undefined"?"undefined":_typeof(Float64Array))==yf?Array:Float64Array,int:(typeof Int32Array==="undefined"?"undefined":_typeof(Int32Array))==yf?Array:Int32Array,ordinal:Array,number:Array,time:Array},_f=(typeof Uint32Array==="undefined"?"undefined":_typeof(Uint32Array))==yf?Array:Uint32Array,wf=(typeof Int32Array==="undefined"?"undefined":_typeof(Int32Array))==yf?Array:Int32Array,bf=(typeof Uint16Array==="undefined"?"undefined":_typeof(Uint16Array))==yf?Array:Uint16Array;function Sf(t){return 65535<t._rawCount?_f:bf;}var Mf=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_rawData","_chunkSize","_chunkCount","_dimValueGetter","_count","_rawCount","_nameDimIdx","_idDimIdx"],If=["_extent","_approximateExtent","_rawExtent"];function Af(e,i){E(Mf.concat(i.__wrappedMethods||[]),function(t){i.hasOwnProperty(t)&&(e[t]=i[t]);}),e.__wrappedMethods=i.__wrappedMethods,E(If,function(t){e[t]=D(i[t]);}),e._calculationInfo=L(i._calculationInfo);}var Tf=function Tf(t,e){t=t||["x","y"];for(var i={},n=[],a={},o=0;o<t.length;o++){var r=t[o];R(r)&&(r={name:r});var s=r.name;r.type=r.type||"float",r.coordDim||(r.coordDim=s,r.coordDimIndex=0),r.otherDims=r.otherDims||{},n.push(s),(i[s]=r).index=o,r.createInvertedIndices&&(a[s]=[]);}this.dimensions=n,this._dimensionInfos=i,this.hostModel=e,this.dataType,this._indices=null,this._count=0,this._rawCount=0,this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this._visual={},this._layout={},this._itemVisuals=[],this.hasItemVisual={},this._itemLayouts=[],this._graphicEls=[],this._chunkSize=1e5,this._chunkCount=0,this._rawData,this._rawExtent={},this._extent={},this._approximateExtent={},this._dimensionsSummary=function(n){var t={},o=t.encode={},r=Q(),s=[],l=[],u=t.userOutput={dimensionNames:n.dimensions.slice(),encode:{}};E(n.dimensions,function(t){var a=n.getDimensionInfo(t),e=a.coordDim;if(e){var i=a.coordDimIndex;gf(o,e)[i]=t,a.isExtraCoord||(r.set(e,1),function(t){return!("ordinal"===t||"time"===t);}(a.type)&&(s[0]=t),gf(u.encode,e)[i]=a.index),a.defaultTooltip&&l.push(t);}pf.each(function(t,e){var i=gf(o,e),n=a.otherDims[e];null!=n&&!1!==n&&(i[n]=a.name);});});var a=[],h={};r.each(function(t,e){var i=o[e];h[e]=i[0],a=a.concat(i);}),t.dataDimsOnCoord=a,t.encodeFirstDimNotExtra=h;var e=o.label;e&&e.length&&(s=e.slice());var i=o.tooltip;return i&&i.length?l=i.slice():l.length||(l=s.slice()),o.defaultedLabel=s,o.defaultedTooltip=l,t;}(this),this._invertedIndicesMap=a,this._calculationInfo={},this.userOutput=this._dimensionsSummary.userOutput;},Df=Tf.prototype;function Cf(t,e,i,n,a){var o=xf[e.type],r=n-1,s=e.name,l=t[s][r];if(l&&l.length<i){for(var u=new o(Math.min(a-r*i,i)),h=0;h<l.length;h++){u[h]=l[h];}t[s][r]=u;}for(var c=n*i;c<a;c+=i){t[s].push(new o(Math.min(a-c,i)));}}function Lf(a){var o=a._invertedIndicesMap;E(o,function(t,e){var i=a._dimensionInfos[e].ordinalMeta;if(i){t=o[e]=new wf(i.categories.length);for(var n=0;n<t.length;n++){t[n]=-1;}for(n=0;n<a._count;n++){t[a.get(e,n)]=n;}}});}function kf(t,e,i){var n;if(null!=e){var a=t._chunkSize,o=Math.floor(i/a),r=i%a,s=t.dimensions[e],l=t._storage[s][o];if(l){n=l[r];var u=t._dimensionInfos[s].ordinalMeta;u&&u.categories.length&&(n=u.categories[n]);}}return n;}function Pf(t){return t;}function Nf(t){return t<this._count&&0<=t?this._indices[t]:-1;}function Of(t,e){var i=t._idList[e];return null==i&&(i=kf(t,t._idDimIdx,e)),null==i&&(i="e\0\0"+e),i;}function Ef(t){return k(t)||(t=[t]),t;}function Rf(t,e){var i=t.dimensions,n=new Tf(N(i,t.getDimensionInfo,t),t.hostModel);Af(n,t);for(var a=n._storage={},o=t._storage,r=0;r<i.length;r++){var s=i[r];o[s]&&(0<=_(e,s)?(a[s]=zf(o[s]),n._rawExtent[s]=Bf(),n._extent[s]=null):a[s]=o[s]);}return n;}function zf(t){for(var e,i,n=new Array(t.length),a=0;a<t.length;a++){n[a]=(e=t[a],i=void 0,(i=e.constructor)===Array?e.slice():new i(e));}return n;}function Bf(){return[1/0,-1/0];}Df.type="list",Df.hasItemOption=!0,Df.getDimension=function(t){return"number"!=typeof t&&(isNaN(t)||this._dimensionInfos.hasOwnProperty(t))||(t=this.dimensions[t]),t;},Df.getDimensionInfo=function(t){return this._dimensionInfos[this.getDimension(t)];},Df.getDimensionsOnCoord=function(){return this._dimensionsSummary.dataDimsOnCoord.slice();},Df.mapDimension=function(t,e){var i=this._dimensionsSummary;if(null==e)return i.encodeFirstDimNotExtra[t];var n=i.encode[t];return!0===e?(n||[]).slice():n&&n[e];},Df.initData=function(t,e,i){(Lu.isInstance(t)||P(t))&&(t=new fh(t,this.dimensions.length)),this._rawData=t,this._storage={},this._indices=null,this._nameList=e||[],this._idList=[],this._nameRepeatCount={},i||(this.hasItemOption=!1),this.defaultDimValueGetter=wh[this._rawData.getSource().sourceFormat],this._dimValueGetter=i=i||this.defaultDimValueGetter,this._dimValueGetterArrayRows=wh.arrayRows,this._rawExtent={},this._initDataFromProvider(0,t.count()),t.pure&&(this.hasItemOption=!1);},Df.getProvider=function(){return this._rawData;},Df.appendData=function(t){var e=this._rawData,i=this.count();e.appendData(t);var n=e.count();e.persistent||(n+=i),this._initDataFromProvider(i,n);},Df.appendValues=function(t,e){for(var i=this._chunkSize,n=this._storage,a=this.dimensions,o=a.length,r=this._rawExtent,s=this.count(),l=s+Math.max(t.length,e?e.length:0),u=this._chunkCount,h=0;h<o;h++){r[v=a[h]]||(r[v]=Bf()),n[v]||(n[v]=[]),Cf(n,this._dimensionInfos[v],i,u,l),this._chunkCount=n[v].length;}for(var c=new Array(o),d=s;d<l;d++){for(var f=d-s,p=Math.floor(d/i),g=d%i,m=0;m<o;m++){var v=a[m],y=this._dimValueGetterArrayRows(t[f]||c,v,f,m);n[v][p][g]=y;var x=r[v];y<x[0]&&(x[0]=y),y>x[1]&&(x[1]=y);}e&&(this._nameList[d]=e[f]);}this._rawCount=this._count=l,this._extent={},Lf(this);},Df._initDataFromProvider=function(t,e){if(!(e<=t)){for(var i,n=this._chunkSize,a=this._rawData,o=this._storage,r=this.dimensions,s=r.length,l=this._dimensionInfos,u=this._nameList,h=this._idList,c=this._rawExtent,d=this._nameRepeatCount={},f=this._chunkCount,p=0;p<s;p++){c[w=r[p]]||(c[w]=Bf());var g=l[w];0===g.otherDims.itemName&&(i=this._nameDimIdx=p),0===g.otherDims.itemId&&(this._idDimIdx=p),o[w]||(o[w]=[]),Cf(o,g,n,f,e),this._chunkCount=o[w].length;}for(var m=new Array(s),v=t;v<e;v++){m=a.getItem(v,m);for(var y=Math.floor(v/n),x=v%n,_=0;_<s;_++){var w,b=o[w=r[_]][y],S=this._dimValueGetter(m,w,v,_);b[x]=S;var M=c[w];S<M[0]&&(M[0]=S),S>M[1]&&(M[1]=S);}if(!a.pure){var I=u[v];if(m&&null==I)if(null!=m.name)u[v]=I=m.name;else if(null!=i){var A=r[i],T=o[A][y];if(T){I=T[x];var D=l[A].ordinalMeta;D&&D.categories.length&&(I=D.categories[I]);}}var C=null==m?null:m.id;null==C&&null!=I&&(d[I]=d[I]||0,0<d[C=I]&&(C+="__ec__"+d[I]),d[I]++),null!=C&&(h[v]=C);}}!a.persistent&&a.clean&&a.clean(),this._rawCount=this._count=e,this._extent={},Lf(this);}},Df.count=function(){return this._count;},Df.getIndices=function(){var t=this._indices;if(t){var e=t.constructor,i=this._count;if(e===Array){a=new e(i);for(var n=0;n<i;n++){a[n]=t[n];}}else a=new e(t.buffer,0,i);}else{var a=new(e=Sf(this))(this.count());for(n=0;n<a.length;n++){a[n]=n;}}return a;},Df.get=function(t,e){if(!(0<=e&&e<this._count))return NaN;var i=this._storage;if(!i[t])return NaN;e=this.getRawIndex(e);var n=Math.floor(e/this._chunkSize),a=e%this._chunkSize;return i[t][n][a];},Df.getByRawIndex=function(t,e){if(!(0<=e&&e<this._rawCount))return NaN;var i=this._storage[t];if(!i)return NaN;var n=Math.floor(e/this._chunkSize),a=e%this._chunkSize;return i[n][a];},Df._getFast=function(t,e){var i=Math.floor(e/this._chunkSize),n=e%this._chunkSize;return this._storage[t][i][n];},Df.getValues=function(t,e){var i=[];k(t)||(e=t,t=this.dimensions);for(var n=0,a=t.length;n<a;n++){i.push(this.get(t[n],e));}return i;},Df.hasValue=function(t){for(var e=this._dimensionsSummary.dataDimsOnCoord,i=0,n=e.length;i<n;i++){if(isNaN(this.get(e[i],t)))return!1;}return!0;},Df.getDataExtent=function(t){t=this.getDimension(t);var e=this._storage[t],i=Bf();if(!e)return i;var n,a=this.count();if(!this._indices)return this._rawExtent[t].slice();if(n=this._extent[t])return n.slice();for(var o=(n=i)[0],r=n[1],s=0;s<a;s++){var l=this._getFast(t,this.getRawIndex(s));l<o&&(o=l),r<l&&(r=l);}return n=[o,r],this._extent[t]=n;},Df.getApproximateExtent=function(t){return t=this.getDimension(t),this._approximateExtent[t]||this.getDataExtent(t);},Df.setApproximateExtent=function(t,e){e=this.getDimension(e),this._approximateExtent[e]=t.slice();},Df.getCalculationInfo=function(t){return this._calculationInfo[t];},Df.setCalculationInfo=function(t,e){vf(t)?L(this._calculationInfo,t):this._calculationInfo[t]=e;},Df.getSum=function(t){var e=0;if(this._storage[t])for(var i=0,n=this.count();i<n;i++){var a=this.get(t,i);isNaN(a)||(e+=a);}return e;},Df.getMedian=function(t){var i=[];this.each(t,function(t,e){isNaN(t)||i.push(t);});var e=[].concat(i).sort(function(t,e){return t-e;}),n=this.count();return 0===n?0:n%2==1?e[(n-1)/2]:(e[n/2]+e[n/2-1])/2;},Df.rawIndexOf=function(t,e){var i=(t&&this._invertedIndicesMap[t])[e];return null==i||isNaN(i)?-1:i;},Df.indexOfName=function(t){for(var e=0,i=this.count();e<i;e++){if(this.getName(e)===t)return e;}return-1;},Df.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var e=this._indices,i=e[t];if(null!=i&&i<this._count&&i===t)return t;for(var n=0,a=this._count-1;n<=a;){var o=(n+a)/2|0;if(e[o]<t)n=1+o;else{if(!(e[o]>t))return o;a=o-1;}}return-1;},Df.indicesOfNearest=function(t,e,i){var n=[];if(!this._storage[t])return n;null==i&&(i=1/0);for(var a=Number.MAX_VALUE,o=-1,r=0,s=this.count();r<s;r++){var l=e-this.get(t,r),u=Math.abs(l);l<=i&&u<=a&&((u<a||0<=l&&o<0)&&(a=u,o=l,n.length=0),n.push(r));}return n;},Df.getRawIndex=Pf,Df.getRawDataItem=function(t){if(this._rawData.persistent)return this._rawData.getItem(this.getRawIndex(t));for(var e=[],i=0;i<this.dimensions.length;i++){var n=this.dimensions[i];e.push(this.get(n,t));}return e;},Df.getName=function(t){var e=this.getRawIndex(t);return this._nameList[e]||kf(this,this._nameDimIdx,e)||"";},Df.getId=function(t){return Of(this,this.getRawIndex(t));},Df.each=function(t,e,i,n){if(this._count){"function"==typeof t&&(n=i,i=e,e=t,t=[]),i=i||n||this;for(var a=(t=N(Ef(t),this.getDimension,this)).length,o=0;o<this.count();o++){switch(a){case 0:e.call(i,o);break;case 1:e.call(i,this.get(t[0],o),o);break;case 2:e.call(i,this.get(t[0],o),this.get(t[1],o),o);break;default:for(var r=0,s=[];r<a;r++){s[r]=this.get(t[r],o);}s[r]=o,e.apply(i,s);}}}},Df.filterSelf=function(t,e,i,n){if(this._count){"function"==typeof t&&(n=i,i=e,e=t,t=[]),i=i||n||this,t=N(Ef(t),this.getDimension,this);for(var a=this.count(),o=new(Sf(this))(a),r=[],s=t.length,l=0,u=t[0],h=0;h<a;h++){var c,d=this.getRawIndex(h);if(0===s)c=e.call(i,h);else if(1===s){var f=this._getFast(u,d);c=e.call(i,f,h);}else{for(var p=0;p<s;p++){r[p]=this._getFast(u,d);}r[p]=h,c=e.apply(i,r);}c&&(o[l++]=d);}return l<a&&(this._indices=o),this._count=l,this._extent={},this.getRawIndex=this._indices?Nf:Pf,this;}},Df.selectRange=function(t){if(this._count){var e=[];for(var i in t){t.hasOwnProperty(i)&&e.push(i);}var n=e.length;if(n){var a=this.count(),o=new(Sf(this))(a),r=0,s=e[0],l=t[s][0],u=t[s][1],h=!1;if(!this._indices){var c=0;if(1===n){for(var d=this._storage[e[0]],f=0;f<this._chunkCount;f++){for(var p=d[f],g=Math.min(this._count-f*this._chunkSize,this._chunkSize),m=0;m<g;m++){(l<=(w=p[m])&&w<=u||isNaN(w))&&(o[r++]=c),c++;}}h=!0;}else if(2===n){d=this._storage[s];var v=this._storage[e[1]],y=t[e[1]][0],x=t[e[1]][1];for(f=0;f<this._chunkCount;f++){p=d[f];var _=v[f];for(g=Math.min(this._count-f*this._chunkSize,this._chunkSize),m=0;m<g;m++){var w=p[m],b=_[m];(l<=w&&w<=u||isNaN(w))&&(y<=b&&b<=x||isNaN(b))&&(o[r++]=c),c++;}}h=!0;}}if(!h)if(1===n)for(m=0;m<a;m++){var S=this.getRawIndex(m);(l<=(w=this._getFast(s,S))&&w<=u||isNaN(w))&&(o[r++]=S);}else for(m=0;m<a;m++){var M=!0;for(S=this.getRawIndex(m),f=0;f<n;f++){var I=e[f];((w=this._getFast(i,S))<t[I][0]||w>t[I][1])&&(M=!1);}M&&(o[r++]=this.getRawIndex(m));}return r<a&&(this._indices=o),this._count=r,this._extent={},this.getRawIndex=this._indices?Nf:Pf,this;}}},Df.mapArray=function(t,e,i,n){"function"==typeof t&&(n=i,i=e,e=t,t=[]),i=i||n||this;var a=[];return this.each(t,function(){a.push(e&&e.apply(this,arguments));},i),a;},Df.map=function(t,e,i,n){i=i||n||this;var a=Rf(this,t=N(Ef(t),this.getDimension,this));a._indices=this._indices,a.getRawIndex=a._indices?Nf:Pf;for(var o=a._storage,r=[],s=this._chunkSize,l=t.length,u=this.count(),h=[],c=a._rawExtent,d=0;d<u;d++){for(var f=0;f<l;f++){h[f]=this.get(t[f],d);}h[l]=d;var p=e&&e.apply(i,h);if(null!=p){"object"!=_typeof(p)&&(r[0]=p,p=r);for(var g=this.getRawIndex(d),m=Math.floor(g/s),v=g%s,y=0;y<p.length;y++){var x=t[y],_=p[y],w=c[x],b=o[x];b&&(b[m][v]=_),_<w[0]&&(w[0]=_),_>w[1]&&(w[1]=_);}}}return a;},Df.downSample=function(t,e,i,n){for(var a=Rf(this,[t]),o=a._storage,r=[],s=Math.floor(1/e),l=o[t],u=this.count(),h=this._chunkSize,c=a._rawExtent[t],d=new(Sf(this))(u),f=0,p=0;p<u;p+=s){u-p<s&&(s=u-p,r.length=s);for(var g=0;g<s;g++){var m=this.getRawIndex(p+g),v=Math.floor(m/h),y=m%h;r[g]=l[v][y];}var x=i(r),_=this.getRawIndex(Math.min(p+n(r,x)||0,u-1)),w=_%h;(l[Math.floor(_/h)][w]=x)<c[0]&&(c[0]=x),x>c[1]&&(c[1]=x),d[f++]=_;}return a._count=f,a._indices=d,a.getRawIndex=Nf,a;},Df.getItemModel=function(t){var e=this.hostModel;return new dl(this.getRawDataItem(t),e,e&&e.ecModel);},Df.diff=function(e){var i=this;return new df(e?e.getIndices():[],this.getIndices(),function(t){return Of(e,t);},function(t){return Of(i,t);});},Df.getVisual=function(t){var e=this._visual;return e&&e[t];},Df.setVisual=function(t,e){if(vf(t))for(var i in t){t.hasOwnProperty(i)&&this.setVisual(i,t[i]);}else this._visual=this._visual||{},this._visual[t]=e;},Df.setLayout=function(t,e){if(vf(t))for(var i in t){t.hasOwnProperty(i)&&this.setLayout(i,t[i]);}else this._layout[t]=e;},Df.getLayout=function(t){return this._layout[t];},Df.getItemLayout=function(t){return this._itemLayouts[t];},Df.setItemLayout=function(t,e,i){this._itemLayouts[t]=i?L(this._itemLayouts[t]||{},e):e;},Df.clearItemLayouts=function(){this._itemLayouts.length=0;},Df.getItemVisual=function(t,e,i){var n=this._itemVisuals[t],a=n&&n[e];return null!=a||i?a:this.getVisual(e);},Df.setItemVisual=function(t,e,i){var n=this._itemVisuals[t]||{},a=this.hasItemVisual;if(this._itemVisuals[t]=n,vf(e))for(var o in e){e.hasOwnProperty(o)&&(n[o]=e[o],a[o]=!0);}else n[e]=i,a[e]=!0;},Df.clearAllVisual=function(){this._visual={},this._itemVisuals=[],this.hasItemVisual={};};function Vf(t){t.seriesIndex=this.seriesIndex,t.dataIndex=this.dataIndex,t.dataType=this.dataType;}function Gf(t,e,i){Lu.isInstance(e)||(e=Lu.seriesDataToSource(e)),i=i||{},t=(t||[]).slice();for(var n=(i.dimsDef||[]).slice(),l=Q(i.encodeDef),a=Q(),o=Q(),u=[],r=function(t,e,i,n){var a=Math.max(t.dimensionsDetectCount||1,e.length,i.length,n||0);return E(e,function(t){var e=t.dimsDef;e&&(a=Math.max(a,e.length));}),a;}(e,t,n,i.dimCount),s=0;s<r;s++){var h=n[s]=L({},z(n[s])?n[s]:{name:n[s]}),c=h.name,d=u[s]={otherDims:{}};null!=c&&null==a.get(c)&&(d.name=d.displayName=c,a.set(c,s)),null!=h.type&&(d.type=h.type),null!=h.displayName&&(d.displayName=h.displayName);}l.each(function(t,i){if(1===(t=wa(t).slice()).length&&!R(t[0])&&t[0]<0)l.set(i,!1);else{var n=l.set(i,[]);E(t,function(t,e){R(t)&&(t=a.get(t)),null!=t&&t<r&&(n[e]=t,p(u[t],i,e));});}});var f=0;function p(t,e,i){null!=pf.get(e)?t.otherDims[e]=i:(t.coordDim=e,t.coordDimIndex=i,o.set(e,!0));}E(t,function(a,t){var o,r,s;if(R(a))o=a,a={};else{o=a.name;var e=a.ordinalMeta;a.ordinalMeta=null,(a=D(a)).ordinalMeta=e,r=a.dimsDef,s=a.otherDims,a.name=a.coordDim=a.coordDimIndex=a.dimsDef=a.otherDims=null;}if(!1!==(i=l.get(o))){var i;if(!(i=wa(i)).length)for(var n=0;n<(r&&r.length||1);n++){for(;f<u.length&&null!=u[f].coordDim;){f++;}f<u.length&&i.push(f++);}E(i,function(t,e){var i=u[t];if(p(C(i,a),o,e),null==i.name&&r){var n=r[e];z(n)||(n={name:n}),i.name=i.displayName=n.name,i.defaultTooltip=n.defaultTooltip;}s&&C(i.otherDims,s);});}});var g=i.generateCoord,m=i.generateCoordCount,v=null!=m;m=g?m||1:0;for(var y,x,_=g||"value",w=0;w<r;w++){null==(d=u[w]=u[w]||{}).coordDim&&(d.coordDim=Ff(_,o,v),d.coordDimIndex=0,(!g||m<=0)&&(d.isExtraCoord=!0),m--),null==d.name&&(d.name=Ff(d.coordDim,a)),null==d.type&&(y=e,x=w,d.name,Eu(y.data,y.sourceFormat,y.seriesLayoutBy,y.dimensionsDefine,y.startIndex,x))&&(d.type="ordinal");}return u;}function Ff(t,e,i){if(i||null!=e.get(t)){for(var n=0;null!=e.get(t+n);){n++;}t+=n;}return e.set(t,!0),t;}Df.setItemGraphicEl=function(t,e){var i=this.hostModel;e&&(e.dataIndex=t,e.dataType=this.dataType,e.seriesIndex=i&&i.seriesIndex,"group"===e.type&&e.traverse(Vf,e)),this._graphicEls[t]=e;},Df.getItemGraphicEl=function(t){return this._graphicEls[t];},Df.eachItemGraphicEl=function(i,n){E(this._graphicEls,function(t,e){t&&i&&i.call(n,t,e);});},Df.cloneShallow=function(t){if(!t){var e=N(this.dimensions,this.getDimensionInfo,this);t=new Tf(e,this.hostModel);}if(t._storage=this._storage,Af(t,this),this._indices){var i=this._indices.constructor;t._indices=new i(this._indices);}else t._indices=null;return t.getRawIndex=t._indices?Nf:Pf,t;},Df.wrapMethod=function(t,e){var i=this[t];"function"==typeof i&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=i.apply(this,arguments);return e.apply(this,[t].concat(U(arguments)));});},Df.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],Df.CHANGABLE_METHODS=["filterSelf","selectRange"];var Wf=function Wf(t,e){return Gf((e=e||{}).coordDimensions||[],t,{dimsDef:e.dimensionsDefine||t.dimensionsDefine,encodeDef:e.encodeDefine||t.encodeDefine,dimCount:e.dimensionsCount,generateCoord:e.generateCoord,generateCoordCount:e.generateCoordCount});};function Hf(t,i,e){var n,a,o,r,s=(e=e||{}).byIndex,l=e.stackedCoordDimension,u=!(!t||!t.get("stack"));if(E(i,function(t,e){R(t)&&(i[e]=t={name:t}),u&&!t.isExtraCoord&&(s||n||!t.ordinalMeta||(n=t),a||"ordinal"===t.type||"time"===t.type||l&&l!==t.coordDim||(a=t));}),!a||s||n||(s=!0),a){o="__\0ecstackresult",r="__\0ecstackedover",n&&(n.createInvertedIndices=!0);var h=a.coordDim,c=a.type,d=0;E(i,function(t){t.coordDim===h&&d++;}),i.push({name:o,coordDim:h,coordDimIndex:d,type:c,isExtraCoord:!0,isCalculationCoord:!0}),d++,i.push({name:r,coordDim:r,coordDimIndex:d,type:c,isExtraCoord:!0,isCalculationCoord:!0});}return{stackedDimension:a&&a.name,stackedByDimension:n&&n.name,isStackedByIndex:s,stackedOverDimension:r,stackResultDimension:o};}function Zf(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension");}function Uf(t,e){return Zf(t,e)?t.getCalculationInfo("stackResultDimension"):e;}function Xf(t,e,i){i=i||{},Lu.isInstance(t)||(t=Lu.seriesDataToSource(t));var n,a=e.get("coordinateSystem"),o=Hu.get(a),r=xu(e);r&&(n=N(r.coordSysDims,function(t){var e={name:t},i=r.axisMap.get(t);if(i){var n=i.get("type");e.type=mf(n);}return e;})),n=n||o&&(o.getDimensionsInfo?o.getDimensionsInfo():o.dimensions.slice())||["x","y"];var s,l,u=Wf(t,{coordDimensions:n,generateCoord:i.generateCoord});r&&E(u,function(t,e){var i=t.coordDim,n=r.categoryAxisMap.get(i);n&&(null==s&&(s=e),t.ordinalMeta=n.getOrdinalMeta()),null!=t.otherDims.itemName&&(l=!0);}),l||null==s||(u[s].otherDims.itemName=0);var h=Hf(e,u),c=new Tf(u,e);c.setCalculationInfo(h);var d=null!=s&&function(t){if(t.sourceFormat===bu){var e=function(t){var e=0;for(;e<t.length&&null==t[e];){e++;}return t[e];}(t.data||[]);return null!=e&&!k(Ma(e));}}(t)?function(t,e,i,n){return n===s?i:this.defaultDimValueGetter(t,e,i,n);}:null;return c.hasItemOption=!1,c.initData(t,null,d),c;}function Yf(t){this._setting=t||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments);}function jf(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this._map;}Yf.prototype.parse=function(t){return t;},Yf.prototype.getSetting=function(t){return this._setting[t];},Yf.prototype.contain=function(t){var e=this._extent;return t>=e[0]&&t<=e[1];},Yf.prototype.normalize=function(t){var e=this._extent;return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0]);},Yf.prototype.scale=function(t){var e=this._extent;return t*(e[1]-e[0])+e[0];},Yf.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]);},Yf.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e));},Yf.prototype.getExtent=function(){return this._extent.slice();},Yf.prototype.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=t),isNaN(e)||(i[1]=e);},Yf.prototype.isBlank=function(){return this._isBlank;},Yf.prototype.setBlank=function(t){this._isBlank=t;},Yf.prototype.getLabel=null,Ga(Yf),Ua(Yf,{registerWhenExtend:!0}),jf.createByAxisModel=function(t){var e=t.option,i=e.data,n=i&&N(i,$f);return new jf({categories:n,needCollect:!n,deduplication:!1!==e.dedplication});};var qf=jf.prototype;function Kf(t){return t._map||(t._map=Q(t.categories));}function $f(t){return z(t)&&null!=t.value?t.value:t+"";}qf.getOrdinal=function(t){return Kf(this).get(t);},qf.parseAndCollect=function(t){var e,i=this._needCollect;if("string"!=typeof t&&!i)return t;if(i&&!this._deduplication)return e=this.categories.length,this.categories[e]=t,e;var n=Kf(this);return null==(e=n.get(t))&&(i?(e=this.categories.length,this.categories[e]=t,n.set(t,e)):e=NaN),e;};var Jf=Yf.prototype,Qf=Yf.extend({type:"ordinal",init:function init(t,e){t&&!k(t)||(t=new jf({categories:t})),this._ordinalMeta=t,this._extent=e||[0,t.categories.length-1];},parse:function parse(t){return"string"==typeof t?this._ordinalMeta.getOrdinal(t):Math.round(t);},contain:function contain(t){return t=this.parse(t),Jf.contain.call(this,t)&&null!=this._ordinalMeta.categories[t];},normalize:function normalize(t){return Jf.normalize.call(this,this.parse(t));},scale:function scale(t){return Math.round(Jf.scale.call(this,t));},getTicks:function getTicks(){for(var t=[],e=this._extent,i=e[0];i<=e[1];){t.push(i),i++;}return t;},getLabel:function getLabel(t){if(!this.isBlank())return this._ordinalMeta.categories[t];},count:function count(){return this._extent[1]-this._extent[0]+1;},unionExtentFromData:function unionExtentFromData(t,e){this.unionExtent(t.getApproximateExtent(e));},getOrdinalMeta:function getOrdinalMeta(){return this._ordinalMeta;},niceTicks:et,niceExtent:et});Qf.create=function(){return new Qf();};var tp=_l;function ep(t){return Sl(t)+2;}function ip(t,e,i){t[e]=Math.max(Math.min(t[e],i[1]),i[0]);}function np(t,e){isFinite(t[0])||(t[0]=e[0]),isFinite(t[1])||(t[1]=e[1]),ip(t,0,e),ip(t,1,e),t[0]>t[1]&&(t[0]=t[1]);}var ap=_l,op=Yf.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function setExtent(t,e){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(e)||(i[1]=parseFloat(e));},unionExtent:function unionExtent(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),op.prototype.setExtent.call(this,e[0],e[1]);},getInterval:function getInterval(){return this._interval;},setInterval:function setInterval(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=ep(t);},getTicks:function getTicks(){return function(t,e,i,n){var a=[];if(!t)return a;e[0]<i[0]&&a.push(e[0]);for(var o=i[0];o<=i[1]&&(a.push(o),(o=tp(o+t,n))!==a[a.length-1]);){if(1e4<a.length)return[];}return e[1]>(a.length?a[a.length-1]:i[1])&&a.push(e[1]),a;}(this._interval,this._extent,this._niceExtent,this._intervalPrecision);},getLabel:function getLabel(t,e){if(null==t)return"";var i=e&&e.precision;return null==i?i=Sl(t)||0:"auto"===i&&(i=this._intervalPrecision),zl(t=ap(t,i,!0));},niceTicks:function niceTicks(t,e,i){t=t||5;var n=this._extent,a=n[1]-n[0];if(isFinite(a)){a<0&&(a=-a,n.reverse());var o=function(t,e,i,n){var a={},o=t[1]-t[0],r=a.interval=Nl(o/e,!0);null!=i&&r<i&&(r=a.interval=i),null!=n&&n<r&&(r=a.interval=n);var s=a.intervalPrecision=ep(r);return np(a.niceTickExtent=[tp(Math.ceil(t[0]/r)*r,s),tp(Math.floor(t[1]/r)*r,s)],t),a;}(n,t,e,i);this._intervalPrecision=o.intervalPrecision,this._interval=o.interval,this._niceExtent=o.niceTickExtent;}},niceExtent:function niceExtent(t){var e=this._extent;if(e[0]===e[1])if(0!==e[0]){var i=e[0];t.fixMax||(e[1]+=i/2),e[0]-=i/2;}else e[1]=1;var n=e[1]-e[0];isFinite(n)||(e[0]=0,e[1]=1),this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var a=this._interval;t.fixMin||(e[0]=ap(Math.floor(e[0]/a)*a)),t.fixMax||(e[1]=ap(Math.ceil(e[1]/a)*a));}});op.create=function(){return new op();};var rp="__ec_stack_",sp="undefined"!=typeof Float32Array?Float32Array:Array;function lp(t){return t.get("stack")||rp+t.seriesIndex;}function up(t){return t.dim+t.index;}function hp(t,e){var i=[];return e.eachSeriesByType(t,function(t){mp(t)&&!vp(t)&&i.push(t);}),i;}function cp(t){var g=function(t){var l={};E(t,function(t){var e=t.coordinateSystem.getBaseAxis();if("time"===e.type||"value"===e.type)for(var i=t.getData(),n=e.dim+"_"+e.index,a=i.mapDimension(e.dim),o=0,r=i.count();o<r;++o){var s=i.get(a,o);l[n]?l[n].push(s):l[n]=[s];}});var e=[];for(var i in l){if(l.hasOwnProperty(i)){var n=l[i];if(n){n.sort(function(t,e){return t-e;});for(var a=null,o=1;o<n.length;++o){var r=n[o]-n[o-1];0<r&&(a=null===a?r:Math.min(a,r));}e[i]=a;}}}return e;}(t),m=[];return E(t,function(t){var e,i=t.coordinateSystem.getBaseAxis(),n=i.getExtent();if("category"===i.type)e=i.getBandWidth();else if("value"===i.type||"time"===i.type){var a=i.dim+"_"+i.index,o=g[a],r=Math.abs(n[1]-n[0]),s=i.scale.getExtent(),l=Math.abs(s[1]-s[0]);e=o?r/l*o:r;}else{var u=t.getData();e=Math.abs(n[1]-n[0])/u.count();}var h=xl(t.get("barWidth"),e),c=xl(t.get("barMaxWidth"),e),d=xl(t.get("barMinWidth")||1,e),f=t.get("barGap"),p=t.get("barCategoryGap");m.push({bandWidth:e,barWidth:h,barMaxWidth:c,barMinWidth:d,barGap:f,barCategoryGap:p,axisKey:up(i),stackId:lp(t)});}),dp(m);}function dp(t){var d={};E(t,function(t,e){var i=t.axisKey,n=t.bandWidth,a=d[i]||{bandWidth:n,remainedWidth:n,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},o=a.stacks;d[i]=a;var r=t.stackId;o[r]||a.autoWidthCount++,o[r]=o[r]||{width:0,maxWidth:0};var s=t.barWidth;s&&!o[r].width&&(o[r].width=s,s=Math.min(a.remainedWidth,s),a.remainedWidth-=s);var l=t.barMaxWidth;l&&(o[r].maxWidth=l);var u=t.barMinWidth;u&&(o[r].minWidth=u);var h=t.barGap;null!=h&&(a.gap=h);var c=t.barCategoryGap;null!=c&&(a.categoryGap=c);});var f={};return E(d,function(t,i){f[i]={};var e=t.stacks,n=t.bandWidth,a=xl(t.categoryGap,n),o=xl(t.gap,1),r=t.remainedWidth,s=t.autoWidthCount,l=(r-a)/(s+(s-1)*o);l=Math.max(l,0),E(e,function(t){var e=t.maxWidth,i=t.minWidth;if(t.width){n=t.width;e&&(n=Math.min(n,e)),i&&(n=Math.max(n,i)),t.width=n,r-=n,s--;}else{var n=l;e&&e<n&&(n=Math.min(e,r)),i&&n<i&&(n=i),n!==l&&(t.width=n,r-=n,s--);}}),l=(r-a)/(s+(s-1)*o),l=Math.max(l,0);var u,h=0;E(e,function(t,e){t.width||(t.width=l),h+=(u=t).width*(1+o);}),u&&(h-=u.width*o);var c=-h/2;E(e,function(t,e){f[i][e]=f[i][e]||{bandWidth:n,offset:c,width:t.width},c+=t.width*(1+o);});}),f;}function fp(t,e,i){if(t&&e){var n=t[up(e)];return null!=n&&null!=i&&(n=n[lp(i)]),n;}}function pp(t,e){var i=hp(t,e),A=cp(i),T={};E(i,function(t){var e=t.getData(),i=t.coordinateSystem,n=i.getBaseAxis(),a=lp(t),o=A[up(n)][a],r=o.offset,s=o.width,l=i.getOtherAxis(n),u=t.get("barMinHeight")||0;T[a]=T[a]||[],e.setLayout({bandWidth:o.bandWidth,offset:r,size:s});for(var h=e.mapDimension(l.dim),c=e.mapDimension(n.dim),d=Zf(e,h),f=l.isHorizontal(),p=yp(n,l,d),g=0,m=e.count();g<m;g++){var v=e.get(h,g),y=e.get(c,g);if(!isNaN(v)&&!isNaN(y)){var x,_,w,b,S,M=0<=v?"p":"n",I=p;if(d&&(T[a][y]||(T[a][y]={p:p,n:p}),I=T[a][y][M]),f)x=I,_=(S=i.dataToPoint([v,y]))[1]+r,w=S[0]-p,b=s,Math.abs(w)<u&&(w=(w<0?-1:1)*u),d&&(T[a][y][M]+=w);else x=(S=i.dataToPoint([y,v]))[0]+r,_=I,w=s,b=S[1]-p,Math.abs(b)<u&&(b=(b<=0?-1:1)*u),d&&(T[a][y][M]+=b);e.setItemLayout(g,{x:x,y:_,width:w,height:b});}}},this);}var gp={seriesType:"bar",plan:Jh(),reset:function reset(t){if(mp(t)&&vp(t)){var e=t.getData(),h=t.coordinateSystem,c=h.getBaseAxis(),d=h.getOtherAxis(c),f=e.mapDimension(d.dim),p=e.mapDimension(c.dim),g=d.isHorizontal(),m=g?0:1,v=fp(cp([t]),c,t).width;return .5<v||(v=.5),{progress:function progress(t,e){var i,n=t.count,a=new sp(2*n),o=new sp(n),r=[],s=[],l=0,u=0;for(;null!=(i=t.next());){s[m]=e.get(f,i),s[1-m]=e.get(p,i),r=h.dataToPoint(s,null,r),a[l++]=r[0],a[l++]=r[1],o[u++]=i;}e.setLayout({largePoints:a,largeDataIndices:o,barWidth:v,valueAxisStart:yp(c,d,!1),valueAxisHorizontal:g});}};}}};function mp(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type;}function vp(t){return t.pipelineContext&&t.pipelineContext.large;}function yp(t,e){return e.toGlobalCoord(e.dataToCoord("log"===e.type?1:0));}var xp=op.prototype,_p=Math.ceil,wp=Math.floor,bp=36e5,Sp=864e5,Mp=op.extend({type:"time",getLabel:function getLabel(t){var e=this._stepLvl,i=new Date(t);return ql(e[0],i,this.getSetting("useUTC"));},niceExtent:function niceExtent(t){var e=this._extent;if(e[0]===e[1]&&(e[0]-=Sp,e[1]+=Sp),e[1]===-1/0&&e[0]===1/0){var i=new Date();e[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),e[0]=e[1]-Sp;}this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var n=this._interval;t.fixMin||(e[0]=_l(wp(e[0]/n)*n)),t.fixMax||(e[1]=_l(_p(e[1]/n)*n));},niceTicks:function niceTicks(t,e,i){t=t||10;var n=this._extent,a=n[1]-n[0],o=a/t;null!=e&&o<e&&(o=e),null!=i&&i<o&&(o=i);var r=Ip.length,s=function(t,e,i,n){for(;i<n;){var a=i+n>>>1;t[a][1]<e?i=1+a:n=a;}return i;}(Ip,o,0,r),l=Ip[Math.min(s,r-1)],u=l[1];"year"===l[0]&&(u*=Nl(a/u/t,!0));var h=this.getSetting("useUTC")?0:60*new Date(+n[0]||+n[1]).getTimezoneOffset()*1e3,c=[Math.round(_p((n[0]-h)/u)*u+h),Math.round(wp((n[1]-h)/u)*u+h)];np(c,n),this._stepLvl=l,this._interval=u,this._niceExtent=c;},parse:function parse(t){return+Ll(t);}});E(["contain","normalize"],function(e){Mp.prototype[e]=function(t){return xp[e].call(this,this.parse(t));};});var Ip=[["hh:mm:ss",1e3],["hh:mm:ss",5e3],["hh:mm:ss",1e4],["hh:mm:ss",15e3],["hh:mm:ss",3e4],["hh:mm\nMM-dd",6e4],["hh:mm\nMM-dd",3e5],["hh:mm\nMM-dd",6e5],["hh:mm\nMM-dd",9e5],["hh:mm\nMM-dd",18e5],["hh:mm\nMM-dd",bp],["hh:mm\nMM-dd",72e5],["hh:mm\nMM-dd",6*bp],["hh:mm\nMM-dd",432e5],["MM-dd\nyyyy",Sp],["MM-dd\nyyyy",2*Sp],["MM-dd\nyyyy",3*Sp],["MM-dd\nyyyy",4*Sp],["MM-dd\nyyyy",5*Sp],["MM-dd\nyyyy",6*Sp],["week",7*Sp],["MM-dd\nyyyy",864e6],["week",14*Sp],["week",21*Sp],["month",31*Sp],["week",42*Sp],["month",62*Sp],["week",70*Sp],["quarter",95*Sp],["month",31*Sp*4],["month",13392e6],["half-year",16416e6],["month",31*Sp*8],["month",26784e6],["year",380*Sp]];Mp.create=function(t){return new Mp({useUTC:t.ecModel.get("useUTC")});};var Ap=Yf.prototype,Tp=op.prototype,Dp=Sl,Cp=_l,Lp=Math.floor,kp=Math.ceil,Pp=Math.pow,Np=Math.log,Op=Yf.extend({type:"log",base:10,$constructor:function $constructor(){Yf.apply(this,arguments),this._originalScale=new op();},getTicks:function getTicks(){var i=this._originalScale,n=this._extent,a=i.getExtent();return N(Tp.getTicks.call(this),function(t){var e=_l(Pp(this.base,t));return e=t===n[0]&&i.__fixMin?Ep(e,a[0]):e,e=t===n[1]&&i.__fixMax?Ep(e,a[1]):e;},this);},getLabel:Tp.getLabel,scale:function scale(t){return t=Ap.scale.call(this,t),Pp(this.base,t);},setExtent:function setExtent(t,e){var i=this.base;t=Np(t)/Np(i),e=Np(e)/Np(i),Tp.setExtent.call(this,t,e);},getExtent:function getExtent(){var t=this.base,e=Ap.getExtent.call(this);e[0]=Pp(t,e[0]),e[1]=Pp(t,e[1]);var i=this._originalScale,n=i.getExtent();return i.__fixMin&&(e[0]=Ep(e[0],n[0])),i.__fixMax&&(e[1]=Ep(e[1],n[1])),e;},unionExtent:function unionExtent(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=Np(t[0])/Np(e),t[1]=Np(t[1])/Np(e),Ap.unionExtent.call(this,t);},unionExtentFromData:function unionExtentFromData(t,e){this.unionExtent(t.getApproximateExtent(e));},niceTicks:function niceTicks(t){t=t||10;var e=this._extent,i=e[1]-e[0];if(!(i==1/0||i<=0)){var n=kl(i);for(t/i*n<=.5&&(n*=10);!isNaN(n)&&Math.abs(n)<1&&0<Math.abs(n);){n*=10;}var a=[_l(kp(e[0]/n)*n),_l(Lp(e[1]/n)*n)];this._interval=n,this._niceExtent=a;}},niceExtent:function niceExtent(t){Tp.niceExtent.call(this,t);var e=this._originalScale;e.__fixMin=t.fixMin,e.__fixMax=t.fixMax;}});function Ep(t,e){return Cp(t,Dp(e));}function Rp(t,e){var i,n,a,o=t.type,r=e.getMin(),s=e.getMax(),l=null!=r,u=null!=s,h=t.getExtent();"ordinal"===o?i=e.getCategories().length:(k(n=e.get("boundaryGap"))||(n=[n||0,n||0]),"boolean"==typeof n[0]&&(n=[0,0]),n[0]=xl(n[0],1),n[1]=xl(n[1],1),a=h[1]-h[0]||Math.abs(h[0])),null==r&&(r="ordinal"===o?i?0:NaN:h[0]-n[0]*a),null==s&&(s="ordinal"===o?i?i-1:NaN:h[1]+n[1]*a),"dataMin"===r?r=h[0]:"function"==typeof r&&(r=r({min:h[0],max:h[1]})),"dataMax"===s?s=h[1]:"function"==typeof s&&(s=s({min:h[0],max:h[1]})),null!=r&&isFinite(r)||(r=NaN),null!=s&&isFinite(s)||(s=NaN),t.setBlank(F(r)||F(s)||"ordinal"===o&&!t.getOrdinalMeta().categories.length),e.getNeedCrossZero()&&(0<r&&0<s&&!l&&(r=0),r<0&&s<0&&!u&&(s=0));var c=e.ecModel;if(c&&"time"===o){var d,f=hp("bar",c);if(E(f,function(t){d|=t.getBaseAxis()===e.axis;}),d){var p=cp(f),g=function(t,e,i,n){var a=i.axis.getExtent(),o=a[1]-a[0],r=fp(n,i.axis);if(void 0===r)return{min:t,max:e};var s=1/0;E(r,function(t){s=Math.min(t.offset,s);});var l=-1/0;E(r,function(t){l=Math.max(t.offset+t.width,l);}),s=Math.abs(s),l=Math.abs(l);var u=s+l,h=e-t,c=h/(1-(s+l)/o)-h;return{min:t-=s/u*c,max:e+=l/u*c};}(r,s,e,p);r=g.min,s=g.max;}}return[r,s];}function zp(t,e){var i=Rp(t,e),n=null!=e.getMin(),a=null!=e.getMax(),o=e.get("splitNumber");"log"===t.type&&(t.base=e.get("logBase"));var r=t.type;t.setExtent(i[0],i[1]),t.niceExtent({splitNumber:o,fixMin:n,fixMax:a,minInterval:"interval"===r||"time"===r?e.get("minInterval"):null,maxInterval:"interval"===r||"time"===r?e.get("maxInterval"):null});var s=e.get("interval");null!=s&&t.setInterval&&t.setInterval(s);}function Bp(t,e){if(e=e||t.get("type"))switch(e){case"category":return new Qf(t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),[1/0,-1/0]);case"value":return new op();default:return(Yf.getClass(e)||op).create(t);}}function Vp(i){var e,n=i.getLabelModel().get("formatter"),a="category"===i.type?i.scale.getExtent()[0]:null;return"string"==typeof n?(e=n,n=function n(t){return t=i.scale.getLabel(t),e.replace("{value}",null!=t?t:"");}):"function"==typeof n?function(t,e){return null!=a&&(e=t-a),n(Gp(i,t),e);}:function(t){return i.scale.getLabel(t);};}function Gp(t,e){return"category"===t.type?t.scale.getLabel(e):e;}function Fp(t){var e=t.get("interval");return null==e?"auto":e;}function Wp(t){return"category"===t.type&&0===Fp(t.getLabelModel());}E(["contain","normalize"],function(e){Op.prototype[e]=function(t){return t=Np(t)/Np(this.base),Ap[e].call(this,t);};}),Op.create=function(){return new Op();};var Hp={getMin:function getMin(t){var e=this.option,i=t||null==e.rangeStart?e.min:e.rangeStart;return this.axis&&null!=i&&"dataMin"!==i&&"function"!=typeof i&&!F(i)&&(i=this.axis.scale.parse(i)),i;},getMax:function getMax(t){var e=this.option,i=t||null==e.rangeEnd?e.max:e.rangeEnd;return this.axis&&null!=i&&"dataMax"!==i&&"function"!=typeof i&&!F(i)&&(i=this.axis.scale.parse(i)),i;},getNeedCrossZero:function getNeedCrossZero(){var t=this.option;return null==t.rangeStart&&null==t.rangeEnd&&!t.scale;},getCoordSysModel:et,setRange:function setRange(t,e){this.option.rangeStart=t,this.option.rangeEnd=e;},resetRange:function resetRange(){this.option.rangeStart=this.option.rangeEnd=null;}},Zp=ds({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+a,n+o),t.lineTo(i-a,n+o),t.closePath();}}),Up=ds({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+a,n),t.lineTo(i,n+o),t.lineTo(i-a,n),t.closePath();}}),Xp=ds({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.x,n=e.y,a=e.width/5*3,o=Math.max(a,e.height),r=a/2,s=r*r/(o-r),l=n-o+r+s,u=Math.asin(s/r),h=Math.cos(u)*r,c=Math.sin(u),d=Math.cos(u),f=.6*r,p=.7*r;t.moveTo(i-h,l+s),t.arc(i,l,r,Math.PI-u,2*Math.PI+u),t.bezierCurveTo(i+h-c*f,l+s+d*f,i,n-p,i,n),t.bezierCurveTo(i,n-p,i-h+c*f,l+s+d*f,i-h,l+s),t.closePath();}}),Yp=ds({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.height,n=e.width,a=e.x,o=e.y,r=n/3*2;t.moveTo(a,o),t.lineTo(a+r,o+i),t.lineTo(a,o+i/4*3),t.lineTo(a-r,o+i),t.lineTo(a,o),t.closePath();}}),jp={line:function line(t,e,i,n,a){a.x1=t,a.y1=e+n/2,a.x2=t+i,a.y2=e+n/2;},rect:function rect(t,e,i,n,a){a.x=t,a.y=e,a.width=i,a.height=n;},roundRect:function roundRect(t,e,i,n,a){a.x=t,a.y=e,a.width=i,a.height=n,a.r=Math.min(i,n)/4;},square:function square(t,e,i,n,a){var o=Math.min(i,n);a.x=t,a.y=e,a.width=o,a.height=o;},circle:function circle(t,e,i,n,a){a.cx=t+i/2,a.cy=e+n/2,a.r=Math.min(i,n)/2;},diamond:function diamond(t,e,i,n,a){a.cx=t+i/2,a.cy=e+n/2,a.width=i,a.height=n;},pin:function pin(t,e,i,n,a){a.x=t+i/2,a.y=e+n/2,a.width=i,a.height=n;},arrow:function arrow(t,e,i,n,a){a.x=t+i/2,a.y=e+n/2,a.width=i,a.height=n;},triangle:function triangle(t,e,i,n,a){a.cx=t+i/2,a.cy=e+n/2,a.width=i,a.height=n;}},qp={};E({line:Ur,rect:Hr,roundRect:Hr,square:Hr,circle:Lr,diamond:Up,pin:Xp,arrow:Yp,triangle:Zp},function(t,e){qp[e]=new t();});var Kp=ds({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function calculateTextPosition(t,e,i){var n=dn(t,e,i),a=this.shape;return a&&"pin"===a.symbolType&&"inside"===e.textPosition&&(n.y=i.y+.4*i.height),n;},buildPath:function buildPath(t,e,i){var n=e.symbolType;if("none"!==n){var a=qp[n];a=a||qp[n="rect"],jp[n](e.x,e.y,e.width,e.height,a.shape),a.buildPath(t,a.shape,i);}}});function $p(t,e){if("image"!==this.type){var i=this.style,n=this.shape;n&&"line"===n.symbolType?i.stroke=t:this.__isEmptyBrush?(i.stroke=t,i.fill=e||"#fff"):(i.fill&&(i.fill=t),i.stroke&&(i.stroke=t)),this.dirty(!1);}}function Jp(t,e,i,n,a,o,r){var s,l=0===t.indexOf("empty");return l&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(s=0===t.indexOf("image://")?ms(t.slice(8),new bi(e,i,n,a),r?"center":"cover"):0===t.indexOf("path://")?gs(t.slice(7),{},new bi(e,i,n,a),r?"center":"cover"):new Kp({shape:{symbolType:t,x:e,y:i,width:n,height:a}})).__isEmptyBrush=l,s.setColor=$p,s.setColor(o),s;}var Qp={isDimensionStacked:Zf,enableDataStack:Hf,getStackedDimension:Uf};var tg=(Object.freeze||Object)({createList:function createList(t){return Xf(t.getSource(),t);},getLayoutRect:au,dataStack:Qp,createScale:function createScale(t,e){var i=e;dl.isInstance(e)||b(i=new dl(e),Hp);var n=Bp(i);return n.setExtent(t[0],t[1]),zp(n,i),n;},mixinAxisModelCommonMethods:function mixinAxisModelCommonMethods(t){b(t,Hp);},completeDimensions:Gf,createDimensions:Wf,createSymbol:Jp}),eg=1e-8;function ig(t,e){return Math.abs(t-e)<eg;}function ng(t,e,i){var n=0,a=t[0];if(!a)return!1;for(var o=1;o<t.length;o++){var r=t[o];n+=$o(a[0],a[1],r[0],r[1],e,i),a=r;}var s=t[0];return ig(a[0],s[0])&&ig(a[1],s[1])||(n+=$o(a[0],a[1],s[0],s[1],e,i)),0!==n;}function ag(t,e,i){if(this.name=t,this.geometries=e,i)i=[i[0],i[1]];else{var n=this.getBoundingRect();i=[n.x+n.width/2,n.y+n.height/2];}this.center=i;}function og(t,e,i){for(var n=[],a=e[0],o=e[1],r=0;r<t.length;r+=2){var s=t.charCodeAt(r)-64,l=t.charCodeAt(r+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),a=s+=a,o=l+=o,n.push([s/i,l/i]);}return n;}ag.prototype={constructor:ag,properties:null,getBoundingRect:function getBoundingRect(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,i=[e,e],n=[-e,-e],a=[],o=[],r=this.geometries,s=0;s<r.length;s++){if("polygon"===r[s].type)Io(r[s].exterior,a,o),St(i,i,a),Mt(n,n,o);}return 0===s&&(i[0]=i[1]=n[0]=n[1]=0),this._rect=new bi(i[0],i[1],n[0]-i[0],n[1]-i[1]);},contain:function contain(t){var e=this.getBoundingRect(),i=this.geometries;if(!e.contain(t[0],t[1]))return!1;t:for(var n=0,a=i.length;n<a;n++){if("polygon"===i[n].type){var o=i[n].exterior,r=i[n].interiors;if(ng(o,t[0],t[1])){for(var s=0;s<(r?r.length:0);s++){if(ng(r[s]))continue t;}return!0;}}}return!1;},transformTo:function transformTo(t,e,i,n){var a=this.getBoundingRect(),o=a.width/a.height;i?n=n||i/o:i=o*n;for(var r=new bi(t,e,i,n),s=a.calculateTransform(r),l=this.geometries,u=0;u<l.length;u++){if("polygon"===l[u].type){for(var h=l[u].exterior,c=l[u].interiors,d=0;d<h.length;d++){bt(h[d],h[d],s);}for(var f=0;f<(c?c.length:0);f++){for(d=0;d<c[f].length;d++){bt(c[f][d],c[f][d],s);}}}}(a=this._rect).copy(r),this.center=[a.x+a.width/2,a.y+a.height/2];},cloneShallow:function cloneShallow(t){null==t&&(t=this.name);var e=new ag(t,this.geometries,this.center);return e._rect=this._rect,e.transformTo=null,e;}};function rg(t){return function(t){if(!t.UTF8Encoding)return;var e=t.UTF8Scale;null==e&&(e=1024);for(var i=t.features,n=0;n<i.length;n++){for(var a=i[n].geometry,o=a.coordinates,r=a.encodeOffsets,s=0;s<o.length;s++){var l=o[s];if("Polygon"===a.type)o[s]=og(l,r[s],e);else if("MultiPolygon"===a.type)for(var u=0;u<l.length;u++){var h=l[u];l[u]=og(h,r[s][u],e);}}}t.UTF8Encoding=!1;}(t),N(M(t.features,function(t){return t.geometry&&t.properties&&0<t.geometry.coordinates.length;}),function(t){var e=t.properties,i=t.geometry,n=i.coordinates,a=[];"Polygon"===i.type&&a.push({type:"polygon",exterior:n[0],interiors:n.slice(1)}),"MultiPolygon"===i.type&&E(n,function(t){t[0]&&a.push({type:"polygon",exterior:t[0],interiors:t.slice(1)});});var o=new ag(e.name,a,e.cp);return o.properties=e,o;});}var sg=La();function lg(t){return"category"===t.type?function(t){var e=t.getLabelModel(),i=hg(t,e);return!e.get("show")||t.scale.isBlank()?{labels:[],labelCategoryInterval:i.labelCategoryInterval}:i;}(t):function(i){var t=i.scale.getTicks(),n=Vp(i);return{labels:N(t,function(t,e){return{formattedLabel:n(t,e),rawLabel:i.scale.getLabel(t),tickValue:t};})};}(t);}function ug(t,e){return"category"===t.type?function(t,e){var i,n,a=cg(t,"ticks"),o=Fp(e),r=dg(a,o);if(r)return r;e.get("show")&&!t.scale.isBlank()||(i=[]);if(O(o))i=gg(t,o,!0);else if("auto"===o){var s=hg(t,t.getLabelModel());n=s.labelCategoryInterval,i=N(s.labels,function(t){return t.tickValue;});}else i=pg(t,n=o,!0);return fg(a,o,{ticks:i,tickCategoryInterval:n});}(t,e):{ticks:t.scale.getTicks()};}function hg(t,e){var i,n=cg(t,"labels"),a=Fp(e),o=dg(n,a);return o||fg(n,a,{labels:O(a)?gg(t,a):pg(t,i="auto"===a?function(t){var e=sg(t).autoInterval;return null!=e?e:sg(t).autoInterval=t.calculateCategoryInterval();}(t):a),labelCategoryInterval:i});}function cg(t,e){return sg(t)[e]||(sg(t)[e]=[]);}function dg(t,e){for(var i=0;i<t.length;i++){if(t[i].key===e)return t[i].value;}}function fg(t,e,i){return t.push({key:e,value:i}),i;}function pg(t,e,i){var n=Vp(t),a=t.scale,o=a.getExtent(),r=t.getLabelModel(),s=[],l=Math.max((e||0)+1,1),u=o[0],h=a.count();0!==u&&1<l&&2<h/l&&(u=Math.round(Math.ceil(u/l)*l));var c=Wp(t),d=r.get("showMinLabel")||c,f=r.get("showMaxLabel")||c;d&&u!==o[0]&&g(o[0]);for(var p=u;p<=o[1];p+=l){g(p);}function g(t){s.push(i?t:{formattedLabel:n(t),rawLabel:a.getLabel(t),tickValue:t});}return f&&p-l!==o[1]&&g(o[1]),s;}function gg(t,i,n){var a=t.scale,o=Vp(t),r=[];return E(a.getTicks(),function(t){var e=a.getLabel(t);i(t,e)&&r.push(n?t:{formattedLabel:o(t),rawLabel:e,tickValue:t});}),r;}var mg=[0,1],vg=function vg(t,e,i){this.dim=t,this.scale=e,this._extent=i||[0,0],this.inverse=!1,this.onBand=!1;};function yg(t,e){var i=(t[1]-t[0])/e/2;t[0]+=i,t[1]-=i;}vg.prototype={constructor:vg,contain:function contain(t){var e=this._extent,i=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]);return i<=t&&t<=n;},containData:function containData(t){return this.contain(this.dataToCoord(t));},getExtent:function getExtent(){return this._extent.slice();},getPixelPrecision:function getPixelPrecision(t){return Ml(t||this.scale.getExtent(),this._extent);},setExtent:function setExtent(t,e){var i=this._extent;i[0]=t,i[1]=e;},dataToCoord:function dataToCoord(t,e){var i=this._extent,n=this.scale;return t=n.normalize(t),this.onBand&&"ordinal"===n.type&&yg(i=i.slice(),n.count()),yl(t,mg,i,e);},coordToData:function coordToData(t,e){var i=this._extent,n=this.scale;this.onBand&&"ordinal"===n.type&&yg(i=i.slice(),n.count());var a=yl(t,i,mg,e);return this.scale.scale(a);},pointToData:function pointToData(t,e){},getTicksCoords:function getTicksCoords(t){var e=(t=t||{}).tickModel||this.getTickModel(),i=N(ug(this,e).ticks,function(t){return{coord:this.dataToCoord(t),tickValue:t};},this);return function(t,e,i,n){var a=e.length;if(!t.onBand||i||!a)return;var o,r,s=t.getExtent();if(1===a)e[0].coord=s[0],o=e[1]={coord:s[0]};else{var l=e[a-1].tickValue-e[0].tickValue,u=(e[a-1].coord-e[0].coord)/l;E(e,function(t){t.coord-=u/2;});var h=t.scale.getExtent();r=1+h[1]-e[a-1].tickValue,o={coord:e[a-1].coord+u*r},e.push(o);}var c=s[0]>s[1];d(e[0].coord,s[0])&&(n?e[0].coord=s[0]:e.shift());n&&d(s[0],e[0].coord)&&e.unshift({coord:s[0]});d(s[1],o.coord)&&(n?o.coord=s[1]:e.pop());n&&d(o.coord,s[1])&&e.push({coord:s[1]});function d(t,e){return t=_l(t),e=_l(e),c?e<t:t<e;}}(this,i,e.get("alignWithLabel"),t.clamp),i;},getViewLabels:function getViewLabels(){return lg(this).labels;},getLabelModel:function getLabelModel(){return this.model.getModel("axisLabel");},getTickModel:function getTickModel(){return this.model.getModel("axisTick");},getBandWidth:function getBandWidth(){var t=this._extent,e=this.scale.getExtent(),i=e[1]-e[0]+(this.onBand?1:0);0===i&&(i=1);var n=Math.abs(t[1]-t[0]);return Math.abs(n)/i;},isHorizontal:null,getRotate:null,calculateCategoryInterval:function calculateCategoryInterval(){return function(t){var e=function(t){var e=t.getLabelModel();return{axisRotate:t.getRotate?t.getRotate():t.isHorizontal&&!t.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()};}(t),i=Vp(t),n=(e.axisRotate-e.labelRotate)/180*Math.PI,a=t.scale,o=a.getExtent(),r=a.count();if(o[1]-o[0]<1)return 0;var s=1;40<r&&(s=Math.max(1,Math.floor(r/40)));for(var l=o[0],u=t.dataToCoord(l+1)-t.dataToCoord(l),h=Math.abs(u*Math.cos(n)),c=Math.abs(u*Math.sin(n)),d=0,f=0;l<=o[1];l+=s){var p,g,m=un(i(l),e.font,"center","top");p=1.3*m.width,g=1.3*m.height,d=Math.max(d,p,7),f=Math.max(f,g,7);}var v=d/h,y=f/c;isNaN(v)&&(v=1/0),isNaN(y)&&(y=1/0);var x=Math.max(0,Math.floor(Math.min(v,y))),_=sg(t.model),w=t.getExtent(),b=_.lastAutoInterval,S=_.lastTickCount;return null!=b&&null!=S&&Math.abs(b-x)<=1&&Math.abs(S-r)<=1&&x<b&&_.axisExtend0===w[0]&&_.axisExtend1===w[1]?x=b:(_.lastTickCount=r,_.lastAutoInterval=x,_.axisExtend0=w[0],_.axisExtend1=w[1]),x;}(this);}};var xg=rg,_g={};E(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],function(t){_g[t]=it[t];});var wg={};function bg(t,e){var i=t.mapDimension("defaultedLabel",!0),n=i.length;if(1===n)return Mh(t,e,i[0]);if(n){for(var a=[],o=0;o<i.length;o++){var r=Mh(t,e,i[o]);a.push(r);}return a.join(" ");}}function Sg(t,e,i){Si.call(this),this.updateData(t,e,i);}E(["extendShape","extendPath","makePath","makeImage","mergePath","resizePath","createIcon","setHoverStyle","setLabelStyle","setTextStyle","setText","getFont","updateProps","initProps","getTransform","clipPointsByRect","clipRectByRect","registerShape","getShapeClass","Group","Image","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","IncrementalDisplayable","CompoundPath","LinearGradient","RadialGradient","BoundingRect"],function(t){wg[t]=ol[t];}),Wh.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this);},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clip:!0,label:{position:"top"},lineStyle:{width:2,type:"solid"},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});var Mg=Sg.prototype,Ig=Sg.getSymbolSize=function(t,e){var i=t.getItemVisual(e,"symbolSize");return i instanceof Array?i.slice():[+i,+i];};function Ag(t){return[t[0]/2,t[1]/2];}function Tg(t,e){this.parent.drift(t,e);}Mg._createSymbol=function(t,e,i,n,a){this.removeAll();var o=Jp(t,-1,-1,2,2,e.getItemVisual(i,"color"),a);o.attr({z2:100,culling:!0,scale:Ag(n)}),o.drift=Tg,this._symbolType=t,this.add(o);},Mg.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(t);},Mg.getSymbolPath=function(){return this.childAt(0);},Mg.getScale=function(){return this.childAt(0).scale;},Mg.highlight=function(){this.childAt(0).trigger("emphasis");},Mg.downplay=function(){this.childAt(0).trigger("normal");},Mg.setZ=function(t,e){var i=this.childAt(0);i.zlevel=t,i.z=e;},Mg.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":e.cursor;},Mg.updateData=function(t,e,i){this.silent=!1;var n=t.getItemVisual(e,"symbol")||"circle",a=t.hostModel,o=Ig(t,e),r=n!==this._symbolType;if(r){var s=t.getItemVisual(e,"symbolKeepAspect");this._createSymbol(n,t,e,o,s);}else{(l=this.childAt(0)).silent=!1,js(l,{scale:Ag(o)},a,e);}if(this._updateCommon(t,e,o,i),r){var l=this.childAt(0),u=i&&i.fadeIn,h={scale:l.scale.slice()};u&&(h.style={opacity:l.style.opacity}),l.scale=[0,0],u&&(l.style.opacity=0),qs(l,h,a,e);}this._seriesModel=a;};var Dg=["itemStyle"],Cg=["emphasis","itemStyle"],Lg=["label"],kg=["emphasis","label"];function Pg(t,e){if(!this.incremental&&!this.useHoverLayer)if("emphasis"===e){var i=this.__symbolOriginalScale,n=i[1]/i[0],a={scale:[Math.max(1.1*i[0],i[0]+3),Math.max(1.1*i[1],i[1]+3*n)]};this.animateTo(a,400,"elasticOut");}else"normal"===e&&this.animateTo({scale:this.__symbolOriginalScale},400,"elasticOut");}function Ng(t){this.group=new Si(),this._symbolCtor=t||Sg;}Mg._updateCommon=function(i,t,e,n){var a=this.childAt(0),o=i.hostModel,r=i.getItemVisual(t,"color");"image"!==a.type?a.useStyle({strokeNoScale:!0}):a.setStyle({opacity:null,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,shadowColor:null});var s=n&&n.itemStyle,l=n&&n.hoverItemStyle,u=n&&n.symbolRotate,h=n&&n.symbolOffset,c=n&&n.labelModel,d=n&&n.hoverLabelModel,f=n&&n.hoverAnimation,p=n&&n.cursorStyle;if(!n||i.hasItemOption){var g=n&&n.itemModel?n.itemModel:i.getItemModel(t);s=g.getModel(Dg).getItemStyle(["color"]),l=g.getModel(Cg).getItemStyle(),u=g.getShallow("symbolRotate"),h=g.getShallow("symbolOffset"),c=g.getModel(Lg),d=g.getModel(kg),f=g.getShallow("hoverAnimation"),p=g.getShallow("cursor");}else l=L({},l);var m=a.style;a.attr("rotation",(u||0)*Math.PI/180||0),h&&a.attr("position",[xl(h[0],e[0]),xl(h[1],e[1])]),p&&a.attr("cursor",p),a.setColor(r,n&&n.symbolInnerColor),a.setStyle(s);var v=i.getItemVisual(t,"opacity");null!=v&&(m.opacity=v);var y=i.getItemVisual(t,"liftZ"),x=a.__z2Origin;null!=y?null==x&&(a.__z2Origin=a.z2,a.z2+=y):null!=x&&(a.z2=x,a.__z2Origin=null);var _=n&&n.useNameLabel;Bs(m,l,c,d,{labelFetcher:o,labelDataIndex:t,defaultText:function defaultText(t,e){return _?i.getName(t):bg(i,t);},isRectText:!0,autoColor:r}),a.__symbolOriginalScale=Ag(e),a.hoverStyle=l,a.highDownOnUpdate=f&&o.isAnimationEnabled()?Pg:null,Os(a);},Mg.fadeOut=function(t,e){var i=this.childAt(0);this.silent=i.silent=!0,e&&e.keepLabel||(i.style.text=null),js(i,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,t);},w(Sg,Si);var Og=Ng.prototype;function Eg(t,e,i,n){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(n.isIgnore&&n.isIgnore(i))&&!(n.clipShape&&!n.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(i,"symbol");}function Rg(t){return null==t||z(t)||(t={isIgnore:t}),t||{};}function zg(t){var e=t.hostModel;return{itemStyle:e.getModel("itemStyle").getItemStyle(["color"]),hoverItemStyle:e.getModel("emphasis.itemStyle").getItemStyle(),symbolRotate:e.get("symbolRotate"),symbolOffset:e.get("symbolOffset"),hoverAnimation:e.get("hoverAnimation"),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label"),cursorStyle:e.get("cursor")};}function Bg(t,e,i){var n,a=t.getBaseAxis(),o=t.getOtherAxis(a),r=function(t,e){var i=0,n=t.scale.getExtent();"start"===e?i=n[0]:"end"===e?i=n[1]:0<n[0]?i=n[0]:n[1]<0&&(i=n[1]);return i;}(o,i),s=a.dim,l=o.dim,u=e.mapDimension(l),h=e.mapDimension(s),c="x"===l||"radius"===l?1:0,d=N(t.dimensions,function(t){return e.mapDimension(t);}),f=e.getCalculationInfo("stackResultDimension");return(n|=Zf(e,d[0]))&&(d[0]=f),(n|=Zf(e,d[1]))&&(d[1]=f),{dataDimsForPoint:d,valueStart:r,valueAxisDim:l,baseAxisDim:s,stacked:!!n,valueDim:u,baseDim:h,baseDataOffset:c,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")};}function Vg(t,e,i,n){var a=NaN;t.stacked&&(a=i.get(i.getCalculationInfo("stackedOverDimension"),n)),isNaN(a)&&(a=t.valueStart);var o=t.baseDataOffset,r=[];return r[o]=i.get(t.baseDim,n),r[1-o]=a,e.dataToPoint(r);}Og.updateData=function(a,o){o=Rg(o);var r=this.group,s=a.hostModel,l=this._data,u=this._symbolCtor,h=zg(a);l||r.removeAll(),a.diff(l).add(function(t){var e=a.getItemLayout(t);if(Eg(a,e,t,o)){var i=new u(a,t,h);i.attr("position",e),a.setItemGraphicEl(t,i),r.add(i);}}).update(function(t,e){var i=l.getItemGraphicEl(e),n=a.getItemLayout(t);Eg(a,n,t,o)?(i?(i.updateData(a,t,h),js(i,{position:n},s)):(i=new u(a,t)).attr("position",n),r.add(i),a.setItemGraphicEl(t,i)):r.remove(i);}).remove(function(t){var e=l.getItemGraphicEl(t);e&&e.fadeOut(function(){r.remove(e);});}).execute(),this._data=a;},Og.isPersistent=function(){return!0;},Og.updateLayout=function(){var n=this._data;n&&n.eachItemGraphicEl(function(t,e){var i=n.getItemLayout(e);t.attr("position",i);});},Og.incrementalPrepareUpdate=function(t){this._seriesScope=zg(t),this._data=null,this.group.removeAll();},Og.incrementalUpdate=function(t,e,i){function n(t){t.isGroup||(t.incremental=t.useHoverLayer=!0);}i=Rg(i);for(var a=t.start;a<t.end;a++){var o=e.getItemLayout(a);if(Eg(e,o,a,i)){var r=new this._symbolCtor(e,a,this._seriesScope);r.traverse(n),r.attr("position",o),this.group.add(r),e.setItemGraphicEl(a,r);}}},Og.remove=function(t){var e=this.group,i=this._data;i&&t?i.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t);});}):e.removeAll();};var Gg=St,Fg=Mt,Wg=ut,Hg=ot,Zg=[],Ug=[],Xg=[];function Yg(t){return isNaN(t[0])||isNaN(t[1]);}function jg(t,e,i,n,a,o,r,s,l,u){return"none"!==u&&u?function(t,e,i,n,a,o,r,s,l,u,h){for(var c=0,d=i,f=0;f<n;f++){var p=e[d];if(a<=d||d<0)break;if(Yg(p)){if(h){d+=o;continue;}break;}if(d===i)t[0<o?"moveTo":"lineTo"](p[0],p[1]);else if(0<l){var g=e[c],m="y"===u?1:0,v=(p[m]-g[m])*l;Hg(Ug,g),Ug[m]=g[m]+v,Hg(Xg,p),Xg[m]=p[m]-v,t.bezierCurveTo(Ug[0],Ug[1],Xg[0],Xg[1],p[0],p[1]);}else t.lineTo(p[0],p[1]);c=d,d+=o;}return f;}.apply(this,arguments):function(t,e,i,n,a,o,r,s,l,u,h){for(var c=0,d=i,f=0;f<n;f++){var p=e[d];if(a<=d||d<0)break;if(Yg(p)){if(h){d+=o;continue;}break;}if(d===i)t[0<o?"moveTo":"lineTo"](p[0],p[1]),Hg(Ug,p);else if(0<l){var g=d+o,m=e[g];if(h)for(;m&&Yg(e[g]);){m=e[g+=o];}var v=.5,y=e[c];if(!(m=e[g])||Yg(m))Hg(Xg,p);else{var x,_;if(Yg(m)&&!h&&(m=p),ht(Zg,m,y),"x"===u||"y"===u){var w="x"===u?0:1;x=Math.abs(p[w]-y[w]),_=Math.abs(p[w]-m[w]);}else x=yt(p,y),_=yt(p,m);Wg(Xg,p,Zg,-l*(1-(v=_/(_+x))));}Gg(Ug,Ug,s),Fg(Ug,Ug,r),Gg(Xg,Xg,s),Fg(Xg,Xg,r),t.bezierCurveTo(Ug[0],Ug[1],Xg[0],Xg[1],p[0],p[1]),Wg(Ug,p,Zg,l*v);}else t.lineTo(p[0],p[1]);c=d,d+=o;}return f;}.apply(this,arguments);}function qg(t,e){var i=[1/0,1/0],n=[-1/0,-1/0];if(e)for(var a=0;a<t.length;a++){var o=t[a];o[0]<i[0]&&(i[0]=o[0]),o[1]<i[1]&&(i[1]=o[1]),o[0]>n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1]);}return{min:e?i:n,max:e?n:i};}var Kg=hr.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:Cr(hr.prototype.brush),buildPath:function buildPath(t,e){var i=e.points,n=0,a=i.length,o=qg(i,e.smoothConstraint);if(e.connectNulls){for(;0<a&&Yg(i[a-1]);a--){;}for(;n<a&&Yg(i[n]);n++){;}}for(;n<a;){n+=jg(t,i,n,a,a,1,o.min,o.max,e.smooth,e.smoothMonotone,e.connectNulls)+1;}}}),$g=hr.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:Cr(hr.prototype.brush),buildPath:function buildPath(t,e){var i=e.points,n=e.stackedOnPoints,a=0,o=i.length,r=e.smoothMonotone,s=qg(i,e.smoothConstraint),l=qg(n,e.smoothConstraint);if(e.connectNulls){for(;0<o&&Yg(i[o-1]);o--){;}for(;a<o&&Yg(i[a]);a++){;}}for(;a<o;){var u=jg(t,i,a,o,o,1,s.min,s.max,e.smooth,r,e.connectNulls);jg(t,n,a+u-1,u,o,-1,l.min,l.max,e.stackedOnSmooth,r,e.connectNulls),a+=u+1,t.closePath();}}});function Jg(t,e,i){var n=t.getArea(),a=t.getBaseAxis().isHorizontal(),o=n.x,r=n.y,s=n.width,l=n.height,u=i.get("lineStyle.width")||2,h=new Hr({shape:{x:o-=u/2,y:r-=u/2,width:s+=u,height:l+=u}});return e&&(h.shape[a?"width":"height"]=0,qs(h,{shape:{width:s,height:l}},i)),h;}function Qg(t,e,i){var n=t.getArea(),a=new Pr({shape:{cx:_l(t.cx,1),cy:_l(t.cy,1),r0:_l(n.r0,1),r:_l(n.r,1),startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});return e&&(a.shape.endAngle=n.startAngle,qs(a,{shape:{endAngle:n.endAngle}},i)),a;}function tm(t,e,i){return t?"polar"===t.type?Qg(t,e,i):"cartesian2d"===t.type?Jg(t,e,i):null:null;}function em(t,e){if(t.length===e.length){for(var i=0;i<t.length;i++){var n=t[i],a=e[i];if(n[0]!==a[0]||n[1]!==a[1])return;}return!0;}}function im(t){return"number"==typeof t?t:t?.5:0;}function nm(t,e,i){for(var n=e.getBaseAxis(),a="x"===n.dim||"radius"===n.dim?0:1,o=[],r=0;r<t.length-1;r++){var s=t[r+1],l=t[r];o.push(l);var u=[];switch(i){case"end":u[a]=s[a],u[1-a]=l[1-a],o.push(u);break;case"middle":var h=(l[a]+s[a])/2,c=[];u[a]=c[a]=h,u[1-a]=l[1-a],c[1-a]=s[1-a],o.push(u),o.push(c);break;default:u[a]=l[a],u[1-a]=s[1-a],o.push(u);}}return t[r]&&o.push(t[r]),o;}function am(t,e,i){var n=t.get("showAllSymbol"),a="auto"===n;if(!n||a){var o=i.getAxesByScale("ordinal")[0];if(o&&(!a||!function(t,e){var i=t.getExtent(),n=Math.abs(i[1]-i[0])/t.scale.count();isNaN(n)&&(n=0);for(var a=e.count(),o=Math.max(1,Math.round(a/5)),r=0;r<a;r+=o){if(1.5*Sg.getSymbolSize(e,r)[t.isHorizontal()?1:0]>n)return!1;}return!0;}(o,e))){var r=e.mapDimension(o.dim),s={};return E(o.getViewLabels(),function(t){s[t.tickValue]=1;}),function(t){return!s.hasOwnProperty(e.get(r,t));};}}}function om(t,e,i){if("cartesian2d"!==t.type)return Qg(t,e,i);var n=t.getBaseAxis().isHorizontal(),a=Jg(t,e,i);if(!i.get("clip",!0)){var o=a.shape,r=Math.max(o.width,o.height);n?(o.y-=r,o.height+=2*r):(o.x-=r,o.width+=2*r);}return a;}ec.extend({type:"line",init:function init(){var t=new Si(),e=new Ng();this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t;},render:function render(t,e,i){var n=t.coordinateSystem,a=this.group,o=t.getData(),r=t.getModel("lineStyle"),s=t.getModel("areaStyle"),l=o.mapArray(o.getItemLayout),u="polar"===n.type,h=this._coordSys,c=this._symbolDraw,d=this._polyline,f=this._polygon,p=this._lineGroup,g=t.get("animation"),m=!s.isEmpty(),v=s.get("origin"),y=function(t,e,i){if(!i.valueDim)return[];for(var n=[],a=0,o=e.count();a<o;a++){n.push(Vg(i,t,e,a));}return n;}(n,o,Bg(n,o,v)),x=t.get("showSymbol"),_=x&&!u&&am(t,o,n),w=this._data;w&&w.eachItemGraphicEl(function(t,e){t.__temp&&(a.remove(t),w.setItemGraphicEl(e,null));}),x||c.remove(),a.add(p);var b,S=!u&&t.get("step");n&&n.getArea&&(null!=(b=n.getArea()).width?(b.x-=.1,b.y-=.1,b.width+=.2,b.height+=.2):b.r0&&(b.r0-=.5,b.r1+=.5)),d&&h.type===n.type&&S===this._step?(m&&!f?f=this._newPolygon(l,y,n,g):f&&!m&&(p.remove(f),f=this._polygon=null),p.setClipPath(om(n,!1,t)),x&&c.updateData(o,{isIgnore:_,clipShape:b}),o.eachItemGraphicEl(function(t){t.stopAnimation(!0);}),em(this._stackedOnPoints,y)&&em(this._points,l)||(g?this._updateAnimation(o,y,n,i,S,v):(S&&(l=nm(l,n,S),y=nm(y,n,S)),d.setShape({points:l}),f&&f.setShape({points:l,stackedOnPoints:y})))):(x&&c.updateData(o,{isIgnore:_,clipShape:b}),S&&(l=nm(l,n,S),y=nm(y,n,S)),d=this._newPolyline(l,n,g),m&&(f=this._newPolygon(l,y,n,g)),p.setClipPath(om(n,!0,t)));var M=function(t,e){var i=t.getVisual("visualMeta");if(i&&i.length&&t.count()&&"cartesian2d"===e.type){for(var n,a,o=i.length-1;0<=o;o--){var r=i[o].dimension,s=t.dimensions[r],l=t.getDimensionInfo(s);if("x"===(n=l&&l.coordDim)||"y"===n){a=i[o];break;}}if(a){var u=e.getAxis(n),h=N(a.stops,function(t){return{coord:u.toGlobalCoord(u.dataToCoord(t.value)),color:t.color};}),c=h.length,d=a.outerColors.slice();c&&h[0].coord>h[c-1].coord&&(h.reverse(),d.reverse());var f=h[0].coord-10,p=h[c-1].coord+10,g=p-f;if(g<.001)return"transparent";E(h,function(t){t.offset=(t.coord-f)/g;}),h.push({offset:c?h[c-1].offset:.5,color:d[1]||"transparent"}),h.unshift({offset:c?h[0].offset:.5,color:d[0]||"transparent"});var m=new Jr(0,0,0,0,h,!0);return m[n]=f,m[n+"2"]=p,m;}}}(o,n)||o.getVisual("color");d.useStyle(C(r.getLineStyle(),{fill:"none",stroke:M,lineJoin:"bevel"}));var I=t.get("smooth");if(I=im(t.get("smooth")),d.setShape({smooth:I,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")}),f){var A=o.getCalculationInfo("stackedOnSeries"),T=0;f.useStyle(C(s.getAreaStyle(),{fill:M,opacity:.7,lineJoin:"bevel"})),A&&(T=im(A.get("smooth"))),f.setShape({smooth:I,stackedOnSmooth:T,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")});}this._data=o,this._coordSys=n,this._stackedOnPoints=y,this._points=l,this._step=S,this._valueOrigin=v;},dispose:function dispose(){},highlight:function highlight(t,e,i,n){var a=t.getData(),o=Ca(a,n);if(!(o instanceof Array)&&null!=o&&0<=o){var r=a.getItemGraphicEl(o);if(!r){var s=a.getItemLayout(o);if(!s)return;(r=new Sg(a,o)).position=s,r.setZ(t.get("zlevel"),t.get("z")),r.ignore=isNaN(s[0])||isNaN(s[1]),r.__temp=!0,a.setItemGraphicEl(o,r),r.stopSymbolAnimation(!0),this.group.add(r);}r.highlight();}else ec.prototype.highlight.call(this,t,e,i,n);},downplay:function downplay(t,e,i,n){var a=t.getData(),o=Ca(a,n);if(null!=o&&0<=o){var r=a.getItemGraphicEl(o);r&&(r.__temp?(a.setItemGraphicEl(o,null),this.group.remove(r)):r.downplay());}else ec.prototype.downplay.call(this,t,e,i,n);},_newPolyline:function _newPolyline(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new Kg({shape:{points:t},silent:!0,z2:10}),this._lineGroup.add(e),this._polyline=e;},_newPolygon:function _newPolygon(t,e){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new $g({shape:{points:t,stackedOnPoints:e},silent:!0}),this._lineGroup.add(i),this._polygon=i;},_updateAnimation:function _updateAnimation(t,e,i,n,a,o){var r=this._polyline,s=this._polygon,l=t.hostModel,u=function(t,e,i,n,a,o,r,s){for(var l=function(t,e){var i=[];return e.diff(t).add(function(t){i.push({cmd:"+",idx:t});}).update(function(t,e){i.push({cmd:"=",idx:e,idx1:t});}).remove(function(t){i.push({cmd:"-",idx:t});}).execute(),i;}(t,e),u=[],h=[],c=[],d=[],f=[],p=[],g=[],m=Bg(a,e,r),v=Bg(o,t,s),y=0;y<l.length;y++){var x=l[y],_=!0;switch(x.cmd){case"=":var w=t.getItemLayout(x.idx),b=e.getItemLayout(x.idx1);(isNaN(w[0])||isNaN(w[1]))&&(w=b.slice()),u.push(w),h.push(b),c.push(i[x.idx]),d.push(n[x.idx1]),g.push(e.getRawIndex(x.idx1));break;case"+":var S=x.idx;u.push(a.dataToPoint([e.get(m.dataDimsForPoint[0],S),e.get(m.dataDimsForPoint[1],S)])),h.push(e.getItemLayout(S).slice()),c.push(Vg(m,a,e,S)),d.push(n[S]),g.push(e.getRawIndex(S));break;case"-":S=x.idx;var M=t.getRawIndex(S);M!==S?(u.push(t.getItemLayout(S)),h.push(o.dataToPoint([t.get(v.dataDimsForPoint[0],S),t.get(v.dataDimsForPoint[1],S)])),c.push(i[S]),d.push(Vg(v,o,t,S)),g.push(M)):_=!1;}_&&(f.push(x),p.push(p.length));}p.sort(function(t,e){return g[t]-g[e];});var I=[],A=[],T=[],D=[],C=[];for(y=0;y<p.length;y++){S=p[y];I[y]=u[S],A[y]=h[S],T[y]=c[S],D[y]=d[S],C[y]=f[S];}return{current:I,next:A,stackedOnCurrent:T,stackedOnNext:D,status:C};}(this._data,t,this._stackedOnPoints,e,this._coordSys,i,this._valueOrigin,o),h=u.current,c=u.stackedOnCurrent,d=u.next,f=u.stackedOnNext;a&&(h=nm(u.current,i,a),c=nm(u.stackedOnCurrent,i,a),d=nm(u.next,i,a),f=nm(u.stackedOnNext,i,a)),r.shape.__points=u.current,r.shape.points=h,js(r,{shape:{points:d}},l),s&&(s.setShape({points:h,stackedOnPoints:c}),js(s,{shape:{points:d,stackedOnPoints:f}},l));for(var p=[],g=u.status,m=0;m<g.length;m++){if("="===g[m].cmd){var v=t.getItemGraphicEl(g[m].idx1);v&&p.push({el:v,ptIdx:m});}}r.animators&&r.animators.length&&r.animators[0].during(function(){for(var t=0;t<p.length;t++){p[t].el.attr("position",r.shape.__points[p[t].ptIdx]);}});},remove:function remove(t){var i=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl(function(t,e){t.__temp&&(i.remove(t),n.setItemGraphicEl(e,null));}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null;}});function rm(t,r,s){return{seriesType:t,performRawSeries:!0,reset:function reset(l,t,e){var i=l.getData(),u=l.get("symbol"),h=l.get("symbolSize"),n=l.get("symbolKeepAspect"),c=O(u),d=O(h),f=c||d,a=!c&&u?u:r,o=d?null:h;if(i.setVisual({legendSymbol:s||a,symbol:a,symbolSize:o,symbolKeepAspect:n}),!t.isSeriesFiltered(l))return{dataEach:i.hasItemOption||f?function(t,e){if(f){var i=l.getRawValue(e),n=l.getDataParams(e);c&&t.setItemVisual(e,"symbol",u(i,n)),d&&t.setItemVisual(e,"symbolSize",h(i,n));}if(t.hasItemOption){var a=t.getItemModel(e),o=a.getShallow("symbol",!0),r=a.getShallow("symbolSize",!0),s=a.getShallow("symbolKeepAspect",!0);null!=o&&t.setItemVisual(e,"symbol",o),null!=r&&t.setItemVisual(e,"symbolSize",r),null!=s&&t.setItemVisual(e,"symbolKeepAspect",s);}}:null};}};}function sm(t){return{seriesType:t,plan:Jh(),reset:function reset(t){var e=t.getData(),c=t.coordinateSystem,d=t.pipelineContext.large;if(c){var f=N(c.dimensions,function(t){return e.mapDimension(t);}).slice(0,2),p=f.length,i=e.getCalculationInfo("stackResultDimension");return Zf(e,f[0])&&(f[0]=i),Zf(e,f[1])&&(f[1]=i),p&&{progress:function progress(t,e){for(var i=t.end-t.start,n=d&&new Float32Array(i*p),a=t.start,o=0,r=[],s=[];a<t.end;a++){var l;if(1===p){var u=e.get(f[0],a);l=!isNaN(u)&&c.dataToPoint(u,null,s);}else{u=r[0]=e.get(f[0],a);var h=r[1]=e.get(f[1],a);l=!isNaN(u)&&!isNaN(h)&&c.dataToPoint(r,null,s);}d?(n[o++]=l?l[0]:NaN,n[o++]=l?l[1]:NaN):e.setItemLayout(a,l&&l.slice()||[NaN,NaN]);}d&&e.setLayout("symbolPoints",n);}};}}};}function lm(t,e){return Math.round(t.length/2);}var um={average:function average(t){for(var e=0,i=0,n=0;n<t.length;n++){isNaN(t[n])||(e+=t[n],i++);}return 0===i?NaN:e/i;},sum:function sum(t){for(var e=0,i=0;i<t.length;i++){e+=t[i]||0;}return e;},max:function max(t){for(var e=-1/0,i=0;i<t.length;i++){t[i]>e&&(e=t[i]);}return isFinite(e)?e:NaN;},min:function min(t){for(var e=1/0,i=0;i<t.length;i++){t[i]<e&&(e=t[i]);}return isFinite(e)?e:NaN;},nearest:function nearest(t){return t[0];}};function hm(t){return this._axes[t];}function cm(t){this._axes={},this._dimList=[],this.name=t||"";}function dm(t){cm.call(this,t);}cm.prototype={constructor:cm,type:"cartesian",getAxis:function getAxis(t){return this._axes[t];},getAxes:function getAxes(){return N(this._dimList,hm,this);},getAxesByScale:function getAxesByScale(e){return e=e.toLowerCase(),M(this.getAxes(),function(t){return t.scale.type===e;});},addAxis:function addAxis(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e);},dataToCoord:function dataToCoord(t){return this._dataCoordConvert(t,"dataToCoord");},coordToData:function coordToData(t){return this._dataCoordConvert(t,"coordToData");},_dataCoordConvert:function _dataCoordConvert(t,e){for(var i=this._dimList,n=t instanceof Array?[]:{},a=0;a<i.length;a++){var o=i[a],r=this._axes[o];n[o]=r[e](t[o]);}return n;}},dm.prototype={constructor:dm,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x");},containPoint:function containPoint(t){var e=this.getAxis("x"),i=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]));},containData:function containData(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1]);},dataToPoint:function dataToPoint(t,e,i){var n=this.getAxis("x"),a=this.getAxis("y");return(i=i||[])[0]=n.toGlobalCoord(n.dataToCoord(t[0])),i[1]=a.toGlobalCoord(a.dataToCoord(t[1])),i;},clampData:function clampData(t,e){var i=this.getAxis("x").scale,n=this.getAxis("y").scale,a=i.getExtent(),o=n.getExtent(),r=i.parse(t[0]),s=n.parse(t[1]);return(e=e||[])[0]=Math.min(Math.max(Math.min(a[0],a[1]),r),Math.max(a[0],a[1])),e[1]=Math.min(Math.max(Math.min(o[0],o[1]),s),Math.max(o[0],o[1])),e;},pointToData:function pointToData(t,e){var i=this.getAxis("x"),n=this.getAxis("y");return(e=e||[])[0]=i.coordToData(i.toLocalCoord(t[0])),e[1]=n.coordToData(n.toLocalCoord(t[1])),e;},getOtherAxis:function getOtherAxis(t){return this.getAxis("x"===t.dim?"y":"x");},getArea:function getArea(){var t=this.getAxis("x").getGlobalExtent(),e=this.getAxis("y").getGlobalExtent(),i=Math.min(t[0],t[1]),n=Math.min(e[0],e[1]);return new bi(i,n,Math.max(t[0],t[1])-i,Math.max(e[0],e[1])-n);}},w(dm,cm);function fm(t,e,i,n,a){vg.call(this,t,e,i),this.type=n||"value",this.position=a||"bottom";}fm.prototype={constructor:fm,index:0,getAxesOnZeroOf:null,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},getGlobalExtent:function getGlobalExtent(t){var e=this.getExtent();return e[0]=this.toGlobalCoord(e[0]),e[1]=this.toGlobalCoord(e[1]),t&&e[0]>e[1]&&e.reverse(),e;},getOtherAxis:function getOtherAxis(){this.grid.getOtherAxis();},pointToData:function pointToData(t,e){return this.coordToData(this.toLocalCoord(t["x"===this.dim?0:1]),e);},toLocalCoord:null,toGlobalCoord:null},w(fm,vg);var pm={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},gm={};gm.categoryAxis=m({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},pm),gm.valueAxis=m({boundaryGap:[0,0],splitNumber:5},pm),gm.timeAxis=C({scale:!0,min:"dataMin",max:"dataMax"},gm.valueAxis),gm.logAxis=C({scale:!0,logBase:10},gm.valueAxis);function mm(o,t,r,e){E(vm,function(a){t.extend({type:o+"Axis."+a,mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){var i=this.layoutMode,n=i?su(t):{};m(t,e.getTheme().get(a+"Axis")),m(t,this.getDefaultOption()),t.type=r(o,t),i&&ru(t,n,i);},optionUpdated:function optionUpdated(){"category"===this.option.type&&(this.__ordinalMeta=jf.createByAxisModel(this));},getCategories:function getCategories(t){var e=this.option;if("category"===e.type)return t?e.data:this.__ordinalMeta.categories;},getOrdinalMeta:function getOrdinalMeta(){return this.__ordinalMeta;},defaultOption:p([{},gm[a+"Axis"],e],!0)});}),fu.registerSubTypeDefaulter(o+"Axis",A(r,o));}var vm=["value","category","time","log"],ym=fu.extend({type:"cartesian2dAxis",axis:null,init:function init(){ym.superApply(this,"init",arguments),this.resetRange();},mergeOption:function mergeOption(){ym.superApply(this,"mergeOption",arguments),this.resetRange();},restoreData:function restoreData(){ym.superApply(this,"restoreData",arguments),this.resetRange();},getCoordSysModel:function getCoordSysModel(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0];}});function xm(t,e){return e.type||(e.data?"category":"value");}m(ym.prototype,Hp);var _m={offset:0};function wm(t,e){return t.getCoordSysModel()===e;}function bm(t,e,i){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(t,e,i),this.model=t;}mm("x",ym,xm,_m),mm("y",ym,xm,_m),fu.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});var Sm=bm.prototype;function Mm(t,e,i,n){i.getAxesOnZeroOf=function(){return a?[a]:[];};var a,o=t[e],r=i.model,s=r.get("axisLine.onZero"),l=r.get("axisLine.onZeroAxisIndex");if(s){if(null!=l)Im(o[l])&&(a=o[l]);else for(var u in o){if(o.hasOwnProperty(u)&&Im(o[u])&&!n[h(o[u])]){a=o[u];break;}}a&&(n[h(a)]=!0);}function h(t){return t.dim+"_"+t.index;}}function Im(t){return t&&"category"!==t.type&&"time"!==t.type&&function(t){var e=t.scale.getExtent(),i=e[0],n=e[1];return!(0<i&&0<n||i<0&&n<0);}(t);}Sm.type="grid",Sm.axisPointerEnabled=!0,Sm.getRect=function(){return this._rect;},Sm.update=function(t,e){var i=this._axesMap;this._updateScale(t,this.model),E(i.x,function(t){zp(t.scale,t.model);}),E(i.y,function(t){zp(t.scale,t.model);});var n={};E(i.x,function(t){Mm(i,"y",t,n);}),E(i.y,function(t){Mm(i,"x",t,n);}),this.resize(this.model,e);},Sm.resize=function(t,e,i){var a=au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});this._rect=a;var n=this._axesList;function o(){E(n,function(t){var e=t.isHorizontal(),i=e?[0,a.width]:[0,a.height],n=t.inverse?1:0;t.setExtent(i[n],i[1-n]),function(t,e){var i=t.getExtent(),n=i[0]+i[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord="x"===t.dim?function(t){return t-e;}:function(t){return n-t+e;};}(t,e?a.x:a.y);});}o(),!i&&t.get("containLabel")&&(E(n,function(t){if(!t.model.get("axisLabel.inside")){var e=function(t){var e=t.model,i=t.scale;if(e.get("axisLabel.show")&&!i.isBlank()){var n,a,o="category"===t.type,r=i.getExtent();a=o?i.count():(n=i.getTicks()).length;var s,l,u,h,c,d,f,p,g,m=t.getLabelModel(),v=Vp(t),y=1;40<a&&(y=Math.ceil(a/40));for(var x=0;x<a;x+=y){var _=v(n?n[x]:r[0]+x),w=m.getTextRect(_),b=(l=w,u=m.get("rotate")||0,void 0,h=u*Math.PI/180,c=l.plain(),d=c.width,f=c.height,p=d*Math.cos(h)+f*Math.sin(h),g=d*Math.sin(h)+f*Math.cos(h),new bi(c.x,c.y,p,g));s?s.union(b):s=b;}return s;}}(t);if(e){var i=t.isHorizontal()?"height":"width",n=t.model.get("axisLabel.margin");a[i]-=e[i]+n,"top"===t.position?a.y+=e.height+n:"left"===t.position&&(a.x+=e.width+n);}}}),o());},Sm.getAxis=function(t,e){var i=this._axesMap[t];if(null!=i){if(null==e)for(var n in i){if(i.hasOwnProperty(n))return i[n];}return i[e];}},Sm.getAxes=function(){return this._axesList.slice();},Sm.getCartesian=function(t,e){if(null!=t&&null!=e){var i="x"+t+"y"+e;return this._coordsMap[i];}z(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var n=0,a=this._coordsList;n<a.length;n++){if(a[n].getAxis("x").index===t||a[n].getAxis("y").index===e)return a[n];}},Sm.getCartesians=function(){return this._coordsList.slice();},Sm.convertToPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.dataToPoint(i):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(i)):null;},Sm.convertFromPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.pointToData(i):n.axis?n.axis.coordToData(n.axis.toLocalCoord(i)):null;},Sm._findConvertTarget=function(t,e){var i,n,a=e.seriesModel,o=e.xAxisModel||a&&a.getReferringComponents("xAxis")[0],r=e.yAxisModel||a&&a.getReferringComponents("yAxis")[0],s=e.gridModel,l=this._coordsList;if(a)_(l,i=a.coordinateSystem)<0&&(i=null);else if(o&&r)i=this.getCartesian(o.componentIndex,r.componentIndex);else if(o)n=this.getAxis("x",o.componentIndex);else if(r)n=this.getAxis("y",r.componentIndex);else if(s){s.coordinateSystem===this&&(i=this._coordsList[0]);}return{cartesian:i,axis:n};},Sm.containPoint=function(t){var e=this._coordsList[0];if(e)return e.containPoint(t);},Sm._initCartesian=function(r,t,e){var s={left:!1,right:!1,top:!1,bottom:!1},l={x:{},y:{}},u={x:0,y:0};if(t.eachComponent("xAxis",i("x"),this),t.eachComponent("yAxis",i("y"),this),!u.x||!u.y)return this._axesMap={},void(this._axesList=[]);function i(o){return function(t,e){if(wm(t,r)){var i=t.get("position");"x"===o?"top"!==i&&"bottom"!==i&&(i=s.bottom?"top":"bottom"):"left"!==i&&"right"!==i&&(i=s.left?"right":"left"),s[i]=!0;var n=new fm(o,Bp(t),[0,0],t.get("type"),i),a="category"===n.type;n.onBand=a&&t.get("boundaryGap"),n.inverse=t.get("inverse"),(t.axis=n).model=t,n.grid=this,n.index=e,this._axesList.push(n),l[o][e]=n,u[o]++;}};}E((this._axesMap=l).x,function(a,o){E(l.y,function(t,e){var i="x"+o+"y"+e,n=new dm(i);n.grid=this,n.model=r,this._coordsMap[i]=n,this._coordsList.push(n),n.addAxis(a),n.addAxis(t);},this);},this);},Sm._updateScale=function(l,u){function h(e,i){E(e.mapDimension(i.dim,!0),function(t){i.scale.unionExtentFromData(e,Uf(e,t));});}E(this._axesList,function(t){t.scale.setExtent(1/0,-1/0);}),l.eachSeries(function(t){if(Dm(t)){var e=Tm(t,l),i=e[0],n=e[1];if(!wm(i,u)||!wm(n,u))return;var a=this.getCartesian(i.componentIndex,n.componentIndex),o=t.getData(),r=a.getAxis("x"),s=a.getAxis("y");"list"===o.type&&(h(o,r,t),h(o,s,t));}},this);},Sm.getTooltipAxes=function(n){var a=[],o=[];return E(this.getCartesians(),function(t){var e=null!=n&&"auto"!==n?t.getAxis(n):t.getBaseAxis(),i=t.getOtherAxis(e);_(a,e)<0&&a.push(e),_(o,i)<0&&o.push(i);}),{baseAxes:a,otherAxes:o};};var Am=["xAxis","yAxis"];function Tm(e){return N(Am,function(t){return e.getReferringComponents(t)[0];});}function Dm(t){return"cartesian2d"===t.get("coordinateSystem");}bm.create=function(n,a){var o=[];return n.eachComponent("grid",function(t,e){var i=new bm(t,n,a);i.name="grid_"+e,i.resize(t,a,!0),t.coordinateSystem=i,o.push(i);}),n.eachSeries(function(t){if(Dm(t)){var e=Tm(t),i=e[0],n=e[1],a=i.getCoordSysModel().coordinateSystem;t.coordinateSystem=a.getCartesian(i.componentIndex,n.componentIndex);}}),o;},bm.dimensions=bm.prototype.dimensions=dm.prototype.dimensions,Hu.register("cartesian2d",bm);function Cm(t,e){this.opt=e,this.axisModel=t,C(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new Si();var i=new Si({position:e.position.slice(),rotation:e.rotation});i.updateTransform(),this._transform=i.transform,this._dumbGroup=i;}var Lm=Math.PI;Cm.prototype={constructor:Cm,hasBuilder:function hasBuilder(t){return!!km[t];},add:function add(t){km[t].call(this);},getGroup:function getGroup(){return this.group;}};var km={axisLine:function axisLine(){var o=this.opt,t=this.axisModel;if(t.get("axisLine.show")){var e=this.axisModel.axis.getExtent(),i=this._transform,r=[e[0],0],n=[e[1],0];i&&(bt(r,r,i),bt(n,n,i));var s=L({lineCap:"round"},t.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new Ur({anid:"line",subPixelOptimize:!0,shape:{x1:r[0],y1:r[1],x2:n[0],y2:n[1]},style:s,strokeContainThreshold:o.strokeContainThreshold||5,silent:!0,z2:1}));var l=t.get("axisLine.symbol"),a=t.get("axisLine.symbolSize"),u=t.get("axisLine.symbolOffset")||0;if("number"==typeof u&&(u=[u,u]),null!=l){"string"==typeof l&&(l=[l,l]),"string"!=typeof a&&"number"!=typeof a||(a=[a,a]);var h=a[0],c=a[1];E([{rotate:o.rotation+Math.PI/2,offset:u[0],r:0},{rotate:o.rotation-Math.PI/2,offset:u[1],r:Math.sqrt((r[0]-n[0])*(r[0]-n[0])+(r[1]-n[1])*(r[1]-n[1]))}],function(t,e){if("none"!==l[e]&&null!=l[e]){var i=Jp(l[e],-h/2,-c/2,h,c,s.stroke,!0),n=t.r+t.offset,a=[r[0]+n*Math.cos(o.rotation),r[1]-n*Math.sin(o.rotation)];i.attr({rotation:t.rotate,position:a,silent:!0,z2:11}),this.group.add(i);}},this);}}},axisTickLabel:function axisTickLabel(){var t=this.axisModel,e=this.opt,i=function(t,e,i){var n=e.axis;if(!e.get("axisTick.show")||n.scale.isBlank())return;for(var a=e.getModel("axisTick"),o=a.getModel("lineStyle"),r=a.get("length"),s=n.getTicksCoords(),l=[],u=[],h=t._transform,c=[],d=0;d<s.length;d++){var f=s[d].coord;l[0]=f,l[1]=0,u[0]=f,u[1]=i.tickDirection*r,h&&(bt(l,l,h),bt(u,u,h));var p=new Ur({anid:"tick_"+s[d].tickValue,subPixelOptimize:!0,shape:{x1:l[0],y1:l[1],x2:u[0],y2:u[1]},style:C(o.getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")}),z2:2,silent:!0});t.group.add(p),c.push(p);}return c;}(this,t,e);!function(t,e,i){if(Wp(t.axis))return;var n=t.get("axisLabel.showMinLabel"),a=t.get("axisLabel.showMaxLabel");i=i||[];var o=(e=e||[])[0],r=e[1],s=e[e.length-1],l=e[e.length-2],u=i[0],h=i[1],c=i[i.length-1],d=i[i.length-2];!1===n?(Em(o),Em(u)):Rm(o,r)&&(n?(Em(r),Em(h)):(Em(o),Em(u)));!1===a?(Em(s),Em(c)):Rm(l,s)&&(a?(Em(l),Em(d)):(Em(s),Em(c)));}(t,function(u,h,c){var d=h.axis;if(!W(c.axisLabelShow,h.get("axisLabel.show"))||d.scale.isBlank())return;var f=h.getModel("axisLabel"),p=f.get("margin"),t=d.getViewLabels(),e=(W(c.labelRotate,f.get("rotate"))||0)*Lm/180,g=Nm(c.rotation,e,c.labelDirection),m=h.getCategories&&h.getCategories(!0),v=[],y=Om(h),x=h.get("triggerEvent");return E(t,function(t,e){var i=t.tickValue,n=t.formattedLabel,a=t.rawLabel,o=f;m&&m[i]&&m[i].textStyle&&(o=new dl(m[i].textStyle,f,h.ecModel));var r=o.getTextColor()||h.get("axisLine.lineStyle.color"),s=[d.dataToCoord(i),c.labelOffset+c.labelDirection*p],l=new Dr({anid:"label_"+i,position:s,rotation:g.rotation,silent:y,z2:10});Gs(l.style,o,{text:n,textAlign:o.getShallow("align",!0)||g.textAlign,textVerticalAlign:o.getShallow("verticalAlign",!0)||o.getShallow("baseline",!0)||g.textVerticalAlign,textFill:"function"==typeof r?r("category"===d.type?a:"value"===d.type?i+"":i,e):r}),x&&(l.eventData=Pm(h),l.eventData.targetType="axisLabel",l.eventData.value=a),u._dumbGroup.add(l),l.updateTransform(),v.push(l),u.group.add(l),l.decomposeTransform();}),v;}(this,t,e),i);},axisName:function axisName(){var t=this.opt,e=this.axisModel,i=W(t.axisName,e.get("name"));if(i){var n,a,o=e.get("nameLocation"),r=t.nameDirection,s=e.getModel("nameTextStyle"),l=e.get("nameGap")||0,u=this.axisModel.axis.getExtent(),h=u[0]>u[1]?-1:1,c=["start"===o?u[0]-h*l:"end"===o?u[1]+h*l:(u[0]+u[1])/2,zm(o)?t.labelOffset+r*l:0],d=e.get("nameRotate");null!=d&&(d=d*Lm/180),zm(o)?n=Nm(t.rotation,null!=d?d:t.rotation,r):(n=function(t,e,i,n){var a,o,r=Tl(i-t.rotation),s=n[0]>n[1],l="start"===e&&!s||"start"!==e&&s;a=Dl(r-Lm/2)?(o=l?"bottom":"top","center"):Dl(r-1.5*Lm)?(o=l?"top":"bottom","center"):(o="middle",r<1.5*Lm&&Lm/2<r?l?"left":"right":l?"right":"left");return{rotation:r,textAlign:a,textVerticalAlign:o};}(t,o,d||0,u),null!=(a=t.axisNameAvailableWidth)&&(a=Math.abs(a/Math.sin(n.rotation)),isFinite(a)||(a=null)));var f=s.getFont(),p=e.get("nameTruncate",!0)||{},g=p.ellipsis,m=W(t.nameTruncateMaxWidth,p.maxWidth,a),v=null!=g&&null!=m?$l(i,m,f,g,{minChar:2,placeholder:p.placeholder}):i,y=e.get("tooltip",!0),x=e.mainType,_={componentType:x,name:i,$vars:["name"]};_[x+"Index"]=e.componentIndex;var w=new Dr({anid:"name",__fullText:i,__truncatedText:v,position:c,rotation:n.rotation,silent:Om(e),z2:1,tooltip:y&&y.show?L({content:i,formatter:function formatter(){return i;},formatterParams:_},y):null});Gs(w.style,s,{text:v,textFont:f,textFill:s.getTextColor()||e.get("axisLine.lineStyle.color"),textAlign:s.get("align")||n.textAlign,textVerticalAlign:s.get("verticalAlign")||n.textVerticalAlign}),e.get("triggerEvent")&&(w.eventData=Pm(e),w.eventData.targetType="axisName",w.eventData.name=i),this._dumbGroup.add(w),w.updateTransform(),this.group.add(w),w.decomposeTransform();}}},Pm=Cm.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e;},Nm=Cm.innerTextLayout=function(t,e,i){var n,a=Tl(e-t);return{rotation:a,textAlign:Dl(a)?(n=0<i?"top":"bottom","center"):Dl(a-Lm)?(n=0<i?"bottom":"top","center"):(n="middle",0<a&&a<Lm?0<i?"right":"left":0<i?"left":"right"),textVerticalAlign:n};};var Om=Cm.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show);};function Em(t){t&&(t.ignore=!0);}function Rm(t,e){var i=t&&t.getBoundingRect().clone(),n=e&&e.getBoundingRect().clone();if(i&&n){var a=te([]);return ae(a,a,-t.rotation),i.applyTransform(ie([],a,t.getLocalTransform())),n.applyTransform(ie([],a,e.getLocalTransform())),i.intersect(n);}}function zm(t){return"middle"===t||"center"===t;}var Bm=E,Vm=A;function Gm(t,e){var i={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(p,g,t){var o=g.getComponent("tooltip"),m=g.getComponent("axisPointer"),v=m.get("link",!0)||[],y=[];Bm(t.getCoordinateSystems(),function(c){if(c.axisPointerEnabled){var t=Zm(c.model),d=p.coordSysAxesInfo[t]={},f=(p.coordSysMap[t]=c).model.getModel("tooltip",o);if(Bm(c.getAxes(),Vm(a,!1,null)),c.getTooltipAxes&&o&&f.get("show")){var e="axis"===f.get("trigger"),i="cross"===f.get("axisPointer.type"),n=c.getTooltipAxes(f.get("axisPointer.axis"));(e||i)&&Bm(n.baseAxes,Vm(a,!i||"cross",e)),i&&Bm(n.otherAxes,Vm(a,"cross",!1));}}function a(t,e,i){var n=i.model.getModel("axisPointer",m),a=n.get("show");if(a&&("auto"!==a||t||Hm(n))){null==e&&(e=n.get("triggerTooltip"));var o=(n=t?function(t,e,i,n,a,o){var r=e.getModel("axisPointer"),s={};Bm(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(t){s[t]=D(r.get(t));}),s.snap="category"!==t.type&&!!o,"cross"===r.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===a){var u=r.get("label.show");if(l.show=null==u||u,!o){var h=s.lineStyle=r.get("crossStyle");h&&C(l,h.textStyle);}}return t.model.getModel("axisPointer",new dl(s,i,n));}(i,f,m,g,t,e):n).get("snap"),r=Zm(i.model),s=e||o||"category"===i.type,l=p.axesInfo[r]={key:r,axis:i,coordSys:c,axisPointerModel:n,triggerTooltip:e,involveSeries:s,snap:o,useHandle:Hm(n),seriesModels:[]};d[r]=l,p.seriesInvolved|=s;var u=function(t,e){for(var i=e.model,n=e.dim,a=0;a<t.length;a++){var o=t[a]||{};if(Fm(o[n+"AxisId"],i.id)||Fm(o[n+"AxisIndex"],i.componentIndex)||Fm(o[n+"AxisName"],i.name))return a;}}(v,i);if(null!=u){var h=y[u]||(y[u]={axesInfo:{}});h.axesInfo[r]=l,h.mapper=v[u].mapper,l.linkGroup=h;}}}});}(i,t,e),i.seriesInvolved&&function(a,t){t.eachSeries(function(i){var n=i.coordinateSystem,t=i.get("tooltip.trigger",!0),e=i.get("tooltip.show",!0);n&&"none"!==t&&!1!==t&&"item"!==t&&!1!==e&&!1!==i.get("axisPointer.show",!0)&&Bm(a.coordSysAxesInfo[Zm(n.model)],function(t){var e=t.axis;n.getAxis(e.dim)===e&&(t.seriesModels.push(i),null==t.seriesDataCount&&(t.seriesDataCount=0),t.seriesDataCount+=i.getData().count());});},this);}(i,t),i;}function Fm(t,e){return"all"===t||k(t)&&0<=_(t,e)||t===e;}function Wm(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[Zm(t)];}function Hm(t){return!!t.get("handle.show");}function Zm(t){return t.type+"||"+t.id;}var Um=lf({type:"axis",_axisPointer:null,axisPointerClass:null,render:function render(t,e,i,n){this.axisPointerClass&&function(t){var e=Wm(t);if(e){var i=e.axisPointerModel,n=e.axis.scale,a=i.option,o=i.get("status"),r=i.get("value");null!=r&&(r=n.parse(r));var s=Hm(i);null==o&&(a.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==r||r>l[1])&&(r=l[1]),r<l[0]&&(r=l[0]),a.value=r,s&&(a.status=e.axis.scale.isBlank()?"hide":"show");}}(t),Um.superApply(this,"render",arguments),Xm(this,t,e,i,n,!0);},updateAxisPointer:function updateAxisPointer(t,e,i,n,a){Xm(this,t,e,i,n,!1);},remove:function remove(t,e){var i=this._axisPointer;i&&i.remove(e),Um.superApply(this,"remove",arguments);},dispose:function dispose(t,e){Ym(this,e),Um.superApply(this,"dispose",arguments);}});function Xm(t,e,i,n,a,o){var r=Um.getAxisPointerClass(t.axisPointerClass);if(r){var s=function(t){var e=Wm(t);return e&&e.axisPointerModel;}(e);s?(t._axisPointer||(t._axisPointer=new r())).render(e,s,n,o):Ym(t,n);}}function Ym(t,e,i){var n=t._axisPointer;n&&n.dispose(e,i),t._axisPointer=null;}var jm=[];function qm(t,e,i){i=i||{};var n=t.coordinateSystem,a=e.axis,o={},r=a.getAxesOnZeroOf()[0],s=a.position,l=r?"onZero":s,u=a.dim,h=n.getRect(),c=[h.x,h.x+h.width,h.y,h.y+h.height],d={left:0,right:1,top:0,bottom:1,onZero:2},f=e.get("offset")||0,p="x"===u?[c[2]-f,c[3]+f]:[c[0]-f,c[1]+f];if(r){var g=r.toGlobalCoord(r.dataToCoord(0));p[d.onZero]=Math.max(Math.min(g,p[1]),p[0]);}o.position=["y"===u?p[d[l]]:c[0],"x"===u?p[d[l]]:c[3]],o.rotation=Math.PI/2*("x"===u?0:1);o.labelDirection=o.tickDirection=o.nameDirection={top:-1,bottom:1,left:-1,right:1}[s],o.labelOffset=r?p[d[s]]-p[d.onZero]:0,e.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),W(i.labelInside,e.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var m=e.get("axisLabel.rotate");return o.labelRotate="top"===l?-m:m,o.z2=1,o;}Um.registerAxisPointerClass=function(t,e){jm[t]=e;},Um.getAxisPointerClass=function(t){return t&&jm[t];};var Km=["axisLine","axisTickLabel","axisName"],$m=["splitArea","splitLine"],Jm=Um.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function render(e,t,i,n){this.group.removeAll();var a=this._axisGroup;if(this._axisGroup=new Si(),this.group.add(this._axisGroup),e.get("show")){var o=e.getCoordSysModel(),r=qm(o,e),s=new Cm(e,r);E(Km,s.add,s),this._axisGroup.add(s.getGroup()),E($m,function(t){e.get(t+".show")&&this["_"+t](e,o);},this),Qs(a,this._axisGroup,e),Jm.superCall(this,"render",e,t,i,n);}},remove:function remove(){this._splitAreaColors=null;},_splitLine:function _splitLine(t,e){var i=t.axis;if(!i.scale.isBlank()){var n=t.getModel("splitLine"),a=n.getModel("lineStyle"),o=a.get("color");o=k(o)?o:[o];for(var r=e.coordinateSystem.getRect(),s=i.isHorizontal(),l=0,u=i.getTicksCoords({tickModel:n}),h=[],c=[],d=a.getLineStyle(),f=0;f<u.length;f++){var p=i.toGlobalCoord(u[f].coord);s?(h[0]=p,h[1]=r.y,c[0]=p,c[1]=r.y+r.height):(h[0]=r.x,h[1]=p,c[0]=r.x+r.width,c[1]=p);var g=l++%o.length,m=u[f].tickValue;this._axisGroup.add(new Ur({anid:null!=m?"line_"+u[f].tickValue:null,subPixelOptimize:!0,shape:{x1:h[0],y1:h[1],x2:c[0],y2:c[1]},style:C({stroke:o[g]},d),silent:!0}));}}},_splitArea:function _splitArea(t,e){var i=t.axis;if(!i.scale.isBlank()){var n=t.getModel("splitArea"),a=n.getModel("areaStyle"),o=a.get("color"),r=e.coordinateSystem.getRect(),s=i.getTicksCoords({tickModel:n,clamp:!0});if(s.length){var l=o.length,u=this._splitAreaColors,h=Q(),c=0;if(u)for(var d=0;d<s.length;d++){var f=u.get(s[d].tickValue);if(null!=f){c=(f+(l-1)*d)%l;break;}}var p=i.toGlobalCoord(s[0].coord),g=a.getAreaStyle();o=k(o)?o:[o];for(d=1;d<s.length;d++){var m,v,y,x,_=i.toGlobalCoord(s[d].coord);p=i.isHorizontal()?(m=p,v=r.y,y=_-m,x=r.height,m+y):(m=r.x,v=p,y=r.width,v+(x=_-v));var w=s[d-1].tickValue;null!=w&&h.set(w,c),this._axisGroup.add(new Hr({anid:null!=w?"area_"+w:null,shape:{x:m,y:v,width:y,height:x},style:C({fill:o[c]},g),silent:!0})),c=(c+1)%l;}this._splitAreaColors=h;}}}});Jm.extend({type:"xAxis"}),Jm.extend({type:"yAxis"}),lf({type:"grid",render:function render(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new Hr({shape:t.coordinateSystem.getRect(),style:C({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}));}}),Jd(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={});}),af(rm("line","circle","line")),nf(sm("line")),Qd(cd.PROCESSOR.STATISTIC,{seriesType:"line",modifyOutputEnd:!0,reset:function reset(t,e,i){var n=t.getData(),a=t.get("sampling"),o=t.coordinateSystem;if("cartesian2d"===o.type&&a){var r,s=o.getBaseAxis(),l=o.getOtherAxis(s),u=s.getExtent(),h=u[1]-u[0],c=Math.round(n.count()/h);1<c&&("string"==typeof a?r=um[a]:"function"==typeof a&&(r=a),r&&t.setData(n.downSample(n.mapDimension(l.dim),1/c,r,lm)));}}});var Qm=Wh.extend({type:"series.__base_bar__",getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this);},getMarkerPosition:function getMarkerPosition(t){var e=this.coordinateSystem;if(e){var i=e.dataToPoint(e.clampData(t)),n=this.getData(),a=n.getLayout("offset"),o=n.getLayout("size");return i[e.getBaseAxis().isHorizontal()?0:1]+=a+o/2,i;}return[NaN,NaN];},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",itemStyle:{},emphasis:{}}});function tv(t,e,i,n,a,o){Bs(t,e,i.getModel("label"),i.getModel("emphasis.label"),{labelFetcher:a,labelDataIndex:o,defaultText:bg(a.getData(),o),isRectText:!0,autoColor:n}),ev(t),ev(e);}function ev(t,e){"outside"===t.textPosition&&(t.textPosition=e);}Qm.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect",getProgressive:function getProgressive(){return!!this.get("large")&&this.get("progressive");},getProgressiveThreshold:function getProgressiveThreshold(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return t<e&&(t=e),t;},defaultOption:{clip:!0,roundCap:!1}});var iv=Xa([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),nv={getBarItemStyle:function getBarItemStyle(t){var e=iv(this,t);if(this.getBorderLineDash){var i=this.getBorderLineDash();i&&(e.lineDash=i);}return e;}},av=ds({type:"sausage",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,a=Math.max(e.r0||0,0),o=Math.max(e.r,0),r=.5*(o-a),s=a+r,l=e.startAngle,u=e.endAngle,h=e.clockwise,c=Math.cos(l),d=Math.sin(l),f=Math.cos(u),p=Math.sin(u);(h?u-l<2*Math.PI:l-u<2*Math.PI)&&(t.moveTo(c*a+i,d*a+n),t.arc(c*s+i,d*s+n,r,-Math.PI+l,l,!h)),t.arc(i,n,o,l,u,!h),t.moveTo(f*o+i,p*o+n),t.arc(f*s+i,p*s+n,r,u-2*Math.PI,u-Math.PI,!h),0!==a&&(t.arc(i,n,a,u,l,h),t.moveTo(c*a+i,p*a+n)),t.closePath();}}),ov=["itemStyle","barBorderWidth"],rv=[0,0];L(dl.prototype,nv),hf({type:"bar",render:function render(t,e,i){this._updateDrawMode(t);var n=t.get("coordinateSystem");return"cartesian2d"!==n&&"polar"!==n||(this._isLargeDraw?this._renderLarge(t,e,i):this._renderNormal(t,e,i)),this.group;},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){this._clear(),this._updateDrawMode(t);},incrementalRender:function incrementalRender(t,e,i,n){this._incrementalRenderLarge(t,e);},_updateDrawMode:function _updateDrawMode(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear());},_renderNormal:function _renderNormal(o,t,e){var r,s=this.group,l=o.getData(),u=this._data,h=o.coordinateSystem,i=h.getBaseAxis();"cartesian2d"===h.type?r=i.isHorizontal():"polar"===h.type&&(r="angle"===i.dim);var c=o.isAnimationEnabled()?o:null,d=o.get("clip",!0),f=function(t,e){var i=t.getArea&&t.getArea();if("cartesian2d"===t.type){var n=t.getBaseAxis();if("category"!==n.type||!n.onBand){var a=e.getLayout("bandWidth");n.isHorizontal()?(i.x-=a,i.width+=2*a):(i.y-=a,i.height+=2*a);}}return i;}(h,l);s.removeClipPath();var p=o.get("roundCap",!0);l.diff(u).add(function(t){if(l.hasValue(t)){var e=l.getItemModel(t),i=fv[h.type](l,t,e);if(d)if(uv[h.type](f,i))return void s.remove(n);var n=hv[h.type](t,i,r,c,!1,p);l.setItemGraphicEl(t,n),s.add(n),pv(n,l,t,e,i,o,r,"polar"===h.type);}}).update(function(t,e){var i=u.getItemGraphicEl(e);if(l.hasValue(t)){var n=l.getItemModel(t),a=fv[h.type](l,t,n);if(d)if(uv[h.type](f,a))return void s.remove(i);i?js(i,{shape:a},c,t):i=hv[h.type](t,a,r,c,!0,p),l.setItemGraphicEl(t,i),s.add(i),pv(i,l,t,n,a,o,r,"polar"===h.type);}else s.remove(i);}).remove(function(t){var e=u.getItemGraphicEl(t);"cartesian2d"===h.type?e&&cv(t,c,e):e&&dv(t,c,e);}).execute(),this._data=l;},_renderLarge:function _renderLarge(t,e,i){this._clear(),mv(t,this.group);var n=t.get("clip",!0)?tm(t.coordinateSystem,!1,t):null;n?this.group.setClipPath(n):this.group.removeClipPath();},_incrementalRenderLarge:function _incrementalRenderLarge(t,e){mv(e,this.group,!0);},dispose:et,remove:function remove(t){this._clear(t);},_clear:function _clear(e){var t=this.group,i=this._data;e&&e.get("animation")&&i&&!this._isLargeDraw?i.eachItemGraphicEl(function(t){"sector"===t.type?dv(t.dataIndex,e,t):cv(t.dataIndex,e,t);}):t.removeAll(),this._data=null;}});var sv=Math.max,lv=Math.min,uv={cartesian2d:function cartesian2d(t,e){var i=e.width<0?-1:1,n=e.height<0?-1:1;i<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height);var a=sv(e.x,t.x),o=lv(e.x+e.width,t.x+t.width),r=sv(e.y,t.y),s=lv(e.y+e.height,t.y+t.height);e.x=a,e.y=r,e.width=o-a,e.height=s-r;var l=e.width<0||e.height<0;return i<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height),l;},polar:function polar(t){return!1;}},hv={cartesian2d:function cartesian2d(t,e,i,n,a){var o=new Hr({shape:L({},e)});if(n){var r=i?"height":"width",s={};o.shape[r]=0,s[r]=e[r],ol[a?"updateProps":"initProps"](o,{shape:s},n,t);}return o;},polar:function polar(t,e,i,n,a,o){var r=e.startAngle<e.endAngle,s=new(!i&&o?av:Pr)({shape:C({clockwise:r},e)});if(n){var l=i?"r":"endAngle",u={};s.shape[l]=i?0:e.startAngle,u[l]=e[l],ol[a?"updateProps":"initProps"](s,{shape:u},n,t);}return s;}};function cv(t,e,i){i.style.text=null,js(i,{shape:{width:0}},e,t,function(){i.parent&&i.parent.remove(i);});}function dv(t,e,i){i.style.text=null,js(i,{shape:{r:i.shape.r0}},e,t,function(){i.parent&&i.parent.remove(i);});}var fv={cartesian2d:function cartesian2d(t,e,i){var n=t.getItemLayout(e),a=function(t,e){var i=t.get(ov)||0;return Math.min(i,Math.abs(e.width),Math.abs(e.height));}(i,n),o=0<n.width?1:-1,r=0<n.height?1:-1;return{x:n.x+o*a/2,y:n.y+r*a/2,width:n.width-o*a,height:n.height-r*a};},polar:function polar(t,e,i){var n=t.getItemLayout(e);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle};}};function pv(t,e,i,n,a,o,r,s){var l=e.getItemVisual(i,"color"),u=e.getItemVisual(i,"opacity"),h=n.getModel("itemStyle"),c=n.getModel("emphasis.itemStyle").getBarItemStyle();s||t.setShape("r",h.get("barBorderRadius")||0),t.useStyle(C({fill:l,opacity:u},h.getBarItemStyle()));var d=n.getShallow("cursor");d&&t.attr("cursor",d);r?a.height:a.width;s||tv(t.style,c,n,l,o,i),Os(t,c);}var gv=hr.extend({type:"largeBar",shape:{points:[]},buildPath:function buildPath(t,e){for(var i=e.points,n=this.__startPoint,a=this.__baseDimIdx,o=0;o<i.length;o+=2){n[a]=i[o+a],t.moveTo(n[0],n[1]),t.lineTo(i[o],i[o+1]);}}});function mv(t,e,i){var n=t.getData(),a=[],o=n.getLayout("valueAxisHorizontal")?1:0;a[1-o]=n.getLayout("valueAxisStart");var r=new gv({shape:{points:n.getLayout("largePoints")},incremental:!!i,__startPoint:a,__baseDimIdx:o,__largeDataIndices:n.getLayout("largeDataIndices"),__barWidth:n.getLayout("barWidth")});e.add(r),function(t,e,i){var n=i.getVisual("borderColor")||i.getVisual("color"),a=e.getModel("itemStyle").getItemStyle(["color","borderColor"]);t.useStyle(a),t.style.fill=null,t.style.stroke=n,t.style.lineWidth=i.getLayout("barWidth");}(r,t,n),r.seriesIndex=t.seriesIndex,t.get("silent")||(r.on("mousedown",vv),r.on("mousemove",vv));}var vv=cc(function(t){var e=function(t,e,i){var n=t.__baseDimIdx,a=1-n,o=t.shape.points,r=t.__largeDataIndices,s=Math.abs(t.__barWidth/2),l=t.__startPoint[a];rv[0]=e,rv[1]=i;for(var u=rv[n],h=rv[1-n],c=u-s,d=u+s,f=0,p=o.length/2;f<p;f++){var g=2*f,m=o[g+n],v=o[g+a];if(c<=m&&m<=d&&(l<=v?l<=h&&h<=v:v<=h&&h<=l))return r[f];}return-1;}(this,t.offsetX,t.offsetY);this.dataIndex=0<=e?e:null;},30,!1);nf(cd.VISUAL.LAYOUT,A(pp,"bar")),nf(cd.VISUAL.PROGRESSIVE_LAYOUT,gp),af({seriesType:"bar",reset:function reset(t){t.getData().setVisual("legendSymbol","roundRect");}});function yv(t,e,i){e=k(e)&&{coordDimensions:e}||L({},e);var n=t.getSource(),a=Wf(n,e),o=new Tf(a,t);return o.initData(n,i),o;}var xv={updateSelectedMap:function updateSelectedMap(t){this._targetList=k(t)?t.slice():[],this._selectTargetMap=S(t||[],function(t,e){return t.set(e.name,e),t;},Q());},select:function select(t,e){var i=null!=e?this._targetList[e]:this._selectTargetMap.get(t);"single"===this.get("selectedMode")&&this._selectTargetMap.each(function(t){t.selected=!1;}),i&&(i.selected=!0);},unSelect:function unSelect(t,e){var i=null!=e?this._targetList[e]:this._selectTargetMap.get(t);i&&(i.selected=!1);},toggleSelected:function toggleSelected(t,e){var i=null!=e?this._targetList[e]:this._selectTargetMap.get(t);if(null!=i)return this[i.selected?"unSelect":"select"](t,e),i.selected;},isSelected:function isSelected(t,e){var i=null!=e?this._targetList[e]:this._selectTargetMap.get(t);return i&&i.selected;}},_v=uf({type:"series.pie",init:function init(t){_v.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData();},this.updateSelectedMap(this._createSelectableList()),this._defaultLabelLine(t);},mergeOption:function mergeOption(t){_v.superCall(this,"mergeOption",t),this.updateSelectedMap(this._createSelectableList());},getInitialData:function getInitialData(t,e){return yv(this,["value"]);},_createSelectableList:function _createSelectableList(){for(var t=this.getRawData(),e=t.mapDimension("value"),i=[],n=0,a=t.count();n<a;n++){i.push({name:t.getName(n),value:t.get(e,n),selected:Ih(t,n,"selected")});}return i;},getDataParams:function getDataParams(t){var e=this.getData(),i=_v.superCall(this,"getDataParams",t),n=[];return e.each(e.mapDimension("value"),function(t){n.push(t);}),i.percent=Il(n,t,e.hostModel.get("percentPrecision")),i.$vars.push("percent"),i;},_defaultLabelLine:function _defaultLabelLine(t){ba(t,"labelLine",["show"]);var e=t.labelLine,i=t.emphasis.labelLine;e.show=e.show&&t.label.show,i.show=i.show&&t.emphasis.label.show;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,hoverOffset:10,avoidLabelOverlap:!0,percentPrecision:2,stillShowZeroSum:!0,label:{rotate:!1,show:!0,position:"outer"},labelLine:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1},animationType:"expansion",animationTypeUpdate:"transition",animationEasing:"cubicOut"}});function wv(t,e,i,n){var a=e.getData(),o=this.dataIndex,r=a.getName(o),s=e.get("selectedOffset");n.dispatchAction({type:"pieToggleSelect",from:t,name:r,seriesId:e.id}),a.each(function(t){bv(a.getItemGraphicEl(t),a.getItemLayout(t),e.isSelected(a.getName(t)),s,i);});}function bv(t,e,i,n,a){var o=(e.startAngle+e.endAngle)/2,r=i?n:0,s=[Math.cos(o)*r,Math.sin(o)*r];a?t.animate().when(200,{position:s}).start("bounceOut"):t.attr("position",s);}function Sv(t,e){Si.call(this);var i=new Pr({z2:2}),n=new zr(),a=new Dr();this.add(i),this.add(n),this.add(a),this.updateData(t,e,!0);}b(_v,xv);var Mv=Sv.prototype;Mv.updateData=function(t,e,i){var n=this.childAt(0),a=this.childAt(1),o=this.childAt(2),r=t.hostModel,s=t.getItemModel(e),l=t.getItemLayout(e),u=L({},l);u.label=null;var h=r.getShallow("animationTypeUpdate");i?(n.setShape(u),"scale"===r.getShallow("animationType")?(n.shape.r=l.r0,qs(n,{shape:{r:l.r}},r,e)):(n.shape.endAngle=l.startAngle,js(n,{shape:{endAngle:l.endAngle}},r,e))):"expansion"===h?n.setShape(u):js(n,{shape:u},r,e);var c=t.getItemVisual(e,"color");n.useStyle(C({lineJoin:"bevel",fill:c},s.getModel("itemStyle").getItemStyle())),n.hoverStyle=s.getModel("emphasis.itemStyle").getItemStyle();var d=s.getShallow("cursor");d&&n.attr("cursor",d),bv(this,t.getItemLayout(e),r.isSelected(null,e),r.get("selectedOffset"),r.get("animation"));var f=!i&&"transition"===h;this._updateLabel(t,e,f),this.highDownOnUpdate=s.get("hoverAnimation")&&r.isAnimationEnabled()?function(t,e){"emphasis"===e?(a.ignore=a.hoverIgnore,o.ignore=o.hoverIgnore,n.stopAnimation(!0),n.animateTo({shape:{r:l.r+r.get("hoverOffset")}},300,"elasticOut")):(a.ignore=a.normalIgnore,o.ignore=o.normalIgnore,n.stopAnimation(!0),n.animateTo({shape:{r:l.r}},300,"elasticOut"));}:null,Os(this);},Mv._updateLabel=function(t,e,i){var n=this.childAt(1),a=this.childAt(2),o=t.hostModel,r=t.getItemModel(e),s=t.getItemLayout(e).label,l=t.getItemVisual(e,"color");if(!s||isNaN(s.x)||isNaN(s.y))a.ignore=a.normalIgnore=a.hoverIgnore=n.ignore=n.normalIgnore=n.hoverIgnore=!0;else{var u={points:s.linePoints||[[s.x,s.y],[s.x,s.y],[s.x,s.y]]},h={x:s.x,y:s.y};i?(js(n,{shape:u},o,e),js(a,{style:h},o,e)):(n.attr({shape:u}),a.attr({style:h})),a.attr({rotation:s.rotation,origin:[s.x,s.y],z2:10});var c=r.getModel("label"),d=r.getModel("emphasis.label"),f=r.getModel("labelLine"),p=r.getModel("emphasis.labelLine");l=t.getItemVisual(e,"color");Bs(a.style,a.hoverStyle={},c,d,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:t.getName(e),autoColor:l,useInsideStyle:!!s.inside},{textAlign:s.textAlign,textVerticalAlign:s.verticalAlign,opacity:t.getItemVisual(e,"opacity")}),a.ignore=a.normalIgnore=!c.get("show"),a.hoverIgnore=!d.get("show"),n.ignore=n.normalIgnore=!f.get("show"),n.hoverIgnore=!p.get("show"),n.setStyle({stroke:l,opacity:t.getItemVisual(e,"opacity")}),n.setStyle(f.getModel("lineStyle").getLineStyle()),n.hoverStyle=p.getModel("lineStyle").getLineStyle();var g=f.get("smooth");g&&!0===g&&(g=.4),n.setShape({smooth:g});}},w(Sv,Si);function Iv(i,t){E(t,function(o){o.update="updateView",tf(o,function(t,e){var a={};return e.eachComponent({mainType:"series",subType:i,query:t},function(i){i[o.method]&&i[o.method](t.name,t.dataIndex);var n=i.getData();n.each(function(t){var e=n.getName(t);a[e]=i.isSelected(e)||!1;});}),{name:t.name,selected:a,seriesId:t.seriesId};});});}function Av(n){return{getTargetSeries:function getTargetSeries(t){var e={},i=Q();return t.eachSeriesByType(n,function(t){t.__paletteScope=e,i.set(t.uid,t);}),i;},reset:function reset(s,t){var l=s.getRawData(),u={},h=s.getData();h.each(function(t){var e=h.getRawIndex(t);u[e]=t;}),l.each(function(t){var e,i=u[t],n=null!=i&&h.getItemVisual(i,"color",!0),a=null!=i&&h.getItemVisual(i,"borderColor",!0);if(n&&a||(e=l.getItemModel(t)),n)l.setItemVisual(t,"color",n);else{var o=e.get("itemStyle.color")||s.getColorFromPalette(l.getName(t)||t+"",s.__paletteScope,l.count());l.setItemVisual(t,"color",o),null!=i&&h.setItemVisual(i,"color",o);}if(a)l.setItemVisual(t,"borderColor",a);else{var r=e.get("itemStyle.borderColor");l.setItemVisual(t,"borderColor",r),null!=i&&h.setItemVisual(i,"borderColor",r);}});}};}ec.extend({type:"pie",init:function init(){var t=new Si();this._sectorGroup=t;},render:function render(t,e,i,n){if(!n||n.from!==this.uid){var a=t.getData(),o=this._data,r=this.group,s=e.get("animation"),l=!o,u=t.get("animationType"),h=t.get("animationTypeUpdate"),c=A(wv,this.uid,t,s,i),d=t.get("selectedMode");if(a.diff(o).add(function(t){var e=new Sv(a,t);l&&"scale"!==u&&e.eachChild(function(t){t.stopAnimation(!0);}),d&&e.on("click",c),a.setItemGraphicEl(t,e),r.add(e);}).update(function(t,e){var i=o.getItemGraphicEl(e);l||"transition"===h||i.eachChild(function(t){t.stopAnimation(!0);}),i.updateData(a,t),i.off("click"),d&&i.on("click",c),r.add(i),a.setItemGraphicEl(t,i);}).remove(function(t){var e=o.getItemGraphicEl(t);r.remove(e);}).execute(),s&&0<a.count()&&(l?"scale"!==u:"transition"!==h)){for(var f=a.getItemLayout(0),p=1;isNaN(f.startAngle)&&p<a.count();++p){f=a.getItemLayout(p);}var g=Math.max(i.getWidth(),i.getHeight())/2,m=T(r.removeClipPath,r);r.setClipPath(this._createClipPath(f.cx,f.cy,g,f.startAngle,f.clockwise,m,t,l));}else r.removeClipPath();this._data=a;}},dispose:function dispose(){},_createClipPath:function _createClipPath(t,e,i,n,a,o,r,s){var l=new Pr({shape:{cx:t,cy:e,r0:0,r:i,startAngle:n,endAngle:n,clockwise:a}});return(s?qs:js)(l,{shape:{endAngle:n+(a?1:-1)*Math.PI*2}},r,o),l;},containPoint:function containPoint(t,e){var i=e.getData().getItemLayout(0);if(i){var n=t[0]-i.cx,a=t[1]-i.cy,o=Math.sqrt(n*n+a*a);return o<=i.r&&o>=i.r0;}}});var Tv=Math.PI/180;function Dv(a,t,e,i,n,o,r){function s(t,e,i){for(var n=t;n<e;n++){if(a[n].y+=i,t<n&&n+1<e&&a[n+1].y>a[n].y+a[n].height)return void l(n,i/2);}l(e-1,i/2);}function l(t,e){for(var i=t;0<=i&&(a[i].y-=e,!(0<i&&a[i].y>a[i-1].y+a[i-1].height));i--){;}}function u(t,e,i,n,a,o){for(var r=e?Number.MAX_VALUE:0,s=0,l=t.length;s<l;s++){var u=Math.abs(t[s].y-n),h=t[s].len,c=t[s].len2,d=u<a+h?Math.sqrt((a+h+c)*(a+h+c)-u*u):Math.abs(t[s].x-i);e&&r<=d&&(d=r-10),!e&&d<=r&&(d=r+10),t[s].x=i+d*o,r=d;}}a.sort(function(t,e){return t.y-e.y;});for(var h,c=0,d=a.length,f=[],p=[],g=0;g<d;g++){(h=a[g].y-c)<0&&s(g,d,-h),c=a[g].y+a[g].height;}r-c<0&&l(d-1,c-r);for(g=0;g<d;g++){a[g].y>=e?p.push(a[g]):f.push(a[g]);}u(f,!1,t,e,i,n),u(p,!0,t,e,i,n);}function Cv(t){return"center"===t.position;}function Lv(I,A,t,e,i){var T,D,C=I.getData(),L=[],k=!1,P=(I.get("minShowLabelAngle")||0)*Tv;C.each(function(t){var e=C.getItemLayout(t),i=C.getItemModel(t),n=i.getModel("label"),a=n.get("position")||i.get("emphasis.label.position"),o=i.getModel("labelLine"),r=o.get("length"),s=o.get("length2");if(!(e.angle<P)){var l,u,h,c,d=(e.startAngle+e.endAngle)/2,f=Math.cos(d),p=Math.sin(d);T=e.cx,D=e.cy;var g="inside"===a||"inner"===a;if("center"===a)l=e.cx,u=e.cy,c="center";else{var m=(g?(e.r+e.r0)/2*f:e.r*f)+T,v=(g?(e.r+e.r0)/2*p:e.r*p)+D;if(l=m+3*f,u=v+3*p,!g){var y=m+f*(r+A-e.r),x=v+p*(r+A-e.r),_=y+(f<0?-1:1)*s;l=_+(f<0?-5:5),h=[[m,v],[y,x],[_,u=x]];}c=g?"center":0<f?"left":"right";}var w,b=n.getFont(),S=n.get("rotate");w="number"==typeof S?S*(Math.PI/180):S?f<0?-d+Math.PI:-d:0;var M=un(I.getFormattedLabel(t,"normal")||C.getName(t),b,c,"top");k=!!w,e.label={x:l,y:u,position:a,height:M.height,len:r,len2:s,linePoints:h,textAlign:c,verticalAlign:"middle",rotation:w,inside:g},g||L.push(e.label);}}),!k&&I.get("avoidLabelOverlap")&&function(t,e,i,n,a,o){for(var r=[],s=[],l=0;l<t.length;l++){Cv(t[l])||(t[l].x<e?r.push(t[l]):s.push(t[l]));}for(Dv(s,e,i,n,1,0,o),Dv(r,e,i,n,-1,0,o),l=0;l<t.length;l++){if(!Cv(t[l])){var u=t[l].linePoints;if(u){var h=u[1][0]-u[2][0];t[l].x<e?u[2][0]=t[l].x+3:u[2][0]=t[l].x-3,u[1][1]=u[2][1]=t[l].y,u[1][0]=u[2][0]+h;}}}}(L,T,D,A,0,e);}function kv(t){return{seriesType:t,reset:function reset(t,e){var n=e.findComponents({mainType:"legend"});if(n&&n.length){var a=t.getData();a.filterSelf(function(t){for(var e=a.getName(t),i=0;i<n.length;i++){if(!n[i].isSelected(e))return!1;}return!0;});}}};}var Pv=2*Math.PI,Nv=Math.PI/180;Iv("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),af(Av("pie")),nf(A(function(t,e,A,i){e.eachSeriesByType(t,function(t){var a=t.getData(),e=a.mapDimension("value"),i=t.get("center"),n=t.get("radius");k(n)||(n=[0,n]),k(i)||(i=[i,i]);var o=A.getWidth(),r=A.getHeight(),s=Math.min(o,r),l=xl(i[0],o),u=xl(i[1],r),h=xl(n[0],s/2),c=xl(n[1],s/2),d=-t.get("startAngle")*Nv,f=t.get("minAngle")*Nv,p=0;a.each(e,function(t){isNaN(t)||p++;});var g=a.getSum(e),m=Math.PI/(g||p)*2,v=t.get("clockwise"),y=t.get("roseType"),x=t.get("stillShowZeroSum"),_=a.getDataExtent(e);_[0]=0;var w=Pv,b=0,S=d,M=v?1:-1;if(a.each(e,function(t,e){var i;if(isNaN(t))a.setItemLayout(e,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:v,cx:l,cy:u,r0:h,r:y?NaN:c});else{(i="area"!==y?0===g&&x?m:t*m:Pv/p)<f?w-=i=f:b+=t;var n=S+M*i;a.setItemLayout(e,{angle:i,startAngle:S,endAngle:n,clockwise:v,cx:l,cy:u,r0:h,r:y?yl(t,_,[h,c]):c}),S=n;}}),w<Pv&&p)if(w<=.001){var I=Pv/p;a.each(e,function(t,e){if(!isNaN(t)){var i=a.getItemLayout(e);i.angle=I,i.startAngle=d+M*e*I,i.endAngle=d+M*(e+1)*I;}});}else m=w/b,S=d,a.each(e,function(t,e){if(!isNaN(t)){var i=a.getItemLayout(e),n=i.angle===f?f:t*m;i.startAngle=S,i.endAngle=S+M*n,S+=M*n;}});Lv(t,c,0,r);});},"pie")),Qd(kv("pie")),Wh.extend({type:"series.scatter",dependencies:["grid","polar","geo","singleAxis","calendar"],getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this);},brushSelector:"point",getProgressive:function getProgressive(){var t=this.option.progressive;return null==t?this.option.large?5e3:this.get("progressive"):t;},getProgressiveThreshold:function getProgressiveThreshold(){var t=this.option.progressiveThreshold;return null==t?this.option.large?1e4:this.get("progressiveThreshold"):t;},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},clip:!0}});var Ov=ds({shape:{points:null},symbolProxy:null,softClipShape:null,buildPath:function buildPath(t,e){var i=e.points,n=e.size,a=this.symbolProxy,o=a.shape;if(!((t.getContext?t.getContext():t)&&n[0]<4))for(var r=0;r<i.length;){var s=i[r++],l=i[r++];isNaN(s)||isNaN(l)||this.softClipShape&&!this.softClipShape.contain(s,l)||(o.x=s-n[0]/2,o.y=l-n[1]/2,o.width=n[0],o.height=n[1],a.buildPath(t,o,!0));}},afterBrush:function afterBrush(t){var e=this.shape,i=e.points,n=e.size;if(n[0]<4){this.setTransform(t);for(var a=0;a<i.length;){var o=i[a++],r=i[a++];isNaN(o)||isNaN(r)||this.softClipShape&&!this.softClipShape.contain(o,r)||t.fillRect(o-n[0]/2,r-n[1]/2,n[0],n[1]);}this.restoreTransform(t);}},findDataIndex:function findDataIndex(t,e){for(var i=this.shape,n=i.points,a=i.size,o=Math.max(a[0],4),r=Math.max(a[1],4),s=n.length/2-1;0<=s;s--){var l=2*s,u=n[l]-o/2,h=n[1+l]-r/2;if(u<=t&&h<=e&&t<=u+o&&e<=h+r)return s;}return-1;}});function Ev(){this.group=new Si();}var Rv=Ev.prototype;function zv(t,e,i){vg.call(this,t,e,i),this.type="value",this.angle=0,this.name="",this.model;}function Bv(t,e,i){this._model=t,this.dimensions=[],this._indicatorAxes=N(t.getIndicatorModels(),function(t,e){var i="indicator_"+e,n=new zv(i,"log"===t.get("axisType")?new Op():new op());return n.name=t.get("name"),(n.model=t).axis=n,this.dimensions.push(i),n;},this),this.resize(t,i),this.cx,this.cy,this.r,this.r0,this.startAngle;}Rv.isPersistent=function(){return!this._incremental;},Rv.updateData=function(t,e){this.group.removeAll();var i=new Ov({rectHover:!0,cursor:"default"});i.setShape({points:t.getLayout("symbolPoints")}),this._setCommon(i,t,!1,e),this.group.add(i),this._incremental=null;},Rv.updateLayout=function(t){if(!this._incremental){var n=t.getLayout("symbolPoints");this.group.eachChild(function(t){if(null!=t.startIndex){var e=2*(t.endIndex-t.startIndex),i=4*t.startIndex*2;n=new Float32Array(n.buffer,i,e);}t.setShape("points",n);});}},Rv.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),2e6<t.count()?(this._incremental||(this._incremental=new ts({silent:!0})),this.group.add(this._incremental)):this._incremental=null;},Rv.incrementalUpdate=function(t,e,i){var n;this._incremental?(n=new Ov(),this._incremental.addDisplayable(n,!0)):((n=new Ov({rectHover:!0,cursor:"default",startIndex:t.start,endIndex:t.end})).incremental=!0,this.group.add(n)),n.setShape({points:e.getLayout("symbolPoints")}),this._setCommon(n,e,!!this._incremental,i);},Rv._setCommon=function(i,t,e,n){var a=t.hostModel;n=n||{};var o=t.getVisual("symbolSize");i.setShape("size",o instanceof Array?o:[o,o]),i.softClipShape=n.clipShape||null,i.symbolProxy=Jp(t.getVisual("symbol"),0,0,0,0),i.setColor=i.symbolProxy.setColor;var r=i.shape.size[0]<4;i.useStyle(a.getModel("itemStyle").getItemStyle(r?["color","shadowBlur","shadowColor"]:["color"]));var s=t.getVisual("color");s&&i.setColor(s),e||(i.seriesIndex=a.seriesIndex,i.on("mousemove",function(t){i.dataIndex=null;var e=i.findDataIndex(t.offsetX,t.offsetY);0<=e&&(i.dataIndex=e+(i.startIndex||0));}));},Rv.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll();},Rv._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles();},hf({type:"scatter",render:function render(t,e,i){var n=t.getData();this._updateSymbolDraw(n,t).updateData(n,{clipShape:this._getClipShape(t)}),this._finished=!0;},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){var n=t.getData();this._updateSymbolDraw(n,t).incrementalPrepareUpdate(n),this._finished=!1;},incrementalRender:function incrementalRender(t,e,i){this._symbolDraw.incrementalUpdate(t,e.getData(),{clipShape:this._getClipShape(e)}),this._finished=t.end===e.getData().count();},updateTransform:function updateTransform(t,e,i){var n=t.getData();if(this.group.dirty(),!this._finished||1e4<n.count()||!this._symbolDraw.isPersistent())return{update:!0};var a=sm().reset(t);a.progress&&a.progress({start:0,end:n.count()},n),this._symbolDraw.updateLayout(n);},_getClipShape:function _getClipShape(t){var e=t.coordinateSystem,i=e&&e.getArea&&e.getArea();return t.get("clip",!0)?i:null;},_updateSymbolDraw:function _updateSymbolDraw(t,e){var i=this._symbolDraw,n=e.pipelineContext.large;return i&&n===this._isLargeDraw||(i&&i.remove(),i=this._symbolDraw=n?new Ev():new Ng(),this._isLargeDraw=n,this.group.removeAll()),this.group.add(i.group),i;},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null;},dispose:function dispose(){}}),af(rm("scatter","circle")),nf(sm("scatter")),w(zv,vg),Bv.prototype.getIndicatorAxes=function(){return this._indicatorAxes;},Bv.prototype.dataToPoint=function(t,e){var i=this._indicatorAxes[e];return this.coordToPoint(i.dataToCoord(t),e);},Bv.prototype.coordToPoint=function(t,e){var i=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(i),this.cy-t*Math.sin(i)];},Bv.prototype.pointToData=function(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=Math.sqrt(e*e+i*i);e/=n,i/=n;for(var a,o=Math.atan2(-i,e),r=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],h=Math.abs(o-u.angle);h<r&&(a=u,s=l,r=h);}return[s,+(a&&a.coordToData(n))];},Bv.prototype.resize=function(t,e){var i=t.get("center"),n=e.getWidth(),a=e.getHeight(),o=Math.min(n,a)/2;this.cx=xl(i[0],n),this.cy=xl(i[1],a),this.startAngle=t.get("startAngle")*Math.PI/180;var r=t.get("radius");"string"!=typeof r&&"number"!=typeof r||(r=[0,r]),this.r0=xl(r[0],o),this.r=xl(r[1],o),E(this._indicatorAxes,function(t,e){t.setExtent(this.r0,this.r);var i=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;i=Math.atan2(Math.sin(i),Math.cos(i)),t.angle=i;},this);},Bv.prototype.update=function(n,t){var a=this._indicatorAxes,o=this._model;E(a,function(t){t.scale.setExtent(1/0,-1/0);}),n.eachSeriesByType("radar",function(t,e){if("radar"===t.get("coordinateSystem")&&n.getComponent("radar",t.get("radarIndex"))===o){var i=t.getData();E(a,function(t){t.scale.unionExtentFromData(i,i.mapDimension(t.dim));});}},this);var f=o.get("splitNumber");function p(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),i=t/e;return 2===i?i=5:i*=2,i*e;}E(a,function(t,e){var i=Rp(t.scale,t.model);zp(t.scale,t.model);var n=t.model,a=t.scale,o=n.getMin(),r=n.getMax(),s=a.getInterval();if(null!=o&&null!=r)a.setExtent(+o,+r),a.setInterval((r-o)/f);else if(null!=o)for(var l;l=o+s*f,a.setExtent(+o,l),a.setInterval(s),s=p(s),l<i[1]&&isFinite(l)&&isFinite(i[1]);){;}else if(null!=r)for(var u;u=r-s*f,a.setExtent(u,+r),a.setInterval(s),s=p(s),u>i[0]&&isFinite(u)&&isFinite(i[0]);){;}else{var h=a.getTicks().length-1;f<h&&(s=p(s));var c=Math.round((i[0]+i[1])/2/s)*s,d=Math.round(f/2);a.setExtent(_l(c-d*s),_l(c+(f-d)*s)),a.setInterval(s);}});},Bv.dimensions=[],Bv.create=function(i,n){var a=[];return i.eachComponent("radar",function(t){var e=new Bv(t,i,n);a.push(e),t.coordinateSystem=e;}),i.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=a[t.get("radarIndex")||0]);}),a;},Hu.register("radar",Bv);var Vv=gm.valueAxis;function Gv(t,e){return C({show:e},t);}sf({type:"radar",optionUpdated:function optionUpdated(){var a=this.get("boundaryGap"),o=this.get("splitNumber"),r=this.get("scale"),s=this.get("axisLine"),l=this.get("axisTick"),u=this.get("axisType"),h=this.get("axisLabel"),c=this.get("name"),d=this.get("name.show"),f=this.get("name.formatter"),p=this.get("nameGap"),g=this.get("triggerEvent"),t=N(this.get("indicator")||[],function(t){null!=t.max&&0<t.max&&!t.min?t.min=0:null!=t.min&&t.min<0&&!t.max&&(t.max=0);var e=c;if(null!=t.color&&(e=C({color:t.color},c)),t=m(D(t),{boundaryGap:a,splitNumber:o,scale:r,axisLine:s,axisTick:l,axisType:u,axisLabel:h,name:t.text,nameLocation:"end",nameGap:p,nameTextStyle:e,triggerEvent:g},!1),d||(t.name=""),"string"==typeof f){var i=t.name;t.name=f.replace("{value}",null!=i?i:"");}else"function"==typeof f&&(t.name=f(t.name,t));var n=L(new dl(t,null,this.ecModel),Hp);return n.mainType="radar",n.componentIndex=this.componentIndex,n;},this);this.getIndicatorModels=function(){return t;};},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:m({lineStyle:{color:"#bbb"}},Vv.axisLine),axisLabel:Gv(Vv.axisLabel,!1),axisTick:Gv(Vv.axisTick,!1),axisType:"interval",splitLine:Gv(Vv.splitLine,!0),splitArea:Gv(Vv.splitArea,!0),indicator:[]}});var Fv=["axisLine","axisTickLabel","axisName"];lf({type:"radar",render:function render(t,e,i){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t);},_buildAxes:function _buildAxes(t){var e=t.coordinateSystem;E(N(e.getIndicatorAxes(),function(t){return new Cm(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});}),function(t){E(Fv,t.add,t),this.group.add(t.getGroup());},this);},_buildSplitLineAndArea:function _buildSplitLineAndArea(t){var n=t.coordinateSystem,e=n.getIndicatorAxes();if(e.length){var i=t.get("shape"),a=t.getModel("splitLine"),o=t.getModel("splitArea"),r=a.getModel("lineStyle"),s=o.getModel("areaStyle"),l=a.get("show"),u=o.get("show"),h=r.get("color"),c=s.get("color");h=k(h)?h:[h],c=k(c)?c:[c];var d=[],f=[];if("circle"===i)for(var p=e[0].getTicksCoords(),g=n.cx,m=n.cy,v=0;v<p.length;v++){if(l)d[I(d,h,v)].push(new Lr({shape:{cx:g,cy:m,r:p[v].coord}}));if(u&&v<p.length-1)f[I(f,c,v)].push(new Nr({shape:{cx:g,cy:m,r0:p[v].coord,r:p[v+1].coord}}));}else{var y,x=N(e,function(t,e){var i=t.getTicksCoords();return y=null==y?i.length-1:Math.min(i.length-1,y),N(i,function(t){return n.coordToPoint(t.coord,e);});}),_=[];for(v=0;v<=y;v++){for(var w=[],b=0;b<e.length;b++){w.push(x[b][v]);}if(w[0]&&w.push(w[0].slice()),l)d[I(d,h,v)].push(new zr({shape:{points:w}}));if(u&&_)f[I(f,c,v-1)].push(new Rr({shape:{points:w.concat(_)}}));_=w.slice().reverse();}}var S=r.getLineStyle(),M=s.getAreaStyle();E(f,function(t,e){this.group.add(ys(t,{style:C({stroke:"none",fill:c[e%c.length]},M),silent:!0}));},this),E(d,function(t,e){this.group.add(ys(t,{style:C({fill:"none",stroke:h[e%h.length]},S),silent:!0}));},this);}function I(t,e,i){var n=i%e.length;return t[n]=t[n]||[],n;}}});var Wv=Wh.extend({type:"series.radar",dependencies:["radar"],init:function init(t){Wv.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData();};},getInitialData:function getInitialData(t,e){return yv(this,{generateCoord:"indicator_",generateCoordCount:1/0});},formatTooltip:function formatTooltip(n){var a=this.getData(),t=this.coordinateSystem.getIndicatorAxes(),e=this.getData().getName(n);return Wl(""===e?this.name:e)+"<br/>"+N(t,function(t,e){var i=a.get(a.mapDimension(t.dim),n);return Wl(t.name+" : "+i);}).join("<br />");},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid"},label:{position:"top"},symbol:"emptyCircle",symbolSize:4}});hf({type:"radar",render:function render(l,t,e){var i=l.coordinateSystem,g=this.group,m=l.getData(),s=this._data;function u(t,e){var i=t.getItemVisual(e,"symbol")||"circle",n=t.getItemVisual(e,"color");if("none"!==i){var a=function(t){return k(t)||(t=[+t,+t]),t;}(t.getItemVisual(e,"symbolSize")),o=Jp(i,-1,-1,2,2,n);return o.attr({style:{strokeNoScale:!0},z2:100,scale:[a[0]/2,a[1]/2]}),o;}}function h(t,e,i,n,a,o){i.removeAll();for(var r=0;r<e.length-1;r++){var s=u(n,a);s&&(t[s.__dimIdx=r]?(s.attr("position",t[r]),ol[o?"initProps":"updateProps"](s,{position:e[r]},l,a)):s.attr("position",e[r]),i.add(s));}}function c(t){return N(t,function(t){return[i.cx,i.cy];});}m.diff(s).add(function(t){var e=m.getItemLayout(t);if(e){var i=new Rr(),n=new zr(),a={shape:{points:e}};i.shape.points=c(e),n.shape.points=c(e),qs(i,a,l,t),qs(n,a,l,t);var o=new Si(),r=new Si();o.add(n),o.add(i),o.add(r),h(n.shape.points,e,r,m,t,!0),m.setItemGraphicEl(t,o);}}).update(function(t,e){var i=s.getItemGraphicEl(e),n=i.childAt(0),a=i.childAt(1),o=i.childAt(2),r={shape:{points:m.getItemLayout(t)}};r.shape.points&&(h(n.shape.points,r.shape.points,o,m,t,!1),js(n,r,l),js(a,r,l),m.setItemGraphicEl(t,i));}).remove(function(t){g.remove(s.getItemGraphicEl(t));}).execute(),m.eachItemGraphicEl(function(t,i){var e=m.getItemModel(i),n=t.childAt(0),a=t.childAt(1),o=t.childAt(2),r=m.getItemVisual(i,"color");g.add(t),n.useStyle(C(e.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:r})),n.hoverStyle=e.getModel("emphasis.lineStyle").getLineStyle();var s=e.getModel("areaStyle"),l=e.getModel("emphasis.areaStyle"),u=s.isEmpty()&&s.parentModel.isEmpty(),h=l.isEmpty()&&l.parentModel.isEmpty();h=h&&u,a.ignore=u,a.useStyle(C(s.getAreaStyle(),{fill:r,opacity:.7})),a.hoverStyle=l.getAreaStyle();var c=e.getModel("itemStyle").getItemStyle(["color"]),d=e.getModel("emphasis.itemStyle").getItemStyle(),f=e.getModel("label"),p=e.getModel("emphasis.label");o.eachChild(function(t){t.setStyle(c),t.hoverStyle=D(d);var e=m.get(m.dimensions[t.__dimIdx],i);null!=e&&!isNaN(e)||(e=""),Bs(t.style,t.hoverStyle,f,p,{labelFetcher:m.hostModel,labelDataIndex:i,labelDimIndex:t.__dimIdx,defaultText:e,autoColor:r,isRectText:!0});}),t.highDownOnUpdate=function(t,e){a.attr("ignore","emphasis"===e?h:u);},Os(t);}),this._data=m;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});function Hv(t){return!isNaN(t[0])&&!isNaN(t[1]);}function Zv(t){return[t.cx,t.cy];}af(Av("radar")),af(rm("radar","circle")),nf(function(t){t.eachSeriesByType("radar",function(t){var i=t.getData(),a=[],o=t.coordinateSystem;if(o){var e=o.getIndicatorAxes();E(e,function(t,n){i.each(i.mapDimension(e[n].dim),function(t,e){a[e]=a[e]||[];var i=o.dataToPoint(t,n);a[e][n]=Hv(i)?i:Zv(o);});}),i.each(function(t){var e=I(a[t],function(t){return Hv(t);})||Zv(o);a[t].push(e.slice()),i.setItemLayout(t,a[t]);});}});}),Qd(kv("radar")),Jd(function(i){var t=i.polar;if(t){k(t)||(t=[t]);var n=[];E(t,function(t,e){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),i.radar=i.radar||[],k(i.radar)||(i.radar=[i.radar]),i.radar.push(t)):n.push(t);}),i.polar=n;}E(i.series,function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex);});});for(var Uv=[126,25],Xv=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],Yv=0;Yv<Xv.length;Yv++){for(var jv=0;jv<Xv[Yv].length;jv++){Xv[Yv][jv][0]/=10.5,Xv[Yv][jv][1]/=-14,Xv[Yv][jv][0]+=Uv[0],Xv[Yv][jv][1]+=Uv[1];}}var qv={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},Kv={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},$v=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],Jv=La(),Qv={load:function load(n,t){var e=Jv(t).parsed;if(e)return e;var i,a=t.specialAreas||{},o=t.geoJSON;try{i=o?rg(o):[];}catch(t){throw new Error("Invalid geoJson format\n"+t.message);}return function(t,e){"china"===t&&e.push(new ag("南海诸岛",N(Xv,function(t){return{type:"polygon",exterior:t};}),Uv));}(n,i),E(i,function(t){var e=t.name;!function(t,e){if("china"===t){var i=qv[e.name];if(i){var n=e.center;n[0]+=i[0]/10.5,n[1]+=-i[1]/14;}}}(n,t),function(t,e){if("world"===t){var i=Kv[e.name];if(i){var n=e.center;n[0]=i[0],n[1]=i[1];}}}(n,t),function(t,e){"china"===t&&"台湾"===e.name&&e.geometries.push({type:"polygon",exterior:$v[0]});}(n,t);var i=a[e];i&&t.transformTo(i.left,i.top,i.width,i.height);}),Jv(t).parsed={regions:i,boundingRect:function(t){for(var e,i=0;i<t.length;i++){var n=t[i].getBoundingRect();(e=e||n.clone()).union(n);}return e;}(i)};}};var ty=La();function ey(t,e){var i,n,a=t.svgXML;try{Y(null!=(n=(i=a&&function(t,e){return new Uc().parse(t,e);}(a,{ignoreViewBox:!0,ignoreRootClip:!0})||{}).root));}catch(t){throw new Error("Invalid svg format\n"+t.message);}var o=i.width,r=i.height,s=i.viewBoxRect;if(e||(e=null==o||null==r?n.getBoundingRect():new bi(0,0,0,0),null!=o&&(e.width=o),null!=r&&(e.height=r)),s){var l=id(s,e.width,e.height),u=n;(n=new Si()).add(u),u.scale=l.scale,u.position=l.position;}return n.setClipPath(new Hr({shape:e.plain()})),{root:n,boundingRect:e};}var iy={geoJSON:Qv,svg:{load:function load(t,e){var i=ty(e).originRoot;if(i)return{root:i,boundingRect:ty(e).boundingRect};var n=ey(e);return ty(e).originRoot=n.root,ty(e).boundingRect=n.boundingRect,n;},makeGraphic:function makeGraphic(t,e,i){var n=ty(e),a=n.rootMap||(n.rootMap=Q()),o=a.get(i);if(o)return o;var r=n.originRoot,s=n.boundingRect;return o=n.originRootHostKey?ey(e,s).root:(n.originRootHostKey=i,r),a.set(i,o);},removeGraphic:function removeGraphic(t,e,i){var n=ty(e),a=n.rootMap;a&&a.removeKey(i),i===n.originRootHostKey&&(n.originRootHostKey=null);}}},ny={load:function load(n,a){var o,r=[],s=Q(),l=Q();return E(oy(n),function(t){var e=iy[t.type].load(n,t);E(e.regions,function(t){var e=t.name;a&&a.hasOwnProperty(e)&&(t=t.cloneShallow(e=a[e])),r.push(t),s.set(e,t),l.set(e,t.center);});var i=e.boundingRect;i&&(o?o.union(i):o=i.clone());}),{regions:r,regionsMap:s,nameCoordMap:l,boundingRect:o||new bi(0,0,0,0)};},makeGraphic:ay("makeGraphic"),removeGraphic:ay("removeGraphic")};function ay(o){return function(i,n){var t=oy(i),a=[];return E(t,function(t){var e=iy[t.type][o];e&&a.push(e(i,t,n));}),a;};}function oy(t){return ad.retrieveMap(t)||[];}b(Wh.extend({type:"series.map",dependencies:["geo"],layoutMode:"box",needsDrawMap:!1,seriesGroup:[],getInitialData:function getInitialData(t){for(var e=yv(this,["value"]),i=e.mapDimension("value"),n=Q(),a=[],o=[],r=0,s=e.count();r<s;r++){var l=e.getName(r);n.set(l,!0),a.push({name:l,value:e.get(i,r),selected:Ih(e,r,"selected")});}return E(ny.load(this.getMapType(),this.option.nameMap).regions,function(t){var e=t.name;n.get(e)||(a.push({name:e}),o.push(e));}),this.updateSelectedMap(a),e.appendValues([],o),e;},getHostGeoModel:function getHostGeoModel(){var t=this.option.geoIndex;return null!=t?this.dependentModels.geo[t]:null;},getMapType:function getMapType(){return(this.getHostGeoModel()||this).option.map;},getRawValue:function getRawValue(t){var e=this.getData();return e.get(e.mapDimension("value"),t);},getRegionModel:function getRegionModel(t){var e=this.getData();return e.getItemModel(e.indexOfName(t));},formatTooltip:function formatTooltip(t){for(var e=this.getData(),i=zl(this.getRawValue(t)),n=e.getName(t),a=this.seriesGroup,o=[],r=0;r<a.length;r++){var s=a[r].originalData.indexOfName(n),l=e.mapDimension("value");isNaN(a[r].originalData.get(l,s))||o.push(Wl(a[r].name));}return o.join(", ")+"<br />"+Wl(n+" : "+i);},getTooltipPosition:function getTooltipPosition(t){if(null!=t){var e=this.getData().getName(t),i=this.coordinateSystem,n=i.getRegion(e);return n&&i.dataToPoint(n.center);}},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}}}}),xv);var ry="\0_ec_interaction_mutex";function sy(t,e){return!!ly(t)[e];}function ly(t){return t[ry]||(t[ry]={});}function uy(i){this.pointerChecker,this._zr=i,this._opt={};var t=T,n=t(hy,this),a=t(cy,this),o=t(dy,this),r=t(fy,this),s=t(py,this);Ct.call(this),this.setPointerChecker=function(t){this.pointerChecker=t;},this.enable=function(t,e){this.disable(),this._opt=C(D(e)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(i.on("mousedown",n),i.on("mousemove",a),i.on("mouseup",o)),!0!==t&&"scale"!==t&&"zoom"!==t||(i.on("mousewheel",r),i.on("pinch",s));},this.disable=function(){i.off("mousedown",n),i.off("mousemove",a),i.off("mouseup",o),i.off("mousewheel",r),i.off("pinch",s);},this.dispose=this.disable,this.isDragging=function(){return this._dragging;},this.isPinching=function(){return this._pinching;};}function hy(t){if(!(Wt(t)||t.target&&t.target.draggable)){var e=t.offsetX,i=t.offsetY;this.pointerChecker&&this.pointerChecker(t,e,i)&&(this._x=e,this._y=i,this._dragging=!0);}}function cy(t){if(this._dragging&&vy("moveOnMouseMove",t,this._opt)&&"pinch"!==t.gestureEvent&&!sy(this._zr,"globalPan")){var e=t.offsetX,i=t.offsetY,n=this._x,a=this._y,o=e-n,r=i-a;this._x=e,this._y=i,this._opt.preventDefaultMouseMove&&Ft(t.event),my(this,"pan","moveOnMouseMove",t,{dx:o,dy:r,oldX:n,oldY:a,newX:e,newY:i});}}function dy(t){Wt(t)||(this._dragging=!1);}function fy(t){var e=vy("zoomOnMouseWheel",t,this._opt),i=vy("moveOnMouseWheel",t,this._opt),n=t.wheelDelta,a=Math.abs(n),o=t.offsetX,r=t.offsetY;if(0!==n&&(e||i)){if(e){var s=3<a?1.4:1<a?1.2:1.1;gy(this,"zoom","zoomOnMouseWheel",t,{scale:0<n?s:1/s,originX:o,originY:r});}if(i){var l=Math.abs(n);gy(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:(0<n?1:-1)*(3<l?.4:1<l?.15:.05),originX:o,originY:r});}}}function py(t){sy(this._zr,"globalPan")||gy(this,"zoom",null,t,{scale:1<t.pinchScale?1.1:1/1.1,originX:t.pinchX,originY:t.pinchY});}function gy(t,e,i,n,a){t.pointerChecker&&t.pointerChecker(n,a.originX,a.originY)&&(Ft(n.event),my(t,e,i,n,a));}function my(t,e,i,n,a){a.isAvailableBehavior=T(vy,null,i,n),t.trigger(e,a);}function vy(t,e,i){var n=i[t];return!t||n&&(!R(n)||e.event[n+"Key"]);}function yy(t,e,i){var n=t.target,a=n.position;a[0]+=e,a[1]+=i,n.dirty();}function xy(t,e,i,n){var a=t.target,o=t.zoomLimit,r=a.position,s=a.scale,l=t.zoom=t.zoom||1;if(l*=e,o){var u=o.min||0,h=o.max||1/0;l=Math.max(Math.min(h,l),u);}var c=l/t.zoom;t.zoom=l,r[0]-=(i-r[0])*(c-1),r[1]-=(n-r[1])*(c-1),s[0]*=c,s[1]*=c,a.dirty();}tf({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),b(uy,Ct);var _y={axisPointer:1,tooltip:1,brush:1};function wy(t,e,i){var n=e.getComponentByElement(t.topTarget),a=n&&n.coordinateSystem;return n&&n!==i&&!_y[n.mainType]&&a&&a.model!==i;}function by(t){var e=t.getItemStyle(),i=t.get("areaColor");return null!=i&&(e.fill=i),e;}function Sy(i,t){t.eachChild(function(e){E(e.__regions,function(t){e.trigger(i.isSelected(t.name)?"emphasis":"normal");});});}function My(t,e){var i=new Si();this.uid=ml("ec_map_draw"),this._controller=new uy(t.getZr()),this._controllerHost={target:e?i:null},this.group=i,this._updateGroup=e,this._mouseDownFlag,this._mapName,this._initialized,i.add(this._regionsGroup=new Si()),i.add(this._backgroundGroup=new Si());}My.prototype={constructor:My,draw:function draw(_,t,e,i,n){var w="geo"===_.mainType,b=_.getData&&_.getData();w&&t.eachComponent({mainType:"series",subType:"map"},function(t){b||t.getHostGeoModel()!==_||(b=t.getData());});var a=_.coordinateSystem;this._updateBackground(a);var S=this._regionsGroup,M=this.group;a._roamTransformable.transform&&(M.transform=a._roamTransformable.transform.slice(),M.decomposeTransform());var I=a._rawTransformable.scale,A=a._rawTransformable.position;S.removeAll();var T=["itemStyle"],D=["emphasis","itemStyle"],C=["label"],L=["emphasis","label"],k=Q();E(a.regions,function(t){var e=k.get(t.name)||k.set(t.name,new Si()),o=new $r({segmentIgnoreThreshold:1,shape:{paths:[]}});e.add(o);var i,n=(x=_.getRegionModel(t.name)||_).getModel(T),a=x.getModel(D),r=by(n),s=by(a),l=x.getModel(C),u=x.getModel(L);if(b){i=b.indexOfName(t.name);var h=b.getItemVisual(i,"color",!0);h&&(r.fill=h);}function c(t){return[t[0]*I[0]+A[0],t[1]*I[1]+A[1]];}E(t.geometries,function(t){if("polygon"===t.type){for(var e=[],i=0;i<t.exterior.length;++i){e.push(c(t.exterior[i]));}o.shape.paths.push(new Rr({segmentIgnoreThreshold:1,shape:{points:e}}));for(i=0;i<(t.interiors?t.interiors.length:0);++i){for(var n=t.interiors[i],a=(e=[],0);a<n.length;++a){e.push(c(n[a]));}o.shape.paths.push(new Rr({segmentIgnoreThreshold:1,shape:{points:e}}));}}}),o.setStyle(r),o.style.strokeNoScale=!0,o.culling=!0;var d=l.get("show"),f=u.get("show"),p=b&&isNaN(b.get(b.mapDimension("value"),i)),g=b&&b.getItemLayout(i);if(w||p&&(d||f)||g&&g.showLabel){var m,v=w?t.name:i;(!b||0<=i)&&(m=_);var y=new Dr({position:c(t.center.slice()),scale:[1/M.scale[0],1/M.scale[1]],z2:10,silent:!0});Bs(y.style,y.hoverStyle={},l,u,{labelFetcher:m,labelDataIndex:v,defaultText:t.name,useInsideStyle:!1},{textAlign:"center",textVerticalAlign:"middle"}),e.add(y);}if(b)b.setItemGraphicEl(i,e);else{var x=_.getRegionModel(t.name);o.eventData={componentType:"geo",componentIndex:_.componentIndex,geoIndex:_.componentIndex,name:t.name,region:x&&x.option||{}};}(e.__regions||(e.__regions=[])).push(t),e.highDownSilentOnTouch=!!_.get("selectedMode"),Os(e,s),S.add(e);}),this._updateController(_,t,e),function(n,a,o,r,s){o.off("click"),o.off("mousedown"),a.get("selectedMode")&&(o.on("mousedown",function(){n._mouseDownFlag=!0;}),o.on("click",function(t){if(n._mouseDownFlag){n._mouseDownFlag=!1;for(var e=t.target;!e.__regions;){e=e.parent;}if(e){var i={type:("geo"===a.mainType?"geo":"map")+"ToggleSelect",batch:N(e.__regions,function(t){return{name:t.name,from:s.uid};})};i[a.mainType+"Id"]=a.id,r.dispatchAction(i),Sy(a,o);}}}));}(this,_,S,e,i),Sy(_,S);},remove:function remove(){this._regionsGroup.removeAll(),this._backgroundGroup.removeAll(),this._controller.dispose(),this._mapName&&ny.removeGraphic(this._mapName,this.uid),this._mapName=null,this._controllerHost={};},_updateBackground:function _updateBackground(t){var e=t.map;this._mapName!==e&&E(ny.makeGraphic(e,this.uid),function(t){this._backgroundGroup.add(t);},this),this._mapName=e;},_updateController:function _updateController(n,t,a){var o=n.coordinateSystem,e=this._controller,i=this._controllerHost;i.zoomLimit=n.get("scaleLimit"),i.zoom=o.getZoom(),e.enable(n.get("roam")||!1);var r=n.mainType;function s(){var t={type:"geoRoam",componentType:r};return t[r+"Id"]=n.id,t;}e.off("pan").on("pan",function(t){this._mouseDownFlag=!1,yy(i,t.dx,t.dy),a.dispatchAction(L(s(),{dx:t.dx,dy:t.dy}));},this),e.off("zoom").on("zoom",function(t){if(this._mouseDownFlag=!1,xy(i,t.scale,t.originX,t.originY),a.dispatchAction(L(s(),{zoom:t.scale,originX:t.originX,originY:t.originY})),this._updateGroup){var e=this.group.scale;this._regionsGroup.traverse(function(t){"text"===t.type&&t.attr("scale",[1/e[0],1/e[1]]);});}},this),e.setPointerChecker(function(t,e,i){return o.getViewRectAfterRoam().contain(e,i)&&!wy(t,a,n);});}};var Iy="__seriesMapHighDown",Ay="__seriesMapCallKey";function Ty(t){var e=this[Iy];e&&e.recordVersion===this[Ay]&&Dy(e,t);}function Dy(t,e){var i=t.circle,n=t.labelModel,a=t.hoverLabelModel,o=t.emphasisText,r=t.normalText;e?(i.style.extendFrom(Gs({},a,{text:a.get("show")?o:null},{isRectText:!0,useInsideStyle:!1},!0)),i.__mapOriginalZ2=i.z2,i.z2+=os):(Gs(i.style,n,{text:n.get("show")?r:null,textPosition:n.getShallow("position")||"bottom"},{isRectText:!0,useInsideStyle:!1}),i.dirty(!1),null!=i.__mapOriginalZ2&&(i.z2=i.__mapOriginalZ2,i.__mapOriginalZ2=null));}function Cy(t,e,i){var n=t.getZoom(),a=t.getCenter(),o=e.zoom,r=t.dataToPoint(a);if(null!=e.dx&&null!=e.dy){r[0]-=e.dx,r[1]-=e.dy;a=t.pointToData(r);t.setCenter(a);}if(null!=o){if(i){var s=i.min||0,l=i.max||1/0;o=Math.max(Math.min(n*o,l),s)/n;}t.scale[0]*=o,t.scale[1]*=o;var u=t.position,h=(e.originX-u[0])*(o-1),c=(e.originY-u[1])*(o-1);u[0]-=h,u[1]-=c,t.updateTransform();a=t.pointToData(r);t.setCenter(a),t.setZoom(o*n);}return{center:t.getCenter(),zoom:t.getZoom()};}hf({type:"map",render:function render(t,e,i,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var a=this.group;if(a.removeAll(),!t.getHostGeoModel()){if(n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===t.id)(o=this._mapDraw)&&a.add(o.group);else if(t.needsDrawMap){var o=this._mapDraw||new My(i,!0);a.add(o.group),o.draw(t,e,i,this,n),this._mapDraw=o;}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,i);}}},remove:function remove(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll();},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;},_renderSymbols:function _renderSymbols(x,t,e){var _=x.originalData,w=this.group;_.each(_.mapDimension("value"),function(t,e){if(!isNaN(t)){var i=_.getItemLayout(e);if(i&&i.point){var n=i.point,a=i.offset,o=new Lr({style:{fill:x.getData().getVisual("color")},shape:{cx:n[0]+9*a,cy:n[1],r:3},silent:!0,z2:8+(a?0:os+1)});if(!a){var r=x.mainSeries.getData(),s=_.getName(e),l=r.indexOfName(s),u=_.getItemModel(e),h=u.getModel("label"),c=u.getModel("emphasis.label"),d=r.getItemGraphicEl(l),f=H(x.getFormattedLabel(l,"normal"),s),p=H(x.getFormattedLabel(l,"emphasis"),f),g=d[Iy],m=Math.random();if(!g){g=d[Iy]={};var v=A(Ty,!0),y=A(Ty,!1);d.on("mouseover",v).on("mouseout",y).on("emphasis",v).on("normal",y);}L(g,{recordVersion:d[Ay]=m,circle:o,labelModel:h,hoverLabelModel:c,emphasisText:p,normalText:f}),Dy(g,!1);}w.add(o);}}});}}),tf({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(n,t){var a=n.componentType||"series";t.eachComponent({mainType:a,query:n},function(t){var e=t.coordinateSystem;if("geo"===e.type){var i=Cy(e,n,t.get("scaleLimit"));t.setCenter&&t.setCenter(i.center),t.setZoom&&t.setZoom(i.zoom),"series"===a&&E(t.seriesGroup,function(t){t.setCenter(i.center),t.setZoom(i.zoom);});}});});var Ly=bt;function ky(){ce.call(this);}function Py(t){this.name=t,this.zoomLimit,ce.call(this),this._roamTransformable=new ky(),this._rawTransformable=new ky(),this._center,this._zoom;}function Ny(t,e,i,n){var a=i.seriesModel,o=a?a.coordinateSystem:null;return o===this?o[t](n):null;}function Oy(t,e,i,n){Py.call(this,t),this.map=e;var a=ny.load(e,i);this._nameCoordMap=a.nameCoordMap,this._regionsMap=a.regionsMap,this._invertLongitute=null==n||n,this.regions=a.regions,this._rect=a.boundingRect;}function Ey(t,e,i,n){var a=i.geoModel,o=i.seriesModel,r=a?a.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return r===this?r[t](n):null;}function Ry(t,e){var i=t.get("boundingCoords");if(null!=i){var n=i[0],a=i[1];isNaN(n[0])||isNaN(n[1])||isNaN(a[0])||isNaN(a[1])||this.setBoundingRect(n[0],n[1],a[0]-n[0],a[1]-n[1]);}var o,r=this.getBoundingRect(),s=t.get("layoutCenter"),l=t.get("layoutSize"),u=e.getWidth(),h=e.getHeight(),c=r.width/r.height*this.aspectScale,d=!1;if(s&&l&&(s=[xl(s[0],u),xl(s[1],h)],l=xl(l,Math.min(u,h)),isNaN(s[0])||isNaN(s[1])||isNaN(l)||(d=!0)),d){var f={};1<c?(f.width=l,f.height=l/c):(f.height=l,f.width=l*c),f.y=s[1]-f.height/2,f.x=s[0]-f.width/2;}else(o=t.getBoxLayoutParams()).aspect=c,f=au(o,{width:u,height:h});this.setViewRect(f.x,f.y,f.width,f.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"));}function zy(i,t){E(t.get("geoCoord"),function(t,e){i.addGeoCoord(e,t);});}b(ky,ce),Py.prototype={constructor:Py,type:"view",dimensions:["x","y"],setBoundingRect:function setBoundingRect(t,e,i,n){return this._rect=new bi(t,e,i,n),this._rect;},getBoundingRect:function getBoundingRect(){return this._rect;},setViewRect:function setViewRect(t,e,i,n){this.transformTo(t,e,i,n),this._viewRect=new bi(t,e,i,n);},transformTo:function transformTo(t,e,i,n){var a=this.getBoundingRect(),o=this._rawTransformable;o.transform=a.calculateTransform(new bi(t,e,i,n)),o.decomposeTransform(),this._updateTransform();},setCenter:function setCenter(t){t&&(this._center=t,this._updateCenterAndZoom());},setZoom:function setZoom(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom();},getDefaultCenter:function getDefaultCenter(){var t=this.getBoundingRect();return[t.x+t.width/2,t.y+t.height/2];},getCenter:function getCenter(){return this._center||this.getDefaultCenter();},getZoom:function getZoom(){return this._zoom||1;},getRoamTransform:function getRoamTransform(){return this._roamTransformable.getLocalTransform();},_updateCenterAndZoom:function _updateCenterAndZoom(){var t=this._rawTransformable.getLocalTransform(),e=this._roamTransformable,i=this.getDefaultCenter(),n=this.getCenter(),a=this.getZoom();n=bt([],n,t),i=bt([],i,t),e.origin=n,e.position=[i[0]-n[0],i[1]-n[1]],e.scale=[a,a],this._updateTransform();},_updateTransform:function _updateTransform(){var t=this._roamTransformable,e=this._rawTransformable;(e.parent=t).updateTransform(),e.updateTransform(),ee(this.transform||(this.transform=[]),e.transform||Qt()),this._rawTransform=e.getLocalTransform(),this.invTransform=this.invTransform||[],re(this.invTransform,this.transform),this.decomposeTransform();},getViewRect:function getViewRect(){return this._viewRect;},getViewRectAfterRoam:function getViewRectAfterRoam(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t;},dataToPoint:function dataToPoint(t,e,i){var n=e?this._rawTransform:this.transform;return i=i||[],n?Ly(i,t,n):ot(i,t);},pointToData:function pointToData(t){var e=this.invTransform;return e?Ly([],t,e):[t[0],t[1]];},convertToPixel:A(Ny,"dataToPoint"),convertFromPixel:A(Ny,"pointToData"),containPoint:function containPoint(t){return this.getViewRectAfterRoam().contain(t[0],t[1]);}},b(Py,ce),Oy.prototype={constructor:Oy,type:"geo",dimensions:["lng","lat"],containCoord:function containCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return!0;}return!1;},transformTo:function transformTo(t,e,i,n){var a=this.getBoundingRect(),o=this._invertLongitute;a=a.clone(),o&&(a.y=-a.y-a.height);var r=this._rawTransformable;if(r.transform=a.calculateTransform(new bi(t,e,i,n)),r.decomposeTransform(),o){var s=r.scale;s[1]=-s[1];}r.updateTransform(),this._updateTransform();},getRegion:function getRegion(t){return this._regionsMap.get(t);},getRegionByCoord:function getRegionByCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return e[i];}},addGeoCoord:function addGeoCoord(t,e){this._nameCoordMap.set(t,e);},getGeoCoord:function getGeoCoord(t){return this._nameCoordMap.get(t);},getBoundingRect:function getBoundingRect(){return this._rect;},dataToPoint:function dataToPoint(t,e,i){if("string"==typeof t&&(t=this.getGeoCoord(t)),t)return Py.prototype.dataToPoint.call(this,t,e,i);},convertToPixel:A(Ey,"dataToPoint"),convertFromPixel:A(Ey,"pointToData")},b(Oy,Py);var By={dimensions:Oy.prototype.dimensions,create:function create(t,s){var l=[];t.eachComponent("geo",function(t,e){var i=t.get("map"),n=t.get("aspectScale"),a=!0,o=ad.retrieveMap(i);o&&o[0]&&"svg"===o[0].type?(null==n&&(n=1),a=!1):null==n&&(n=.75);var r=new Oy(i+e,i,t.get("nameMap"),a);r.aspectScale=n,r.zoomLimit=t.get("scaleLimit"),l.push(r),zy(r,t),(t.coordinateSystem=r).model=t,r.resize=Ry,r.resize(t,s);}),t.eachSeries(function(t){if("geo"===t.get("coordinateSystem")){var e=t.get("geoIndex")||0;t.coordinateSystem=l[e];}});var i={};return t.eachSeriesByType("map",function(t){if(!t.getHostGeoModel()){var e=t.getMapType();i[e]=i[e]||[],i[e].push(t);}}),E(i,function(t,e){var i=new Oy(e,e,p(N(t,function(t){return t.get("nameMap");})));i.zoomLimit=W.apply(null,N(t,function(t){return t.get("scaleLimit");})),l.push(i),i.resize=Ry,i.aspectScale=t[0].get("aspectScale"),i.resize(t[0],s),E(t,function(t){zy(t.coordinateSystem=i,t);});}),l;},getFilledRegions:function getFilledRegions(t,e,i){for(var n=(t||[]).slice(),a=Q(),o=0;o<n.length;o++){a.set(n[o].name,n[o]);}return E(ny.load(e,i).regions,function(t){var e=t.name;a.get(e)||n.push({name:e});}),n;}};ef("geo",By);nf(function(i){var a={};i.eachSeriesByType("map",function(t){var e=t.getMapType();if(!t.getHostGeoModel()&&!a[e]){var l={};E(t.seriesGroup,function(t){var r=t.coordinateSystem,s=t.originalData;t.get("showLegendSymbol")&&i.getComponent("legend")&&s.each(s.mapDimension("value"),function(t,e){var i=s.getName(e),n=r.getRegion(i);if(n&&!isNaN(t)){var a=l[i]||0,o=r.dataToPoint(n.center);l[i]=a+1,s.setItemLayout(e,{point:o,offset:a});}});});var n=t.getData();n.each(function(t){var e=n.getName(t),i=n.getItemLayout(t)||{};i.showLabel=!l[e],n.setItemLayout(t,i);}),a[e]=!0;}});}),af(function(t){t.eachSeriesByType("map",function(t){var e=t.get("color"),i=t.getModel("itemStyle"),n=i.get("areaColor"),a=i.get("color")||e[t.seriesIndex%e.length];t.getData().setVisual({areaColor:n,color:a});});}),Qd(cd.PROCESSOR.STATISTIC,function(t){var n={};t.eachSeriesByType("map",function(t){var e=t.getHostGeoModel(),i=e?"o"+e.id:"i"+t.getMapType();(n[i]=n[i]||[]).push(t);}),E(n,function(t,e){for(var i=function(u,h){var c={};return E(u,function(n){n.each(n.mapDimension("value"),function(t,e){var i="ec-"+n.getName(e);c[i]=c[i]||[],isNaN(t)||c[i].push(t);});}),u[0].map(u[0].mapDimension("value"),function(t,e){for(var i,n="ec-"+u[0].getName(e),a=0,o=1/0,r=-1/0,s=c[n].length,l=0;l<s;l++){o=Math.min(o,c[n][l]),r=Math.max(r,c[n][l]),a+=c[n][l];}return i="min"===h?o:"max"===h?r:"average"===h?a/s:a,0===s?NaN:i;});}(N(t,function(t){return t.getData();}),t[0].get("mapValueCalculation")),n=0;n<t.length;n++){t[n].originalData=t[n].getData();}for(n=0;n<t.length;n++){(t[n].seriesGroup=t)[n].needsDrawMap=0===n&&!t[n].getHostGeoModel(),t[n].setData(i.cloneShallow()),t[n].mainSeries=t[0];}});}),Jd(function(t){var e=[];E(t.series,function(t){t&&"map"===t.type&&(e.push(t),t.map=t.map||t.mapType,C(t,t.mapLocation));});}),Iv("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);var Vy=E,Gy="\0__link_datas",Fy="\0__link_mainData";function Wy(i){var n=i.mainData,t=i.datas;t||(t={main:n},i.datasAttr={main:"data"}),i.datas=i.mainData=null,Yy(n,t,i),Vy(t,function(e){Vy(n.TRANSFERABLE_METHODS,function(t){e.wrapMethod(t,A(Hy,i));});}),n.wrapMethod("cloneShallow",A(Uy,i)),Vy(n.CHANGABLE_METHODS,function(t){n.wrapMethod(t,A(Zy,i));}),Y(t[n.dataType]===n);}function Hy(t,e){if(function(t){return t[Fy]===t;}(this)){var i=L({},this[Gy]);Yy(i[this.dataType]=e,i,t);}else jy(e,this.dataType,this[Fy],t);return e;}function Zy(t,e){return t.struct&&t.struct.update(this),e;}function Uy(i,n){return Vy(n[Gy],function(t,e){t!==n&&jy(t.cloneShallow(),e,n,i);}),n;}function Xy(t){var e=this[Fy];return null==t||null==e?e:e[Gy][t];}function Yy(i,t,n){i[Gy]={},Vy(t,function(t,e){jy(t,e,i,n);});}function jy(t,e,i,n){(i[Gy][e]=t)[Fy]=i,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=Xy;}function qy(t,e){this.name=t||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=e;}function Ky(e,t,i){this.root,this.data,this._nodes=[],this.hostModel=e,this.levelModels=N(t||[],function(t){return new dl(t,e,e.ecModel);}),this.leavesModel=new dl(i||{},e,e.ecModel);}function $y(t,e){var i=e.children;t.parentNode!==e&&(i.push(t),t.parentNode=e);}function Jy(t,e){var i=t.isExpand?t.children:[],n=t.parentNode.children,a=t.hierNode.i?n[t.hierNode.i-1]:null;if(i.length){!function(t){var e=t.children,i=e.length,n=0,a=0;for(;0<=--i;){var o=e[i];o.hierNode.prelim+=n,o.hierNode.modifier+=n,a+=o.hierNode.change,n+=o.hierNode.shift+a;}}(t);var o=(i[0].hierNode.prelim+i[i.length-1].hierNode.prelim)/2;a?(t.hierNode.prelim=a.hierNode.prelim+e(t,a),t.hierNode.modifier=t.hierNode.prelim-o):t.hierNode.prelim=o;}else a&&(t.hierNode.prelim=a.hierNode.prelim+e(t,a));t.parentNode.hierNode.defaultAncestor=function(t,e,i,n){if(e){for(var a=t,o=t,r=o.parentNode.children[0],s=e,l=a.hierNode.modifier,u=o.hierNode.modifier,h=r.hierNode.modifier,c=s.hierNode.modifier;s=ix(s),o=nx(o),s&&o;){a=ix(a),r=nx(r),a.hierNode.ancestor=t;var d=s.hierNode.prelim+c-o.hierNode.prelim-u+n(s,o);0<d&&(ax((p=t,g=i,(f=s).hierNode.ancestor.parentNode===p.parentNode?f.hierNode.ancestor:g),t,d),u+=d,l+=d),c+=s.hierNode.modifier,u+=o.hierNode.modifier,l+=a.hierNode.modifier,h+=r.hierNode.modifier;}s&&!ix(a)&&(a.hierNode.thread=s,a.hierNode.modifier+=c-l),o&&!nx(r)&&(r.hierNode.thread=o,r.hierNode.modifier+=u-h,i=t);}var f,p,g;return i;}(t,a,t.parentNode.hierNode.defaultAncestor||n[0],e);}function Qy(t){var e=t.hierNode.prelim+t.parentNode.hierNode.modifier;t.setLayout({x:e},!0),t.hierNode.modifier+=t.parentNode.hierNode.modifier;}function tx(t){return arguments.length?t:ox;}function ex(t,e){var i={};return t-=Math.PI/2,i.x=e*Math.cos(t),i.y=e*Math.sin(t),i;}function ix(t){var e=t.children;return e.length&&t.isExpand?e[e.length-1]:t.hierNode.thread;}function nx(t){var e=t.children;return e.length&&t.isExpand?e[0]:t.hierNode.thread;}function ax(t,e,i){var n=i/(e.hierNode.i-t.hierNode.i);e.hierNode.change-=n,e.hierNode.shift+=i,e.hierNode.modifier+=i,e.hierNode.prelim+=i,t.hierNode.change+=n;}function ox(t,e){return t.parentNode===e.parentNode?1:2;}function rx(t,e){var i=t.getItemLayout(e);return i&&!isNaN(i.x)&&!isNaN(i.y)&&"none"!==t.getItemVisual(e,"symbol");}function sx(t,e,i){return i.itemModel=e,i.itemStyle=e.getModel("itemStyle").getItemStyle(),i.hoverItemStyle=e.getModel("emphasis.itemStyle").getItemStyle(),i.lineStyle=e.getModel("lineStyle").getLineStyle(),i.labelModel=e.getModel("label"),i.hoverLabelModel=e.getModel("emphasis.label"),!1===t.isExpand&&0!==t.children.length?i.symbolInnerColor=i.itemStyle.fill:i.symbolInnerColor="#fff",i;}function lx(t,e,i,n,a,o){var r=!i,s=t.tree.getNodeByDataIndex(e),l=s.getModel(),u=(o=sx(s,l,o),t.tree.root),h=s.parentNode===u?s:s.parentNode||s,c=t.getItemGraphicEl(h.dataIndex),d=h.getLayout(),f=c?{x:c.position[0],y:c.position[1],rawX:c.__radialOldRawX,rawY:c.__radialOldRawY}:d,p=s.getLayout();r?(i=new Sg(t,e,o)).attr("position",[f.x,f.y]):i.updateData(t,e,o),i.__radialOldRawX=i.__radialRawX,i.__radialOldRawY=i.__radialRawY,i.__radialRawX=p.rawX,i.__radialRawY=p.rawY,n.add(i),t.setItemGraphicEl(e,i),js(i,{position:[p.x,p.y]},a);var g=i.getSymbolPath();if("radial"===o.layout){var m,v,y=u.children[0],x=y.getLayout(),_=y.children.length;if(p.x===x.x&&!0===s.isExpand){var w={};w.x=(y.children[0].getLayout().x+y.children[_-1].getLayout().x)/2,w.y=(y.children[0].getLayout().y+y.children[_-1].getLayout().y)/2,(m=Math.atan2(w.y-x.y,w.x-x.x))<0&&(m=2*Math.PI+m),(v=w.x<x.x)&&(m-=Math.PI);}else(m=Math.atan2(p.y-x.y,p.x-x.x))<0&&(m=2*Math.PI+m),0===s.children.length||0!==s.children.length&&!1===s.isExpand?(v=p.x<x.x)&&(m-=Math.PI):(v=p.x>x.x)||(m-=Math.PI);var b=v?"left":"right",S=o.labelModel.get("rotate"),M=S*(Math.PI/180);g.setStyle({textPosition:o.labelModel.get("position")||b,textRotation:null==S?-m:M,textOrigin:"center",verticalAlign:"middle"});}if(s.parentNode&&s.parentNode!==u){var I=i.__edge;js(I=I||(i.__edge=new qr({shape:hx(o,f,f),style:C({opacity:0,strokeNoScale:!0},o.lineStyle)})),{shape:hx(o,d,p),style:{opacity:1}},a),n.add(I);}}function ux(t,e,i,n,a,o){for(var r,s=t.tree.getNodeByDataIndex(e),l=t.tree.root,u=s.getModel(),h=(o=sx(s,u,o),s.parentNode===l?s:s.parentNode||s);null==(r=h.getLayout());){h=h.parentNode===l?h:h.parentNode||h;}js(i,{position:[r.x+1,r.y+1]},a,function(){n.remove(i),t.setItemGraphicEl(e,null);}),i.fadeOut(null,{keepLabel:!0});var c=i.__edge;c&&js(c,{shape:hx(o,r,r),style:{opacity:0}},a,function(){n.remove(c);});}function hx(t,e,i){var n,a,o,r,s,l,u,h,c=t.orient;if("radial"!==t.layout)return s=e.x,u=e.y,l=i.x,h=i.y,"LR"!==c&&"RL"!==c||(n=s+(l-s)*t.curvature,a=u,o=l+(s-l)*t.curvature,r=h),"TB"!==c&&"BT"!==c||(n=s,a=u+(h-u)*t.curvature,o=l,r=h+(u-h)*t.curvature),{x1:s,y1:u,x2:l,y2:h,cpx1:n,cpy1:a,cpx2:o,cpy2:r};s=e.rawX,u=e.rawY,l=i.rawX,h=i.rawY;var d=ex(s,u),f=ex(s,u+(h-u)*t.curvature),p=ex(l,h+(u-h)*t.curvature),g=ex(l,h);return{x1:d.x,y1:d.y,x2:g.x,y2:g.y,cpx1:f.x,cpy1:f.y,cpx2:p.x,cpy2:p.y};}function cx(t,e){for(var i,n=[t];i=n.pop();){if(e(i),i.isExpand){var a=i.children;if(a.length)for(var o=a.length-1;0<=o;o--){n.push(a[o]);}}}}qy.prototype={constructor:qy,isRemoved:function isRemoved(){return this.dataIndex<0;},eachNode:function eachNode(t,e,i){"function"==typeof t&&(i=e,e=t,t=null),R(t=t||{})&&(t={order:t});var n,a=t.order||"preorder",o=this[t.attr||"children"];"preorder"===a&&(n=e.call(i,this));for(var r=0;!n&&r<o.length;r++){o[r].eachNode(t,e,i);}"postorder"===a&&e.call(i,this);},updateDepthAndHeight:function updateDepthAndHeight(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height);}this.height=e+1;},getNodeById:function getNodeById(t){if(this.getId()===t)return this;for(var e=0,i=this.children,n=i.length;e<n;e++){var a=i[e].getNodeById(t);if(a)return a;}},contains:function contains(t){if(t===this)return!0;for(var e=0,i=this.children,n=i.length;e<n;e++){var a=i[e].contains(t);if(a)return a;}},getAncestors:function getAncestors(t){for(var e=[],i=t?this:this.parentNode;i;){e.push(i),i=i.parentNode;}return e.reverse(),e;},getValue:function getValue(t){var e=this.hostTree.data;return e.get(e.getDimension(t||"value"),this.dataIndex);},setLayout:function setLayout(t,e){0<=this.dataIndex&&this.hostTree.data.setItemLayout(this.dataIndex,t,e);},getLayout:function getLayout(){return this.hostTree.data.getItemLayout(this.dataIndex);},getModel:function getModel(t){if(!(this.dataIndex<0)){var e,i=this.hostTree,n=i.data.getItemModel(this.dataIndex),a=this.getLevelModel();return a||0!==this.children.length&&(0===this.children.length||!1!==this.isExpand)||(e=this.getLeavesModel()),n.getModel(t,(a||e||i.hostModel).getModel(t));}},getLevelModel:function getLevelModel(){return(this.hostTree.levelModels||[])[this.depth];},getLeavesModel:function getLeavesModel(){return this.hostTree.leavesModel;},setVisual:function setVisual(t,e){0<=this.dataIndex&&this.hostTree.data.setItemVisual(this.dataIndex,t,e);},getVisual:function getVisual(t,e){return this.hostTree.data.getItemVisual(this.dataIndex,t,e);},getRawIndex:function getRawIndex(){return this.hostTree.data.getRawIndex(this.dataIndex);},getId:function getId(){return this.hostTree.data.getId(this.dataIndex);},isAncestorOf:function isAncestorOf(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode;}return!1;},isDescendantOf:function isDescendantOf(t){return t!==this&&t.isAncestorOf(this);}},Ky.prototype={constructor:Ky,type:"tree",eachNode:function eachNode(t,e,i){this.root.eachNode(t,e,i);},getNodeByDataIndex:function getNodeByDataIndex(t){var e=this.data.getRawIndex(t);return this._nodes[e];},getNodeByName:function getNodeByName(t){return this.root.getNodeByName(t);},update:function update(){for(var t=this.data,e=this._nodes,i=0,n=e.length;i<n;i++){e[i].dataIndex=-1;}for(i=0,n=t.count();i<n;i++){e[t.getRawIndex(i)].dataIndex=i;}},clearLayouts:function clearLayouts(){this.data.clearItemLayouts();}},Ky.createTree=function(t,e,i){var s=new Ky(e,i.levels,i.leaves),l=[],u=1;!function t(e,i){var n=e.value;u=Math.max(u,k(n)?n.length:1);l.push(e);var a=new qy(e.name,s);i?$y(a,i):s.root=a;s._nodes.push(a);var o=e.children;if(o)for(var r=0;r<o.length;r++){t(o[r],a);}}(t),s.root.updateDepthAndHeight(0);var n=Wf(l,{coordDimensions:["value"],dimensionsCount:u}),a=new Tf(n,e);return a.initData(l),Wy({mainData:a,struct:s,structAttr:"tree"}),s.update(),s;},Wh.extend({type:"series.tree",layoutInfo:null,layoutMode:"box",getInitialData:function getInitialData(t){var e={name:t.name,children:t.data},i=t.leaves||{},n={};n.leaves=i;var a=Ky.createTree(e,this,n),o=0;a.eachNode("preorder",function(t){t.depth>o&&(o=t.depth);});var r=t.expandAndCollapse&&0<=t.initialTreeDepth?t.initialTreeDepth:o;return a.root.eachNode("preorder",function(t){var e=t.hostTree.data.getRawDataItem(t.dataIndex);t.isExpand=e&&null!=e.collapsed?!e.collapsed:t.depth<=r;}),a.data;},getOrient:function getOrient(){var t=this.get("orient");return"horizontal"===t?t="LR":"vertical"===t&&(t="TB"),t;},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},formatTooltip:function formatTooltip(t){for(var e=this.getData().tree,i=e.root.children[0],n=e.getNodeByDataIndex(t),a=n.getValue(),o=n.name;n&&n!==i;){o=n.parentNode.name+"."+o,n=n.parentNode;}return Wl(o+(isNaN(a)||null==a?"":" : "+a));},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderColor:"#c23531",borderWidth:1.5},label:{show:!0,color:"#555"},leaves:{label:{show:!0}},animationEasing:"linear",animationDuration:700,animationDurationUpdate:1e3}}),hf({type:"tree",init:function init(t,e){this._oldTree,this._mainGroup=new Si(),this._controller=new uy(e.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup);},render:function render(n,t,i,e){var a=n.getData(),o=n.layoutInfo,r=this._mainGroup,s=n.get("layout");"radial"===s?r.attr("position",[o.x+o.width/2,o.y+o.height/2]):r.attr("position",[o.x,o.y]),this._updateViewCoordSys(n,o,s),this._updateController(n,t,i);var l=this._data,u={expandAndCollapse:n.get("expandAndCollapse"),layout:s,orient:n.getOrient(),curvature:n.get("lineStyle.curveness"),symbolRotate:n.get("symbolRotate"),symbolOffset:n.get("symbolOffset"),hoverAnimation:n.get("hoverAnimation"),useNameLabel:!0,fadeIn:!0};a.diff(l).add(function(t){rx(a,t)&&lx(a,t,null,r,n,u);}).update(function(t,e){var i=l.getItemGraphicEl(e);rx(a,t)?lx(a,t,i,r,n,u):i&&ux(l,e,i,r,n,u);}).remove(function(t){var e=l.getItemGraphicEl(t);e&&ux(l,t,e,r,n,u);}).execute(),this._nodeScaleRatio=n.get("nodeScaleRatio"),this._updateNodeAndLinkScale(n),!0===u.expandAndCollapse&&a.eachItemGraphicEl(function(t,e){t.off("click").on("click",function(){i.dispatchAction({type:"treeExpandAndCollapse",seriesId:n.id,dataIndex:e});});}),this._data=a;},_updateViewCoordSys:function _updateViewCoordSys(t){var i=t.getData(),n=[];i.each(function(t){var e=i.getItemLayout(t);!e||isNaN(e.x)||isNaN(e.y)||n.push([+e.x,+e.y]);});var e=[],a=[];Io(n,e,a);var o=this._min,r=this._max;a[0]-e[0]==0&&(e[0]=o?o[0]:e[0]-1,a[0]=r?r[0]:a[0]+1),a[1]-e[1]==0&&(e[1]=o?o[1]:e[1]-1,a[1]=r?r[1]:a[1]+1);var s=t.coordinateSystem=new Py();s.zoomLimit=t.get("scaleLimit"),s.setBoundingRect(e[0],e[1],a[0]-e[0],a[1]-e[1]),s.setCenter(t.get("center")),s.setZoom(t.get("zoom")),this.group.attr({position:s.position,scale:s.scale}),this._viewCoordSys=s,this._min=e,this._max=a;},_updateController:function _updateController(a,t,o){var e=this._controller,i=this._controllerHost,r=this.group;e.setPointerChecker(function(t,e,i){var n=r.getBoundingRect();return n.applyTransform(r.transform),n.contain(e,i)&&!wy(t,o,a);}),e.enable(a.get("roam")),i.zoomLimit=a.get("scaleLimit"),i.zoom=a.coordinateSystem.getZoom(),e.off("pan").off("zoom").on("pan",function(t){yy(i,t.dx,t.dy),o.dispatchAction({seriesId:a.id,type:"treeRoam",dx:t.dx,dy:t.dy});},this).on("zoom",function(t){xy(i,t.scale,t.originX,t.originY),o.dispatchAction({seriesId:a.id,type:"treeRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(a);},this);},_updateNodeAndLinkScale:function _updateNodeAndLinkScale(t){var e=t.getData(),i=this._getNodeGlobalScale(t),n=[i,i];e.eachItemGraphicEl(function(t,e){t.attr("scale",n);});},_getNodeGlobalScale:function _getNodeGlobalScale(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=this._nodeScaleRatio,n=e.scale,a=n&&n[0]||1;return((e.getZoom()-1)*i+1)/a;},dispose:function dispose(){this._controller&&this._controller.dispose(),this._controllerHost={};},remove:function remove(){this._mainGroup.removeAll(),this._data=null;}}),tf({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(n,t){t.eachComponent({mainType:"series",subType:"tree",query:n},function(t){var e=n.dataIndex,i=t.getData().tree.getNodeByDataIndex(e);i.isExpand=!i.isExpand;});}),tf({type:"treeRoam",event:"treeRoam",update:"none"},function(i,t){t.eachComponent({mainType:"series",subType:"tree",query:i},function(t){var e=Cy(t.coordinateSystem,i);t.setCenter&&t.setCenter(e.center),t.setZoom&&t.setZoom(e.zoom);});});function dx(t,e,i){if(t&&0<=_(e,t.type)){var n=i.getData().tree.root,a=t.targetNode;if("string"==typeof a&&(a=n.getNodeById(a)),a&&n.contains(a))return{node:a};var o=t.targetNodeId;if(null!=o&&(a=n.getNodeById(o)))return{node:a};}}function fx(t){for(var e=[];t;){(t=t.parentNode)&&e.push(t);}return e.reverse();}function px(t,e){return 0<=_(fx(t),e);}function gx(t,e){for(var i=[];t;){var n=t.dataIndex;i.push({name:t.name,dataIndex:n,value:e.getRawValue(n)}),t=t.parentNode;}return i.reverse(),i;}af(rm("tree","circle")),nf(function(t,e){t.eachSeriesByType("tree",function(t){!function(t,e){var i=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}(t,e);t.layoutInfo=i;var n=t.get("layout"),a=0,o=0,r=null;r="radial"===n?(a=2*Math.PI,o=Math.min(i.height,i.width)/2,tx(function(t,e){return(t.parentNode===e.parentNode?1:2)/t.depth;})):(a=i.width,o=i.height,tx());var s=t.getData().tree.root,l=s.children[0];if(l){!function(t){t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var e,i,n=[t];e=n.pop();){if(i=e.children,e.isExpand&&i.length)for(var a=i.length-1;0<=a;a--){var o=i[a];o.hierNode={defaultAncestor:null,ancestor:o,prelim:0,modifier:0,change:0,shift:0,i:a,thread:null},n.push(o);}}}(s),function(t,e,i){for(var n,a=[t],o=[];n=a.pop();){if(o.push(n),n.isExpand){var r=n.children;if(r.length)for(var s=0;s<r.length;s++){a.push(r[s]);}}}for(;n=o.pop();){e(n,i);}}(l,Jy,r),s.hierNode.modifier=-l.hierNode.prelim,cx(l,Qy);var u=l,h=l,c=l;cx(l,function(t){var e=t.getLayout().x;e<u.getLayout().x&&(u=t),e>h.getLayout().x&&(h=t),t.depth>c.depth&&(c=t);});var d=u===h?1:r(u,h)/2,f=d-u.getLayout().x,p=0,g=0,m=0,v=0;if("radial"===n)p=a/(h.getLayout().x+d+f),g=o/(c.depth-1||1),cx(l,function(t){m=(t.getLayout().x+f)*p,v=(t.depth-1)*g;var e=ex(m,v);t.setLayout({x:e.x,y:e.y,rawX:m,rawY:v},!0);});else{var y=t.getOrient();"RL"===y||"LR"===y?(g=o/(h.getLayout().x+d+f),p=a/(c.depth-1||1),cx(l,function(t){v=(t.getLayout().x+f)*g,m="LR"===y?(t.depth-1)*p:a-(t.depth-1)*p,t.setLayout({x:m,y:v},!0);})):"TB"!==y&&"BT"!==y||(p=a/(h.getLayout().x+d+f),g=o/(c.depth-1||1),cx(l,function(t){m=(t.getLayout().x+f)*p,v="TB"===y?(t.depth-1)*g:o-(t.depth-1)*g,t.setLayout({x:m,y:v},!0);}));}}}(t,e);});}),Wh.extend({type:"series.treemap",layoutMode:"box",dependencies:["grid","polar"],preventUsingHoverLayer:!0,_viewRoot:null,defaultOption:{progressive:0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",ellipsis:!0},upperLabel:{show:!1,position:[0,"50%"],height:20,color:"#fff",ellipsis:!0,verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],color:"#fff",ellipsis:!0,verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function getInitialData(t,e){var i={name:t.name,children:t.data};!function i(t){var n=0;E(t.children,function(t){i(t);var e=t.value;k(e)&&(e=e[0]),n+=e;});var e=t.value;k(e)&&(e=e[0]);null!=e&&!isNaN(e)||(e=n);e<0&&(e=0);k(t.value)?t.value[0]=e:t.value=e;}(i);var n=t.levels||[];n=t.levels=function(t,e){var n,i=e.get("color");if(!i)return;if(E(t=t||[],function(t){var e=new dl(t),i=e.get("color");(e.get("itemStyle.color")||i&&"none"!==i)&&(n=!0);}),!n){(t[0]||(t[0]={})).color=i.slice();}return t;}(n,e);var a={};return a.levels=n,Ky.createTree(i,this,a).data;},optionUpdated:function optionUpdated(){this.resetViewRoot();},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=k(i)?zl(i[0]):zl(i);return Wl(e.getName(t)+": "+n);},getDataParams:function getDataParams(t){var e=Wh.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=gx(i,this),e;},setLayoutInfo:function setLayoutInfo(t){this.layoutInfo=this.layoutInfo||{},L(this.layoutInfo,t);},mapIdToIndex:function mapIdToIndex(t){var e=this._idIndexMap;e||(e=this._idIndexMap=Q(),this._idIndexMapCount=0);var i=e.get(t);return null==i&&e.set(t,i=this._idIndexMapCount++),i;},getViewRoot:function getViewRoot(){return this._viewRoot;},resetViewRoot:function resetViewRoot(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e);}});var mx=5;function vx(t){this.group=new Si(),t.add(this.group);}function yx(t,e,i,n,a,o){var r=[[a?t:t-mx,e],[t+i,e],[t+i,e+n],[a?t:t-mx,e+n]];return o||r.splice(2,0,[t+i+mx,e+n/2]),a||r.push([t,e+n/2]),r;}vx.prototype={constructor:vx,render:function render(t,e,i,n){var a=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),a.get("show")&&i){var r=a.getModel("itemStyle"),s=r.getModel("textStyle"),l={pos:{left:a.get("left"),right:a.get("right"),top:a.get("top"),bottom:a.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:a.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(i,l,s),this._renderContent(t,l,r,s,n),ou(o,l.pos,l.box);}},_prepare:function _prepare(t,e,i){for(var n=t;n;n=n.parentNode){var a=n.getModel().get("name"),o=i.getTextRect(a),r=Math.max(o.width+16,e.emptyItemWidth);e.totalWidth+=r+8,e.renderList.push({node:n,text:a,width:r});}},_renderContent:function _renderContent(t,e,i,n,a){for(var o,r,s=0,l=e.emptyItemWidth,u=t.get("breadcrumb.height"),h=function(t,e,i){var n=e.width,a=e.height,o=xl(t.x,n),r=xl(t.y,a),s=xl(t.x2,n),l=xl(t.y2,a);return(isNaN(o)||isNaN(parseFloat(t.x)))&&(o=0),(isNaN(s)||isNaN(parseFloat(t.x2)))&&(s=n),(isNaN(r)||isNaN(parseFloat(t.y)))&&(r=0),(isNaN(l)||isNaN(parseFloat(t.y2)))&&(l=a),i=Vl(i||0),{width:Math.max(s-o-i[1]-i[3],0),height:Math.max(l-r-i[0]-i[2],0)};}(e.pos,e.box),c=e.totalWidth,d=e.renderList,f=d.length-1;0<=f;f--){var p=d[f],g=p.node,m=p.width,v=p.text;c>h.width&&(c-=m-l,m=l,v=null);var y=new Rr({shape:{points:yx(s,0,m,u,f===d.length-1,0===f)},style:C(i.getItemStyle(),{lineJoin:"bevel",text:v,textFill:n.getTextColor(),textFont:n.getFont()}),z:10,onclick:A(a,g)});this.group.add(y),o=t,r=g,y.eventData={componentType:"series",componentSubType:"treemap",componentIndex:o.componentIndex,seriesIndex:o.componentIndex,seriesName:o.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:r&&r.dataIndex,name:r&&r.name},treePathInfo:r&&gx(r,o)},s+=m+8;}},remove:function remove(){this.group.removeAll();}};function xx(t){var e=Lx(t);return e.stroke=e.fill=e.lineWidth=null,e;}var _x=T,bx=Si,Sx=Hr,Mx=E,Ix=["label"],Ax=["emphasis","label"],Tx=["upperLabel"],Dx=["emphasis","upperLabel"],Cx=10,Lx=Xa([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);function kx(d,r,s,l,u,i,f,t,e,n){if(f){var p=f.getLayout();if(p&&p.isInView){var h=p.width,c=p.height,g=p.borderWidth,m=p.invisible,v=f.getRawIndex(),y=t&&t.getRawIndex(),a=f.viewChildren,x=p.upperHeight,o=a&&a.length,_=f.getModel("itemStyle"),w=f.getModel("emphasis.itemStyle"),b=T("nodeGroup",bx);if(b){if(e.add(b),b.attr("position",[p.x||0,p.y||0]),b.__tmNodeWidth=h,b.__tmNodeHeight=c,p.isAboveViewRoot)return b;var S=T("background",Sx,n,1);if(S&&function(t,n,a){n.dataIndex=f.dataIndex,n.seriesIndex=d.seriesIndex,n.setShape({x:0,y:0,width:h,height:c});var o=f.getVisual("borderColor",!0),r=w.get("borderColor");I(n,function(){var t=xx(_);t.fill=o;var e=Lx(w);if(e.fill=r,a){var i=h-2*g;A(t,e,o,i,x,{x:g,y:0,width:i,height:x});}else t.text=e.text=null;n.setStyle(t),Os(n,e);}),t.add(n);}(b,S,o&&p.upperHeight),!o){var M=T("content",Sx,n,2);M&&function(t,i){i.dataIndex=f.dataIndex,i.seriesIndex=d.seriesIndex;var n=Math.max(h-2*g,0),a=Math.max(c-2*g,0);i.culling=!0,i.setShape({x:g,y:g,width:n,height:a});var o=f.getVisual("color",!0);I(i,function(){var t=xx(_);t.fill=o;var e=Lx(w);A(t,e,o,n,a),i.setStyle(t),Os(i,e);}),t.add(i);}(b,M);}return b;}}}function I(t,e){m?t.invisible||i.push(t):(e(),t.__tmWillVisible||(t.invisible=!1));}function A(t,e,i,n,a,o){var r=f.getModel(),s=W(d.getFormattedLabel(f.dataIndex,"normal",null,null,o?"upperLabel":"label"),r.get("name"));if(!o&&p.isLeafRoot){var l=d.get("drillDownIcon",!0);s=l?l+" "+s:s;}var u=r.getModel(o?Tx:Ix),h=r.getModel(o?Dx:Ax),c=u.getShallow("show");Bs(t,e,u,h,{defaultText:c?s:null,autoColor:i,isRectText:!0}),o&&(t.textRect=D(o)),t.truncate=c&&u.get("ellipsis")?{outerWidth:n,outerHeight:a,minChar:2}:null;}function T(t,e,i,n){var a=null!=y&&s[t][y],o=u[t];return a?(s[t][y]=null,function(t,e,i){(t[v]={}).old="nodeGroup"===i?e.position.slice():L({},e.shape);}(o,a,t)):m||((a=new e({z:function(t,e){var i=t*Cx+e;return(i-1)/i;}(i,n)})).__tmDepth=i,function(t,e,i){var n=t[v]={},a=f.parentNode;if(a&&(!l||"drillDown"===l.direction)){var o=0,r=0,s=u.background[a.getRawIndex()];!l&&s&&s.old&&(o=s.old.width,r=s.old.height),n.old="nodeGroup"===i?[0,r]:{x:o,y:r,width:0,height:0};}n.fadein="nodeGroup"!==i;}(o,0,a.__tmStorageName=t)),r[t][v]=a;}}hf({type:"treemap",init:function init(t,e){this._containerGroup,this._storage={nodeGroup:[],background:[],content:[]},this._oldTree,this._breadcrumb,this._controller,this._state="ready";},render:function render(t,e,i,n){if(!(_(e.findComponents({mainType:"series",subType:"treemap",query:n}),t)<0)){this.seriesModel=t,this.api=i,this.ecModel=e;var a=dx(n,["treemapZoomToNode","treemapRootToNode"],t),o=n&&n.type,r=t.layoutInfo,s=!this._oldTree,l=this._storage,u="treemapRootToNode"===o&&a&&l?{rootNodeGroup:l.nodeGroup[a.node.getRawIndex()],direction:n.direction}:null,h=this._giveContainerGroup(r),c=this._doRender(h,t,u);s||o&&"treemapZoomToNode"!==o&&"treemapRootToNode"!==o?c.renderFinally():this._doAnimation(h,c,t,u),this._resetController(i),this._renderBreadcrumb(t,i,a);}},_giveContainerGroup:function _giveContainerGroup(t){var e=this._containerGroup;return e||(e=this._containerGroup=new bx(),this._initEvents(e),this.group.add(e)),e.attr("position",[t.x,t.y]),e;},_doRender:function _doRender(t,e,i){var n=e.getData().tree,a=this._oldTree,o={nodeGroup:[],background:[],content:[]},r={nodeGroup:[],background:[],content:[]},s=this._storage,l=[],c=A(kx,e,r,s,i,o,l);!function o(r,s,l,u,h){u?Mx(s=r,function(t,e){t.isRemoved()||i(e,e);}):new df(s,r,t,t).add(i).update(i).remove(A(i,null)).execute();function t(t){return t.getId();}function i(t,e){var i=null!=t?r[t]:null,n=null!=e?s[e]:null,a=c(i,n,l,h);a&&o(i&&i.viewChildren||[],n&&n.viewChildren||[],a,u,h+1);}}(n.root?[n.root]:[],a&&a.root?[a.root]:[],t,n===a||!a,0);var u,h,d=(h={nodeGroup:[],background:[],content:[]},(u=s)&&Mx(u,function(t,e){var i=h[e];Mx(t,function(t){t&&(i.push(t),t.__tmWillDelete=1);});}),h);return this._oldTree=n,this._storage=r,{lastsForAnimation:o,willDeleteEls:d,renderFinally:function renderFinally(){Mx(d,function(t){Mx(t,function(t){t.parent&&t.parent.remove(t);});}),Mx(l,function(t){t.invisible=!0,t.dirty();});}};},_doAnimation:function _doAnimation(t,o,e,s){if(e.get("animation")){var l=e.get("animationDurationUpdate"),u=e.get("animationEasing"),h=function(){var o,r=[],s={};return{add:function add(t,e,i,n,a){return R(n)&&(a=n,n=0),!s[t.id]&&(s[t.id]=1,r.push({el:t,target:e,time:i,delay:n,easing:a}),!0);},done:function done(t){return o=t,this;},start:function start(){for(var t=r.length,e=0,i=r.length;e<i;e++){var n=r[e];n.el.animateTo(n.target,n.time,n.delay,n.easing,a);}return this;function a(){--t||(r.length=0,s={},o&&o());}}};}();Mx(o.willDeleteEls,function(t,r){Mx(t,function(t,e){if(!t.invisible){var i,n=t.parent;if(s&&"drillDown"===s.direction)i=n===s.rootNodeGroup?{shape:{x:0,y:0,width:n.__tmNodeWidth,height:n.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var a=0,o=0;n.__tmWillDelete||(a=n.__tmNodeWidth/2,o=n.__tmNodeHeight/2),i="nodeGroup"===r?{position:[a,o],style:{opacity:0}}:{shape:{x:a,y:o,width:0,height:0},style:{opacity:0}};}i&&h.add(t,i,l,u);}});}),Mx(this._storage,function(t,a){Mx(t,function(t,e){var i=o.lastsForAnimation[a][e],n={};i&&("nodeGroup"===a?i.old&&(n.position=t.position.slice(),t.attr("position",i.old)):(i.old&&(n.shape=L({},t.shape),t.setShape(i.old)),i.fadein?(t.setStyle("opacity",0),n.style={opacity:1}):1!==t.style.opacity&&(n.style={opacity:1})),h.add(t,n,l,u));});},this),this._state="animating",h.done(_x(function(){this._state="ready",o.renderFinally();},this)).start();}},_resetController:function _resetController(t){var e=this._controller;e||((e=this._controller=new uy(t.getZr())).enable(this.seriesModel.get("roam")),e.on("pan",_x(this._onPan,this)),e.on("zoom",_x(this._onZoom,this)));var n=new bi(0,0,t.getWidth(),t.getHeight());e.setPointerChecker(function(t,e,i){return n.contain(e,i);});},_clearController:function _clearController(){var t=this._controller;t&&(t.dispose(),t=null);},_onPan:function _onPan(t){if("animating"!==this._state&&(3<Math.abs(t.dx)||3<Math.abs(t.dy))){var e=this.seriesModel.getData().tree.root;if(!e)return;var i=e.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+t.dx,y:i.y+t.dy,width:i.width,height:i.height}});}},_onZoom:function _onZoom(t){var e=t.originX,i=t.originY;if("animating"!==this._state){var n=this.seriesModel.getData().tree.root;if(!n)return;var a=n.getLayout();if(!a)return;var o=new bi(a.x,a.y,a.width,a.height),r=this.seriesModel.layoutInfo;e-=r.x,i-=r.y;var s=Qt();ne(s,s,[-e,-i]),oe(s,s,[t.scale,t.scale]),ne(s,s,[e,i]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}});}},_initEvents:function _initEvents(t){t.on("click",function(t){if("ready"===this._state){var e=this.seriesModel.get("nodeClick",!0);if(e){var i=this.findTarget(t.offsetX,t.offsetY);if(i){var n=i.node;if(n.getLayout().isLeafRoot)this._rootToNode(i);else if("zoomToNode"===e)this._zoomToNode(i);else if("link"===e){var a=n.hostTree.data.getItemModel(n.dataIndex),o=a.get("link",!0),r=a.get("target",!0)||"blank";o&&window.open(o,r);}}}}},this);},_renderBreadcrumb:function _renderBreadcrumb(e,t,i){i=i||(i=null!=e.get("leafDepth",!0)?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2))||{node:e.getData().tree.root},(this._breadcrumb||(this._breadcrumb=new vx(this.group))).render(e,t,i.node,_x(function(t){"animating"!==this._state&&(px(e.getViewRoot(),t)?this._rootToNode({node:t}):this._zoomToNode({node:t}));},this));},remove:function remove(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove();},dispose:function dispose(){this._clearController();},_zoomToNode:function _zoomToNode(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},_rootToNode:function _rootToNode(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},findTarget:function findTarget(a,o){var r;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(t){var e=this._storage.background[t.getRawIndex()];if(e){var i=e.transformCoordToLocal(a,o),n=e.shape;if(!(n.x<=i[0]&&i[0]<=n.x+n.width&&n.y<=i[1]&&i[1]<=n.y+n.height))return!1;r={node:t,offsetX:i[0],offsetY:i[1]};}},this),r;}});for(var Px=function Px(){},Nx=["treemapZoomToNode","treemapRender","treemapMove"],Ox=0;Ox<Nx.length;Ox++){tf({type:Nx[Ox],update:"updateView"},Px);}tf({type:"treemapRootToNode",update:"updateView"},function(a,t){t.eachComponent({mainType:"series",subType:"treemap",query:a},function(t,e){var i=dx(a,["treemapZoomToNode","treemapRootToNode"],t);if(i){var n=t.getViewRoot();n&&(a.direction=px(n,i.node)?"rollUp":"drillDown"),t.resetViewRoot(i.node);}});});var Ex=E,Rx=z,zx=-1,Bx=function Bx(t){var e=t.mappingMethod,i=t.type,n=this.option=D(t);this.type=i,this.mappingMethod=e,this._normalizeData=qx[e];var a=Vx[i];this.applyVisual=a.applyVisual,this.getColorMapper=a.getColorMapper,this._doMap=a._doMap[e],"piecewise"===e?(Gx(n),function(i){var t=i.pieceList;i.hasSpecialVisual=!1,E(t,function(t,e){t.originIndex=e,null!=t.visual&&(i.hasSpecialVisual=!0);});}(n)):"category"===e?n.categories?function(t){var e=t.categories,i=t.visual,n=t.categoryMap={};if(Ex(e,function(t,e){n[t]=e;}),!k(i)){var a=[];z(i)?Ex(i,function(t,e){var i=n[e];a[null!=i?i:zx]=t;}):a[zx]=i,i=jx(t,a);}for(var o=e.length-1;0<=o;o--){null==i[o]&&(delete n[e[o]],e.pop());}}(n):Gx(n,!0):(Y("linear"!==e||n.dataExtent),Gx(n));};Bx.prototype={constructor:Bx,mapValueToVisual:function mapValueToVisual(t){var e=this._normalizeData(t);return this._doMap(e,t);},getNormalizer:function getNormalizer(){return T(this._normalizeData,this);}};var Vx=Bx.visualHandlers={color:{applyVisual:Hx("color"),getColorMapper:function getColorMapper(){var a=this.option;return T("category"===a.mappingMethod?function(t,e){return e||(t=this._normalizeData(t)),Zx.call(this,t);}:function(t,e,i){var n=!!i;return e||(t=this._normalizeData(t)),i=Ve(t,a.parsedVisual,i),n?i:Ue(i,"rgba");},this);},_doMap:{linear:function linear(t){return Ue(Ve(t,this.option.parsedVisual),"rgba");},category:Zx,piecewise:function piecewise(t,e){var i=Yx.call(this,e);return null==i&&(i=Ue(Ve(t,this.option.parsedVisual),"rgba")),i;},fixed:Ux}},colorHue:Fx(function(t,e){return He(t,e);}),colorSaturation:Fx(function(t,e){return He(t,null,e);}),colorLightness:Fx(function(t,e){return He(t,null,null,e);}),colorAlpha:Fx(function(t,e){return Ze(t,e);}),opacity:{applyVisual:Hx("opacity"),_doMap:Xx([0,1])},liftZ:{applyVisual:Hx("liftZ"),_doMap:{linear:Ux,category:Ux,piecewise:Ux,fixed:Ux}},symbol:{applyVisual:function applyVisual(t,e,i){var n=this.mapValueToVisual(t);if(R(n))i("symbol",n);else if(Rx(n))for(var a in n){n.hasOwnProperty(a)&&i(a,n[a]);}},_doMap:{linear:Wx,category:Zx,piecewise:function piecewise(t,e){var i=Yx.call(this,e);return null==i&&(i=Wx.call(this,t)),i;},fixed:Ux}},symbolSize:{applyVisual:Hx("symbolSize"),_doMap:Xx([0,1])}};function Gx(t,e){var i=t.visual,n=[];z(i)?Ex(i,function(t){n.push(t);}):null!=i&&n.push(i);e||1!==n.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(n[1]=n[0]),jx(t,n);}function Fx(n){return{applyVisual:function applyVisual(t,e,i){t=this.mapValueToVisual(t),i("color",n(e("color"),t));},_doMap:Xx([0,1])};}function Wx(t){var e=this.option.visual;return e[Math.round(yl(t,[0,1],[0,e.length-1],!0))]||{};}function Hx(n){return function(t,e,i){i(n,this.mapValueToVisual(t));};}function Zx(t){var e=this.option.visual;return e[this.option.loop&&t!==zx?t%e.length:t];}function Ux(){return this.option.visual[0];}function Xx(n){return{linear:function linear(t){return yl(t,n,this.option.visual,!0);},category:Zx,piecewise:function piecewise(t,e){var i=Yx.call(this,e);return null==i&&(i=yl(t,n,this.option.visual,!0)),i;},fixed:Ux};}function Yx(t){var e=this.option,i=e.pieceList;if(e.hasSpecialVisual){var n=i[Bx.findPieceIndex(t,i)];if(n&&n.visual)return n.visual[this.type];}}function jx(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=N(e,function(t){return Ee(t);})),e;}var qx={linear:function linear(t){return yl(t,this.option.dataExtent,[0,1],!0);},piecewise:function piecewise(t){var e=this.option.pieceList,i=Bx.findPieceIndex(t,e,!0);if(null!=i)return yl(i,[0,e.length-1],[0,1],!0);},category:function category(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?zx:e;},fixed:et};function Kx(t,e,i){return t?e<=i:e<i;}Bx.listVisualTypes=function(){var i=[];return E(Vx,function(t,e){i.push(e);}),i;},Bx.addVisualHandler=function(t,e){Vx[t]=e;},Bx.isValidType=function(t){return Vx.hasOwnProperty(t);},Bx.eachVisual=function(t,e,i){z(t)?E(t,e,i):e.call(i,t);},Bx.mapVisual=function(t,n,a){var o,r=k(t)?[]:z(t)?{}:(o=!0,null);return Bx.eachVisual(t,function(t,e){var i=n.call(a,t,e);o?r=i:r[e]=i;}),r;},Bx.retrieveVisuals=function(i){var n,a={};return i&&Ex(Vx,function(t,e){i.hasOwnProperty(e)&&(a[e]=i[e],n=!0);}),n?a:null;},Bx.prepareVisualTypes=function(t){if(Rx(t)){var i=[];Ex(t,function(t,e){i.push(e);}),t=i;}else{if(!k(t))return[];t=t.slice();}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1;}),t;},Bx.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e;},Bx.findPieceIndex=function(n,t,e){for(var a,o=1/0,i=0,r=t.length;i<r;i++){var s=t[i].value;if(null!=s){if(s===n||"string"==typeof s&&s===n+"")return i;e&&c(s,i);}}for(i=0,r=t.length;i<r;i++){var l=t[i],u=l.interval,h=l.close;if(u){if(u[0]===-1/0){if(Kx(h[1],n,u[1]))return i;}else if(u[1]===1/0){if(Kx(h[0],u[0],n))return i;}else if(Kx(h[0],u[0],n)&&Kx(h[1],n,u[1]))return i;e&&c(u[0],i),e&&c(u[1],i);}}if(e)return n===1/0?t.length-1:n===-1/0?0:a;function c(t,e){var i=Math.abs(t-n);i<o&&(o=i,a=e);}};var $x=k,Jx="itemStyle",Qx={seriesType:"treemap",reset:function reset(t,e,i,n){var a=t.getData().tree,o=a.root,r=t.getModel(Jx);o.isRemoved()||!function n(t,e,a,o,r,s){var l=t.getModel();var i=t.getLayout();if(!i||i.invisible||!i.isInView)return;var u=t.getModel(Jx);var h=a[t.depth];var c=t_(u,e,h,o);var d=u.get("borderColor");var f=u.get("borderColorSaturation");var p;null!=f&&(p=e_(c),g=f,d=null!=(m=p)?He(m,null,null,g):null);var g,m;t.setVisual("borderColor",d);var v=t.viewChildren;if(v&&v.length){var y=n_(t,l,i,u,c,v);E(v,function(t,e){if(t.depth>=r.length||t===r[t.depth]){var i=o_(l,c,t,e,y,s);n(t,i,a,o,r,s);}});}else p=e_(c),t.setVisual("color",p);}(o,{},N(a.levelModels,function(t){return t?t.get(Jx):null;}),r,t.getViewRoot().getAncestors(),t);}};function t_(i,n,a,o){var r=L({},n);return E(["color","colorAlpha","colorSaturation"],function(t){var e=i.get(t,!0);null==e&&a&&(e=a[t]),null==e&&(e=n[t]),null==e&&(e=o.get(t)),null!=e&&(r[t]=e);}),r;}function e_(t){var e=i_(t,"color");if(e){var i=i_(t,"colorAlpha"),n=i_(t,"colorSaturation");return n&&(e=He(e,null,null,n)),i&&(e=Ze(e,i)),e;}}function i_(t,e){var i=t[e];if(null!=i&&"none"!==i)return i;}function n_(t,e,i,n,a,o){if(o&&o.length){var r=a_(e,"color")||null!=a.color&&"none"!==a.color&&(a_(e,"colorAlpha")||a_(e,"colorSaturation"));if(r){var s=e.get("visualMin"),l=e.get("visualMax"),u=i.dataExtent.slice();null!=s&&s<u[0]&&(u[0]=s),null!=l&&l>u[1]&&(u[1]=l);var h=e.get("colorMappingBy"),c={type:r.name,dataExtent:u,visual:r.range};"color"!==c.type||"index"!==h&&"id"!==h?c.mappingMethod="linear":(c.mappingMethod="category",c.loop=!0);var d=new Bx(c);return d.__drColorMappingBy=h,d;}}}function a_(t,e){var i=t.get(e);return $x(i)&&i.length?{name:e,range:i}:null;}function o_(t,e,i,n,a,o){var r=L({},e);if(a){var s=a.type,l="color"===s&&a.__drColorMappingBy,u="index"===l?n:"id"===l?o.mapIdToIndex(i.getId()):i.getValue(t.get("visualDimension"));r[s]=a.mapValueToVisual(u);}return r;}var r_=Math.max,s_=Math.min,l_=W,u_=E,h_=["itemStyle","borderWidth"],c_=["itemStyle","gapWidth"],d_=["upperLabel","show"],f_=["upperLabel","height"],p_={seriesType:"treemap",reset:function reset(t,e,i,n){var a=i.getWidth(),o=i.getHeight(),r=t.option,s=au(t.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()}),l=r.size||[],u=xl(l_(s.width,l[0]),a),h=xl(l_(s.height,l[1]),o),c=n&&n.type,d=dx(n,["treemapZoomToNode","treemapRootToNode"],t),f="treemapRender"===c||"treemapMove"===c?n.rootRect:null,p=t.getViewRoot(),g=fx(p);if("treemapMove"!==c){var m="treemapZoomToNode"===c?function(t,e,i,n,a){var o,r=(e||{}).node,s=[n,a];if(!r||r===i)return s;var l=n*a,u=l*t.option.zoomToNodeRatio;for(;o=r.parentNode;){for(var h=0,c=o.children,d=0,f=c.length;d<f;d++){h+=c[d].getValue();}var p=r.getValue();if(0===p)return s;u*=h/p;var g=o.getModel(),m=g.get(h_),v=Math.max(m,y_(g));u+=4*m*m+(3*m+v)*Math.pow(u,.5),Al<u&&(u=Al),r=o;}u<l&&(u=l);var y=Math.pow(u/l,.5);return[n*y,a*y];}(t,d,p,u,h):f?[f.width,f.height]:[u,h],v=r.sort;v&&"asc"!==v&&"desc"!==v&&(v="desc");var y={squareRatio:r.squareRatio,sort:v,leafDepth:r.leafDepth};p.hostTree.clearLayouts();var x={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(x),function t(e,i,n,a){var o;var r;if(e.isRemoved())return;var s=e.getLayout();o=s.width;r=s.height;var l=e.getModel();var u=l.get(h_);var h=l.get(c_)/2;var c=y_(l);var d=Math.max(u,c);var f=u-h;var p=d-h;var l=e.getModel();e.setLayout({borderWidth:u,upperHeight:d,upperLabelHeight:c},!0);o=r_(o-2*f,0);r=r_(r-f-p,0);var g=o*r;var m=g_(e,l,g,i,n,a);if(!m.length)return;var v={x:f,y:p,width:o,height:r};var y=s_(o,r);var x=1/0;var _=[];_.area=0;for(var w=0,b=m.length;w<b;){var S=m[w];_.push(S),_.area+=S.getLayout().area;var M=m_(_,y,i.squareRatio);x=M<=x?(w++,M):(_.area-=_.pop().getLayout().area,v_(_,y,v,h,!1),y=s_(v.width,v.height),_.length=_.area=0,1/0);}_.length&&v_(_,y,v,h,!0);if(!n){var I=l.get("childrenVisibleMin");null!=I&&g<I&&(n=!0);}for(var w=0,b=m.length;w<b;w++){t(m[w],i,n,a+1);}}(p,y,!1,0);x=p.getLayout();u_(g,function(t,e){var i=(g[e+1]||p).getValue();t.setLayout(L({dataExtent:[i,i],borderWidth:0,upperHeight:0},x));});}var _=t.getData().tree.root;_.setLayout(function(t,e,i){if(e)return{x:e.x,y:e.y};var n={x:0,y:0};if(!i)return n;var a=i.node,o=a.getLayout();if(!o)return n;var r=[o.width/2,o.height/2],s=a;for(;s;){var l=s.getLayout();r[0]+=l.x,r[1]+=l.y,s=s.parentNode;}return{x:t.width/2-r[0],y:t.height/2-r[1]};}(s,f,d),!0),t.setLayoutInfo(s),function e(t,i,n,a,o){var r=t.getLayout();var s=n[o];var l=s&&s===t;if(s&&!l||o===n.length&&t!==a)return;t.setLayout({isInView:!0,invisible:!l&&!i.intersect(r),isAboveViewRoot:l},!0);var u=new bi(i.x-r.x,i.y-r.y,i.width,i.height);u_(t.viewChildren||[],function(t){e(t,u,n,a,o+1);});}(_,new bi(-s.x,-s.y,a,o),g,p,0);}};function g_(t,e,i,n,a,o){var r=t.children||[],s=n.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=n.leafDepth&&n.leafDepth<=o;if(a&&!l)return t.viewChildren=[];!function(t,n){n&&t.sort(function(t,e){var i="asc"===n?t.getValue()-e.getValue():e.getValue()-t.getValue();return 0==i?"asc"===n?t.dataIndex-e.dataIndex:e.dataIndex-t.dataIndex:i;});}(r=M(r,function(t){return!t.isRemoved();}),s);var u=function(t,e,i){for(var n=0,a=0,o=e.length;a<o;a++){n+=e[a].getValue();}var r=t.get("visualDimension");if(e&&e.length){if("value"===r&&i)s=[e[e.length-1].getValue(),e[0].getValue()],"asc"===i&&s.reverse();else{var s=[1/0,-1/0];u_(e,function(t){var e=t.getValue(r);e<s[0]&&(s[0]=e),e>s[1]&&(s[1]=e);});}}else s=[NaN,NaN];return{sum:n,dataExtent:s};}(e,r,s);if(0===u.sum)return t.viewChildren=[];if(u.sum=function(t,e,i,n,a){if(!n)return i;for(var o=t.get("visibleMin"),r=a.length,s=r,l=r-1;0<=l;l--){var u=a["asc"===n?r-l-1:l].getValue();u/i*e<o&&(s=l,i-=u);}return"asc"===n?a.splice(0,r-s):a.splice(s,r-s),i;}(e,i,u.sum,s,r),0===u.sum)return t.viewChildren=[];for(var h=0,c=r.length;h<c;h++){var d=r[h].getValue()/u.sum*i;r[h].setLayout({area:d});}return l&&(r.length&&t.setLayout({isLeafRoot:!0},!0),r.length=0),t.viewChildren=r,t.setLayout({dataExtent:u.dataExtent},!0),r;}function m_(t,e,i){for(var n,a=0,o=1/0,r=0,s=t.length;r<s;r++){(n=t[r].getLayout().area)&&(n<o&&(o=n),a<n&&(a=n));}var l=t.area*t.area,u=e*e*i;return l?r_(u*a/l,l/(u*o)):1/0;}function v_(t,e,i,n,a){var o=e===i.width?0:1,r=1-o,s=["x","y"],l=["width","height"],u=i[s[o]],h=e?t.area/e:0;(a||h>i[l[r]])&&(h=i[l[r]]);for(var c=0,d=t.length;c<d;c++){var f=t[c],p={},g=h?f.getLayout().area/h:0,m=p[l[r]]=r_(h-2*n,0),v=i[s[o]]+i[l[o]]-u,y=c===d-1||v<g?v:g,x=p[l[o]]=r_(y-2*n,0);p[s[r]]=i[s[r]]+s_(n,m/2),p[s[o]]=u+s_(n,x/2),u+=y,f.setLayout(p,!0);}i[s[r]]+=h,i[l[r]]-=h;}function y_(t){return t.get(d_)?t.get(f_):0;}function x_(t){return"_EC_"+t;}af(Qx),nf(p_);function __(t){this._directed=t||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData;}var w_=__.prototype;function b_(t,e){this.id=null==t?"":t,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==e?-1:e;}function S_(t,e,i){this.node1=t,this.node2=e,this.dataIndex=null==i?-1:i;}w_.type="graph",w_.isDirected=function(){return this._directed;},w_.addNode=function(t,e){t=null==t?""+e:""+t;var i=this._nodesMap;if(!i[x_(t)]){var n=new b_(t,e);return(n.hostGraph=this).nodes.push(n),i[x_(t)]=n;}},w_.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e];},w_.getNodeById=function(t){return this._nodesMap[x_(t)];},w_.addEdge=function(t,e,i){var n=this._nodesMap,a=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),b_.isInstance(t)||(t=n[x_(t)]),b_.isInstance(e)||(e=n[x_(e)]),t&&e){var o=t.id+"-"+e.id;if(!a[o]){var r=new S_(t,e,i);return(r.hostGraph=this)._directed&&(t.outEdges.push(r),e.inEdges.push(r)),t.edges.push(r),t!==e&&e.edges.push(r),this.edges.push(r),a[o]=r;}}},w_.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e];},w_.getEdge=function(t,e){b_.isInstance(t)&&(t=t.id),b_.isInstance(e)&&(e=e.id);var i=this._edgesMap;return this._directed?i[t+"-"+e]:i[t+"-"+e]||i[e+"-"+t];},w_.eachNode=function(t,e){for(var i=this.nodes,n=i.length,a=0;a<n;a++){0<=i[a].dataIndex&&t.call(e,i[a],a);}},w_.eachEdge=function(t,e){for(var i=this.edges,n=i.length,a=0;a<n;a++){0<=i[a].dataIndex&&0<=i[a].node1.dataIndex&&0<=i[a].node2.dataIndex&&t.call(e,i[a],a);}},w_.breadthFirstTraverse=function(t,e,i,n){if(b_.isInstance(e)||(e=this._nodesMap[x_(e)]),e){for(var a="out"===i?"outEdges":"in"===i?"inEdges":"edges",o=0;o<this.nodes.length;o++){this.nodes[o].__visited=!1;}if(!t.call(n,e,null))for(var r=[e];r.length;){var s=r.shift(),l=s[a];for(o=0;o<l.length;o++){var u=l[o],h=u.node1===s?u.node2:u.node1;if(!h.__visited){if(t.call(n,h,s))return;r.push(h),h.__visited=!0;}}}}},w_.update=function(){for(var t=this.data,i=this.edgeData,e=this.nodes,n=this.edges,a=0,o=e.length;a<o;a++){e[a].dataIndex=-1;}for(a=0,o=t.count();a<o;a++){e[t.getRawIndex(a)].dataIndex=a;}i.filterSelf(function(t){var e=n[i.getRawIndex(t)];return 0<=e.node1.dataIndex&&0<=e.node2.dataIndex;});for(a=0,o=n.length;a<o;a++){n[a].dataIndex=-1;}for(a=0,o=i.count();a<o;a++){n[i.getRawIndex(a)].dataIndex=a;}},w_.clone=function(){for(var t=new __(this._directed),e=this.nodes,i=this.edges,n=0;n<e.length;n++){t.addNode(e[n].id,e[n].dataIndex);}for(n=0;n<i.length;n++){var a=i[n];t.addEdge(a.node1.id,a.node2.id,a.dataIndex);}return t;},b_.prototype={constructor:b_,degree:function degree(){return this.edges.length;},inDegree:function inDegree(){return this.inEdges.length;},outDegree:function outDegree(){return this.outEdges.length;},getModel:function getModel(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t);}},S_.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t);};function M_(i,n){return{getValue:function getValue(t){var e=this[i][n];return e.get(e.getDimension(t||"value"),this.dataIndex);},setVisual:function setVisual(t,e){0<=this.dataIndex&&this[i][n].setItemVisual(this.dataIndex,t,e);},getVisual:function getVisual(t,e){return this[i][n].getItemVisual(this.dataIndex,t,e);},setLayout:function setLayout(t,e){0<=this.dataIndex&&this[i][n].setItemLayout(this.dataIndex,t,e);},getLayout:function getLayout(){return this[i][n].getItemLayout(this.dataIndex);},getGraphicEl:function getGraphicEl(){return this[i][n].getItemGraphicEl(this.dataIndex);},getRawIndex:function getRawIndex(){return this[i][n].getRawIndex(this.dataIndex);}};}b(b_,M_("hostGraph","data")),b(S_,M_("hostGraph","edgeData")),__.Node=b_,__.Edge=S_,Wa(b_),Wa(S_);function I_(t,e,i,n,a){for(var o=new __(n),r=0;r<t.length;r++){o.addNode(W(t[r].id,t[r].name,r),r);}var s=[],l=[],u=0;for(r=0;r<e.length;r++){var h=e[r],c=h.source,d=h.target;o.addEdge(c,d,u)&&(l.push(h),s.push(W(h.id,c+" > "+d)),u++);}var f,p=i.get("coordinateSystem");if("cartesian2d"===p||"polar"===p)f=Xf(t,i);else{var g=Hu.get(p),m=g&&"view"!==g.type&&g.dimensions||[];_(m,"value")<0&&m.concat(["value"]);var v=Wf(t,{coordDimensions:m});(f=new Tf(v,i)).initData(t);}var y=new Tf(["value"],i);return y.initData(l,s),a&&a(f,y),Wy({mainData:f,struct:o,structAttr:"graph",datas:{node:f,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o;}var A_=uf({type:"series.graph",init:function init(t){A_.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData;},this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeOption:function mergeOption(t){A_.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeDefaultAndTheme:function mergeDefaultAndTheme(t){A_.superApply(this,"mergeDefaultAndTheme",arguments),ba(t,["edgeLabel"],["show"]);},getInitialData:function getInitialData(t,s){var e=t.edges||t.links||[],i=t.data||t.nodes||[],l=this;if(i&&e)return I_(i,e,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t){var e=l._categoriesModels[t.getShallow("category")];return e&&(e.parentModel=t.parentModel,t.parentModel=e),t;});var i=l.getModel("edgeLabel"),n=new dl({label:i.option},i.parentModel,s),a=l.getModel("emphasis.edgeLabel"),o=new dl({emphasis:{label:a.option}},a.parentModel,s);function r(t){return(t=this.parsePath(t))&&"label"===t[0]?n:t&&"emphasis"===t[0]&&"label"===t[1]?o:this.parentModel;}e.wrapMethod("getItemModel",function(t){return t.customizeGetParent(r),t;});}).data;},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},getCategoriesData:function getCategoriesData(){return this._categoriesData;},formatTooltip:function formatTooltip(t,e,i){if("edge"!==i)return A_.superApply(this,"formatTooltip",arguments);var n=this.getData(),a=this.getDataParams(t,i),o=n.graph.getEdgeByIndex(t),r=n.getName(o.node1.dataIndex),s=n.getName(o.node2.dataIndex),l=[];return null!=r&&l.push(r),null!=s&&l.push(s),l=Wl(l.join(" > ")),a.value&&(l+=" : "+Wl(a.value)),l;},_updateCategoriesData:function _updateCategoriesData(){var t=N(this.option.categories||[],function(t){return null!=t.value?t:L({value:0},t);}),e=new Tf(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t,!0);});},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},isAnimationEnabled:function isAnimationEnabled(){return A_.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"));},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle"},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,curveness:0,opacity:.5},emphasis:{label:{show:!0}}}}),T_=Ur.prototype,D_=qr.prototype;function C_(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1);}var L_=ds({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function buildPath(t,e){this[C_(e)?"_buildPathLine":"_buildPathCurve"](t,e);},_buildPathLine:T_.buildPath,_buildPathCurve:D_.buildPath,pointAt:function pointAt(t){return this[C_(this.shape)?"_pointAtLine":"_pointAtCurve"](t);},_pointAtLine:T_.pointAt,_pointAtCurve:D_.pointAt,tangentAt:function tangentAt(t){var e=this.shape,i=C_(e)?[e.x2-e.x1,e.y2-e.y1]:this._tangentAtCurve(t);return mt(i,i);},_tangentAtCurve:D_.tangentAt}),k_=["fromSymbol","toSymbol"];function P_(t){return"_"+t+"Type";}function N_(t,e,i){var n=e.getItemVisual(i,"color"),a=e.getItemVisual(i,t),o=e.getItemVisual(i,t+"Size");if(a&&"none"!==a){k(o)||(o=[o,o]);var r=Jp(a,-o[0]/2,-o[1]/2,o[0],o[1],n);return r.name=t,r;}}function O_(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var i=e[2];i?(t.cpx1=i[0],t.cpy1=i[1]):(t.cpx1=NaN,t.cpy1=NaN);}function E_(t,e,i){Si.call(this),this._createLine(t,e,i);}var R_=E_.prototype;function z_(t){this._ctor=t||E_,this.group=new Si();}R_.beforeUpdate=function(){var t=this.childOfName("fromSymbol"),e=this.childOfName("toSymbol"),i=this.childOfName("label");if(t||e||!i.ignore){for(var n=1,a=this.parent;a;){a.scale&&(n/=a.scale[0]),a=a.parent;}var o=this.childOfName("line");if(this.__dirty||o.__dirty){var r=o.shape.percent,s=o.pointAt(0),l=o.pointAt(r),u=ht([],l,s);if(mt(u,u),t){t.attr("position",s);var h=o.tangentAt(0);t.attr("rotation",Math.PI/2-Math.atan2(h[1],h[0])),t.attr("scale",[n*r,n*r]);}if(e){e.attr("position",l);h=o.tangentAt(1);e.attr("rotation",-Math.PI/2-Math.atan2(h[1],h[0])),e.attr("scale",[n*r,n*r]);}if(!i.ignore){var c,d,f;i.attr("position",l);var p=5*n;if("end"===i.__position)c=[u[0]*p+l[0],u[1]*p+l[1]],d=.8<u[0]?"left":u[0]<-.8?"right":"center",f=.8<u[1]?"top":u[1]<-.8?"bottom":"middle";else if("middle"===i.__position){var g=r/2,m=[(h=o.tangentAt(g))[1],-h[0]],v=o.pointAt(g);0<m[1]&&(m[0]=-m[0],m[1]=-m[1]),c=[v[0]+m[0]*p,v[1]+m[1]*p],d="center",f="bottom";var y=-Math.atan2(h[1],h[0]);l[0]<s[0]&&(y=Math.PI+y),i.attr("rotation",y);}else c=[-u[0]*p+s[0],-u[1]*p+s[1]],d=.8<u[0]?"right":u[0]<-.8?"left":"center",f=.8<u[1]?"bottom":u[1]<-.8?"top":"middle";i.attr({style:{textVerticalAlign:i.__verticalAlign||f,textAlign:i.__textAlign||d},position:c,scale:[n,n]});}}}},R_._createLine=function(i,n,t){var e=i.hostModel,a=function(t){var e=new L_({name:"line",subPixelOptimize:!0});return O_(e.shape,t),e;}(i.getItemLayout(n));a.shape.percent=0,qs(a,{shape:{percent:1}},e,n),this.add(a);var o=new Dr({name:"label",lineLabelOriginalOpacity:1});this.add(o),E(k_,function(t){var e=N_(t,i,n);this.add(e),this[P_(t)]=i.getItemVisual(n,t);},this),this._updateCommonStl(i,n,t);},R_.updateData=function(a,o,t){var e=a.hostModel,i=this.childOfName("line"),n=a.getItemLayout(o),r={shape:{}};O_(r.shape,n),js(i,r,e,o),E(k_,function(t){var e=a.getItemVisual(o,t),i=P_(t);if(this[i]!==e){this.remove(this.childOfName(t));var n=N_(t,a,o);this.add(n);}this[i]=e;},this),this._updateCommonStl(a,o,t);},R_._updateCommonStl=function(t,e,i){var n=t.hostModel,a=this.childOfName("line"),o=i&&i.lineStyle,r=i&&i.hoverLineStyle,s=i&&i.labelModel,l=i&&i.hoverLabelModel;if(!i||t.hasItemOption){var u=t.getItemModel(e);o=u.getModel("lineStyle").getLineStyle(),r=u.getModel("emphasis.lineStyle").getLineStyle(),s=u.getModel("label"),l=u.getModel("emphasis.label");}var h=t.getItemVisual(e,"color"),c=Z(t.getItemVisual(e,"opacity"),o.opacity,1);a.useStyle(C({strokeNoScale:!0,fill:"none",stroke:h,opacity:c},o)),a.hoverStyle=r,E(k_,function(t){var e=this.childOfName(t);e&&(e.setColor(h),e.setStyle({opacity:c}));},this);var d,f,p=s.getShallow("show"),g=l.getShallow("show"),m=this.childOfName("label");if((p||g)&&(d=h||"#000",null==(f=n.getFormattedLabel(e,"normal",t.dataType)))){var v=n.getRawValue(e);f=null==v?t.getName(e):isFinite(v)?_l(v):v;}var y=p?f:null,x=g?H(n.getFormattedLabel(e,"emphasis",t.dataType),f):null,_=m.style;null==y&&null==x||(Gs(m.style,s,{text:y},{autoColor:d}),m.__textAlign=_.textAlign,m.__verticalAlign=_.textVerticalAlign,m.__position=s.get("position")||"middle"),m.hoverStyle=null!=x?{text:x,textFill:l.getTextColor(!0),fontStyle:l.getShallow("fontStyle"),fontWeight:l.getShallow("fontWeight"),fontSize:l.getShallow("fontSize"),fontFamily:l.getShallow("fontFamily")}:{text:null},m.ignore=!p&&!g,Os(this);},R_.highlight=function(){this.trigger("emphasis");},R_.downplay=function(){this.trigger("normal");},R_.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e));},R_.setLinePoints=function(t){var e=this.childOfName("line");O_(e.shape,t),e.dirty();},w(E_,Si);var B_=z_.prototype;function V_(t){var e=t.hostModel;return{lineStyle:e.getModel("lineStyle").getLineStyle(),hoverLineStyle:e.getModel("emphasis.lineStyle").getLineStyle(),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label")};}function G_(t){return isNaN(t[0])||isNaN(t[1]);}function F_(t){return!G_(t[0])&&!G_(t[1]);}function W_(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=t.option.nodeScaleRatio,n=e.scale,a=n&&n[0]||1;return((e.getZoom()-1)*i+1)/a;}function H_(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e;}B_.isPersistent=function(){return!0;},B_.updateData=function(i){var n=this,e=n.group,a=n._lineData;n._lineData=i,a||e.removeAll();var o=V_(i);i.diff(a).add(function(t){!function(t,e,i,n){if(!F_(e.getItemLayout(i)))return;var a=new t._ctor(e,i,n);e.setItemGraphicEl(i,a),t.group.add(a);}(n,i,t,o);}).update(function(t,e){!function(t,e,i,n,a,o){var r=e.getItemGraphicEl(n);if(!F_(i.getItemLayout(a)))return t.group.remove(r);r?r.updateData(i,a,o):r=new t._ctor(i,a,o);i.setItemGraphicEl(a,r),t.group.add(r);}(n,a,i,e,t,o);}).remove(function(t){e.remove(a.getItemGraphicEl(t));}).execute();},B_.updateLayout=function(){var i=this._lineData;i&&i.eachItemGraphicEl(function(t,e){t.updateLayout(i,e);},this);},B_.incrementalPrepareUpdate=function(t){this._seriesScope=V_(t),this._lineData=null,this.group.removeAll();},B_.incrementalUpdate=function(t,e){function i(t){t.isGroup||(t.incremental=t.useHoverLayer=!0);}for(var n=t.start;n<t.end;n++){if(F_(e.getItemLayout(n))){var a=new this._ctor(e,n,this._seriesScope);a.traverse(i),this.group.add(a),e.setItemGraphicEl(n,a);}}},B_.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll();},B_._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles();};var Z_=[],U_=[],X_=[],Y_=fo,j_=_t,q_=Math.abs;function K_(t,e,i){for(var n,a=t[0],o=t[1],r=t[2],s=1/0,l=i*i,u=.1,h=.1;h<=.9;h+=.1){Z_[0]=Y_(a[0],o[0],r[0],h),Z_[1]=Y_(a[1],o[1],r[1],h),(f=q_(j_(Z_,e)-l))<s&&(s=f,n=h);}for(var c=0;c<32;c++){var d=n+u;U_[0]=Y_(a[0],o[0],r[0],n),U_[1]=Y_(a[1],o[1],r[1],n),X_[0]=Y_(a[0],o[0],r[0],d),X_[1]=Y_(a[1],o[1],r[1],d);var f=j_(U_,e)-l;if(q_(f)<.01)break;var p=j_(X_,e)-l;u/=2,f<0?0<=p?n+=u:n-=u:0<=p?n-=u:n+=u;}return n;}function $_(t,l){var u=[],h=mo,c=[[],[],[]],d=[[],[]],f=[];l/=2,t.eachEdge(function(t,e){var i=t.getLayout(),n=t.getVisual("fromSymbol"),a=t.getVisual("toSymbol");i.__original||(i.__original=[rt(i[0]),rt(i[1])],i[2]&&i.__original.push(rt(i[2])));var o=i.__original;if(null!=i[2]){if(ot(c[0],o[0]),ot(c[1],o[2]),ot(c[2],o[1]),n&&"none"!==n){var r=H_(t.node1),s=K_(c,o[0],r*l);h(c[0][0],c[1][0],c[2][0],s,u),c[0][0]=u[3],c[1][0]=u[4],h(c[0][1],c[1][1],c[2][1],s,u),c[0][1]=u[3],c[1][1]=u[4];}if(a&&"none"!==a){r=H_(t.node2),s=K_(c,o[1],r*l);h(c[0][0],c[1][0],c[2][0],s,u),c[1][0]=u[1],c[2][0]=u[2],h(c[0][1],c[1][1],c[2][1],s,u),c[1][1]=u[1],c[2][1]=u[2];}ot(i[0],c[0]),ot(i[1],c[2]),ot(i[2],c[1]);}else{if(ot(d[0],o[0]),ot(d[1],o[1]),ht(f,d[1],d[0]),mt(f,f),n&&"none"!==n){r=H_(t.node1);ut(d[0],d[0],f,r*l);}if(a&&"none"!==a){r=H_(t.node2);ut(d[1],d[1],f,-r*l);}ot(i[0],d[0]),ot(i[1],d[1]);}});}var J_="__focusNodeAdjacency",Q_="__unfocusNodeAdjacency",tw=["itemStyle","opacity"],ew=["lineStyle","opacity"];function iw(t,e){var i=t.getVisual("opacity");return null!=i?i:t.getModel().get(e);}function nw(t,e,i){var n=t.getGraphicEl(),a=iw(t,e);null!=i&&(null==a&&(a=1),a*=i),n.downplay&&n.downplay(),n.traverse(function(t){if(!t.isGroup){var e=t.lineLabelOriginalOpacity;null!=e&&null==i||(e=a),t.setStyle("opacity",e);}});}function aw(t,e){var i=iw(t,e),n=t.getGraphicEl();n.traverse(function(t){t.isGroup||t.setStyle("opacity",i);}),n.highlight&&n.highlight();}hf({type:"graph",init:function init(t,e){var i=new Ng(),n=new z_(),a=this.group;this._controller=new uy(e.getZr()),this._controllerHost={target:a},a.add(i.group),a.add(n.group),this._symbolDraw=i,this._lineDraw=n,this._firstRender=!0;},render:function render(a,t,o){var e=a.coordinateSystem;this._model=a;var i=this._symbolDraw,n=this._lineDraw,r=this.group;if("view"===e.type){var s={position:e.position,scale:e.scale};this._firstRender?r.attr(s):js(r,s,a);}$_(a.getGraph(),W_(a));var l=a.getData();i.updateData(l);var u=a.getEdgeData();n.updateData(u),this._updateNodeAndLinkScale(),this._updateController(a,t,o),clearTimeout(this._layoutTimeout);var h=a.forceLayout,c=a.get("force.layoutAnimation");h&&this._startForceLayoutIteration(h,c),l.eachItemGraphicEl(function(t,e){var i=l.getItemModel(e);t.off("drag").off("dragend");var n=i.get("draggable");n&&t.on("drag",function(){h&&(h.warmUp(),this._layouting||this._startForceLayoutIteration(h,c),h.setFixed(e),l.setItemLayout(e,t.position));},this).on("dragend",function(){h&&h.setUnfixed(e);},this),t.setDraggable(n&&h),t[J_]&&t.off("mouseover",t[J_]),t[Q_]&&t.off("mouseout",t[Q_]),i.get("focusNodeAdjacency")&&(t.on("mouseover",t[J_]=function(){o.dispatchAction({type:"focusNodeAdjacency",seriesId:a.id,dataIndex:t.dataIndex});}),t.on("mouseout",t[Q_]=function(){o.dispatchAction({type:"unfocusNodeAdjacency",seriesId:a.id});}));},this),l.graph.eachEdge(function(t){var e=t.getGraphicEl();e[J_]&&e.off("mouseover",e[J_]),e[Q_]&&e.off("mouseout",e[Q_]),t.getModel().get("focusNodeAdjacency")&&(e.on("mouseover",e[J_]=function(){o.dispatchAction({type:"focusNodeAdjacency",seriesId:a.id,edgeDataIndex:t.dataIndex});}),e.on("mouseout",e[Q_]=function(){o.dispatchAction({type:"unfocusNodeAdjacency",seriesId:a.id});}));});var d="circular"===a.get("layout")&&a.get("circular.rotateLabel"),f=l.getLayout("cx"),p=l.getLayout("cy");l.eachItemGraphicEl(function(t,e){var i=l.getItemModel(e).get("label.rotate")||0,n=t.getSymbolPath();if(d){var a=l.getItemLayout(e),o=Math.atan2(a[1]-p,a[0]-f);o<0&&(o=2*Math.PI+o);var r=a[0]<f;r&&(o-=Math.PI);var s=r?"left":"right";Vs(n,{textRotation:-o,textPosition:s,textOrigin:"center"},{textPosition:s});}else Vs(n,{textRotation:i*=Math.PI/180});}),this._firstRender=!1;},dispose:function dispose(){this._controller&&this._controller.dispose(),this._controllerHost={};},focusNodeAdjacency:function focusNodeAdjacency(t,e,i,n){var a=this._model.getData().graph,o=n.dataIndex,r=n.edgeDataIndex,s=a.getNodeByIndex(o),l=a.getEdgeByIndex(r);(s||l)&&(a.eachNode(function(t){nw(t,tw,.1);}),a.eachEdge(function(t){nw(t,ew,.1);}),s&&(aw(s,tw),E(s.edges,function(t){t.dataIndex<0||(aw(t,ew),aw(t.node1,tw),aw(t.node2,tw));})),l&&(aw(l,ew),aw(l.node1,tw),aw(l.node2,tw)));},unfocusNodeAdjacency:function unfocusNodeAdjacency(t,e,i,n){var a=this._model.getData().graph;a.eachNode(function(t){nw(t,tw);}),a.eachEdge(function(t){nw(t,ew);});},_startForceLayoutIteration:function _startForceLayoutIteration(t,i){var n=this;!function e(){t.step(function(t){n.updateLayout(n._model),(n._layouting=!t)&&(i?n._layoutTimeout=setTimeout(e,16):e());});}();},_updateController:function _updateController(a,t,o){var e=this._controller,i=this._controllerHost,r=this.group;e.setPointerChecker(function(t,e,i){var n=r.getBoundingRect();return n.applyTransform(r.transform),n.contain(e,i)&&!wy(t,o,a);}),"view"===a.coordinateSystem.type?(e.enable(a.get("roam")),i.zoomLimit=a.get("scaleLimit"),i.zoom=a.coordinateSystem.getZoom(),e.off("pan").off("zoom").on("pan",function(t){yy(i,t.dx,t.dy),o.dispatchAction({seriesId:a.id,type:"graphRoam",dx:t.dx,dy:t.dy});}).on("zoom",function(t){xy(i,t.scale,t.originX,t.originY),o.dispatchAction({seriesId:a.id,type:"graphRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(),$_(a.getGraph(),W_(a)),this._lineDraw.updateLayout();},this)):e.disable();},_updateNodeAndLinkScale:function _updateNodeAndLinkScale(){var t=this._model,e=t.getData(),i=W_(t),n=[i,i];e.eachItemGraphicEl(function(t,e){t.attr("scale",n);});},updateLayout:function updateLayout(t){$_(t.getGraph(),W_(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout();},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove();}}),tf({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},function(){}),tf({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},function(){});tf({type:"graphRoam",event:"graphRoam",update:"none"},function(i,t){t.eachComponent({mainType:"series",query:i},function(t){var e=Cy(t.coordinateSystem,i);t.setCenter&&t.setCenter(e.center),t.setZoom&&t.setZoom(e.zoom);});});function ow(t){return t instanceof Array||(t=[t,t]),t;}function rw(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=t.getGraph();i.eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")]);}),sw(i);}}function sw(t){t.eachEdge(function(t){var e=t.getModel().get("lineStyle.curveness")||0,i=rt(t.node1.getLayout()),n=rt(t.node2.getLayout()),a=[i,n];+e&&a.push([(i[0]+n[0])/2-(i[1]-n[1])*e,(i[1]+n[1])/2-(n[0]-i[0])*e]),t.setLayout(a);});}var lw=Math.PI,uw=[];function hw(t,e){var i=t.coordinateSystem;if(!i||"view"===i.type){var n=i.getBoundingRect(),a=t.getData(),o=a.graph,s=n.width/2+n.x,l=n.height/2+n.y,r=Math.min(n.width,n.height)/2,u=a.count();a.setLayout({cx:s,cy:l}),u&&(cw[e](t,i,o,a,r,s,l,u),o.eachEdge(function(t){var e,i=t.getModel().get("lineStyle.curveness")||0,n=rt(t.node1.getLayout()),a=rt(t.node2.getLayout()),o=(n[0]+a[0])/2,r=(n[1]+a[1])/2;+i&&(e=[s*(i*=3)+o*(1-i),l*i+r*(1-i)]),t.setLayout([n,a,e]);}));}}var cw={value:function value(t,e,i,n,a,o,r,s){var l=0,u=n.getSum("value"),h=2*Math.PI/(u||s);i.eachNode(function(t){var e=t.getValue("value"),i=h*(u?e:1)/2;l+=i,t.setLayout([a*Math.cos(l)+o,a*Math.sin(l)+r]),l+=i;});},symbolSize:function symbolSize(t,e,i,n,a,o,r,s){var l=0;uw.length=s;var u=W_(t);i.eachNode(function(t){var e=H_(t);isNaN(e)&&(e=2),e<0&&(e=0),e*=u;var i=Math.asin(e/2/a);isNaN(i)&&(i=lw/2),uw[t.dataIndex]=i,l+=2*i;});var h=(2*lw-l)/s/2,c=0;i.eachNode(function(t){var e=h+uw[t.dataIndex];c+=e,t.setLayout([a*Math.cos(c)+o,a*Math.sin(c)+r]),c+=e;});}},dw=ut;Qd(function(t){var o=t.findComponents({mainType:"legend"});o&&o.length&&t.eachSeriesByType("graph",function(t){var e=t.getCategoriesData(),n=t.getGraph().data,a=e.mapArray(e.getName);n.filterSelf(function(t){var e=n.getItemModel(t).getShallow("category");if(null!=e){"number"==typeof e&&(e=a[e]);for(var i=0;i<o.length;i++){if(!o[i].isSelected(e))return!1;}}return!0;});},this);}),af(rm("graph","circle",null)),af(function(t){var h={};t.eachSeriesByType("graph",function(s){var l=s.getCategoriesData(),a=s.getData(),u={};l.each(function(t){var e=l.getName(t);u["ec-"+e]=t;var i=l.getItemModel(t),n=i.get("itemStyle.color")||s.getColorFromPalette(e,h);l.setItemVisual(t,"color",n);for(var a=["opacity","symbol","symbolSize","symbolKeepAspect"],o=0;o<a.length;o++){var r=i.getShallow(a[o],!0);null!=r&&l.setItemVisual(t,a[o],r);}}),l.count()&&a.each(function(t){var e=a.getItemModel(t).getShallow("category");if(null!=e){"string"==typeof e&&(e=u["ec-"+e]);for(var i=["color","opacity","symbol","symbolSize","symbolKeepAspect"],n=0;n<i.length;n++){null==a.getItemVisual(t,i[n],!0)&&a.setItemVisual(t,i[n],l.getItemVisual(e,i[n]));}}});});}),af(function(t){t.eachSeriesByType("graph",function(t){var s=t.getGraph(),l=t.getEdgeData(),e=ow(t.get("edgeSymbol")),i=ow(t.get("edgeSymbolSize")),u="lineStyle.color".split("."),h="lineStyle.opacity".split(".");l.setVisual("fromSymbol",e&&e[0]),l.setVisual("toSymbol",e&&e[1]),l.setVisual("fromSymbolSize",i&&i[0]),l.setVisual("toSymbolSize",i&&i[1]),l.setVisual("color",t.get(u)),l.setVisual("opacity",t.get(h)),l.each(function(t){var e=l.getItemModel(t),i=s.getEdgeByIndex(t),n=ow(e.getShallow("symbol",!0)),a=ow(e.getShallow("symbolSize",!0)),o=e.get(u),r=e.get(h);switch(o){case"source":o=i.node1.getVisual("color");break;case"target":o=i.node2.getVisual("color");}n[0]&&i.setVisual("fromSymbol",n[0]),n[1]&&i.setVisual("toSymbol",n[1]),a[0]&&i.setVisual("fromSymbolSize",a[0]),a[1]&&i.setVisual("toSymbolSize",a[1]),i.setVisual("color",o),i.setVisual("opacity",r);});});}),nf(function(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),i=t.coordinateSystem;if(i&&"view"!==i.type){var n=t.getData(),a=[];E(i.dimensions,function(t){a=a.concat(n.mapDimension(t,!0));});for(var o=0;o<n.count();o++){for(var r=[],s=!1,l=0;l<a.length;l++){var u=n.get(a[l],o);isNaN(u)||(s=!0),r.push(u);}s?n.setItemLayout(o,i.dataToPoint(r)):n.setItemLayout(o,[NaN,NaN]);}sw(n.graph);}else e&&"none"!==e||rw(t);});}),nf(cd.VISUAL.POST_CHART_LAYOUT,function(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&hw(t,"symbolSize");});}),nf(function(t){t.eachSeriesByType("graph",function(t){if(!(l=t.coordinateSystem)||"view"===l.type)if("force"===t.get("layout")){var c=t.preservedPoints||{},d=t.getGraph(),f=d.data,e=d.edgeData,i=t.getModel("force"),n=i.get("initLayout");t.preservedPoints?f.each(function(t){var e=f.getId(t);f.setItemLayout(t,c[e]||[NaN,NaN]);}):n&&"none"!==n?"circular"===n&&hw(t,"value"):rw(t);var a=f.getDataExtent("value"),o=e.getDataExtent("value"),r=i.get("repulsion"),s=i.get("edgeLength");k(r)||(r=[r,r]),k(s)||(s=[s,s]),s=[s[1],s[0]];var l,u=f.mapArray("value",function(t,e){var i=f.getItemLayout(e),n=yl(t,a,r);return isNaN(n)&&(n=(r[0]+r[1])/2),{w:n,rep:n,fixed:f.getItemModel(e).get("fixed"),p:!i||isNaN(i[0])||isNaN(i[1])?null:i};}),h=e.mapArray("value",function(t,e){var i=d.getEdgeByIndex(e),n=yl(t,o,s);isNaN(n)&&(n=(s[0]+s[1])/2);var a=i.getModel();return{n1:u[i.node1.dataIndex],n2:u[i.node2.dataIndex],d:n,curveness:a.get("lineStyle.curveness")||0,ignoreForceLayout:a.get("ignoreForceLayout")};}),p=(l=t.coordinateSystem).getBoundingRect(),g=function(f,p,t){for(var e=t.rect,i=e.width,n=e.height,g=[e.x+i/2,e.y+n/2],m=null==t.gravity?.1:t.gravity,a=0;a<f.length;a++){var o=f[a];o.p||(o.p=at(i*(Math.random()-.5)+g[0],n*(Math.random()-.5)+g[1])),o.pp=rt(o.p),o.edges=null;}var r=null==t.friction?.6:t.friction,v=r;return{warmUp:function warmUp(){v=.8*r;},setFixed:function setFixed(t){f[t].fixed=!0;},setUnfixed:function setUnfixed(t){f[t].fixed=!1;},step:function step(t){for(var e=[],i=f.length,n=0;n<p.length;n++){var a=p[n];if(!a.ignoreForceLayout){var o=a.n1;ht(e,(u=a.n2).p,o.p);var r=ct(e)-a.d,s=u.w/(o.w+u.w);isNaN(s)&&(s=0),mt(e,e),o.fixed||dw(o.p,o.p,e,s*r*v),u.fixed||dw(u.p,u.p,e,-(1-s)*r*v);}}for(n=0;n<i;n++){(d=f[n]).fixed||(ht(e,g,d.p),dw(d.p,d.p,e,m*v));}for(n=0;n<i;n++){o=f[n];for(var l=n+1;l<i;l++){var u;ht(e,(u=f[l]).p,o.p),0===(r=ct(e))&&(st(e,Math.random()-.5,Math.random()-.5),r=1);var h=(o.rep+u.rep)/r/r;o.fixed||dw(o.pp,o.pp,e,h),u.fixed||dw(u.pp,u.pp,e,-h);}}var c=[];for(n=0;n<i;n++){var d;(d=f[n]).fixed||(ht(c,d.p,d.pp),dw(d.p,d.p,c,v),ot(d.pp,d.p));}v*=.992,t&&t(f,p,v<.01);}};}(u,h,{rect:p,gravity:i.get("gravity"),friction:i.get("friction")}),m=g.step;g.step=function(h){for(var t=0,e=u.length;t<e;t++){u[t].fixed&&ot(u[t].p,d.getNodeByIndex(t).getLayout());}m(function(t,e,i){for(var n=0,a=t.length;n<a;n++){t[n].fixed||d.getNodeByIndex(n).setLayout(t[n].p),c[f.getId(n)]=t[n].p;}for(n=0,a=e.length;n<a;n++){var o=e[n],r=d.getEdgeByIndex(n),s=o.n1.p,l=o.n2.p,u=r.getLayout();(u=u?u.slice():[])[0]=u[0]||[],u[1]=u[1]||[],ot(u[0],s),ot(u[1],l),+o.curveness&&(u[2]=[(s[0]+l[0])/2-(s[1]-l[1])*o.curveness,(s[1]+l[1])/2-(l[0]-s[0])*o.curveness]),r.setLayout(u);}h&&h(i);});},t.forceLayout=g,t.preservedPoints=c,g.step();}else t.forceLayout=null;});}),ef("graphView",{create:function create(t,d){var f=[];return t.eachSeriesByType("graph",function(t){var e=t.get("coordinateSystem");if(!e||"view"===e){var i=t.getData(),n=[],a=[];Io(i.mapArray(function(t){var e=i.getItemModel(t);return[+e.get("x"),+e.get("y")];}),n,a),a[0]-n[0]==0&&(a[0]+=1,n[0]-=1),a[1]-n[1]==0&&(a[1]+=1,n[1]-=1);var o=(a[0]-n[0])/(a[1]-n[1]),r=function(t,e,i){var n=t.getBoxLayoutParams();return n.aspect=i,au(n,{width:e.getWidth(),height:e.getHeight()});}(t,d,o);isNaN(o)&&(n=[r.x,r.y],a=[r.x+r.width,r.y+r.height]);var s=a[0]-n[0],l=a[1]-n[1],u=r.width,h=r.height,c=t.coordinateSystem=new Py();c.zoomLimit=t.get("scaleLimit"),c.setBoundingRect(n[0],n[1],s,l),c.setViewRect(r.x,r.y,u,h),c.setCenter(t.get("center")),c.setZoom(t.get("zoom")),f.push(c);}}),f;}});Wh.extend({type:"series.gauge",getInitialData:function getInitialData(t,e){return yv(this,["value"]);},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,color:"auto"},pointer:{show:!0,length:"80%",width:8},itemStyle:{color:"auto"},title:{show:!0,offsetCenter:[0,"-40%"],color:"#333",fontSize:15},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"auto",fontSize:30}}});var fw=hr.extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function buildPath(t,e){var i=Math.cos,n=Math.sin,a=e.r,o=e.width,r=e.angle,s=e.x-i(r)*o*(a/3<=o?1:2),l=e.y-n(r)*o*(a/3<=o?1:2);r=e.angle-Math.PI/2,t.moveTo(s,l),t.lineTo(e.x+i(r)*o,e.y+n(r)*o),t.lineTo(e.x+i(e.angle)*a,e.y+n(e.angle)*a),t.lineTo(e.x-i(r)*o,e.y-n(r)*o),t.lineTo(s,l);}});function pw(t,e){return e&&("string"==typeof e?t=e.replace("{value}",null!=t?t:""):"function"==typeof e&&(t=e(t))),t;}var gw=2*Math.PI,mw=(ec.extend({type:"gauge",render:function render(t,e,i){this.group.removeAll();var n=t.get("axisLine.lineStyle.color"),a=function(t,e){var i=t.get("center"),n=e.getWidth(),a=e.getHeight(),o=Math.min(n,a);return{cx:xl(i[0],e.getWidth()),cy:xl(i[1],e.getHeight()),r:xl(t.get("radius"),o/2)};}(t,i);this._renderMain(t,e,i,n,a);},dispose:function dispose(){},_renderMain:function _renderMain(t,e,i,n,a){for(var o=this.group,r=t.getModel("axisLine"),s=r.getModel("lineStyle"),l=t.get("clockwise"),u=-t.get("startAngle")/180*Math.PI,h=((g=-t.get("endAngle")/180*Math.PI)-u)%gw,c=u,d=s.get("width"),f=r.get("show"),p=0;f&&p<n.length;p++){var g,m=Math.min(Math.max(n[p][0],0),1),v=new Pr({shape:{startAngle:c,endAngle:g=u+h*m,cx:a.cx,cy:a.cy,clockwise:l,r0:a.r-d,r:a.r},silent:!0});v.setStyle({fill:n[p][1]}),v.setStyle(s.getLineStyle(["color","borderWidth","borderColor"])),o.add(v),c=g;}function y(t){if(t<=0)return n[0][1];for(var e=0;e<n.length;e++){if(n[e][0]>=t&&(0===e?0:n[e-1][0])<t)return n[e][1];}return n[e-1][1];}if(!l){var x=u;u=g,g=x;}this._renderTicks(t,e,i,y,a,u,g,l),this._renderPointer(t,e,i,y,a,u,g,l),this._renderTitle(t,e,i,y,a),this._renderDetail(t,e,i,y,a);},_renderTicks:function _renderTicks(t,e,i,n,a,o,r,s){for(var l=this.group,u=a.cx,h=a.cy,c=a.r,d=+t.get("min"),f=+t.get("max"),p=t.getModel("splitLine"),g=t.getModel("axisTick"),m=t.getModel("axisLabel"),v=t.get("splitNumber"),y=g.get("splitNumber"),x=xl(p.get("length"),c),_=xl(g.get("length"),c),w=o,b=(r-o)/v,S=b/y,M=p.getModel("lineStyle").getLineStyle(),I=g.getModel("lineStyle").getLineStyle(),A=0;A<=v;A++){var T=Math.cos(w),D=Math.sin(w);if(p.get("show")){var C=new Ur({shape:{x1:T*c+u,y1:D*c+h,x2:T*(c-x)+u,y2:D*(c-x)+h},style:M,silent:!0});"auto"===M.stroke&&C.setStyle({stroke:n(A/v)}),l.add(C);}if(m.get("show")){var L=pw(_l(A/v*(f-d)+d),m.get("formatter")),k=m.get("distance"),P=n(A/v);l.add(new Dr({style:Gs({},m,{text:L,x:T*(c-x-k)+u,y:D*(c-x-k)+h,textVerticalAlign:D<-.4?"top":.4<D?"bottom":"middle",textAlign:T<-.4?"left":.4<T?"right":"center"},{autoColor:P}),silent:!0}));}if(g.get("show")&&A!==v){for(var N=0;N<=y;N++){T=Math.cos(w),D=Math.sin(w);var O=new Ur({shape:{x1:T*c+u,y1:D*c+h,x2:T*(c-_)+u,y2:D*(c-_)+h},silent:!0,style:I});"auto"===I.stroke&&O.setStyle({stroke:n((A+N/y)/v)}),l.add(O),w+=S;}w-=S;}else w+=b;}},_renderPointer:function _renderPointer(n,t,e,a,o,i,r,s){var l=this.group,u=this._data;if(n.get("pointer.show")){var h=[+n.get("min"),+n.get("max")],c=[i,r],d=n.getData(),f=d.mapDimension("value");d.diff(u).add(function(t){var e=new fw({shape:{angle:i}});qs(e,{shape:{angle:yl(d.get(f,t),h,c,!0)}},n),l.add(e),d.setItemGraphicEl(t,e);}).update(function(t,e){var i=u.getItemGraphicEl(e);js(i,{shape:{angle:yl(d.get(f,t),h,c,!0)}},n),l.add(i),d.setItemGraphicEl(t,i);}).remove(function(t){var e=u.getItemGraphicEl(t);l.remove(e);}).execute(),d.eachItemGraphicEl(function(t,e){var i=d.getItemModel(e),n=i.getModel("pointer");t.setShape({x:o.cx,y:o.cy,width:xl(n.get("width"),o.r),r:xl(n.get("length"),o.r)}),t.useStyle(i.getModel("itemStyle").getItemStyle()),"auto"===t.style.fill&&t.setStyle("fill",a(yl(d.get(f,e),h,[0,1],!0))),Os(t,i.getModel("emphasis.itemStyle").getItemStyle());}),this._data=d;}else u&&u.eachItemGraphicEl(function(t){l.remove(t);});},_renderTitle:function _renderTitle(t,e,i,n,a){var o=t.getData(),r=o.mapDimension("value"),s=t.getModel("title");if(s.get("show")){var l=s.get("offsetCenter"),u=a.cx+xl(l[0],a.r),h=a.cy+xl(l[1],a.r),c=+t.get("min"),d=+t.get("max"),f=n(yl(t.getData().get(r,0),[c,d],[0,1],!0));this.group.add(new Dr({silent:!0,style:Gs({},s,{x:u,y:h,text:o.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:f,forceRich:!0})}));}},_renderDetail:function _renderDetail(t,e,i,n,a){var o=t.getModel("detail"),r=+t.get("min"),s=+t.get("max");if(o.get("show")){var l=o.get("offsetCenter"),u=a.cx+xl(l[0],a.r),h=a.cy+xl(l[1],a.r),c=xl(o.get("width"),a.r),d=xl(o.get("height"),a.r),f=t.getData(),p=f.get(f.mapDimension("value"),0),g=n(yl(p,[r,s],[0,1],!0));this.group.add(new Dr({silent:!0,style:Gs({},o,{x:u,y:h,text:pw(p,o.get("formatter")),textWidth:isNaN(c)?null:c,textHeight:isNaN(d)?null:d,textAlign:"center",textVerticalAlign:"middle"},{autoColor:g,forceRich:!0})}));}}}),uf({type:"series.funnel",init:function init(t){mw.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData();},this._defaultLabelLine(t);},getInitialData:function getInitialData(t,e){return yv(this,["value"]);},_defaultLabelLine:function _defaultLabelLine(t){ba(t,"labelLine",["show"]);var e=t.labelLine,i=t.emphasis.labelLine;e.show=e.show&&t.label.show,i.show=i.show&&t.emphasis.label.show;},getDataParams:function getDataParams(t){var e=this.getData(),i=mw.superCall(this,"getDataParams",t),n=e.mapDimension("value"),a=e.getSum(n);return i.percent=a?+(e.get(n,t)/a*100).toFixed(2):0,i.$vars.push("percent"),i;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}}}}));function vw(t,e){Si.call(this);var i=new Rr(),n=new zr(),a=new Dr();this.add(i),this.add(n),this.add(a),this.highDownOnUpdate=function(t,e){"emphasis"===e?(n.ignore=n.hoverIgnore,a.ignore=a.hoverIgnore):(n.ignore=n.normalIgnore,a.ignore=a.normalIgnore);},this.updateData(t,e,!0);}var yw=vw.prototype,xw=["itemStyle","opacity"];yw.updateData=function(t,e,i){var n=this.childAt(0),a=t.hostModel,o=t.getItemModel(e),r=t.getItemLayout(e),s=t.getItemModel(e).get(xw);s=null==s?1:s,n.useStyle({}),i?(n.setShape({points:r.points}),n.setStyle({opacity:0}),qs(n,{style:{opacity:s}},a,e)):js(n,{style:{opacity:s},shape:{points:r.points}},a,e);var l=o.getModel("itemStyle"),u=t.getItemVisual(e,"color");n.setStyle(C({lineJoin:"round",fill:u},l.getItemStyle(["opacity"]))),n.hoverStyle=l.getModel("emphasis").getItemStyle(),this._updateLabel(t,e),Os(this);},yw._updateLabel=function(t,e){var i=this.childAt(1),n=this.childAt(2),a=t.hostModel,o=t.getItemModel(e),r=t.getItemLayout(e).label,s=t.getItemVisual(e,"color");js(i,{shape:{points:r.linePoints||r.linePoints}},a,e),js(n,{style:{x:r.x,y:r.y}},a,e),n.attr({rotation:r.rotation,origin:[r.x,r.y],z2:10});var l=o.getModel("label"),u=o.getModel("emphasis.label"),h=o.getModel("labelLine"),c=o.getModel("emphasis.labelLine");s=t.getItemVisual(e,"color");Bs(n.style,n.hoverStyle={},l,u,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:t.getName(e),autoColor:s,useInsideStyle:!!r.inside},{textAlign:r.textAlign,textVerticalAlign:r.verticalAlign}),n.ignore=n.normalIgnore=!l.get("show"),n.hoverIgnore=!u.get("show"),i.ignore=i.normalIgnore=!h.get("show"),i.hoverIgnore=!c.get("show"),i.setStyle({stroke:s}),i.setStyle(h.getModel("lineStyle").getLineStyle()),i.hoverStyle=c.getModel("lineStyle").getLineStyle();},w(vw,Si);ec.extend({type:"funnel",render:function render(t,e,i){var n=t.getData(),a=this._data,o=this.group;n.diff(a).add(function(t){var e=new vw(n,t);n.setItemGraphicEl(t,e),o.add(e);}).update(function(t,e){var i=a.getItemGraphicEl(e);i.updateData(n,t),o.add(i),n.setItemGraphicEl(t,i);}).remove(function(t){var e=a.getItemGraphicEl(t);o.remove(e);}).execute(),this._data=n;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});af(Av("funnel")),nf(function(t,w,e){t.eachSeriesByType("funnel",function(t){var a=t.getData(),o=a.mapDimension("value"),e=t.get("sort"),r=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}(t,w),i=function(t,e){for(var i=t.mapDimension("value"),n=t.mapArray(i,function(t){return t;}),a=[],o="ascending"===e,r=0,s=t.count();r<s;r++){a[r]=r;}return"function"==typeof e?a.sort(e):"none"!==e&&a.sort(function(t,e){return o?n[t]-n[e]:n[e]-n[t];}),a;}(a,e),s=[xl(t.get("minSize"),r.width),xl(t.get("maxSize"),r.width)],n=a.getDataExtent(o),l=t.get("min"),u=t.get("max");null==l&&(l=Math.min(n[0],0)),null==u&&(u=n[1]);function h(t,e){var i,n=yl(a.get(o,t)||0,[l,u],s,!0);switch(c){case"left":i=r.x;break;case"center":i=r.x+(r.width-n)/2;break;case"right":i=r.x+r.width-n;}return[[i,e],[i+n,e]];}var c=t.get("funnelAlign"),d=t.get("gap"),f=(r.height-d*(a.count()-1))/a.count(),p=r.y;"ascending"===e&&(f=-f,d=-d,p+=r.height,i=i.reverse());for(var g=0;g<i.length;g++){var m=i[g],v=i[g+1],y=a.getItemModel(m).get("itemStyle.height");null==y?y=f:(y=xl(y,r.height),"ascending"===e&&(y=-y));var x=h(m,p),_=h(v,p+y);p+=y+d,a.setItemLayout(m,{points:x.concat(_.slice().reverse())});}!function(g){g.each(function(t){var e,i,n,a,o=g.getItemModel(t),r=o.getModel("label").get("position"),s=o.getModel("labelLine"),l=g.getItemLayout(t),u=l.points,h="inner"===r||"inside"===r||"center"===r||"insideLeft"===r||"insideRight"===r;if(h)e="insideLeft"===r?(i=(u[0][0]+u[3][0])/2+5,n=(u[0][1]+u[3][1])/2,"left"):"insideRight"===r?(i=(u[1][0]+u[2][0])/2-5,n=(u[1][1]+u[2][1])/2,"right"):(i=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,n=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4,"center"),a=[[i,n],[i,n]];else{var c,d,f,p=s.get("length");e="left"===r?(c=(u[3][0]+u[0][0])/2,d=(u[3][1]+u[0][1])/2,i=(f=c-p)-5,"right"):"right"===r?(c=(u[1][0]+u[2][0])/2,d=(u[1][1]+u[2][1])/2,i=(f=c+p)+5,"left"):"rightTop"===r?(c=u[1][0],d=u[1][1],i=(f=c+p)+5,"top"):"rightBottom"===r?(c=u[2][0],d=u[2][1],i=(f=c+p)+5,"bottom"):"leftTop"===r?(c=u[0][0],d=u[1][1],i=(f=c-p)-5,"right"):"leftBottom"===r?(c=u[3][0],d=u[2][1],i=(f=c-p)-5,"right"):(c=(u[1][0]+u[2][0])/2,d=(u[1][1]+u[2][1])/2,i=(f=c+p)+5,"left");a=[[c,d],[f,d]],n=d;}l.label={linePoints:a,x:i,y:n,verticalAlign:"middle",textAlign:e,inside:h};});}(a);});}),Qd(kv("funnel"));function _w(t,e,i,n,a){vg.call(this,t,e,i),this.type=n||"value",this.axisIndex=a;}_w.prototype={constructor:_w,model:null,isHorizontal:function isHorizontal(){return"horizontal"!==this.coordinateSystem.getModel().get("layout");}},w(_w,vg);function ww(t,e,i,n,a,o){t=t||0;var r=i[1]-i[0];if(null!=a&&(a=Sw(a,[0,r])),null!=o&&(o=Math.max(o,null!=a?a:0)),"all"===n){var s=Math.abs(e[1]-e[0]);a=o=Sw(s=Sw(s,[0,r]),[a,o]),n=0;}e[0]=Sw(e[0],i),e[1]=Sw(e[1],i);var l=bw(e,n);e[n]+=t;var u=a||0,h=i.slice();l.sign<0?h[0]+=u:h[1]-=u,e[n]=Sw(e[n],h);var c=bw(e,n);return null!=a&&(c.sign!==l.sign||c.span<a)&&(e[1-n]=e[n]+l.sign*a),c=bw(e,n),null!=o&&c.span>o&&(e[1-n]=e[n]+c.sign*o),e;}function bw(t,e){var i=t[e]-t[1-e];return{span:Math.abs(i),sign:0<i?-1:i<0?1:e?-1:1};}function Sw(t,e){return Math.min(null!=e[1]?e[1]:1/0,Math.max(null!=e[0]?e[0]:-1/0,t));}var Mw=E,Iw=Math.min,Aw=Math.max,Tw=Math.floor,Dw=Math.ceil,Cw=_l,Lw=Math.PI;function kw(t,e,i){this._axesMap=Q(),this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,e,i);}function Pw(t,e){return Iw(Aw(t,e[0]),e[1]);}kw.prototype={type:"parallel",constructor:kw,_init:function _init(t,r,e){var i=t.dimensions,s=t.parallelAxisIndex;Mw(i,function(t,e){var i=s[e],n=r.getComponent("parallelAxis",i),a=this._axesMap.set(t,new _w(t,Bp(n),[0,0],n.get("type"),i)),o="category"===a.type;a.onBand=o&&n.get("boundaryGap"),a.inverse=n.get("inverse"),(n.axis=a).model=n,a.coordinateSystem=n.coordinateSystem=this;},this);},update:function update(t,e){this._updateAxesFromSeries(this._model,t);},containPoint:function containPoint(t){var e=this._makeLayoutInfo(),i=e.axisBase,n=e.layoutBase,a=e.pixelDimIndex,o=t[1-a],r=t[a];return i<=o&&o<=i+e.axisLength&&n<=r&&r<=n+e.layoutLength;},getModel:function getModel(){return this._model;},_updateAxesFromSeries:function _updateAxesFromSeries(e,n){n.eachSeries(function(t){if(e.contains(t,n)){var i=t.getData();Mw(this.dimensions,function(t){var e=this._axesMap.get(t);e.scale.unionExtentFromData(i,i.mapDimension(t)),zp(e.scale,e.model);},this);}},this);},resize:function resize(t,e){this._rect=au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes();},getRect:function getRect(){return this._rect;},_makeLayoutInfo:function _makeLayoutInfo(){var t,e=this._model,i=this._rect,n=["x","y"],a=["width","height"],o=e.get("layout"),r="horizontal"===o?0:1,s=i[a[r]],l=[0,s],u=this.dimensions.length,h=Pw(e.get("axisExpandWidth"),l),c=Pw(e.get("axisExpandCount")||0,[0,u]),d=e.get("axisExpandable")&&3<u&&c<u&&1<c&&0<h&&0<s,f=e.get("axisExpandWindow");f?(t=Pw(f[1]-f[0],l),f[1]=f[0]+t):(t=Pw(h*(c-1),l),(f=[h*(e.get("axisExpandCenter")||Tw(u/2))-t/2])[1]=f[0]+t);var p=(s-t)/(u-c);p<3&&(p=0);var g=[Tw(Cw(f[0]/h,1))+1,Dw(Cw(f[1]/h,1))-1],m=p/h*f[0];return{layout:o,pixelDimIndex:r,layoutBase:i[n[r]],layoutLength:s,axisBase:i[n[1-r]],axisLength:i[a[1-r]],axisExpandable:d,axisExpandWidth:h,axisCollapseWidth:p,axisExpandWindow:f,axisCount:u,winInnerIndices:g,axisExpandWindow0Pos:m};},_layoutAxes:function _layoutAxes(){var l=this._rect,t=this._axesMap,e=this.dimensions,u=this._makeLayoutInfo(),h=u.layout;t.each(function(t){var e=[0,u.axisLength],i=t.inverse?1:0;t.setExtent(e[i],e[1-i]);}),Mw(e,function(t,e){var i=(u.axisExpandable?function(t,e){var i,n,a=e.layoutLength,o=e.axisExpandWidth,r=e.axisCount,s=e.axisCollapseWidth,l=e.winInnerIndices,u=s,h=!1;t<l[0]?(i=t*s,n=s):t<=l[1]?(i=e.axisExpandWindow0Pos+t*o-e.axisExpandWindow[0],u=o,h=!0):(i=a-(r-1-t)*s,n=s);return{position:i,axisNameAvailableWidth:u,axisLabelShow:h,nameTruncateMaxWidth:n};}:function(t,e){var i=e.layoutLength/(e.axisCount-1);return{position:i*t,axisNameAvailableWidth:i,axisLabelShow:!0};})(e,u),n={horizontal:{x:i.position,y:u.axisLength},vertical:{x:0,y:i.position}},a={horizontal:Lw/2,vertical:0},o=[n[h].x+l.x,n[h].y+l.y],r=a[h],s=Qt();ae(s,s,r),ne(s,s,o),this._axesLayout[t]={position:o,rotation:r,transform:s,axisNameAvailableWidth:i.axisNameAvailableWidth,axisLabelShow:i.axisLabelShow,nameTruncateMaxWidth:i.nameTruncateMaxWidth,tickDirection:1,labelDirection:1};},this);},getAxis:function getAxis(t){return this._axesMap.get(t);},dataToPoint:function dataToPoint(t,e){return this.axisCoordToPoint(this._axesMap.get(e).dataToCoord(t),e);},eachActiveState:function eachActiveState(e,t,i,n){null==i&&(i=0),null==n&&(n=e.count());var a=this._axesMap,o=this.dimensions,r=[],s=[];E(o,function(t){r.push(e.mapDimension(t)),s.push(a.get(t).model);});for(var l=this.hasAxisBrushed(),u=i;u<n;u++){var h;if(l){h="active";for(var c=e.getValues(r,u),d=0,f=o.length;d<f;d++){if("inactive"===s[d].getActiveState(c[d])){h="inactive";break;}}}else h="normal";t(h,u);}},hasAxisBrushed:function hasAxisBrushed(){for(var t=this.dimensions,e=this._axesMap,i=!1,n=0,a=t.length;n<a;n++){"normal"!==e.get(t[n]).model.getActiveState()&&(i=!0);}return i;},axisCoordToPoint:function axisCoordToPoint(t,e){return $s([t,0],this._axesLayout[e].transform);},getAxisLayout:function getAxisLayout(t){return D(this._axesLayout[t]);},getSlidedAxisExpandWindow:function getSlidedAxisExpandWindow(t){var e=this._makeLayoutInfo(),i=e.pixelDimIndex,n=e.axisExpandWindow.slice(),a=n[1]-n[0],o=[0,e.axisExpandWidth*(e.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:n};var r,s=t[i]-e.layoutBase-e.axisExpandWindow0Pos,l="slide",u=e.axisCollapseWidth,h=this._model.get("axisExpandSlideTriggerArea"),c=null!=h[0];if(u)c&&u&&s<a*h[0]?(l="jump",r=s-a*h[2]):c&&u&&s>a*(1-h[0])?(l="jump",r=s-a*(1-h[2])):0<=(r=s-a*h[1])&&(r=s-a*(1-h[1]))<=0&&(r=0),(r*=e.axisExpandWidth/u)?ww(r,n,o,"all"):l="none";else{a=n[1]-n[0];(n=[Aw(0,o[1]*s/a-a/2)])[1]=Iw(o[1],n[0]+a),n[0]=n[1]-a;}return{axisExpandWindow:n,behavior:l};}},Hu.register("parallel",{create:function create(n,a){var o=[];return n.eachComponent("parallel",function(t,e){var i=new kw(t,n,a);i.name="parallel_"+e,i.resize(t,a),(t.coordinateSystem=i).model=t,o.push(i);}),n.eachSeries(function(t){if("parallel"===t.get("coordinateSystem")){var e=n.queryComponents({mainType:"parallel",index:t.get("parallelIndex"),id:t.get("parallelId")})[0];t.coordinateSystem=e.coordinateSystem;}}),o;}});var Nw=fu.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function getAreaSelectStyle(){return Xa([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"));},setActiveIntervals:function setActiveIntervals(t){var e=this.activeIntervals=D(t);if(e)for(var i=e.length-1;0<=i;i--){wl(e[i]);}},getActiveState:function getActiveState(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t||isNaN(t))return"inactive";if(1===e.length){var i=e[0];if(i[0]<=t&&t<=i[1])return"active";}else for(var n=0,a=e.length;n<a;n++){if(e[n][0]<=t&&t<=e[n][1])return"active";}return"inactive";}});m(Nw.prototype,Hp),mm("parallel",Nw,function(t,e){return e.type||(e.data?"category":"value");},{type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10}),fu.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},init:function init(){fu.prototype.init.apply(this,arguments),this.mergeOption({});},mergeOption:function mergeOption(t){var e=this.option;t&&m(e,t,!0),this._initDimensions();},contains:function contains(t,e){var i=t.get("parallelIndex");return null!=i&&e.getComponent("parallel",i)===this;},setAxisExpand:function setAxisExpand(e){E(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(t){e.hasOwnProperty(t)&&(this.option[t]=e[t]);},this);},_initDimensions:function _initDimensions(){var e=this.dimensions=[],i=this.parallelAxisIndex=[];E(M(this.dependentModels.parallelAxis,function(t){return(t.get("parallelIndex")||0)===this.componentIndex;},this),function(t){e.push("dim"+t.get("dim")),i.push(t.componentIndex);});}});tf({type:"axisAreaSelect",event:"axisAreaSelected"},function(e,t){t.eachComponent({mainType:"parallelAxis",query:e},function(t){t.axis.model.setActiveIntervals(e.intervals);});}),tf("parallelAxisExpand",function(e,t){t.eachComponent({mainType:"parallel",query:e},function(t){t.setAxisExpand(e);});});var Ow=A,Ew=E,Rw=N,zw=Math.min,Bw=Math.max,Vw=Math.pow,Gw=1e4,Fw=6,Ww=6,Hw="globalPan",Zw={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},Uw={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},Xw={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},Yw=0;function jw(t){Ct.call(this),this._zr=t,this.group=new Si(),this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._lastMouseMovePoint={},this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,this._uid="brushController_"+Yw++,this._handlers={},Ew(_b,function(t,e){this._handlers[e]=T(t,this);},this);}function qw(t,e){var i=bb[e.brushType].createCover(t,e);return i.__brushOption=e,Jw(i,e),t.group.add(i),i;}function Kw(t,e){var i=tb(e);return i.endCreating&&(i.endCreating(t,e),Jw(e,e.__brushOption)),e;}function $w(t,e){var i=e.__brushOption;tb(e).updateCoverShape(t,e,i.range,i);}function Jw(t,e){var i=e.z;null==i&&(i=Gw),t.traverse(function(t){t.z=i,t.z2=i;});}function Qw(t,e){tb(e).updateCommon(t,e),$w(t,e);}function tb(t){return bb[t.__brushOption.brushType];}function eb(t,e,i){var n,a=t._panels;if(!a)return!0;var o=t._transform;return Ew(a,function(t){t.isTargetByCursor(e,i,o)&&(n=t);}),n;}function ib(t,e){var i=t._panels;if(!i)return!0;var n=e.__brushOption.panelId;return null==n||i[n];}function nb(e){var t=e._covers,i=t.length;return Ew(t,function(t){e.group.remove(t);},e),t.length=0,!!i;}function ab(t,e){var i=Rw(t._covers,function(t){var e=t.__brushOption,i=D(e.range);return{brushType:e.brushType,panelId:e.panelId,range:i};});t.trigger("brush",i,{isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick});}function ob(t){var e=t.length-1;return e<0&&(e=0),[t[0],t[e]];}function rb(e,i,t,n){var a=new Si();return a.add(new Hr({name:"main",style:hb(t),silent:!0,draggable:!0,cursor:"move",drift:Ow(e,i,a,"nswe"),ondragend:Ow(ab,i,{isEnd:!0})})),Ew(n,function(t){a.add(new Hr({name:t,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:Ow(e,i,a,t),ondragend:Ow(ab,i,{isEnd:!0})}));}),a;}function sb(t,e,i,n){var a=n.brushStyle.lineWidth||0,o=Bw(a,Ww),r=i[0][0],s=i[1][0],l=r-a/2,u=s-a/2,h=i[0][1],c=i[1][1],d=h-o+a/2,f=c-o+a/2,p=h-r,g=c-s,m=p+a,v=g+a;ub(t,e,"main",r,s,p,g),n.transformable&&(ub(t,e,"w",l,u,o,v),ub(t,e,"e",d,u,o,v),ub(t,e,"n",l,u,m,o),ub(t,e,"s",l,f,m,o),ub(t,e,"nw",l,u,o,o),ub(t,e,"ne",d,u,o,o),ub(t,e,"sw",l,f,o,o),ub(t,e,"se",d,f,o,o));}function lb(n,a){var t=a.__brushOption,o=t.transformable,e=a.childAt(0);e.useStyle(hb(t)),e.attr({silent:!o,cursor:o?"move":"default"}),Ew(["w","e","n","s","se","sw","ne","nw"],function(t){var e=a.childOfName(t),i=function t(e,i){{if(1<i.length){i=i.split("");var n=[t(e,i[0]),t(e,i[1])];return"e"!==n[0]&&"w"!==n[0]||n.reverse(),n.join("");}var a={w:"left",e:"right",n:"top",s:"bottom"},o={left:"w",right:"e",top:"n",bottom:"s"},n=Js(a[i],Ks(e.group));return o[n];}}(n,t);e&&e.attr({silent:!o,invisible:!o,cursor:o?Uw[i]+"-resize":null});});}function ub(t,e,i,n,a,o,r){var s=e.childOfName(i);s&&s.setShape(function(t){var e=zw(t[0][0],t[1][0]),i=zw(t[0][1],t[1][1]),n=Bw(t[0][0],t[1][0]),a=Bw(t[0][1],t[1][1]);return{x:e,y:i,width:n-e,height:a-i};}(gb(t,e,[[n,a],[n+o,a+r]])));}function hb(t){return C({strokeNoScale:!0},t.brushStyle);}function cb(t,e,i,n){var a=[zw(t,i),zw(e,n)],o=[Bw(t,i),Bw(e,n)];return[[a[0],o[0]],[a[1],o[1]]];}function db(t,e,i,n,a,o,r,s){var l=n.__brushOption,u=t(l.range),h=pb(i,o,r);Ew(a.split(""),function(t){var e=Zw[t];u[e[0]][e[1]]+=h[e[0]];}),l.range=e(cb(u[0][0],u[1][0],u[0][1],u[1][1])),Qw(i,n),ab(i,{isEnd:!1});}function fb(t,e,i,n,a){var o=e.__brushOption.range,r=pb(t,i,n);Ew(o,function(t){t[0]+=r[0],t[1]+=r[1];}),Qw(t,e),ab(t,{isEnd:!1});}function pb(t,e,i){var n=t.group,a=n.transformCoordToLocal(e,i),o=n.transformCoordToLocal(0,0);return[a[0]-o[0],a[1]-o[1]];}function gb(t,e,i){var n=ib(t,e);return n&&!0!==n?n.clipPath(i,t._transform):D(i);}function mb(t){var e=t.event;e.preventDefault&&e.preventDefault();}function vb(t,e,i){return t.childOfName("main").contain(e,i);}function yb(t,e,i,n){var a,o=t._creatingCover,r=t._creatingPanel,s=t._brushOption;if(t._track.push(i.slice()),function(t){var e=t._track;if(!e.length)return!1;var i=e[e.length-1],n=e[0],a=i[0]-n[0],o=i[1]-n[1],r=Vw(a*a+o*o,.5);return Fw<r;}(t)||o){if(r&&!o){"single"===s.brushMode&&nb(t);var l=D(s);l.brushType=xb(l.brushType,r),l.panelId=!0===r?null:r.panelId,o=t._creatingCover=qw(t,l),t._covers.push(o);}if(o){var u=bb[xb(t._brushType,r)];o.__brushOption.range=u.getCreatingRange(gb(t,o,t._track)),n&&(Kw(t,o),u.updateCommon(t,o)),$w(t,o),a={isEnd:n};}}else n&&"single"===s.brushMode&&s.removeOnClick&&eb(t,e,i)&&nb(t)&&(a={isEnd:n,removeOnClick:!0});return a;}function xb(t,e){return"auto"===t?e.defaultBrushType:t;}jw.prototype={constructor:jw,enableBrush:function enableBrush(t){return this._brushType&&function(t){var i=t._zr;(function(t,e,i){var n=ly(t);n[e]===i&&(n[e]=null);})(i,Hw,t._uid),Ew(t._handlers,function(t,e){i.off(e,t);}),t._brushType=t._brushOption=null;}(this),t.brushType&&function(t,e){var i=t._zr;t._enableGlobalPan||function(t,e,i){ly(t)[e]=i;}(i,Hw,t._uid);Ew(t._handlers,function(t,e){i.on(e,t);}),t._brushType=e.brushType,t._brushOption=m(D(Xw),e,!0);}(this,t),this;},setPanels:function setPanels(t){if(t&&t.length){var e=this._panels={};E(t,function(t){e[t.panelId]=D(t);});}else this._panels=null;return this;},mount:function mount(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({position:t.position||[0,0],rotation:t.rotation||0,scale:t.scale||[1,1]}),this._transform=e.getLocalTransform(),this;},eachCover:function eachCover(t,e){Ew(this._covers,t,e);},updateCovers:function updateCovers(a){a=N(a,function(t){return m(D(Xw),t,!0);});var i="\0-brush-index-",o=this._covers,r=this._covers=[],s=this,l=this._creatingCover;return new df(o,a,function(t,e){return n(t.__brushOption,e);},n).add(t).update(t).remove(function(t){o[t]!==l&&s.group.remove(o[t]);}).execute(),this;function n(t,e){return(null!=t.id?t.id:i+e)+"-"+t.brushType;}function t(t,e){var i=a[t];if(null!=e&&o[e]===l)r[t]=o[e];else{var n=r[t]=null!=e?(o[e].__brushOption=i,o[e]):Kw(s,qw(s,i));Qw(s,n);}}},unmount:function unmount(){return this.enableBrush(!1),nb(this),this._zr.remove(this.group),this;},dispose:function dispose(){this.unmount(),this.off();}},b(jw,Ct);var _b={mousedown:function mousedown(t){if(this._dragging)wb(this,t);else if(!t.target||!t.target.draggable){mb(t);var e=this.group.transformCoordToLocal(t.offsetX,t.offsetY);this._creatingCover=null,(this._creatingPanel=eb(this,t,e))&&(this._dragging=!0,this._track=[e.slice()]);}},mousemove:function mousemove(t){var e=this._lastMouseMovePoint;e.x=t.offsetX,e.y=t.offsetY;var i=this.group.transformCoordToLocal(e.x,e.y);if(function(t,e,i){if(t._brushType){var n=t._zr,a=t._covers,o=eb(t,e,i);if(!t._dragging)for(var r=0;r<a.length;r++){var s=a[r].__brushOption;if(o&&(!0===o||s.panelId===o.panelId)&&bb[s.brushType].contain(a[r],i[0],i[1]))return;}o&&n.setCursorStyle("crosshair");}}(this,t,i),this._dragging){mb(t);var n=yb(this,t,i,!1);n&&ab(this,n);}},mouseup:function mouseup(t){wb(this,t);},globalout:function globalout(t){wb(this,t,!0);}};function wb(t,e,i){if(t._dragging){i||mb(e);var n=e.offsetX,a=e.offsetY,o=t._lastMouseMovePoint;i&&(n=o.x,a=o.y);var r=t.group.transformCoordToLocal(n,a),s=yb(t,e,r,!0);t._dragging=!1,t._track=[],t._creatingCover=null,s&&ab(t,s);}}var bb={lineX:Sb(0),lineY:Sb(1),rect:{createCover:function createCover(t,e){return rb(Ow(db,function(t){return t;},function(t){return t;}),t,e,["w","e","n","s","se","sw","ne","nw"]);},getCreatingRange:function getCreatingRange(t){var e=ob(t);return cb(e[1][0],e[1][1],e[0][0],e[0][1]);},updateCoverShape:function updateCoverShape(t,e,i,n){sb(t,e,i,n);},updateCommon:lb,contain:vb},polygon:{createCover:function createCover(t,e){var i=new Si();return i.add(new zr({name:"main",style:hb(e),silent:!0})),i;},getCreatingRange:function getCreatingRange(t){return t;},endCreating:function endCreating(t,e){e.remove(e.childAt(0)),e.add(new Rr({name:"main",draggable:!0,drift:Ow(fb,t,e),ondragend:Ow(ab,t,{isEnd:!0})}));},updateCoverShape:function updateCoverShape(t,e,i,n){e.childAt(0).setShape({points:gb(t,e,i)});},updateCommon:lb,contain:vb}};function Sb(l){return{createCover:function createCover(t,e){return rb(Ow(db,function(t){var e=[t,[0,100]];return l&&e.reverse(),e;},function(t){return t[l];}),t,e,[["w","e"],["n","s"]][l]);},getCreatingRange:function getCreatingRange(t){var e=ob(t);return[zw(e[0][l],e[1][l]),Bw(e[0][l],e[1][l])];},updateCoverShape:function updateCoverShape(t,e,i,n){var a,o=ib(t,e);if(!0!==o&&o.getLinearBrushOtherExtent)a=o.getLinearBrushOtherExtent(l,t._transform);else{var r=t._zr;a=[0,[r.getWidth(),r.getHeight()][1-l]];}var s=[i,a];l&&s.reverse(),sb(t,e,s,n);},updateCommon:lb,contain:vb};}function Mb(i){return i=Tb(i),function(t,e){return tl(t,i);};}function Ib(a,o){return a=Tb(a),function(t){var e=null!=o?o:t,i=e?a.width:a.height,n=e?a.x:a.y;return[n,n+(i||0)];};}function Ab(n,a,o){return n=Tb(n),function(t,e,i){return n.contain(e[0],e[1])&&!wy(t,a,o);};}function Tb(t){return bi.create(t);}var Db=["axisLine","axisTickLabel","axisName"],Cb=lf({type:"parallelAxis",init:function init(t,e){Cb.superApply(this,"init",arguments),(this._brushController=new jw(e.getZr())).on("brush",T(this._onBrush,this));},render:function render(t,e,i,n){if(!function(t,e,i){return i&&"axisAreaSelect"===i.type&&e.findComponents({mainType:"parallelAxis",query:i})[0]===t;}(t,e,n)){this.axisModel=t,this.api=i,this.group.removeAll();var a=this._axisGroup;if(this._axisGroup=new Si(),this.group.add(this._axisGroup),t.get("show")){var o=function(t,e){return e.getComponent("parallel",t.get("parallelIndex"));}(t,e),r=o.coordinateSystem,s=t.getAreaSelectStyle(),l=s.width,u=t.axis.dim,h=L({strokeContainThreshold:l},r.getAxisLayout(u)),c=new Cm(t,h);E(Db,c.add,c),this._axisGroup.add(c.getGroup()),this._refreshBrushController(h,s,t,o,l,i);var d=n&&!1===n.animation?null:t;Qs(a,this._axisGroup,d);}}},_refreshBrushController:function _refreshBrushController(t,e,i,n,a,o){var r=i.axis.getExtent(),s=r[1]-r[0],l=Math.min(30,.1*Math.abs(s)),u=bi.create({x:r[0],y:-a/2,width:s,height:a});u.x-=l,u.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,position:t.position}).setPanels([{panelId:"pl",clipPath:Mb(u),isTargetByCursor:Ab(u,o,n),getLinearBrushOtherExtent:Ib(u,0)}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers(function(t){var e=t.axis;return N(t.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[e.dataToCoord(t[0],!0),e.dataToCoord(t[1],!0)]};});}(i));},_onBrush:function _onBrush(t,e){var i=this.axisModel,n=i.axis,a=N(t,function(t){return[n.coordToData(t.range[0],!0),n.coordToData(t.range[1],!0)];});!i.option.realtime!==e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:a});},dispose:function dispose(){this._brushController.dispose();}});lf({type:"parallel",render:function render(t,e,i){this._model=t,this._api=i,this._handlers||(this._handlers={},E(Lb,function(t,e){i.getZr().on(e,this._handlers[e]=T(t,this));},this)),dc(this,"_throttledDispatchExpand",t.get("axisExpandRate"),"fixRate");},dispose:function dispose(t,i){E(this._handlers,function(t,e){i.getZr().off(e,t);}),this._handlers=null;},_throttledDispatchExpand:function _throttledDispatchExpand(t){this._dispatchExpand(t);},_dispatchExpand:function _dispatchExpand(t){t&&this._api.dispatchAction(L({type:"parallelAxisExpand"},t));}});var Lb={mousedown:function mousedown(t){kb(this,"click")&&(this._mouseDownPoint=[t.offsetX,t.offsetY]);},mouseup:function mouseup(t){var e=this._mouseDownPoint;if(kb(this,"click")&&e){var i=[t.offsetX,t.offsetY];if(5<Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))return;var n=this._model.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]);"none"!==n.behavior&&this._dispatchExpand({axisExpandWindow:n.axisExpandWindow});}this._mouseDownPoint=null;},mousemove:function mousemove(t){if(!this._mouseDownPoint&&kb(this,"mousemove")){var e=this._model,i=e.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]),n=i.behavior;"jump"===n&&this._throttledDispatchExpand.debounceNextCall(e.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===n?null:{axisExpandWindow:i.axisExpandWindow,animation:"jump"===n&&null});}}};function kb(t,e){var i=t._model;return i.get("axisExpandable")&&i.get("axisExpandTriggerOn")===e;}Jd(function(t){!function(t){if(t.parallel)return;var e=!1;E(t.series,function(t){t&&"parallel"===t.type&&(e=!0);}),e&&(t.parallel=[{}]);}(t),function(n){E(wa(n.parallelAxis),function(t){if(z(t)){var e=t.parallelIndex||0,i=wa(n.parallel)[e];i&&i.parallelAxisDefault&&m(t,i.parallelAxisDefault,!1);}});}(t);}),Wh.extend({type:"series.parallel",dependencies:["parallel"],visualColorAccessPath:"lineStyle.color",getInitialData:function getInitialData(t,e){var i=this.getSource();return function(t,e){if(t.encodeDefine)return;var i=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(!i)return;var n=t.encodeDefine=Q();E(i.dimensions,function(t){var e=function(t){return+t.replace("dim","");}(t);n.set(t,e);});}(i,this),Xf(i,this);},getRawIndicesByActiveState:function getRawIndicesByActiveState(i){var t=this.coordinateSystem,n=this.getData(),a=[];return t.eachActiveState(n,function(t,e){i===t&&a.push(n.getRawIndex(e));}),a;},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"}});ec.extend({type:"parallel",init:function init(){this._dataGroup=new Si(),this.group.add(this._dataGroup),this._data,this._initialized;},render:function render(o,t,e,r){var i=this._dataGroup,s=o.getData(),l=this._data,u=o.coordinateSystem,h=u.dimensions,c=Ob(o);if(s.diff(l).add(function(t){Eb(Nb(s,i,t,h,u),s,t,c);}).update(function(t,e){var i=l.getItemGraphicEl(e),n=Pb(s,t,h,u);s.setItemGraphicEl(t,i);var a=r&&!1===r.animation?null:o;js(i,{shape:{points:n}},a,t),Eb(i,s,t,c);}).remove(function(t){var e=l.getItemGraphicEl(t);i.remove(e);}).execute(),!this._initialized){this._initialized=!0;var n=function(t,e,i){var n=t.model,a=t.getRect(),o=new Hr({shape:{x:a.x,y:a.y,width:a.width,height:a.height}}),r="horizontal"===n.get("layout")?"width":"height";return o.setShape(r,0),qs(o,{shape:{width:a.width,height:a.height}},e,i),o;}(u,o,function(){setTimeout(function(){i.removeClipPath();});});i.setClipPath(n);}this._data=s;},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){this._initialized=!0,this._data=null,this._dataGroup.removeAll();},incrementalRender:function incrementalRender(t,e,i){for(var n=e.getData(),a=e.coordinateSystem,o=a.dimensions,r=Ob(e),s=t.start;s<t.end;s++){var l=Nb(n,this._dataGroup,s,o,a);l.incremental=!0,Eb(l,n,s,r);}},dispose:function dispose(){},remove:function remove(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null;}});function Pb(t,e,i,n){for(var a,o=[],r=0;r<i.length;r++){var s=i[r],l=t.get(t.mapDimension(s),e);a=l,("category"===n.getAxis(s).type?null==a:null==a||isNaN(a))||o.push(n.dataToPoint(l,s));}return o;}function Nb(t,e,i,n,a){var o=Pb(t,i,n,a),r=new zr({shape:{points:o},silent:!0,z2:10});return e.add(r),t.setItemGraphicEl(i,r),r;}function Ob(t){var e=t.get("smooth",!0);return!0===e&&(e=.3),{lineStyle:t.getModel("lineStyle").getLineStyle(),smooth:null!=e?e:.3};}function Eb(t,e,i,n){var a=n.lineStyle;e.hasItemOption&&(a=e.getItemModel(i).getModel("lineStyle").getLineStyle());t.useStyle(a);var o=t.style;o.fill=null,o.stroke=e.getItemVisual(i,"color"),o.opacity=e.getItemVisual(i,"opacity"),n.smooth&&(t.shape.smooth=n.smooth);}var Rb=["lineStyle","normal","opacity"];af({seriesType:"parallel",reset:function reset(t,e,i){var n=t.getModel("itemStyle"),a=t.getModel("lineStyle"),o=e.get("color"),r=a.get("color")||n.get("color")||o[t.seriesIndex%o.length],s=t.get("inactiveOpacity"),l=t.get("activeOpacity"),u=t.getModel("lineStyle").getLineStyle(),h=t.coordinateSystem,c=t.getData(),d={normal:u.opacity,active:l,inactive:s};return c.setVisual("color",r),{progress:function progress(t,a){h.eachActiveState(a,function(t,e){var i=d[t];if("normal"===t&&a.hasItemOption){var n=a.getItemModel(e).get(Rb,!0);null!=n&&(i=n);}a.setItemVisual(e,"opacity",i);},t.start,t.end);}};}});var zb=Wh.extend({type:"series.sankey",layoutInfo:null,levelModels:null,getInitialData:function getInitialData(t,e){for(var i=t.edges||t.links,n=t.data||t.nodes,a=t.levels,o=this.levelModels={},r=0;r<a.length;r++){null!=a[r].depth&&0<=a[r].depth&&(o[a[r].depth]=new dl(a[r],this,e));}if(n&&i)return I_(n,i,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t,n){return t.customizeGetParent(function(t){var e=this.parentModel,i=e.getData().getItemLayout(n).depth;return e.levelModels[i]||this.parentModel;}),t;}),e.wrapMethod("getItemModel",function(t,n){return t.customizeGetParent(function(t){var e=this.parentModel,i=e.getGraph().getEdgeByIndex(n).node1.getLayout().depth;return e.levelModels[i]||this.parentModel;}),t;});}).data;},setNodePosition:function setNodePosition(t,e){var i=this.option.data[t];i.localX=e[0],i.localY=e[1];},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},formatTooltip:function formatTooltip(t,e,i){if("edge"===i){var n=this.getDataParams(t,i),a=n.data,o=a.source+" -- "+a.target;return n.value&&(o+=" : "+n.value),Wl(o);}if("node"!==i)return zb.superCall(this,"formatTooltip",t,e);var r=this.getGraph().getNodeByIndex(t).getLayout().value,s=this.getDataParams(t,i).data.name;if(r)o=s+" : "+r;return Wl(o);},optionUpdated:function optionUpdated(){var t=this.option;!0===t.focusNodeAdjacency&&(t.focusNodeAdjacency="allEdges");},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,focusNodeAdjacency:!1,layoutIterations:32,label:{show:!0,position:"right",color:"#000",fontSize:12},levels:[],nodeAlign:"justify",itemStyle:{borderWidth:1,borderColor:"#333"},lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.6}},animationEasing:"linear",animationDuration:1e3}}),Bb=["itemStyle","opacity"],Vb=["lineStyle","opacity"];function Gb(t,e){return t.getVisual("opacity")||t.getModel().get(e);}function Fb(t,e,i){var n=t.getGraphicEl(),a=Gb(t,e);null!=i&&(null==a&&(a=1),a*=i),n.downplay&&n.downplay(),n.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",a);});}function Wb(t,e){var i=Gb(t,e),n=t.getGraphicEl();n.highlight&&n.highlight(),n.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",i);});}var Hb=ds({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0,orient:""},buildPath:function buildPath(t,e){var i=e.extent;t.moveTo(e.x1,e.y1),t.bezierCurveTo(e.cpx1,e.cpy1,e.cpx2,e.cpy2,e.x2,e.y2),"vertical"===e.orient?(t.lineTo(e.x2+i,e.y2),t.bezierCurveTo(e.cpx2+i,e.cpy2,e.cpx1+i,e.cpy1,e.x1+i,e.y1)):(t.lineTo(e.x2,e.y2+i),t.bezierCurveTo(e.cpx2,e.cpy2+i,e.cpx1,e.cpy1+i,e.x1,e.y1+i)),t.closePath();}});hf({type:"sankey",_model:null,_focusAdjacencyDisabled:!1,render:function render(w,t,n){var a=this,e=w.getGraph(),b=this.group,i=w.layoutInfo,S=i.width,M=i.height,u=w.getData(),I=w.getData("edge"),A=w.get("orient");this._model=w,b.removeAll(),b.attr("position",[i.x,i.y]),e.eachEdge(function(t){var e=new Hb();e.dataIndex=t.dataIndex,e.seriesIndex=w.seriesIndex,e.dataType="edge";var i,n,a,o,r,s,l,u,h=t.getModel("lineStyle"),c=h.get("curveness"),d=t.node1.getLayout(),f=t.node1.getModel(),p=f.get("localX"),g=f.get("localY"),m=t.node2.getLayout(),v=t.node2.getModel(),y=v.get("localX"),x=v.get("localY"),_=t.getLayout();switch(e.shape.extent=Math.max(1,_.dy),u="vertical"===(e.shape.orient=A)?(i=(null!=p?p*S:d.x)+_.sy,n=(null!=g?g*M:d.y)+d.dy,a=(null!=y?y*S:m.x)+_.ty,r=i,s=n*(1-c)+(o=null!=x?x*M:m.y)*c,l=a,n*c+o*(1-c)):(i=(null!=p?p*S:d.x)+d.dx,n=(null!=g?g*M:d.y)+_.sy,r=i*(1-c)+(a=null!=y?y*S:m.x)*c,s=n,l=i*c+a*(1-c),o=(null!=x?x*M:m.y)+_.ty),e.setShape({x1:i,y1:n,x2:a,y2:o,cpx1:r,cpy1:s,cpx2:l,cpy2:u}),e.setStyle(h.getItemStyle()),e.style.fill){case"source":e.style.fill=t.node1.getVisual("color");break;case"target":e.style.fill=t.node2.getVisual("color");}Os(e,t.getModel("emphasis.lineStyle").getItemStyle()),b.add(e),I.setItemGraphicEl(t.dataIndex,e);}),e.eachNode(function(t){var e=t.getLayout(),i=t.getModel(),n=i.get("localX"),a=i.get("localY"),o=i.getModel("label"),r=i.getModel("emphasis.label"),s=new Hr({shape:{x:null!=n?n*S:e.x,y:null!=a?a*M:e.y,width:e.dx,height:e.dy},style:i.getModel("itemStyle").getItemStyle()}),l=t.getModel("emphasis.itemStyle").getItemStyle();Bs(s.style,l,o,r,{labelFetcher:w,labelDataIndex:t.dataIndex,defaultText:t.id,isRectText:!0}),s.setStyle("fill",t.getVisual("color")),Os(s,l),b.add(s),u.setItemGraphicEl(t.dataIndex,s),s.dataType="node";}),u.eachItemGraphicEl(function(t,i){var e=u.getItemModel(i);e.get("draggable")&&(t.drift=function(t,e){a._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=e,this.dirty(),n.dispatchAction({type:"dragNode",seriesId:w.id,dataIndex:u.getRawIndex(i),localX:this.shape.x/S,localY:this.shape.y/M});},t.ondragend=function(){a._focusAdjacencyDisabled=!1;},t.draggable=!0,t.cursor="move"),e.get("focusNodeAdjacency")&&(t.off("mouseover").on("mouseover",function(){a._focusAdjacencyDisabled||n.dispatchAction({type:"focusNodeAdjacency",seriesId:w.id,dataIndex:t.dataIndex});}),t.off("mouseout").on("mouseout",function(){a._focusAdjacencyDisabled||n.dispatchAction({type:"unfocusNodeAdjacency",seriesId:w.id});}));}),I.eachItemGraphicEl(function(t,e){I.getItemModel(e).get("focusNodeAdjacency")&&(t.off("mouseover").on("mouseover",function(){a._focusAdjacencyDisabled||n.dispatchAction({type:"focusNodeAdjacency",seriesId:w.id,edgeDataIndex:t.dataIndex});}),t.off("mouseout").on("mouseout",function(){a._focusAdjacencyDisabled||n.dispatchAction({type:"unfocusNodeAdjacency",seriesId:w.id});}));}),!this._data&&w.get("animation")&&b.setClipPath(function(t,e,i){var n=new Hr({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return qs(n,{shape:{width:t.width+20,height:t.height+20}},e,i),n;}(b.getBoundingRect(),w,function(){b.removeClipPath();})),this._data=w.getData();},dispose:function dispose(){},focusNodeAdjacency:function focusNodeAdjacency(t,e,i,n){var a=this._model.getData(),o=a.graph,r=n.dataIndex,s=a.getItemModel(r),l=n.edgeDataIndex;if(null!=r||null!=l){var u=o.getNodeByIndex(r),h=o.getEdgeByIndex(l);if(o.eachNode(function(t){Fb(t,Bb,.1);}),o.eachEdge(function(t){Fb(t,Vb,.1);}),u){Wb(u,Bb);var c=s.get("focusNodeAdjacency");"outEdges"===c?E(u.outEdges,function(t){t.dataIndex<0||(Wb(t,Vb),Wb(t.node2,Bb));}):"inEdges"===c?E(u.inEdges,function(t){t.dataIndex<0||(Wb(t,Vb),Wb(t.node1,Bb));}):"allEdges"===c&&E(u.edges,function(t){t.dataIndex<0||(Wb(t,Vb),Wb(t.node1,Bb),Wb(t.node2,Bb));});}h&&(Wb(h,Vb),Wb(h.node1,Bb),Wb(h.node2,Bb));}},unfocusNodeAdjacency:function unfocusNodeAdjacency(t,e,i,n){var a=this._model.getGraph();a.eachNode(function(t){Fb(t,Bb);}),a.eachEdge(function(t){Fb(t,Vb);});}}),tf({type:"dragNode",event:"dragnode",update:"update"},function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY]);});});function Zb(t){var e=t.hostGraph.data.getRawDataItem(t.dataIndex);return null!=e.depth&&0<=e.depth;}function Ub(t,l,u,h,c){var d="vertical"===c?"x":"y";E(t,function(t){var e,i,n;t.sort(function(t,e){return t.getLayout()[d]-e.getLayout()[d];});for(var a=0,o=t.length,r="vertical"===c?"dx":"dy",s=0;s<o;s++){0<(n=a-(i=t[s]).getLayout()[d])&&(e=i.getLayout()[d]+n,"vertical"===c?i.setLayout({x:e},!0):i.setLayout({y:e},!0)),a=i.getLayout()[d]+i.getLayout()[r]+l;}if(0<(n=a-l-("vertical"===c?h:u)))for(e=i.getLayout()[d]-n,"vertical"===c?i.setLayout({x:e},!0):i.setLayout({y:e},!0),a=e,s=o-2;0<=s;--s){0<(n=(i=t[s]).getLayout()[d]+i.getLayout()[r]+l-a)&&(e=i.getLayout()[d]-n,"vertical"===c?i.setLayout({x:e},!0):i.setLayout({y:e},!0)),a=i.getLayout()[d];}});}function Xb(t,a,o){E(t.slice().reverse(),function(t){E(t,function(t){if(t.outEdges.length){var e=$b(t.outEdges,Yb,o)/$b(t.outEdges,Kb,o);if("vertical"===o){var i=t.getLayout().x+(e-qb(t,o))*a;t.setLayout({x:i},!0);}else{var n=t.getLayout().y+(e-qb(t,o))*a;t.setLayout({y:n},!0);}}});});}function Yb(t,e){return qb(t.node2,e)*t.getValue();}function jb(t,e){return qb(t.node1,e)*t.getValue();}function qb(t,e){return"vertical"===e?t.getLayout().x+t.getLayout().dx/2:t.getLayout().y+t.getLayout().dy/2;}function Kb(t){return t.getValue();}function $b(t,e,i){for(var n=0,a=t.length,o=-1;++o<a;){var r=+e.call(t,t[o],i);isNaN(r)||(n+=r);}return n;}function Jb(t,a,o){E(t,function(t){E(t,function(t){if(t.inEdges.length){var e=$b(t.inEdges,jb,o)/$b(t.inEdges,Kb,o);if("vertical"===o){var i=t.getLayout().x+(e-qb(t,o))*a;t.setLayout({x:i},!0);}else{var n=t.getLayout().y+(e-qb(t,o))*a;t.setLayout({y:n},!0);}}});});}nf(function(t,u,e){t.eachSeriesByType("sankey",function(t){var e=t.get("nodeWidth"),i=t.get("nodeGap"),n=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}(t,u),a=(t.layoutInfo=n).width,o=n.height,r=t.getGraph(),s=r.nodes,l=r.edges;!function(t){E(t,function(t){var e=$b(t.outEdges,Kb),i=$b(t.inEdges,Kb),n=Math.max(e,i);t.setLayout({value:n},!0);});}(s),function(t,e,i,n,a,o,r,s,l){(function(t,e,i,n,a,o,r){for(var s=[],l=[],u=[],h=[],c=0,d=0;d<e.length;d++){s[d]=1;}for(d=0;d<t.length;d++){l[d]=t[d].inEdges.length,0===l[d]&&u.push(t[d]);}var f=-1;for(;u.length;){for(var p=0;p<u.length;p++){var g=u[p],m=g.hostGraph.data.getRawDataItem(g.dataIndex),v=null!=m.depth&&0<=m.depth;v&&m.depth>f&&(f=m.depth),g.setLayout({depth:v?m.depth:c},!0),"vertical"===o?g.setLayout({dy:i},!0):g.setLayout({dx:i},!0);for(var y=0;y<g.outEdges.length;y++){var x=g.outEdges[y],_=e.indexOf(x);s[_]=0;var w=x.node2,b=t.indexOf(w);0==--l[b]&&h.indexOf(w)<0&&h.push(w);}}++c,u=h,h=[];}for(d=0;d<s.length;d++){if(1===s[d])throw new Error("Sankey is a DAG, the original data has cycle!");}var S=c-1<f?f:c-1;r&&"left"!==r&&function(t,e,i,n){if("right"===e){for(var a=[],o=t,r=0;o.length;){for(var s=0;s<o.length;s++){var l=o[s];l.setLayout({skNodeHeight:r},!0);for(var u=0;u<l.inEdges.length;u++){var h=l.inEdges[u];a.indexOf(h.node1)<0&&a.push(h.node1);}}o=a,a=[],++r;}E(t,function(t){Zb(t)||t.setLayout({depth:Math.max(0,n-t.getLayout().skNodeHeight)},!0);});}else"justify"===e&&function(t,e){E(t,function(t){Zb(t)||t.outEdges.length||t.setLayout({depth:e},!0);});}(t,n);}(t,r,0,S);!function(t,i,n){E(t,function(t){var e=t.getLayout().depth*i;"vertical"===n?t.setLayout({y:e},!0):t.setLayout({x:e},!0);});}(t,"vertical"===o?(a-i)/S:(n-i)/S,o);})(t,e,i,a,o,s,l),function(t,e,i,n,a,o,r){var s=function(t,e){var i=[],n="vertical"===e?"y":"x",a=Ra(t,function(t){return t.getLayout()[n];});return a.keys.sort(function(t,e){return t-e;}),E(a.keys,function(t){i.push(a.buckets.get(t));}),i;}(t,r);(function(t,e,a,o,r,s){var l=1/0;E(t,function(t){var e=t.length,i=0;E(t,function(t){i+=t.getLayout().value;});var n="vertical"===s?(o-(e-1)*r)/i:(a-(e-1)*r)/i;n<l&&(l=n);}),E(t,function(t){E(t,function(t,e){var i=t.getLayout().value*l;"vertical"===s?(t.setLayout({x:e},!0),t.setLayout({dx:i},!0)):(t.setLayout({y:e},!0),t.setLayout({dy:i},!0));});}),E(e,function(t){var e=+t.getValue()*l;t.setLayout({dy:e},!0);});})(s,e,i,n,a,r),Ub(s,a,i,n,r);for(var l=1;0<o;o--){Xb(s,l*=.99,r),Ub(s,a,i,n,r),Jb(s,l,r),Ub(s,a,i,n,r);}}(t,e,o,a,n,r,s),function(t,e){var i="vertical"===e?"x":"y";E(t,function(t){t.outEdges.sort(function(t,e){return t.node2.getLayout()[i]-e.node2.getLayout()[i];}),t.inEdges.sort(function(t,e){return t.node1.getLayout()[i]-e.node1.getLayout()[i];});}),E(t,function(t){var e=0,i=0;E(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy;}),E(t.inEdges,function(t){t.setLayout({ty:i},!0),i+=t.getLayout().dy;});});}(t,s);}(s,l,e,i,a,o,0!==M(s,function(t){return 0===t.getLayout().value;}).length?0:t.get("layoutIterations"),t.get("orient"),t.get("nodeAlign"));});}),af(function(t,e){t.eachSeriesByType("sankey",function(n){var t=n.getGraph().nodes;if(t.length){var a=1/0,o=-1/0;E(t,function(t){var e=t.getLayout().value;e<a&&(a=e),o<e&&(o=e);}),E(t,function(t){var e=new Bx({type:"color",mappingMethod:"linear",dataExtent:[a,o],visual:n.get("color")}).mapValueToVisual(t.getLayout().value),i=t.getModel().get("itemStyle.color");null!=i?t.setVisual("color",i):t.setVisual("color",e);});}});});var Qb={_baseAxisDim:null,getInitialData:function getInitialData(t,e){var i,n,a=e.getComponent("xAxis",this.get("xAxisIndex")),o=e.getComponent("yAxis",this.get("yAxisIndex")),r=a.get("type"),s=o.get("type");"category"===r?(t.layout="horizontal",i=a.getOrdinalMeta(),n=!0):"category"===s?(t.layout="vertical",i=o.getOrdinalMeta(),n=!0):t.layout=t.layout||"horizontal";var l=["x","y"],u="horizontal"===t.layout?0:1,h=this._baseAxisDim=l[u],c=l[1-u],d=[a,o],f=d[u].get("type"),p=d[1-u].get("type"),g=t.data;if(g&&n){var m=[];E(g,function(t,e){var i;t.value&&k(t.value)?(i=t.value.slice(),t.value.unshift(e)):k(t)?(i=t.slice(),t.unshift(e)):i=t,m.push(i);}),t.data=m;}var v=this.defaultValueDimensions;return yv(this,{coordDimensions:[{name:h,type:mf(f),ordinalMeta:i,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:c,type:mf(p),dimsDef:v.slice()}],dimensionsCount:v.length+1});},getBaseAxis:function getBaseAxis(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis;}};b(Wh.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}}),Qb,!0);var tS=["itemStyle"],eS=["emphasis","itemStyle"],iS=(ec.extend({type:"boxplot",render:function render(t,e,i){var a=t.getData(),o=this.group,r=this._data;this._data||o.removeAll();var s="horizontal"===t.get("layout")?1:0;a.diff(r).add(function(t){if(a.hasValue(t)){var e=nS(a.getItemLayout(t),a,t,s,!0);a.setItemGraphicEl(t,e),o.add(e);}}).update(function(t,e){var i=r.getItemGraphicEl(e);if(a.hasValue(t)){var n=a.getItemLayout(t);i?aS(n,i,a,t):i=nS(n,a,t,s),o.add(i),a.setItemGraphicEl(t,i);}else o.remove(i);}).remove(function(t){var e=r.getItemGraphicEl(t);e&&o.remove(e);}).execute(),this._data=a;},remove:function remove(t){var e=this.group,i=this._data;this._data=null,i&&i.eachItemGraphicEl(function(t){t&&e.remove(t);});},dispose:et}),hr.extend({type:"boxplotBoxPath",shape:{},buildPath:function buildPath(t,e){var i=e.points,n=0;for(t.moveTo(i[n][0],i[n][1]),n++;n<4;n++){t.lineTo(i[n][0],i[n][1]);}for(t.closePath();n<i.length;n++){t.moveTo(i[n][0],i[n][1]),n++,t.lineTo(i[n][0],i[n][1]);}}}));function nS(t,e,i,n,a){var o=t.ends,r=new iS({shape:{points:a?function(t,e,i){return N(t,function(t){return(t=t.slice())[e]=i.initBaseline,t;});}(o,n,t):o}});return aS(t,r,e,i,a),r;}function aS(t,e,i,n,a){var o=i.hostModel;(0,ol[a?"initProps":"updateProps"])(e,{shape:{points:t.ends}},o,n);var r=i.getItemModel(n),s=r.getModel(tS),l=i.getItemVisual(n,"color"),u=s.getItemStyle(["borderColor"]);u.stroke=l,u.strokeNoScale=!0,e.useStyle(u),e.z2=100,Os(e,r.getModel(eS).getItemStyle());}var oS=["itemStyle","borderColor"],rS=E;af(function(n,t){var a=n.get("color");n.eachRawSeriesByType("boxplot",function(t){var e=a[t.seriesIndex%a.length],i=t.getData();i.setVisual({legendSymbol:"roundRect",color:t.get(oS)||e}),n.isSeriesFiltered(t)||i.each(function(t){var e=i.getItemModel(t);i.setItemVisual(t,{color:e.get(oS,!0)});});});}),nf(function(t){var e=function(t){var n=[],a=[];return t.eachSeriesByType("boxplot",function(t){var e=t.getBaseAxis(),i=_(a,e);i<0&&(i=a.length,a[i]=e,n[i]={axis:e,seriesModels:[]}),n[i].seriesModels.push(t);}),n;}(t);rS(e,function(i){var t=i.seriesModels;t.length&&(function(t){var e,i,n=t.axis,a=t.seriesModels,o=a.length,r=t.boxWidthList=[],s=t.boxOffsetList=[],l=[];if("category"===n.type)i=n.getBandWidth();else{var u=0;rS(a,function(t){u=Math.max(u,t.getData().count());}),e=n.getExtent(),Math.abs(e[1]-e[0]);}rS(a,function(t){var e=t.get("boxWidth");k(e)||(e=[e,e]),l.push([xl(e[0],i)||0,xl(e[1],i)||0]);});var h=.8*i-2,c=h/o*.3,d=(h-c*(o-1))/o,f=d/2-h/2;rS(a,function(t,e){s.push(f),f+=c+d,r.push(Math.min(Math.max(d,l[e][0]),l[e][1]));});}(i),rS(t,function(t,e){!function(t,r,e){var s=t.coordinateSystem,l=t.getData(),o=e/2,u="horizontal"===t.get("layout")?0:1,h=1-u,i=["x","y"],n=l.mapDimension(i[u]),a=l.mapDimension(i[h],!0);if(null==n||a.length<5)return;for(var c=0;c<l.count();c++){var d=l.get(n,c),f=x(d,a[2],c),p=x(d,a[0],c),g=x(d,a[1],c),m=x(d,a[3],c),v=x(d,a[4],c),y=[];_(y,g,0),_(y,m,1),y.push(p,g,v,m),w(y,p),w(y,v),w(y,f),l.setItemLayout(c,{initBaseline:f[h],ends:y});}function x(t,e,i){var n,a=l.get(e,i),o=[];return o[u]=t,o[h]=a,isNaN(t)||isNaN(a)?n=[NaN,NaN]:(n=s.dataToPoint(o))[u]+=r,n;}function _(t,e,i){var n=e.slice(),a=e.slice();n[u]+=o,a[u]-=o,i?t.push(n,a):t.push(a,n);}function w(t,e){var i=e.slice(),n=e.slice();i[u]-=o,n[u]+=o,t.push(i,n);}}(t,i.boxOffsetList[e],i.boxWidthList[e]);}));});}),b(Wh.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,clip:!0,itemStyle:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function getShadowDim(){return"open";},brushSelector:function brushSelector(t,e,i){var n=e.getItemLayout(t);return n&&i.rect(n.brushRect);}}),Qb,!0);var sS=["itemStyle"],lS=["emphasis","itemStyle"],uS=["color","color0","borderColor","borderColor0"],hS=(ec.extend({type:"candlestick",render:function render(t,e,i){this.group.removeClipPath(),this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t);},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){this._clear(),this._updateDrawMode(t);},incrementalRender:function incrementalRender(t,e,i,n){this._isLargeDraw?this._incrementalRenderLarge(t,e):this._incrementalRenderNormal(t,e);},_updateDrawMode:function _updateDrawMode(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear());},_renderNormal:function _renderNormal(a){var o=a.getData(),r=this._data,s=this.group,l=o.getLayout("isSimpleBox"),u=a.get("clip",!0),t=a.coordinateSystem,h=t.getArea&&t.getArea();this._data||s.removeAll(),o.diff(r).add(function(t){if(o.hasValue(t)){var e,i=o.getItemLayout(t);if(u&&dS(h,i))return;qs(e=cS(i,t,!0),{shape:{points:i.ends}},a,t),fS(e,o,t,l),s.add(e),o.setItemGraphicEl(t,e);}}).update(function(t,e){var i=r.getItemGraphicEl(e);if(o.hasValue(t)){var n=o.getItemLayout(t);u&&dS(h,n)?s.remove(i):(i?js(i,{shape:{points:n.ends}},a,t):i=cS(n,t),fS(i,o,t,l),s.add(i),o.setItemGraphicEl(t,i));}else s.remove(i);}).remove(function(t){var e=r.getItemGraphicEl(t);e&&s.remove(e);}).execute(),this._data=o;},_renderLarge:function _renderLarge(t){this._clear(),gS(t,this.group);var e=t.get("clip",!0)?tm(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath();},_incrementalRenderNormal:function _incrementalRenderNormal(t,e){for(var i,n=e.getData(),a=n.getLayout("isSimpleBox");null!=(i=t.next());){var o;fS(o=cS(n.getItemLayout(i),i),n,i,a),o.incremental=!0,this.group.add(o);}},_incrementalRenderLarge:function _incrementalRenderLarge(t,e){gS(e,this.group,!0);},remove:function remove(t){this._clear();},_clear:function _clear(){this.group.removeAll(),this._data=null;},dispose:et}),hr.extend({type:"normalCandlestickBox",shape:{},buildPath:function buildPath(t,e){var i=e.points;this.__simpleBox?(t.moveTo(i[4][0],i[4][1]),t.lineTo(i[6][0],i[6][1])):(t.moveTo(i[0][0],i[0][1]),t.lineTo(i[1][0],i[1][1]),t.lineTo(i[2][0],i[2][1]),t.lineTo(i[3][0],i[3][1]),t.closePath(),t.moveTo(i[4][0],i[4][1]),t.lineTo(i[5][0],i[5][1]),t.moveTo(i[6][0],i[6][1]),t.lineTo(i[7][0],i[7][1]));}}));function cS(t,e,i){var n=t.ends;return new hS({shape:{points:i?function(t,e){return N(t,function(t){return(t=t.slice())[1]=e.initBaseline,t;});}(n,t):n},z2:100});}function dS(t,e){for(var i=!0,n=0;n<e.ends.length;n++){if(t.contain(e.ends[n][0],e.ends[n][1])){i=!1;break;}}return i;}function fS(t,e,i,n){var a=e.getItemModel(i),o=a.getModel(sS),r=e.getItemVisual(i,"color"),s=e.getItemVisual(i,"borderColor")||r,l=o.getItemStyle(uS);t.useStyle(l),t.style.strokeNoScale=!0,t.style.fill=r,t.style.stroke=s,t.__simpleBox=n,Os(t,a.getModel(lS).getItemStyle());}var pS=hr.extend({type:"largeCandlestickBox",shape:{},buildPath:function buildPath(t,e){for(var i=e.points,n=0;n<i.length;){if(this.__sign===i[n++]){var a=i[n++];t.moveTo(a,i[n++]),t.lineTo(a,i[n++]);}else n+=3;}}});function gS(t,e,i){var n=t.getData(),a=n.getLayout("largePoints"),o=new pS({shape:{points:a},__sign:1});e.add(o);var r=new pS({shape:{points:a},__sign:-1});e.add(r),mS(1,o,t,n),mS(-1,r,t,n),i&&(o.incremental=!0,r.incremental=!0);}function mS(t,e,i,n){var a=0<t?"P":"N",o=n.getVisual("borderColor"+a)||n.getVisual("color"+a),r=i.getModel(sS).getItemStyle(uS);e.useStyle(r),e.style.fill=null,e.style.stroke=o;}var vS=["itemStyle","borderColor"],yS=["itemStyle","borderColor0"],xS=["itemStyle","color"],_S=["itemStyle","color0"],wS={seriesType:"candlestick",plan:Jh(),performRawSeries:!0,reset:function reset(t,e){var i=t.getData(),n=t.pipelineContext.large;if(i.setVisual({legendSymbol:"roundRect",colorP:o(1,t),colorN:o(-1,t),borderColorP:r(1,t),borderColorN:r(-1,t)}),!e.isSeriesFiltered(t))return!n&&{progress:function progress(t,e){var i;for(;null!=(i=t.next());){var n=e.getItemModel(i),a=e.getItemLayout(i).sign;e.setItemVisual(i,{color:o(a,n),borderColor:r(a,n)});}}};function o(t,e){return e.get(0<t?xS:_S);}function r(t,e){return e.get(0<t?vS:yS);}}},bS="undefined"!=typeof Float32Array?Float32Array:Array,SS={seriesType:"candlestick",plan:Jh(),reset:function reset(t){var x=t.coordinateSystem,e=t.getData(),_=function(t,e){var i,n=t.getBaseAxis(),a="category"===n.type?n.getBandWidth():(i=n.getExtent(),Math.abs(i[1]-i[0])/e.count()),o=xl(H(t.get("barMaxWidth"),a),a),r=xl(H(t.get("barMinWidth"),1),a),s=t.get("barWidth");return null!=s?xl(s,a):Math.max(Math.min(a/2,o),r);}(t,e),i=["x","y"],w=e.mapDimension(i[0]),n=e.mapDimension(i[1],!0),b=n[0],S=n[1],M=n[2],I=n[3];if(e.setLayout({candleWidth:_,isSimpleBox:_<=1.3}),!(null==w||n.length<4))return{progress:t.pipelineContext.large?function(t,e){var i,n,a=new bS(4*t.count),o=0,r=[],s=[];for(;null!=(n=t.next());){var l=e.get(w,n),u=e.get(b,n),h=e.get(S,n),c=e.get(M,n),d=e.get(I,n);isNaN(l)||isNaN(c)||isNaN(d)?(a[o++]=NaN,o+=3):(a[o++]=MS(e,n,u,h,S),r[0]=l,r[1]=c,i=x.dataToPoint(r,null,s),a[o++]=i?i[0]:NaN,a[o++]=i?i[1]:NaN,r[1]=d,i=x.dataToPoint(r,null,s),a[o++]=i?i[1]:NaN);}e.setLayout("largePoints",a);}:function(t,e){var i;for(;null!=(i=t.next());){var n=e.get(w,i),a=e.get(b,i),o=e.get(S,i),r=e.get(M,i),s=e.get(I,i),l=Math.min(a,o),u=Math.max(a,o),h=g(l,n),c=g(u,n),d=g(r,n),f=g(s,n),p=[];m(p,c,0),m(p,h,1),p.push(y(f),y(c),y(d),y(h)),e.setItemLayout(i,{sign:MS(e,i,a,o,S),initBaseline:o<a?c[1]:h[1],ends:p,brushRect:v(r,s,n)});}function g(t,e){var i=[];return i[0]=e,i[1]=t,isNaN(e)||isNaN(t)?[NaN,NaN]:x.dataToPoint(i);}function m(t,e,i){var n=e.slice(),a=e.slice();n[0]=_s(n[0]+_/2,1,!1),a[0]=_s(a[0]-_/2,1,!0),i?t.push(n,a):t.push(a,n);}function v(t,e,i){var n=g(t,i),a=g(e,i);return n[0]-=_/2,a[0]-=_/2,{x:n[0],y:n[1],width:_,height:a[1]-n[1]};}function y(t){return t[0]=_s(t[0],1),t;}}};}};function MS(t,e,i,n,a){return n<i?-1:i<n?1:0<e?t.get(a,e-1)<=n?1:-1:1;}Jd(function(t){t&&k(t.series)&&E(t.series,function(t){z(t)&&"k"===t.type&&(t.type="candlestick");});}),af(wS),nf(SS),Wh.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this);},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});function IS(t,e){var i=e.rippleEffectColor||e.color;t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?i:null,fill:"fill"===e.brushType?i:null}});});}function AS(t,e){Si.call(this);var i=new Sg(t,e),n=new Si();this.add(i),this.add(n),n.beforeUpdate=function(){this.attr(i.getScale());},this.updateData(t,e);}var TS=AS.prototype;TS.stopEffectAnimation=function(){this.childAt(1).removeAll();},TS.startEffectAnimation=function(t){for(var e=t.symbolType,i=t.color,n=this.childAt(1),a=0;a<3;a++){var o=Jp(e,-1,-1,2,2,i);o.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var r=-a/3*t.period+t.effectOffset;o.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(r).start(),o.animateStyle(!0).when(t.period,{opacity:0}).delay(r).start(),n.add(o);}IS(n,t);},TS.updateEffectAnimation=function(t){for(var e=this._effectCfg,i=this.childAt(1),n=["symbolType","period","rippleScale"],a=0;a<n.length;a++){var o=n[a];if(e[o]!==t[o])return this.stopEffectAnimation(),void this.startEffectAnimation(t);}IS(i,t);},TS.highlight=function(){this.trigger("emphasis");},TS.downplay=function(){this.trigger("normal");},TS.updateData=function(t,e){var i=t.hostModel;this.childAt(0).updateData(t,e);var n=this.childAt(1),a=t.getItemModel(e),o=t.getItemVisual(e,"symbol"),r=function(t){return k(t)||(t=[+t,+t]),t;}(t.getItemVisual(e,"symbolSize")),s=t.getItemVisual(e,"color");n.attr("scale",r),n.traverse(function(t){t.attr({fill:s});});var l=a.getShallow("symbolOffset");if(l){var u=n.position;u[0]=xl(l[0],r[0]),u[1]=xl(l[1],r[1]);}n.rotation=(a.getShallow("symbolRotate")||0)*Math.PI/180||0;var h={};if(h.showEffectOn=i.get("showEffectOn"),h.rippleScale=a.get("rippleEffect.scale"),h.brushType=a.get("rippleEffect.brushType"),h.period=1e3*a.get("rippleEffect.period"),h.effectOffset=e/t.count(),h.z=a.getShallow("z")||0,h.zlevel=a.getShallow("zlevel")||0,h.symbolType=o,h.color=s,h.rippleEffectColor=a.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===h.showEffectOn)this._effectCfg?this.updateEffectAnimation(h):this.startEffectAnimation(h),this._effectCfg=h;else{this._effectCfg=null,this.stopEffectAnimation();var c=this.childAt(0),d=function d(){c.highlight(),"render"!==h.showEffectOn&&this.startEffectAnimation(h);},f=function f(){c.downplay(),"render"!==h.showEffectOn&&this.stopEffectAnimation();};this.on("mouseover",d,this).on("mouseout",f,this).on("emphasis",d,this).on("normal",f,this);}this._effectCfg=h;},TS.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t();},w(AS,Si),hf({type:"effectScatter",init:function init(){this._symbolDraw=new Ng(AS);},render:function render(t,e,i){var n=t.getData(),a=this._symbolDraw;a.updateData(n),this.group.add(a.group);},updateTransform:function updateTransform(t,e,i){var n=t.getData();this.group.dirty();var a=sm().reset(t);a.progress&&a.progress({start:0,end:n.count()},n),this._symbolDraw.updateLayout(n);},_updateGroupTransform:function _updateGroupTransform(t){var e=t.coordinateSystem;e&&e.getRoamTransform&&(this.group.transform=se(e.getRoamTransform()),this.group.decomposeTransform());},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(e);},dispose:function dispose(){}}),af(rm("effectScatter","circle")),nf(sm("effectScatter"));var DS="undefined"==typeof Uint32Array?Array:Uint32Array,CS="undefined"==typeof Float64Array?Array:Float64Array;function LS(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(t.data=N(e,function(t){var e={coords:[t[0].coord,t[1].coord]};return t[0].name&&(e.fromName=t[0].name),t[1].name&&(e.toName=t[1].name),p([e,t[0],t[1]]);}));}var kS=Wh.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.color",init:function init(t){t.data=t.data||[],LS(t);var e=this._processFlatCoordsArray(t.data);this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count)),kS.superApply(this,"init",arguments);},mergeOption:function mergeOption(t){if(t.data=t.data||[],LS(t),t.data){var e=this._processFlatCoordsArray(t.data);this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count));}kS.superApply(this,"mergeOption",arguments);},appendData:function appendData(t){var e=this._processFlatCoordsArray(t.data);e.flatCoords&&(this._flatCoords?(this._flatCoords=tt(this._flatCoords,e.flatCoords),this._flatCoordsOffset=tt(this._flatCoordsOffset,e.flatCoordsOffset)):(this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset),t.data=new Float32Array(e.count)),this.getRawData().appendData(t.data);},_getCoordsFromItemModel:function _getCoordsFromItemModel(t){var e=this.getData().getItemModel(t);return e.option instanceof Array?e.option:e.getShallow("coords");},getLineCoordsCount:function getLineCoordsCount(t){return this._flatCoordsOffset?this._flatCoordsOffset[2*t+1]:this._getCoordsFromItemModel(t).length;},getLineCoords:function getLineCoords(t,e){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[2*t],n=this._flatCoordsOffset[2*t+1],a=0;a<n;a++){e[a]=e[a]||[],e[a][0]=this._flatCoords[i+2*a],e[a][1]=this._flatCoords[i+2*a+1];}return n;}var o=this._getCoordsFromItemModel(t);for(a=0;a<o.length;a++){e[a]=e[a]||[],e[a][0]=o[a][0],e[a][1]=o[a][1];}return o.length;},_processFlatCoordsArray:function _processFlatCoordsArray(t){var e=0;if(this._flatCoords&&(e=this._flatCoords.length),"number"!=typeof t[0])return{flatCoordsOffset:null,flatCoords:null,count:t.length};for(var i=t.length,n=new DS(i),a=new CS(i),o=0,r=0,s=0,l=0;l<i;){s++;var u=t[l++];n[r++]=o+e,n[r++]=u;for(var h=0;h<u;h++){var c=t[l++],d=t[l++];a[o++]=c,a[o++]=d;}}return{flatCoordsOffset:new Uint32Array(n.buffer,0,r),flatCoords:a,count:s};},getInitialData:function getInitialData(t,e){var o=new Tf(["value"],this);return o.hasItemOption=!1,o.initData(t.data,[],function(t,e,i,n){if(t instanceof Array)return NaN;o.hasItemOption=!0;var a=t.value;return null!=a?a instanceof Array?a[n]:a:void 0;}),o;},formatTooltip:function formatTooltip(t){var e=this.getData().getItemModel(t),i=e.get("name");if(i)return i;var n=e.get("fromName"),a=e.get("toName"),o=[];return null!=n&&o.push(n),null!=a&&o.push(a),Wl(o.join(" > "));},preventIncremental:function preventIncremental(){return!!this.get("effect.show");},getProgressive:function getProgressive(){var t=this.option.progressive;return null==t?this.option.large?1e4:this.get("progressive"):t;},getProgressiveThreshold:function getProgressiveThreshold(){var t=this.option.progressiveThreshold;return null==t?this.option.large?2e4:this.get("progressiveThreshold"):t;},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}}});function PS(t,e,i){Si.call(this),this.add(this.createLine(t,e,i)),this._updateEffectSymbol(t,e);}var NS=PS.prototype;function OS(t,e,i){Si.call(this),this._createPolyline(t,e,i);}NS.createLine=function(t,e,i){return new E_(t,e,i);},NS._updateEffectSymbol=function(t,e){var i=t.getItemModel(e).getModel("effect"),n=i.get("symbolSize"),a=i.get("symbol");k(n)||(n=[n,n]);var o=i.get("color")||t.getItemVisual(e,"color"),r=this.childAt(1);this._symbolType!==a&&(this.remove(r),(r=Jp(a,-.5,-.5,1,1,o)).z2=100,r.culling=!0,this.add(r)),r&&(r.setStyle("shadowColor",o),r.setStyle(i.getItemStyle(["color"])),r.attr("scale",n),r.setColor(o),r.attr("scale",n),this._symbolType=a,this._updateEffectAnimation(t,i,e));},NS._updateEffectAnimation=function(e,t,i){var n=this.childAt(1);if(n){var a=this,o=e.getItemLayout(i),r=1e3*t.get("period"),s=t.get("loop"),l=t.get("constantSpeed"),u=W(t.get("delay"),function(t){return t/e.count()*r/3;}),h="function"==typeof u;if(n.ignore=!0,this.updateAnimationPoints(n,o),0<l&&(r=this.getLineLength(n)/l*1e3),r!==this._period||s!==this._loop){n.stopAnimation();var c=u;h&&(c=u(i)),0<n.__t&&(c=-r*n.__t),n.__t=0;var d=n.animate("",s).when(r,{__t:1}).delay(c).during(function(){a.updateSymbolPosition(n);});s||d.done(function(){a.remove(n);}),d.start();}this._period=r,this._loop=s;}},NS.getLineLength=function(t){return yt(t.__p1,t.__cp1)+yt(t.__cp1,t.__p2);},NS.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];},NS.updateData=function(t,e,i){this.childAt(0).updateData(t,e,i),this._updateEffectSymbol(t,e);},NS.updateSymbolPosition=function(t){var e=t.__p1,i=t.__p2,n=t.__cp1,a=t.__t,o=t.position,r=fo,s=po;o[0]=r(e[0],n[0],i[0],a),o[1]=r(e[1],n[1],i[1],a);var l=s(e[0],n[0],i[0],a),u=s(e[1],n[1],i[1],a);t.rotation=-Math.atan2(u,l)-Math.PI/2,t.ignore=!1;},NS.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var i=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,i,e);},w(PS,Si);var ES=OS.prototype;function RS(t,e,i){PS.call(this,t,e,i),this._lastFrame=0,this._lastFramePercent=0;}ES._createPolyline=function(t,e,i){var n=t.getItemLayout(e),a=new zr({shape:{points:n}});this.add(a),this._updateCommonStl(t,e,i);},ES.updateData=function(t,e,i){var n=t.hostModel;js(this.childAt(0),{shape:{points:t.getItemLayout(e)}},n,e),this._updateCommonStl(t,e,i);},ES._updateCommonStl=function(t,e,i){var n=this.childAt(0),a=t.getItemModel(e),o=t.getItemVisual(e,"color"),r=i&&i.lineStyle,s=i&&i.hoverLineStyle;i&&!t.hasItemOption||(r=a.getModel("lineStyle").getLineStyle(),s=a.getModel("emphasis.lineStyle").getLineStyle()),n.useStyle(C({strokeNoScale:!0,fill:"none",stroke:o},r)),n.hoverStyle=s,Os(this);},ES.updateLayout=function(t,e){this.childAt(0).setShape("points",t.getItemLayout(e));},w(OS,Si);var zS=RS.prototype;zS.createLine=function(t,e,i){return new OS(t,e,i);},zS.updateAnimationPoints=function(t,e){this._points=e;for(var i=[0],n=0,a=1;a<e.length;a++){var o=e[a-1],r=e[a];n+=yt(o,r),i.push(n);}if(0!==n){for(a=0;a<i.length;a++){i[a]/=n;}this._offsets=i,this._length=n;}},zS.getLineLength=function(t){return this._length;},zS.updateSymbolPosition=function(t){var e=t.__t,i=this._points,n=this._offsets,a=i.length;if(n){var o=this._lastFrame;if(e<this._lastFramePercent){for(r=Math.min(o+1,a-1);0<=r&&!(n[r]<=e);r--){;}r=Math.min(r,a-2);}else{for(var r=o;r<a&&!(n[r]>e);r++){;}r=Math.min(r-1,a-2);}wt(t.position,i[r],i[r+1],(e-n[r])/(n[r+1]-n[r]));var s=i[r+1][0]-i[r][0],l=i[r+1][1]-i[r][1];t.rotation=-Math.atan2(l,s)-Math.PI/2,this._lastFrame=r,this._lastFramePercent=e,t.ignore=!1;}},w(RS,PS);var BS=ds({shape:{polyline:!1,curveness:0,segs:[]},buildPath:function buildPath(t,e){var i=e.segs,n=e.curveness;if(e.polyline)for(var a=0;a<i.length;){var o=i[a++];if(0<o){t.moveTo(i[a++],i[a++]);for(var r=1;r<o;r++){t.lineTo(i[a++],i[a++]);}}}else for(a=0;a<i.length;){var s=i[a++],l=i[a++],u=i[a++],h=i[a++];if(t.moveTo(s,l),0<n){var c=(s+u)/2-(l-h)*n,d=(l+h)/2-(u-s)*n;t.quadraticCurveTo(c,d,u,h);}else t.lineTo(u,h);}},findDataIndex:function findDataIndex(t,e){var i=this.shape,n=i.segs,a=i.curveness;if(i.polyline)for(var o=0,r=0;r<n.length;){var s=n[r++];if(0<s)for(var l=n[r++],u=n[r++],h=1;h<s;h++){if(Zo(l,u,c=n[r++],d=n[r++]))return o;}o++;}else for(o=0,r=0;r<n.length;){l=n[r++],u=n[r++];var c=n[r++],d=n[r++];if(0<a){if(Xo(l,u,(l+c)/2-(u-d)*a,(u+d)/2-(c-l)*a,c,d))return o;}else if(Zo(l,u,c,d))return o;o++;}return-1;}});function VS(){this.group=new Si();}var GS=VS.prototype;GS.isPersistent=function(){return!this._incremental;},GS.updateData=function(t){this.group.removeAll();var e=new BS({rectHover:!0,cursor:"default"});e.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(e,t),this.group.add(e),this._incremental=null;},GS.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),5e5<t.count()?(this._incremental||(this._incremental=new ts({silent:!0})),this.group.add(this._incremental)):this._incremental=null;},GS.incrementalUpdate=function(t,e){var i=new BS();i.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(i,e,!!this._incremental),this._incremental?this._incremental.addDisplayable(i,!0):(i.rectHover=!0,i.cursor="default",i.__startIndex=t.start,this.group.add(i));},GS.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll();},GS._setCommon=function(i,t,e){var n=t.hostModel;i.setShape({polyline:n.get("polyline"),curveness:n.get("lineStyle.curveness")}),i.useStyle(n.getModel("lineStyle").getLineStyle()),i.style.strokeNoScale=!0;var a=t.getVisual("color");a&&i.setStyle("stroke",a),i.setStyle("fill"),e||(i.seriesIndex=n.seriesIndex,i.on("mousemove",function(t){i.dataIndex=null;var e=i.findDataIndex(t.offsetX,t.offsetY);0<e&&(i.dataIndex=e+i.__startIndex);}));},GS._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles();};var FS={seriesType:"lines",plan:Jh(),reset:function reset(g){var m=g.coordinateSystem,v=g.get("polyline"),y=g.pipelineContext.large;return{progress:function progress(t,e){var i=[];if(y){var n,a=t.end-t.start;if(v){for(var o=0,r=t.start;r<t.end;r++){o+=g.getLineCoordsCount(r);}n=new Float32Array(a+2*o);}else n=new Float32Array(4*a);var s=0,l=[];for(r=t.start;r<t.end;r++){var u=g.getLineCoords(r,i);v&&(n[s++]=u);for(var h=0;h<u;h++){l=m.dataToPoint(i[h],!1,l),n[s++]=l[0],n[s++]=l[1];}}e.setLayout("linesPoints",n);}else for(r=t.start;r<t.end;r++){var c=e.getItemModel(r),d=(u=g.getLineCoords(r,i),[]);if(v)for(var f=0;f<u;f++){d.push(m.dataToPoint(i[f]));}else{d[0]=m.dataToPoint(i[0]),d[1]=m.dataToPoint(i[1]);var p=c.get("lineStyle.curveness");+p&&(d[2]=[(d[0][0]+d[1][0])/2-(d[0][1]-d[1][1])*p,(d[0][1]+d[1][1])/2-(d[1][0]-d[0][0])*p]);}e.setItemLayout(r,d);}}};}};function WS(t){return t instanceof Array||(t=[t,t]),t;}hf({type:"lines",init:function init(){},render:function render(t,e,i){var n=t.getData(),a=this._updateLineDraw(n,t),o=t.get("zlevel"),r=t.get("effect.trailLength"),s=i.getZr(),l="svg"===s.painter.getType();l||s.painter.getLayer(o).clear(!0),null==this._lastZlevel||l||s.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(t)&&r&&(l||s.configLayer(o,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(r/10+.9,1),0)})),a.updateData(n);var u=t.get("clip",!0)&&tm(t.coordinateSystem,!1,t);u?this.group.setClipPath(u):this.group.removeClipPath(),this._lastZlevel=o,this._finished=!0;},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){var n=t.getData();this._updateLineDraw(n,t).incrementalPrepareUpdate(n),this._clearLayer(i),this._finished=!1;},incrementalRender:function incrementalRender(t,e,i){this._lineDraw.incrementalUpdate(t,e.getData()),this._finished=t.end===e.getData().count();},updateTransform:function updateTransform(t,e,i){var n=t.getData(),a=t.pipelineContext;if(!this._finished||a.large||a.progressiveRender)return{update:!0};var o=FS.reset(t);o.progress&&o.progress({start:0,end:n.count()},n),this._lineDraw.updateLayout(),this._clearLayer(i);},_updateLineDraw:function _updateLineDraw(t,e){var i=this._lineDraw,n=this._showEffect(e),a=!!e.get("polyline"),o=e.pipelineContext.large;return i&&n===this._hasEffet&&a===this._isPolyline&&o===this._isLargeDraw||(i&&i.remove(),i=this._lineDraw=o?new VS():new z_(a?n?RS:OS:n?PS:E_),this._hasEffet=n,this._isPolyline=a,this._isLargeDraw=o,this.group.removeAll()),this.group.add(i.group),i;},_showEffect:function _showEffect(t){return!!t.get("effect.show");},_clearLayer:function _clearLayer(t){var e=t.getZr();"svg"===e.painter.getType()||null==this._lastZlevel||e.painter.getLayer(this._lastZlevel).clear(!0);},remove:function remove(t,e){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(e);},dispose:function dispose(){}});var HS="lineStyle.opacity".split("."),ZS={seriesType:"lines",reset:function reset(t,e,i){var n=WS(t.get("symbol")),a=WS(t.get("symbolSize")),o=t.getData();return o.setVisual("fromSymbol",n&&n[0]),o.setVisual("toSymbol",n&&n[1]),o.setVisual("fromSymbolSize",a&&a[0]),o.setVisual("toSymbolSize",a&&a[1]),o.setVisual("opacity",t.get(HS)),{dataEach:o.hasItemOption?function(t,e){var i=t.getItemModel(e),n=WS(i.getShallow("symbol",!0)),a=WS(i.getShallow("symbolSize",!0)),o=i.get(HS);n[0]&&t.setItemVisual(e,"fromSymbol",n[0]),n[1]&&t.setItemVisual(e,"toSymbol",n[1]),a[0]&&t.setItemVisual(e,"fromSymbolSize",a[0]),a[1]&&t.setItemVisual(e,"toSymbolSize",a[1]),t.setItemVisual(e,"opacity",o);}:null};}};nf(FS),af(ZS),Wh.extend({type:"series.heatmap",getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this,{generateCoord:"value"});},preventIncremental:function preventIncremental(){var t=Hu.get(this.get("coordinateSystem"));if(t&&t.dimensions)return"lng"===t.dimensions[0]&&"lat"===t.dimensions[1];},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}});function US(){var t=g();this.canvas=t,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={};}US.prototype={update:function update(t,e,i,n,a,o){var r=this._getBrush(),s=this._getGradient(t,a,"inRange"),l=this._getGradient(t,a,"outOfRange"),u=this.pointSize+this.blurSize,h=this.canvas,c=h.getContext("2d"),d=t.length;h.width=e,h.height=i;for(var f=0;f<d;++f){var p=t[f],g=p[0],m=p[1],v=n(p[2]);c.globalAlpha=v,c.drawImage(r,g-u,m-u);}if(!h.width||!h.height)return h;for(var y=c.getImageData(0,0,h.width,h.height),x=y.data,_=0,w=x.length,b=this.minOpacity,S=this.maxOpacity-b;_<w;){v=x[_+3]/256;var M=4*Math.floor(255*v);if(0<v){var I=o(v)?s:l;0<v&&(v=v*S+b),x[_++]=I[M],x[_++]=I[1+M],x[_++]=I[2+M],x[_++]=I[3+M]*v*256;}else _+=4;}return c.putImageData(y,0,0),h;},_getBrush:function _getBrush(){var t=this._brushCanvas||(this._brushCanvas=g()),e=this.pointSize+this.blurSize,i=2*e;t.width=i,t.height=i;var n=t.getContext("2d");return n.clearRect(0,0,i,i),n.shadowOffsetX=i,n.shadowBlur=this.blurSize,n.shadowColor="#000",n.beginPath(),n.arc(-e,e,this.pointSize,0,2*Math.PI,!0),n.closePath(),n.fill(),t;},_getGradient:function _getGradient(t,e,i){for(var n=this._gradientPixels,a=n[i]||(n[i]=new Uint8ClampedArray(1024)),o=[0,0,0,0],r=0,s=0;s<256;s++){e[i](s/255,!0,o),a[r++]=o[0],a[r++]=o[1],a[r++]=o[2],a[r++]=o[3];}return a;}},hf({type:"heatmap",render:function render(i,t,e){var n;t.eachComponent("visualMap",function(e){e.eachTargetSeries(function(t){t===i&&(n=e);});}),this.group.removeAll(),this._incrementalDisplayable=null;var a=i.coordinateSystem;"cartesian2d"===a.type||"calendar"===a.type?this._renderOnCartesianAndCalendar(i,e,0,i.getData().count()):function(t){var e=t.dimensions;return"lng"===e[0]&&"lat"===e[1];}(a)&&this._renderOnGeo(a,i,n,e);},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){this.group.removeAll();},incrementalRender:function incrementalRender(t,e,i,n){e.coordinateSystem&&this._renderOnCartesianAndCalendar(e,n,t.start,t.end,!0);},_renderOnCartesianAndCalendar:function _renderOnCartesianAndCalendar(t,e,i,n,a){var o,r,s=t.coordinateSystem;if("cartesian2d"===s.type){var l=s.getAxis("x"),u=s.getAxis("y");o=l.getBandWidth(),r=u.getBandWidth();}for(var h=this.group,c=t.getData(),d="emphasis.itemStyle",f="emphasis.label",p=t.getModel("itemStyle").getItemStyle(["color"]),g=t.getModel(d).getItemStyle(),m=t.getModel("label"),v=t.getModel(f),y=s.type,x="cartesian2d"===y?[c.mapDimension("x"),c.mapDimension("y"),c.mapDimension("value")]:[c.mapDimension("time"),c.mapDimension("value")],_=i;_<n;_++){var w;if("cartesian2d"===y){if(isNaN(c.get(x[2],_)))continue;var b=s.dataToPoint([c.get(x[0],_),c.get(x[1],_)]);w=new Hr({shape:{x:b[0]-o/2,y:b[1]-r/2,width:o,height:r},style:{fill:c.getItemVisual(_,"color"),opacity:c.getItemVisual(_,"opacity")}});}else{if(isNaN(c.get(x[1],_)))continue;w=new Hr({z2:1,shape:s.dataToRect([c.get(x[0],_)]).contentShape,style:{fill:c.getItemVisual(_,"color"),opacity:c.getItemVisual(_,"opacity")}});}var S=c.getItemModel(_);c.hasItemOption&&(p=S.getModel("itemStyle").getItemStyle(["color"]),g=S.getModel(d).getItemStyle(),m=S.getModel("label"),v=S.getModel(f));var M=t.getRawValue(_),I="-";M&&null!=M[2]&&(I=M[2]),Bs(p,g,m,v,{labelFetcher:t,labelDataIndex:_,defaultText:I,isRectText:!0}),w.setStyle(p),Os(w,c.hasItemOption?g:L({},g)),(w.incremental=a)&&(w.useHoverLayer=!0),h.add(w),c.setItemGraphicEl(_,w);}},_renderOnGeo:function _renderOnGeo(a,t,e,i){var n=e.targetVisuals.inRange,o=e.targetVisuals.outOfRange,r=t.getData(),s=this._hmLayer||this._hmLayer||new US();s.blurSize=t.get("blurSize"),s.pointSize=t.get("pointSize"),s.minOpacity=t.get("minOpacity"),s.maxOpacity=t.get("maxOpacity");var l=a.getViewRect().clone(),u=a.getRoamTransform();l.applyTransform(u);var h=Math.max(l.x,0),c=Math.max(l.y,0),d=Math.min(l.width+l.x,i.getWidth()),f=Math.min(l.height+l.y,i.getHeight()),p=d-h,g=f-c,m=[r.mapDimension("lng"),r.mapDimension("lat"),r.mapDimension("value")],v=r.mapArray(m,function(t,e,i){var n=a.dataToPoint([t,e]);return n[0]-=h,n[1]-=c,n.push(i),n;}),y=e.getExtent(),x="visualMap.continuous"===e.type?function(t,e){var i=t[1]-t[0];return e=[(e[0]-t[0])/i,(e[1]-t[0])/i],function(t){return t>=e[0]&&t<=e[1];};}(y,e.option.range):function(e,n,a){var i=e[1]-e[0],o=(n=N(n,function(t){return{interval:[(t.interval[0]-e[0])/i,(t.interval[1]-e[0])/i]};})).length,r=0;return function(t){for(var e=r;e<o;e++){if((i=n[e].interval)[0]<=t&&t<=i[1]){r=e;break;}}if(e===o)for(e=r-1;0<=e;e--){var i;if((i=n[e].interval)[0]<=t&&t<=i[1]){r=e;break;}}return 0<=e&&e<o&&a[e];};}(y,e.getPieceList(),e.option.selected);s.update(v,p,g,n.color.getNormalizer(),{inRange:n.color.getColorMapper(),outOfRange:o.color.getColorMapper()},x);var _=new Yn({style:{width:p,height:g,x:h,y:c,image:s.canvas},silent:!0});this.group.add(_);},dispose:function dispose(){}});var XS=Qm.extend({type:"series.pictorialBar",dependencies:["grid"],defaultOption:{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,hoverAnimation:!1},getInitialData:function getInitialData(t){return t.stack=null,XS.superApply(this,"getInitialData",arguments);}}),YS=["itemStyle","borderWidth"],jS=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],qS=new Lr();hf({type:"pictorialBar",render:function render(t,e,i){var r=this.group,s=t.getData(),l=this._data,n=t.coordinateSystem,a=!!n.getBaseAxis().isHorizontal(),o=n.grid.getRect(),u={ecSize:{width:i.getWidth(),height:i.getHeight()},seriesModel:t,coordSys:n,coordSysExtent:[[o.x,o.x+o.width],[o.y,o.y+o.height]],isHorizontal:a,valueDim:jS[+a],categoryDim:jS[1-a]};return s.diff(l).add(function(t){if(s.hasValue(t)){var e=nM(s,t),i=KS(s,t,e,u),n=sM(s,u,i);s.setItemGraphicEl(t,n),r.add(n),dM(n,u,i);}}).update(function(t,e){var i=l.getItemGraphicEl(e);if(s.hasValue(t)){var n=nM(s,t),a=KS(s,t,n,u),o=uM(s,a);i&&o!==i.__pictorialShapeStr&&(r.remove(i),s.setItemGraphicEl(t,null),i=null),i?function(t,e,i){var n=i.animationModel,a=i.dataIndex;js(t.__pictorialBundle,{position:i.bundlePosition.slice()},n,a),i.symbolRepeat?QS(t,e,i,!0):tM(t,e,i,!0);eM(t,i,!0),iM(t,e,i,!0);}(i,u,a):i=sM(s,u,a,!0),s.setItemGraphicEl(t,i),i.__pictorialSymbolMeta=a,r.add(i),dM(i,u,a);}else r.remove(i);}).remove(function(t){var e=l.getItemGraphicEl(t);e&&lM(l,t,e.__pictorialSymbolMeta.animationModel,e);}).execute(),this._data=s,this.group;},dispose:et,remove:function remove(e,t){var i=this.group,n=this._data;e.get("animation")?n&&n.eachItemGraphicEl(function(t){lM(n,t.dataIndex,e,t);}):i.removeAll();}});function KS(t,e,i,n){var a=t.getItemLayout(e),o=i.get("symbolRepeat"),r=i.get("symbolClip"),s=i.get("symbolPosition")||"start",l=(i.get("symbolRotate")||0)*Math.PI/180||0,u=i.get("symbolPatternSize")||2,h=i.isAnimationEnabled(),c={dataIndex:e,layout:a,itemModel:i,symbolType:t.getItemVisual(e,"symbol")||"circle",color:t.getItemVisual(e,"color"),symbolClip:r,symbolRepeat:o,symbolRepeatDirection:i.get("symbolRepeatDirection"),symbolPatternSize:u,rotation:l,animationModel:h?i:null,hoverAnimation:h&&i.get("hoverAnimation"),z2:i.getShallow("z",!0)||0};!function(t,e,i,n,a){var o,r=n.valueDim,s=t.get("symbolBoundingData"),l=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),u=l.toGlobalCoord(l.dataToCoord(0)),h=1-+(i[r.wh]<=0);if(k(s)){var c=[$S(l,s[0])-u,$S(l,s[1])-u];c[1]<c[0]&&c.reverse(),o=c[h];}else o=null!=s?$S(l,s)-u:e?n.coordSysExtent[r.index][h]-u:i[r.wh];a.boundingLength=o,e&&(a.repeatCutLength=i[r.wh]);a.pxSign=0<o?1:o<0?-1:0;}(i,o,a,n,c),function(t,e,i,n,a,o,r,s,l,u){var h=l.valueDim,c=l.categoryDim,d=Math.abs(i[c.wh]),f=t.getItemVisual(e,"symbolSize");f=k(f)?f.slice():(null==f&&(f="100%"),[f,f]);f[c.index]=xl(f[c.index],d),f[h.index]=xl(f[h.index],n?d:Math.abs(o)),u.symbolSize=f,(u.symbolScale=[f[0]/s,f[1]/s])[h.index]*=(l.isHorizontal?-1:1)*r;}(t,e,a,o,0,c.boundingLength,c.pxSign,u,n,c),function(t,e,i,n,a){var o=t.get(YS)||0;o&&(qS.attr({scale:e.slice(),rotation:i}),qS.updateTransform(),o/=qS.getLineScale(),o*=e[n.valueDim.index]);a.valueLineWidth=o;}(i,c.symbolScale,l,n,c);var d=c.symbolSize,f=i.get("symbolOffset");return k(f)&&(f=[xl(f[0],d[0]),xl(f[1],d[1])]),function(t,e,i,n,a,o,r,s,l,u,h,c){var d=h.categoryDim,f=h.valueDim,p=c.pxSign,g=Math.max(e[f.index]+s,0),m=g;if(n){var v=Math.abs(l),y=W(t.get("symbolMargin"),"15%")+"",x=!1;y.lastIndexOf("!")===y.length-1&&(x=!0,y=y.slice(0,y.length-1)),y=xl(y,e[f.index]);var _=Math.max(g+2*y,0),w=x?0:2*y,b=El(n),S=b?n:fM((v+w)/_);_=g+2*(y=(v-S*g)/2/(x?S:S-1)),w=x?0:2*y,b||"fixed"===n||(S=u?fM((Math.abs(u)+w)/_):0),m=S*_-w,c.repeatTimes=S,c.symbolMargin=y;}var M=p*(m/2),I=c.pathPosition=[];I[d.index]=i[d.wh]/2,I[f.index]="start"===r?M:"end"===r?l-M:l/2,o&&(I[0]+=o[0],I[1]+=o[1]);var A=c.bundlePosition=[];A[d.index]=i[d.xy],A[f.index]=i[f.xy];var T=c.barRectShape=L({},i);T[f.wh]=p*Math.max(Math.abs(i[f.wh]),Math.abs(I[f.index]+M)),T[d.wh]=i[d.wh];var D=c.clipShape={};D[d.xy]=-i[d.xy],D[d.wh]=h.ecSize[d.wh],D[f.xy]=0,D[f.wh]=i[f.wh];}(i,d,a,o,0,f,s,c.valueLineWidth,c.boundingLength,c.repeatCutLength,n,c),c;}function $S(t,e){return t.toGlobalCoord(t.dataToCoord(t.scale.parse(e)));}function JS(t){var e=t.symbolPatternSize,i=Jp(t.symbolType,-e/2,-e/2,e,e,t.color);return i.attr({culling:!0}),"image"!==i.type&&i.setStyle({strokeNoScale:!0}),i;}function QS(t,e,a,i){var n=t.__pictorialBundle,o=a.symbolSize,r=a.valueLineWidth,s=a.pathPosition,l=e.valueDim,u=a.repeatTimes||0,h=0,c=o[e.valueDim.index]+r+2*a.symbolMargin;for(hM(t,function(t){t.__pictorialAnimationIndex=h,t.__pictorialRepeatTimes=u,h<u?cM(t,null,p(h),a,i):cM(t,null,{scale:[0,0]},a,i,function(){n.remove(t);}),rM(t,a),h++;});h<u;h++){var d=JS(a);d.__pictorialAnimationIndex=h,d.__pictorialRepeatTimes=u,n.add(d);var f=p(h);cM(d,{position:f.position,scale:[0,0]},{scale:f.scale,rotation:f.rotation},a,i),d.on("mouseover",g).on("mouseout",m),rM(d,a);}function p(t){var e=s.slice(),i=a.pxSign,n=t;return("start"===a.symbolRepeatDirection?0<i:i<0)&&(n=u-1-t),e[l.index]=c*(n-u/2+.5)+s[l.index],{position:e,scale:a.symbolScale.slice(),rotation:a.rotation};}function g(){hM(t,function(t){t.trigger("emphasis");});}function m(){hM(t,function(t){t.trigger("normal");});}}function tM(t,e,i,n){var a=t.__pictorialBundle,o=t.__pictorialMainPath;o?cM(o,null,{position:i.pathPosition.slice(),scale:i.symbolScale.slice(),rotation:i.rotation},i,n):(o=t.__pictorialMainPath=JS(i),a.add(o),cM(o,{position:i.pathPosition.slice(),scale:[0,0],rotation:i.rotation},{scale:i.symbolScale.slice()},i,n),o.on("mouseover",function(){this.trigger("emphasis");}).on("mouseout",function(){this.trigger("normal");})),rM(o,i);}function eM(t,e,i){var n=L({},e.barRectShape),a=t.__pictorialBarRect;a?cM(a,null,{shape:n},e,i):(a=t.__pictorialBarRect=new Hr({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),t.add(a));}function iM(t,e,i,n){if(i.symbolClip){var a=t.__pictorialClipPath,o=L({},i.clipShape),r=e.valueDim,s=i.animationModel,l=i.dataIndex;if(a)js(a,{shape:o},s,l);else{o[r.wh]=0,a=new Hr({shape:o}),t.__pictorialBundle.setClipPath(a),t.__pictorialClipPath=a;var u={};u[r.wh]=i.clipShape[r.wh],ol[n?"updateProps":"initProps"](a,{shape:u},s,l);}}}function nM(t,e){var i=t.getItemModel(e);return i.getAnimationDelayParams=aM,i.isAnimationEnabled=oM,i;}function aM(t){return{index:t.__pictorialAnimationIndex,count:t.__pictorialRepeatTimes};}function oM(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation");}function rM(t,e){t.off("emphasis").off("normal");var i=e.symbolScale.slice();e.hoverAnimation&&t.on("emphasis",function(){this.animateTo({scale:[1.1*i[0],1.1*i[1]]},400,"elasticOut");}).on("normal",function(){this.animateTo({scale:i.slice()},400,"elasticOut");});}function sM(t,e,i,n){var a=new Si(),o=new Si();return a.add(o),(a.__pictorialBundle=o).attr("position",i.bundlePosition.slice()),i.symbolRepeat?QS(a,e,i):tM(a,0,i),eM(a,i,n),iM(a,e,i,n),a.__pictorialShapeStr=uM(t,i),a.__pictorialSymbolMeta=i,a;}function lM(t,e,i,n){var a=n.__pictorialBarRect;a&&(a.style.text=null);var o=[];hM(n,function(t){o.push(t);}),n.__pictorialMainPath&&o.push(n.__pictorialMainPath),n.__pictorialClipPath&&(i=null),E(o,function(t){js(t,{scale:[0,0]},i,e,function(){n.parent&&n.parent.remove(n);});}),t.setItemGraphicEl(e,null);}function uM(t,e){return[t.getItemVisual(e.dataIndex,"symbol")||"none",!!e.symbolRepeat,!!e.symbolClip].join(":");}function hM(e,i,n){E(e.__pictorialBundle.children(),function(t){t!==e.__pictorialBarRect&&i.call(n,t);});}function cM(t,e,i,n,a,o){e&&t.attr(e),n.symbolClip&&!a?i&&t.attr(i):i&&ol[a?"updateProps":"initProps"](t,i,n.animationModel,n.dataIndex,o);}function dM(t,e,i){var n=i.color,a=i.dataIndex,o=i.itemModel,r=o.getModel("itemStyle").getItemStyle(["color"]),s=o.getModel("emphasis.itemStyle").getItemStyle(),l=o.getShallow("cursor");hM(t,function(t){t.setColor(n),t.setStyle(C({fill:n,opacity:i.opacity},r)),Os(t,s),l&&(t.cursor=l),t.z2=i.z2;});var u={},h=(e.valueDim.posDesc[+(0<i.boundingLength)],t.__pictorialBarRect);tv(h.style,u,o,n,e.seriesModel,a),Os(h,u);}function fM(t){var e=Math.round(t);return Math.abs(t-e)<1e-4?e:Math.ceil(t);}nf(A(pp,"pictorialBar")),af(rm("pictorialBar","roundRect"));function pM(t,e,i,n,a){vg.call(this,t,e,i),this.type=n||"value",this.position=a||"bottom",this.orient=null;}function gM(t,e,i){this.dimension="single",this.dimensions=["single"],this._axis=null,this._rect,this._init(t,e,i),this.model=t;}function mM(t,e){e=e||{};var i=t.coordinateSystem,n=t.axis,a={},o=n.position,r=n.orient,s=i.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],u={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};a.position=["vertical"===r?u.vertical[o]:l[0],"horizontal"===r?u.horizontal[o]:l[3]];a.rotation=Math.PI/2*{horizontal:0,vertical:1}[r];a.labelDirection=a.tickDirection=a.nameDirection={top:-1,bottom:1,right:1,left:-1}[o],t.get("axisTick.inside")&&(a.tickDirection=-a.tickDirection),W(e.labelInside,t.get("axisLabel.inside"))&&(a.labelDirection=-a.labelDirection);var h=e.rotate;return null==h&&(h=t.get("axisLabel.rotate")),a.labelRotation="top"===o?-h:h,a.z2=1,a;}pM.prototype={constructor:pM,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},pointToData:function pointToData(t,e){return this.coordinateSystem.pointToData(t,e)[0];},toGlobalCoord:null,toLocalCoord:null},w(pM,vg),Hu.register("single",{create:function create(n,a){var o=[];return n.eachComponent("singleAxis",function(t,e){var i=new gM(t,n,a);i.name="single_"+e,i.resize(t,a),t.coordinateSystem=i,o.push(i);}),n.eachSeries(function(t){if("singleAxis"===t.get("coordinateSystem")){var e=n.queryComponents({mainType:"singleAxis",index:t.get("singleAxisIndex"),id:t.get("singleAxisId")})[0];t.coordinateSystem=e&&e.coordinateSystem;}}),o;},dimensions:(gM.prototype={type:"singleAxis",axisPointerEnabled:!0,constructor:gM,_init:function _init(t,e,i){var n=this.dimension,a=new pM(n,Bp(t),[0,0],t.get("type"),t.get("position")),o="category"===a.type;a.onBand=o&&t.get("boundaryGap"),a.inverse=t.get("inverse"),a.orient=t.get("orient"),(t.axis=a).model=t,(a.coordinateSystem=this)._axis=a;},update:function update(t,e){t.eachSeries(function(t){if(t.coordinateSystem===this){var e=t.getData();E(e.mapDimension(this.dimension,!0),function(t){this._axis.scale.unionExtentFromData(e,t);},this),zp(this._axis.scale,this._axis.model);}},this);},resize:function resize(t,e){this._rect=au({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis();},getRect:function getRect(){return this._rect;},_adjustAxis:function _adjustAxis(){var t=this._rect,e=this._axis,i=e.isHorizontal(),n=i?[0,t.width]:[0,t.height],a=e.reverse?1:0;e.setExtent(n[a],n[1-a]),this._updateAxisTransform(e,i?t.x:t.y);},_updateAxisTransform:function _updateAxisTransform(t,e){var i=t.getExtent(),n=i[0]+i[1],a=t.isHorizontal();t.toGlobalCoord=a?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord=a?function(t){return t-e;}:function(t){return n-t+e;};},getAxis:function getAxis(){return this._axis;},getBaseAxis:function getBaseAxis(){return this._axis;},getAxes:function getAxes(){return[this._axis];},getTooltipAxes:function getTooltipAxes(){return{baseAxes:[this.getAxis()]};},containPoint:function containPoint(t){var e=this.getRect(),i=this.getAxis();return"horizontal"===i.orient?i.contain(i.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:i.contain(i.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height;},pointToData:function pointToData(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))];},dataToPoint:function dataToPoint(t){var e=this.getAxis(),i=this.getRect(),n=[],a="horizontal"===e.orient?0:1;return t instanceof Array&&(t=t[0]),n[a]=e.toGlobalCoord(e.dataToCoord(+t)),n[1-a]=0==a?i.y+i.height/2:i.x+i.width/2,n;}}).dimensions});var vM=["axisLine","axisTickLabel","axisName"],yM="splitLine",xM=Um.extend({type:"singleAxis",axisPointerClass:"SingleAxisPointer",render:function render(t,e,i,n){var a=this.group;a.removeAll();var o=mM(t),r=new Cm(t,o);E(vM,r.add,r),a.add(r.getGroup()),t.get(yM+".show")&&this["_"+yM](t),xM.superCall(this,"render",t,e,i,n);},_splitLine:function _splitLine(t){var e=t.axis;if(!e.scale.isBlank()){var i=t.getModel("splitLine"),n=i.getModel("lineStyle"),a=n.get("width"),o=n.get("color");o=o instanceof Array?o:[o];for(var r=t.coordinateSystem.getRect(),s=e.isHorizontal(),l=[],u=0,h=e.getTicksCoords({tickModel:i}),c=[],d=[],f=0;f<h.length;++f){var p=e.toGlobalCoord(h[f].coord);s?(c[0]=p,c[1]=r.y,d[0]=p,d[1]=r.y+r.height):(c[0]=r.x,c[1]=p,d[0]=r.x+r.width,d[1]=p);var g=u++%o.length;l[g]=l[g]||[],l[g].push(new Ur({subPixelOptimize:!0,shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:{lineWidth:a},silent:!0}));}for(f=0;f<l.length;++f){this.group.add(ys(l[f],{style:{stroke:o[f%o.length],lineDash:n.getLineDash(a),lineWidth:a},silent:!0}));}}}}),_M=fu.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null,getCoordSysModel:function getCoordSysModel(){return this;}});m(_M.prototype,Hp),mm("single",_M,function(t,e){return e.type||(e.data?"category":"value");},{left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}});function wM(t,e){var i,n=[],a=t.seriesIndex;if(null==a||!(i=e.getSeriesByIndex(a)))return{point:[]};var o=i.getData(),r=Ca(o,t);if(null==r||r<0||k(r))return{point:[]};var s=o.getItemGraphicEl(r),l=i.coordinateSystem;if(i.getTooltipPosition)n=i.getTooltipPosition(r)||[];else if(l&&l.dataToPoint)n=l.dataToPoint(o.getValues(N(l.dimensions,function(t){return o.mapDimension(t);}),r,!0))||[];else if(s){var u=s.getBoundingRect().clone();u.applyTransform(s.transform),n=[u.x+u.width/2,u.y+u.height/2];}return{point:n,el:s};}var bM=E,SM=A,MM=La();function IM(t,e,i,n,a){var o=t.axis;if(!o.scale.isBlank()&&o.containData(e))if(t.involveSeries){var r=function(l,t){var u=t.axis,h=u.dim,c=l,d=[],f=Number.MAX_VALUE,p=-1;return bM(t.seriesModels,function(e,t){var i,n,a=e.getData().mapDimension(h,!0);if(e.getAxisTooltipData){var o=e.getAxisTooltipData(a,l,u);n=o.dataIndices,i=o.nestestValue;}else{if(!(n=e.getData().indicesOfNearest(a[0],l,"category"===u.type?.5:null)).length)return;i=e.getData().get(a[0],n[0]);}if(null!=i&&isFinite(i)){var r=l-i,s=Math.abs(r);s<=f&&((s<f||0<=r&&p<0)&&(f=s,p=r,c=i,d.length=0),bM(n,function(t){d.push({seriesIndex:e.seriesIndex,dataIndexInside:t,dataIndex:e.getData().getRawIndex(t)});}));}}),{payloadBatch:d,snapToValue:c};}(e,t),s=r.payloadBatch,l=r.snapToValue;s[0]&&null==a.seriesIndex&&L(a,s[0]),!n&&t.snap&&o.containData(l)&&null!=l&&(e=l),i.showPointer(t,e,s,a),i.showTooltip(t,r,l);}else i.showPointer(t,e);}function AM(t,e,i,n){t[e.key]={value:i,payloadBatch:n};}function TM(t,e,i,n){var a=i.payloadBatch,o=e.axis,r=o.model,s=e.axisPointerModel;if(e.triggerTooltip&&a.length){var l=e.coordSys.model,u=Zm(l),h=t.map[u];h||(h=t.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},t.list.push(h)),h.dataByAxis.push({axisDim:o.dim,axisIndex:r.componentIndex,axisType:r.type,axisId:r.id,value:n,valueLabelOpt:{precision:s.get("label.precision"),formatter:s.get("label.formatter")},seriesDataIndices:a.slice()});}}function DM(t){var e=t.axis.model,i={},n=i.axisDim=t.axis.dim;return i.axisIndex=i[n+"AxisIndex"]=e.componentIndex,i.axisName=i[n+"AxisName"]=e.name,i.axisId=i[n+"AxisId"]=e.id,i;}function CM(t){return!t||null==t[0]||isNaN(t[0])||null==t[1]||isNaN(t[1]);}sf({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}});var LM=La(),kM=E;function PM(t,e,i){if(!v.node){var n=e.getZr();LM(n).records||(LM(n).records={}),function(a,o){if(LM(a).initialized)return;function t(t,n){a.on(t,function(e){var i=function(i){var n={showTip:[],hideTip:[]},a=function a(t){var e=n[t.type];e?e.push(t):(t.dispatchAction=a,i.dispatchAction(t));};return{dispatchAction:a,pendings:n};}(o);kM(LM(a).records,function(t){t&&n(t,e,i.dispatchAction);}),function(t,e){var i,n=t.showTip.length,a=t.hideTip.length;n?i=t.showTip[n-1]:a&&(i=t.hideTip[a-1]);i&&(i.dispatchAction=null,e.dispatchAction(i));}(i.pendings,o);});}LM(a).initialized=!0,t("click",A(OM,"click")),t("mousemove",A(OM,"mousemove")),t("globalout",NM);}(n,e),(LM(n).records[t]||(LM(n).records[t]={})).handler=i;}}function NM(t,e,i){t.handler("leave",null,i);}function OM(t,e,i,n){e.handler(t,i,n);}function EM(t,e){if(!v.node){var i=e.getZr();(LM(i).records||{})[t]&&(LM(i).records[t]=null);}}var RM=lf({type:"axisPointer",render:function render(t,e,i){var n=e.getComponent("tooltip"),a=t.get("triggerOn")||n&&n.get("triggerOn")||"mousemove|click";PM("axisPointer",i,function(t,e,i){"none"!==a&&("leave"===t||0<=a.indexOf(t))&&i({type:"updateAxisPointer",currTrigger:t,x:e&&e.offsetX,y:e&&e.offsetY});});},remove:function remove(t,e){EM(e.getZr(),"axisPointer"),RM.superApply(this._model,"remove",arguments);},dispose:function dispose(t,e){EM("axisPointer",e),RM.superApply(this._model,"dispose",arguments);}}),zM=La(),BM=D,VM=T;function GM(){}function FM(t,e,i,n){!function i(n,t){{if(z(n)&&z(t)){var a=!0;return E(t,function(t,e){a=a&&i(n[e],t);}),!!a;}return n===t;}}(zM(i).lastProp,n)&&(zM(i).lastProp=n,e?js(i,n,t):(i.stopAnimation(),i.attr(n)));}function WM(t,e){t[e.get("label.show")?"show":"hide"]();}function HM(t){return{position:t.position.slice(),rotation:t.rotation||0};}function ZM(t,e,i){var n=e.get("z"),a=e.get("zlevel");t&&t.traverse(function(t){"group"!==t.type&&(null!=n&&(t.z=n),null!=a&&(t.zlevel=a),t.silent=i);});}function UM(t){var e,i=t.get("type"),n=t.getModel(i+"Style");return"line"===i?(e=n.getLineStyle()).fill=null:"shadow"===i&&((e=n.getAreaStyle()).stroke=null),e;}function XM(t,e,i,n,a){var o=YM(i.get("value"),e.axis,e.ecModel,i.get("seriesDataIndices"),{precision:i.get("label.precision"),formatter:i.get("label.formatter")}),r=i.getModel("label"),s=Vl(r.get("padding")||0),l=r.getFont(),u=un(o,l),h=a.position,c=u.width+s[1]+s[3],d=u.height+s[0]+s[2],f=a.align;"right"===f&&(h[0]-=c),"center"===f&&(h[0]-=c/2);var p=a.verticalAlign;"bottom"===p&&(h[1]-=d),"middle"===p&&(h[1]-=d/2),function(t,e,i,n){var a=n.getWidth(),o=n.getHeight();t[0]=Math.min(t[0]+e,a)-e,t[1]=Math.min(t[1]+i,o)-i,t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0);}(h,c,d,n);var g=r.get("backgroundColor");g&&"auto"!==g||(g=e.get("axisLine.lineStyle.color")),t.label={shape:{x:0,y:0,width:c,height:d,r:r.get("borderRadius")},position:h.slice(),style:{text:o,textFont:l,textFill:r.getTextColor(),textPosition:"inside",textPadding:s,fill:g,stroke:r.get("borderColor")||"transparent",lineWidth:r.get("borderWidth")||0,shadowBlur:r.get("shadowBlur"),shadowColor:r.get("shadowColor"),shadowOffsetX:r.get("shadowOffsetX"),shadowOffsetY:r.get("shadowOffsetY")},z2:10};}function YM(t,e,a,i,n){t=e.scale.parse(t);var o=e.scale.getLabel(t,{precision:n.precision}),r=n.formatter;if(r){var s={value:Gp(e,t),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};E(i,function(t){var e=a.getSeriesByIndex(t.seriesIndex),i=t.dataIndexInside,n=e&&e.getDataParams(i);n&&s.seriesData.push(n);}),R(r)?o=r.replace("{value}",o):O(r)&&(o=r(s));}return o;}function jM(t,e,i){var n=Qt();return ae(n,n,i.rotation),ne(n,n,i.position),$s([t.dataToCoord(e),(i.labelOffset||0)+(i.labelDirection||1)*(i.labelMargin||0)],n);}function qM(t,e,i,n,a,o){var r=Cm.innerTextLayout(i.rotation,0,i.labelDirection);i.labelMargin=a.get("label.margin"),XM(e,n,a,o,{position:jM(n.axis,t,i),align:r.textAlign,verticalAlign:r.textVerticalAlign});}function KM(t,e,i){return{x1:t[i=i||0],y1:t[1-i],x2:e[i],y2:e[1-i]};}function $M(t,e,i){return{x:t[i=i||0],y:t[1-i],width:e[i],height:e[1-i]};}function JM(t,e,i,n,a,o){return{cx:t,cy:e,r0:i,r:n,startAngle:a,endAngle:o,clockwise:!0};}Ga((GM.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function render(t,e,i,n){var a=e.get("value"),o=e.get("status");if(this._axisModel=t,this._axisPointerModel=e,this._api=i,n||this._lastValue!==a||this._lastStatus!==o){this._lastValue=a,this._lastStatus=o;var r=this._group,s=this._handle;if(!o||"hide"===o)return r&&r.hide(),void(s&&s.hide());r&&r.show(),s&&s.show();var l={};this.makeElOption(l,a,t,e,i);var u=l.graphicKey;u!==this._lastGraphicKey&&this.clear(i),this._lastGraphicKey=u;var h=this._moveAnimation=this.determineAnimation(t,e);if(r){var c=A(FM,e,h);this.updatePointerEl(r,l,c,e),this.updateLabelEl(r,l,c,e);}else r=this._group=new Si(),this.createPointerEl(r,l,t,e),this.createLabelEl(r,l,t,e),i.getZr().add(r);ZM(r,e,!0),this._renderHandle(a);}},remove:function remove(t){this.clear(t);},dispose:function dispose(t){this.clear(t);},determineAnimation:function determineAnimation(t,e){var i=e.get("animation"),n=t.axis,a="category"===n.type,o=e.get("snap");if(!o&&!a)return!1;if("auto"!==i&&null!=i)return!0===i;var r=this.animationThreshold;if(a&&n.getBandWidth()>r)return!0;if(o){var s=Wm(t).seriesDataCount,l=n.getExtent();return Math.abs(l[0]-l[1])/s>r;}return!1;},makeElOption:function makeElOption(t,e,i,n,a){},createPointerEl:function createPointerEl(t,e,i,n){var a=e.pointer;if(a){var o=zM(t).pointerEl=new ol[a.type](BM(e.pointer));t.add(o);}},createLabelEl:function createLabelEl(t,e,i,n){if(e.label){var a=zM(t).labelEl=new Hr(BM(e.label));t.add(a),WM(a,n);}},updatePointerEl:function updatePointerEl(t,e,i){var n=zM(t).pointerEl;n&&e.pointer&&(n.setStyle(e.pointer.style),i(n,{shape:e.pointer.shape}));},updateLabelEl:function updateLabelEl(t,e,i,n){var a=zM(t).labelEl;a&&(a.setStyle(e.label.style),i(a,{shape:e.label.shape,position:e.label.position}),WM(a,n));},_renderHandle:function _renderHandle(t){if(!this._dragging&&this.updateHandleTransform){var e,i=this._axisPointerModel,n=this._api.getZr(),a=this._handle,o=i.getModel("handle"),r=i.get("status");if(!o.get("show")||!r||"hide"===r)return a&&n.remove(a),void(this._handle=null);this._handle||(e=!0,a=this._handle=el(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function onmousemove(t){Ft(t.event);},onmousedown:VM(this._onHandleDragMove,this,0,0),drift:VM(this._onHandleDragMove,this),ondragend:VM(this._onHandleDragEnd,this)}),n.add(a)),ZM(a,i,!1);a.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=o.get("size");k(s)||(s=[s,s]),a.attr("scale",[s[0]/2,s[1]/2]),dc(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,e);}},_moveHandleToValue:function _moveHandleToValue(t,e){FM(this._axisPointerModel,!e&&this._moveAnimation,this._handle,HM(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)));},_onHandleDragMove:function _onHandleDragMove(t,e){var i=this._handle;if(i){this._dragging=!0;var n=this.updateHandleTransform(HM(i),[t,e],this._axisModel,this._axisPointerModel);this._payloadInfo=n,i.stopAnimation(),i.attr(HM(n)),zM(i).lastProp=null,this._doDispatchAxisPointer();}},_doDispatchAxisPointer:function _doDispatchAxisPointer(){if(this._handle){var t=this._payloadInfo,e=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:e.axis.dim,axisIndex:e.componentIndex}]});}},_onHandleDragEnd:function _onHandleDragEnd(t){if(this._dragging=!1,this._handle){var e=this._axisPointerModel.get("value");this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"});}},getHandleTransform:null,updateHandleTransform:null,clear:function clear(t){this._lastValue=null,this._lastStatus=null;var e=t.getZr(),i=this._group,n=this._handle;e&&i&&(this._lastGraphicKey=null,i&&e.remove(i),n&&e.remove(n),this._group=null,this._handle=null,this._payloadInfo=null);},doClear:function doClear(){},buildLabel:function buildLabel(t,e,i){return{x:t[i=i||0],y:t[1-i],width:e[i],height:e[1-i]};}}).constructor=GM);var QM=GM.extend({makeElOption:function makeElOption(t,e,i,n,a){var o=i.axis,r=o.grid,s=n.get("type"),l=tI(r,o).getOtherAxis(o).getGlobalExtent(),u=o.toGlobalCoord(o.dataToCoord(e,!0));if(s&&"none"!==s){var h=UM(n),c=eI[s](o,u,l);c.style=h,t.graphicKey=c.type,t.pointer=c;}qM(e,t,qm(r.model,i),i,n,a);},getHandleTransform:function getHandleTransform(t,e,i){var n=qm(e.axis.grid.model,e,{labelInside:!1});return n.labelMargin=i.get("handle.margin"),{position:jM(e.axis,t,n),rotation:n.rotation+(n.labelDirection<0?Math.PI:0)};},updateHandleTransform:function updateHandleTransform(t,e,i,n){var a=i.axis,o=a.grid,r=a.getGlobalExtent(!0),s=tI(o,a).getOtherAxis(a).getGlobalExtent(),l="x"===a.dim?0:1,u=t.position;u[l]+=e[l],u[l]=Math.min(r[1],u[l]),u[l]=Math.max(r[0],u[l]);var h=(s[1]+s[0])/2,c=[h,h];c[l]=u[l];return{position:u,rotation:t.rotation,cursorPoint:c,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]};}});function tI(t,e){var i={};return i[e.dim+"AxisIndex"]=e.index,t.getCartesian(i);}var eI={line:function line(t,e,i){return{type:"Line",subPixelOptimize:!0,shape:KM([e,i[0]],[e,i[1]],iI(t))};},shadow:function shadow(t,e,i){var n=Math.max(1,t.getBandWidth()),a=i[1]-i[0];return{type:"Rect",shape:$M([e-n/2,i[0]],[n,a],iI(t))};}};function iI(t){return"x"===t.dim?0:1;}Um.registerAxisPointerClass("CartesianAxisPointer",QM),Jd(function(t){if(t){t.axisPointer&&0!==t.axisPointer.length||(t.axisPointer={});var e=t.axisPointer.link;e&&!k(e)&&(t.axisPointer.link=[e]);}}),Qd(cd.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=Gm(t,e);}),tf({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},function(t,e,i){var n=t.currTrigger,r=[t.x,t.y],a=t,o=t.dispatchAction||T(i.dispatchAction,i),s=e.getComponent("axisPointer").coordSysAxesInfo;if(s){CM(r)&&(r=wM({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},e).point);var l=CM(r),u=a.axesInfo,h=s.axesInfo,c="leave"===n||CM(r),d={},f={},p={list:[],map:{}},g={showPointer:SM(AM,f),showTooltip:SM(TM,p)};bM(s.coordSysMap,function(t,e){var o=l||t.containPoint(r);bM(s.coordSysAxesInfo[e],function(t,e){var i=t.axis,n=function(t,e){for(var i=0;i<(t||[]).length;i++){var n=t[i];if(e.axis.dim===n.axisDim&&e.axis.model.componentIndex===n.axisIndex)return n;}}(u,t);if(!c&&o&&(!u||n)){var a=n&&n.value;null!=a||l||(a=i.pointToData(r)),null!=a&&IM(t,a,g,!1,d);}});});var m={};return bM(h,function(a,t){var o=a.linkGroup;o&&!f[t]&&bM(o.axesInfo,function(t,e){var i=f[e];if(t!==a&&i){var n=i.value;o.mapper&&(n=a.axis.scale.parse(o.mapper(n,DM(t),DM(a)))),m[a.key]=n;}});}),bM(m,function(t,e){IM(h[e],t,g,!0,d);}),function(a,t,e){var o=e.axesInfo=[];bM(t,function(t,e){var i=t.axisPointerModel.option,n=a[e];n?(t.useHandle||(i.status="show"),i.value=n.value,i.seriesDataIndices=(n.payloadBatch||[]).slice()):t.useHandle||(i.status="hide"),"show"===i.status&&o.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:i.value});});}(f,h,d),function(t,e,i,n){if(CM(e)||!t.list.length)return n({type:"hideTip"});var a=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:i.tooltipOption,position:i.position,dataIndexInside:a.dataIndexInside,dataIndex:a.dataIndex,seriesIndex:a.seriesIndex,dataByCoordSys:t.list});}(p,r,t,o),function(t,e,i){var n=i.getZr(),a="axisPointerLastHighlights",o=MM(n)[a]||{},r=MM(n)[a]={};bM(t,function(t,e){var i=t.axisPointerModel.option;"show"===i.status&&bM(i.seriesDataIndices,function(t){var e=t.seriesIndex+" | "+t.dataIndex;r[e]=t;});});var s=[],l=[];E(o,function(t,e){r[e]||l.push(t);}),E(r,function(t,e){o[e]||s.push(t);}),l.length&&i.dispatchAction({type:"downplay",escapeConnect:!0,batch:l}),s.length&&i.dispatchAction({type:"highlight",escapeConnect:!0,batch:s});}(h,0,i),d;}});var nI=["x","y"],aI=["width","height"],oI=GM.extend({makeElOption:function makeElOption(t,e,i,n,a){var o=i.axis,r=o.coordinateSystem,s=lI(r,1-sI(o)),l=r.dataToPoint(e)[0],u=n.get("type");if(u&&"none"!==u){var h=UM(n),c=rI[u](o,l,s);c.style=h,t.graphicKey=c.type,t.pointer=c;}qM(e,t,mM(i),i,n,a);},getHandleTransform:function getHandleTransform(t,e,i){var n=mM(e,{labelInside:!1});return n.labelMargin=i.get("handle.margin"),{position:jM(e.axis,t,n),rotation:n.rotation+(n.labelDirection<0?Math.PI:0)};},updateHandleTransform:function updateHandleTransform(t,e,i,n){var a=i.axis,o=a.coordinateSystem,r=sI(a),s=lI(o,r),l=t.position;l[r]+=e[r],l[r]=Math.min(s[1],l[r]),l[r]=Math.max(s[0],l[r]);var u=lI(o,1-r),h=(u[1]+u[0])/2,c=[h,h];return c[r]=l[r],{position:l,rotation:t.rotation,cursorPoint:c,tooltipOption:{verticalAlign:"middle"}};}}),rI={line:function line(t,e,i){return{type:"Line",subPixelOptimize:!0,shape:KM([e,i[0]],[e,i[1]],sI(t))};},shadow:function shadow(t,e,i){var n=t.getBandWidth(),a=i[1]-i[0];return{type:"Rect",shape:$M([e-n/2,i[0]],[n,a],sI(t))};}};function sI(t){return t.isHorizontal()?0:1;}function lI(t,e){var i=t.getRect();return[i[nI[e]],i[nI[e]]+i[aI[e]]];}Um.registerAxisPointerClass("SingleAxisPointer",oI),lf({type:"single"});var uI=Wh.extend({type:"series.themeRiver",dependencies:["singleAxis"],nameMap:null,init:function init(t){uI.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData();};},fixData:function fixData(t){var e=t.length,i=Ra(t,function(t){return t[2];}),n=[];i.buckets.each(function(t,e){n.push({name:e,dataList:t});});for(var a=n.length,o=-1,r=-1,s=0;s<a;++s){var l=n[s].dataList.length;o<l&&(o=l,r=s);}for(var u=0;u<a;++u){if(u!==r)for(var h=n[u].name,c=0;c<o;++c){for(var d=n[r].dataList[c][0],f=n[u].dataList.length,p=-1,g=0;g<f;++g){if(n[u].dataList[g][0]===d){p=g;break;}}-1===p&&(t[e]=[],t[e][0]=d,t[e][1]=0,t[e][2]=h,e++);}}return t;},getInitialData:function getInitialData(t,e){for(var i=e.queryComponents({mainType:"singleAxis",index:this.get("singleAxisIndex"),id:this.get("singleAxisId")})[0].get("type"),n=M(t.data,function(t){return void 0!==t[2];}),a=this.fixData(n||[]),o=[],r=this.nameMap=Q(),s=0,l=0;l<a.length;++l){o.push(a[l][2]),r.get(a[l][2])||(r.set(a[l][2],s),s++);}var u=Wf(a,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:mf(i)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}),h=new Tf(u,this);return h.initData(a),h;},getLayerSeries:function getLayerSeries(){for(var i=this.getData(),t=i.count(),e=[],n=0;n<t;++n){e[n]=n;}var a=i.mapDimension("single"),o=Ra(e,function(t){return i.get("name",t);}),r=[];return o.buckets.each(function(t,e){t.sort(function(t,e){return i.get(a,t)-i.get(a,e);}),r.push({name:e,indices:t});}),r;},getAxisTooltipData:function getAxisTooltipData(t,e,i){k(t)||(t=t?[t]:[]);for(var n,a=this.getData(),o=this.getLayerSeries(),r=[],s=o.length,l=0;l<s;++l){for(var u=Number.MAX_VALUE,h=-1,c=o[l].indices.length,d=0;d<c;++d){var f=a.get(t[0],o[l].indices[d]),p=Math.abs(f-e);p<=u&&(n=f,u=p,h=o[l].indices[d]);}r.push(h);}return{dataIndices:r,nestestValue:n};},formatTooltip:function formatTooltip(t){var e=this.getData(),i=e.getName(t),n=e.get(e.mapDimension("value"),t);return!isNaN(n)&&null!=n||(n="-"),Wl(i+" : "+n);},defaultOption:{zlevel:0,z:2,coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",color:"#000",fontSize:11},emphasis:{label:{show:!0}}}});hf({type:"themeRiver",init:function init(){this._layers=[];},render:function render(b,t,e){var S=b.getData(),M=this.group,I=b.getLayerSeries(),i=S.getLayout("layoutInfo"),n=i.rect,a=i.boundaryGap;function o(t){return t.name;}M.attr("position",[0,n.y+a[0]]);var r=new df(this._layersSeries||[],I,o,o),A={};function s(t,e,i){var n=this._layers;if("remove"!==t){for(var a,o,r,s=[],l=[],u=I[e].indices,h=0;h<u.length;h++){var c=S.getItemLayout(u[h]),d=c.x,f=c.y0,p=c.y;s.push([d,f]),l.push([d,f+p]),a=S.getItemVisual(u[h],"color");}var g=S.getItemLayout(u[0]),m=S.getItemModel(u[h-1]),v=m.getModel("label"),y=v.get("margin");if("add"===t){var x=A[e]=new Si();o=new $g({shape:{points:s,stackedOnPoints:l,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),r=new Dr({style:{x:g.x-y,y:g.y0+g.y/2}}),x.add(o),x.add(r),M.add(x),o.setClipPath(function(t,e,i){var n=new Hr({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return qs(n,{shape:{width:t.width+20,height:t.height+20}},e,i),n;}(o.getBoundingRect(),b,function(){o.removeClipPath();}));}else{x=n[i];o=x.childAt(0),r=x.childAt(1),M.add(x),A[e]=x,js(o,{shape:{points:s,stackedOnPoints:l}},b),js(r,{style:{x:g.x-y,y:g.y0+g.y/2}},b);}var _=m.getModel("emphasis.itemStyle"),w=m.getModel("itemStyle");Gs(r.style,v,{text:v.get("show")?b.getFormattedLabel(u[h-1],"normal")||S.getName(u[h-1]):null,textVerticalAlign:"middle"}),o.setStyle(L({fill:a},w.getItemStyle(["color"]))),Os(o,_.getItemStyle());}else M.remove(n[e]);}r.add(T(s,this,"add")).update(T(s,this,"update")).remove(T(s,this,"remove")).execute(),this._layersSeries=I,this._layers=A;},dispose:function dispose(){}});function hI(i,t,e){if(i.count())for(var n,a=t.coordinateSystem,o=t.getLayerSeries(),r=i.mapDimension("single"),s=i.mapDimension("value"),l=N(o,function(t){return N(t.indices,function(t){var e=a.dataToPoint(i.get(r,t));return e[1]=i.get(s,t),e;});}),u=function(t){for(var e=t.length,i=t[0].length,n=[],a=[],o=0,r={},s=0;s<i;++s){for(var l=0,u=0;l<e;++l){u+=t[l][s][1];}o<u&&(o=u),n.push(u);}for(var h=0;h<i;++h){a[h]=(o-n[h])/2;}for(var c=o=0;c<i;++c){var d=n[c]+a[c];o<d&&(o=d);}return r.y0=a,r.max=o,r;}(l),h=u.y0,c=e/u.max,d=o.length,f=o[0].indices.length,p=0;p<f;++p){n=h[p]*c,i.setItemLayout(o[0].indices[p],{layerIndex:0,x:l[0][p][0],y0:n,y:l[0][p][1]*c});for(var g=1;g<d;++g){n+=l[g-1][p][1]*c,i.setItemLayout(o[g].indices[p],{layerIndex:g,x:l[g][p][0],y0:n,y:l[g][p][1]*c});}}}nf(function(t,e){t.eachSeriesByType("themeRiver",function(t){var e=t.getData(),i=t.coordinateSystem,n={},a=i.getRect();n.rect=a;var o=t.get("boundaryGap"),r=i.getAxis();(n.boundaryGap=o,"horizontal"===r.orient)?(o[0]=xl(o[0],a.height),o[1]=xl(o[1],a.height),hI(e,t,a.height-o[0]-o[1])):(o[0]=xl(o[0],a.width),o[1]=xl(o[1],a.width),hI(e,t,a.width-o[0]-o[1]));e.setLayout("layoutInfo",n);});}),af(function(t){t.eachSeriesByType("themeRiver",function(a){var o=a.getData(),r=a.getRawData(),s=a.get("color"),l=Q();o.each(function(t){l.set(o.getRawIndex(t),t);}),r.each(function(t){var e=r.getName(t),i=s[(a.nameMap.get(e)-1)%s.length];r.setItemVisual(t,"color",i);var n=l.get(t);null!=n&&o.setItemVisual(n,"color",i);});});}),Qd(kv("themeRiver")),Wh.extend({type:"series.sunburst",_viewRoot:null,getInitialData:function getInitialData(t,e){var i={name:t.name,children:t.data};!function i(t){var n=0;E(t.children,function(t){i(t);var e=t.value;k(e)&&(e=e[0]),n+=e;});var e=t.value;k(e)&&(e=e[0]);null!=e&&!isNaN(e)||(e=n);e<0&&(e=0);k(t.value)?t.value[0]=e:t.value=e;}(i);var n=t.levels||[],a={};return a.levels=n,Ky.createTree(i,this,a).data;},optionUpdated:function optionUpdated(){this.resetViewRoot();},getDataParams:function getDataParams(t){var e=Wh.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=gx(i,this),e;},defaultOption:{zlevel:0,z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,percentPrecision:2,stillShowZeroSum:!0,highlightPolicy:"descendant",nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0,emphasis:{}},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1,emphasis:{},highlight:{opacity:1},downplay:{opacity:.9}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicOut",data:[],levels:[],sort:"desc"},getViewRoot:function getViewRoot(){return this._viewRoot;},resetViewRoot:function resetViewRoot(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e);}});var cI="none",dI="ancestor",fI="self",pI=2,gI=4;function mI(t,e,i){Si.call(this);var n=new Pr({z2:pI});n.seriesIndex=e.seriesIndex;var a=new Dr({z2:gI,silent:t.getModel("label").get("silent")});function o(){a.ignore=a.hoverIgnore;}function r(){a.ignore=a.normalIgnore;}this.add(n),this.add(a),this.updateData(!0,t,"normal",e,i),this.on("emphasis",o).on("normal",r).on("mouseover",o).on("mouseout",r);}var vI=mI.prototype;vI.updateData=function(t,e,i,n,a){(this.node=e).piece=this,n=n||this._seriesModel,a=a||this._ecModel;var o=this.childAt(0);o.dataIndex=e.dataIndex;var r=e.getModel(),s=e.getLayout(),l=L({},s);l.label=null;var u=function(t,e,i){var n=t.getVisual("color"),a=t.getVisual("visualMeta");a&&0!==a.length||(n=null);var o=t.getModel("itemStyle").get("color");{if(o)return o;if(n)return n;if(0===t.depth)return i.option.color[0];var r=i.option.color.length;o=i.option.color[function(t){var e=t;for(;1<e.depth;){e=e.parentNode;}return _(t.getAncestors()[0].children,e);}(t)%r];}return o;}(e,0,a);!function(t,e,i){e.getData().setItemVisual(t.dataIndex,"color",i);}(e,n,u);var h,c=r.getModel("itemStyle").getItemStyle();"normal"===i?h=c:h=m(r.getModel(i+".itemStyle").getItemStyle(),c);h=C({lineJoin:"bevel",fill:h.fill||u},h),t?(o.setShape(l),o.shape.r=s.r0,js(o,{shape:{r:s.r}},n,e.dataIndex),o.useStyle(h)):"object"==_typeof(h.fill)&&h.fill.type||"object"==_typeof(o.style.fill)&&o.style.fill.type?(js(o,{shape:l},n),o.useStyle(h)):js(o,{shape:l,style:h},n),this._updateLabel(n,u,i);var d=r.getShallow("cursor");if(d&&o.attr("cursor",d),t){var f=n.getShallow("highlightPolicy");this._initEvents(o,e,n,f);}this._seriesModel=n||this._seriesModel,this._ecModel=a||this._ecModel;},vI.onEmphasis=function(e){var i=this;this.node.hostTree.root.eachNode(function(t){t.piece&&(i.node===t?t.piece.updateData(!1,t,"emphasis"):!function(t,e,i){return i!==cI&&(i===fI?t===e:i===dI?t===e||t.isAncestorOf(e):t===e||t.isDescendantOf(e));}(t,i.node,e)?e!==cI&&t.piece.childAt(0).trigger("downplay"):t.piece.childAt(0).trigger("highlight"));});},vI.onNormal=function(){this.node.hostTree.root.eachNode(function(t){t.piece&&t.piece.updateData(!1,t,"normal");});},vI.onHighlight=function(){this.updateData(!1,this.node,"highlight");},vI.onDownplay=function(){this.updateData(!1,this.node,"downplay");},vI._updateLabel=function(t,e,i){var n=this.node.getModel(),a=n.getModel("label"),o="normal"===i||"emphasis"===i?a:n.getModel(i+".label"),r=n.getModel("emphasis.label"),s=W(t.getFormattedLabel(this.node.dataIndex,i,null,null,"label"),this.node.name);!1===S("show")&&(s="");var l=this.node.getLayout(),u=o.get("minAngle");null==u&&(u=a.get("minAngle")),u=u/180*Math.PI;var h=l.endAngle-l.startAngle;null!=u&&Math.abs(h)<u&&(s="");var c=this.childAt(1);Bs(c.style,c.hoverStyle||{},a,r,{defaultText:o.getShallow("show")?s:null,autoColor:e,useInsideStyle:!0});var d,f=(l.startAngle+l.endAngle)/2,p=Math.cos(f),g=Math.sin(f),m=S("position"),v=S("distance")||0,y=S("align");"outside"===m?(d=l.r+v,y=f>Math.PI/2?"right":"left"):y&&"center"!==y?"left"===y?(d=l.r0+v,f>Math.PI/2&&(y="right")):"right"===y&&(d=l.r-v,f>Math.PI/2&&(y="left")):(d=(l.r+l.r0)/2,y="center"),c.attr("style",{text:s,textAlign:y,textVerticalAlign:S("verticalAlign")||"middle",opacity:S("opacity")});var x=d*p+l.cx,_=d*g+l.cy;c.attr("position",[x,_]);var w=S("rotate"),b=0;function S(t){var e=o.get(t);return null==e?a.get(t):e;}"radial"===w?(b=-f)<-Math.PI/2&&(b+=Math.PI):"tangential"===w?(b=Math.PI/2-f)>Math.PI/2?b-=Math.PI:b<-Math.PI/2&&(b+=Math.PI):"number"==typeof w&&(b=w*Math.PI/180),c.attr("rotation",b);},vI._initEvents=function(t,e,i,n){t.off("mouseover").off("mouseout").off("emphasis").off("normal");function a(){r.onEmphasis(n);}function o(){r.onNormal();}var r=this;i.isAnimationEnabled()&&t.on("mouseover",a).on("mouseout",o).on("emphasis",a).on("normal",o).on("downplay",function(){r.onDownplay();}).on("highlight",function(){r.onHighlight();});},w(mI,Si);ec.extend({type:"sunburst",init:function init(){},render:function render(a,o,t,e){var n=this;this.seriesModel=a,this.api=t,this.ecModel=o;var r=a.getData(),s=r.tree.root,i=a.getViewRoot(),l=this.group,u=a.get("renderLabelForZeroData"),h=[];i.eachNode(function(t){h.push(t);});var c=this._oldChildren||[];if(function(i,n){if(0===i.length&&0===n.length)return;function t(t){return t.getId();}function e(t,e){!function(t,e){u||!t||t.getValue()||(t=null);if(t!==s&&e!==s)if(e&&e.piece)t?(e.piece.updateData(!1,t,"normal",a,o),r.setItemGraphicEl(t.dataIndex,e.piece)):function(t){if(!t)return;t.piece&&(l.remove(t.piece),t.piece=null);}(e);else if(t){var i=new mI(t,a,o);l.add(i),r.setItemGraphicEl(t.dataIndex,i);}}(null==t?null:i[t],null==e?null:n[e]);}new df(n,i,t,t).add(e).update(e).remove(A(e,null)).execute();}(h,c),function(t,e){if(0<e.depth){n.virtualPiece?n.virtualPiece.updateData(!1,t,"normal",a,o):(n.virtualPiece=new mI(t,a,o),l.add(n.virtualPiece)),e.piece._onclickEvent&&e.piece.off("click",e.piece._onclickEvent);var i=function i(t){n._rootToNode(e.parentNode);};e.piece._onclickEvent=i,n.virtualPiece.on("click",i);}else n.virtualPiece&&(l.remove(n.virtualPiece),n.virtualPiece=null);}(s,i),e&&e.highlight&&e.highlight.piece){var d=a.getShallow("highlightPolicy");e.highlight.piece.onEmphasis(d);}else if(e&&e.unhighlight){var f=this.virtualPiece;!f&&s.children.length&&(f=s.children[0].piece),f&&f.onNormal();}this._initEvents(),this._oldChildren=h;},dispose:function dispose(){},_initEvents:function _initEvents(){function t(o){var r=!1;s.seriesModel.getViewRoot().eachNode(function(t){if(!r&&t.piece&&t.piece.childAt(0)===o.target){var e=t.getModel().get("nodeClick");if("rootToNode"===e)s._rootToNode(t);else if("link"===e){var i=t.getModel(),n=i.get("link");if(n){var a=i.get("target",!0)||"_blank";window.open(n,a);}}r=!0;}});}var s=this;this.group._onclickEvent&&this.group.off("click",this.group._onclickEvent),this.group.on("click",t),this.group._onclickEvent=t;},_rootToNode:function _rootToNode(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:"sunburstRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t});},containPoint:function containPoint(t,e){var i=e.getData().getItemLayout(0);if(i){var n=t[0]-i.cx,a=t[1]-i.cy,o=Math.sqrt(n*n+a*a);return o<=i.r&&o>=i.r0;}}});var yI="sunburstRootToNode";tf({type:yI,update:"updateView"},function(a,t){t.eachComponent({mainType:"series",subType:"sunburst",query:a},function(t,e){var i=dx(a,[yI],t);if(i){var n=t.getViewRoot();n&&(a.direction=px(n,i.node)?"rollUp":"drillDown"),t.resetViewRoot(i.node);}});});var xI="sunburstHighlight";tf({type:xI,update:"updateView"},function(n,t){t.eachComponent({mainType:"series",subType:"sunburst",query:n},function(t,e){var i=dx(n,[xI],t);i&&(n.highlight=i.node);});});tf({type:"sunburstUnhighlight",update:"updateView"},function(i,t){t.eachComponent({mainType:"series",subType:"sunburst",query:i},function(t,e){i.unhighlight=!0;});});var _I=Math.PI/180;function wI(t,e){if("function"==typeof e)return t.sort(e);var n="asc"===e;return t.sort(function(t,e){var i=(t.getValue()-e.getValue())*(n?1:-1);return 0==i?(t.dataIndex-e.dataIndex)*(n?-1:1):i;});}function bI(o,r){return r=r||[0,0],N(["x","y"],function(t,e){var i=this.getAxis(t),n=r[e],a=o[e]/2;return"category"===i.type?i.getBandWidth():Math.abs(i.dataToCoord(n-a)-i.dataToCoord(n+a));},this);}af(A(Av,"sunburst")),nf(A(function(t,e,C,i){e.eachSeriesByType(t,function(t){var e=t.get("center"),i=t.get("radius");k(i)||(i=[0,i]),k(e)||(e=[e,e]);var n=C.getWidth(),a=C.getHeight(),h=Math.min(n,a),c=xl(e[0],n),d=xl(e[1],a),f=xl(i[0],h/2),o=xl(i[1],h/2),r=-t.get("startAngle")*_I,p=t.get("minAngle")*_I,g=t.getData().tree.root,s=t.getViewRoot(),m=s.depth,l=t.get("sort");null!=l&&!function e(t,i){var n=t.children||[];t.children=wI(n,i);n.length&&E(t.children,function(t){e(t,i);});}(s,l);var u=0;E(s.children,function(t){isNaN(t.getValue())||u++;});var v=s.getValue(),y=Math.PI/(v||u)*2,x=0<s.depth,_=s.height-(x?-1:1),w=(o-f)/(_||1),b=t.get("clockwise"),S=t.get("stillShowZeroSum"),M=b?1:-1,I=function I(t,e){if(t){var i=e;if(t!==g){var n=t.getValue(),a=0===v&&S?y:n*y;a<p&&(a=p),i=e+M*a;var o=t.depth-m-(x?-1:1),r=f+w*o,s=f+w*(1+o),l=t.getModel();null!=l.get("r0")&&(r=xl(l.get("r0"),h/2)),null!=l.get("r")&&(s=xl(l.get("r"),h/2)),t.setLayout({angle:a,startAngle:e,endAngle:i,clockwise:b,cx:c,cy:d,r0:r,r:s});}if(t.children&&t.children.length){var u=0;E(t.children,function(t){u+=I(t,e+u);});}return i-e;}};if(x){var A=f,T=f+w,D=2*Math.PI;g.setLayout({angle:D,startAngle:r,endAngle:r+D,clockwise:b,cx:c,cy:d,r0:A,r:T});}I(s,r);});},"sunburst")),Qd(A(kv,"sunburst"));function SI(o,r){return r=r||[0,0],N([0,1],function(t){var e=r[t],i=o[t]/2,n=[],a=[];return n[t]=e-i,a[t]=e+i,n[1-t]=a[1-t]=r[1-t],Math.abs(this.dataToPoint(n)[t]-this.dataToPoint(a)[t]);},this);}function MI(t,e){var i=this.getAxis(),n=e instanceof Array?e[0]:e,a=(t instanceof Array?t[0]:t)/2;return"category"===i.type?i.getBandWidth():Math.abs(i.dataToCoord(n-a)-i.dataToCoord(n+a));}function II(s,l){return N(["Radius","Angle"],function(t,e){var i=this["get"+t+"Axis"](),n=l[e],a=s[e]/2,o="dataTo"+t,r="category"===i.type?i.getBandWidth():Math.abs(i[o](n-a)-i[o](n+a));return"Angle"===t&&(r=r*Math.PI/180),r;},this);}var AI=rs,TI=["itemStyle"],DI=["emphasis","itemStyle"],CI=["label"],LI=["emphasis","label"],kI="e\0\0",PI={cartesian2d:function cartesian2d(e){var t=e.grid.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function coord(t){return e.dataToPoint(t);},size:T(bI,e)}};},geo:function geo(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function coord(t){return e.dataToPoint(t);},size:T(SI,e)}};},singleAxis:function singleAxis(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function coord(t){return e.dataToPoint(t);},size:T(MI,e)}};},polar:function polar(a){var o=a.getRadiusAxis(),r=a.getAngleAxis(),t=o.getExtent();return t[0]>t[1]&&t.reverse(),{coordSys:{type:"polar",cx:a.cx,cy:a.cy,r:t[1],r0:t[0]},api:{coord:T(function(t){var e=o.dataToRadius(t[0]),i=r.dataToAngle(t[1]),n=a.coordToPoint([e,i]);return n.push(e,i*Math.PI/180),n;}),size:T(II,a)}};},calendar:function calendar(i){var t=i.getRect(),e=i.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:i.getCellWidth(),cellHeight:i.getCellHeight(),rangeInfo:{start:e.start,end:e.end,weeks:e.weeks,dayCount:e.allDay}},api:{coord:function coord(t,e){return i.dataToPoint(t,e);}}};}};function NI(t,e,i,n,a){null==i[t]||a||(e[t]=i[t],i[t]=n[t]);}function OI(o,r,e,t){var i=o.get("renderItem"),n=o.coordinateSystem,a={};n&&(a=n.prepareCustoms?n.prepareCustoms():PI[n.type](n));var s,l,u,h,c,d=C({getWidth:t.getWidth,getHeight:t.getHeight,getZr:t.getZr,getDevicePixelRatio:t.getDevicePixelRatio,value:function value(t,e){return null==e&&(e=s),r.get(r.getDimension(t||0),e);},style:function style(t,e){null==e&&(e=s),g(e);var i=l.getModel(TI).getItemStyle();null!=c&&(i.fill=c);var n=r.getItemVisual(e,"opacity");null!=n&&(i.opacity=n);var a=t?VI(t,u):u;return Gs(i,a,null,{autoColor:c,isRectText:!0}),i.text=a.getShallow("show")?H(o.getFormattedLabel(e,"normal"),bg(r,e)):null,t&&GI(i,t),i;},styleEmphasis:function styleEmphasis(t,e){null==e&&(e=s),g(e);var i=l.getModel(DI).getItemStyle(),n=t?VI(t,h):h;return Gs(i,n,null,{isRectText:!0},!0),i.text=n.getShallow("show")?Z(o.getFormattedLabel(e,"emphasis"),o.getFormattedLabel(e,"normal"),bg(r,e)):null,t&&GI(i,t),i;},visual:function visual(t,e){return null==e&&(e=s),r.getItemVisual(e,t);},barLayout:function barLayout(t){if(n.getBaseAxis){return function(t){var e=[],i=t.axis;if("category"===i.type){for(var n=i.getBandWidth(),a=0;a<t.count;a++){e.push(C({bandWidth:n,axisKey:"axis0",stackId:rp+a},t));}var o=dp(e),r=[];for(a=0;a<t.count;a++){var s=o.axis0[rp+a];s.offsetCenter=s.offset+s.width/2,r.push(s);}return r;}}(C({axis:n.getBaseAxis()},t));}},currentSeriesIndices:function currentSeriesIndices(){return e.getCurrentSeriesIndices();},font:function font(t){return Xs(t,e);}},a.api||{}),f={context:{},seriesId:o.id,seriesName:o.name,seriesIndex:o.seriesIndex,coordSys:a.coordSys,dataInsideLength:r.count(),encode:function(a){var o={};return E(a.dimensions,function(t,e){var i=a.getDimensionInfo(t);if(!i.isExtraCoord){var n=i.coordDim;(o[n]=o[n]||[])[i.coordDimIndex]=e;}}),o;}(o.getData())},p=!0;return function(t,e){return s=t,p=!0,i&&i(C({dataIndexInside:t,dataIndex:r.getRawIndex(t),actionType:e?e.type:null},f),d);};function g(t){null==t&&(t=s),p&&(l=r.getItemModel(t),u=l.getModel(CI),h=l.getModel(LI),c=r.getItemVisual(t,"color"),p=!1);}}function EI(t,e,i,n,a,o){return(t=RI(t,e,i,n,a,o,!0))&&o.setItemGraphicEl(e,t),t;}function RI(t,e,i,n,a,o,r){var s=!i,l=(i=i||{}).type,u=i.shape,h=i.style;if(t&&(s||null!=l&&l!==t.__customGraphicType||"path"===l&&function(t){return t&&(t.hasOwnProperty("pathData")||t.hasOwnProperty("d"));}(u)&&WI(u)!==t.__customPathData||"image"===l&&HI(h,"image")&&h.image!==t.__customImagePath||"text"===l&&HI(u,"text")&&h.text!==t.__customText)&&(a.remove(t),t=null),!s){var c=!t;return function(e,t,i,n,a,o,r){var s={},l=i.style||{};if(i.shape&&(s.shape=D(i.shape)),i.position&&(s.position=i.position.slice()),i.scale&&(s.scale=i.scale.slice()),i.origin&&(s.origin=i.origin.slice()),i.rotation&&(s.rotation=i.rotation),"image"===e.type&&i.style){var u=s.style={};E(["x","y","width","height"],function(t){NI(t,u,l,e.style,o);});}if("text"===e.type&&i.style){u=s.style={};E(["x","y"],function(t){NI(t,u,l,e.style,o);}),!l.hasOwnProperty("textFill")&&l.fill&&(l.textFill=l.fill),!l.hasOwnProperty("textStroke")&&l.stroke&&(l.textStroke=l.stroke);}if("group"!==e.type&&(e.useStyle(l),o)){e.style.opacity=0;var h=l.opacity;null==h&&(h=1),qs(e,{style:{opacity:h}},n,t);}o?e.attr(s):js(e,s,n,t),i.hasOwnProperty("z2")&&e.attr("z2",i.z2||0),i.hasOwnProperty("silent")&&e.attr("silent",i.silent),i.hasOwnProperty("invisible")&&e.attr("invisible",i.invisible),i.hasOwnProperty("ignore")&&e.attr("ignore",i.ignore),i.hasOwnProperty("info")&&e.attr("info",i.info);var c=i.styleEmphasis;Ds(e,c),r&&Es(e,!1!==c);}(t=t||function(t){var e,i=t.type;if("path"===i){var n=t.shape,a=null!=n.width&&null!=n.height?{x:n.x||0,y:n.y||0,width:n.width,height:n.height}:null,o=WI(n);(e=gs(o,null,a,n.layout||"center")).__customPathData=o;}else if("image"===i)(e=new Yn({})).__customImagePath=t.style.image;else if("text"===i)(e=new Dr({})).__customText=t.style.text;else if("group"===i)e=new Si();else{if("compoundPath"===i)throw new Error('"compoundPath" is not supported yet.');e=new(ps(i))();}return e.__customGraphicType=i,e.name=t.name,e;}(i),e,i,n,0,c,r),"group"===l&&function(t,e,i,n,a){var o=i.children,r=o?o.length:0,s=i.$mergeChildren,l="byName"===s||i.diffChildrenByName,u=!1===s;if(!r&&!l&&!u)return;if(l)return function(t){new df(t.oldChildren,t.newChildren,zI,zI,t).add(BI).update(BI).remove(FI).execute();}({oldChildren:t.children()||[],newChildren:o||[],dataIndex:e,animatableModel:n,group:t,data:a});u&&t.removeAll();for(var h=0;h<r;h++){o[h]&&RI(t.childAt(h),e,o[h],n,t,a);}}(t,e,i,n,o),a.add(t),t;}}function zI(t,e){var i=t&&t.name;return null!=i?i:kI+e;}function BI(t,e){var i=this.context,n=null!=t?i.newChildren[t]:null;RI(null!=e?i.oldChildren[e]:null,i.dataIndex,n,i.animatableModel,i.group,i.data);}function VI(i,t){var n=new dl({},t);return E(AI,function(t,e){i.hasOwnProperty(t)&&(n.option[e]=i[t]);}),n;}function GI(t,e){for(var i in e){!e.hasOwnProperty(i)&&AI.hasOwnProperty(i)||(t[i]=e[i]);}}function FI(t){var e=this.context,i=e.oldChildren[t];i&&e.group.remove(i);}function WI(t){return t&&(t.pathData||t.d);}function HI(t,e){return t&&t.hasOwnProperty(e);}function ZI(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex;}function UI(t,e){return e.dim+t.model.componentIndex;}function XI(t,e){vg.call(this,"radius",t,e),this.type="category";}Wh.extend({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,useTransform:!0,clip:!1},getInitialData:function getInitialData(t,e){return Xf(this.getSource(),this);},getDataParams:function getDataParams(t,e,i){var n=Wh.prototype.getDataParams.apply(this,arguments);return i&&(n.info=i.info),n;}}),ec.extend({type:"custom",_data:null,render:function render(i,t,e,n){var a=this._data,o=i.getData(),r=this.group,s=OI(i,o,t,e);o.diff(a).add(function(t){EI(null,t,s(t,n),i,r,o);}).update(function(t,e){EI(a.getItemGraphicEl(e),t,s(t,n),i,r,o);}).remove(function(t){var e=a.getItemGraphicEl(t);e&&r.remove(e);}).execute();var l=i.get("clip",!0)?tm(i.coordinateSystem,!1,i):null;l?r.setClipPath(l):r.removeClipPath(),this._data=o;},incrementalPrepareRender:function incrementalPrepareRender(t,e,i){this.group.removeAll(),this._data=null;},incrementalRender:function incrementalRender(t,e,i,n,a){var o=e.getData(),r=OI(e,o,i,n);function s(t){t.isGroup||(t.incremental=!0,t.useHoverLayer=!0);}for(var l=t.start;l<t.end;l++){EI(null,l,r(l,a),e,this.group,o).traverse(s);}},dispose:et,filterForExposedEvent:function filterForExposedEvent(t,e,i,n){var a=e.element;if(null==a||i.name===a)return!0;for(;(i=i.parent)&&i!==this.group;){if(i.name===a)return!0;}return!1;}}),XI.prototype={constructor:XI,pointToData:function pointToData(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1];},dataToRadius:vg.prototype.dataToCoord,radiusToData:vg.prototype.coordToData},w(XI,vg);var YI=La();function jI(t,e){e=e||[0,360],vg.call(this,"angle",t,e),this.type="category";}jI.prototype={constructor:jI,pointToData:function pointToData(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1];},dataToAngle:vg.prototype.dataToCoord,angleToData:vg.prototype.coordToData,calculateCategoryInterval:function calculateCategoryInterval(){var t=this.getLabelModel(),e=this.scale,i=e.getExtent(),n=e.count();if(i[1]-i[0]<1)return 0;var a=i[0],o=this.dataToCoord(a+1)-this.dataToCoord(a),r=Math.abs(o),s=un(a,t.getFont(),"center","top"),l=Math.max(s.height,7)/r;isNaN(l)&&(l=1/0);var u=Math.max(0,Math.floor(l)),h=YI(this.model),c=h.lastAutoInterval,d=h.lastTickCount;return null!=c&&null!=d&&Math.abs(c-u)<=1&&Math.abs(d-n)<=1&&u<c?u=c:(h.lastTickCount=n,h.lastAutoInterval=u),u;}},w(jI,vg);function qI(t){this.name=t||"",this.cx=0,this.cy=0,this._radiusAxis=new XI(),this._angleAxis=new jI(),this._radiusAxis.polar=this._angleAxis.polar=this;}qI.prototype={type:"polar",axisPointerEnabled:!0,constructor:qI,dimensions:["radius","angle"],model:null,containPoint:function containPoint(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1]);},containData:function containData(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1]);},getAxis:function getAxis(t){return this["_"+t+"Axis"];},getAxes:function getAxes(){return[this._radiusAxis,this._angleAxis];},getAxesByScale:function getAxesByScale(t){var e=[],i=this._angleAxis,n=this._radiusAxis;return i.scale.type===t&&e.push(i),n.scale.type===t&&e.push(n),e;},getAngleAxis:function getAngleAxis(){return this._angleAxis;},getRadiusAxis:function getRadiusAxis(){return this._radiusAxis;},getOtherAxis:function getOtherAxis(t){var e=this._angleAxis;return t===e?this._radiusAxis:e;},getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis();},getTooltipAxes:function getTooltipAxes(t){var e=null!=t&&"auto"!==t?this.getAxis(t):this.getBaseAxis();return{baseAxes:[e],otherAxes:[this.getOtherAxis(e)]};},dataToPoint:function dataToPoint(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)]);},pointToData:function pointToData(t,e){var i=this.pointToCoord(t);return[this._radiusAxis.radiusToData(i[0],e),this._angleAxis.angleToData(i[1],e)];},pointToCoord:function pointToCoord(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=this.getAngleAxis(),a=n.getExtent(),o=Math.min(a[0],a[1]),r=Math.max(a[0],a[1]);n.inverse?o=r-360:r=o+360;var s=Math.sqrt(e*e+i*i);e/=s,i/=s;for(var l=Math.atan2(-i,e)/Math.PI*180,u=l<o?1:-1;l<o||r<l;){l+=360*u;}return[s,l];},coordToPoint:function coordToPoint(t){var e=t[0],i=t[1]/180*Math.PI;return[Math.cos(i)*e+this.cx,-Math.sin(i)*e+this.cy];},getArea:function getArea(){var t=this.getAngleAxis(),e=this.getRadiusAxis().getExtent().slice();e[0]>e[1]&&e.reverse();var i=t.getExtent(),n=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:e[0],r:e[1],startAngle:-i[0]*n,endAngle:-i[1]*n,clockwise:t.inverse,contain:function contain(t,e){var i=t-this.cx,n=e-this.cy,a=i*i+n*n,o=this.r,r=this.r0;return a<=o*o&&r*r<=a;}};}};var KI=fu.extend({type:"polarAxis",axis:null,getCoordSysModel:function getCoordSysModel(){return this.ecModel.queryComponents({mainType:"polar",index:this.option.polarIndex,id:this.option.polarId})[0];}});m(KI.prototype,Hp);var $I={splitNumber:5};function JI(t,e){return e.type||(e.data?"category":"value");}function QI(t,e){var i=this,n=i.getAngleAxis(),a=i.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),a.scale.setExtent(1/0,-1/0),t.eachSeries(function(t){if(t.coordinateSystem===i){var e=t.getData();E(e.mapDimension("radius",!0),function(t){a.scale.unionExtentFromData(e,Uf(e,t));}),E(e.mapDimension("angle",!0),function(t){n.scale.unionExtentFromData(e,Uf(e,t));});}}),zp(n.scale,n.model),zp(a.scale,a.model),"category"===n.type&&!n.onBand){var o=n.getExtent(),r=360/n.scale.count();n.inverse?o[1]+=r:o[1]-=r,n.setExtent(o[0],o[1]);}}function tA(t,e){if(t.type=e.get("type"),t.scale=Bp(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,t.inverse=e.get("inverse"),"angleAxis"===e.mainType){t.inverse^=e.get("clockwise");var i=e.get("startAngle");t.setExtent(i,i+(t.inverse?-360:360));}(e.axis=t).model=e;}mm("angle",KI,JI,{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}}),mm("radius",KI,JI,$I),sf({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function findAxisModel(t){var e;return this.ecModel.eachComponent(t,function(t){t.getCoordSysModel()===this&&(e=t);},this),e;},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}}),Hu.register("polar",{dimensions:qI.prototype.dimensions,create:function create(i,s){var l=[];return i.eachComponent("polar",function(t,e){var i=new qI(e);i.update=QI;var n=i.getRadiusAxis(),a=i.getAngleAxis(),o=t.findAxisModel("radiusAxis"),r=t.findAxisModel("angleAxis");tA(n,o),tA(a,r),function(t,e,i){var n=e.get("center"),a=i.getWidth(),o=i.getHeight();t.cx=xl(n[0],a),t.cy=xl(n[1],o);var r=t.getRadiusAxis(),s=Math.min(a,o)/2,l=e.get("radius");null==l?l=[0,"100%"]:k(l)||(l=[0,l]),l=[xl(l[0],s),xl(l[1],s)],r.inverse?r.setExtent(l[1],l[0]):r.setExtent(l[0],l[1]);}(i,t,s),l.push(i),(t.coordinateSystem=i).model=t;}),i.eachSeries(function(t){if("polar"===t.get("coordinateSystem")){var e=i.queryComponents({mainType:"polar",index:t.get("polarIndex"),id:t.get("polarId")})[0];t.coordinateSystem=e.coordinateSystem;}}),l;}});var eA=["axisLine","axisLabel","axisTick","splitLine","splitArea"];function iA(t,e,i){e[1]>e[0]&&(e=e.slice().reverse());var n=t.coordToPoint([e[0],i]),a=t.coordToPoint([e[1],i]);return{x1:n[0],y1:n[1],x2:a[0],y2:a[1]};}function nA(t){return t.getRadiusAxis().inverse?0:1;}function aA(t){var e=t[0],i=t[t.length-1];e&&i&&Math.abs(Math.abs(e.coord-i.coord)-360)<1e-4&&t.pop();}Um.extend({type:"angleAxis",axisPointerClass:"PolarAxisPointer",render:function render(e,t){if(this.group.removeAll(),e.get("show")){var i=e.axis,n=i.polar,a=n.getRadiusAxis().getExtent(),o=i.getTicksCoords(),r=N(i.getViewLabels(),function(t){return(t=D(t)).coord=i.dataToCoord(t.tickValue),t;});aA(r),aA(o),E(eA,function(t){!e.get(t+".show")||i.scale.isBlank()&&"axisLine"!==t||this["_"+t](e,n,o,a,r);},this);}},_axisLine:function _axisLine(t,e,i,n){var a,o=t.getModel("axisLine.lineStyle"),r=nA(e),s=r?0:1;(a=0===n[s]?new Lr({shape:{cx:e.cx,cy:e.cy,r:n[r]},style:o.getLineStyle(),z2:1,silent:!0}):new Nr({shape:{cx:e.cx,cy:e.cy,r:n[r],r0:n[s]},style:o.getLineStyle(),z2:1,silent:!0})).style.fill=null,this.group.add(a);},_axisTick:function _axisTick(t,e,i,n){var a=t.getModel("axisTick"),o=(a.get("inside")?-1:1)*a.get("length"),r=n[nA(e)],s=N(i,function(t){return new Ur({shape:iA(e,[r,r+o],t.coord)});});this.group.add(ys(s,{style:C(a.getModel("lineStyle").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})}));},_axisLabel:function _axisLabel(c,d,t,f,e){var p=c.getCategories(!0),g=c.getModel("axisLabel"),m=g.get("margin"),v=c.get("triggerEvent");E(e,function(t,e){var i=g,n=t.tickValue,a=f[nA(d)],o=d.coordToPoint([a+m,t.coord]),r=d.cx,s=d.cy,l=Math.abs(o[0]-r)/a<.3?"center":o[0]>r?"left":"right",u=Math.abs(o[1]-s)/a<.3?"middle":o[1]>s?"top":"bottom";p&&p[n]&&p[n].textStyle&&(i=new dl(p[n].textStyle,g,g.ecModel));var h=new Dr({silent:Cm.isLabelSilent(c)});this.group.add(h),Gs(h.style,i,{x:o[0],y:o[1],textFill:i.getTextColor()||c.get("axisLine.lineStyle.color"),text:t.formattedLabel,textAlign:l,textVerticalAlign:u}),v&&(h.eventData=Cm.makeAxisEventDataBase(c),h.eventData.targetType="axisLabel",h.eventData.value=t.rawLabel);},this);},_splitLine:function _splitLine(t,e,i,n){var a=t.getModel("splitLine").getModel("lineStyle"),o=a.get("color"),r=0;o=o instanceof Array?o:[o];for(var s=[],l=0;l<i.length;l++){var u=r++%o.length;s[u]=s[u]||[],s[u].push(new Ur({shape:iA(e,n,i[l].coord)}));}for(l=0;l<s.length;l++){this.group.add(ys(s[l],{style:C({stroke:o[l%o.length]},a.getLineStyle()),silent:!0,z:t.get("z")}));}},_splitArea:function _splitArea(t,e,i,n){if(i.length){var a=t.getModel("splitArea").getModel("areaStyle"),o=a.get("color"),r=0;o=o instanceof Array?o:[o];for(var s=[],l=Math.PI/180,u=-i[0].coord*l,h=Math.min(n[0],n[1]),c=Math.max(n[0],n[1]),d=t.get("clockwise"),f=1;f<i.length;f++){var p=r++%o.length;s[p]=s[p]||[],s[p].push(new Pr({shape:{cx:e.cx,cy:e.cy,r0:h,r:c,startAngle:u,endAngle:-i[f].coord*l,clockwise:d},silent:!0})),u=-i[f].coord*l;}for(f=0;f<s.length;f++){this.group.add(ys(s[f],{style:C({fill:o[f%o.length]},a.getAreaStyle()),silent:!0}));}}}});var oA=["axisLine","axisTickLabel","axisName"],rA=["splitLine","splitArea"];Um.extend({type:"radiusAxis",axisPointerClass:"PolarAxisPointer",render:function render(e,t){if(this.group.removeAll(),e.get("show")){var i=e.axis,n=i.polar,a=n.getAngleAxis(),o=i.getTicksCoords(),r=a.getExtent()[0],s=i.getExtent(),l=function(t,e,i){return{position:[t.cx,t.cy],rotation:i/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1};}(n,e,r),u=new Cm(e,l);E(oA,u.add,u),this.group.add(u.getGroup()),E(rA,function(t){e.get(t+".show")&&!i.scale.isBlank()&&this["_"+t](e,n,r,s,o);},this);}},_splitLine:function _splitLine(t,e,i,n,a){var o=t.getModel("splitLine").getModel("lineStyle"),r=o.get("color"),s=0;r=r instanceof Array?r:[r];for(var l=[],u=0;u<a.length;u++){var h=s++%r.length;l[h]=l[h]||[],l[h].push(new Lr({shape:{cx:e.cx,cy:e.cy,r:a[u].coord},silent:!0}));}for(u=0;u<l.length;u++){this.group.add(ys(l[u],{style:C({stroke:r[u%r.length],fill:null},o.getLineStyle()),silent:!0}));}},_splitArea:function _splitArea(t,e,i,n,a){if(a.length){var o=t.getModel("splitArea").getModel("areaStyle"),r=o.get("color"),s=0;r=r instanceof Array?r:[r];for(var l=[],u=a[0].coord,h=1;h<a.length;h++){var c=s++%r.length;l[c]=l[c]||[],l[c].push(new Pr({shape:{cx:e.cx,cy:e.cy,r0:u,r:a[h].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),u=a[h].coord;}for(h=0;h<l.length;h++){this.group.add(ys(l[h],{style:C({fill:r[h%r.length]},o.getAreaStyle()),silent:!0}));}}}});var sA=GM.extend({makeElOption:function makeElOption(t,e,i,n,a){var o=i.axis;"angle"===o.dim&&(this.animationThreshold=Math.PI/18);var r,s=o.polar,l=s.getOtherAxis(o).getExtent();r=o["dataTo"+Kl(o.dim)](e);var u=n.get("type");if(u&&"none"!==u){var h=UM(n),c=lA[u](o,s,r,l,h);c.style=h,t.graphicKey=c.type,t.pointer=c;}var d=n.get("label.margin");XM(t,i,n,a,function(t,e,i,n,a){var o=e.axis,r=o.dataToCoord(t),s=n.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,u,h,c=n.getRadiusAxis().getExtent();if("radius"===o.dim){var d=Qt();ae(d,d,s),ne(d,d,[n.cx,n.cy]),l=$s([r,-a],d);var f=e.getModel("axisLabel").get("rotate")||0,p=Cm.innerTextLayout(s,f*Math.PI/180,-1);u=p.textAlign,h=p.textVerticalAlign;}else{var g=c[1];l=n.coordToPoint([g+a,r]);var m=n.cx,v=n.cy;u=Math.abs(l[0]-m)/g<.3?"center":l[0]>m?"left":"right",h=Math.abs(l[1]-v)/g<.3?"middle":l[1]>v?"top":"bottom";}return{position:l,align:u,verticalAlign:h};}(e,i,0,s,d));}});var lA={line:function line(t,e,i,n,a){return"angle"===t.dim?{type:"Line",shape:KM(e.coordToPoint([n[0],i]),e.coordToPoint([n[1],i]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:i}};},shadow:function shadow(t,e,i,n,a){var o=Math.max(1,t.getBandWidth()),r=Math.PI/180;return"angle"===t.dim?{type:"Sector",shape:JM(e.cx,e.cy,n[0],n[1],(-i-o/2)*r,(o/2-i)*r)}:{type:"Sector",shape:JM(e.cx,e.cy,i-o/2,i+o/2,0,2*Math.PI)};}};function uA(n,t){t.update="updateView",tf(t,function(t,e){var i={};return e.eachComponent({mainType:"geo",query:t},function(e){e[n](t.name),E(e.coordinateSystem.regions,function(t){i[t.name]=e.isSelected(t.name)||!1;});}),{selected:i,name:t.name};});}Um.registerAxisPointerClass("PolarAxisPointer",sA),nf(A(function(t,e,i){var N={},O=function(t){var g={};E(t,function(t,e){var i=t.getData(),n=t.coordinateSystem,a=n.getBaseAxis(),o=UI(n,a),r=a.getExtent(),s="category"===a.type?a.getBandWidth():Math.abs(r[1]-r[0])/i.count(),l=g[o]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},u=l.stacks;g[o]=l;var h=ZI(t);u[h]||l.autoWidthCount++,u[h]=u[h]||{width:0,maxWidth:0};var c=xl(t.get("barWidth"),s),d=xl(t.get("barMaxWidth"),s),f=t.get("barGap"),p=t.get("barCategoryGap");c&&!u[h].width&&(c=Math.min(l.remainedWidth,c),u[h].width=c,l.remainedWidth-=c),d&&(u[h].maxWidth=d),null!=f&&(l.gap=f),null!=p&&(l.categoryGap=p);});var d={};return E(g,function(t,i){d[i]={};var e=t.stacks,n=t.bandWidth,a=xl(t.categoryGap,n),o=xl(t.gap,1),r=t.remainedWidth,s=t.autoWidthCount,l=(r-a)/(s+(s-1)*o);l=Math.max(l,0),E(e,function(t,e){var i=t.maxWidth;i&&i<l&&(i=Math.min(i,r),t.width&&(i=Math.min(i,t.width)),r-=i,t.width=i,s--);}),l=(r-a)/(s+(s-1)*o),l=Math.max(l,0);var u,h=0;E(e,function(t,e){t.width||(t.width=l),h+=(u=t).width*(1+o);}),u&&(h-=u.width*o);var c=-h/2;E(e,function(t,e){d[i][e]=d[i][e]||{offset:c,width:t.width},c+=t.width*(1+o);});}),d;}(M(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"polar"===t.coordinateSystem.type;}));e.eachSeriesByType(t,function(t){if("polar"===t.coordinateSystem.type){var e=t.getData(),i=t.coordinateSystem,n=i.getBaseAxis(),a=UI(i,n),o=ZI(t),r=O[a][o],s=r.offset,l=r.width,u=i.getOtherAxis(n),h=t.coordinateSystem.cx,c=t.coordinateSystem.cy,d=t.get("barMinHeight")||0,f=t.get("barMinAngle")||0;N[o]=N[o]||[];for(var p=e.mapDimension(u.dim),g=e.mapDimension(n.dim),m=Zf(e,p),v="radius"!==n.dim||!t.get("roundCap",!0),y=u.getExtent()[0],x=0,_=e.count();x<_;x++){var w=e.get(p,x),b=e.get(g,x);if(!isNaN(w)){var S,M,I,A,T=0<=w?"p":"n",D=y;if(m&&(N[o][b]||(N[o][b]={p:y,n:y}),D=N[o][b][T]),"radius"===u.dim){var C=u.dataToRadius(w)-y,L=n.dataToAngle(b);Math.abs(C)<d&&(C=(C<0?-1:1)*d),M=(S=D)+C,A=(I=L-s)-l,m&&(N[o][b][T]=M);}else{var k=u.dataToAngle(w,v)-y,P=n.dataToRadius(b);Math.abs(k)<f&&(k=(k<0?-1:1)*f),M=(S=P+s)+l,A=(I=D)+k,m&&(N[o][b][T]=A);}e.setItemLayout(x,{cx:h,cy:c,r0:S,r:M,startAngle:-I*Math.PI/180,endAngle:-A*Math.PI/180});}}}},this);},"bar")),lf({type:"polar"}),b(fu.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function init(t){fu.prototype.init.apply(this,arguments),ba(t,"label",["show"]);},optionUpdated:function optionUpdated(){var t=this.option,i=this;t.regions=By.getFilledRegions(t.regions,t.map,t.nameMap),this._optionModelMap=S(t.regions||[],function(t,e){return e.name&&t.set(e.name,new dl(e,i)),t;},Q()),this.updateSelectedMap(t.regions);},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function getRegionModel(t){return this._optionModelMap.get(t)||new dl(null,this,this.ecModel);},getFormattedLabel:function getFormattedLabel(t,e){var i=this.getRegionModel(t).get("label"+("normal"===e?".":e+".")+"formatter"),n={name:t};return"function"==typeof i?(n.status=e,i(n)):"string"==typeof i?i.replace("{a}",null!=t?t:""):void 0;},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;}}),xv),lf({type:"geo",init:function init(t,e){var i=new My(e,!0);this._mapDraw=i,this.group.add(i.group);},render:function render(t,e,i,n){if(!n||"geoToggleSelect"!==n.type||n.from!==this.uid){var a=this._mapDraw;t.get("show")?a.draw(t,e,i,this,n):this._mapDraw.group.removeAll(),this.group.silent=t.get("silent");}},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove();}}),uA("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),uA("select",{type:"geoSelect",event:"geoselected"}),uA("unSelect",{type:"geoUnSelect",event:"geounselected"});function hA(t,e,i){this._model=t;}function cA(t,e,i,n){var a=i.calendarModel,o=i.seriesModel,r=a?a.coordinateSystem:o?o.coordinateSystem:null;return r===this?r[t](n):null;}hA.prototype={constructor:hA,type:"calendar",dimensions:["time","value"],getDimensionsInfo:function getDimensionsInfo(){return[{name:"time",type:"time"},"value"];},getRangeInfo:function getRangeInfo(){return this._rangeInfo;},getModel:function getModel(){return this._model;},getRect:function getRect(){return this._rect;},getCellWidth:function getCellWidth(){return this._sw;},getCellHeight:function getCellHeight(){return this._sh;},getOrient:function getOrient(){return this._orient;},getFirstDayOfWeek:function getFirstDayOfWeek(){return this._firstDayOfWeek;},getDateInfo:function getDateInfo(t){var e=(t=Ll(t)).getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var n=t.getDate();n=n<10?"0"+n:n;var a=t.getDay();return{y:e,m:i,d:n,day:a=Math.abs((a+7-this.getFirstDayOfWeek())%7),time:t.getTime(),formatedDate:e+"-"+i+"-"+n,date:t};},getNextNDay:function getNextNDay(t,e){return 0===(e=e||0)||(t=new Date(this.getDateInfo(t).time)).setDate(t.getDate()+e),this.getDateInfo(t);},update:function update(t,e){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var i=this._rangeInfo.weeks||1,n=["width","height"],a=this._model.get("cellSize").slice(),o=this._model.getBoxLayoutParams(),r="horizontal"===this._orient?[i,7]:[7,i];E([0,1],function(t){u(a,t)&&(o[n[t]]=a[t]*r[t]);});var s={width:e.getWidth(),height:e.getHeight()},l=this._rect=au(o,s);function u(t,e){return null!=t[e]&&"auto"!==t[e];}E([0,1],function(t){u(a,t)||(a[t]=l[n[t]]/r[t]);}),this._sw=a[0],this._sh=a[1];},dataToPoint:function dataToPoint(t,e){k(t)&&(t=t[0]),null==e&&(e=!0);var i=this.getDateInfo(t),n=this._rangeInfo,a=i.formatedDate;if(e&&!(i.time>=n.start.time&&i.time<n.end.time+864e5))return[NaN,NaN];var o=i.day,r=this._getRangeInfo([n.start.time,a]).nthWeek;return"vertical"===this._orient?[this._rect.x+o*this._sw+this._sw/2,this._rect.y+r*this._sh+this._sh/2]:[this._rect.x+r*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2];},pointToData:function pointToData(t){var e=this.pointToDate(t);return e&&e.time;},dataToRect:function dataToRect(t,e){var i=this.dataToPoint(t,e);return{contentShape:{x:i[0]-(this._sw-this._lineWidth)/2,y:i[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:i,tl:[i[0]-this._sw/2,i[1]-this._sh/2],tr:[i[0]+this._sw/2,i[1]-this._sh/2],br:[i[0]+this._sw/2,i[1]+this._sh/2],bl:[i[0]-this._sw/2,i[1]+this._sh/2]};},pointToDate:function pointToDate(t){var e=Math.floor((t[0]-this._rect.x)/this._sw)+1,i=Math.floor((t[1]-this._rect.y)/this._sh)+1,n=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(i,e-1,n):this._getDateByWeeksAndDay(e,i-1,n);},convertToPixel:A(cA,"dataToPoint"),convertFromPixel:A(cA,"pointToData"),_initRangeOption:function _initRangeOption(){var t=this._model.get("range"),e=t;if(k(e)&&1===e.length&&(e=e[0]),/^\d{4}$/.test(e)&&(t=[e+"-01-01",e+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(e)){var i=this.getDateInfo(e),n=i.date;n.setMonth(n.getMonth()+1);var a=this.getNextNDay(n,-1);t=[i.formatedDate,a.formatedDate];}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(e)&&(t=[e,e]);var o=this._getRangeInfo(t);return o.start.time>o.end.time&&t.reverse(),t;},_getRangeInfo:function _getRangeInfo(t){var e;(t=[this.getDateInfo(t[0]),this.getDateInfo(t[1])])[0].time>t[1].time&&(e=!0,t.reverse());var i=Math.floor(t[1].time/864e5)-Math.floor(t[0].time/864e5)+1,n=new Date(t[0].time),a=n.getDate(),o=t[1].date.getDate();if(n.setDate(a+i-1),n.getDate()!==o)for(var r=0<n.getTime()-t[1].time?1:-1;n.getDate()!==o&&0<(n.getTime()-t[1].time)*r;){i-=r,n.setDate(a+i-1);}var s=Math.floor((i+t[0].day+6)/7),l=e?1-s:s-1;return e&&t.reverse(),{range:[t[0].formatedDate,t[1].formatedDate],start:t[0],end:t[1],allDay:i,weeks:s,nthWeek:l,fweek:t[0].day,lweek:t[1].day};},_getDateByWeeksAndDay:function _getDateByWeeksAndDay(t,e,i){var n=this._getRangeInfo(i);if(t>n.weeks||0===t&&e<n.fweek||t===n.weeks&&e>n.lweek)return!1;var a=7*(t-1)-n.fweek+e,o=new Date(n.start.time);return o.setDate(n.start.d+a),this.getDateInfo(o);}},hA.dimensions=hA.prototype.dimensions,hA.getDimensionsInfo=hA.prototype.getDimensionsInfo,hA.create=function(i,n){var a=[];return i.eachComponent("calendar",function(t){var e=new hA(t,i,n);a.push(e),t.coordinateSystem=e;}),i.eachSeries(function(t){"calendar"===t.get("coordinateSystem")&&(t.coordinateSystem=a[t.get("calendarIndex")||0]);}),a;},Hu.register("calendar",hA);var dA=fu.extend({type:"calendar",coordinateSystem:null,defaultOption:{zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",nameMap:"en",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",nameMap:"en",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},init:function init(t,e,i,n){var a=su(t);dA.superApply(this,"init",arguments),fA(t,a);},mergeOption:function mergeOption(t,e){dA.superApply(this,"mergeOption",arguments),fA(this.option,t);}});function fA(t,e){var i=t.cellSize;k(i)?1===i.length&&(i[1]=i[0]):i=t.cellSize=[i,i];var n=N([0,1],function(t){return function(t,e){return null!=t[eu[e][0]]||null!=t[eu[e][1]]&&null!=t[eu[e][2]];}(e,t)&&(i[t]="auto"),null!=i[t]&&"auto"!==i[t];});ru(t,e,{type:"box",ignoreSize:n});}var pA={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},gA={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};lf({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function render(t,e,i){var n=this.group;n.removeAll();var a=t.coordinateSystem,o=a.getRangeInfo(),r=a.getOrient();this._renderDayRect(t,o,n),this._renderLines(t,o,r,n),this._renderYearText(t,o,r,n),this._renderMonthText(t,r,n),this._renderWeekText(t,o,r,n);},_renderDayRect:function _renderDayRect(t,e,i){for(var n=t.coordinateSystem,a=t.getModel("itemStyle").getItemStyle(),o=n.getCellWidth(),r=n.getCellHeight(),s=e.start.time;s<=e.end.time;s=n.getNextNDay(s,1).time){var l=n.dataToRect([s],!1).tl,u=new Hr({shape:{x:l[0],y:l[1],width:o,height:r},cursor:"default",style:a});i.add(u);}},_renderLines:function _renderLines(i,t,n,a){var o=this,r=i.coordinateSystem,s=i.getModel("splitLine.lineStyle").getLineStyle(),l=i.get("splitLine.show"),e=s.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var u=t.start,h=0;u.time<=t.end.time;h++){d(u.formatedDate),0===h&&(u=r.getDateInfo(t.start.y+"-"+t.start.m));var c=u.date;c.setMonth(c.getMonth()+1),u=r.getDateInfo(c);}function d(t){o._firstDayOfMonth.push(r.getDateInfo(t)),o._firstDayPoints.push(r.dataToRect([t],!1).tl);var e=o._getLinePointsOfOneWeek(i,t,n);o._tlpoints.push(e[0]),o._blpoints.push(e[e.length-1]),l&&o._drawSplitline(e,s,a);}d(r.getNextNDay(t.end.time,1).formatedDate),l&&this._drawSplitline(o._getEdgesPoints(o._tlpoints,e,n),s,a),l&&this._drawSplitline(o._getEdgesPoints(o._blpoints,e,n),s,a);},_getEdgesPoints:function _getEdgesPoints(t,e,i){var n=[t[0].slice(),t[t.length-1].slice()],a="horizontal"===i?0:1;return n[0][a]=n[0][a]-e/2,n[1][a]=n[1][a]+e/2,n;},_drawSplitline:function _drawSplitline(t,e,i){var n=new zr({z2:20,shape:{points:t},style:e});i.add(n);},_getLinePointsOfOneWeek:function _getLinePointsOfOneWeek(t,e,i){var n=t.coordinateSystem;e=n.getDateInfo(e);for(var a=[],o=0;o<7;o++){var r=n.getNextNDay(e.time,o),s=n.dataToRect([r.time],!1);a[2*r.day]=s.tl,a[2*r.day+1]=s["horizontal"===i?"bl":"tr"];}return a;},_formatterLabel:function _formatterLabel(t,e){return"string"==typeof t&&t?Xl(t,e):"function"==typeof t?t(e):e.nameMap;},_yearTextPositionControl:function _yearTextPositionControl(t,e,i,n,a){e=e.slice();var o=["center","bottom"];"bottom"===n?(e[1]+=a,o=["center","top"]):"left"===n?e[0]-=a:"right"===n?(e[0]+=a,o=["center","top"]):e[1]-=a;var r=0;return"left"!==n&&"right"!==n||(r=Math.PI/2),{rotation:r,position:e,style:{textAlign:o[0],textVerticalAlign:o[1]}};},_renderYearText:function _renderYearText(t,e,i,n){var a=t.getModel("yearLabel");if(a.get("show")){var o=a.get("margin"),r=a.get("position");r=r||("horizontal"!==i?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,u=(s[0][1]+s[1][1])/2,h="horizontal"===i?0:1,c={top:[l,s[h][1]],bottom:[l,s[1-h][1]],left:[s[1-h][0],u],right:[s[h][0],u]},d=e.start.y;+e.end.y>+e.start.y&&(d=d+"-"+e.end.y);var f=a.get("formatter"),p={start:e.start.y,end:e.end.y,nameMap:d},g=this._formatterLabel(f,p),m=new Dr({z2:30});Gs(m.style,a,{text:g}),m.attr(this._yearTextPositionControl(m,c[r],i,r,o)),n.add(m);}},_monthTextPositionControl:function _monthTextPositionControl(t,e,i,n,a){var o="left",r="top",s=t[0],l=t[1];return"horizontal"===i?(l+=a,e&&(o="center"),"start"===n&&(r="bottom")):(s+=a,e&&(r="middle"),"start"===n&&(o="right")),{x:s,y:l,textAlign:o,textVerticalAlign:r};},_renderMonthText:function _renderMonthText(t,e,i){var n=t.getModel("monthLabel");if(n.get("show")){var a=n.get("nameMap"),o=n.get("margin"),r=n.get("position"),s=n.get("align"),l=[this._tlpoints,this._blpoints];R(a)&&(a=pA[a.toUpperCase()]||[]);var u="start"===r?0:1,h="horizontal"===e?0:1;o="start"===r?-o:o;for(var c="center"===s,d=0;d<l[u].length-1;d++){var f=l[u][d].slice(),p=this._firstDayOfMonth[d];if(c){var g=this._firstDayPoints[d];f[h]=(g[h]+l[0][d+1][h])/2;}var m=n.get("formatter"),v=a[+p.m-1],y={yyyy:p.y,yy:(p.y+"").slice(2),MM:p.m,M:+p.m,nameMap:v},x=this._formatterLabel(m,y),_=new Dr({z2:30});L(Gs(_.style,n,{text:x}),this._monthTextPositionControl(f,c,e,r,o)),i.add(_);}}},_weekTextPositionControl:function _weekTextPositionControl(t,e,i,n,a){var o="center",r="middle",s=t[0],l=t[1],u="start"===i;return"horizontal"===e?(s=s+n+(u?1:-1)*a[0]/2,o=u?"right":"left"):(l=l+n+(u?1:-1)*a[1]/2,r=u?"bottom":"top"),{x:s,y:l,textAlign:o,textVerticalAlign:r};},_renderWeekText:function _renderWeekText(t,e,i,n){var a=t.getModel("dayLabel");if(a.get("show")){var o=t.coordinateSystem,r=a.get("position"),s=a.get("nameMap"),l=a.get("margin"),u=o.getFirstDayOfWeek();R(s)&&(s=gA[s.toUpperCase()]||[]);var h=o.getNextNDay(e.end.time,7-e.lweek).time,c=[o.getCellWidth(),o.getCellHeight()];l=xl(l,c["horizontal"===i?0:1]),"start"===r&&(h=o.getNextNDay(e.start.time,-(7+e.fweek)).time,l=-l);for(var d=0;d<7;d++){var f,p=o.getNextNDay(h,d),g=o.dataToRect([p.time],!1).center;f=Math.abs((d+u)%7);var m=new Dr({z2:30});L(Gs(m.style,a,{text:s[f]}),this._weekTextPositionControl(g,i,r,l,c)),n.add(m);}}}});var mA={path:null,compoundPath:null,group:Si,image:Yn,text:Dr};Jd(function(t){var e=t.graphic;k(e)?e[0]&&e[0].elements?t.graphic=[t.graphic[0]]:t.graphic=[{elements:e}]:e&&!e.elements&&(t.graphic=[{elements:[e]}]);});var vA=sf({type:"graphic",defaultOption:{elements:[],parentId:null},_elOptionsToUpdate:null,mergeOption:function mergeOption(t){var e=this.option.elements;this.option.elements=null,vA.superApply(this,"mergeOption",arguments),this.option.elements=e;},optionUpdated:function optionUpdated(t,e){var i=this.option,n=(e?i:t).elements,a=i.elements=e?[]:i.elements,o=[];this._flatten(n,o);var r=Ia(a,o);Aa(r);var s=this._elOptionsToUpdate=[];E(r,function(t,e){var i=t.option;i&&(s.push(i),function(t,e){var i=t.exist;if(e.id=t.keyInfo.id,!e.type&&i&&(e.type=i.type),null==e.parentId){var n=e.parentOption;n?e.parentId=n.id:i&&(e.parentId=i.parentId);}e.parentOption=null;}(t,i),function(t,e,i){var n=L({},i),a=t[e],o=i.$action||"merge";"merge"===o?a?(m(a,n,!0),ru(a,n,{ignoreSize:!0}),lu(i,a)):t[e]=n:"replace"===o?t[e]=n:"remove"===o&&a&&(t[e]=null);}(a,e,i),function(t,e){if(!t)return;t.hv=e.hv=[_A(e,["left","right"]),_A(e,["top","bottom"])],"group"===t.type&&(null==t.width&&(t.width=e.width=0),null==t.height&&(t.height=e.height=0));}(a[e],i));},this);for(var l=a.length-1;0<=l;l--){null==a[l]?a.splice(l,1):delete a[l].$action;}},_flatten:function _flatten(t,i,n){E(t,function(t){if(t){n&&(t.parentOption=n),i.push(t);var e=t.children;"group"===t.type&&e&&this._flatten(e,i,t),delete t.children;}},this);},useElOptionsToUpdate:function useElOptionsToUpdate(){var t=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,t;}});function yA(t,e,i,n){var a=i.type,o=new(mA.hasOwnProperty(a)?mA[a]:ps(a))(i);e.add(o),n.set(t,o),o.__ecGraphicId=t;}function xA(t,e){var i=t&&t.parent;i&&("group"===t.type&&t.traverse(function(t){xA(t,e);}),e.removeKey(t.__ecGraphicId),i.remove(t));}function _A(e,t){var i;return E(t,function(t){null!=e[t]&&"auto"!==e[t]&&(i=!0);}),i;}lf({type:"graphic",init:function init(t,e){this._elMap=Q(),this._lastGraphicModel;},render:function render(t,e,i){t!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=t,this._updateElements(t),this._relocate(t,i);},_updateElements:function _updateElements(u){var t=u.useElOptionsToUpdate();if(t){var h=this._elMap,c=this.group;E(t,function(t){var e=t.$action,i=t.id,n=h.get(i),a=t.parentId,o=null!=a?h.get(a):c,r=t.style;"text"===t.type&&r&&(t.hv&&t.hv[1]&&(r.textVerticalAlign=r.textBaseline=null),!r.hasOwnProperty("textFill")&&r.fill&&(r.textFill=r.fill),!r.hasOwnProperty("textStroke")&&r.stroke&&(r.textStroke=r.stroke));var s=function(e){return e=L({},e),E(["id","parentId","$action","hv","bounding"].concat(tu),function(t){delete e[t];}),e;}(t);e&&"merge"!==e?"replace"===e?(xA(n,h),yA(i,o,s,h)):"remove"===e&&xA(n,h):n?n.attr(s):yA(i,o,s,h);var l=h.get(i);l&&(l.__ecGraphicWidthOption=t.width,l.__ecGraphicHeightOption=t.height,function(t,e){var i=t.eventData;t.silent||t.ignore||i||(i=t.eventData={componentType:"graphic",componentIndex:e.componentIndex,name:t.name});i&&(i.info=t.info);}(l,u));});}},_relocate:function _relocate(t,e){for(var i=t.option.elements,n=this.group,a=this._elMap,o=e.getWidth(),r=e.getHeight(),s=0;s<i.length;s++){var l=i[s];if((h=a.get(l.id))&&h.isGroup){var u=(c=h.parent)===n;h.__ecGraphicWidth=xl(h.__ecGraphicWidthOption,u?o:c.__ecGraphicWidth)||0,h.__ecGraphicHeight=xl(h.__ecGraphicHeightOption,u?r:c.__ecGraphicHeight)||0;}}for(s=i.length-1;0<=s;s--){var h,c;l=i[s];if(h=a.get(l.id))ou(h,l,(c=h.parent)===n?{width:o,height:r}:{width:c.__ecGraphicWidth,height:c.__ecGraphicHeight},null,{hv:l.hv,boundingMode:l.bounding});}},_clear:function _clear(){var e=this._elMap;e.each(function(t){xA(t,e);}),this._elMap=Q();},dispose:function dispose(){this._clear();}});var wA={};function bA(t,e){wA[t]=e;}function SA(t){return wA[t];}var MA=sf({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},optionUpdated:function optionUpdated(){MA.superApply(this,"optionUpdated",arguments),E(this.option.feature,function(t,e){var i=SA(e);i&&m(t,i.defaultOption);});},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1}}});function IA(t,e){var i=Vl(e.get("padding")),n=e.getItemStyle(["color","opacity"]);return n.fill=e.get("backgroundColor"),t=new Hr({shape:{x:t.x-i[3],y:t.y-i[0],width:t.width+i[1]+i[3],height:t.height+i[0]+i[2],r:e.get("borderRadius")},style:n,silent:!0,z2:-1});}lf({type:"toolbox",render:function render(h,c,d,s){var f=this.group;if(f.removeAll(),h.get("show")){var p=+h.get("itemSize"),l=h.get("feature")||{},u=this._features||(this._features={}),g=[];E(l,function(t,e){g.push(e);}),new df(this._featureNames||[],g).add(t).update(t).remove(A(t,null)).execute(),this._featureNames=g,function(t,e,i){var n=e.getBoxLayoutParams(),a=e.get("padding"),o={width:i.getWidth(),height:i.getHeight()},r=au(n,o,a);nu(e.get("orient"),t,e.get("itemGap"),r.width,r.height),ou(t,n,o,a);}(f,h,d),f.add(IA(f.getBoundingRect(),h)),f.eachChild(function(t){var e=t.__title,i=t.hoverStyle;if(i&&e){var n=un(e,wn(i)),a=t.position[0]+f.position[0],o=!1;t.position[1]+f.position[1]+p+n.height>d.getHeight()&&(i.textPosition="top",o=!0);var r=o?-5-n.height:p+8;a+n.width/2>d.getWidth()?(i.textPosition=["100%",r],i.textAlign="right"):a-n.width/2<0&&(i.textPosition=[0,r],i.textAlign="left");}});}function t(t,e){var i,n=g[t],a=g[e],o=new dl(l[n],h,h.ecModel);if(n&&!a){if(function(t){return 0===t.indexOf("my");}(n))i={model:o,onclick:o.option.onclick,featureName:n};else{var r=SA(n);if(!r)return;i=new r(o,c,d);}u[n]=i;}else{if(!(i=u[a]))return;i.model=o,i.ecModel=c,i.api=d;}n||!a?o.get("show")&&!i.unusable?(function(a,o,t){var r=a.getModel("iconStyle"),s=a.getModel("emphasis.iconStyle"),e=o.getIcons?o.getIcons():a.get("icon"),l=a.get("title")||{};if("string"==typeof e){var i=e,n=l;l={},(e={})[t]=i,l[t]=n;}var u=a.iconPaths={};E(e,function(t,e){var i=el(t,{},{x:-p/2,y:-p/2,width:p,height:p});i.setStyle(r.getItemStyle()),i.hoverStyle=s.getItemStyle(),i.setStyle({text:l[e],textAlign:s.get("textAlign"),textBorderRadius:s.get("textBorderRadius"),textPadding:s.get("textPadding"),textFill:null});var n=h.getModel("tooltip");n&&n.get("show")&&i.attr("tooltip",L({content:l[e],formatter:n.get("formatter",!0)||function(){return l[e];},formatterParams:{componentType:"toolbox",name:e,title:l[e],$vars:["name","title"]},position:n.get("position",!0)||"bottom"},n.option)),Os(i),h.get("showTitle")&&(i.__title=l[e],i.on("mouseover",function(){var t=s.getItemStyle(),e="vertical"===h.get("orient")?null==h.get("right")?"right":"left":null==h.get("bottom")?"bottom":"top";i.setStyle({textFill:s.get("textFill")||t.fill||t.stroke||"#000",textBackgroundColor:s.get("textBackgroundColor"),textPosition:s.get("textPosition")||e});}).on("mouseout",function(){i.setStyle({textFill:null,textBackgroundColor:null});})),i.trigger(a.get("iconStatus."+e)||"normal"),f.add(i),i.on("click",T(o.onclick,o,c,d,e)),u[e]=i;});}(o,i,n),o.setIconStatus=function(t,e){var i=this.option,n=this.iconPaths;i.iconStatus=i.iconStatus||{},i.iconStatus[t]=e,n[t]&&n[t].trigger(e);},i.render&&i.render(o,c,d,s)):i.remove&&i.remove(c,d):i.dispose&&i.dispose(c,d);}},updateView:function updateView(t,e,i,n){E(this._features,function(t){t.updateView&&t.updateView(t.model,e,i,n);});},remove:function remove(e,i){E(this._features,function(t){t.remove&&t.remove(e,i);}),this.group.removeAll();},dispose:function dispose(e,i){E(this._features,function(t){t.dispose&&t.dispose(e,i);});}});var AA=gc.toolbox.saveAsImage;function TA(t){this.model=t;}TA.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:AA.title,type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:AA.lang.slice()},TA.prototype.unusable=!v.canvasSupported,TA.prototype.onclick=function(t,e){var i=this.model,n=i.get("name")||t.get("title.0.text")||"echarts",a=i.get("type",!0)||"png",o=e.getConnectedDataURL({type:a,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")});if("function"!=typeof MouseEvent||v.browser.ie||v.browser.edge){if(window.navigator.msSaveOrOpenBlob){for(var r=atob(o.split(",")[1]),s=r.length,l=new Uint8Array(s);s--;){l[s]=r.charCodeAt(s);}var u=new Blob([l]);window.navigator.msSaveOrOpenBlob(u,n+"."+a);}else{var h=i.get("lang"),c='<body style="margin:0;"><img src="'+o+'" style="max-width:100%;" title="'+(h&&h[0]||"")+'" /></body>';window.open().document.write(c);}}else{var d=document.createElement("a");d.download=n+"."+a,d.target="_blank",d.href=o;var f=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});d.dispatchEvent(f);}},bA("saveAsImage",TA);var DA=gc.toolbox.magicType;function CA(t){this.model=t;}CA.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z",tiled:"M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z"},title:D(DA.title),option:{},seriesIndex:{}};var LA=CA.prototype;LA.getIcons=function(){var t=this.model,e=t.get("icon"),i={};return E(t.get("type"),function(t){e[t]&&(i[t]=e[t]);}),i;};var kA={line:function line(t,e,i,n){if("bar"===t)return m({id:e,type:"line",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.line")||{},!0);},bar:function bar(t,e,i,n){if("line"===t)return m({id:e,type:"bar",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.bar")||{},!0);},stack:function stack(t,e,i,n){if("line"===t||"bar"===t)return m({id:e,stack:"__ec_magicType_stack__"},n.get("option.stack")||{},!0);},tiled:function tiled(t,e,i,n){if("line"===t||"bar"===t)return m({id:e,stack:""},n.get("option.tiled")||{},!0);}},PA=[["line","bar"],["stack","tiled"]];LA.onclick=function(u,t,h){var c=this.model,e=c.get("seriesIndex."+h);if(kA[h]){var d={series:[]};E(PA,function(t){0<=_(t,h)&&E(t,function(t){c.setIconStatus(t,"normal");});}),c.setIconStatus(h,"emphasis"),u.eachComponent({mainType:"series",query:null==e?null:{seriesIndex:e}},function(t){var e=t.subType,i=t.id,n=kA[h](e,i,t,c);n&&(C(n,t.option),d.series.push(n));var a=t.coordinateSystem;if(a&&"cartesian2d"===a.type&&("line"===h||"bar"===h)){var o=a.getAxesByScale("ordinal")[0];if(o){var r=o.dim+"Axis",s=u.queryComponents({mainType:r,index:t.get(name+"Index"),id:t.get(name+"Id")})[0].componentIndex;d[r]=d[r]||[];for(var l=0;l<=s;l++){d[r][s]=d[r][s]||{};}d[r][s].boundaryGap="bar"===h;}}}),t.dispatchAction({type:"changeMagicType",currentType:h,newOption:d});}},tf({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption);}),bA("magicType",CA);var NA=gc.toolbox.dataView,OA=new Array(60).join("-"),EA="\t";function RA(t){var e=function(t){var a={},o=[],r=[];return t.eachRawSeries(function(t){var e=t.coordinateSystem;if(!e||"cartesian2d"!==e.type&&"polar"!==e.type)o.push(t);else{var i=e.getBaseAxis();if("category"===i.type){var n=i.dim+"_"+i.index;a[n]||(a[n]={categoryAxis:i,valueAxis:e.getOtherAxis(i),series:[]},r.push({axisDim:i.dim,axisIndex:i.index})),a[n].series.push(t);}else o.push(t);}}),{seriesGroupByCategoryAxis:a,other:o,meta:r};}(t);return{value:M([function(t){var h=[];return E(t,function(t,e){var i=t.categoryAxis,n=t.valueAxis.dim,a=[" "].concat(N(t.series,function(t){return t.name;})),o=[i.model.getCategories()];E(t.series,function(t){o.push(t.getRawData().mapArray(n,function(t){return t;}));});for(var r=[a.join(EA)],s=0;s<o[0].length;s++){for(var l=[],u=0;u<o.length;u++){l.push(o[u][s]);}r.push(l.join(EA));}h.push(r.join("\n"));}),h.join("\n\n"+OA+"\n\n");}(e.seriesGroupByCategoryAxis),function(t){return N(t,function(t){var a=t.getRawData(),o=[t.name],r=[];return a.each(a.dimensions,function(){for(var t=arguments.length,e=arguments[t-1],i=a.getName(e),n=0;n<t-1;n++){r[n]=arguments[n];}o.push((i?i+EA:"")+r.join(EA));}),o.join("\n");}).join("\n\n"+OA+"\n\n");}(e.other)],function(t){return t.replace(/[\n\t\s]/g,"");}).join("\n\n"+OA+"\n\n"),meta:e.meta};}function zA(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}var BA=new RegExp("["+EA+"]+","g");function VA(t,o){var e=t.split(new RegExp("\n*"+OA+"\n*","g")),r={series:[]};return E(e,function(t,e){if(function(t){if(0<=t.slice(0,t.indexOf("\n")).indexOf(EA))return!0;}(t)){var i=function(t){for(var e=t.split(/\n+/g),i=[],n=N(zA(e.shift()).split(BA),function(t){return{name:t,data:[]};}),a=0;a<e.length;a++){var o=zA(e[a]).split(BA);i.push(o.shift());for(var r=0;r<o.length;r++){n[r]&&(n[r].data[a]=o[r]);}}return{series:n,categories:i};}(t),n=o[e],a=n.axisDim+"Axis";n&&(r[a]=r[a]||[],r[a][n.axisIndex]={data:i.categories},r.series=r.series.concat(i.series));}else{i=function(t){for(var e=t.split(/\n+/g),i=zA(e.shift()),n=[],a=0;a<e.length;a++){var o,r=zA(e[a]).split(BA),s="",l=!1;o=isNaN(r[0])?(l=!0,s=r[0],r=r.slice(1),n[a]={name:s,value:[]},n[a].value):n[a]=[];for(var u=0;u<r.length;u++){o.push(+r[u]);}1===o.length&&(l?n[a].value=o[0]:n[a]=o[0]);}return{name:i,data:n};}(t);r.series.push(i);}}),r;}function GA(t){this._dom=null,this.model=t;}GA.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:D(NA.title),lang:D(NA.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},GA.prototype.onclick=function(t,e){var i=e.getDom(),n=this.model;this._dom&&i.removeChild(this._dom);var a=document.createElement("div");a.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",a.style.backgroundColor=n.get("backgroundColor")||"#fff";var o=document.createElement("h4"),r=n.get("lang")||[];o.innerHTML=r[0]||n.get("title"),o.style.cssText="margin: 10px 20px;",o.style.color=n.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var u=n.get("optionToContent"),h=n.get("contentToOption"),c=RA(t);if("function"==typeof u){var d=u(e.getOption());"string"==typeof d?s.innerHTML=d:G(d)&&s.appendChild(d);}else s.appendChild(l),l.readOnly=n.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=n.get("textColor"),l.style.borderColor=n.get("textareaBorderColor"),l.style.backgroundColor=n.get("textareaColor"),l.value=c.value;var f=c.meta,p=document.createElement("div");p.style.cssText="position:absolute;bottom:0;left:0;right:0;";var g="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",m=document.createElement("div"),v=document.createElement("div");g+=";background-color:"+n.get("buttonColor"),g+=";color:"+n.get("buttonTextColor");var y=this;function x(){i.removeChild(a),y._dom=null;}Gt(m,"click",x),Gt(v,"click",function(){var t;try{t="function"==typeof h?h(s,e.getOption()):VA(l.value,f);}catch(t){throw x(),new Error("Data view format error "+t);}t&&e.dispatchAction({type:"changeDataView",newOption:t}),x();}),m.innerHTML=r[1],v.innerHTML=r[2],v.style.cssText=g,m.style.cssText=g,n.get("readOnly")||p.appendChild(v),p.appendChild(m),a.appendChild(o),a.appendChild(s),a.appendChild(p),s.style.height=i.clientHeight-80+"px",i.appendChild(a),this._dom=a;},GA.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom);},GA.prototype.dispose=function(t,e){this.remove(t,e);},bA("dataView",GA),tf({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,n){var a=[];E(t.newOption.series,function(t){var e=n.getSeriesByName(t.name)[0];if(e){var i=e.get("data");a.push({name:t.name,data:function(t,n){return N(t,function(t,e){var i=n&&n[e];return z(i)&&!k(i)?(z(t)&&!k(t)&&(t=t.value),C({value:t},i)):t;});}(t.data,i)});}else a.push(L({type:"scatter"},t));}),n.mergeOption(C({series:a},t.newOption));});var FA=E,WA=_,HA=A,ZA=["dataToPoint","pointToData"],UA=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"];function XA(t,e,i){var n=this._targetInfoList=[],a={},o=qA(e,t);FA(KA,function(t,e){i&&i.include&&!(0<=WA(i.include,e))||t(o,n,a);});}var YA=XA.prototype;function jA(t){return t[0]>t[1]&&t.reverse(),t;}function qA(t,e){return Pa(t,e,{includeMainTypes:UA});}YA.setOutputRanges=function(t,e){this.matchOutputRanges(t,e,function(t,e,i){if((t.coordRanges||(t.coordRanges=[])).push(e),!t.coordRange){t.coordRange=e;var n=QA[t.brushType](0,i,e);t.__rangeOffset={offset:eT[t.brushType](n.values,t.range,[1,1]),xyMinMax:n.xyMinMax};}});},YA.matchOutputRanges=function(t,n,a){FA(t,function(i){var t=this.findTargetInfo(i,n);t&&!0!==t&&E(t.coordSyses,function(t){var e=QA[i.brushType](1,t,i.range);a(i,e.values,t,n);});},this);},YA.setInputRanges=function(t,a){FA(t,function(t){var e=this.findTargetInfo(t,a);if(t.range=t.range||[],e&&!0!==e){t.panelId=e.panelId;var i=QA[t.brushType](0,e.coordSys,t.coordRange),n=t.__rangeOffset;t.range=n?eT[t.brushType](i.values,n.offset,function(t,e){var i=nT(t),n=nT(e),a=[i[0]/n[0],i[1]/n[1]];return isNaN(a[0])&&(a[0]=1),isNaN(a[1])&&(a[1]=1),a;}(i.xyMinMax,n.xyMinMax)):i.values;}},this);},YA.makePanelOpts=function(i,n){return N(this._targetInfoList,function(t){var e=t.getPanelRect();return{panelId:t.panelId,defaultBrushType:n&&n(t),clipPath:Mb(e),isTargetByCursor:Ab(e,i,t.coordSysModel),getLinearBrushOtherExtent:Ib(e)};});},YA.controlSeries=function(t,e,i){var n=this.findTargetInfo(t,i);return!0===n||n&&0<=WA(n.coordSyses,e.coordinateSystem);},YA.findTargetInfo=function(t,e){for(var i=this._targetInfoList,n=qA(e,t),a=0;a<i.length;a++){var o=i[a],r=t.panelId;if(r){if(o.panelId===r)return o;}else for(a=0;a<$A.length;a++){if($A[a](n,o))return o;}}return!0;};var KA={grid:function grid(t,n){var a=t.xAxisModels,o=t.yAxisModels,e=t.gridModels,i=Q(),r={},s={};(a||o||e)&&(FA(a,function(t){var e=t.axis.grid.model;i.set(e.id,e),r[e.id]=!0;}),FA(o,function(t){var e=t.axis.grid.model;i.set(e.id,e),s[e.id]=!0;}),FA(e,function(t){i.set(t.id,t),r[t.id]=!0,s[t.id]=!0;}),i.each(function(t){var e=t.coordinateSystem,i=[];FA(e.getCartesians(),function(t,e){(0<=WA(a,t.getAxis("x").model)||0<=WA(o,t.getAxis("y").model))&&i.push(t);}),n.push({panelId:"grid--"+t.id,gridModel:t,coordSysModel:t,coordSys:i[0],coordSyses:i,getPanelRect:JA.grid,xAxisDeclared:r[t.id],yAxisDeclared:s[t.id]});}));},geo:function geo(t,i){FA(t.geoModels,function(t){var e=t.coordinateSystem;i.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:e,coordSyses:[e],getPanelRect:JA.geo});});}},$A=[function(t,e){var i=t.xAxisModel,n=t.yAxisModel,a=t.gridModel;return!a&&i&&(a=i.axis.grid.model),!a&&n&&(a=n.axis.grid.model),a&&a===e.gridModel;},function(t,e){var i=t.geoModel;return i&&i===e.geoModel;}],JA={grid:function grid(){return this.coordSys.grid.getRect().clone();},geo:function geo(){var t=this.coordSys,e=t.getBoundingRect().clone();return e.applyTransform(Ks(t)),e;}},QA={lineX:HA(tT,0),lineY:HA(tT,1),rect:function rect(t,e,i){var n=e[ZA[t]]([i[0][0],i[1][0]]),a=e[ZA[t]]([i[0][1],i[1][1]]),o=[jA([n[0],a[0]]),jA([n[1],a[1]])];return{values:o,xyMinMax:o};},polygon:function polygon(i,n,t){var a=[[1/0,-1/0],[1/0,-1/0]];return{values:N(t,function(t){var e=n[ZA[i]](t);return a[0][0]=Math.min(a[0][0],e[0]),a[1][0]=Math.min(a[1][0],e[1]),a[0][1]=Math.max(a[0][1],e[0]),a[1][1]=Math.max(a[1][1],e[1]),e;}),xyMinMax:a};}};function tT(t,e,i,n){var a=i.getAxis(["x","y"][t]),o=jA(N([0,1],function(t){return e?a.coordToData(a.toLocalCoord(n[t])):a.toGlobalCoord(a.dataToCoord(n[t]));})),r=[];return r[t]=o,r[1-t]=[NaN,NaN],{values:o,xyMinMax:r};}var eT={lineX:HA(iT,0),lineY:HA(iT,1),rect:function rect(t,e,i){return[[t[0][0]-i[0]*e[0][0],t[0][1]-i[0]*e[0][1]],[t[1][0]-i[1]*e[1][0],t[1][1]-i[1]*e[1][1]]];},polygon:function polygon(t,i,n){return N(t,function(t,e){return[t[0]-n[0]*i[e][0],t[1]-n[1]*i[e][1]];});}};function iT(t,e,i,n){return[e[0]-n[t]*i[0],e[1]-n[t]*i[1]];}function nT(t){return t?[t[0][1]-t[0][0],t[1][1]-t[1][0]]:[NaN,NaN];}var aT=E,oT="\0_ec_hist_store";function rT(t){var e=t[oT];return e=e||(t[oT]=[{}]);}fu.registerSubTypeDefaulter("dataZoom",function(){return"slider";});var sT=["cartesian2d","polar","singleAxis"];var lT,uT,hT,cT,dT=(uT=["axisIndex","axis","index","id"],hT=N(lT=(lT=["x","y","z","radius","angle","single"]).slice(),Kl),cT=N(uT=(uT||[]).slice(),Kl),function(a,o){E(lT,function(t,e){for(var i={name:t,capital:hT[e]},n=0;n<uT.length;n++){i[uT[n]]=t+cT[n];}a.call(o,i);});});function fT(a,o,r){return function(t){var e,i={nodes:[],records:{}};if(o(function(t){i.records[t.name]={};}),!t)return i;for(s(t,i);e=!1,a(n),e;){;}function n(t){!function(t,e){return 0<=_(e.nodes,t);}(t,i)&&function(t,i){var n=!1;return o(function(e){E(r(t,e)||[],function(t){i.records[e.name][t]&&(n=!0);});}),n;}(t,i)&&(s(t,i),e=!0);}return i;};function s(t,i){i.nodes.push(t),o(function(e){E(r(t,e)||[],function(t){i.records[e.name][t]=!0;});});}}function pT(t,e,i,n){this._dimName=t,this._axisIndex=e,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=n,this._dataZoomModel=i;}var gT=E,mT=wl;function vT(t,e){var i=t.getAxisModel(),n=t._percentWindow,a=t._valueWindow;if(n){var o=Ml(a,[0,500]);o=Math.min(o,20);var r=e||0===n[0]&&100===n[1];i.setRange(r?null:+a[0].toFixed(o),r?null:+a[1].toFixed(o));}}pT.prototype={constructor:pT,hostedBy:function hostedBy(t){return this._dataZoomModel===t;},getDataValueWindow:function getDataValueWindow(){return this._valueWindow.slice();},getDataPercentWindow:function getDataPercentWindow(){return this._percentWindow.slice();},getTargetSeriesModels:function getTargetSeriesModels(){var n=[],a=this.ecModel;return a.eachSeries(function(t){if(function(t){return 0<=_(sT,t);}(t.get("coordinateSystem"))){var e=this._dimName,i=a.queryComponents({mainType:e+"Axis",index:t.get(e+"AxisIndex"),id:t.get(e+"AxisId")})[0];this._axisIndex===(i&&i.componentIndex)&&n.push(t);}},this),n;},getAxisModel:function getAxisModel(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex);},getOtherAxisModel:function getOtherAxisModel(){var t,e,i,n=this._dimName,a=this.ecModel,o=this.getAxisModel();return t="x"===n||"y"===n?(e="gridIndex","x"===n?"y":"x"):(e="polarIndex","angle"===n?"radius":"angle"),a.eachComponent(t+"Axis",function(t){(t.get(e)||0)===(o.get(e)||0)&&(i=t);}),i;},getMinMaxSpan:function getMinMaxSpan(){return D(this._minMaxSpan);},calculateDataWindow:function calculateDataWindow(a){var o,r=this._dataExtent,s=this.getAxisModel().axis.scale,l=this._dataZoomModel.getRangePropMode(),u=[0,100],h=[],c=[];gT(["start","end"],function(t,e){var i=a[t],n=a[t+"Value"];"percent"===l[e]?(null==i&&(i=u[e]),n=s.parse(yl(i,u,r))):(o=!0,i=yl(n=null==n?r[e]:s.parse(n),r,u)),c[e]=n,h[e]=i;}),mT(c),mT(h);var d=this._minMaxSpan;function t(t,e,i,n,a){var o=a?"Span":"ValueSpan";ww(0,t,i,"all",d["min"+o],d["max"+o]);for(var r=0;r<2;r++){e[r]=yl(t[r],i,n,!0),a&&(e[r]=s.parse(e[r]));}}return o?t(c,h,r,u,!1):t(h,c,u,r,!0),{valueWindow:c,percentWindow:h};},reset:function reset(t){if(t===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=function(t,e,i){var n=[1/0,-1/0];gT(i,function(t){var i=t.getData();i&&gT(i.mapDimension(e,!0),function(t){var e=i.getApproximateExtent(t);e[0]<n[0]&&(n[0]=e[0]),e[1]>n[1]&&(n[1]=e[1]);});}),n[1]<n[0]&&(n=[NaN,NaN]);return function(t,e){var i=t.getAxisModel(),n=i.getMin(!0),a="category"===i.get("type"),o=a&&i.getCategories().length;null!=n&&"dataMin"!==n&&"function"!=typeof n?e[0]=n:a&&(e[0]=0<o?0:NaN);var r=i.getMax(!0);null!=r&&"dataMax"!==r&&"function"!=typeof r?e[1]=r:a&&(e[1]=0<o?o-1:NaN);i.get("scale",!0)||(0<e[0]&&(e[0]=0),e[1]<0&&(e[1]=0));}(t,n),n;}(this,this._dimName,e),function(n){var a=n._minMaxSpan={},o=n._dataZoomModel,r=n._dataExtent;gT(["min","max"],function(t){var e=o.get(t+"Span"),i=o.get(t+"ValueSpan");null!=i&&(i=n.getAxisModel().axis.scale.parse(i)),null!=i?e=yl(r[0]+i,r,[0,100],!0):null!=e&&(i=yl(e,[0,100],r,!0)-r[0]),a[t+"Span"]=e,a[t+"ValueSpan"]=i;});}(this);var i=this.calculateDataWindow(t.settledOption);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,vT(this);}},restore:function restore(t){t===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,vT(this,!0));},filterData:function filterData(t,e){if(t===this._dataZoomModel){var n=this._dimName,i=this.getTargetSeriesModels(),a=t.get("filterMode"),c=this._valueWindow;"none"!==a&&gT(i,function(i){var u=i.getData(),h=u.mapDimension(n,!0);h.length&&("weakFilter"===a?u.filterSelf(function(t){for(var e,i,n,a=0;a<h.length;a++){var o=u.get(h[a],t),r=!isNaN(o),s=o<c[0],l=o>c[1];if(r&&!s&&!l)return!0;r&&(n=!0),s&&(e=!0),l&&(i=!0);}return n&&e&&i;}):gT(h,function(t){if("empty"===a)i.setData(u=u.map(t,function(t){return function(t){return t>=c[0]&&t<=c[1];}(t)?t:NaN;}));else{var e={};e[t]=c,u.selectRange(e);}}),gT(h,function(t){u.setApproximateExtent(c,t);}));});}}};var yT=E,xT=dT,_T=sf({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function init(t,e,i){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var n=wT(t);this.settledOption=n,this.mergeDefaultAndTheme(t,i),this.doInit(n);},mergeOption:function mergeOption(t){var e=wT(t);m(this.option,t,!0),m(this.settledOption,e,!0),this.doInit(e);},doInit:function doInit(t){var i=this.option;v.canvasSupported||(i.realtime=!1),this._setDefaultThrottle(t),bT(this,t);var n=this.settledOption;yT([["start","startValue"],["end","endValue"]],function(t,e){"value"===this._rangePropMode[e]&&(i[t[0]]=n[t[0]]=null);},this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies();},_giveAxisProxies:function _giveAxisProxies(){var r=this._axisProxies;this.eachTargetAxis(function(t,e,i,n){var a=this.dependentModels[t.axis][e],o=a.__dzAxisProxy||(a.__dzAxisProxy=new pT(t.name,e,this,n));r[t.name+"_"+e]=o;},this);},_resetTarget:function _resetTarget(){var i=this.option,t=this._judgeAutoMode();xT(function(t){var e=t.axisIndex;i[e]=wa(i[e]);},this),"axisIndex"===t?this._autoSetAxisIndex():"orient"===t&&this._autoSetOrient();},_judgeAutoMode:function _judgeAutoMode(){var e=this.option,i=!1;xT(function(t){null!=e[t.axisIndex]&&(i=!0);},this);var t=e.orient;return null==t&&i?"orient":i?void 0:(null==t&&(e.orient="horizontal"),"axisIndex");},_autoSetAxisIndex:function _autoSetAxisIndex(){var o=!0,e=this.get("orient",!0),r=this.option,t=this.dependentModels;if(o){var i="vertical"===e?"y":"x";t[i+"Axis"].length?(r[i+"AxisIndex"]=[0],o=!1):yT(t.singleAxis,function(t){o&&t.get("orient",!0)===e&&(r.singleAxisIndex=[t.componentIndex],o=!1);});}o&&xT(function(t){if(o){var e=[],i=this.dependentModels[t.axis];if(i.length&&!e.length)for(var n=0,a=i.length;n<a;n++){"category"===i[n].get("type")&&e.push(n);}(r[t.axisIndex]=e).length&&(o=!1);}},this),o&&this.ecModel.eachSeries(function(a){this._isSeriesHasAllAxesTypeOf(a,"value")&&xT(function(t){var e=r[t.axisIndex],i=a.get(t.axisIndex),n=a.get(t.axisId);_(e,i=a.ecModel.queryComponents({mainType:t.axis,index:i,id:n})[0].componentIndex)<0&&e.push(i);});},this);},_autoSetOrient:function _autoSetOrient(){var e;this.eachTargetAxis(function(t){e=e||t.name;},this),this.option.orient="y"===e?"vertical":"horizontal";},_isSeriesHasAllAxesTypeOf:function _isSeriesHasAllAxesTypeOf(n,a){var o=!0;return xT(function(t){var e=n.get(t.axisIndex),i=this.dependentModels[t.axis][e];i&&i.get("type")===a||(o=!1);},this),o;},_setDefaultThrottle:function _setDefaultThrottle(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&0<e.animationDurationUpdate?100:20;}},getFirstTargetAxisModel:function getFirstTargetAxisModel(){var i;return xT(function(t){if(null==i){var e=this.get(t.axisIndex);e.length&&(i=this.dependentModels[t.axis][e[0]]);}},this),i;},eachTargetAxis:function eachTargetAxis(i,n){var a=this.ecModel;xT(function(e){yT(this.get(e.axisIndex),function(t){i.call(n,e,t,this,a);},this);},this);},getAxisProxy:function getAxisProxy(t,e){return this._axisProxies[t+"_"+e];},getAxisModel:function getAxisModel(t,e){var i=this.getAxisProxy(t,e);return i&&i.getAxisModel();},setRawRange:function setRawRange(e){var i=this.option,n=this.settledOption;yT([["start","startValue"],["end","endValue"]],function(t){null==e[t[0]]&&null==e[t[1]]||(i[t[0]]=n[t[0]]=e[t[0]],i[t[1]]=n[t[1]]=e[t[1]]);},this),bT(this,e);},setCalculatedRange:function setCalculatedRange(e){var i=this.option;yT(["start","startValue","end","endValue"],function(t){i[t]=e[t];});},getPercentRange:function getPercentRange(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow();},getValueRange:function getValueRange(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var i=this.findRepresentativeAxisProxy();return i?i.getDataValueWindow():void 0;},findRepresentativeAxisProxy:function findRepresentativeAxisProxy(t){if(t)return t.__dzAxisProxy;var e=this._axisProxies;for(var i in e){if(e.hasOwnProperty(i)&&e[i].hostedBy(this))return e[i];}for(var i in e){if(e.hasOwnProperty(i)&&!e[i].hostedBy(this))return e[i];}},getRangePropMode:function getRangePropMode(){return this._rangePropMode.slice();}});function wT(e){var i={};return yT(["start","end","startValue","endValue","throttle"],function(t){e.hasOwnProperty(t)&&(i[t]=e[t]);}),i;}function bT(t,a){var o=t._rangePropMode,r=t.get("rangeMode");yT([["start","startValue"],["end","endValue"]],function(t,e){var i=null!=a[t[0]],n=null!=a[t[1]];i&&!n?o[e]="percent":!i&&n?o[e]="value":r?o[e]=r[e]:i&&(o[e]="percent");});}var ST=Kh.extend({type:"dataZoom",render:function render(t,e,i,n){this.dataZoomModel=t,this.ecModel=e,this.api=i;},getTargetCoordInfo:function getTargetCoordInfo(){var t=this.dataZoomModel,a=this.ecModel,o={};return t.eachTargetAxis(function(t,e){var i=a.getComponent(t.axis,e);if(i){var n=i.getCoordSysModel();n&&function(t,e,i,n){for(var a,o=0;o<i.length;o++){if(i[o].model===t){a=i[o];break;}}a||i.push(a={model:t,axisModels:[],coordIndex:n});a.axisModels.push(e);}(n,i,o[n.mainType]||(o[n.mainType]=[]),n.componentIndex);}},this),o;}});_T.extend({type:"dataZoom.select"}),ST.extend({type:"dataZoom.select"}),Qd({getTargetSeries:function getTargetSeries(t){var n=Q();return t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,e,i){E(i.getAxisProxy(t.name,e).getTargetSeriesModels(),function(t){n.set(t.uid,t);});});}),n;},modifyOutputEnd:!0,overallReset:function overallReset(t,n){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,e,i){i.getAxisProxy(t.name,e).reset(i,n);}),t.eachTargetAxis(function(t,e,i){i.getAxisProxy(t.name,e).filterData(i,n);});}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy(),i=e.getDataPercentWindow(),n=e.getDataValueWindow();t.setCalculatedRange({start:i[0],end:i[1],startValue:n[0],endValue:n[1]});});}}),tf("dataZoom",function(i,t){var n=fT(T(t.eachComponent,t,"dataZoom"),dT,function(t,e){return t.get(e.axisIndex);}),a=[];t.eachComponent({mainType:"dataZoom",query:i},function(t,e){a.push.apply(a,n(t).nodes);}),E(a,function(t,e){t.setRawRange({start:i.start,end:i.end,startValue:i.startValue,endValue:i.endValue});});});var MT=gc.toolbox.dataZoom,IT=E;function AT(t,e,i){(this._brushController=new jw(i.getZr())).on("brush",T(this._onBrush,this)).mount(),this._isZoomActive;}AT.defaultOption={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:D(MT.title)};var TT=AT.prototype;TT.render=function(t,e,i,n){this.model=t,this.ecModel=e,this.api=i,function(t,e,i,n,a){var o=i._isZoomActive;n&&"takeGlobalCursor"===n.type&&(o="dataZoomSelect"===n.key&&n.dataZoomSelectActive);i._isZoomActive=o,t.setIconStatus("zoom",o?"emphasis":"normal");var r=new XA(CT(t.option),e,{include:["grid"]});i._brushController.setPanels(r.makePanelOpts(a,function(t){return t.xAxisDeclared&&!t.yAxisDeclared?"lineX":!t.xAxisDeclared&&t.yAxisDeclared?"lineY":"rect";})).enableBrush(!!o&&{brushType:"auto",brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}});}(t,e,this,n,i),function(t,e){t.setIconStatus("back",1<function(t){return rT(t).length;}(e)?"emphasis":"normal");}(t,e);},TT.onclick=function(t,e,i){DT[i].call(this);},TT.remove=function(t,e){this._brushController.unmount();},TT.dispose=function(t,e){this._brushController.dispose();};var DT={zoom:function zoom(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t});},back:function back(){this._dispatchZoomAction(function(t){var n=rT(t),e=n[n.length-1];1<n.length&&n.pop();var a={};return aT(e,function(t,e){for(var i=n.length-1;0<=i;i--){if(t=n[i][e]){a[e]=t;break;}}}),a;}(this.ecModel));}};function CT(e){var i={};return E(["xAxisIndex","yAxisIndex"],function(t){i[t]=e[t],null==i[t]&&(i[t]="all"),!1!==i[t]&&"none"!==i[t]||(i[t]=[]);}),i;}TT._onBrush=function(t,e){if(e.isEnd&&t.length){var s={},l=this.ecModel;this._brushController.updateCovers([]),new XA(CT(this.model.option),l,{include:["grid"]}).matchOutputRanges(t,l,function(t,e,i){if("cartesian2d"===i.type){var n=t.brushType;"rect"===n?(a("x",i,e[0]),a("y",i,e[1])):a({lineX:"x",lineY:"y"}[n],i,e);}}),function(o,t){var r=rT(o);aT(t,function(t,e){for(var i=r.length-1;0<=i;i--){if(r[i][e])break;}if(i<0){var n=o.queryComponents({mainType:"dataZoom",subType:"select",id:e})[0];if(n){var a=n.getPercentRange();r[0][e]={dataZoomId:e,start:a[0],end:a[1]};}}}),r.push(t);}(l,s),this._dispatchZoomAction(s);}function a(t,e,i){var n=e.getAxis(t),a=n.model,o=function(e,i,t){var n;return t.eachComponent({mainType:"dataZoom",subType:"select"},function(t){t.getAxisModel(e,i.componentIndex)&&(n=t);}),n;}(t,a,l),r=o.findRepresentativeAxisProxy(a).getMinMaxSpan();null==r.minValueSpan&&null==r.maxValueSpan||(i=ww(0,i.slice(),n.scale.getExtent(),0,r.minValueSpan,r.maxValueSpan)),o&&(s[o.id]={dataZoomId:o.id,startValue:i[0],endValue:i[1]});}},TT._dispatchZoomAction=function(t){var i=[];IT(t,function(t,e){i.push(D(t));}),i.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:i});},bA("dataZoom",AT),Jd(function(s){if(s){var l=s.dataZoom||(s.dataZoom=[]);k(l)||(s.dataZoom=l=[l]);var t=s.toolbox;if(t&&(k(t)&&(t=t[0]),t&&t.feature)){var e=t.feature.dataZoom;i("xAxis",e),i("yAxis",e);}}function i(n,a){if(a){var o=n+"Index",r=a[o];null==r||"all"===r||k(r)||(r=!1===r||"none"===r?[]:[r]),function(t,e){var i=s[t];k(i)||(i=i?[i]:[]);IT(i,e);}(n,function(t,e){if(null==r||"all"===r||-1!==_(r,e)){var i={type:"select",$fromToolbox:!0,filterMode:a.filterMode||"filter",id:"\0_ec_\0toolbox-dataZoom_"+n+e};i[o]=e,l.push(i);}});}}});var LT=gc.toolbox.restore;function kT(t){this.model=t;}kT.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:LT.title},kT.prototype.onclick=function(t,e,i){!function(t){t[oT]=null;}(t),e.dispatchAction({type:"restore",from:this.uid});},bA("restore",kT),tf({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate");}),sf({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});var PT=E,NT=Bl,OT=["","-webkit-","-moz-","-o-"];function ET(a){var o=[],t=a.get("transitionDuration"),e=a.get("backgroundColor"),i=a.getModel("textStyle"),n=a.get("padding");return t&&o.push(function(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",i="left "+t+"s "+e+",top "+t+"s "+e;return N(OT,function(t){return t+"transition:"+i;}).join(";");}(t)),e&&(v.canvasSupported?o.push("background-Color:"+e):(o.push("background-Color:#"+Be(e)),o.push("filter:alpha(opacity=70)"))),PT(["width","color","radius"],function(t){var e="border-"+t,i=NT(e),n=a.get(i);null!=n&&o.push(e+":"+n+("color"===t?"":"px"));}),o.push(function(i){var n=[],t=i.get("fontSize"),e=i.getTextColor();return e&&n.push("color:"+e),n.push("font:"+i.getFont()),t&&n.push("line-height:"+Math.round(3*t/2)+"px"),PT(["decoration","align"],function(t){var e=i.get(t);e&&n.push("text-"+t+":"+e);}),n.join(";");}(i)),null!=n&&o.push("padding:"+Vl(n).join("px ")+"px"),o.join(";")+";";}function RT(i,t){if(v.wxa)return null;var e=document.createElement("div"),n=this._zr=t.getZr();this.el=e,this._x=t.getWidth()/2,this._y=t.getHeight()/2,i.appendChild(e),this._container=i,this._show=!1,this._hideTimeout;var a=this;e.onmouseenter=function(){a._enterable&&(clearTimeout(a._hideTimeout),a._show=!0),a._inContent=!0;},e.onmousemove=function(t){if(t=t||window.event,!a._enterable){var e=n.handler;Vt(i,t,!0),e.dispatch("mousemove",t);}},e.onmouseleave=function(){a._enterable&&a._show&&a.hideLater(a._hideDelay),a._inContent=!1;};}function zT(t){this._zr=t.getZr(),this._show=!1,this._hideTimeout;}RT.prototype={constructor:RT,_enterable:!0,update:function update(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),i=t.style;"absolute"!==i.position&&"absolute"!==e.position&&(i.position="relative");},show:function show(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+ET(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",e.style.pointerEvents=this._enterable?"auto":"none",this._show=!0;},setContent:function setContent(t){this.el.innerHTML=null==t?"":t;},setEnterable:function setEnterable(t){this._enterable=t;},getSize:function getSize(){var t=this.el;return[t.clientWidth,t.clientHeight];},moveTo:function moveTo(t,e){var i,n=this._zr;n&&n.painter&&(i=n.painter.getViewportRootOffset())&&(t+=i.offsetLeft,e+=i.offsetTop);var a=this.el.style;a.left=t+"px",a.top=e+"px",this._x=t,this._y=e;},hide:function hide(){this.el.style.display="none",this._show=!1;},hideLater:function hideLater(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(T(this.hide,this),t)):this.hide());},isShow:function isShow(){return this._show;},getOuterSize:function getOuterSize(){var t=this.el.clientWidth,e=this.el.clientHeight;if(document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(this.el);i&&(t+=parseInt(i.borderLeftWidth,10)+parseInt(i.borderRightWidth,10),e+=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10));}return{width:t,height:e};}},zT.prototype={constructor:zT,_enterable:!0,update:function update(){},show:function show(t){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.attr("show",!0),this._show=!0;},setContent:function setContent(t,e,i){this.el&&this._zr.remove(this.el);for(var n={},a=t,o="{marker",r=a.indexOf(o);0<=r;){var s=a.indexOf("|}"),l=a.substr(r+o.length,s-r-o.length);-1<l.indexOf("sub")?n["marker"+l]={textWidth:4,textHeight:4,textBorderRadius:2,textBackgroundColor:e[l],textOffset:[3,0]}:n["marker"+l]={textWidth:10,textHeight:10,textBorderRadius:5,textBackgroundColor:e[l]},r=(a=a.substr(s+1)).indexOf("{marker");}this.el=new Dr({style:{rich:n,text:t,textLineHeight:20,textBackgroundColor:i.get("backgroundColor"),textBorderRadius:i.get("borderRadius"),textFill:i.get("textStyle.color"),textPadding:i.get("padding")},z:i.get("z")}),this._zr.add(this.el);var u=this;this.el.on("mouseover",function(){u._enterable&&(clearTimeout(u._hideTimeout),u._show=!0),u._inContent=!0;}),this.el.on("mouseout",function(){u._enterable&&u._show&&u.hideLater(u._hideDelay),u._inContent=!1;});},setEnterable:function setEnterable(t){this._enterable=t;},getSize:function getSize(){var t=this.el.getBoundingRect();return[t.width,t.height];},moveTo:function moveTo(t,e){this.el&&this.el.attr("position",[t,e]);},hide:function hide(){this.el&&this.el.hide(),this._show=!1;},hideLater:function hideLater(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(T(this.hide,this),t)):this.hide());},isShow:function isShow(){return this._show;},getOuterSize:function getOuterSize(){var t=this.getSize();return{width:t[0],height:t[1]};}};var BT=T,VT=E,GT=xl,FT=new Hr({shape:{x:-1,y:-1,width:2,height:2}});function WT(t){for(var e=t.pop();t.length;){var i=t.pop();i&&(dl.isInstance(i)&&(i=i.get("tooltip",!0)),"string"==typeof i&&(i={formatter:i}),e=new dl(i,e,e.ecModel));}return e;}function HT(t,e){return t.dispatchAction||T(e.dispatchAction,e);}function ZT(t){return"center"===t||"middle"===t;}lf({type:"tooltip",init:function init(t,e){if(!v.node){var i,n=t.getComponent("tooltip").get("renderMode");this._renderMode=Ea(n),"html"===this._renderMode?(i=new RT(e.getDom(),e),this._newLine="<br/>"):(i=new zT(e),this._newLine="\n"),this._tooltipContent=i;}},render:function render(t,e,i){if(!v.node){this.group.removeAll(),this._tooltipModel=t,this._ecModel=e,this._api=i,this._lastDataByCoordSys=null,this._alwaysShowContent=t.get("alwaysShowContent");var n=this._tooltipContent;n.update(),n.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow();}},_initGlobalListener:function _initGlobalListener(){var n=this._tooltipModel.get("triggerOn");PM("itemTooltip",this._api,BT(function(t,e,i){"none"!==n&&(0<=n.indexOf(t)?this._tryShow(e,i):"leave"===t&&this._hide(i));},this));},_keepShow:function _keepShow(){var t=this._tooltipModel,e=this._ecModel,i=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==t.get("triggerOn")){var n=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){i.isDisposed()||n.manuallyShowTip(t,e,i,{x:n._lastX,y:n._lastY});});}},manuallyShowTip:function manuallyShowTip(t,e,i,n){if(n.from!==this.uid&&!v.node){var a=HT(n,i);this._ticket="";var o=n.dataByCoordSys;if(n.tooltip&&null!=n.x&&null!=n.y){var r=FT;r.position=[n.x,n.y],r.update(),r.tooltip=n.tooltip,this._tryShow({offsetX:n.x,offsetY:n.y,target:r},a);}else if(o)this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,event:{},dataByCoordSys:n.dataByCoordSys,tooltipOption:n.tooltipOption},a);else if(null!=n.seriesIndex){if(this._manuallyAxisShowTip(t,e,i,n))return;var s=wM(n,e),l=s.point[0],u=s.point[1];null!=l&&null!=u&&this._tryShow({offsetX:l,offsetY:u,position:n.position,target:s.el,event:{}},a);}else null!=n.x&&null!=n.y&&(i.dispatchAction({type:"updateAxisPointer",x:n.x,y:n.y}),this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,target:i.getZr().findHover(n.x,n.y).target,event:{}},a));}},manuallyHideTip:function manuallyHideTip(t,e,i,n){var a=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&a.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,n.from!==this.uid&&this._hide(HT(n,i));},_manuallyAxisShowTip:function _manuallyAxisShowTip(t,e,i,n){var a=n.seriesIndex,o=n.dataIndex,r=e.getComponent("axisPointer").coordSysAxesInfo;if(null!=a&&null!=o&&null!=r){var s=e.getSeriesByIndex(a);if(s)if("axis"===(t=WT([s.getData().getItemModel(o),s,(s.coordinateSystem||{}).model,t])).get("trigger"))return i.dispatchAction({type:"updateAxisPointer",seriesIndex:a,dataIndex:o,position:n.position}),!0;}},_tryShow:function _tryShow(t,e){var i=t.target;if(this._tooltipModel){this._lastX=t.offsetX,this._lastY=t.offsetY;var n=t.dataByCoordSys;n&&n.length?this._showAxisTooltip(n,t):i&&null!=i.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(t,i,e)):i&&i.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(t,i,e)):(this._lastDataByCoordSys=null,this._hide(e));}},_showOrMove:function _showOrMove(t,e){var i=t.get("showDelay");e=T(e,this),clearTimeout(this._showTimout),0<i?this._showTimout=setTimeout(e,i):e();},_showAxisTooltip:function _showAxisTooltip(t,e){var d=this._ecModel,i=this._tooltipModel,n=[e.offsetX,e.offsetY],a=[],f=[],o=WT([e.tooltipOption,i]),p=this._renderMode,r=this._newLine,g={};VT(t,function(t){VT(t.dataByAxis,function(s){var l=d.getComponent(s.axisDim+"Axis",s.axisIndex),u=s.value,h=[];if(l&&null!=u){var c=YM(u,l.axis,d,s.seriesDataIndices,s.valueLabelOpt);E(s.seriesDataIndices,function(t){var e=d.getSeriesByIndex(t.seriesIndex),i=t.dataIndexInside,n=e&&e.getDataParams(i);if(n.axisDim=s.axisDim,n.axisIndex=s.axisIndex,n.axisType=s.axisType,n.axisId=s.axisId,n.axisValue=Gp(l.axis,u),n.axisValueLabel=c,n){f.push(n);var a,o=e.formatTooltip(i,!0,null,p);if(z(o)){a=o.html;var r=o.markers;m(g,r);}else a=o;h.push(a);}});var t=c;"html"!==p?a.push(h.join(r)):a.push((t?Wl(t)+r:"")+h.join(r));}});},this),a.reverse(),a=a.join(this._newLine+this._newLine);var s=e.position;this._showOrMove(o,function(){this._updateContentNotChangedOnAxis(t)?this._updatePosition(o,s,n[0],n[1],this._tooltipContent,f):this._showTooltipContent(o,a,f,Math.random(),n[0],n[1],s,void 0,g);});},_showSeriesItemTooltip:function _showSeriesItemTooltip(t,e,i){var n=this._ecModel,a=e.seriesIndex,o=n.getSeriesByIndex(a),r=e.dataModel||o,s=e.dataIndex,l=e.dataType,u=r.getData(),h=WT([u.getItemModel(s),r,o&&(o.coordinateSystem||{}).model,this._tooltipModel]),c=h.get("trigger");if(null==c||"item"===c){var d,f,p=r.getDataParams(s,l),g=r.formatTooltip(s,!1,l,this._renderMode);f=z(g)?(d=g.html,g.markers):(d=g,null);var m="item_"+r.name+"_"+s;this._showOrMove(h,function(){this._showTooltipContent(h,d,p,m,t.offsetX,t.offsetY,t.position,t.target,f);}),i({type:"showTip",dataIndexInside:s,dataIndex:u.getRawIndex(s),seriesIndex:a,from:this.uid});}},_showComponentItemTooltip:function _showComponentItemTooltip(t,e,i){var n=e.tooltip;if("string"==typeof n){n={content:n,formatter:n};}var a=new dl(n,this._tooltipModel,this._ecModel),o=a.get("content"),r=Math.random();this._showOrMove(a,function(){this._showTooltipContent(a,o,a.get("formatterParams")||{},r,t.offsetX,t.offsetY,t.position,e);}),i({type:"showTip",from:this.uid});},_showTooltipContent:function _showTooltipContent(i,t,n,e,a,o,r,s,l){if(this._ticket="",i.get("showContent")&&i.get("show")){var u=this._tooltipContent,h=i.get("formatter");r=r||i.get("position");var c=t;if(h&&"string"==typeof h)c=Ul(h,n,!0);else if("function"==typeof h){var d=BT(function(t,e){t===this._ticket&&(u.setContent(e,l,i),this._updatePosition(i,r,a,o,u,n,s));},this);this._ticket=e,c=h(n,e,d);}u.setContent(c,l,i),u.show(i),this._updatePosition(i,r,a,o,u,n,s);}},_updatePosition:function _updatePosition(t,e,i,n,a,o,r){var s=this._api.getWidth(),l=this._api.getHeight();e=e||t.get("position");var u=a.getSize(),h=t.get("align"),c=t.get("verticalAlign"),d=r&&r.getBoundingRect().clone();if(r&&d.applyTransform(r.transform),"function"==typeof e&&(e=e([i,n],o,a.el,d,{viewSize:[s,l],contentSize:u.slice()})),k(e))i=GT(e[0],s),n=GT(e[1],l);else if(z(e)){e.width=u[0],e.height=u[1];var f=au(e,{width:s,height:l});i=f.x,n=f.y,c=h=null;}else if("string"==typeof e&&r){i=(p=function(t,e,i){var n=i[0],a=i[1],o=0,r=0,s=e.width,l=e.height;switch(t){case"inside":o=e.x+s/2-n/2,r=e.y+l/2-a/2;break;case"top":o=e.x+s/2-n/2,r=e.y-a-5;break;case"bottom":o=e.x+s/2-n/2,r=e.y+l+5;break;case"left":o=e.x-n-5,r=e.y+l/2-a/2;break;case"right":o=e.x+s+5,r=e.y+l/2-a/2;}return[o,r];}(e,d,u))[0],n=p[1];}else{var p;i=(p=function(t,e,i,n,a,o,r){var s=i.getOuterSize(),l=s.width,u=s.height;null!=o&&(n<t+l+o?t-=l+o:t+=o);null!=r&&(a<e+u+r?e-=u+r:e+=r);return[t,e];}(i,n,a,s,l,h?null:20,c?null:20))[0],n=p[1];}h&&(i-=ZT(h)?u[0]/2:"right"===h?u[0]:0),c&&(n-=ZT(c)?u[1]/2:"bottom"===c?u[1]:0),t.get("confine")&&(i=(p=function(t,e,i,n,a){var o=i.getOuterSize(),r=o.width,s=o.height;return t=Math.min(t+r,n)-r,e=Math.min(e+s,a)-s,t=Math.max(t,0),e=Math.max(e,0),[t,e];}(i,n,a,s,l))[0],n=p[1]);a.moveTo(i,n);},_updateContentNotChangedOnAxis:function _updateContentNotChangedOnAxis(n){var t=this._lastDataByCoordSys,r=!!t&&t.length===n.length;return r&&VT(t,function(t,e){var i=t.dataByAxis||{},o=(n[e]||{}).dataByAxis||[];(r&=i.length===o.length)&&VT(i,function(t,e){var i=o[e]||{},n=t.seriesDataIndices||[],a=i.seriesDataIndices||[];(r&=t.value===i.value&&t.axisType===i.axisType&&t.axisId===i.axisId&&n.length===a.length)&&VT(n,function(t,e){var i=a[e];r&=t.seriesIndex===i.seriesIndex&&t.dataIndex===i.dataIndex;});});}),this._lastDataByCoordSys=n,!!r;},_hide:function _hide(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid});},dispose:function dispose(t,e){v.node||(this._tooltipContent.hide(),EM("itemTooltip",e));}}),tf({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),tf({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){});var UT=["rect","polygon","keep","clear"];var XT=E;function YT(t){if(t)for(var e in t){if(t.hasOwnProperty(e))return!0;}}function jT(t,e,o){var i={};return XT(e,function(n){var a=i[n]=function(){function t(){}return t.prototype.__hidden=t.prototype,new t();}();XT(t[n],function(t,e){if(Bx.isValidType(e)){var i={type:e,visual:t};o&&o(i,n),a[e]=new Bx(i),"opacity"===e&&((i=D(i)).type="colorAlpha",a.__hidden.__alphaForOpacity=new Bx(i));}});}),i;}function qT(e,i,t){var n;E(t,function(t){i.hasOwnProperty(t)&&YT(i[t])&&(n=!0);}),n&&E(t,function(t){i.hasOwnProperty(t)&&YT(i[t])?e[t]=D(i[t]):delete e[t];});}var KT={lineX:$T(0),lineY:$T(1),rect:{point:function point(t,e,i){return t&&i.boundingRect.contain(t[0],t[1]);},rect:function rect(t,e,i){return t&&i.boundingRect.intersect(t);}},polygon:{point:function point(t,e,i){return t&&i.boundingRect.contain(t[0],t[1])&&ng(i.range,t[0],t[1]);},rect:function rect(t,e,i){var n=i.range;if(!t||n.length<=1)return!1;var a=t.x,o=t.y,r=t.width,s=t.height,l=n[0];return!!(ng(n,a,o)||ng(n,a+r,o)||ng(n,a,o+s)||ng(n,a+r,o+s)||bi.create(t).contain(l[0],l[1])||il(a,o,a+r,o,n)||il(a,o,a,o+s,n)||il(a+r,o,a+r,o+s,n)||il(a,o+s,a+r,o+s,n))||void 0;}}};function $T(o){var r=["x","y"],s=["width","height"];return{point:function point(t,e,i){if(t){var n=i.range;return JT(t[o],n);}},rect:function rect(t,e,i){if(t){var n=i.range,a=[t[r[o]],t[r[o]]+t[s[o]]];return a[1]<a[0]&&a.reverse(),JT(a[0],n)||JT(a[1],n)||JT(n[0],a)||JT(n[1],a);}}};}function JT(t,e){return e[0]<=t&&t<=e[1];}var QT=["inBrush","outOfBrush"],tD="__ecBrushSelect",eD="__ecInBrushSelectEvent",iD=cd.VISUAL.BRUSH;function nD(t,e){if(!t.isDisposed()){var i=t.getZr();i[eD]=!0,t.dispatchAction({type:"brushSelect",batch:e}),i[eD]=!1;}}function aD(t,e,i,n){for(var a=0,o=e.length;a<o;a++){var r=e[a];if(t[r.brushType](n,i,r.selectors,r))return!0;}}function oD(t){var r=t.brushSelector;if(R(r)){var e=[];return E(KT,function(o,t){e[t]=function(t,e,i,n){var a=e.getItemLayout(t);return o[r](a,i,n);};}),e;}if(O(r)){var i={};return E(KT,function(t,e){i[e]=r;}),i;}return r;}nf(iD,function(e,t,i){e.eachComponent({mainType:"brush"},function(t){i&&"takeGlobalCursor"===i.type&&t.setBrushOption("brush"===i.key?i.brushOption:{brushType:!1}),(t.brushTargetManager=new XA(t.option,e)).setInputRanges(t.areas,e);});}),af(iD,function(p,t,e){var a,g,m=[];p.eachComponent({mainType:"brush"},function(o,t){var s={brushId:o.id,brushIndex:t,brushName:o.name,areas:D(o.areas),selected:[]};m.push(s);var e=o.option,i=e.brushLink,n=[],l=[],u=[],h=0;t||(a=e.throttleType,g=e.throttleDelay);var r=N(o.areas,function(t){return function(i){var n=i.selectors={};return E(KT[i.brushType],function(e,t){n[t]=function(t){return e(t,n,i);};}),i;}(C({boundingRect:rD[t.brushType](t)},t));}),c=jT(o.option,QT,function(t){t.mappingMethod="fixed";});function d(t){return"all"===i||n[t];}function f(t){return!!t.length;}k(i)&&E(i,function(t){n[t]=1;}),p.eachSeries(function(t,e){var i=u[e]=[];"parallel"===t.subType?function(t,e){var i=t.coordinateSystem;h|=i.hasAxisBrushed(),d(e)&&i.eachActiveState(t.getData(),function(t,e){"active"===t&&(l[e]=1);});}(t,e):function(e,t,i){var n=oD(e);if(!n||function(t,e){var i=t.option.seriesIndex;return null!=i&&"all"!==i&&(k(i)?_(i,e)<0:e!==i);}(o,t))return;if(E(r,function(t){n[t.brushType]&&o.brushTargetManager.controlSeries(t,e,p)&&i.push(t),h|=f(i);}),d(t)&&f(i)){var a=e.getData();a.each(function(t){aD(n,i,a,t)&&(l[t]=1);});}}(t,e,i);}),p.eachSeries(function(t,e){var i={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};s.selected.push(i);var n=oD(t),a=u[e],o=t.getData(),r=d(e)?function(t){return l[t]?(i.dataIndex.push(o.getRawIndex(t)),"inBrush"):"outOfBrush";}:function(t){return aD(n,a,o,t)?(i.dataIndex.push(o.getRawIndex(t)),"inBrush"):"outOfBrush";};(d(e)?h:f(a))&&function(t,u,h,c,d,f){var p,g={};function m(t){return h.getItemVisual(p,t);}function v(t,e){h.setItemVisual(p,t,e);}function e(t,e){p=null==f?t:e;var i=h.getRawDataItem(p);if(!i||!1!==i.visualMap)for(var n=c.call(d,t),a=u[n],o=g[n],r=0,s=o.length;r<s;r++){var l=o[r];a[l]&&a[l].applyVisual(t,m,v);}}E(t,function(t){var e=Bx.prepareVisualTypes(u[t]);g[t]=e;}),null==f?h.each(e):h.each([f],e);}(QT,c,o,r);});}),function(t,e,i,n,a){if(!a)return;var o=t.getZr();if(o[eD])return;o[tD]||(o[tD]=nD);dc(o,tD,i,e)(t,n);}(t,a,g,m,e);});var rD={lineX:et,lineY:et,rect:function rect(t){return sD(t.range);},polygon:function polygon(t){for(var e,i=t.range,n=0,a=i.length;n<a;n++){e=e||[[1/0,-1/0],[1/0,-1/0]];var o=i[n];o[0]<e[0][0]&&(e[0][0]=o[0]),o[0]>e[0][1]&&(e[0][1]=o[0]),o[1]<e[1][0]&&(e[1][0]=o[1]),o[1]>e[1][1]&&(e[1][1]=o[1]);}return e&&sD(e);}};function sD(t){return new bi(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0]);}var lD=["#ddd"];sf({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function optionUpdated(t,e){var i=this.option;e||qT(i,t,["inBrush","outOfBrush"]);var n=i.inBrush=i.inBrush||{};i.outOfBrush=i.outOfBrush||{color:lD},n.hasOwnProperty("liftZ")||(n.liftZ=5);},setAreas:function setAreas(t){t&&(this.areas=N(t,function(t){return uD(this.option,t);},this));},setBrushOption:function setBrushOption(t){this.brushOption=uD(this.option,t),this.brushType=this.brushOption.brushType;}});function uD(t,e){return m({brushType:t.brushType,brushMode:t.brushMode,transformable:t.transformable,brushStyle:new dl(t.brushStyle).getItemStyle(),removeOnClick:t.removeOnClick,z:t.z},e,!0);}function hD(t,e,i,n){n&&n.$from===t.id||this._brushController.setPanels(t.brushTargetManager.makePanelOpts(i)).enableBrush(t.brushOption).updateCovers(t.areas.slice());}lf({type:"brush",init:function init(t,e){this.ecModel=t,this.api=e,this.model,(this._brushController=new jw(e.getZr())).on("brush",T(this._onBrush,this)).mount();},render:function render(t){return this.model=t,hD.apply(this,arguments);},updateTransform:hD,updateView:hD,dispose:function dispose(){this._brushController.dispose();},_onBrush:function _onBrush(t,e){var i=this.model.id;this.model.brushTargetManager.setOutputRanges(t,this.ecModel),e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"brush",brushId:i,areas:D(t),$from:i}),e.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:i,areas:D(t),$from:i});}}),tf({type:"brush",event:"brush"},function(e,t){t.eachComponent({mainType:"brush",query:e},function(t){t.setAreas(e.areas);});}),tf({type:"brushSelect",event:"brushSelected",update:"none"},function(){}),tf({type:"brushEnd",event:"brushEnd",update:"none"},function(){});var cD=gc.toolbox.brush;function dD(t,e,i){this.model=t,this.ecModel=e,this.api=i,this._brushType,this._brushMode;}dD.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:D(cD.title)};var fD=dD.prototype;fD.render=fD.updateView=function(e,t,i){var n,a,o;t.eachComponent({mainType:"brush"},function(t){n=t.brushType,a=t.brushOption.brushMode||"single",o|=t.areas.length;}),this._brushType=n,this._brushMode=a,E(e.get("type",!0),function(t){e.setIconStatus(t,("keep"===t?"multiple"===a:"clear"===t?o:t===n)?"emphasis":"normal");});},fD.getIcons=function(){var t=this.model,e=t.get("icon",!0),i={};return E(t.get("type",!0),function(t){e[t]&&(i[t]=e[t]);}),i;},fD.onclick=function(t,e,i){var n=this._brushType,a=this._brushMode;"clear"===i?(e.dispatchAction({type:"axisAreaSelect",intervals:[]}),e.dispatchAction({type:"brush",command:"clear",areas:[]})):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===i?n:n!==i&&i,brushMode:"keep"===i?"multiple"===a?"single":"multiple":a}});},bA("brush",dD),Jd(function(t,e){var i=t&&t.brush;if(k(i)||(i=i?[i]:[]),i.length){var n=[];E(i,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(n=n.concat(e));});var a=t&&t.toolbox;k(a)&&(a=a[0]),a||(a={feature:{}},t.toolbox=[a]);var o=a.feature||(a.feature={}),r=o.brush||(o.brush={}),s=r.type||(r.type=[]);s.push.apply(s,n),function(i){var e={};E(i,function(t){e[t]=1;}),i.length=0,E(e,function(t,e){i.push(e);});}(s),e&&!s.length&&s.push.apply(s,UT);}}),sf({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),lf({type:"title",render:function render(t,e,i){if(this.group.removeAll(),t.get("show")){var n=this.group,a=t.getModel("textStyle"),o=t.getModel("subtextStyle"),r=t.get("textAlign"),s=H(t.get("textBaseline"),t.get("textVerticalAlign")),l=new Dr({style:Gs({},a,{text:t.get("text"),textFill:a.getTextColor()},{disableBox:!0}),z2:10}),u=l.getBoundingRect(),h=t.get("subtext"),c=new Dr({style:Gs({},o,{text:h,textFill:o.getTextColor(),y:u.height+t.get("itemGap"),textVerticalAlign:"top"},{disableBox:!0}),z2:10}),d=t.get("link"),f=t.get("sublink"),p=t.get("triggerEvent",!0);l.silent=!d&&!p,c.silent=!f&&!p,d&&l.on("click",function(){window.open(d,"_"+t.get("target"));}),f&&c.on("click",function(){window.open(f,"_"+t.get("subtarget"));}),l.eventData=c.eventData=p?{componentType:"title",componentIndex:t.componentIndex}:null,n.add(l),h&&n.add(c);var g=n.getBoundingRect(),m=t.getBoxLayoutParams();m.width=g.width,m.height=g.height;var v=au(m,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));r||("middle"===(r=t.get("left")||t.get("right"))&&(r="center"),"right"===r?v.x+=v.width:"center"===r&&(v.x+=v.width/2)),s||("center"===(s=t.get("top")||t.get("bottom"))&&(s="middle"),"bottom"===s?v.y+=v.height:"middle"===s&&(v.y+=v.height/2),s=s||"top"),n.attr("position",[v.x,v.y]);var y={textAlign:r,textVerticalAlign:s};l.setStyle(y),c.setStyle(y),g=n.getBoundingRect();var x=v.margin,_=t.getItemStyle(["color","opacity"]);_.fill=t.get("backgroundColor");var w=new Hr({shape:{x:g.x-x[3],y:g.y-x[0],width:g.width+x[1]+x[3],height:g.height+x[0]+x[2],r:t.get("borderRadius")},style:_,subPixelOptimize:!0,silent:!0});n.add(w);}}});function pD(t){var e=t.itemStyle||(t.itemStyle={}),i=e.emphasis||(e.emphasis={}),n=t.label||t.label||{},a=n.normal||(n.normal={}),o={normal:1,emphasis:1};E(n,function(t,e){o[e]||gD(a,e)||(a[e]=t);}),i.label&&!gD(n,"emphasis")&&(n.emphasis=i.label,delete i.label);}function gD(t,e){return t.hasOwnProperty(e);}fu.registerSubTypeDefaulter("timeline",function(){return"slider";}),tf({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e){var i=e.getComponent("timeline");return i&&null!=t.currentIndex&&(i.setCurrentIndex(t.currentIndex),!i.get("loop",!0)&&i.isIndexMax()&&i.setPlayState(!1)),e.resetOption("timeline"),C({currentIndex:i.option.currentIndex},t);}),tf({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var i=e.getComponent("timeline");i&&null!=t.playState&&i.setPlayState(t.playState);});var mD=fu.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},init:function init(t,e,i){this._data,this._names,this.mergeDefaultAndTheme(t,i),this._initData();},mergeOption:function mergeOption(t){mD.superApply(this,"mergeOption",arguments),this._initData();},setCurrentIndex:function setCurrentIndex(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(e<=t&&(t=e-1),t<0&&(t=0)),this.option.currentIndex=t;},getCurrentIndex:function getCurrentIndex(){return this.option.currentIndex;},isIndexMax:function isIndexMax(){return this.getCurrentIndex()>=this._data.count()-1;},setPlayState:function setPlayState(t){this.option.autoPlay=!!t;},getPlayState:function getPlayState(){return!!this.option.autoPlay;},_initData:function _initData(){var t=this.option,e=t.data||[],i=t.axisType,a=this._names=[];if("category"===i){var o=[];E(e,function(t,e){var i,n=Ma(t);z(t)?(i=D(t)).value=e:i=e,o.push(i),R(n)||null!=n&&!isNaN(n)||(n=""),a.push(n+"");}),e=o;}var n={category:"ordinal",time:"time"}[i]||"number";(this._data=new Tf([{name:"value",type:n}],this)).initData(e,a);},getData:function getData(){return this._data;},getCategories:function getCategories(){if("category"===this.get("axisType"))return this._names.slice();}});b(mD.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#304654"},itemStyle:{color:"#304654",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{label:{show:!0,color:"#c23531"},itemStyle:{color:"#c23531"},controlStyle:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}}),Th);function vD(t,e,i,n){vg.call(this,t,e,i),this.type=n||"value",this.model=null;}var yD=Kh.extend({type:"timeline"});vD.prototype={constructor:vD,getLabelModel:function getLabelModel(){return this.model.getModel("label");},isHorizontal:function isHorizontal(){return"horizontal"===this.model.get("orient");}},w(vD,vg);var xD=T,_D=E,wD=Math.PI;function bD(t,e,i,n,a,o){var r=e.get("color");a?(a.setColor(r),i.add(a),o&&o.onUpdate(a)):((a=Jp(t.get("symbol"),-1,-1,2,2,r)).setStyle("strokeNoScale",!0),i.add(a),o&&o.onCreate(a));var s=e.getItemStyle(["color","symbol","symbolSize"]);a.setStyle(s),n=m({rectHover:!0,z2:100},n,!0);var l=t.get("symbolSize");(l=l instanceof Array?l.slice():[+l,+l])[0]/=2,l[1]/=2,n.scale=l;var u=t.get("symbolOffset");if(u){var h=n.position=n.position||[0,0];h[0]+=xl(u[0],l[0]),h[1]+=xl(u[1],l[1]);}var c=t.get("symbolRotate");return n.rotation=(c||0)*Math.PI/180||0,a.attr(n),a.updateTransform(),a;}function SD(t,e,i,n,a){if(!t.dragging){var o=n.getModel("checkpointStyle"),r=i.dataToCoord(n.getData().get(["value"],e));a||!o.get("animation",!0)?t.attr({position:[r,0]}):(t.stopAnimation(!0),t.animateTo({position:[r,0]},o.get("animationDuration",!0),o.get("animationEasing",!0)));}}yD.extend({type:"timeline.slider",init:function init(t,e){this.api=e,this._axis,this._viewRect,this._timer,this._currentPointer,this._mainGroup,this._labelGroup;},render:function render(e,t,i,n){if(this.model=e,this.api=i,this.ecModel=t,this.group.removeAll(),e.get("show",!0)){var a=this._layout(e,i),o=this._createGroup("mainGroup"),r=this._createGroup("labelGroup"),s=this._axis=this._createAxis(a,e);e.formatTooltip=function(t){return Wl(s.scale.getLabel(t));},_D(["AxisLine","AxisTick","Control","CurrentPointer"],function(t){this["_render"+t](a,o,s,e);},this),this._renderAxisLabel(a,r,s,e),this._position(a,e);}this._doPlayStop();},remove:function remove(){this._clearTimer(),this.group.removeAll();},dispose:function dispose(){this._clearTimer();},_layout:function _layout(t,e){var i=t.get("label.position"),n=t.get("orient"),a=function(t,e){return au(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"));}(t,e);null==i||"auto"===i?i="horizontal"===n?a.y+a.height/2<e.getHeight()/2?"-":"+":a.x+a.width/2<e.getWidth()/2?"+":"-":isNaN(i)&&(i={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[n][i]);var o,r,s,l,u={horizontal:"center",vertical:0<=i||"+"===i?"left":"right"},h={horizontal:0<=i||"+"===i?"top":"bottom",vertical:"middle"},c={horizontal:0,vertical:wD/2},d="vertical"===n?a.height:a.width,f=t.getModel("controlStyle"),p=f.get("show",!0),g=p?f.get("itemSize"):0,m=p?f.get("itemGap"):0,v=g+m,y=t.get("label.rotate")||0;y=y*wD/180;var x=f.get("position",!0),_=p&&f.get("showPlayBtn",!0),w=p&&f.get("showPrevBtn",!0),b=p&&f.get("showNextBtn",!0),S=0,M=d;return"left"===x||"bottom"===x?(_&&(o=[0,0],S+=v),w&&(r=[S,0],S+=v)):(_&&(o=[M-g,0],M-=v),w&&(r=[0,0],S+=v)),b&&(s=[M-g,0],M-=v),l=[S,M],t.get("inverse")&&l.reverse(),{viewRect:a,mainLength:d,orient:n,rotation:c[n],labelRotation:y,labelPosOpt:i,labelAlign:t.get("label.align")||u[n],labelBaseline:t.get("label.verticalAlign")||t.get("label.baseline")||h[n],playPosition:o,prevBtnPosition:r,nextBtnPosition:s,axisExtent:l,controlSize:g,controlGap:m};},_position:function _position(t,e){var i=this._mainGroup,n=this._labelGroup,a=t.viewRect;if("vertical"===t.orient){var o=Qt(),r=a.x,s=a.y+a.height;ne(o,o,[-r,-s]),ae(o,o,-wD/2),ne(o,o,[r,s]),(a=a.clone()).applyTransform(o);}var l=m(a),u=m(i.getBoundingRect()),h=m(n.getBoundingRect()),c=i.position,d=n.position;d[0]=c[0]=l[0][0];var f,p=t.labelPosOpt;isNaN(p)?(v(c,u,l,1,f="+"===p?0:1),v(d,h,l,1,1-f)):(v(c,u,l,1,f=0<=p?0:1),d[1]=c[1]+p);function g(t){var e=t.position;t.origin=[l[0][0]-e[0],l[1][0]-e[1]];}function m(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]];}function v(t,e,i,n,a){t[n]+=i[n][a]-e[n][a];}i.attr("position",c),n.attr("position",d),i.rotation=n.rotation=t.rotation,g(i),g(n);},_createAxis:function _createAxis(t,e){var i=e.getData(),n=e.get("axisType"),a=Bp(e,n);a.getTicks=function(){return i.mapArray(["value"],function(t){return t;});};var o=i.getDataExtent("value");a.setExtent(o[0],o[1]),a.niceTicks();var r=new vD("value",a,t.axisExtent,n);return r.model=e,r;},_createGroup:function _createGroup(t){var e=this["_"+t]=new Si();return this.group.add(e),e;},_renderAxisLine:function _renderAxisLine(t,e,i,n){var a=i.getExtent();n.get("lineStyle.show")&&e.add(new Ur({shape:{x1:a[0],y1:0,x2:a[1],y2:0},style:L({lineCap:"round"},n.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}));},_renderAxisTick:function _renderAxisTick(t,s,l,u){var h=u.getData(),e=l.scale.getTicks();_D(e,function(t){var e=l.dataToCoord(t),i=h.getItemModel(t),n=i.getModel("itemStyle"),a=i.getModel("emphasis.itemStyle"),o={position:[e,0],onclick:xD(this._changeTimeline,this,t)},r=bD(i,n,s,o);Os(r,a.getItemStyle()),i.get("tooltip")?(r.dataIndex=t,r.dataModel=u):r.dataIndex=r.dataModel=null;},this);},_renderAxisLabel:function _renderAxisLabel(s,l,u,t){if(u.getLabelModel().get("show")){var h=t.getData(),e=u.getViewLabels();_D(e,function(t){var e=t.tickValue,i=h.getItemModel(e),n=i.getModel("label"),a=i.getModel("emphasis.label"),o=u.dataToCoord(t.tickValue),r=new Dr({position:[o,0],rotation:s.labelRotation-s.rotation,onclick:xD(this._changeTimeline,this,e),silent:!1});Gs(r.style,n,{text:t.formattedLabel,textAlign:s.labelAlign,textVerticalAlign:s.labelBaseline}),l.add(r),Os(r,Gs({},a));},this);}},_renderControl:function _renderControl(t,o,e,r){var s=t.controlSize,l=t.rotation,u=r.getModel("controlStyle").getItemStyle(),h=r.getModel("emphasis.controlStyle").getItemStyle(),c=[0,-s/2,s,s],i=r.getPlayState(),n=r.get("inverse",!0);function a(t,e,i,n){if(t){var a=function(t,e,i,n){return gs(t.get(e).replace(/^path:\/\//,""),D(n||{}),new bi(i[0],i[1],i[2],i[3]),"center");}(r,e,c,{position:t,origin:[s/2,0],rotation:n?-l:0,rectHover:!0,style:u,onclick:i});o.add(a),Os(a,h);}}a(t.nextBtnPosition,"controlStyle.nextIcon",xD(this._changeTimeline,this,n?"-":"+")),a(t.prevBtnPosition,"controlStyle.prevIcon",xD(this._changeTimeline,this,n?"+":"-")),a(t.playPosition,"controlStyle."+(i?"stopIcon":"playIcon"),xD(this._handlePlayClick,this,!i),!0);},_renderCurrentPointer:function _renderCurrentPointer(t,e,i,n){var a=n.getData(),o=n.getCurrentIndex(),r=a.getItemModel(o).getModel("checkpointStyle"),s=this,l={onCreate:function onCreate(t){t.draggable=!0,t.drift=xD(s._handlePointerDrag,s),t.ondragend=xD(s._handlePointerDragend,s),SD(t,o,i,n,!0);},onUpdate:function onUpdate(t){SD(t,o,i,n);}};this._currentPointer=bD(r,r,this._mainGroup,{},this._currentPointer,l);},_handlePlayClick:function _handlePlayClick(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid});},_handlePointerDrag:function _handlePointerDrag(t,e,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY]);},_handlePointerDragend:function _handlePointerDragend(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0);},_pointerChangeTimeline:function _pointerChangeTimeline(t,e){var i=this._toAxisCoord(t)[0],n=wl(this._axis.getExtent().slice());i>n[1]&&(i=n[1]),i<n[0]&&(i=n[0]),this._currentPointer.position[0]=i,this._currentPointer.dirty();var a=this._findNearestTick(i),o=this.model;(e||a!==o.getCurrentIndex()&&o.get("realtime"))&&this._changeTimeline(a);},_doPlayStop:function _doPlayStop(){this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(xD(function(){var t=this.model;this._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1));},this),this.model.get("playInterval")));},_toAxisCoord:function _toAxisCoord(t){return $s(t,this._mainGroup.getLocalTransform(),!0);},_findNearestTick:function _findNearestTick(a){var o,t=this.model.getData(),r=1/0,s=this._axis;return t.each(["value"],function(t,e){var i=s.dataToCoord(t),n=Math.abs(i-a);n<r&&(r=n,o=e);}),o;},_clearTimer:function _clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null);},_changeTimeline:function _changeTimeline(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid});}}),Jd(function(t){var e=t&&t.timeline;k(e)||(e=e?[e]:[]),E(e,function(t){t&&function(t){var e=t.type,i={number:"value",time:"time"};i[e]&&(t.axisType=i[e],delete t.type);if(pD(t),gD(t,"controlPosition")){var n=t.controlStyle||(t.controlStyle={});gD(n,"position")||(n.position=t.controlPosition),"none"!==n.position||gD(n,"show")||(n.show=!1,delete n.position),delete t.controlPosition;}E(t.data||[],function(t){z(t)&&!k(t)&&(!gD(t,"value")&&gD(t,"name")&&(t.value=t.name),pD(t));});}(t);});});var MD=zl,ID=Wl;function AD(t){ba(t,"label",["show"]);}var TD=sf({type:"marker",dependencies:["series","grid","polar","geo"],init:function init(t,e,i){this.mergeDefaultAndTheme(t,i),this._mergeOption(t,i,!1,!0);},isAnimationEnabled:function isAnimationEnabled(){if(v.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.isAnimationEnabled();},mergeOption:function mergeOption(t,e){this._mergeOption(t,e,!1,!1);},_mergeOption:function _mergeOption(t,n,e,a){var o=this.constructor,r=this.mainType+"Model";e||n.eachSeries(function(t){var e=t.get(this.mainType,!0),i=t[r];e&&e.data?(i?i._mergeOption(e,n,!0):(a&&AD(e),E(e.data,function(t){t instanceof Array?(AD(t[0]),AD(t[1])):AD(t);}),L(i=new o(e,this,n),{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),i.__hostSeries=t),t[r]=i):t[r]=null;},this);},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=k(i)?N(i,MD).join(", "):MD(i),a=e.getName(t),o=ID(this.name);return null==i&&!a||(o+="<br />"),a&&(o+=ID(a),null!=i&&(o+=" : ")),null!=i&&(o+=ID(n)),o;},getData:function getData(){return this._data;},setData:function setData(t){this._data=t;}});b(TD,Th),TD.extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}}});var DD=_;function CD(t,e,i,n,a,o){var r=[],s=Zf(e,n)?e.getCalculationInfo("stackResultDimension"):n,l=RD(e,s,t),u=e.indicesOfNearest(s,l)[0];r[a]=e.get(i,u),r[o]=e.get(n,u);var h=bl(e.get(n,u));return 0<=(h=Math.min(h,20))&&(r[o]=+r[o].toFixed(h)),r;}var LD=A,kD={min:LD(CD,"min"),max:LD(CD,"max"),average:LD(CD,"average")};function PD(t,e){var i=t.getData(),n=t.coordinateSystem;if(e&&!function(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y));}(e)&&!k(e.coord)&&n){var a=n.dimensions,o=ND(e,i,n,t);if((e=D(e)).type&&kD[e.type]&&o.baseAxis&&o.valueAxis){var r=DD(a,o.baseAxis.dim),s=DD(a,o.valueAxis.dim);e.coord=kD[e.type](i,o.baseDataDim,o.valueDataDim,r,s),e.value=e.coord[s];}else{for(var l=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],u=0;u<2;u++){kD[l[u]]&&(l[u]=RD(i,i.mapDimension(a[u]),l[u]));}e.coord=l;}}return e;}function ND(t,e,i,n){var a={};return null!=t.valueIndex||null!=t.valueDim?(a.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,a.valueAxis=i.getAxis(function(t,e){var i=t.getData(),n=i.dimensions;e=i.getDimension(e);for(var a=0;a<n.length;a++){var o=i.getDimensionInfo(n[a]);if(o.name===e)return o.coordDim;}}(n,a.valueDataDim)),a.baseAxis=i.getOtherAxis(a.valueAxis),a.baseDataDim=e.mapDimension(a.baseAxis.dim)):(a.baseAxis=n.getBaseAxis(),a.valueAxis=i.getOtherAxis(a.baseAxis),a.baseDataDim=e.mapDimension(a.baseAxis.dim),a.valueDataDim=e.mapDimension(a.valueAxis.dim)),a;}function OD(t,e){return!(t&&t.containData&&e.coord&&!function(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)));}(e))||t.containData(e.coord);}function ED(t,e,i,n){return n<2?t.coord&&t.coord[n]:t.value;}function RD(t,e,i){if("average"!==i)return"median"===i?t.getMedian(e):t.getDataExtent(e,!0)["max"===i?1:0];var n=0,a=0;return t.each(e,function(t,e){isNaN(t)||(n+=t,a++);}),n/a;}var zD=lf({type:"marker",init:function init(){this.markerGroupMap=Q();},render:function render(t,i,n){var e=this.markerGroupMap;e.each(function(t){t.__keep=!1;});var a=this.type+"Model";i.eachSeries(function(t){var e=t[a];e&&this.renderSeries(t,e,i,n);},this),e.each(function(t){t.__keep||this.group.remove(t.group);},this);},renderSeries:function renderSeries(){}});function BD(s,l,u){var h=l.coordinateSystem;s.each(function(t){var e,i=s.getItemModel(t),n=xl(i.get("x"),u.getWidth()),a=xl(i.get("y"),u.getHeight());if(isNaN(n)||isNaN(a)){if(l.getMarkerPosition)e=l.getMarkerPosition(s.getValues(s.dimensions,t));else if(h){var o=s.get(h.dimensions[0],t),r=s.get(h.dimensions[1],t);e=h.dataToPoint([o,r]);}}else e=[n,a];isNaN(n)||(e[0]=n),isNaN(a)||(e[1]=a),s.setItemLayout(t,e);});}zD.extend({type:"markPoint",updateTransform:function updateTransform(t,e,i){e.eachSeries(function(t){var e=t.markPointModel;e&&(BD(e.getData(),t,i),this.markerGroupMap.get(t.id).updateLayout(e));},this);},renderSeries:function renderSeries(t,l,e,i){var n=t.coordinateSystem,a=t.id,u=t.getData(),o=this.markerGroupMap,r=o.get(a)||o.set(a,new Ng()),h=function(t,e,i){var n;n=t?N(t&&t.dimensions,function(t){return C({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{});}):[{name:"value",type:"float"}];var a=new Tf(n,i),o=N(i.get("data"),A(PD,e));t&&(o=M(o,A(OD,t)));return a.initData(o,null,t?ED:function(t){return t.value;}),a;}(n,t,l);l.setData(h),BD(l.getData(),t,i),h.each(function(t){var e=h.getItemModel(t),i=e.getShallow("symbol"),n=e.getShallow("symbolSize"),a=O(i),o=O(n);if(a||o){var r=l.getRawValue(t),s=l.getDataParams(t);a&&(i=i(r,s)),o&&(n=n(r,s));}h.setItemVisual(t,{symbol:i,symbolSize:n,color:e.get("itemStyle.color")||u.getVisual("color")});}),r.updateData(h),this.group.add(r.group),h.eachItemGraphicEl(function(t){t.traverse(function(t){t.dataModel=l;});}),r.__keep=!0,r.group.silent=l.get("silent")||t.get("silent");}}),Jd(function(t){t.markPoint=t.markPoint||{};}),TD.extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end"},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"}});function VD(t,e,i,n){var a=t.getData(),o=n.type;if(!k(n)&&("min"===o||"max"===o||"average"===o||"median"===o||null!=n.xAxis||null!=n.yAxis)){var r,s;if(null!=n.yAxis||null!=n.xAxis)r=e.getAxis(null!=n.yAxis?"y":"x"),s=W(n.yAxis,n.xAxis);else{var l=ND(n,a,e,t);r=l.valueAxis,s=RD(a,Uf(a,l.valueDataDim),o);}var u="x"===r.dim?0:1,h=1-u,c=D(n),d={};c.type=null,c.coord=[],d.coord=[],c.coord[h]=-1/0,d.coord[h]=1/0;var f=i.get("precision");0<=f&&"number"==typeof s&&(s=+s.toFixed(Math.min(f,20))),c.coord[u]=d.coord[u]=s,n=[c,d,{type:o,valueIndex:n.valueIndex,value:s}];}return(n=[PD(t,n[0]),PD(t,n[1]),L({},n[2])])[2].type=n[2].type||"",m(n[2],n[0]),m(n[2],n[1]),n;}function GD(t){return!isNaN(t)&&!isFinite(t);}function FD(t,e,i,n){var a=1-t,o=n.dimensions[t];return GD(e[a])&&GD(i[a])&&e[t]===i[t]&&n.getAxis(o).containData(e[t]);}function WD(t,e){if("cartesian2d"===t.type){var i=e[0].coord,n=e[1].coord;if(i&&n&&(FD(1,i,n,t)||FD(0,i,n,t)))return!0;}return OD(t,e[0])&&OD(t,e[1]);}function HD(t,e,i,n,a){var o,r=n.coordinateSystem,s=t.getItemModel(e),l=xl(s.get("x"),a.getWidth()),u=xl(s.get("y"),a.getHeight());if(isNaN(l)||isNaN(u)){if(n.getMarkerPosition)o=n.getMarkerPosition(t.getValues(t.dimensions,e));else{var h=r.dimensions,c=t.get(h[0],e),d=t.get(h[1],e);o=r.dataToPoint([c,d]);}if("cartesian2d"===r.type){var f=r.getAxis("x"),p=r.getAxis("y");h=r.dimensions;GD(t.get(h[0],e))?o[0]=f.toGlobalCoord(f.getExtent()[i?0:1]):GD(t.get(h[1],e))&&(o[1]=p.toGlobalCoord(p.getExtent()[i?0:1]));}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u);}else o=[l,u];t.setItemLayout(e,o);}zD.extend({type:"markLine",updateTransform:function updateTransform(t,e,o){e.eachSeries(function(e){var t=e.markLineModel;if(t){var i=t.getData(),n=t.__from,a=t.__to;n.each(function(t){HD(n,t,!0,e,o),HD(a,t,!1,e,o);}),i.each(function(t){i.setItemLayout(t,[n.getItemLayout(t),a.getItemLayout(t)]);}),this.markerGroupMap.get(e.id).updateLayout();}},this);},renderSeries:function renderSeries(a,i,t,o){var e=a.coordinateSystem,n=a.id,r=a.getData(),s=this.markerGroupMap,l=s.get(n)||s.set(n,new z_());this.group.add(l.group);var u=function(t,e,i){var n;n=t?N(t&&t.dimensions,function(t){return C({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{});}):[{name:"value",type:"float"}];var a=new Tf(n,i),o=new Tf(n,i),r=new Tf([],i),s=N(i.get("data"),A(VD,e,t,i));t&&(s=M(s,A(WD,t)));var l=t?ED:function(t){return t.value;};return a.initData(N(s,function(t){return t[0];}),null,l),o.initData(N(s,function(t){return t[1];}),null,l),r.initData(N(s,function(t){return t[2];})),r.hasItemOption=!0,{from:a,to:o,line:r};}(e,a,i),h=u.from,c=u.to,d=u.line;i.__from=h,i.__to=c,i.setData(d);var f=i.get("symbol"),p=i.get("symbolSize");function g(t,e,i){var n=t.getItemModel(e);HD(t,e,i,a,o),t.setItemVisual(e,{symbolSize:n.get("symbolSize")||p[i?0:1],symbol:n.get("symbol",!0)||f[i?0:1],color:n.get("itemStyle.color")||r.getVisual("color")});}k(f)||(f=[f,f]),"number"==typeof p&&(p=[p,p]),u.from.each(function(t){g(h,t,!0),g(c,t,!1);}),d.each(function(t){var e=d.getItemModel(t).get("lineStyle.color");d.setItemVisual(t,{color:e||h.getItemVisual(t,"color")}),d.setItemLayout(t,[h.getItemLayout(t),c.getItemLayout(t)]),d.setItemVisual(t,{fromSymbolSize:h.getItemVisual(t,"symbolSize"),fromSymbol:h.getItemVisual(t,"symbol"),toSymbolSize:c.getItemVisual(t,"symbolSize"),toSymbol:c.getItemVisual(t,"symbol")});}),l.updateData(d),u.line.eachItemGraphicEl(function(t,e){t.traverse(function(t){t.dataModel=i;});}),l.__keep=!0,l.group.silent=i.get("silent")||a.get("silent");}}),Jd(function(t){t.markLine=t.markLine||{};}),TD.extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}}});function ZD(t,e,i,n){var a=PD(t,n[0]),o=PD(t,n[1]),r=W,s=a.coord,l=o.coord;s[0]=r(s[0],-1/0),s[1]=r(s[1],-1/0),l[0]=r(l[0],1/0),l[1]=r(l[1],1/0);var u=p([{},a,o]);return u.coord=[a.coord,o.coord],u.x0=a.x,u.y0=a.y,u.x1=o.x,u.y1=o.y,u;}function UD(t){return!isNaN(t)&&!isFinite(t);}function XD(t,e,i){var n=1-t;return UD(e[n])&&UD(i[n]);}function YD(t,e){var i=e.coord[0],n=e.coord[1];return!("cartesian2d"!==t.type||!i||!n||!XD(1,i,n)&&!XD(0,i,n))||OD(t,{coord:i,x:e.x0,y:e.y0})||OD(t,{coord:n,x:e.x1,y:e.y1});}function jD(t,e,i,n,a){var o,r=n.coordinateSystem,s=t.getItemModel(e),l=xl(s.get(i[0]),a.getWidth()),u=xl(s.get(i[1]),a.getHeight());if(isNaN(l)||isNaN(u)){if(n.getMarkerPosition)o=n.getMarkerPosition(t.getValues(i,e));else{var h=[f=t.get(i[0],e),p=t.get(i[1],e)];r.clampData&&r.clampData(h,h),o=r.dataToPoint(h,!0);}if("cartesian2d"===r.type){var c=r.getAxis("x"),d=r.getAxis("y"),f=t.get(i[0],e),p=t.get(i[1],e);UD(f)?o[0]=c.toGlobalCoord(c.getExtent()["x0"===i[0]?0:1]):UD(p)&&(o[1]=d.toGlobalCoord(d.getExtent()["y0"===i[1]?0:1]));}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u);}else o=[l,u];return o;}var qD=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];zD.extend({type:"markArea",updateTransform:function updateTransform(t,e,a){e.eachSeries(function(i){var t=i.markAreaModel;if(t){var n=t.getData();n.each(function(e){var t=N(qD,function(t){return jD(n,e,t,i,a);});n.setItemLayout(e,t),n.getItemGraphicEl(e).setShape("points",t);});}},this);},renderSeries:function renderSeries(i,r,t,n){var e=i.coordinateSystem,a=i.id,o=i.getData(),s=this.markerGroupMap,l=s.get(a)||s.set(a,{group:new Si()});this.group.add(l.group),l.__keep=!0;var u=function(t,i,e){var n,a;a=t?(n=N(t&&t.dimensions,function(t){var e=i.getData();return C({name:t},e.getDimensionInfo(e.mapDimension(t))||{});}),new Tf(N(["x0","y0","x1","y1"],function(t,e){return{name:t,type:n[e%2].type};}),e)):new Tf(n=[{name:"value",type:"float"}],e);var o=N(e.get("data"),A(ZD,i,t,e));t&&(o=M(o,A(YD,t)));var r=t?function(t,e,i,n){return t.coord[Math.floor(n/2)][n%2];}:function(t){return t.value;};return a.initData(o,null,r),a.hasItemOption=!0,a;}(e,i,r);r.setData(u),u.each(function(e){u.setItemLayout(e,N(qD,function(t){return jD(u,e,t,i,n);})),u.setItemVisual(e,{color:o.getVisual("color")});}),u.diff(l.__data).add(function(t){var e=new Rr({shape:{points:u.getItemLayout(t)}});u.setItemGraphicEl(t,e),l.group.add(e);}).update(function(t,e){var i=l.__data.getItemGraphicEl(e);js(i,{shape:{points:u.getItemLayout(t)}},r,t),l.group.add(i),u.setItemGraphicEl(t,i);}).remove(function(t){var e=l.__data.getItemGraphicEl(t);l.group.remove(e);}).execute(),u.eachItemGraphicEl(function(t,e){var i=u.getItemModel(e),n=i.getModel("label"),a=i.getModel("emphasis.label"),o=u.getItemVisual(e,"color");t.useStyle(C(i.getModel("itemStyle").getItemStyle(),{fill:Ze(o,.4),stroke:o})),t.hoverStyle=i.getModel("emphasis.itemStyle").getItemStyle(),Bs(t.style,t.hoverStyle,n,a,{labelFetcher:r,labelDataIndex:e,defaultText:u.getName(e)||"",isRectText:!0,autoColor:o}),Os(t,{}),t.dataModel=r;}),l.__data=u,l.group.silent=r.get("silent")||i.get("silent");}}),Jd(function(t){t.markArea=t.markArea||{};});var KD=gc.legend.selector,$D={all:{type:"all",title:D(KD.all)},inverse:{type:"inverse",title:D(KD.inverse)}},JD=sf({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function init(t,e,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{},this._updateSelector(t);},mergeOption:function mergeOption(t){JD.superCall(this,"mergeOption",t),this._updateSelector(t);},_updateSelector:function _updateSelector(t){var i=t.selector;!0===i&&(i=t.selector=["all","inverse"]),k(i)&&E(i,function(t,e){R(t)&&(t={type:t}),i[e]=m(t,$D[t.type]);});},optionUpdated:function optionUpdated(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,i=0;i<t.length;i++){var n=t[i].get("name");if(this.isSelected(n)){this.select(n),e=!0;break;}}e||this.select(t[0].get("name"));}},_updateData:function _updateData(o){var r=[],s=[];o.eachRawSeries(function(t){var e,i=t.name;if(s.push(i),t.legendDataProvider){var n=t.legendDataProvider(),a=n.mapArray(n.getName);o.isSeriesFiltered(t)||(s=s.concat(a)),a.length?r=r.concat(a):e=!0;}else e=!0;e&&Ta(t)&&r.push(t.name);}),this._availableNames=s;var t=N(this.get("data")||r,function(t){return"string"!=typeof t&&"number"!=typeof t||(t={name:t}),new dl(t,this,this.ecModel);},this);this._data=t;},getData:function getData(){return this._data;},select:function select(t){var e=this.option.selected;"single"===this.get("selectedMode")&&E(this._data,function(t){e[t.get("name")]=!1;});e[t]=!0;},unSelect:function unSelect(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1);},toggleSelected:function toggleSelected(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t);},allSelect:function allSelect(){var t=this._data,e=this.option.selected;E(t,function(t){e[t.get("name",!0)]=!0;});},inverseSelect:function inverseSelect(){var t=this._data,i=this.option.selected;E(t,function(t){var e=t.get("name",!0);i.hasOwnProperty(e)||(i[e]=!0),i[e]=!i[e];});},isSelected:function isSelected(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&0<=_(this._availableNames,t);},getOrient:function getOrient(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"};},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",itemStyle:{borderWidth:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}}});function QD(t,e,i){var a,o={},r="toggleSelected"===t;return i.eachComponent("legend",function(n){r&&null!=a?n[a?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?n[t]():(n[t](e.name),a=n.isSelected(e.name)),E(n.getData(),function(t){var e=t.get("name");if("\n"!==e&&""!==e){var i=n.isSelected(e);o.hasOwnProperty(e)?o[e]=o[e]&&i:o[e]=i;}});}),"allSelect"===t||"inverseSelect"===t?{selected:o}:{name:e.name,selected:o};}tf("legendToggleSelect","legendselectchanged",A(QD,"toggleSelected")),tf("legendAllSelect","legendselectall",A(QD,"allSelect")),tf("legendInverseSelect","legendinverseselect",A(QD,"inverseSelect")),tf("legendSelect","legendselected",A(QD,"select")),tf("legendUnSelect","legendunselected",A(QD,"unSelect"));var tC=A,eC=E,iC=Si,nC=lf({type:"legend.plain",newlineDisabled:!1,init:function init(){this.group.add(this._contentGroup=new iC()),this._backgroundEl,this.group.add(this._selectorGroup=new iC()),this._isFirstRender=!0;},getContentGroup:function getContentGroup(){return this._contentGroup;},getSelectorGroup:function getSelectorGroup(){return this._selectorGroup;},render:function render(t,e,i){var n=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var a=t.get("align"),o=t.get("orient");a&&"auto"!==a||(a="right"===t.get("left")&&"vertical"===o?"right":"left");var r=t.get("selector",!0),s=t.get("selectorPosition",!0);!r||s&&"auto"!==s||(s="horizontal"===o?"end":"start"),this.renderInner(a,t,e,i,r,o,s);var l=t.getBoxLayoutParams(),u={width:i.getWidth(),height:i.getHeight()},h=t.get("padding"),c=au(l,u,h),d=this.layoutInner(t,a,c,n,r,s),f=au(C({width:d.width,height:d.height},l),u,h);this.group.attr("position",[f.x-d.x,f.y-d.y]),this.group.add(this._backgroundEl=IA(d,t));}},resetInner:function resetInner(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll();},renderInner:function renderInner(u,h,c,d,t,e,i){var f=this.getContentGroup(),p=Q(),g=h.get("selectedMode"),m=[];c.eachRawSeries(function(t){t.get("legendHoverLink")||m.push(t.id);}),eC(h.getData(),function(o,r){var s=o.get("name");if(this.newlineDisabled||""!==s&&"\n"!==s){var t=c.getSeriesByName(s)[0];if(!p.get(s))if(t){var e=t.getData(),i=e.getVisual("color"),n=e.getVisual("borderColor");"function"==typeof i&&(i=i(t.getDataParams(0))),"function"==typeof n&&(n=n(t.getDataParams(0)));var a=e.getVisual("legendSymbol")||"roundRect",l=e.getVisual("symbol");this._createItem(s,r,o,h,a,l,u,i,n,g).on("click",tC(oC,s,d)).on("mouseover",tC(rC,t.name,null,d,m)).on("mouseout",tC(sC,t.name,null,d,m)),p.set(s,!0);}else c.eachRawSeries(function(t){if(!p.get(s)&&t.legendDataProvider){var e=t.legendDataProvider(),i=e.indexOfName(s);if(i<0)return;var n=e.getItemVisual(i,"color"),a=e.getItemVisual(i,"borderColor");this._createItem(s,r,o,h,"roundRect",null,u,n,a,g).on("click",tC(oC,s,d)).on("mouseover",tC(rC,null,s,d,m)).on("mouseout",tC(sC,null,s,d,m)),p.set(s,!0);}},this);}else f.add(new iC({newline:!0}));},this),t&&this._createSelector(t,h,d,e,i);},_createSelector:function _createSelector(t,o,r,e,i){var s=this.getSelectorGroup();eC(t,function(t){!function(t){var e=t.type,i=new Dr({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function onclick(){r.dispatchAction({type:"all"===e?"legendAllSelect":"legendInverseSelect"});}});s.add(i);var n=o.getModel("selectorLabel"),a=o.getModel("emphasis.selectorLabel");Bs(i.style,i.hoverStyle={},n,a,{defaultText:t.title,isRectText:!1}),Os(i);}(t);});},_createItem:function _createItem(t,e,i,n,a,o,r,s,l,u){var h=n.get("itemWidth"),c=n.get("itemHeight"),d=n.get("inactiveColor"),f=n.get("inactiveBorderColor"),p=n.get("symbolKeepAspect"),g=n.getModel("itemStyle"),m=n.isSelected(t),v=new iC(),y=i.getModel("textStyle"),x=i.get("icon"),_=i.getModel("tooltip"),w=_.parentModel,b=Jp(a=x||a,0,0,h,c,m?s:d,null==p||p);if(v.add(aC(b,a,g,l,f,m)),!x&&o&&(o!==a||"none"===o)){var S=.8*c;"none"===o&&(o="circle");var M=Jp(o,(h-S)/2,(c-S)/2,S,S,m?s:d,null==p||p);v.add(aC(M,o,g,l,f,m));}var I="left"===r?h+5:-5,A=r,T=n.get("formatter"),D=t;"string"==typeof T&&T?D=T.replace("{name}",null!=t?t:""):"function"==typeof T&&(D=T(t)),v.add(new Dr({style:Gs({},y,{text:D,x:I,y:c/2,textFill:m?y.getTextColor():d,textAlign:A,textVerticalAlign:"middle"})}));var C=new Hr({shape:v.getBoundingRect(),invisible:!0,tooltip:_.get("show")?L({content:t,formatter:w.get("formatter",!0)||function(){return t;},formatterParams:{componentType:"legend",legendIndex:n.componentIndex,name:t,$vars:["name"]}},_.option):null});return v.add(C),v.eachChild(function(t){t.silent=!0;}),C.silent=!u,this.getContentGroup().add(v),Os(v),v.__legendDataIndex=e,v;},layoutInner:function layoutInner(t,e,i,n,a,o){var r=this.getContentGroup(),s=this.getSelectorGroup();nu(t.get("orient"),r,t.get("itemGap"),i.width,i.height);var l=r.getBoundingRect(),u=[-l.x,-l.y];if(a){nu("horizontal",s,t.get("selectorItemGap",!0));var h=s.getBoundingRect(),c=[-h.x,-h.y],d=t.get("selectorButtonGap",!0),f=t.getOrient().index,p=0===f?"width":"height",g=0===f?"height":"width",m=0===f?"y":"x";"end"===o?c[f]+=l[p]+d:u[f]+=h[p]+d,c[1-f]+=l[g]/2-h[g]/2,s.attr("position",c),r.attr("position",u);var v={x:0,y:0};return v[p]=l[p]+d+h[p],v[g]=Math.max(l[g],h[g]),v[m]=Math.min(0,h[m]+c[1-f]),v;}return r.attr("position",u),this.group.getBoundingRect();},remove:function remove(){this.getContentGroup().removeAll(),this._isFirstRender=!0;}});function aC(t,e,i,n,a,o){var r;return"line"!==e&&e.indexOf("empty")<0?(r=i.getItemStyle(),t.style.stroke=n,o||(r.stroke=a)):r=i.getItemStyle(["borderWidth","borderColor"]),t.setStyle(r);}function oC(t,e){e.dispatchAction({type:"legendToggleSelect",name:t});}function rC(t,e,i,n){var a=i.getZr().storage.getDisplayList()[0];a&&a.useHoverLayer||i.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:n});}function sC(t,e,i,n){var a=i.getZr().storage.getDisplayList()[0];a&&a.useHoverLayer||i.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:n});}Qd(cd.PROCESSOR.SERIES_FILTER,function(t){var i=t.findComponents({mainType:"legend"});i&&i.length&&t.filterSeries(function(t){for(var e=0;e<i.length;e++){if(!i[e].isSelected(t.name))return!1;}return!0;});}),fu.registerSubTypeDefaulter("legend",function(){return"plain";});var lC=JD.extend({type:"legend.scroll",setScrollDataIndex:function setScrollDataIndex(t){this.option.scrollDataIndex=t;},defaultOption:{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800},init:function init(t,e,i,n){var a=su(t);lC.superCall(this,"init",t,e,i,n),uC(this,t,a);},mergeOption:function mergeOption(t,e){lC.superCall(this,"mergeOption",t,e),uC(this,this.option,t);}});function uC(t,e,i){var n=[1,1];n[t.getOrient().index]=0,ru(e,i,{type:"box",ignoreSize:n});}var hC=Si,cC=["width","height"],dC=["x","y"],fC=nC.extend({type:"legend.scroll",newlineDisabled:!0,init:function init(){fC.superCall(this,"init"),this._currentIndex=0,this.group.add(this._containerGroup=new hC()),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new hC()),this._showController;},resetInner:function resetInner(){fC.superCall(this,"resetInner"),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null;},renderInner:function renderInner(t,a,e,o,i,n,r){var s=this;fC.superCall(this,"renderInner",t,a,e,o,i,n,r);var l=this._controllerGroup,u=a.get("pageIconSize",!0);k(u)||(u=[u,u]),c("pagePrev",0);var h=a.getModel("pageTextStyle");function c(t,e){var i=t+"DataIndex",n=el(a.get("pageIcons",!0)[a.getOrient().name][e],{onclick:T(s._pageGo,s,i,a,o)},{x:-u[0]/2,y:-u[1]/2,width:u[0],height:u[1]});n.name=t,l.add(n);}l.add(new Dr({name:"pageText",style:{textFill:h.getTextColor(),font:h.getFont(),textVerticalAlign:"middle",textAlign:"center"},silent:!0})),c("pageNext",1);},layoutInner:function layoutInner(t,e,i,n,a,o){var r=this.getSelectorGroup(),s=t.getOrient().index,l=cC[s],u=dC[s],h=cC[1-s],c=dC[1-s];a&&nu("horizontal",r,t.get("selectorItemGap",!0));var d=t.get("selectorButtonGap",!0),f=r.getBoundingRect(),p=[-f.x,-f.y],g=D(i);a&&(g[l]=i[l]-f[l]-d);var m=this._layoutContentAndController(t,n,g,s,l,h,c);if(a){if("end"===o)p[s]+=m[l]+d;else{var v=f[l]+d;p[s]-=v,m[u]-=v;}m[l]+=f[l]+d,p[1-s]+=m[c]+m[h]/2-f[h]/2,m[h]=Math.max(m[h],f[h]),m[c]=Math.min(m[c],f[c]+p[1-s]),r.attr("position",p);}return m;},_layoutContentAndController:function _layoutContentAndController(t,e,i,n,a,o,r){var s=this.getContentGroup(),l=this._containerGroup,u=this._controllerGroup;nu(t.get("orient"),s,t.get("itemGap"),n?i.width:null,n?null:i.height),nu("horizontal",u,t.get("pageButtonItemGap",!0));var h=s.getBoundingRect(),c=u.getBoundingRect(),d=this._showController=h[a]>i[a],f=[-h.x,-h.y];e||(f[n]=s.position[n]);var p=[0,0],g=[-c.x,-c.y],m=H(t.get("pageButtonGap",!0),t.get("itemGap",!0));d&&("end"===t.get("pageButtonPosition",!0)?g[n]+=i[a]-c[a]:p[n]+=c[a]+m);g[1-n]+=h[o]/2-c[o]/2,s.attr("position",f),l.attr("position",p),u.attr("position",g);var v={x:0,y:0};if(v[a]=d?i[a]:h[a],v[o]=Math.max(h[o],c[o]),v[r]=Math.min(0,c[r]+g[1-n]),l.__rectSize=i[a],d){var y={x:0,y:0};y[a]=Math.max(i[a]-c[a]-m,0),y[o]=v[o],l.setClipPath(new Hr({shape:y})),l.__rectSize=y[a];}else u.eachChild(function(t){t.attr({invisible:!0,silent:!0});});var x=this._getPageInfo(t);return null!=x.pageIndex&&js(s,{position:x.contentPosition},d&&t),this._updatePageInfoView(t,x),v;},_pageGo:function _pageGo(t,e,i){var n=this._getPageInfo(e)[t];null!=n&&i.dispatchAction({type:"legendScroll",scrollDataIndex:n,legendId:e.id});},_updatePageInfoView:function _updatePageInfoView(n,a){var o=this._controllerGroup;E(["pagePrev","pageNext"],function(t){var e=null!=a[t+"DataIndex"],i=o.childOfName(t);i&&(i.setStyle("fill",e?n.get("pageIconColor",!0):n.get("pageIconInactiveColor",!0)),i.cursor=e?"pointer":"default");});var t=o.childOfName("pageText"),e=n.get("pageFormatter"),i=a.pageIndex,r=null!=i?i+1:0,s=a.pageCount;t&&e&&t.setStyle("text",R(e)?e.replace("{current}",r).replace("{total}",s):e({current:r,total:s}));},_getPageInfo:function _getPageInfo(t){var e=t.get("scrollDataIndex",!0),i=this.getContentGroup(),n=this._containerGroup.__rectSize,a=t.getOrient().index,o=cC[a],r=dC[a],s=this._findTargetItemIndex(e),l=i.children(),u=l[s],h=l.length,c=h?1:0,d={contentPosition:i.position.slice(),pageCount:c,pageIndex:c-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!u)return d;var f=y(u);d.contentPosition[a]=-f.s;for(var p=s+1,g=f,m=f,v=null;p<=h;++p){(!(v=y(l[p]))&&m.e>g.s+n||v&&!x(v,g.s))&&(g=m.i>g.i?m:v)&&(null==d.pageNextDataIndex&&(d.pageNextDataIndex=g.i),++d.pageCount),m=v;}for(p=s-1,g=f,m=f,v=null;-1<=p;--p){(v=y(l[p]))&&x(m,v.s)||!(g.i<m.i)||(m=g,null==d.pagePrevDataIndex&&(d.pagePrevDataIndex=g.i),++d.pageCount,++d.pageIndex),g=v;}return d;function y(t){if(t){var e=t.getBoundingRect(),i=e[r]+t.position[a];return{s:i,e:i+e[o],i:t.__legendDataIndex};}}function x(t,e){return t.e>=e&&t.s<=e+n;}},_findTargetItemIndex:function _findTargetItemIndex(n){var a,o,t=this.getContentGroup();return this._showController&&t.eachChild(function(t,e){var i=t.__legendDataIndex;null==o&&null!=i&&(o=e),i===n&&(a=e);}),null!=a?a:o;}});tf("legendScroll","legendscroll",function(t,e){var i=t.scrollDataIndex;null!=i&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(t){t.setScrollDataIndex(i);});});_T.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});var pC=Hr,gC=yl,mC=wl,vC=T,yC=E,xC="horizontal",_C="vertical",wC=["line","bar","candlestick","scatter"],bC=ST.extend({type:"dataZoom.slider",init:function init(t,e){this._displayables={},this._orient,this._range,this._handleEnds,this._size,this._handleWidth,this._handleHeight,this._location,this._dragging,this._dataShadowInfo,this.api=e;},render:function render(t,e,i,n){bC.superApply(this,"render",arguments),dc(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=t.get("orient"),!1!==this.dataZoomModel.get("show")?(n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),this._updateView()):this.group.removeAll();},remove:function remove(){bC.superApply(this,"remove",arguments),fc(this,"_dispatchZoomAction");},dispose:function dispose(){bC.superApply(this,"dispose",arguments),fc(this,"_dispatchZoomAction");},_buildView:function _buildView(){var t=this.group;t.removeAll(),this._resetLocation(),this._resetInterval();var e=this._displayables.barGroup=new Si();this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup();},_resetLocation:function _resetLocation(){var t=this.dataZoomModel,e=this.api,i=this._findCoordRect(),n={width:e.getWidth(),height:e.getHeight()},a=this._orient===xC?{right:n.width-i.x-i.width,top:n.height-30-7,width:i.width,height:30}:{right:7,top:i.y,width:30,height:i.height},o=su(t.option);E(["right","top","width","height"],function(t){"ph"===o[t]&&(o[t]=a[t]);});var r=au(o,n,t.padding);this._location={x:r.x,y:r.y},this._size=[r.width,r.height],this._orient===_C&&this._size.reverse();},_positionGroup:function _positionGroup(){var t=this.group,e=this._location,i=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),a=n&&n.get("inverse"),o=this._displayables.barGroup,r=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(i!==xC||a?i===xC&&a?{scale:r?[-1,1]:[-1,-1]}:i!==_C||a?{scale:r?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:r?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:r?[1,1]:[1,-1]});var s=t.getBoundingRect([o]);t.attr("position",[e.x-s.x,e.y-s.y]);},_getViewExtent:function _getViewExtent(){return[0,this._size[0]];},_renderBackground:function _renderBackground(){var t=this.dataZoomModel,e=this._size,i=this._displayables.barGroup;i.add(new pC({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40})),i.add(new pC({shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:"transparent"},z2:0,onclick:T(this._onClickPanelClick,this)}));},_renderDataShadow:function _renderDataShadow(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(t){var e=this._size,i=t.series,n=i.getRawData(),a=i.getShadowDim?i.getShadowDim():t.otherDim;if(null!=a){var o=n.getDataExtent(a),r=.3*(o[1]-o[0]);o=[o[0]-r,o[1]+r];var s,l=[0,e[1]],u=[0,e[0]],h=[[e[0],0],[0,0]],c=[],d=u[1]/(n.count()-1),f=0,p=Math.round(n.count()/e[0]);n.each([a],function(t,e){if(0<p&&e%p)f+=d;else{var i=null==t||isNaN(t)||""===t,n=i?0:gC(t,o,l,!0);i&&!s&&e?(h.push([h[h.length-1][0],0]),c.push([c[c.length-1][0],0])):!i&&s&&(h.push([f,0]),c.push([f,0])),h.push([f,n]),c.push([f,n]),f+=d,s=i;}});var g=this.dataZoomModel;this._displayables.barGroup.add(new Rr({shape:{points:h},style:C({fill:g.get("dataBackgroundColor")},g.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new zr({shape:{points:c},style:g.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}));}}},_prepareDataShadowInfo:function _prepareDataShadowInfo(){var t=this.dataZoomModel,s=t.get("showDataShadow");if(!1!==s){var l,u=this.ecModel;return t.eachTargetAxis(function(o,r){E(t.getAxisProxy(o.name,r).getTargetSeriesModels(),function(t){if(!(l||!0!==s&&_(wC,t.get("type"))<0)){var e,i=u.getComponent(o.axis,r).axis,n=function(t){return{x:"y",y:"x",radius:"angle",angle:"radius"}[t];}(o.name),a=t.coordinateSystem;null!=n&&a.getOtherAxis&&(e=a.getOtherAxis(i).inverse),n=t.getData().mapDimension(n),l={thisAxis:i,series:t,thisDim:o.name,otherDim:n,otherAxisInverse:e};}},this);},this),l;}},_renderHandle:function _renderHandle(){var t=this._displayables,o=t.handles=[],r=t.handleLabels=[],s=this._displayables.barGroup,e=this._size,l=this.dataZoomModel;s.add(t.filler=new pC({draggable:!0,cursor:SC(this._orient),drift:vC(this._onDragMove,this,"all"),onmousemove:function onmousemove(t){Ft(t.event);},ondragstart:vC(this._showDataInfo,this,!0),ondragend:vC(this._onDragEnd,this),onmouseover:vC(this._showDataInfo,this,!0),onmouseout:vC(this._showDataInfo,this,!1),style:{fill:l.get("fillerColor"),textPosition:"inside"}})),s.add(new pC({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),yC([0,1],function(t){var e=el(l.get("handleIcon"),{cursor:SC(this._orient),draggable:!0,drift:vC(this._onDragMove,this,t),onmousemove:function onmousemove(t){Ft(t.event);},ondragend:vC(this._onDragEnd,this),onmouseover:vC(this._showDataInfo,this,!0),onmouseout:vC(this._showDataInfo,this,!1)},{x:-1,y:0,width:2,height:2}),i=e.getBoundingRect();this._handleHeight=xl(l.get("handleSize"),this._size[1]),this._handleWidth=i.width/i.height*this._handleHeight,e.setStyle(l.getModel("handleStyle").getItemStyle());var n=l.get("handleColor");null!=n&&(e.style.fill=n),s.add(o[t]=e);var a=l.textStyleModel;this.group.add(r[t]=new Dr({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",textFill:a.getTextColor(),textFont:a.getFont()},z2:10}));},this);},_resetInterval:function _resetInterval(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[gC(t[0],[0,100],e,!0),gC(t[1],[0,100],e,!0)];},_updateInterval:function _updateInterval(t,e){var i=this.dataZoomModel,n=this._handleEnds,a=this._getViewExtent(),o=i.findRepresentativeAxisProxy().getMinMaxSpan(),r=[0,100];ww(e,n,a,i.get("zoomLock")?"all":t,null!=o.minSpan?gC(o.minSpan,r,a,!0):null,null!=o.maxSpan?gC(o.maxSpan,r,a,!0):null);var s=this._range,l=this._range=mC([gC(n[0],a,r,!0),gC(n[1],a,r,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1];},_updateView:function _updateView(t){var n=this._displayables,a=this._handleEnds,e=mC(a.slice()),o=this._size;yC([0,1],function(t){var e=n.handles[t],i=this._handleHeight;e.attr({scale:[i/2,i/2],position:[a[t],o[1]/2-i/2]});},this),n.filler.setShape({x:e[0],y:0,width:e[1]-e[0],height:o[1]}),this._updateDataInfo(t);},_updateDataInfo:function _updateDataInfo(t){var e=this.dataZoomModel,o=this._displayables,r=o.handleLabels,s=this._orient,l=["",""];if(e.get("showDetail")){var i=e.findRepresentativeAxisProxy();if(i){var n=i.getAxisModel().axis,a=this._range,u=t?i.calculateDataWindow({start:a[0],end:a[1]}).valueWindow:i.getDataValueWindow();l=[this._formatLabel(u[0],n),this._formatLabel(u[1],n)];}}var h=mC(this._handleEnds.slice());function c(t){var e=Ks(o.handles[t].parent,this.group),i=Js(0===t?"right":"left",e),n=this._handleWidth/2+5,a=$s([h[t]+(0===t?-n:n),this._size[1]/2],e);r[t].setStyle({x:a[0],y:a[1],textVerticalAlign:s===xC?"middle":i,textAlign:s===xC?i:"center",text:l[t]});}c.call(this,0),c.call(this,1);},_formatLabel:function _formatLabel(t,e){var i=this.dataZoomModel,n=i.get("labelFormatter"),a=i.get("labelPrecision");null!=a&&"auto"!==a||(a=e.getPixelPrecision());var o=null==t||isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel(Math.round(t)):t.toFixed(Math.min(a,20));return O(n)?n(t,o):R(n)?n.replace("{value}",o):o;},_showDataInfo:function _showDataInfo(t){t=this._dragging||t;var e=this._displayables.handleLabels;e[0].attr("invisible",!t),e[1].attr("invisible",!t);},_onDragMove:function _onDragMove(t,e,i){this._dragging=!0;var n=$s([e,i],this._displayables.barGroup.getLocalTransform(),!0),a=this._updateInterval(t,n[0]),o=this.dataZoomModel.get("realtime");this._updateView(!o),a&&o&&this._dispatchZoomAction();},_onDragEnd:function _onDragEnd(){this._dragging=!1,this._showDataInfo(!1),this.dataZoomModel.get("realtime")||this._dispatchZoomAction();},_onClickPanelClick:function _onClickPanelClick(t){var e=this._size,i=this._displayables.barGroup.transformCoordToLocal(t.offsetX,t.offsetY);if(!(i[0]<0||i[0]>e[0]||i[1]<0||i[1]>e[1])){var n=this._handleEnds,a=(n[0]+n[1])/2,o=this._updateInterval("all",i[0]-a);this._updateView(),o&&this._dispatchZoomAction();}},_dispatchZoomAction:function _dispatchZoomAction(){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:t[0],end:t[1]});},_findCoordRect:function _findCoordRect(){var i;if(yC(this.getTargetCoordInfo(),function(t){if(!i&&t.length){var e=t[0].model.coordinateSystem;i=e.getRect&&e.getRect();}}),!i){var t=this.api.getWidth(),e=this.api.getHeight();i={x:.2*t,y:.2*e,width:.6*t,height:.6*e};}return i;}});function SC(t){return"vertical"===t?"ns-resize":"ew-resize";}_T.extend({type:"dataZoom.inside",defaultOption:{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}});var MC="\0_ec_dataZoom_roams";function IC(t,n){var e=TC(t),a=n.dataZoomId,o=n.coordId;E(e,function(t,e){var i=t.dataZoomInfos;i[a]&&_(n.allCoordIds,o)<0&&(delete i[a],t.count--);}),DC(e);var i=e[o];i||((i=e[o]={coordId:o,dataZoomInfos:{},count:0}).controller=function(t,r){var e=new uy(t.getZr());return E(["pan","zoom","scrollMove"],function(o){e.on(o,function(n){var a=[];E(r.dataZoomInfos,function(t){if(n.isAvailableBehavior(t.dataZoomModel.option)){var e=(t.getRange||{})[o],i=e&&e(r.controller,n);!t.dataZoomModel.get("disabled",!0)&&i&&a.push({dataZoomId:t.dataZoomId,start:i[0],end:i[1]});}}),a.length&&r.dispatchAction(a);});}),e;}(t,i),i.dispatchAction=A(CC,t)),i.dataZoomInfos[a]||i.count++,i.dataZoomInfos[a]=n;var r=function(t){var n,a={type_true:2,type_move:1,type_false:0,type_undefined:-1},o=!0;return E(t,function(t){var e=t.dataZoomModel,i=!e.get("disabled",!0)&&(!e.get("zoomLock",!0)||"move");a["type_"+n]<a["type_"+i]&&(n=i),o&=e.get("preventDefaultMouseMove",!0);}),{controlType:n,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!o}};}(i.dataZoomInfos);i.controller.enable(r.controlType,r.opt),i.controller.setPointerChecker(n.containsPoint),dc(i,"dispatchAction",n.dataZoomModel.get("throttle",!0),"fixRate");}function AC(t){return t.type+"\0_"+t.id;}function TC(t){var e=t.getZr();return e[MC]||(e[MC]={});}function DC(i){E(i,function(t,e){t.count||(t.controller.dispose(),delete i[e]);});}function CC(t,e){t.dispatchAction({type:"dataZoom",batch:e});}var LC=T,kC=ST.extend({type:"dataZoom.inside",init:function init(t,e){this._range;},render:function render(r,t,s,e){kC.superApply(this,"render",arguments),this._range=r.getPercentRange(),E(this.getTargetCoordInfo(),function(t,a){var o=N(t,function(t){return AC(t.model);});E(t,function(e){var n=e.model,i={};E(["pan","zoom","scrollMove"],function(t){i[t]=LC(PC[t],this,e,a);},this),IC(s,{coordId:AC(n),allCoordIds:o,containsPoint:function containsPoint(t,e,i){return n.coordinateSystem.containPoint([e,i]);},dataZoomId:r.id,dataZoomModel:r,getRange:i});},this);},this);},dispose:function dispose(){!function(t,i){var e=TC(t);E(e,function(t){t.controller.dispose();var e=t.dataZoomInfos;e[i]&&(delete e[i],t.count--);}),DC(e);}(this.api,this.dataZoomModel.id),kC.superApply(this,"dispose",arguments),this._range=null;}}),PC={zoom:function zoom(t,e,i,n){var a=this._range,o=a.slice(),r=t.axisModels[0];if(r){var s=EC[e](null,[n.originX,n.originY],r,i,t),l=(0<s.signal?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(o[1]-o[0])+o[0],u=Math.max(1/n.scale,0);o[0]=(o[0]-l)*u+l,o[1]=(o[1]-l)*u+l;var h=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return ww(0,o,[0,100],0,h.minSpan,h.maxSpan),this._range=o,a[0]!==o[0]||a[1]!==o[1]?o:void 0;}},pan:NC(function(t,e,i,n,a,o){var r=EC[n]([o.oldX,o.oldY],[o.newX,o.newY],e,a,i);return r.signal*(t[1]-t[0])*r.pixel/r.pixelLength;}),scrollMove:NC(function(t,e,i,n,a,o){return EC[n]([0,0],[o.scrollDelta,o.scrollDelta],e,a,i).signal*(t[1]-t[0])*o.scrollDelta;})};function NC(l){return function(t,e,i,n){var a=this._range,o=a.slice(),r=t.axisModels[0];if(r){var s=l(o,r,t,e,i,n);return ww(s,o,[0,100],"all"),this._range=o,a[0]!==o[0]||a[1]!==o[1]?o:void 0;}};}function OC(t){var e=t&&t.visualMap;k(e)||(e=e?[e]:[]),RC(e,function(t){if(t){zC(t,"splitList")&&!zC(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var e=t.pieces;e&&k(e)&&RC(e,function(t){z(t)&&(zC(t,"start")&&!zC(t,"min")&&(t.min=t.start),zC(t,"end")&&!zC(t,"max")&&(t.max=t.end));});}});}var EC={grid:function grid(t,e,i,n,a){var o=i.axis,r={},s=a.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(r.pixel=e[0]-t[0],r.pixelLength=s.width,r.pixelStart=s.x,r.signal=o.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=s.height,r.pixelStart=s.y,r.signal=o.inverse?-1:1),r;},polar:function polar(t,e,i,n,a){var o=i.axis,r={},s=a.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===i.mainType?(r.pixel=e[0]-t[0],r.pixelLength=l[1]-l[0],r.pixelStart=l[0],r.signal=o.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=u[1]-u[0],r.pixelStart=u[0],r.signal=o.inverse?-1:1),r;},singleAxis:function singleAxis(t,e,i,n,a){var o=i.axis,r=a.model.coordinateSystem.getRect(),s={};return t=t||[0,0],"horizontal"===o.orient?(s.pixel=e[0]-t[0],s.pixelLength=r.width,s.pixelStart=r.x,s.signal=o.inverse?1:-1):(s.pixel=e[1]-t[1],s.pixelLength=r.height,s.pixelStart=r.y,s.signal=o.inverse?-1:1),s;}},RC=E;function zC(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e);}fu.registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?0<t.pieces.length:0<t.splitNumber)&&!t.calculable?"piecewise":"continuous";});var BC=cd.VISUAL.COMPONENT;function VC(t,e,i,n){for(var a=e.targetVisuals[n],o=Bx.prepareVisualTypes(a),r={color:t.getData().getVisual("color")},s=0,l=o.length;s<l;s++){var u=o[s],h=a["opacity"===u?"__alphaForOpacity":u];h&&h.applyVisual(i,c,d);}return r.color;function c(t){return r[t];}function d(t,e){r[t]=e;}}af(BC,{createOnAllSeries:!0,reset:function reset(i,t){var n=[];return t.eachComponent("visualMap",function(t){var e=i.pipelineContext;!t.isTargetSeries(i)||e&&e.large||n.push(function(t,f,p,g){var m={};return E(t,function(t){var e=Bx.prepareVisualTypes(f[t]);m[t]=e;}),{progress:function progress(t,i){function e(t){return i.getItemVisual(a,t);}function n(t,e){i.setItemVisual(a,t,e);}var a;for(null!=g&&(g=i.getDimension(g));null!=(a=t.next());){var o=i.getRawDataItem(a);if(!o||!1!==o.visualMap)for(var r=null!=g?i.get(g,a,!0):a,s=p(r),l=f[s],u=m[s],h=0,c=u.length;h<c;h++){var d=u[h];l[d]&&l[d].applyVisual(r,e,n);}}}};}(t.stateList,t.targetVisuals,T(t.getValueState,t),t.getDataDimension(i.getData())));}),n;}}),af(BC,{createOnAllSeries:!0,reset:function reset(a,t){var o=a.getData(),r=[];t.eachComponent("visualMap",function(t){if(t.isTargetSeries(a)){var e=t.getVisualMeta(T(VC,null,a,t))||{stops:[],outerColors:[]},i=t.getDataDimension(o),n=o.getDimensionInfo(i);null!=n&&(e.dimension=n.index,r.push(e));}}),a.getData().setVisual("visualMeta",r);}});var GC=function GC(t,e,i){var n=D((FC[t]||{})[e]);return i&&k(n)?n[n.length-1]:n;},FC={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},WC=Bx.mapVisual,HC=Bx.eachVisual,ZC=k,UC=E,XC=wl,YC=yl,jC=sf({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-1/0,1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function init(t,e,i){this._dataExtent,this.targetVisuals={},this.controllerVisuals={},this.textStyleModel,this.itemSize,this.mergeDefaultAndTheme(t,i);},optionUpdated:function optionUpdated(t,e){var i=this.option;v.canvasSupported||(i.realtime=!1),e||qT(i,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption();},resetVisual:function resetVisual(t){var e=this.stateList;t=T(t,this),this.controllerVisuals=jT(this.option.controller,e,t),this.targetVisuals=jT(this.option.target,e,t);},getTargetSeriesIndices:function getTargetSeriesIndices(){var t=this.option.seriesIndex,i=[];return null==t||"all"===t?this.ecModel.eachSeries(function(t,e){i.push(e);}):i=wa(t),i;},eachTargetSeries:function eachTargetSeries(e,i){E(this.getTargetSeriesIndices(),function(t){e.call(i,this.ecModel.getSeriesByIndex(t));},this);},isTargetSeries:function isTargetSeries(e){var i=!1;return this.eachTargetSeries(function(t){t===e&&(i=!0);}),i;},formatValueText:function formatValueText(t,e,i){var n,a,o=this.option,r=o.precision,s=this.dataBound,l=o.formatter;return i=i||["<",">"],k(t)&&(t=t.slice(),n=!0),a=e?t:n?[u(t[0]),u(t[1])]:u(t),R(l)?l.replace("{value}",n?a[0]:a).replace("{value2}",n?a[1]:a):O(l)?n?l(t[0],t[1]):l(t):n?t[0]===s[0]?i[0]+" "+a[1]:t[1]===s[1]?i[1]+" "+a[0]:a[0]+" - "+a[1]:a;function u(t){return t===s[0]?"min":t===s[1]?"max":(+t).toFixed(Math.min(r,20));}},resetExtent:function resetExtent(){var t=this.option,e=XC([t.min,t.max]);this._dataExtent=e;},getDataDimension:function getDataDimension(t){var e=this.option.dimension,i=t.dimensions;if(null!=e||i.length){if(null!=e)return t.getDimension(e);for(var n=t.dimensions,a=n.length-1;0<=a;a--){var o=n[a];if(!t.getDimensionInfo(o).isCalculationCoord)return o;}}},getExtent:function getExtent(){return this._dataExtent.slice();},completeVisualOption:function completeVisualOption(){var t=this.ecModel,e=this.option,i={inRange:e.inRange,outOfRange:e.outOfRange},n=e.target||(e.target={}),a=e.controller||(e.controller={});m(n,i),m(a,i);var u=this.isCategory();function o(n){ZC(e.color)&&!n.inRange&&(n.inRange={color:e.color.slice().reverse()}),n.inRange=n.inRange||{color:t.get("gradientColor")},UC(this.stateList,function(t){var e=n[t];if(R(e)){var i=GC(e,"active",u);i?(n[t]={},n[t][e]=i):delete n[t];}},this);}o.call(this,n),o.call(this,a),function(t,e,i){var n=t[e],a=t[i];n&&!a&&(a=t[i]={},UC(n,function(t,e){if(Bx.isValidType(e)){var i=GC(e,"inactive",u);null!=i&&(a[e]=i,"color"!==e||a.hasOwnProperty("opacity")||a.hasOwnProperty("colorAlpha")||(a.opacity=[0,0]));}}));}.call(this,n,"inRange","outOfRange"),function(o){var r=(o.inRange||{}).symbol||(o.outOfRange||{}).symbol,s=(o.inRange||{}).symbolSize||(o.outOfRange||{}).symbolSize,l=this.get("inactiveColor");UC(this.stateList,function(t){var e=this.itemSize,i=o[t];null==(i=i||(o[t]={color:u?l:[l]})).symbol&&(i.symbol=r&&D(r)||(u?"roundRect":["roundRect"])),null==i.symbolSize&&(i.symbolSize=s&&D(s)||(u?e[0]:[e[0],e[0]])),i.symbol=WC(i.symbol,function(t){return"none"===t||"square"===t?"roundRect":t;});var n=i.symbolSize;if(null!=n){var a=-1/0;HC(n,function(t){a<t&&(a=t);}),i.symbolSize=WC(n,function(t){return YC(t,[0,a],[0,e[0]],!0);});}},this);}.call(this,a);},resetItemSize:function resetItemSize(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))];},isCategory:function isCategory(){return!!this.option.categories;},setSelected:et,getValueState:et,getVisualMeta:et}),qC=[20,140],KC=jC.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:null},optionUpdated:function optionUpdated(t,e){KC.superApply(this,"optionUpdated",arguments),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent();}),this._resetRange();},resetItemSize:function resetItemSize(){KC.superApply(this,"resetItemSize",arguments);var t=this.itemSize;"horizontal"===this._orient&&t.reverse(),null!=t[0]&&!isNaN(t[0])||(t[0]=qC[0]),null!=t[1]&&!isNaN(t[1])||(t[1]=qC[1]);},_resetRange:function _resetRange(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):k(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]));},completeVisualOption:function completeVisualOption(){jC.prototype.completeVisualOption.apply(this,arguments),E(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=0);},this);},setSelected:function setSelected(t){this.option.range=t.slice(),this._resetRange();},getSelected:function getSelected(){var t=this.getExtent(),e=wl((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e;},getValueState:function getValueState(t){var e=this.option.range,i=this.getExtent();return(e[0]<=i[0]||e[0]<=t)&&(e[1]>=i[1]||t<=e[1])?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(n){var a=[];return this.eachTargetSeries(function(t){var i=[],e=t.getData();e.each(this.getDataDimension(e),function(t,e){n[0]<=t&&t<=n[1]&&i.push(e);},this),a.push({seriesId:t.id,dataIndex:i});},this),a;},getVisualMeta:function getVisualMeta(i){var t=$C(this,"outOfRange",this.getExtent()),e=$C(this,"inRange",this.option.range.slice()),n=[];function a(t,e){n.push({value:t,color:i(t,e)});}for(var o=0,r=0,s=e.length,l=t.length;r<l&&(!e.length||t[r]<=e[0]);r++){t[r]<e[o]&&a(t[r],"outOfRange");}for(var u=1;o<s;o++,u=0){u&&n.length&&a(e[o],"outOfRange"),a(e[o],"inRange");}for(u=1;r<l;r++){(!e.length||e[e.length-1]<t[r])&&(u&&(n.length&&a(n[n.length-1].value,"outOfRange"),u=0),a(t[r],"outOfRange"));}var h=n.length;return{stops:n,outerColors:[h?n[0].color:"transparent",h?n[h-1].color:"transparent"]};}});function $C(t,e,i){if(i[0]===i[1])return i.slice();for(var n=(i[1]-i[0])/200,a=i[0],o=[],r=0;r<=200&&a<i[1];r++){o.push(a),a+=n;}return o.push(i[1]),o;}var JC=lf({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function init(t,e){this.ecModel=t,this.api=e,this.visualMapModel;},render:function render(t,e,i,n){!1!==(this.visualMapModel=t).get("show")?this.doRender.apply(this,arguments):this.group.removeAll();},renderBackground:function renderBackground(t){var e=this.visualMapModel,i=Vl(e.get("padding")||0),n=t.getBoundingRect();t.add(new Hr({z2:-1,silent:!0,shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[3]+i[1],height:n.height+i[0]+i[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}));},getControllerVisual:function getControllerVisual(i,n,a){var t=(a=a||{}).forceState,e=this.visualMapModel,o={};if("symbol"===n&&(o.symbol=e.get("itemSymbol")),"color"===n){var r=e.get("contentColor");o.color=r;}function s(t){return o[t];}function l(t,e){o[t]=e;}var u=e.controllerVisuals[t||e.getValueState(i)];return E(Bx.prepareVisualTypes(u),function(t){var e=u[t];a.convertOpacityToAlpha&&"opacity"===t&&(t="colorAlpha",e=u.__alphaForOpacity),Bx.dependsOn(t,n)&&e&&e.applyVisual(i,s,l);}),o[n];},positionGroup:function positionGroup(t){var e=this.visualMapModel,i=this.api;ou(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()});},doRender:et});function QC(t,e,i){var n=t.option,a=n.align;if(null!=a&&"auto"!==a)return a;for(var o={width:e.getWidth(),height:e.getHeight()},r="horizontal"===n.orient?1:0,s=[["left","right","width"],["top","bottom","height"]],l=s[r],u=[0,null,10],h={},c=0;c<3;c++){h[s[1-r][c]]=u[c],h[l[c]]=2===c?i[0]:n[l[c]];}var d=[["x","width",3],["y","height",0]][r],f=au(h,o,n.padding);return l[(f.margin[d[2]]||0)+f[d[0]]+.5*f[d[1]]<.5*o[d[1]]?0:1];}function tL(t,e){return E(t||[],function(t){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null),t.highlightKey="visualMap"+(e?e.componentIndex:"");}),t;}var eL=yl,iL=E,nL=Math.min,aL=Math.max,oL=JC.extend({type:"visualMap.continuous",init:function init(){oL.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._orient,this._useHandle,this._hoverLinkDataIndices=[],this._dragging,this._hovering;},doRender:function doRender(t,e,i,n){n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView();},_buildView:function _buildView(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var i=t.get("text");this._renderEndsText(e,i,0),this._renderEndsText(e,i,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e);},_renderEndsText:function _renderEndsText(t,e,i){if(e){var n=e[1-i];n=null!=n?n+"":"";var a=this.visualMapModel,o=a.get("textGap"),r=a.itemSize,s=this._shapes.barGroup,l=this._applyTransform([r[0]/2,0===i?-o:r[1]+o],s),u=this._applyTransform(0===i?"bottom":"top",s),h=this._orient,c=this.visualMapModel.textStyleModel;this.group.add(new Dr({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===h?"middle":u,textAlign:"horizontal"===h?u:"center",text:n,textFont:c.getFont(),textFill:c.getTextColor()}}));}},_renderBar:function _renderBar(t){var e=this.visualMapModel,i=this._shapes,n=e.itemSize,a=this._orient,o=this._useHandle,r=QC(e,this.api,n),s=i.barGroup=this._createBarGroup(r);s.add(i.outOfRange=rL()),s.add(i.inRange=rL(null,o?lL(this._orient):null,T(this._dragHandle,this,"all",!1),T(this._dragHandle,this,"all",!0)));var l=e.textStyleModel.getTextRect("国"),u=aL(l.width,l.height);o&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(s,0,n,u,a,r),this._createHandle(s,1,n,u,a,r)),this._createIndicator(s,n,u,a),t.add(s);},_createHandle:function _createHandle(t,e,i,n,a){var o=T(this._dragHandle,this,e,!1),r=T(this._dragHandle,this,e,!0),s=rL(function(t,e){return 0===t?[[0,0],[e,0],[e,-e]]:[[0,0],[e,0],[e,e]];}(e,n),lL(this._orient),o,r);s.position[0]=i[0],t.add(s);var l=this.visualMapModel.textStyleModel,u=new Dr({draggable:!0,drift:o,onmousemove:function onmousemove(t){Ft(t.event);},ondragend:r,style:{x:0,y:0,text:"",textFont:l.getFont(),textFill:l.getTextColor()}});this.group.add(u);var h=["horizontal"===a?n/2:1.5*n,"horizontal"===a?0===e?-1.5*n:1.5*n:0===e?-n/2:n/2],c=this._shapes;c.handleThumbs[e]=s,c.handleLabelPoints[e]=h,c.handleLabels[e]=u;},_createIndicator:function _createIndicator(t,e,i,n){var a=rL([[0,0]],"move");a.position[0]=e[0],a.attr({invisible:!0,silent:!0}),t.add(a);var o=this.visualMapModel.textStyleModel,r=new Dr({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:o.getFont(),textFill:o.getTextColor()}});this.group.add(r);var s=["horizontal"===n?i/2:9,0],l=this._shapes;l.indicator=a,l.indicatorLabel=r,l.indicatorLabelPoint=s;},_dragHandle:function _dragHandle(t,e,i,n){if(this._useHandle){if(this._dragging=!e,!e){var a=this._applyTransform([i,n],this._shapes.barGroup,!0);this._updateInterval(t,a[1]),this._updateView();}e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?this._hovering||this._clearHoverLinkToSeries():sL(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1);}},_resetInterval:function _resetInterval(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),i=t.getExtent(),n=[0,t.itemSize[1]];this._handleEnds=[eL(e[0],i,n,!0),eL(e[1],i,n,!0)];},_updateInterval:function _updateInterval(t,e){e=e||0;var i=this.visualMapModel,n=this._handleEnds,a=[0,i.itemSize[1]];ww(e,n,a,t,0);var o=i.getExtent();this._dataInterval=[eL(n[0],a,o,!0),eL(n[1],a,o,!0)];},_updateView:function _updateView(t){var e=this.visualMapModel,i=e.getExtent(),n=this._shapes,a=[0,e.itemSize[1]],o=t?a:this._handleEnds,r=this._createBarVisual(this._dataInterval,i,o,"inRange"),s=this._createBarVisual(i,i,a,"outOfRange");n.inRange.setStyle({fill:r.barColor,opacity:r.opacity}).setShape("points",r.barPoints),n.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(o,r);},_createBarVisual:function _createBarVisual(t,e,i,n){var a={forceState:n,convertOpacityToAlpha:!0},o=this._makeColorGradient(t,a),r=[this.getControllerVisual(t[0],"symbolSize",a),this.getControllerVisual(t[1],"symbolSize",a)],s=this._createBarPoints(i,r);return{barColor:new Jr(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]};},_makeColorGradient:function _makeColorGradient(t,e){var i=[],n=(t[1]-t[0])/100;i.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var a=1;a<100;a++){var o=t[0]+n*a;if(o>t[1])break;i.push({color:this.getControllerVisual(o,"color",e),offset:a/100});}return i.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),i;},_createBarPoints:function _createBarPoints(t,e){var i=this.visualMapModel.itemSize;return[[i[0]-e[0],t[0]],[i[0],t[0]],[i[0],t[1]],[i[0]-e[1],t[1]]];},_createBarGroup:function _createBarGroup(t){var e=this._orient,i=this.visualMapModel.get("inverse");return new Si("horizontal"!==e||i?"horizontal"===e&&i?{scale:"bottom"===t?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==e||i?{scale:"left"===t?[1,1]:[-1,1]}:{scale:"left"===t?[1,-1]:[-1,-1]}:{scale:"bottom"===t?[1,1]:[-1,1],rotation:Math.PI/2});},_updateHandle:function _updateHandle(n,a){if(this._useHandle){var o=this._shapes,r=this.visualMapModel,s=o.handleThumbs,l=o.handleLabels;iL([0,1],function(t){var e=s[t];e.setStyle("fill",a.handlesColor[t]),e.position[1]=n[t];var i=$s(o.handleLabelPoints[t],Ks(e,this.group));l[t].setStyle({x:i[0],y:i[1],text:r.formatValueText(this._dataInterval[t]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===t?"bottom":"top":"left",o.barGroup)});},this);}},_showIndicator:function _showIndicator(t,e,i,n){var a=this.visualMapModel,o=a.getExtent(),r=a.itemSize,s=[0,r[1]],l=eL(t,o,s,!0),u=this._shapes,h=u.indicator;if(h){h.position[1]=l,h.attr("invisible",!1),h.setShape("points",function(t,e,i,n){return t?[[0,-nL(e,aL(i,0))],[6,0],[0,nL(e,aL(n-i,0))]]:[[0,0],[5,-5],[5,5]];}(!!i,n,l,r[1]));var c=this.getControllerVisual(t,"color",{convertOpacityToAlpha:!0});h.setStyle("fill",c);var d=$s(u.indicatorLabelPoint,Ks(h,this.group)),f=u.indicatorLabel;f.attr("invisible",!1);var p=this._applyTransform("left",u.barGroup),g=this._orient;f.setStyle({text:(i||"")+a.formatValueText(e),textVerticalAlign:"horizontal"===g?p:"middle",textAlign:"horizontal"===g?"center":p,x:d[0],y:d[1]});}},_enableHoverLinkToSeries:function _enableHoverLinkToSeries(){var n=this;this._shapes.barGroup.on("mousemove",function(t){if(n._hovering=!0,!n._dragging){var e=n.visualMapModel.itemSize,i=n._applyTransform([t.offsetX,t.offsetY],n._shapes.barGroup,!0,!0);i[1]=nL(aL(0,i[1]),e[1]),n._doHoverLinkToSeries(i[1],0<=i[0]&&i[0]<=e[0]);}}).on("mouseout",function(){n._hovering=!1,n._dragging||n._clearHoverLinkToSeries();});},_enableHoverLinkFromSeries:function _enableHoverLinkFromSeries(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries();},_doHoverLinkToSeries:function _doHoverLinkToSeries(t,e){var i=this.visualMapModel,n=i.itemSize;if(i.option.hoverLink){var a=[0,n[1]],o=i.getExtent();t=nL(aL(a[0],t),a[1]);var r=function(t,e,i){var n=6,a=t.get("hoverLinkDataSize");a&&(n=eL(a,e,i,!0)/2);return n;}(i,o,a),s=[t-r,t+r],l=eL(t,a,o,!0),u=[eL(s[0],a,o,!0),eL(s[1],a,o,!0)];s[0]<a[0]&&(u[0]=-1/0),a[1]<s[1]&&(u[1]=1/0),e&&(u[0]===-1/0?this._showIndicator(l,u[1],"< ",r):u[1]===1/0?this._showIndicator(l,u[0],"> ",r):this._showIndicator(l,l,"≈ ",r));var h=this._hoverLinkDataIndices,c=[];(e||sL(i))&&(c=this._hoverLinkDataIndices=i.findTargetDataIndices(u));var d=function(t,e){var i={},n={};return a(t||[],i),a(e||[],n,i),[o(i),o(n)];function a(t,e,i){for(var n=0,a=t.length;n<a;n++){for(var o=t[n].seriesId,r=wa(t[n].dataIndex),s=i&&i[o],l=0,u=r.length;l<u;l++){var h=r[l];s&&s[h]?s[h]=null:(e[o]||(e[o]={}))[h]=1;}}}function o(t,e){var i=[];for(var n in t){if(t.hasOwnProperty(n)&&null!=t[n])if(e)i.push(+n);else{var a=o(t[n],!0);a.length&&i.push({seriesId:n,dataIndex:a});}}return i;}}(h,c);this._dispatchHighDown("downplay",tL(d[0],i)),this._dispatchHighDown("highlight",tL(d[1],i));}},_hoverLinkFromSeriesMouseOver:function _hoverLinkFromSeriesMouseOver(t){var e=t.target,i=this.visualMapModel;if(e&&null!=e.dataIndex){var n=this.ecModel.getSeriesByIndex(e.seriesIndex);if(i.isTargetSeries(n)){var a=n.getData(e.dataType),o=a.get(i.getDataDimension(a),e.dataIndex,!0);isNaN(o)||this._showIndicator(o,o);}}},_hideIndicator:function _hideIndicator(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0);},_clearHoverLinkToSeries:function _clearHoverLinkToSeries(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",tL(t,this.visualMapModel)),t.length=0;},_clearHoverLinkFromSeries:function _clearHoverLinkFromSeries(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator);},_applyTransform:function _applyTransform(t,e,i,n){var a=Ks(e,n?null:this.group);return ol[k(t)?"applyTransform":"transformDirection"](t,a,i);},_dispatchHighDown:function _dispatchHighDown(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e});},dispose:function dispose(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();},remove:function remove(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();}});function rL(t,e,i,n){return new Rr({shape:{points:t},draggable:!!i,cursor:e,drift:i,onmousemove:function onmousemove(t){Ft(t.event);},ondragend:n});}function sL(t){var e=t.get("hoverLinkOnHandle");return!!(null==e?t.get("realtime"):e);}function lL(t){return"vertical"===t?"ns-resize":"ew-resize";}tf({type:"selectDataRange",event:"dataRangeSelected",update:"update"},function(e,t){t.eachComponent({mainType:"visualMap",query:e},function(t){t.setSelected(e.selected);});}),Jd(OC);var uL=jC.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function optionUpdated(t,e){uL.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var i=this._mode=this._determineMode();hL[this._mode].call(this),this._resetSelected(t,e);var n=this.option.categories;this.resetVisual(function(t,e){"categories"===i?(t.mappingMethod="category",t.categories=D(n)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=N(this._pieceList,function(t){t=D(t);return"inRange"!==e&&(t.visual=null),t;}));});},completeVisualOption:function completeVisualOption(){var n=this.option,i={},t=Bx.listVisualTypes(),a=this.isCategory();function o(t,e,i){return t&&t[e]&&(z(t[e])?t[e].hasOwnProperty(i):t[e]===i);}E(n.pieces,function(e){E(t,function(t){e.hasOwnProperty(t)&&(i[t]=1);});}),E(i,function(t,e){var i=0;E(this.stateList,function(t){i|=o(n,t,e)||o(n.target,t,e);},this),i||E(this.stateList,function(t){(n[t]||(n[t]={}))[e]=GC(e,"inRange"===t?"active":"inactive",a);});},this),jC.prototype.completeVisualOption.apply(this,arguments);},_resetSelected:function _resetSelected(t,e){var i=this.option,n=this._pieceList,a=(e?i:t).selected||{};if(i.selected=a,E(n,function(t,e){var i=this.getSelectedMapKey(t);a.hasOwnProperty(i)||(a[i]=!0);},this),"single"===i.selectedMode){var o=!1;E(n,function(t,e){var i=this.getSelectedMapKey(t);a[i]&&(o?a[i]=!1:o=!0);},this);}},getSelectedMapKey:function getSelectedMapKey(t){return"categories"===this._mode?t.value+"":t.index+"";},getPieceList:function getPieceList(){return this._pieceList;},_determineMode:function _determineMode(){var t=this.option;return t.pieces&&0<t.pieces.length?"pieces":this.option.categories?"categories":"splitNumber";},setSelected:function setSelected(t){this.option.selected=D(t);},getValueState:function getValueState(t){var e=Bx.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(n){var a=[];return this.eachTargetSeries(function(t){var i=[],e=t.getData();e.each(this.getDataDimension(e),function(t,e){Bx.findPieceIndex(t,this._pieceList)===n&&i.push(e);},this),a.push({seriesId:t.id,dataIndex:i});},this),a;},getRepresentValue:function getRepresentValue(t){var e;if(this.isCategory())e=t.value;else if(null!=t.value)e=t.value;else{var i=t.interval||[];e=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2;}return e;},getVisualMeta:function getVisualMeta(a){if(!this.isCategory()){var o=[],r=[],s=this,t=this._pieceList.slice();if(t.length){var e=t[0].interval[0];e!==-1/0&&t.unshift({interval:[-1/0,e]}),(e=t[t.length-1].interval[1])!==1/0&&t.push({interval:[e,1/0]});}else t.push({interval:[-1/0,1/0]});var i=-1/0;return E(t,function(t){var e=t.interval;e&&(e[0]>i&&n([i,e[0]],"outOfRange"),n(e.slice()),i=e[1]);},this),{stops:o,outerColors:r};}function n(t,e){var i=s.getRepresentValue({interval:t});e=e||s.getValueState(i);var n=a(i,e);t[0]===-1/0?r[0]=n:t[1]===1/0?r[1]=n:o.push({value:t[0],color:n},{value:t[1],color:n});}}}),hL={splitNumber:function splitNumber(){var t=this.option,e=this._pieceList,i=Math.min(t.precision,20),n=this.getExtent(),a=t.splitNumber;a=Math.max(parseInt(a,10),1),t.splitNumber=a;for(var o=(n[1]-n[0])/a;+o.toFixed(i)!==o&&i<5;){i++;}t.precision=i,o=+o.toFixed(i);var r=0;t.minOpen&&e.push({index:r++,interval:[-1/0,n[0]],close:[0,0]});for(var s=n[0],l=r+a;r<l;s+=o){var u=r===a-1?n[1]:s+o;e.push({index:r++,interval:[s,u],close:[1,1]});}t.maxOpen&&e.push({index:r++,interval:[n[1],1/0],close:[0,0]}),Ol(e),E(e,function(t){t.text=this.formatValueText(t.interval);},this);},categories:function categories(){var t=this.option;E(t.categories,function(t){this._pieceList.push({text:this.formatValueText(t,!0),value:t});},this),cL(t,this._pieceList);},pieces:function pieces(){var t=this.option,d=this._pieceList;E(t.pieces,function(t,e){z(t)||(t={value:t});var i={text:"",index:e};if(null!=t.label&&(i.text=t.label),t.hasOwnProperty("value")){var n=i.value=t.value;i.interval=[n,n],i.close=[1,1];}else{for(var a=i.interval=[],o=i.close=[0,0],r=[1,0,1],s=[-1/0,1/0],l=[],u=0;u<2;u++){for(var h=[["gte","gt","min"],["lte","lt","max"]][u],c=0;c<3&&null==a[u];c++){a[u]=t[h[c]],o[u]=r[c],l[u]=2===c;}null==a[u]&&(a[u]=s[u]);}l[0]&&a[1]===1/0&&(o[0]=0),l[1]&&a[0]===-1/0&&(o[1]=0),a[0]===a[1]&&o[0]&&o[1]&&(i.value=a[0]);}i.visual=Bx.retrieveVisuals(t),d.push(i);},this),cL(t,d),Ol(d),E(d,function(t){var e=t.close,i=[["<","≤"][e[1]],[">","≥"][e[0]]];t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,i);},this);}};function cL(t,e){var i=t.inverse;("vertical"===t.orient?!i:i)&&e.reverse();}JC.extend({type:"visualMap.piecewise",doRender:function doRender(){var o=this.group;o.removeAll();var r=this.visualMapModel,s=r.get("textGap"),t=r.textStyleModel,l=t.getFont(),u=t.getTextColor(),h=this._getItemAlign(),c=r.itemSize,e=this._getViewData(),i=e.endsText,d=W(r.get("showLabel",!0),!i);i&&this._renderEndsText(o,i[0],c,d,h),E(e.viewPieceList,function(t){var e=t.piece,i=new Si();i.onclick=T(this._onItemClick,this,e),this._enableHoverLink(i,t.indexInModelPieceList);var n=r.getRepresentValue(e);if(this._createItemSymbol(i,n,[0,0,c[0],c[1]]),d){var a=this.visualMapModel.getValueState(n);i.add(new Dr({style:{x:"right"===h?-s:c[0]+s,y:c[1]/2,text:e.text,textVerticalAlign:"middle",textAlign:h,textFont:l,textFill:u,opacity:"outOfRange"===a?.5:1}}));}o.add(i);},this),i&&this._renderEndsText(o,i[1],c,d,h),nu(r.get("orient"),o,r.get("itemGap")),this.renderBackground(o),this.positionGroup(o);},_enableHoverLink:function _enableHoverLink(t,i){function e(t){var e=this.visualMapModel;e.option.hoverLink&&this.api.dispatchAction({type:t,batch:tL(e.findTargetDataIndices(i),e)});}t.on("mouseover",T(e,this,"highlight")).on("mouseout",T(e,this,"downplay"));},_getItemAlign:function _getItemAlign(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return QC(t,this.api,t.itemSize);var i=e.align;return i&&"auto"!==i||(i="left"),i;},_renderEndsText:function _renderEndsText(t,e,i,n,a){if(e){var o=new Si(),r=this.visualMapModel.textStyleModel;o.add(new Dr({style:{x:n?"right"===a?i[0]:0:i[0]/2,y:i[1]/2,textVerticalAlign:"middle",textAlign:n?a:"center",text:e,textFont:r.getFont(),textFill:r.getTextColor()}})),t.add(o);}},_getViewData:function _getViewData(){var t=this.visualMapModel,e=N(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e};}),i=t.get("text"),n=t.get("orient"),a=t.get("inverse");return("horizontal"===n?a:!a)?e.reverse():i=i&&i.slice().reverse(),{viewPieceList:e,endsText:i};},_createItemSymbol:function _createItemSymbol(t,e,i){t.add(Jp(this.getControllerVisual(e,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(e,"color")));},_onItemClick:function _onItemClick(t){var e=this.visualMapModel,i=e.option,n=D(i.selected),a=e.getSelectedMapKey(t);"single"===i.selectedMode?(n[a]=!0,E(n,function(t,e){n[e]=e===a;})):n[a]=!n[a],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:n});}});Jd(OC);var dL,fL="urn:schemas-microsoft-com:vml",pL="undefined"==typeof window?null:window,gL=!1,mL=pL&&pL.document;function vL(t){return dL(t);}if(mL&&!v.canvasSupported)try{mL.namespaces.zrvml||mL.namespaces.add("zrvml",fL),dL=function dL(t){return mL.createElement("<zrvml:"+t+' class="zrvml">');};}catch(t){dL=function dL(t){return mL.createElement("<"+t+' xmlns="'+fL+'" class="zrvml">');};}var yL,xL=Ho.CMD,_L=Math.round,wL=Math.sqrt,bL=Math.abs,SL=Math.cos,ML=Math.sin,IL=Math.max;if(!v.canvasSupported){var AL=",",TL="progid:DXImageTransform.Microsoft",DL=21600,CL=DL/2,LL=function LL(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=DL+","+DL,t.coordorigin="0,0";},kL=function kL(t,e,i){return"rgb("+[t,e,i].join(",")+")";},PL=function PL(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e);},NL=function NL(t,e){e&&t&&e.parentNode===t&&t.removeChild(e);},OL=function OL(t,e,i){return 1e5*(parseFloat(t)||0)+1e3*(parseFloat(e)||0)+i;},EL=Fn,RL=function RL(t,e,i){var n=Ee(e);i=+i,isNaN(i)&&(i=1),n&&(t.color=kL(n[0],n[1],n[2]),t.opacity=i*n[3]);},zL=function zL(t,e,i,n){var a="fill"===e,o=t.getElementsByTagName(e)[0];null!=i[e]&&"none"!==i[e]&&(a||!a&&i.lineWidth)?(t[a?"filled":"stroked"]="true",i[e]instanceof jr&&NL(t,o),o=o||vL(e),a?function(t,e,i){var n,a,o=e.fill;if(null!=o)if(o instanceof jr){var r,s=0,l=[0,0],u=0,h=1,c=i.getBoundingRect(),d=c.width,f=c.height;if("linear"===o.type){r="gradient";var p=i.transform,g=[o.x*d,o.y*f],m=[o.x2*d,o.y2*f];p&&(bt(g,g,p),bt(m,m,p));var v=m[0]-g[0],y=m[1]-g[1];(s=180*Math.atan2(v,y)/Math.PI)<0&&(s+=360),s<1e-6&&(s=0);}else{r="gradientradial";g=[o.x*d,o.y*f],p=i.transform;var x=i.scale,_=d,w=f;l=[(g[0]-c.x)/_,(g[1]-c.y)/w],p&&bt(g,g,p),_/=x[0]*DL,w/=x[1]*DL;var b=IL(_,w);u=0/b,h=2*o.r/b-u;}var S=o.colorStops.slice();S.sort(function(t,e){return t.offset-e.offset;});for(var M=S.length,I=[],A=[],T=0;T<M;T++){var D=S[T],C=(n=D.color,void 0,a=Ee(n),[kL(a[0],a[1],a[2]),a[3]]);A.push(D.offset*h+u+" "+C[0]),0!==T&&T!==M-1||I.push(C);}if(2<=M){var L=I[0][0],k=I[1][0],P=I[0][1]*e.opacity,N=I[1][1]*e.opacity;t.type=r,t.method="none",t.focus="100%",t.angle=s,t.color=L,t.color2=k,t.colors=A.join(","),t.opacity=N,t.opacity2=P;}"radial"===r&&(t.focusposition=l.join(","));}else RL(t,o,e.opacity);}(o,i,n):function(t,e){e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof jr||RL(t,e.stroke,e.opacity);}(o,i),PL(t,o)):(t[a?"filled":"stroked"]="false",NL(t,o));},BL=[[],[],[]];hr.prototype.brushVML=function(t){var e=this.style,i=this._vmlEl;i||(i=vL("shape"),LL(i),this._vmlEl=i),zL(i,"fill",e,this),zL(i,"stroke",e,this);var n=this.transform,a=null!=n,o=i.getElementsByTagName("stroke")[0];if(o){var r=e.lineWidth;if(a&&!e.strokeNoScale){var s=n[0]*n[3]-n[1]*n[2];r*=wL(bL(s));}o.weight=r+"px";}var l=this.path||(this.path=new Ho());this.__dirtyPath&&(l.beginPath(),l.subPixelOptimize=!1,this.buildPath(l,this.shape),l.toStatic(),this.__dirtyPath=!1),i.path=function(t,e){var i,n,a,o,r,s,l=xL.M,u=xL.C,h=xL.L,c=xL.A,d=xL.Q,f=[],p=t.data,g=t.len();for(o=0;o<g;){switch(n="",i=0,a=p[o++]){case l:n=" m ",i=1,r=p[o++],s=p[o++],BL[0][0]=r,BL[0][1]=s;break;case h:n=" l ",i=1,r=p[o++],s=p[o++],BL[0][0]=r,BL[0][1]=s;break;case d:case u:n=" c ",i=3;var m,v,y=p[o++],x=p[o++],_=p[o++],w=p[o++];a===d?(_=((m=_)+2*y)/3,w=((v=w)+2*x)/3,y=(r+2*y)/3,x=(s+2*x)/3):(m=p[o++],v=p[o++]),BL[0][0]=y,BL[0][1]=x,BL[1][0]=_,BL[1][1]=w,r=BL[2][0]=m,s=BL[2][1]=v;break;case c:var b=0,S=0,M=1,I=1,A=0;e&&(b=e[4],S=e[5],M=wL(e[0]*e[0]+e[1]*e[1]),I=wL(e[2]*e[2]+e[3]*e[3]),A=Math.atan2(-e[1]/I,e[0]/M));var T=p[o++],D=p[o++],C=p[o++],L=p[o++],k=p[o++]+A,P=p[o++]+k+A;o++;var N=p[o++],O=T+SL(k)*C,E=D+ML(k)*L,R=(y=T+SL(P)*C,x=D+ML(P)*L,N?" wa ":" at ");Math.abs(O-y)<1e-4&&(.01<Math.abs(P-k)?N&&(O+=.0125):Math.abs(E-D)<1e-4?N&&O<T||!N&&T<O?x-=.0125:x+=.0125:N&&E<D||!N&&D<E?y+=.0125:y-=.0125),f.push(R,_L(((T-C)*M+b)*DL-CL),AL,_L(((D-L)*I+S)*DL-CL),AL,_L(((T+C)*M+b)*DL-CL),AL,_L(((D+L)*I+S)*DL-CL),AL,_L((O*M+b)*DL-CL),AL,_L((E*I+S)*DL-CL),AL,_L((y*M+b)*DL-CL),AL,_L((x*I+S)*DL-CL)),r=y,s=x;break;case xL.R:var z=BL[0],B=BL[1];z[0]=p[o++],z[1]=p[o++],B[0]=z[0]+p[o++],B[1]=z[1]+p[o++],e&&(bt(z,z,e),bt(B,B,e)),z[0]=_L(z[0]*DL-CL),B[0]=_L(B[0]*DL-CL),z[1]=_L(z[1]*DL-CL),B[1]=_L(B[1]*DL-CL),f.push(" m ",z[0],AL,z[1]," l ",B[0],AL,z[1]," l ",B[0],AL,B[1]," l ",z[0],AL,B[1]);break;case xL.Z:f.push(" x ");}if(0<i){f.push(n);for(var V=0;V<i;V++){var G=BL[V];e&&bt(G,G,e),f.push(_L(G[0]*DL-CL),AL,_L(G[1]*DL-CL),V<i-1?AL:"");}}}return f.join("");}(l,this.transform),i.style.zIndex=OL(this.zlevel,this.z,this.z2),PL(t,i),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t);},hr.prototype.onRemove=function(t){NL(t,this._vmlEl),this.removeRectText(t);},hr.prototype.onAdd=function(t){PL(t,this._vmlEl),this.appendRectText(t);};Yn.prototype.brushVML=function(t){var e,i,n=this.style,a=n.image;if(function(t){return"object"==_typeof(t)&&t.tagName&&"IMG"===t.tagName.toUpperCase();}(a)){var o=a.src;if(o===this._imageSrc)e=this._imageWidth,i=this._imageHeight;else{var r=a.runtimeStyle,s=r.width,l=r.height;r.width="auto",r.height="auto",e=a.width,i=a.height,r.width=s,r.height=l,this._imageSrc=o,this._imageWidth=e,this._imageHeight=i;}a=o;}else a===this._imageSrc&&(e=this._imageWidth,i=this._imageHeight);if(a){var u=n.x||0,h=n.y||0,c=n.width,d=n.height,f=n.sWidth,p=n.sHeight,g=n.sx||0,m=n.sy||0,v=f&&p,y=this._vmlEl;y||(y=mL.createElement("div"),LL(y),this._vmlEl=y);var x,_=y.style,w=!1,b=1,S=1;if(this.transform&&(x=this.transform,b=wL(x[0]*x[0]+x[1]*x[1]),S=wL(x[2]*x[2]+x[3]*x[3]),w=x[1]||x[2]),w){var M=[u,h],I=[u+c,h],A=[u,h+d],T=[u+c,h+d];bt(M,M,x),bt(I,I,x),bt(A,A,x),bt(T,T,x);var D=IL(M[0],I[0],A[0],T[0]),C=IL(M[1],I[1],A[1],T[1]),L=[];L.push("M11=",x[0]/b,AL,"M12=",x[2]/S,AL,"M21=",x[1]/b,AL,"M22=",x[3]/S,AL,"Dx=",_L(u*b+x[4]),AL,"Dy=",_L(h*S+x[5])),_.padding="0 "+_L(D)+"px "+_L(C)+"px 0",_.filter=TL+".Matrix("+L.join("")+", SizingMethod=clip)";}else x&&(u=u*b+x[4],h=h*S+x[5]),_.filter="",_.left=_L(u)+"px",_.top=_L(h)+"px";var k=this._imageEl,P=this._cropEl;k||(k=mL.createElement("div"),this._imageEl=k);var N=k.style;if(v){if(e&&i)N.width=_L(b*e*c/f)+"px",N.height=_L(S*i*d/p)+"px";else{var O=new Image(),E=this;O.onload=function(){O.onload=null,e=O.width,i=O.height,N.width=_L(b*e*c/f)+"px",N.height=_L(S*i*d/p)+"px",E._imageWidth=e,E._imageHeight=i,E._imageSrc=a;},O.src=a;}P||((P=mL.createElement("div")).style.overflow="hidden",this._cropEl=P);var R=P.style;R.width=_L((c+g*c/f)*b),R.height=_L((d+m*d/p)*S),R.filter=TL+".Matrix(Dx="+-g*c/f*b+",Dy="+-m*d/p*S+")",P.parentNode||y.appendChild(P),k.parentNode!==P&&P.appendChild(k);}else N.width=_L(b*c)+"px",N.height=_L(S*d)+"px",y.appendChild(k),P&&P.parentNode&&(y.removeChild(P),this._cropEl=null);var z="",B=n.opacity;B<1&&(z+=".Alpha(opacity="+_L(100*B)+") "),z+=TL+".AlphaImageLoader(src="+a+", SizingMethod=scale)",N.filter=z,y.style.zIndex=OL(this.zlevel,this.z,this.z2),PL(t,y),null!=n.text&&this.drawRectText(t,this.getBoundingRect());}},Yn.prototype.onRemove=function(t){NL(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t);},Yn.prototype.onAdd=function(t){PL(t,this._vmlEl),this.appendRectText(t);};var VL,GL="normal",FL={},WL=0,HL=document.createElement("div");yL=function yL(t,e){var i=mL;VL||((VL=i.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",mL.body.appendChild(VL));try{VL.style.font=e;}catch(t){}return VL.innerHTML="",VL.appendChild(i.createTextNode(t)),{width:VL.offsetWidth};},sn["measureText"]=yL;for(var ZL=new bi(),UL=function UL(t,e,i,n){var a=this.style;this.__dirty&&Cn(a);var o=a.text;if(null!=o&&(o+=""),o){if(a.rich){var r=xn(o,a);o=[];for(var s=0;s<r.lines.length;s++){for(var l=r.lines[s].tokens,u=[],h=0;h<l.length;h++){u.push(l[h].text);}o.push(u.join(""));}o=o.join("\n");}var c,d,f=a.textAlign,p=a.textVerticalAlign,g=function(t){var e=FL[t];if(!e){100<WL&&(WL=0,FL={});var i,n=HL.style;try{n.font=t,i=n.fontFamily.split(",")[0];}catch(t){}e={style:n.fontStyle||GL,variant:n.fontVariant||GL,weight:n.fontWeight||GL,size:0|parseFloat(n.fontSize||12),family:i||"Microsoft YaHei"},FL[t]=e,WL++;}return e;}(a.font),m=g.style+" "+g.variant+" "+g.weight+" "+g.size+'px "'+g.family+'"';i=i||un(o,m,f,p,a.textPadding,a.textLineHeight);var v=this.transform;if(v&&!n&&(ZL.copy(e),ZL.applyTransform(v),e=ZL),n)c=e.x,d=e.y;else{var y=a.textPosition;if(y instanceof Array)c=e.x+EL(y[0],e.width),d=e.y+EL(y[1],e.height),f=f||"left";else{var x=this.calculateTextPosition?this.calculateTextPosition({},a,e):dn({},a,e);c=x.x,d=x.y,f=f||x.textAlign,p=p||x.textVerticalAlign;}}c=hn(c,i.width,f),d=cn(d,i.height,p),d+=i.height/2;var _,w,b,S=vL,M=this._textVmlEl;M?w=(_=(b=M.firstChild).nextSibling).nextSibling:(M=S("line"),_=S("path"),w=S("textpath"),b=S("skew"),w.style["v-text-align"]="left",LL(M),_.textpathok=!0,w.on=!0,M.from="0 0",M.to="1000 0.05",PL(M,b),PL(M,_),PL(M,w),this._textVmlEl=M);var I=[c,d],A=M.style;v&&n?(bt(I,I,v),b.on=!0,b.matrix=v[0].toFixed(3)+AL+v[2].toFixed(3)+AL+v[1].toFixed(3)+AL+v[3].toFixed(3)+",0,0",b.offset=(_L(I[0])||0)+","+(_L(I[1])||0),b.origin="0 0",A.left="0px",A.top="0px"):(b.on=!1,A.left=_L(c)+"px",A.top=_L(d)+"px"),w.string=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;");}(o);try{w.style.font=m;}catch(t){}zL(M,"fill",{fill:a.textFill,opacity:a.opacity},this),zL(M,"stroke",{stroke:a.textStroke,opacity:a.opacity,lineDash:a.lineDash||null},this),M.style.zIndex=OL(this.zlevel,this.z,this.z2),PL(t,M);}},XL=function XL(t){NL(t,this._textVmlEl),this._textVmlEl=null;},YL=function YL(t){PL(t,this._textVmlEl);},jL=[Zn,Xn,Yn,hr,Dr],qL=0;qL<jL.length;qL++){var KL=jL[qL].prototype;KL.drawRectText=UL,KL.removeRectText=XL,KL.appendRectText=YL;}Dr.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t);},Dr.prototype.onRemove=function(t){this.removeRectText(t);},Dr.prototype.onAdd=function(t){this.appendRectText(t);};}function $L(t){return parseInt(t,10);}function JL(t,e){!function(){if(!gL&&mL){gL=!0;var t=mL.styleSheets;t.length<31?mL.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)");}}(),this.root=t,this.storage=e;var i=document.createElement("div"),n=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",n.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=n,this._vmlViewport=i,this.resize();var a=e.delFromStorage,o=e.addToStorage;e.delFromStorage=function(t){a.call(e,t),t&&t.onRemove&&t.onRemove(n);},e.addToStorage=function(t){t.onAdd&&t.onAdd(n),o.call(e,t);},this._firstPaint=!0;}JL.prototype={constructor:JL,getType:function getType(){return"vml";},getViewportRoot:function getViewportRoot(){return this._vmlViewport;},getViewportRootOffset:function getViewportRootOffset(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0};},refresh:function refresh(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t);},_paintList:function _paintList(t){for(var e=this._vmlRoot,i=0;i<t.length;i++){var n=t[i];n.invisible||n.ignore?(n.__alreadyNotVisible||n.onRemove(e),n.__alreadyNotVisible=!0):(n.__alreadyNotVisible&&n.onAdd(e),n.__alreadyNotVisible=!1,n.__dirty&&(n.beforeBrush&&n.beforeBrush(),(n.brushVML||n.brush).call(n,e),n.afterBrush&&n.afterBrush())),n.__dirty=!1;}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1);},resize:function resize(t,e){t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!==t||this._height!==e){this._width=t,this._height=e;var i=this._vmlViewport.style;i.width=t+"px",i.height=e+"px";}},dispose:function dispose(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},clear:function clear(){this._vmlViewport&&this.root.removeChild(this._vmlViewport);},_getWidth:function _getWidth(){var t=this.root,e=t.currentStyle;return(t.clientWidth||$L(e.width))-$L(e.paddingLeft)-$L(e.paddingRight)|0;},_getHeight:function _getHeight(){var t=this.root,e=t.currentStyle;return(t.clientHeight||$L(e.height))-$L(e.paddingTop)-$L(e.paddingBottom)|0;}},E(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){JL.prototype[t]=function(t){return function(){ci('In IE8.0 VML mode painter not support method "'+t+'"');};}(t);}),pa("vml",JL);function QL(t){return document.createElementNS("http://www.w3.org/2000/svg",t);}var tk=Ho.CMD,ek=Array.prototype.join,ik="none",nk=Math.round,ak=Math.sin,ok=Math.cos,rk=Math.PI,sk=2*Math.PI,lk=180/rk,uk=1e-4;function hk(t){return nk(1e4*t)/1e4;}function ck(t){return t<uk&&-uk<t;}function dk(t,e){e&&fk(t,"transform","matrix("+ek.call(e,",")+")");}function fk(t,e,i){i&&("linear"===i.type||"radial"===i.type)||t.setAttribute(e,i);}function pk(t,e,i,n){if(function(t,e){var i=e?t.textFill:t.fill;return null!=i&&i!==ik;}(e,i)){var a=i?e.textFill:e.fill;fk(t,"fill",a="transparent"===a?ik:a),fk(t,"fill-opacity",null!=e.fillOpacity?e.fillOpacity*e.opacity:e.opacity);}else fk(t,"fill",ik);if(function(t,e){var i=e?t.textStroke:t.stroke;return null!=i&&i!==ik;}(e,i)){var o=i?e.textStroke:e.stroke;fk(t,"stroke",o="transparent"===o?ik:o),fk(t,"stroke-width",(i?e.textStrokeWidth:e.lineWidth)/(!i&&e.strokeNoScale?n.getLineScale():1)),fk(t,"paint-order",i?"stroke":"fill"),fk(t,"stroke-opacity",null!=e.strokeOpacity?e.strokeOpacity:e.opacity),e.lineDash?(fk(t,"stroke-dasharray",e.lineDash.join(",")),fk(t,"stroke-dashoffset",nk(e.lineDashOffset||0))):fk(t,"stroke-dasharray",""),e.lineCap&&fk(t,"stroke-linecap",e.lineCap),e.lineJoin&&fk(t,"stroke-linejoin",e.lineJoin),e.miterLimit&&fk(t,"stroke-miterlimit",e.miterLimit);}else fk(t,"stroke",ik);}var gk={};gk.brush=function(t){var e=t.style,i=t.__svgEl;i||(i=QL("path"),t.__svgEl=i),t.path||t.createPathProxy();var n=t.path;if(t.__dirtyPath){n.beginPath(),n.subPixelOptimize=!1,t.buildPath(n,t.shape),t.__dirtyPath=!1;var a=function(t){for(var e=[],i=t.data,n=t.len(),a=0;a<n;){var o="",r=0;switch(i[a++]){case tk.M:o="M",r=2;break;case tk.L:o="L",r=2;break;case tk.Q:o="Q",r=4;break;case tk.C:o="C",r=6;break;case tk.A:var s=i[a++],l=i[a++],u=i[a++],h=i[a++],c=i[a++],d=i[a++],f=i[a++],p=i[a++],g=Math.abs(d),m=ck(g-sk)||(p?sk<=d:sk<=-d),v=0<d?d%sk:d%sk+sk,y=!1;y=!!m||!ck(g)&&rk<=v==!!p;var x=hk(s+u*ok(c)),_=hk(l+h*ak(c));m&&(d=p?sk-1e-4:1e-4-sk,y=!0,9===a&&e.push("M",x,_));var w=hk(s+u*ok(c+d)),b=hk(l+h*ak(c+d));e.push("A",hk(u),hk(h),nk(f*lk),+y,+p,w,b);break;case tk.Z:o="Z";break;case tk.R:w=hk(i[a++]),b=hk(i[a++]);var S=hk(i[a++]),M=hk(i[a++]);e.push("M",w,b,"L",w+S,b,"L",w+S,b+M,"L",w,b+M,"L",w,b);}o&&e.push(o);for(var I=0;I<r;I++){e.push(hk(i[a++]));}}return e.join(" ");}(n);a.indexOf("NaN")<0&&fk(i,"d",a);}pk(i,e,!1,t),dk(i,t.transform),null!=e.text&&bk(t,t.getBoundingRect());};var mk={brush:function brush(t){var e=t.style,i=e.image;i instanceof HTMLImageElement&&(i=i.src);if(i){var n=e.x||0,a=e.y||0,o=e.width,r=e.height,s=t.__svgEl;s||(s=QL("image"),t.__svgEl=s),i!==t.__imageSrc&&(function(t,e,i){t.setAttributeNS("http://www.w3.org/1999/xlink",e,i);}(s,"href",i),t.__imageSrc=i),fk(s,"width",o),fk(s,"height",r),fk(s,"x",n),fk(s,"y",a),dk(s,t.transform),null!=e.text&&bk(t,t.getBoundingRect());}}},vk={},yk=new bi(),xk={},_k=[],wk={left:"start",right:"end",center:"middle",middle:"middle"},bk=function bk(t,e){var i=t.style,n=t.transform,a=t instanceof Dr||i.transformText;t.__dirty&&Cn(i);var o=i.text;if(null!=o&&(o+=""),Hn(o,i)){null==o&&(o=""),!a&&n&&(yk.copy(e),yk.applyTransform(n),e=yk);var r=t.__textSvgEl;r||(r=QL("text"),t.__textSvgEl=r);var s=r.style,l=i.font||rn,u=r.__computedFont;l!==r.__styleFont&&(s.font=r.__styleFont=l,u=r.__computedFont=s.font);var h=i.textPadding,c=i.textLineHeight,d=t.__textCotentBlock;d&&!t.__dirtyText||(d=t.__textCotentBlock=yn(o,u,h,c,i.truncate));var f=d.outerHeight,p=d.lineHeight;zn(xk,t,i,e);var g=xk.baseX,m=xk.baseY,v=xk.textAlign||"left",y=xk.textVerticalAlign;!function(t,e,i,n,a,o,r){te(_k),e&&i&&ee(_k,i);var s=n.textRotation;if(a&&s){var l=n.textOrigin;"center"===l?(o=a.width/2+a.x,r=a.height/2+a.y):l&&(o=l[0]+a.x,r=l[1]+a.y),_k[4]-=o,_k[5]-=r,ae(_k,_k,s),_k[4]+=o,_k[5]+=r;}dk(t,_k);}(r,a,n,i,e,g,m);var x=g,_=cn(m,f,y);h&&(x=function(t,e,i){return"right"===e?t-i[1]:"center"===e?t+i[3]/2-i[1]/2:t+i[3];}(g,v,h),_+=h[0]),_+=p/2,pk(r,i,!0,t);var w=d.canCacheByTextString,b=t.__tspanList||(t.__tspanList=[]),S=b.length;if(w&&t.__canCacheByTextString&&t.__text===o){if(t.__dirtyText&&S)for(var M=0;M<S;++M){Sk(b[M],v,x,_+M*p);}}else{t.__text=o,t.__canCacheByTextString=w;var I=d.lines,A=I.length;for(M=0;M<A;M++){var T=b[M],D=I[M];T?T.__zrText!==D&&(T.innerHTML="",T.appendChild(document.createTextNode(D))):(T=b[M]=QL("tspan"),r.appendChild(T),T.appendChild(document.createTextNode(D))),Sk(T,v,x,_+M*p);}if(A<S){for(;M<S;M++){r.removeChild(b[M]);}b.length=A;}}}};function Sk(t,e,i,n){fk(t,"dominant-baseline","middle"),fk(t,"text-anchor",wk[e]),fk(t,"x",i),fk(t,"y",n);}function Mk(){}function Ik(t,e){for(var i=0,n=e.length,a=0,o=0;i<n;i++){var r=e[i];if(r.removed){for(s=[],l=o;l<o+r.count;l++){s.push(l);}r.indices=s,o+=r.count;}else{for(var s=[],l=a;l<a+r.count;l++){s.push(l);}r.indices=s,a+=r.count,r.added||(o+=r.count);}}return e;}vk.drawRectText=bk,vk.brush=function(t){null!=t.style.text&&bk(t,!1);},Mk.prototype={diff:function diff(l,u,t){t=t||function(t,e){return t===e;},this.equals=t;var h=this;l=l.slice();var c=(u=u.slice()).length,d=l.length,f=1,e=c+d,p=[{newPos:-1,components:[]}],i=this.extractCommon(p[0],u,l,0);if(p[0].newPos+1>=c&&d<=i+1){for(var n=[],a=0;a<u.length;a++){n.push(a);}return[{indices:n,count:u.length}];}function o(){for(var t=-1*f;t<=f;t+=2){var e,i=p[t-1],n=p[t+1],a=(n?n.newPos:0)-t;i&&(p[t-1]=void 0);var o=i&&i.newPos+1<c,r=n&&0<=a&&a<d;if(o||r){if(!o||r&&i.newPos<n.newPos?(e={newPos:(s=n).newPos,components:s.components.slice(0)},h.pushComponent(e.components,void 0,!0)):((e=i).newPos++,h.pushComponent(e.components,!0,void 0)),a=h.extractCommon(e,u,l,t),e.newPos+1>=c&&d<=a+1)return Ik(h,e.components,u,l);p[t]=e;}else p[t]=void 0;}var s;f++;}for(;f<=e;){var r=o();if(r)return r;}},pushComponent:function pushComponent(t,e,i){var n=t[t.length-1];n&&n.added===e&&n.removed===i?t[t.length-1]={count:n.count+1,added:e,removed:i}:t.push({count:1,added:e,removed:i});},extractCommon:function extractCommon(t,e,i,n){for(var a=e.length,o=i.length,r=t.newPos,s=r-n,l=0;r+1<a&&s+1<o&&this.equals(e[r+1],i[s+1]);){r++,s++,l++;}return l&&t.components.push({count:l}),t.newPos=r,s;},tokenize:function tokenize(t){return t.slice();},join:function join(t){return t.slice();}};var Ak=new Mk();function Tk(t,e,i,n,a){this._zrId=t,this._svgRoot=e,this._tagNames="string"==typeof i?[i]:i,this._markLabel=n,this._domName=a||"_dom",this.nextId=0;}function Dk(t,e){Tk.call(this,t,e,["linearGradient","radialGradient"],"__gradient_in_use__");}function Ck(t,e){Tk.call(this,t,e,"clipPath","__clippath_in_use__");}function Lk(t,e){Tk.call(this,t,e,["filter"],"__filter_in_use__","_shadowDom");}function kk(t){return t&&(t.shadowBlur||t.shadowOffsetX||t.shadowOffsetY||t.textShadowBlur||t.textShadowOffsetX||t.textShadowOffsetY);}function Pk(t){return parseInt(t,10);}function Nk(t,e){return e&&t&&e.parentNode!==t;}function Ok(t,e,i){if(Nk(t,e)&&i){var n=i.nextSibling;n?t.insertBefore(e,n):t.appendChild(e);}}function Ek(t,e){if(Nk(t,e)){var i=t.firstChild;i?t.insertBefore(e,i):t.appendChild(e);}}function Rk(t,e){e&&t&&e.parentNode===t&&t.removeChild(e);}function zk(t){return t.__textSvgEl;}function Bk(t){return t.__svgEl;}Tk.prototype.createElement=QL,Tk.prototype.getDefs=function(t){var e=this._svgRoot,n=this._svgRoot.getElementsByTagName("defs");return 0===n.length?t?((n=e.insertBefore(this.createElement("defs"),e.firstChild)).contains||(n.contains=function(t){var e=n.children;if(!e)return!1;for(var i=e.length-1;0<=i;--i){if(e[i]===t)return!0;}return!1;}),n):null:n[0];},Tk.prototype.update=function(t,e){if(t){var i=this.getDefs(!1);if(t[this._domName]&&i.contains(t[this._domName]))"function"==typeof e&&e(t);else{var n=this.add(t);n&&(t[this._domName]=n);}}},Tk.prototype.addDom=function(t){this.getDefs(!0).appendChild(t);},Tk.prototype.removeDom=function(t){var e=this.getDefs(!1);e&&t[this._domName]&&(e.removeChild(t[this._domName]),t[this._domName]=null);},Tk.prototype.getDoms=function(){var i=this.getDefs(!1);if(!i)return[];var n=[];return E(this._tagNames,function(t){var e=i.getElementsByTagName(t);n=n.concat([].slice.call(e));}),n;},Tk.prototype.markAllUnused=function(){var t=this.getDoms(),e=this;E(t,function(t){t[e._markLabel]="0";});},Tk.prototype.markUsed=function(t){t&&(t[this._markLabel]="1");},Tk.prototype.removeUnused=function(){var e=this.getDefs(!1);if(e){var t=this.getDoms(),i=this;E(t,function(t){"1"!==t[i._markLabel]&&e.removeChild(t);});}},Tk.prototype.getSvgProxy=function(t){return t instanceof hr?gk:t instanceof Yn?mk:t instanceof Dr?vk:gk;},Tk.prototype.getTextSvgElement=function(t){return t.__textSvgEl;},Tk.prototype.getSvgElement=function(t){return t.__svgEl;},w(Dk,Tk),Dk.prototype.addWithoutUpdate=function(o,r){if(r&&r.style){var s=this;E(["fill","stroke"],function(t){if(r.style[t]&&("linear"===r.style[t].type||"radial"===r.style[t].type)){var e,i=r.style[t],n=s.getDefs(!0);i._dom?(e=i._dom,n.contains(i._dom)||s.addDom(e)):e=s.add(i),s.markUsed(r);var a=e.getAttribute("id");o.setAttribute(t,"url(#"+a+")");}});}},Dk.prototype.add=function(t){var e;if("linear"===t.type)e=this.createElement("linearGradient");else{if("radial"!==t.type)return ci("Illegal gradient type."),null;e=this.createElement("radialGradient");}return t.id=t.id||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-gradient-"+t.id),this.updateDom(t,e),this.addDom(e),e;},Dk.prototype.update=function(i){var n=this;Tk.prototype.update.call(this,i,function(){var t=i.type,e=i._dom.tagName;"linear"===t&&"linearGradient"===e||"radial"===t&&"radialGradient"===e?n.updateDom(i,i._dom):(n.removeDom(i),n.add(i));});},Dk.prototype.updateDom=function(t,e){if("linear"===t.type)e.setAttribute("x1",t.x),e.setAttribute("y1",t.y),e.setAttribute("x2",t.x2),e.setAttribute("y2",t.y2);else{if("radial"!==t.type)return void ci("Illegal gradient type.");e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",t.r);}t.global?e.setAttribute("gradientUnits","userSpaceOnUse"):e.setAttribute("gradientUnits","objectBoundingBox"),e.innerHTML="";for(var i=t.colorStops,n=0,a=i.length;n<a;++n){var o=this.createElement("stop");o.setAttribute("offset",100*i[n].offset+"%");var r=i[n].color;if(r.indexOf(!1)){var s=Ee(r)[3],l=Be(r);o.setAttribute("stop-color","#"+l),o.setAttribute("stop-opacity",s);}else o.setAttribute("stop-color",i[n].color);e.appendChild(o);}t._dom=e;},Dk.prototype.markUsed=function(t){if(t.style){var e=t.style.fill;e&&e._dom&&Tk.prototype.markUsed.call(this,e._dom),(e=t.style.stroke)&&e._dom&&Tk.prototype.markUsed.call(this,e._dom);}},w(Ck,Tk),Ck.prototype.update=function(t){var e=this.getSvgElement(t);e&&this.updateDom(e,t.__clipPaths,!1);var i=this.getTextSvgElement(t);i&&this.updateDom(i,t.__clipPaths,!0),this.markUsed(t);},Ck.prototype.updateDom=function(t,e,i){if(e&&0<e.length){var n,a,o=this.getDefs(!0),r=e[0],s=i?"_textDom":"_dom";r[s]?(a=r[s].getAttribute("id"),n=r[s],o.contains(n)||o.appendChild(n)):(a="zr"+this._zrId+"-clip-"+this.nextId,++this.nextId,(n=this.createElement("clipPath")).setAttribute("id",a),o.appendChild(n),r[s]=n);var l=this.getSvgProxy(r);if(r.transform&&r.parent.invTransform&&!i){var u=Array.prototype.slice.call(r.transform);ie(r.transform,r.parent.invTransform,r.transform),l.brush(r),r.transform=u;}else l.brush(r);var h=this.getSvgElement(r);n.innerHTML="",n.appendChild(h.cloneNode()),t.setAttribute("clip-path","url(#"+a+")"),1<e.length&&this.updateDom(n,e.slice(1),i);}else t&&t.setAttribute("clip-path","none");},Ck.prototype.markUsed=function(t){var e=this;t.__clipPaths&&E(t.__clipPaths,function(t){t._dom&&Tk.prototype.markUsed.call(e,t._dom),t._textDom&&Tk.prototype.markUsed.call(e,t._textDom);});},w(Lk,Tk),Lk.prototype.addWithoutUpdate=function(t,e){if(e&&kk(e.style)){var i;if(e._shadowDom)i=e._shadowDom,this.getDefs(!0).contains(e._shadowDom)||this.addDom(i);else i=this.add(e);this.markUsed(e);var n=i.getAttribute("id");t.style.filter="url(#"+n+")";}},Lk.prototype.add=function(t){var e=this.createElement("filter");return t._shadowDomId=t._shadowDomId||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-shadow-"+t._shadowDomId),this.updateDom(t,e),this.addDom(e),e;},Lk.prototype.update=function(t,e){if(kk(e.style)){var i=this;Tk.prototype.update.call(this,e,function(){i.updateDom(e,e._shadowDom);});}else this.remove(t,e);},Lk.prototype.remove=function(t,e){null!=e._shadowDomId&&(this.removeDom(t),t.style.filter="");},Lk.prototype.updateDom=function(t,e){var i=e.getElementsByTagName("feDropShadow");i=0===i.length?this.createElement("feDropShadow"):i[0];var n,a,o,r,s=t.style,l=t.scale&&t.scale[0]||1,u=t.scale&&t.scale[1]||1;if(s.shadowBlur||s.shadowOffsetX||s.shadowOffsetY)n=s.shadowOffsetX||0,a=s.shadowOffsetY||0,o=s.shadowBlur,r=s.shadowColor;else{if(!s.textShadowBlur)return void this.removeDom(e,s);n=s.textShadowOffsetX||0,a=s.textShadowOffsetY||0,o=s.textShadowBlur,r=s.textShadowColor;}i.setAttribute("dx",n/l),i.setAttribute("dy",a/u),i.setAttribute("flood-color",r);var h=o/2/l+" "+o/2/u;i.setAttribute("stdDeviation",h),e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width",Math.ceil(o/2*200)+"%"),e.setAttribute("height",Math.ceil(o/2*200)+"%"),e.appendChild(i),t._shadowDom=e;},Lk.prototype.markUsed=function(t){t._shadowDom&&Tk.prototype.markUsed.call(this,t._shadowDom);};function Vk(t,e,i,n){this.root=t,this.storage=e,this._opts=i=L({},i||{});var a=QL("svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("version","1.1"),a.setAttribute("baseProfile","full"),a.style.cssText="user-select:none;position:absolute;left:0;top:0;",this.gradientManager=new Dk(n,a),this.clipPathManager=new Ck(n,a),this.shadowManager=new Lk(n,a);var o=document.createElement("div");o.style.cssText="overflow:hidden;position:relative",this._svgRoot=a,this._viewport=o,t.appendChild(o),o.appendChild(a),this.resize(i.width,i.height),this._visibleList=[];}Vk.prototype={constructor:Vk,getType:function getType(){return"svg";},getViewportRoot:function getViewportRoot(){return this._viewport;},getViewportRootOffset:function getViewportRootOffset(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0};},refresh:function refresh(){var t=this.storage.getDisplayList(!0);this._paintList(t);},setBackgroundColor:function setBackgroundColor(t){this._viewport.style.background=t;},_paintList:function _paintList(t){this.gradientManager.markAllUnused(),this.clipPathManager.markAllUnused(),this.shadowManager.markAllUnused();var e,i,n=this._svgRoot,a=this._visibleList,o=t.length,r=[];for(e=0;e<o;e++){var s=t[e],l=(i=s)instanceof hr?gk:i instanceof Yn?mk:i instanceof Dr?vk:gk,u=Bk(s)||zk(s);s.invisible||(s.__dirty&&(l&&l.brush(s),this.clipPathManager.update(s),s.style&&(this.gradientManager.update(s.style.fill),this.gradientManager.update(s.style.stroke),this.shadowManager.update(u,s)),s.__dirty=!1),r.push(s));}var h,c=function(t,e,i){return Ak.diff(t,e,i);}(a,r);for(e=0;e<c.length;e++){if((p=c[e]).removed)for(var d=0;d<p.count;d++){u=Bk(s=a[p.indices[d]]);var f=zk(s);Rk(n,u),Rk(n,f);}}for(e=0;e<c.length;e++){var p;if((p=c[e]).added)for(d=0;d<p.count;d++){u=Bk(s=r[p.indices[d]]),f=zk(s);h?Ok(n,u,h):Ek(n,u),u?Ok(n,f,u):h?Ok(n,f,h):Ek(n,f),Ok(n,f,u),h=f||u||h,this.gradientManager.addWithoutUpdate(u||f,s),this.shadowManager.addWithoutUpdate(u||f,s),this.clipPathManager.markUsed(s);}else if(!p.removed)for(d=0;d<p.count;d++){h=zk(s=r[p.indices[d]])||Bk(s)||h;u=Bk(s),f=zk(s);this.gradientManager.markUsed(s),this.gradientManager.addWithoutUpdate(u||f,s),this.shadowManager.markUsed(s),this.shadowManager.addWithoutUpdate(u||f,s),this.clipPathManager.markUsed(s);}}this.gradientManager.removeUnused(),this.clipPathManager.removeUnused(),this.shadowManager.removeUnused(),this._visibleList=r;},_getDefs:function _getDefs(t){var n,e=this._svgRoot;return 0!==(n=this._svgRoot.getElementsByTagName("defs")).length?n[0]:t?((n=e.insertBefore(QL("defs"),e.firstChild)).contains||(n.contains=function(t){var e=n.children;if(!e)return!1;for(var i=e.length-1;0<=i;--i){if(e[i]===t)return!0;}return!1;}),n):null;},resize:function resize(t,e){var i=this._viewport;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!==t||this._height!==e){this._width=t,this._height=e;var a=i.style;a.width=t+"px",a.height=e+"px";var o=this._svgRoot;o.setAttribute("width",t),o.setAttribute("height",e);}},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},_getSize:function _getSize(t){var e=this._opts,i=["width","height"][t],n=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var r=this.root,s=document.defaultView.getComputedStyle(r);return(r[n]||Pk(s[i])||Pk(r.style[i]))-(Pk(s[a])||0)-(Pk(s[o])||0)|0;},dispose:function dispose(){this.root.innerHTML="",this._svgRoot=this._viewport=this.storage=null;},clear:function clear(){this._viewport&&this.root.removeChild(this._viewport);},pathToDataUrl:function pathToDataUrl(){return this.refresh(),"data:image/svg+xml;charset=UTF-8,"+this._svgRoot.outerHTML;}},E(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){Vk.prototype[t]=function(t){return function(){ci('In SVG mode painter not support method "'+t+'"');};}(t);}),pa("svg",Vk),t.version="4.5.0",t.dependencies={zrender:"4.1.2"},t.PRIORITY=cd,t.init=function(t,e,i){var n=Kd(t);if(n)return n;var a=new vd(t,e,i);return a.id="ec_"+Ud++,Hd[a.id]=a,Oa(t,Yd,a.id),function(n){var a="__connectUpdateStatus";function o(t,e){for(var i=0;i<t.length;i++){t[i][a]=e;}}sd(Rd,function(t,e){n._messageCenter.on(e,function(t){if(Zd[n.group]&&0!==n[a]){if(t&&t.escapeConnect)return;var e=n.makeActionFromEvent(t),i=[];sd(Hd,function(t){t!==n&&t.group===n.group&&i.push(t);}),o(i,0),sd(i,function(t){1!==t[a]&&t.dispatchAction(e);}),o(i,2);}});});}(a),a;},t.connect=function(e){if(k(e)){var t=e;e=null,sd(t,function(t){null!=t.group&&(e=t.group);}),e=e||"g_"+Xd++,sd(t,function(t){t.group=e;});}return Zd[e]=!0,e;},t.disConnect=jd,t.disconnect=qd,t.dispose=function(t){"string"==typeof t?t=Hd[t]:t instanceof vd||(t=Kd(t)),t instanceof vd&&!t.isDisposed()&&t.dispose();},t.getInstanceByDom=Kd,t.getInstanceById=function(t){return Hd[t];},t.registerTheme=$d,t.registerPreprocessor=Jd,t.registerProcessor=Qd,t.registerPostUpdate=function(t){Vd.push(t);},t.registerAction=tf,t.registerCoordinateSystem=ef,t.getCoordinateSystemDimensions=function(t){var e=Hu.get(t);if(e)return e.getDimensionsInfo?e.getDimensionsInfo():e.dimensions.slice();},t.registerLayout=nf,t.registerVisual=af,t.registerLoading=rf,t.extendComponentModel=sf,t.extendComponentView=lf,t.extendSeriesModel=uf,t.extendChartView=hf,t.setCanvasCreator=function(t){f("createCanvas",t);},t.registerMap=function(t,e,i){ad.registerMap(t,e,i);},t.getMap=function(t){var e=ad.retrieveMap(t);return e&&e[0]&&{geoJson:e[0].geoJSON,specialAreas:e[0].specialAreas};},t.dataTool={},t.zrender=ma,t.number=Rl,t.format=Jl,t.throttle=cc,t.helper=tg,t.matrix=le,t.vector=It,t.color=Xe,t.parseGeoJSON=rg,t.parseGeoJson=xg,t.util=_g,t.graphic=wg,t.List=Tf,t.Model=dl,t.Axis=vg,t.env=v;});function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/*! uiCropper v1.0.9 License: MIT */
angular.module("uiCropper", []), angular.module("uiCropper").factory("cropAreaCircle", ["cropArea", function (t) {
  function e() {
    t.apply(this, arguments), this._boxResizeBaseSize = 25, this._boxResizeNormalRatio = 1, this._boxResizeHoverRatio = 1.2, this._iconMoveNormalRatio = .9, this._iconMoveHoverRatio = 1.2, this._boxResizeNormalSize = this._boxResizeBaseSize * this._boxResizeNormalRatio, this._boxResizeHoverSize = this._boxResizeBaseSize * this._boxResizeHoverRatio, this._posDragStartX = 0, this._posDragStartY = 0, this._posResizeStartX = 0, this._posResizeStartY = 0, this._posResizeStartSize = 0, this._boxResizeIsHover = !1, this._areaIsHover = !1, this._boxResizeIsDragging = !1, this._areaIsDragging = !1;
  }

  return (e.prototype = new t()).getType = function () {
    return "circle";
  }, e.prototype._calcCirclePerimeterCoords = function (e) {
    var t = this._size.w / 2,
        i = e * (Math.PI / 180);
    return [this.getCenterPoint().x + t * Math.cos(i), this.getCenterPoint().y + t * Math.sin(i)];
  }, e.prototype._calcResizeIconCenterCoords = function () {
    return this._calcCirclePerimeterCoords(-45);
  }, e.prototype._isCoordWithinArea = function (e) {
    return Math.sqrt((e[0] - this.getCenterPoint().x) * (e[0] - this.getCenterPoint().x) + (e[1] - this.getCenterPoint().y) * (e[1] - this.getCenterPoint().y)) < this._size.w / 2;
  }, e.prototype._isCoordWithinBoxResize = function (e) {
    var t = this._calcResizeIconCenterCoords(),
        i = this._boxResizeHoverSize / 2;

    return e[0] > t[0] - i && e[0] < t[0] + i && e[1] > t[1] - i && e[1] < t[1] + i;
  }, e.prototype._drawArea = function (e, t, i) {
    e.arc(t.x, t.y, i.w / 2, 0, 2 * Math.PI);
  }, e.prototype.draw = function () {
    t.prototype.draw.apply(this, arguments);
    var e = this.getCenterPoint();
    this._cropCanvas.drawIconMove([e.x, e.y], this._areaIsHover ? this._iconMoveHoverRatio : this._iconMoveNormalRatio), this._cropCanvas.drawIconResizeBoxNESW(this._calcResizeIconCenterCoords(), this._boxResizeBaseSize, this._boxResizeIsHover ? this._boxResizeHoverRatio : this._boxResizeNormalRatio);
  }, e.prototype.setSizeByScale = function (e) {
    var t = this.getCenterPoint(),
        i = this.getSize().w * e / 2,
        r = {
      x: t.x - i,
      y: t.y - i
    },
        s = {
      x: t.x + i,
      y: t.y + i
    };
    this.circleOnMove(r, s), this._events.trigger("area-resize");
  }, e.prototype.processMouseMove = function (e, t) {
    var i = "default",
        r = !1;
    if (this._boxResizeIsHover = !1, this._areaIsHover = !1, this._areaIsDragging) this.setCenterPointOnMove({
      x: e - this._posDragStartX,
      y: t - this._posDragStartY
    }), i = "move", r = this._areaIsHover = !0, this._events.trigger("area-move");else if (this._boxResizeIsDragging) {
      var s, a, n;
      i = "nesw-resize", a = e - this._posResizeStartX, s = (n = this._posResizeStartY - t) < a ? this._posResizeStartSize.w + 2 * n : this._posResizeStartSize.w + 2 * a;
      var o = {},
          h = {};
      o.x = this.getCenterPoint().x - .5 * s, h.x = this.getCenterPoint().x + .5 * s, o.y = this.getCenterPoint().y - .5 * s, h.y = this.getCenterPoint().y + .5 * s, this.circleOnMove(o, h), r = this._boxResizeIsHover = !0, this._events.trigger("area-resize");
    } else this._isCoordWithinBoxResize([e, t]) ? (i = "nesw-resize", this._areaIsHover = !1, r = this._boxResizeIsHover = !0) : this._isCoordWithinArea([e, t]) && (i = "move", r = this._areaIsHover = !0);
    return angular.element(this._ctx.canvas).css({
      cursor: i
    }), r;
  }, e.prototype.processMouseDown = function (e, t) {
    if (this._isCoordWithinBoxResize([e, t])) this._areaIsDragging = !1, this._areaIsHover = !1, this._boxResizeIsDragging = !0, this._boxResizeIsHover = !0, this._posResizeStartX = e, this._posResizeStartY = t, this._posResizeStartSize = this._size, this._events.trigger("area-resize-start");else if (this._isCoordWithinArea([e, t])) {
      this._areaIsDragging = !0, this._areaIsHover = !0, this._boxResizeIsDragging = !1, this._boxResizeIsHover = !1;
      var i = this.getCenterPoint();
      this._posDragStartX = e - i.x, this._posDragStartY = t - i.y, this._events.trigger("area-move-start");
    }
  }, e.prototype.processMouseUp = function () {
    this._areaIsDragging && (this._areaIsDragging = !1, this._events.trigger("area-move-end")), this._boxResizeIsDragging && (this._boxResizeIsDragging = !1, this._events.trigger("area-resize-end")), this._areaIsHover = !1, this._boxResizeIsHover = !1, this._posDragStartX = 0, this._posDragStartY = 0;
  }, e;
}]), angular.module("uiCropper").factory("cropAreaRectangle", ["cropArea", function (a) {
  function e() {
    a.apply(this, arguments), this._resizeCtrlBaseRadius = 15, this._resizeCtrlNormalRatio = .6, this._resizeCtrlHoverRatio = .7, this._iconMoveNormalRatio = .9, this._iconMoveHoverRatio = 1.2, this._resizeCtrlNormalRadius = this._resizeCtrlBaseRadius * this._resizeCtrlNormalRatio, this._resizeCtrlHoverRadius = this._resizeCtrlBaseRadius * this._resizeCtrlHoverRatio, this._posDragStartX = 0, this._posDragStartY = 0, this._posResizeStartX = 0, this._posResizeStartY = 0, this._posResizeStartSize = {
      w: 0,
      h: 0
    }, this._resizeCtrlIsHover = -1, this._areaIsHover = !1, this._resizeCtrlIsDragging = -1, this._areaIsDragging = !1;
  }

  return (e.prototype = new a()).getType = function () {
    return "rectangle";
  }, e.prototype._calcRectangleCorners = function () {
    var e = this.getSize(),
        t = this.getSouthEastBound();
    return [[e.x, e.y], [t.x, e.y], [e.x, t.y], [t.x, t.y]];
  }, e.prototype._calcRectangleDimensions = function () {
    var e = this.getSize(),
        t = this.getSouthEastBound();
    return {
      left: e.x,
      top: e.y,
      right: t.x,
      bottom: t.y
    };
  }, e.prototype._isCoordWithinArea = function (e) {
    var t = this._calcRectangleDimensions();

    return e[0] >= t.left && e[0] <= t.right && e[1] >= t.top && e[1] <= t.bottom;
  }, e.prototype._isCoordWithinResizeCtrl = function (e) {
    for (var t = this._calcRectangleCorners(), i = -1, r = 0, s = t.length; r < s; r++) {
      var a = t[r];

      if (e[0] > a[0] - this._resizeCtrlHoverRadius && e[0] < a[0] + this._resizeCtrlHoverRadius && e[1] > a[1] - this._resizeCtrlHoverRadius && e[1] < a[1] + this._resizeCtrlHoverRadius) {
        i = r;
        break;
      }
    }

    return i;
  }, e.prototype._drawArea = function (e, t, i) {
    e.rect(i.x, i.y, i.w, i.h);
  }, e.prototype.draw = function () {
    a.prototype.draw.apply(this, arguments);
    var e = this.getCenterPoint();

    this._cropCanvas.drawIconMove([e.x, e.y], this._areaIsHover ? this._iconMoveHoverRatio : this._iconMoveNormalRatio);

    for (var t = this._calcRectangleCorners(), i = 0, r = t.length; i < r; i++) {
      var s = t[i];

      this._cropCanvas.drawIconResizeBoxBase(s, this._resizeCtrlBaseRadius, this._resizeCtrlIsHover === i ? this._resizeCtrlHoverRatio : this._resizeCtrlNormalRatio);
    }
  }, e.prototype.setSizeByScale = function (e, t) {
    var i,
        r,
        s = this.getCenterPoint(),
        a = this.getSize();

    if (this._aspect) {
      var n = a.w * e,
          o = a.h * e;
      i = {
        x: s.x - n / 2,
        y: s.y - o / 2
      }, r = {
        x: s.x + n / 2,
        y: s.y + o / 2
      };
    } else switch (i = {
      x: a.x,
      y: a.y
    }, r = {
      x: a.x + a.w,
      y: a.y + a.h
    }, t) {
      case "up":
      case "down":
        r.y = a.y + a.h * e;
        break;

      case "left":
      case "right":
        r.x = a.x + a.w * e;
    }

    this.setSizeByCorners(i, r), this._events.trigger("area-resize");
  }, e.prototype.processMouseMove = function (e, t) {
    var i = "default",
        r = !1;
    if (this._resizeCtrlIsHover = -1, this._areaIsHover = !1, this._areaIsDragging) this.setCenterPointOnMove({
      x: e - this._posDragStartX,
      y: t - this._posDragStartY
    }), i = "move", r = this._areaIsHover = !0, this._events.trigger("area-move");else if (-1 < this._resizeCtrlIsDragging) {
      var s = this.getSize(),
          a = this.getSouthEastBound(),
          n = e;

      switch (this._resizeCtrlIsDragging) {
        case 0:
          this._aspect && (n = a.x - (a.y - t) * this._aspect), this.setSizeByCorners({
            x: n,
            y: t
          }, {
            x: a.x,
            y: a.y
          }), i = "nwse-resize";
          break;

        case 1:
          this._aspect && (n = s.x + (a.y - t) * this._aspect), this.setSizeByCorners({
            x: s.x,
            y: t
          }, {
            x: n,
            y: a.y
          }), i = "nesw-resize";
          break;

        case 2:
          this._aspect && (n = a.x - (t - s.y) * this._aspect), this.setSizeByCorners({
            x: n,
            y: s.y
          }, {
            x: a.x,
            y: t
          }), i = "nesw-resize";
          break;

        case 3:
          this._aspect && (n = s.x + (t - s.y) * this._aspect), this.setSizeByCorners({
            x: s.x,
            y: s.y
          }, {
            x: n,
            y: t
          }), i = "nwse-resize";
      }

      this._resizeCtrlIsHover = this._resizeCtrlIsDragging, r = !0, this._events.trigger("area-resize");
    } else {
      var o = this._isCoordWithinResizeCtrl([e, t]);

      if (-1 < o) {
        switch (o) {
          case 0:
            i = "nwse-resize";
            break;

          case 1:
          case 2:
            i = "nesw-resize";
            break;

          case 3:
            i = "nwse-resize";
        }

        this._areaIsHover = !1, this._resizeCtrlIsHover = o, r = !0;
      } else this._isCoordWithinArea([e, t]) && (i = "move", r = this._areaIsHover = !0);
    }
    return angular.element(this._ctx.canvas).css({
      cursor: i
    }), r;
  }, e.prototype.processMouseDown = function (e, t) {
    var i = this._isCoordWithinResizeCtrl([e, t]);

    if (-1 < i) this._areaIsDragging = !1, this._areaIsHover = !1, this._resizeCtrlIsDragging = i, this._resizeCtrlIsHover = i, this._posResizeStartX = e, this._posResizeStartY = t, this._posResizeStartSize = this._size, this._events.trigger("area-resize-start");else if (this._isCoordWithinArea([e, t])) {
      this._areaIsDragging = !0, this._areaIsHover = !0, this._resizeCtrlIsDragging = -1, this._resizeCtrlIsHover = -1;
      var r = this.getCenterPoint();
      this._posDragStartX = e - r.x, this._posDragStartY = t - r.y, this._events.trigger("area-move-start");
    }
  }, e.prototype.processMouseUp = function () {
    this._areaIsDragging && (this._areaIsDragging = !1, this._events.trigger("area-move-end")), -1 < this._resizeCtrlIsDragging && (this._resizeCtrlIsDragging = -1, this._events.trigger("area-resize-end")), this._areaIsHover = !1, this._resizeCtrlIsHover = -1, this._posDragStartX = 0, this._posDragStartY = 0;
  }, e;
}]), angular.module("uiCropper").factory("cropAreaSquare", ["cropArea", function (a) {
  function e() {
    a.apply(this, arguments), this._resizeCtrlBaseRadius = 15, this._resizeCtrlNormalRatio = .6, this._resizeCtrlHoverRatio = .7, this._iconMoveNormalRatio = .9, this._iconMoveHoverRatio = 1.2, this._resizeCtrlNormalRadius = this._resizeCtrlBaseRadius * this._resizeCtrlNormalRatio, this._resizeCtrlHoverRadius = this._resizeCtrlBaseRadius * this._resizeCtrlHoverRatio, this._posDragStartX = 0, this._posDragStartY = 0, this._posResizeStartX = 0, this._posResizeStartY = 0, this._posResizeStartSize = 0, this._resizeCtrlIsHover = -1, this._areaIsHover = !1, this._resizeCtrlIsDragging = -1, this._areaIsDragging = !1;
  }

  return (e.prototype = new a()).getType = function () {
    return "square";
  }, e.prototype._calcSquareCorners = function () {
    var e = this.getSize(),
        t = this.getSouthEastBound();
    return [[e.x, e.y], [t.x, e.y], [e.x, t.y], [t.x, t.y]];
  }, e.prototype._calcSquareDimensions = function () {
    var e = this.getSize(),
        t = this.getSouthEastBound();
    return {
      left: e.x,
      top: e.y,
      right: t.x,
      bottom: t.y
    };
  }, e.prototype._isCoordWithinArea = function (e) {
    var t = this._calcSquareDimensions();

    return e[0] >= t.left && e[0] <= t.right && e[1] >= t.top && e[1] <= t.bottom;
  }, e.prototype._isCoordWithinResizeCtrl = function (e) {
    for (var t = this._calcSquareCorners(), i = -1, r = 0, s = t.length; r < s; r++) {
      var a = t[r];

      if (e[0] > a[0] - this._resizeCtrlHoverRadius && e[0] < a[0] + this._resizeCtrlHoverRadius && e[1] > a[1] - this._resizeCtrlHoverRadius && e[1] < a[1] + this._resizeCtrlHoverRadius) {
        i = r;
        break;
      }
    }

    return i;
  }, e.prototype._drawArea = function (e, t, i) {
    e.rect(i.x, i.y, i.w, i.h);
  }, e.prototype.draw = function () {
    a.prototype.draw.apply(this, arguments);
    var e = this.getCenterPoint();

    this._cropCanvas.drawIconMove([e.x, e.y], this._areaIsHover ? this._iconMoveHoverRatio : this._iconMoveNormalRatio);

    for (var t = this._calcSquareCorners(), i = 0, r = t.length; i < r; i++) {
      var s = t[i];

      this._cropCanvas.drawIconResizeBoxBase(s, this._resizeCtrlBaseRadius, this._resizeCtrlIsHover === i ? this._resizeCtrlHoverRatio : this._resizeCtrlNormalRatio);
    }
  }, e.prototype._clampPoint = function (e, t) {
    var i = this._ctx.canvas.width;
    return e < 0 && (t -= Math.abs(e), e = 0), t < 0 && (e -= Math.abs(t), t = 0), i < e && (t -= i - e, e = i), i < t && (e -= i - t, t = i), {
      x: e,
      y: t
    };
  }, e.prototype.setSizeByScale = function (e) {
    var t = this.getCenterPoint(),
        i = this.getSize().w * e;
    i < this._minSize.w && (i = this._minSize.w);
    var r = {
      x: t.x - i / 2,
      y: t.y - i / 2
    },
        s = {
      x: t.x + i / 2,
      y: t.y + i / 2
    };
    this.setSizeByCorners(r, s), this._events.trigger("area-resize");
  }, e.prototype.processMouseMove = function (e, t) {
    var i = "default",
        r = !1;
    if (this._resizeCtrlIsHover = -1, this._areaIsHover = !1, this._areaIsDragging) this.setCenterPointOnMove({
      x: e - this._posDragStartX,
      y: t - this._posDragStartY
    }), i = "move", r = this._areaIsHover = !0, this._events.trigger("area-move");else if (-1 < this._resizeCtrlIsDragging) {
      var s, a;

      switch (this._resizeCtrlIsDragging) {
        case 0:
          a = s = -1, i = "nwse-resize";
          break;

        case 1:
          a = -(s = 1), i = "nesw-resize";
          break;

        case 2:
          s = -1, a = 1, i = "nesw-resize";
          break;

        case 3:
          a = s = 1, i = "nwse-resize";
      }

      var n,
          o = (e - this._posResizeStartX) * s,
          h = (t - this._posResizeStartY) * a;
      n = h < o ? this._posResizeStartSize.w + h : this._posResizeStartSize.w + o;
      var c = Math.max(this._minSize.w, n),
          u = {},
          l = {},
          g = {},
          p = {},
          f = this.getSize(),
          d = this.getSouthEastBound();

      switch (this._resizeCtrlIsDragging) {
        case 0:
          u.x = d.x - c, u.y = d.y - c, u = this._clampPoint(u.x, u.y), this.setSizeByCorners(u, {
            x: d.x,
            y: d.y
          }), i = "nwse-resize";
          break;

        case 1:
          p.x = f.x + c, p.y = d.y - c, p = this._clampPoint(p.x, p.y), this.setSizeByCorners({
            x: f.x,
            y: p.y
          }, {
            x: p.x,
            y: d.y
          }), i = "nesw-resize";
          break;

        case 2:
          g.x = d.x - c, g.y = f.y + c, g = this._clampPoint(g.x, g.y), this.setSizeByCorners({
            x: g.x,
            y: f.y
          }, {
            x: d.x,
            y: g.y
          }), i = "nesw-resize";
          break;

        case 3:
          l.x = f.x + c, l.y = f.y + c, l = this._clampPoint(l.x, l.y), this.setSizeByCorners({
            x: f.x,
            y: f.y
          }, l), i = "nwse-resize";
      }

      this._resizeCtrlIsHover = this._resizeCtrlIsDragging, r = !0, this._events.trigger("area-resize");
    } else {
      var v = this._isCoordWithinResizeCtrl([e, t]);

      if (-1 < v) {
        switch (v) {
          case 0:
            i = "nwse-resize";
            break;

          case 1:
          case 2:
            i = "nesw-resize";
            break;

          case 3:
            i = "nwse-resize";
        }

        this._areaIsHover = !1, this._resizeCtrlIsHover = v, r = !0;
      } else this._isCoordWithinArea([e, t]) && (i = "move", r = this._areaIsHover = !0);
    }
    return angular.element(this._ctx.canvas).css({
      cursor: i
    }), r;
  }, e.prototype.processMouseDown = function (e, t) {
    var i = this._isCoordWithinResizeCtrl([e, t]);

    if (-1 < i) this._areaIsDragging = !1, this._areaIsHover = !1, this._resizeCtrlIsDragging = i, this._resizeCtrlIsHover = i, this._posResizeStartX = e, this._posResizeStartY = t, this._posResizeStartSize = this._size, this._events.trigger("area-resize-start");else if (this._isCoordWithinArea([e, t])) {
      this._areaIsDragging = !0, this._areaIsHover = !0, this._resizeCtrlIsDragging = -1, this._resizeCtrlIsHover = -1;
      var r = this.getCenterPoint();
      this._posDragStartX = e - r.x, this._posDragStartY = t - r.y, this._events.trigger("area-move-start");
    }
  }, e.prototype.processMouseUp = function () {
    this._areaIsDragging && (this._areaIsDragging = !1, this._events.trigger("area-move-end")), -1 < this._resizeCtrlIsDragging && (this._resizeCtrlIsDragging = -1, this._events.trigger("area-resize-end")), this._areaIsHover = !1, this._resizeCtrlIsHover = -1, this._posDragStartX = 0, this._posDragStartY = 0;
  }, e;
}]), angular.module("uiCropper").factory("cropArea", ["cropCanvas", function (i) {
  function e(e, t) {
    this._ctx = e, this._events = t, this._minSize = {
      x: 0,
      y: 0,
      w: 80,
      h: 80
    }, this._initSize = void 0, this._initCoords = void 0, this._allowCropResizeOnCorners = !1, this._forceAspectRatio = !1, this._aspect = null, this._disableCrop = !1, this._cropCanvas = new i(e, this._disableCrop), this._image = new Image(), this._size = {
      x: 0,
      y: 0,
      w: 150,
      h: 150
    };
  }

  return e.prototype.setAllowCropResizeOnCorners = function (e) {
    this._allowCropResizeOnCorners = e;
  }, e.prototype.getImage = function () {
    return this._image;
  }, e.prototype.setImage = function (e) {
    this._image = e;
  }, e.prototype.setForceAspectRatio = function (e) {
    this._forceAspectRatio = e;
  }, e.prototype.setAspect = function (e) {
    this._aspect = e;
  }, e.prototype.getAspect = function () {
    return this._aspect;
  }, e.prototype.getCanvasSize = function () {
    return {
      w: this._ctx.canvas.width,
      h: this._ctx.canvas.height
    };
  }, e.prototype.getSize = function () {
    return this._size;
  }, e.prototype.setSize = function (e) {
    e = this._processSize(e), this._size = this._preventBoundaryCollision(e);
  }, e.prototype.setSizeOnMove = function (e) {
    e = this._processSize(e), this._allowCropResizeOnCorners ? this._size = this._preventBoundaryCollision(e) : this._size = this._allowMouseOutsideCanvas(e);
  }, e.prototype.circleOnMove = function (e, t) {
    var i = {
      x: e.x,
      y: e.y,
      w: t.x - e.x,
      h: t.y - e.y
    },
        r = this._ctx.canvas.height,
        s = this._ctx.canvas.width;
    (i.w > s || i.h > r) && (s < r ? (i.w = s, i.h = s) : (i.w = r, i.h = r)), i.x + i.w > s && (i.x = s - i.w), i.y + i.h > r && (i.y = r - i.h), i.x < 0 && (i.x = 0), i.y < 0 && (i.y = 0), this._minSize.w > i.w && (i.w = this._minSize.w, i.x = this._size.x), this._minSize.h > i.h && (i.h = this._minSize.h, i.y = this._size.y), this._size = i;
  }, e.prototype.setSizeByCorners = function (e, t) {
    var i = {
      x: e.x,
      y: e.y,
      w: t.x - e.x,
      h: t.y - e.y
    };
    this.setSize(i);
  }, e.prototype.getSouthEastBound = function () {
    return this._southEastBound(this.getSize());
  }, e.prototype.setMinSize = function (e) {
    this._minSize = this._processSize(e), this.setSize(this._minSize);
  }, e.prototype.getMinSize = function () {
    return this._minSize;
  }, e.prototype.getCenterPoint = function () {
    var e = this.getSize();
    return {
      x: e.x + e.w / 2,
      y: e.y + e.h / 2
    };
  }, e.prototype.setCenterPoint = function (e) {
    var t = this.getSize();
    this.setSize({
      x: e.x - t.w / 2,
      y: e.y - t.h / 2,
      w: t.w,
      h: t.h
    });
  }, e.prototype.setCenterPointOnMove = function (e) {
    var t = this.getSize();
    this.setSizeOnMove({
      x: e.x - t.w / 2,
      y: e.y - t.h / 2,
      w: t.w,
      h: t.h
    });
  }, e.prototype.setInitSize = function (e) {
    this._initSize = this._processSize(e), this.setSize(this._initSize);
  }, e.prototype.getInitSize = function () {
    return this._initSize;
  }, e.prototype.setInitCoords = function (e) {
    e.h = this.getSize().h, e.w = this.getSize().w, this._initCoords = this._processSize(e), this.setSize(this._initCoords);
  }, e.prototype.setDisableCrop = function (e) {
    this._disableCrop = e, this._cropCanvas = new i(this._ctx, this._disableCrop);
  }, e.prototype.getInitCoords = function () {
    return this._initCoords;
  }, e.prototype.getType = function () {
    return "circle";
  }, e.prototype._allowMouseOutsideCanvas = function (e) {
    var t = this._ctx.canvas.height,
        i = this._ctx.canvas.width,
        r = {
      w: e.w,
      h: e.h
    };
    return e.x < 0 ? r.x = 0 : e.x + e.w > i ? r.x = i - e.w : r.x = e.x, e.y < 0 ? r.y = 0 : e.y + e.h > t ? r.y = t - e.h : r.y = e.y, r;
  }, e.prototype._preventBoundaryCollision = function (e) {
    var t = this._ctx.canvas.height,
        i = this._ctx.canvas.width,
        r = {
      x: e.x,
      y: e.y
    },
        s = this._southEastBound(e);

    r.x < 0 && (r.x = 0), r.y < 0 && (r.y = 0), s.x > i && (s.x = i), s.y > t && (s.y = t);
    var a = this._forceAspectRatio ? e.w : s.x - r.x,
        n = this._forceAspectRatio ? e.h : s.y - r.y;
    t < n && (n = t), this._aspect && (a = n * this._aspect, r.x + a > i && (n = (a = i - r.x) / this._aspect, this._minSize.w > a && (a = this._minSize.w), this._minSize.h > n && (n = this._minSize.h), r.x = i - a), r.y + n > t && (r.y = t - n)), this._forceAspectRatio && (a = n, r.x + a > i && ((a = i - r.x) < this._minSize.w && (a = this._minSize.w), n = a));
    var o = {
      x: r.x,
      y: r.y,
      w: a,
      h: n
    };
    return o.w < this._minSize.w && !this._forceAspectRatio && (o.w = this._minSize.w, (s = this._southEastBound(o)).x > i && (s.x = i, r.x = Math.max(s.x - i, s.x - this._minSize.w), o = {
      x: r.x,
      y: r.y,
      w: s.x - r.x,
      h: s.y - r.y
    })), o.h < this._minSize.h && !this._forceAspectRatio && (o.h = this._minSize.h, (s = this._southEastBound(o)).y > t && (s.y = t, r.y = Math.max(s.y - t, s.y - this._minSize.h), o = {
      x: r.x,
      y: r.y,
      w: s.x - r.x,
      h: s.y - r.y
    })), this._forceAspectRatio && ((s = this._southEastBound(o)).y > t && (o.y = t - o.h), s.x > i && (o.x = i - o.w)), o;
  }, e.prototype._dontDragOutside = function () {
    var e = this._ctx.canvas.height,
        t = this._ctx.canvas.width;
    this._width > t && (this._width = t), this._height > e && (this._height = e), this._x < this._width / 2 && (this._x = this._width / 2), this._x > t - this._width / 2 && (this._x = t - this._width / 2), this._y < this._height / 2 && (this._y = this._height / 2), this._y > e - this._height / 2 && (this._y = e - this._height / 2);
  }, e.prototype._drawArea = function () {}, e.prototype._processSize = function (e) {
    "number" == typeof e && (e = {
      w: e,
      h: e
    });
    var t = e.w,
        i = e.h;
    return this._aspect && (1 <= this.aspect ? t = e.h * this._aspect : i = e.w / this._aspect), {
      x: void 0 === e.x ? this.getSize().x : e.x,
      y: void 0 === e.y ? this.getSize().y : e.y,
      w: t || this._minSize.w,
      h: i || this._minSize.h
    };
  }, e.prototype._southEastBound = function (e) {
    return {
      x: e.x + e.w,
      y: e.y + e.h
    };
  }, e.prototype.draw = function () {
    this._cropCanvas.drawCropArea(this._image, this.getCenterPoint(), this._size, this._drawArea);
  }, e.prototype.processMouseMove = function () {}, e.prototype.processMouseDown = function () {}, e.prototype.processMouseUp = function () {}, e;
}]), angular.module("uiCropper").factory("cropCanvas", [function () {
  var s = [[-.5, -2], [-3, -4.5], [-.5, -7], [-7, -7], [-7, -.5], [-4.5, -3], [-2, -.5]],
      a = [[.5, -2], [3, -4.5], [.5, -7], [7, -7], [7, -.5], [4.5, -3], [2, -.5]],
      n = [[-.5, 2], [-3, 4.5], [-.5, 7], [-7, 7], [-7, .5], [-4.5, 3], [-2, .5]],
      u = [[.5, 2], [3, 4.5], [.5, 7], [7, 7], [7, .5], [4.5, 3], [2, .5]],
      i = [[-1.5, -2.5], [-1.5, -6], [-5, -6], [0, -11], [5, -6], [1.5, -6], [1.5, -2.5]],
      l = [[-2.5, -1.5], [-6, -1.5], [-6, -5], [-11, 0], [-6, 5], [-6, 1.5], [-2.5, 1.5]],
      g = [[-1.5, 2.5], [-1.5, 6], [-5, 6], [0, 11], [5, 6], [1.5, 6], [1.5, 2.5]],
      p = [[2.5, -1.5], [6, -1.5], [6, -5], [11, 0], [6, 5], [6, 1.5], [2.5, 1.5]],
      f = "#fff",
      d = "#bababa",
      v = "#444",
      m = "#fff",
      w = "#bababa",
      y = "#444",
      _ = "#fff",
      z = 1;
  return function (h, c) {
    function o(e, t, i) {
      return [i * e[0] + t[0], i * e[1] + t[1]];
    }

    function r(e, t, i, r) {
      if (!c) {
        h.save(), h.fillStyle = t, h.beginPath();
        var s,
            a = o(e[0], i, r);

        for (var n in h.moveTo(a[0], a[1]), e) {
          0 < n && (s = o(e[n], i, r), h.lineTo(s[0], s[1]));
        }

        h.lineTo(a[0], a[1]), h.fill(), h.closePath(), h.restore();
      }
    }

    this.drawIconMove = function (e, t) {
      c || (r(i, _, e, t), r(l, _, e, t), r(g, _, e, t), r(p, _, e, t));
    }, this.drawIconResizeCircle = function (e, t, i) {
      if (!c) {
        var r = t * i;
        h.save(), h.strokeStyle = w, h.lineWidth = z, h.fillStyle = y, h.beginPath(), h.arc(e[0], e[1], r, 0, 2 * Math.PI), h.fill(), h.stroke(), h.closePath(), h.restore();
      }
    }, this.drawIconResizeBoxBase = function (e, t, i) {
      if (!c) {
        var r = t * i;
        h.save(), h.strokeStyle = d, h.lineWidth = z, h.fillStyle = v, h.fillRect(e[0] - r / 2, e[1] - r / 2, r, r), h.strokeRect(e[0] - r / 2, e[1] - r / 2, r, r), h.restore();
      }
    }, this.drawIconResizeBoxNESW = function (e, t, i) {
      c || (this.drawIconResizeBoxBase(e, t, i), r(a, m, e, i), r(n, m, e, i));
    }, this.drawIconResizeBoxNWSE = function (e, t, i) {
      c || (this.drawIconResizeBoxBase(e, t, i), r(s, m, e, i), r(u, m, e, i));
    }, this.drawCropArea = function (e, t, i, r) {
      if (!c) {
        var s = Math.abs(e.width / h.canvas.width),
            a = Math.abs(e.height / h.canvas.height),
            n = Math.abs(t.x - i.w / 2),
            o = Math.abs(t.y - i.h / 2);
        h.save(), h.strokeStyle = f, h.lineWidth = z, h.setLineDash([5, 5]), h.beginPath(), r(h, t, i), h.stroke(), h.clip(), 0 < i.w && h.drawImage(e, n * s, o * a, Math.abs(i.w * s), Math.abs(i.h * a), n, o, Math.abs(i.w), Math.abs(i.h)), h.beginPath(), r(h, t, i), h.stroke(), h.clip(), h.restore();
      }
    };
  };
}]), angular.module("uiCropper").service("cropEXIF", [function () {
  var u = !1,
      c = this.Tags = {
    36864: "ExifVersion",
    40960: "FlashpixVersion",
    40961: "ColorSpace",
    40962: "PixelXDimension",
    40963: "PixelYDimension",
    37121: "ComponentsConfiguration",
    37122: "CompressedBitsPerPixel",
    37500: "MakerNote",
    37510: "UserComment",
    40964: "RelatedSoundFile",
    36867: "DateTimeOriginal",
    36868: "DateTimeDigitized",
    37520: "SubsecTime",
    37521: "SubsecTimeOriginal",
    37522: "SubsecTimeDigitized",
    33434: "ExposureTime",
    33437: "FNumber",
    34850: "ExposureProgram",
    34852: "SpectralSensitivity",
    34855: "ISOSpeedRatings",
    34856: "OECF",
    37377: "ShutterSpeedValue",
    37378: "ApertureValue",
    37379: "BrightnessValue",
    37380: "ExposureBias",
    37381: "MaxApertureValue",
    37382: "SubjectDistance",
    37383: "MeteringMode",
    37384: "LightSource",
    37385: "Flash",
    37396: "SubjectArea",
    37386: "FocalLength",
    41483: "FlashEnergy",
    41484: "SpatialFrequencyResponse",
    41486: "FocalPlaneXResolution",
    41487: "FocalPlaneYResolution",
    41488: "FocalPlaneResolutionUnit",
    41492: "SubjectLocation",
    41493: "ExposureIndex",
    41495: "SensingMethod",
    41728: "FileSource",
    41729: "SceneType",
    41730: "CFAPattern",
    41985: "CustomRendered",
    41986: "ExposureMode",
    41987: "WhiteBalance",
    41988: "DigitalZoomRation",
    41989: "FocalLengthIn35mmFilm",
    41990: "SceneCaptureType",
    41991: "GainControl",
    41992: "Contrast",
    41993: "Saturation",
    41994: "Sharpness",
    41995: "DeviceSettingDescription",
    41996: "SubjectDistanceRange",
    40965: "InteroperabilityIFDPointer",
    42016: "ImageUniqueID"
  },
      l = this.TiffTags = {
    256: "ImageWidth",
    257: "ImageHeight",
    34665: "ExifIFDPointer",
    34853: "GPSInfoIFDPointer",
    40965: "InteroperabilityIFDPointer",
    258: "BitsPerSample",
    259: "Compression",
    262: "PhotometricInterpretation",
    274: "Orientation",
    277: "SamplesPerPixel",
    284: "PlanarConfiguration",
    530: "YCbCrSubSampling",
    531: "YCbCrPositioning",
    282: "XResolution",
    283: "YResolution",
    296: "ResolutionUnit",
    273: "StripOffsets",
    278: "RowsPerStrip",
    279: "StripByteCounts",
    513: "JPEGInterchangeFormat",
    514: "JPEGInterchangeFormatLength",
    301: "TransferFunction",
    318: "WhitePoint",
    319: "PrimaryChromaticities",
    529: "YCbCrCoefficients",
    532: "ReferenceBlackWhite",
    306: "DateTime",
    270: "ImageDescription",
    271: "Make",
    272: "Model",
    305: "Software",
    315: "Artist",
    33432: "Copyright"
  },
      g = this.GPSTags = {
    0: "GPSVersionID",
    1: "GPSLatitudeRef",
    2: "GPSLatitude",
    3: "GPSLongitudeRef",
    4: "GPSLongitude",
    5: "GPSAltitudeRef",
    6: "GPSAltitude",
    7: "GPSTimeStamp",
    8: "GPSSatellites",
    9: "GPSStatus",
    10: "GPSMeasureMode",
    11: "GPSDOP",
    12: "GPSSpeedRef",
    13: "GPSSpeed",
    14: "GPSTrackRef",
    15: "GPSTrack",
    16: "GPSImgDirectionRef",
    17: "GPSImgDirection",
    18: "GPSMapDatum",
    19: "GPSDestLatitudeRef",
    20: "GPSDestLatitude",
    21: "GPSDestLongitudeRef",
    22: "GPSDestLongitude",
    23: "GPSDestBearingRef",
    24: "GPSDestBearing",
    25: "GPSDestDistanceRef",
    26: "GPSDestDistance",
    27: "GPSProcessingMethod",
    28: "GPSAreaInformation",
    29: "GPSDateStamp",
    30: "GPSDifferential"
  },
      p = this.StringValues = {
    ExposureProgram: {
      0: "Not defined",
      1: "Manual",
      2: "Normal program",
      3: "Aperture priority",
      4: "Shutter priority",
      5: "Creative program",
      6: "Action program",
      7: "Portrait mode",
      8: "Landscape mode"
    },
    MeteringMode: {
      0: "Unknown",
      1: "Average",
      2: "CenterWeightedAverage",
      3: "Spot",
      4: "MultiSpot",
      5: "Pattern",
      6: "Partial",
      255: "Other"
    },
    LightSource: {
      0: "Unknown",
      1: "Daylight",
      2: "Fluorescent",
      3: "Tungsten (incandescent light)",
      4: "Flash",
      9: "Fine weather",
      10: "Cloudy weather",
      11: "Shade",
      12: "Daylight fluorescent (D 5700 - 7100K)",
      13: "Day white fluorescent (N 4600 - 5400K)",
      14: "Cool white fluorescent (W 3900 - 4500K)",
      15: "White fluorescent (WW 3200 - 3700K)",
      17: "Standard light A",
      18: "Standard light B",
      19: "Standard light C",
      20: "D55",
      21: "D65",
      22: "D75",
      23: "D50",
      24: "ISO studio tungsten",
      255: "Other"
    },
    Flash: {
      0: "Flash did not fire",
      1: "Flash fired",
      5: "Strobe return light not detected",
      7: "Strobe return light detected",
      9: "Flash fired, compulsory flash mode",
      13: "Flash fired, compulsory flash mode, return light not detected",
      15: "Flash fired, compulsory flash mode, return light detected",
      16: "Flash did not fire, compulsory flash mode",
      24: "Flash did not fire, auto mode",
      25: "Flash fired, auto mode",
      29: "Flash fired, auto mode, return light not detected",
      31: "Flash fired, auto mode, return light detected",
      32: "No flash function",
      65: "Flash fired, red-eye reduction mode",
      69: "Flash fired, red-eye reduction mode, return light not detected",
      71: "Flash fired, red-eye reduction mode, return light detected",
      73: "Flash fired, compulsory flash mode, red-eye reduction mode",
      77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
      79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",
      89: "Flash fired, auto mode, red-eye reduction mode",
      93: "Flash fired, auto mode, return light not detected, red-eye reduction mode",
      95: "Flash fired, auto mode, return light detected, red-eye reduction mode"
    },
    SensingMethod: {
      1: "Not defined",
      2: "One-chip color area sensor",
      3: "Two-chip color area sensor",
      4: "Three-chip color area sensor",
      5: "Color sequential area sensor",
      7: "Trilinear sensor",
      8: "Color sequential linear sensor"
    },
    SceneCaptureType: {
      0: "Standard",
      1: "Landscape",
      2: "Portrait",
      3: "Night scene"
    },
    SceneType: {
      1: "Directly photographed"
    },
    CustomRendered: {
      0: "Normal process",
      1: "Custom process"
    },
    WhiteBalance: {
      0: "Auto white balance",
      1: "Manual white balance"
    },
    GainControl: {
      0: "None",
      1: "Low gain up",
      2: "High gain up",
      3: "Low gain down",
      4: "High gain down"
    },
    Contrast: {
      0: "Normal",
      1: "Soft",
      2: "Hard"
    },
    Saturation: {
      0: "Normal",
      1: "Low saturation",
      2: "High saturation"
    },
    Sharpness: {
      0: "Normal",
      1: "Soft",
      2: "Hard"
    },
    SubjectDistanceRange: {
      0: "Unknown",
      1: "Macro",
      2: "Close view",
      3: "Distant view"
    },
    FileSource: {
      3: "DSC"
    },
    Components: {
      0: "",
      1: "Y",
      2: "Cb",
      3: "Cr",
      4: "R",
      5: "G",
      6: "B"
    }
  };

  function s(e) {
    return !!e.exifdata;
  }

  function i(r, s) {
    function t(e) {
      var t = a(e),
          i = function (e) {
        var t = new DataView(e);
        if (u && console.log("Got file of length " + e.byteLength), 255 !== t.getUint8(0) || 216 !== t.getUint8(1)) return u && console.log("Not a valid JPEG"), !1;

        for (var i, r, s = 2, a = e.byteLength; s < a;) {
          if (r = s, 56 === (i = t).getUint8(r) && 66 === i.getUint8(r + 1) && 73 === i.getUint8(r + 2) && 77 === i.getUint8(r + 3) && 4 === i.getUint8(r + 4) && 4 === i.getUint8(r + 5)) {
            var n = t.getUint8(s + 7);
            n % 2 != 0 && (n += 1), 0 === n && (n = 4);
            var o = s + 8 + n,
                h = t.getUint16(s + 6 + n);
            return d(e, o, h);
          }

          s++;
        }
      }(e);

      r.exifdata = t || {}, r.iptcdata = i || {}, s && s.call(r);
    }

    var i = new FileReader();

    if (r.src) {
      /^data\:/i.test(r.src) ? t(function (e, t) {
        t = t || e.match(/^data\:([^\;]+)\;base64,/im)[1] || "", e = e.replace(/^data\:([^\;]+)\;base64,/gim, "");

        for (var i = atob(e), r = i.length, s = new ArrayBuffer(r), a = new Uint8Array(s), n = 0; n < r; n++) {
          a[n] = i.charCodeAt(n);
        }

        return s;
      }(r.src)) : /^blob\:/i.test(r.src) && (i.onload = function (e) {
        t(e.target.result);
      }, function (e, t) {
        var i = new XMLHttpRequest();
        i.open("GET", e, !0), i.responseType = "blob", i.onload = function (e) {
          200 !== this.status && 0 !== this.status || t(this.response);
        }, i.send();
      }(r.src, function (e) {
        i.readAsArrayBuffer(e);
      }));
      var e = new XMLHttpRequest();
      e.onload = function () {
        if (200 !== this.status && 0 !== this.status) throw "Could not load image";
        t(e.response), e = null;
      }, e.open("GET", r.src, !0), e.responseType = "arraybuffer";

      try {
        e.send(null);
      } catch (e) {}
    } else window.FileReader && (r instanceof window.Blob || r instanceof window.File) && (i.onload = function (e) {
      u && console.log("Got file of length " + e.target.result.byteLength), t(e.target.result);
    }, i.readAsArrayBuffer(r));
  }

  function a(e) {
    var t = new DataView(e);
    if (u && console.log("Got file of length " + e.byteLength), 255 !== t.getUint8(0) || 216 !== t.getUint8(1)) return u && console.log("Not a valid JPEG"), !1;

    for (var i, r = 2, s = e.byteLength; r < s;) {
      if (255 !== t.getUint8(r)) return u && console.log("Not a valid marker at offset " + r + ", found: " + t.getUint8(r)), !1;
      if (i = t.getUint8(r + 1), u && console.log(i), 225 === i) return u && console.log("Found 0xFFE1 marker"), n(t, r + 4, t.getUint16(r + 2));
      r += 2 + t.getUint16(r + 2);
    }
  }

  var f = {
    120: "caption",
    110: "credit",
    25: "keywords",
    55: "dateCreated",
    80: "byline",
    85: "bylineTitle",
    122: "captionWriter",
    105: "headline",
    116: "copyright",
    15: "category"
  };

  function d(e, t, i) {
    for (var r, s, a, n, o = new DataView(e), h = {}, c = t; c < t + i;) {
      28 === o.getUint8(c) && 2 === o.getUint8(c + 1) && (n = o.getUint8(c + 2)) in f && (a = o.getInt16(c + 3), s = f[n], r = w(o, c + 5, a), h.hasOwnProperty(s) ? h[s] instanceof Array ? h[s].push(r) : h[s] = [h[s], r] : h[s] = r), c++;
    }

    return h;
  }

  function v(e, t, i, r, s) {
    var a,
        n,
        o,
        h = e.getUint16(i, !s),
        c = {};

    for (o = 0; o < h; o++) {
      a = i + 12 * o + 2, !(n = r[e.getUint16(a, !s)]) && u && console.log("Unknown tag: " + e.getUint16(a, !s)), c[n] = m(e, a, t, 0, s);
    }

    return c;
  }

  function m(e, t, i, r, s) {
    var a,
        n,
        o,
        h,
        c,
        u,
        l = e.getUint16(t + 2, !s),
        g = e.getUint32(t + 4, !s),
        p = e.getUint32(t + 8, !s) + i;

    switch (l) {
      case 1:
      case 7:
        if (1 === g) return e.getUint8(t + 8, !s);

        for (a = 4 < g ? p : t + 8, n = [], h = 0; h < g; h++) {
          n[h] = e.getUint8(a + h);
        }

        return n;

      case 2:
        return w(e, a = 4 < g ? p : t + 8, g - 1);

      case 3:
        if (1 === g) return e.getUint16(t + 8, !s);

        for (a = 2 < g ? p : t + 8, n = [], h = 0; h < g; h++) {
          n[h] = e.getUint16(a + 2 * h, !s);
        }

        return n;

      case 4:
        if (1 === g) return e.getUint32(t + 8, !s);

        for (n = [], h = 0; h < g; h++) {
          n[h] = e.getUint32(p + 4 * h, !s);
        }

        return n;

      case 5:
        if (1 === g) return c = e.getUint32(p, !s), u = e.getUint32(p + 4, !s), (o = {}).numerator = c, o.denominator = u, o;

        for (n = [], h = 0; h < g; h++) {
          c = e.getUint32(p + 8 * h, !s), u = e.getUint32(p + 4 + 8 * h, !s), n[h] = {}, n[h].numerator = c, n[h].denominator = u;
        }

        return n;

      case 9:
        if (1 === g) return e.getInt32(t + 8, !s);

        for (n = [], h = 0; h < g; h++) {
          n[h] = e.getInt32(p + 4 * h, !s);
        }

        return n;

      case 10:
        if (1 === g) return e.getInt32(p, !s) / e.getInt32(p + 4, !s);

        for (n = [], h = 0; h < g; h++) {
          n[h] = e.getInt32(p + 8 * h, !s) / e.getInt32(p + 4 + 8 * h, !s);
        }

        return n;
    }
  }

  function w(e, t, i) {
    for (var r = "", s = t; s < t + i; s++) {
      r += String.fromCharCode(e.getUint8(s));
    }

    return r;
  }

  function n(e, t) {
    if ("Exif" !== w(e, t, 4)) return u && console.log("Not valid EXIF data! " + w(e, t, 4)), !1;
    var i,
        r,
        s,
        a,
        n,
        o = t + 6;
    if (18761 === e.getUint16(o)) i = !1;else {
      if (19789 !== e.getUint16(o)) return u && console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"), !1;
      i = !0;
    }
    if (42 !== e.getUint16(o + 2, !i)) return u && console.log("Not valid TIFF data! (no 0x002A)"), !1;
    var h = e.getUint32(o + 4, !i);
    if (h < 8) return u && console.log("Not valid TIFF data! (First offset less than 8)", e.getUint32(o + 4, !i)), !1;
    if ((r = v(e, o, o + h, l, i)).ExifIFDPointer) for (s in a = v(e, o, o + r.ExifIFDPointer, c, i)) {
      switch (s) {
        case "LightSource":
        case "Flash":
        case "MeteringMode":
        case "ExposureProgram":
        case "SensingMethod":
        case "SceneCaptureType":
        case "SceneType":
        case "CustomRendered":
        case "WhiteBalance":
        case "GainControl":
        case "Contrast":
        case "Saturation":
        case "Sharpness":
        case "SubjectDistanceRange":
        case "FileSource":
          a[s] = p[s][a[s]];
          break;

        case "ExifVersion":
        case "FlashpixVersion":
          a[s] = String.fromCharCode(a[s][0], a[s][1], a[s][2], a[s][3]);
          break;

        case "ComponentsConfiguration":
          a[s] = p.Components[a[s][0]] + p.Components[a[s][1]] + p.Components[a[s][2]] + p.Components[a[s][3]];
      }

      r[s] = a[s];
    }
    if (r.GPSInfoIFDPointer) for (s in n = v(e, o, o + r.GPSInfoIFDPointer, g, i)) {
      switch (s) {
        case "GPSVersionID":
          n[s] = n[s][0] + "." + n[s][1] + "." + n[s][2] + "." + n[s][3];
      }

      r[s] = n[s];
    }
    return r;
  }

  this.getData = function (e, t) {
    return !((e instanceof Image || e instanceof HTMLImageElement) && !e.complete || (s(e) ? t && t.call(e) : i(e, t), 0));
  }, this.getTag = function (e, t) {
    if (s(e)) return e.exifdata[t];
  }, this.getAllTags = function (e) {
    if (!s(e)) return {};
    var t,
        i = e.exifdata,
        r = {};

    for (t in i) {
      i.hasOwnProperty(t) && (r[t] = i[t]);
    }

    return r;
  }, this.pretty = function (e) {
    if (!s(e)) return "";
    var t,
        i = e.exifdata,
        r = "";

    for (t in i) {
      i.hasOwnProperty(t) && ("object" == _typeof(i[t]) ? i[t] instanceof Number ? r += t + " : " + i[t] + " [" + i[t].numerator + "/" + i[t].denominator + "]\r\n" : r += t + " : [" + i[t].length + " values]\r\n" : r += t + " : " + i[t] + "\r\n");
    }

    return r;
  }, this.readFromBinaryFile = function (e) {
    return a(e);
  };
}]), angular.module("uiCropper").factory("cropHost", ["$document", "$q", "cropAreaCircle", "cropAreaSquare", "cropAreaRectangle", "cropEXIF", function (P, A, B, H, U, L) {
  function F(e) {
    var t = e.getBoundingClientRect(),
        i = document.body,
        r = document.documentElement,
        s = window.pageYOffset || r.scrollTop || i.scrollTop,
        a = window.pageXOffset || r.scrollLeft || i.scrollLeft,
        n = r.clientTop || i.clientTop || 0,
        o = r.clientLeft || i.clientLeft || 0,
        h = t.top + s - n,
        c = t.left + a - o;
    return {
      top: Math.round(h),
      left: Math.round(c)
    };
  }

  var N = 8;
  return function (p, s, f) {
    var d = null,
        v = null,
        m = null,
        u = null,
        l = null,
        g = this,
        w = [100, 100],
        y = [300, 300],
        _ = null,
        i = [],
        r = {
      w: 200,
      h: 200
    },
        a = null,
        z = "image/png",
        n = null,
        o = {
      up: 38,
      down: 40,
      left: 37,
      right: 39
    },
        S = !1;

    function C() {
      d.clearRect(0, 0, d.canvas.width, d.canvas.height), null !== v && (d.drawImage(v, 0, 0, d.canvas.width, d.canvas.height), d.save(), m._disableCrop || (d.fillStyle = "rgba(0, 0, 0, 0.65)", d.fillRect(0, 0, d.canvas.width, d.canvas.height), d.restore()), m.draw());
    }

    function x() {
      p[0].focus();
    }

    function I(e, t) {
      var i = e / t,
          r = [e, t],
          s = {
        left: 0,
        top: 0
      };
      return r[0] > y[0] ? (r[0] = y[0], r[1] = r[0] / i, s.top = (y[1] - r[1]) / 2) : (r[1] > y[1] ? (r[1] = y[1], r[0] = r[1] * i) : s.top = (y[1] - r[1]) / 2, s.left = (y[0] - r[0]) / 2), {
        dims: r,
        margins: s
      };
    }

    function b() {
      var e = [0, 0];

      if (null !== v) {
        if (x(), m.setImage(v), "fit" === _) {
          var t = I(v.width, v.height);
          e = t.dims;
          var i = t.margins;
          p.css({
            "margin-left": i.left + "px",
            "margin-top": i.top + "px"
          });
        } else {
          var r = [v.width, v.height],
              s = v.width / v.height;
          (e = r)[0] > y[0] ? (e[0] = y[0], e[1] = e[0] / s) : e[0] < w[0] && (e[0] = w[0], e[1] = e[0] / s), "fixed-height" === _ && e[1] > y[1] ? (e[1] = y[1], e[0] = e[1] * s) : e[1] < w[1] && (e[1] = w[1], e[0] = e[1] * s);
        }

        p.prop("width", e[0]).prop("height", e[1]), "fixed-height" === _ && p.css({
          "margin-left": -e[0] / 2 + "px",
          "margin-top": -e[1] / 2 + "px"
        });
        var a = d.canvas.width,
            n = d.canvas.height,
            o = g.getAreaType();
        if ("circle" === o || "square" === o) n < a && (a = n), n = a;else if ("rectangle" === o && l) {
          var h = m.getAspect();
          h < a / n ? a = h * n : n = h * a;
        }
        if (u ? m.setSize({
          w: a,
          h: n
        }) : void 0 !== m.getInitSize() ? m.setSize({
          w: Math.min(m.getInitSize().w, a / 2),
          h: Math.min(m.getInitSize().h, n / 2)
        }) : m.setSize({
          w: Math.min(200, a / 2),
          h: Math.min(200, n / 2)
        }), m.getInitCoords()) {
          if (g.areaInitIsRelativeToImage) {
            var c = v.width / e[0];
            m.setSize({
              w: m.getInitSize().w / c,
              h: m.getInitSize().h / c,
              x: m.getInitCoords().x / c,
              y: m.getInitCoords().y / c
            });
          } else m.setSize({
            w: m.getSize().w,
            h: m.getSize().h,
            x: m.getInitCoords().x,
            y: m.getInitCoords().y
          });
        } else m.setCenterPoint({
          x: d.canvas.width / 2,
          y: d.canvas.height / 2
        });
      } else p.prop("width", 0).prop("height", 0).css({
        "margin-top": 0
      });

      C();
    }

    function h(e) {
      return angular.isDefined(e.changedTouches) ? e.changedTouches : e.originalEvent.changedTouches;
    }

    function e(e) {
      if (!m._disableCrop && null !== v) {
        var t,
            i,
            r = F(d.canvas);
        i = "touchmove" === e.type ? (t = h(e)[0].pageX, h(e)[0].pageY) : (t = e.pageX, e.pageY), m.processMouseMove(t - r.left, i - r.top), C();
      }
    }

    function t(e) {
      if (e.preventDefault(), !m._disableCrop && (s.allowPropagation || e.stopPropagation(), null !== v)) {
        x();
        var t,
            i,
            r = F(d.canvas);
        i = "touchstart" === e.type ? (t = h(e)[0].pageX, h(e)[0].pageY) : (t = e.pageX, e.pageY), m.processMouseDown(t - r.left, i - r.top), C();
      }
    }

    function c(e) {
      if (!m._disableCrop && null !== v) {
        var t,
            i,
            r = F(d.canvas);
        i = "touchend" === e.type ? (t = h(e)[0].pageX, h(e)[0].pageY) : (t = e.pageX, e.pageY), m.processMouseUp(t - r.left, i - r.top), C();
      }
    }

    function R(e) {
      if (!m._disableCrop && null !== v && !0 !== s.disableKeyboardAccess) {
        var t = e.which;

        switch (t) {
          case o.up:
          case o.down:
          case o.left:
          case o.right:
            e.preventDefault(), e.stopPropagation();

            var i = function (i) {
              return Object.keys(o).reduce(function (e, t) {
                return i === o[t] ? t : e;
              }, null);
            }(t);

            e.shiftKey ? function (e) {
              if (!m._disableCrop) {
                var t;

                switch (e) {
                  case "up":
                  case "left":
                    t = .95;
                    break;

                  case "down":
                  case "right":
                    t = 1.05;
                    break;

                  default:
                    return;
                }

                m.setSizeByScale(t, e), C();
              }
            }(i) : function (e) {
              if (!m._disableCrop) {
                var t = m.getCenterPoint(),
                    i = {
                  x: t.x,
                  y: t.y
                };

                switch (e) {
                  case "up":
                    i.y -= 5;
                    break;

                  case "down":
                    i.y += 5;
                    break;

                  case "left":
                    i.x -= 5;
                    break;

                  case "right":
                    i.x += 5;
                    break;

                  default:
                    return;
                }

                m.setCenterPointOnMove(i), C();
              }
            }(i);
            break;

          default:
            return;
        }
      }
    }

    function D(e, t) {
      var i, r;

      if (i = (r = angular.element("<canvas></canvas>")[0]).getContext("2d"), r.width = e.w, r.height = e.h, null !== v) {
        var s = (t.x - m.getSize().w / 2) * (v.width / d.canvas.width),
            a = (t.y - m.getSize().h / 2) * (v.height / d.canvas.height),
            n = m.getSize().w * (v.width / d.canvas.width),
            o = m.getSize().h * (v.height / d.canvas.height);
        if (S) i.drawImage(v, s, a, n, o, 0, 0, e.w, e.h);else {
          var h,
              c,
              u = n / o;
          1 < u ? h = (c = e.w) / u : c = (h = e.h) * u, r.width = c, r.height = h, i.drawImage(v, s, a, n, o, 0, 0, Math.round(c), Math.round(h));
        }
      }

      return r;
    }

    function M(e) {
      var t,
          i = {
        dataURI: null,
        imageData: null
      };
      return t = D(e, m.getCenterPoint()), null !== v && (i.dataURI = null !== n ? t.toDataURL(z, n) : t.toDataURL(z)), i;
    }

    this.setInitMax = function (e) {
      u = e;
    }, this.setAllowCropResizeOnCorners = function (e) {
      m.setAllowCropResizeOnCorners(e);
    }, this.setDisableCrop = function (e) {
      m.setDisableCrop(e), C();
    }, this.getResultImage = function () {
      if (0 === i.length) return M(this.getResultImageSize());

      for (var e = [], t = 0; t < i.length; t++) {
        e.push({
          dataURI: M(i[t]).dataURI,
          w: i[t].w,
          h: i[t].h
        });
      }

      return e;
    }, this.getResultImageDataBlob = function () {
      var e,
          t = A.defer();
      return e = D(this.getResultImageSize(), m.getCenterPoint()), null !== n ? e.toBlob(function (e) {
        t.resolve(e);
      }, z, n) : e.toBlob(function (e) {
        t.resolve(e);
      }, z), t.promise;
    }, this.getAreaCoords = function () {
      return m.getSize();
    }, this.getArea = function () {
      return m;
    }, this.setNewImageSource = function (e) {
      if (v = null, b(), e) {
        var g = new Image();
        g.onload = function () {
          f.trigger("load-done"), L.getData(g, function () {
            var e = L.getTag(g, "Orientation");

            if (-1 < [3, 6, 8].indexOf(e)) {
              var t = document.createElement("canvas"),
                  i = t.getContext("2d"),
                  r = g.width,
                  s = g.height,
                  a = 0,
                  n = 0,
                  o = 0,
                  h = 0,
                  c = 0;

              switch (h = r, c = s, e) {
                case 3:
                  a = -g.width, n = -g.height, o = 180;
                  break;

                case 6:
                  r = g.height, s = g.width, n = -g.height, h = s, c = r, o = 90;
                  break;

                case 8:
                  r = g.height, s = g.width, a = -g.width, h = s, c = r, o = 270;
              }

              var u = 1e3;

              if (u < r || u < s) {
                var l = 0;
                u < r ? (l = u / r, r = u, s *= l) : u < s && (l = u / s, s = u, r *= l), n *= l, a *= l, h *= l, c *= l;
              }

              t.width = r, t.height = s, i.rotate(o * Math.PI / 180), i.drawImage(g, a, n, h, c), (v = new Image()).onload = function () {
                b(), f.trigger("image-updated");
              }, v.src = t.toDataURL(z);
            } else v = g, f.trigger("image-updated");

            b();
          });
        }, g.onerror = function () {
          f.trigger("load-error");
        }, f.trigger("load-start"), e instanceof window.Blob ? g.src = URL.createObjectURL(e) : ("http" !== e.substring(0, 4).toLowerCase() && "//" !== e.substring(0, 2) || (g.crossOrigin = "anonymous"), g.src = e);
      }
    }, this.setMaxDimensions = function (e, t) {
      if (y = [e, t], null !== v) {
        var i = d.canvas.width,
            r = d.canvas.height,
            s = [0, 0];

        if ("fit" === _) {
          var a = I(v.width, v.height);
          s = a.dims;
          var n = a.margins;
          p.css({
            "margin-left": n.left + "px",
            "margin-top": n.top + "px"
          });
        } else {
          var o = [v.width, v.height],
              h = v.width / v.height;
          (s = o)[0] > y[0] ? (s[0] = y[0], s[1] = s[0] / h) : s[0] < w[0] && (s[0] = w[0], s[1] = s[0] / h), "fixed-height" === _ && s[1] > y[1] ? (s[1] = y[1], s[0] = s[1] * h) : s[1] < w[1] && (s[1] = w[1], s[0] = s[1] * h);
        }

        p.prop("width", s[0]).prop("height", s[1]), "fixed-height" === _ && p.css({
          "margin-left": -s[0] / 2 + "px",
          "margin-top": -s[1] / 2 + "px"
        });
        var c = i ? d.canvas.width / i : 0,
            u = r ? d.canvas.height / r : 0,
            l = Math.min(c, u),
            g = m.getCenterPoint();
        m.setSize({
          w: m.getSize().w * l,
          h: m.getSize().h * l
        }), m.setCenterPoint({
          x: g.x * c,
          y: g.y * u
        });
      } else p.prop("width", 0).prop("height", 0).css({
        "margin-top": 0
      });

      C();
    }, this.setAreaMinSize = function (e) {
      angular.isUndefined(e) || (e = "number" == typeof e || "string" == typeof e ? {
        w: parseInt(parseInt(e), 10),
        h: parseInt(parseInt(e), 10)
      } : {
        w: parseInt(e.w, 10),
        h: parseInt(e.h, 10)
      }, isNaN(e.w) || isNaN(e.h) || (m.setMinSize(e), C()));
    }, this.setAreaMinRelativeSize = function (e) {
      if (null !== v && !angular.isUndefined(e)) {
        var t = m.getCanvasSize();
        e = "number" == typeof e || "string" == typeof e ? (a = {
          w: e,
          h: e
        }, {
          w: t.w / (v.width / parseInt(parseInt(e), 10)),
          h: t.h / (v.height / parseInt(parseInt(e), 10))
        }) : (a = e, {
          w: t.w / (v.width / parseInt(parseInt(e.w), 10)),
          h: t.h / (v.height / parseInt(parseInt(e.h), 10))
        }), isNaN(e.w) || isNaN(e.h) || (m.setMinSize(e), C());
      }
    }, this.setAreaInitSize = function (e) {
      angular.isUndefined(e) || (e = "number" == typeof e || "string" == typeof e ? {
        w: parseInt(parseInt(e), 10),
        h: parseInt(parseInt(e), 10)
      } : {
        w: parseInt(e.w, 10),
        h: parseInt(e.h, 10)
      }, isNaN(e.w) || isNaN(e.h) || (m.setInitSize(e), C()));
    }, this.setAreaInitCoords = function (e) {
      angular.isUndefined(e) || (e = {
        x: parseInt(e.x, 10),
        y: parseInt(e.y, 10)
      }, isNaN(e.x) || isNaN(e.y) || (m.setInitCoords(e), C()));
    }, this.setMaxCanvasDimensions = function (e) {
      if (!angular.isUndefined(e)) {
        var t = [];
        t = "number" == typeof e || "string" == typeof e ? [parseInt(parseInt(e), 10), parseInt(parseInt(e), 10)] : [parseInt(e.w, 10), parseInt(e.h, 10)], !isNaN(t[0]) && 0 < t[0] && t[0] > w[0] && !isNaN(t[1]) && 0 < t[1] && t[1] > w[1] && (y = t);
      }
    }, this.setMinCanvasDimensions = function (e) {
      if (!angular.isUndefined(e)) {
        var t = [];
        t = "number" == typeof e || "string" == typeof e ? [parseInt(parseInt(e), 10), parseInt(parseInt(e), 10)] : [parseInt(e.w, 10), parseInt(e.h, 10)], !isNaN(t[0]) && 0 <= t[0] && !isNaN(t[1]) && 0 <= t[1] && (w = t);
      }
    }, this.setScalemode = function (e) {
      _ = e;
    }, this.getScalemode = function () {
      return _;
    }, this.getResultImageSize = function () {
      if ("selection" === r) return m.getSize();
      if ("max" !== r) return r;
      var e = 1;
      v && d && d.canvas && (e = v.width / d.canvas.width);
      var t = {
        w: e * m.getSize().w,
        h: e * m.getSize().h
      };
      return a && (t.w < a.w && (t.w = a.w), t.h < a.h && (t.h = a.h)), t;
    }, this.setResultImageSize = function (e) {
      if (angular.isArray(e)) return i = e.slice(), void (e = {
        w: parseInt(e[0].w, 10),
        h: parseInt(e[0].h, 10)
      });
      angular.isUndefined(e) || (angular.isString(e) ? r = e : (angular.isNumber(e) && (e = {
        w: e = parseInt(e, 10),
        h: e
      }), e = {
        w: parseInt(e.w, 10),
        h: parseInt(e.h, 10)
      }, isNaN(e.w) || isNaN(e.h) || (r = e, C())));
    }, this.setResultImageFormat = function (e) {
      z = e;
    }, this.setResultImageQuality = function (e) {
      e = parseFloat(e), !isNaN(e) && 0 <= e && e <= 1 && (n = e);
    }, this.getAreaType = function () {
      return m.getType();
    }, this.setAreaType = function (e) {
      var t = m.getCenterPoint(),
          i = m.getSize(),
          r = m.getMinSize(),
          s = t.x,
          a = t.y,
          n = B;
      "square" === e ? n = H : "rectangle" === e && (n = U), (m = new n(d, f)).setMinSize(r), m.setSize(i), "square" === e || "circle" === e ? (S = !0, m.setForceAspectRatio(!0)) : (S = !1, m.setForceAspectRatio(!1)), m.setCenterPoint({
        x: s,
        y: a
      }), null !== v && m.setImage(v), C();
    }, this.getDominantColor = function (e) {
      var t = new Image(),
          i = new ColorThief(),
          r = null,
          s = A.defer();
      return t.src = e, t.onload = function () {
        r = i.getColor(t), s.resolve(r);
      }, s.promise;
    }, this.getPalette = function (e) {
      var t = new Image(),
          i = new ColorThief(),
          r = null,
          s = A.defer();
      return t.src = e, t.onload = function () {
        r = i.getPalette(t, N), s.resolve(r);
      }, s.promise;
    }, this.setPaletteColorLength = function (e) {
      N = e;
    }, this.setAspect = function (e) {
      l = !0, m.setAspect(e);
      var t = m.getMinSize();
      t.w = t.h * e, m.setMinSize(t);
      var i = m.getSize();
      i.w = i.h * e, m.setSize(i);
    }, d = p[0].getContext("2d"), m = new B(d, f), P.on("mousemove", e), p.on("mousedown", t), P.on("mouseup", c), P.on("touchmove", e), p.on("touchstart", t), P.on("touchend", c), p.prop("tabindex", "0"), p.on("keydown", R), this.destroy = function () {
      P.off("mousemove", e), p.off("mousedown", t), P.off("mouseup", c), P.off("touchmove", e), p.off("touchstart", t), P.off("touchend", c), p.off("keydown", R), p.remove();
    };
  };
}]), angular.module("uiCropper").factory("cropPubSub", [function () {
  return function () {
    var i = {};
    this.on = function (e, t) {
      return e.split(" ").forEach(function (e) {
        i[e] || (i[e] = []), i[e].push(t);
      }), this;
    }, this.trigger = function (e, t) {
      return angular.forEach(i[e], function (e) {
        e.call(null, t);
      }), this;
    };
  };
}]), angular.module("uiCropper").directive("uiCropper", ["$timeout", "cropHost", "cropPubSub", function (h, c, t) {
  return {
    restrict: "E",
    scope: {
      image: "=",
      resultImage: "=",
      resultArrayImage: "=?",
      resultBlob: "=?",
      urlBlob: "=?",
      chargement: "=?",
      cropject: "=?",
      maxCanvasDimensions: "=?",
      minCanvasDimensions: "=?",
      canvasScalemode: "@?",
      changeOnFly: "=?",
      disableKeyboardAccess: "=?",
      allowPropagation: "=?",
      liveView: "=?",
      initMaxArea: "=?",
      areaCoords: "=?",
      areaType: "@",
      areaMinSize: "=?",
      areaInitSize: "=?",
      areaInitCoords: "=?",
      areaInitIsRelativeToImage: "=?",
      areaMinRelativeSize: "=?",
      resultImageSize: "=?",
      resultImageFormat: "@",
      resultImageQuality: "=?",
      aspectRatio: "=?",
      allowCropResizeOnCorners: "=?",
      dominantColor: "=?",
      paletteColor: "=?",
      paletteColorLength: "=?",
      disableCrop: "=?",
      onChange: "&",
      onLoadBegin: "&",
      onLoadDone: "&",
      onLoadError: "&"
    },
    template: "<canvas></canvas>",
    controller: ["$scope", function (e) {
      e.events = new t();
    }],
    link: function link(i, r) {
      var n,
          e = i.events,
          o = new c(r.find("canvas"), {
        disableKeyboardAccess: i.disableKeyboardAccess,
        allowPropagation: i.allowPropagation
      }, e);

      function t(t, e, i) {
        if ("" !== t.image && (!t.liveView.block || e)) {
          var r,
              s = o.getResultImage();
          angular.isArray(s) ? (r = s[0].dataURI, t.resultArrayImage = s) : r = s.dataURI;
          var a = window.URL || window.webkitURL;
          n !== r && (n = r, t.resultImage = r, t.liveView.callback && t.liveView.callback(r), i && i(r), o.getResultImageDataBlob().then(function (e) {
            t.resultBlob = e, t.urlBlob = e ? a.createObjectURL(e) : null;
          }), t.resultImage && (o.getDominantColor(t.resultImage).then(function (e) {
            t.dominantColor = e;
          }), o.getPalette(t.resultImage).then(function (e) {
            t.paletteColor = e;
          })), function (e) {
            e.areaCoords = o.getAreaCoords();
          }(t), t.onChange({
            $dataURI: t.resultImage
          }));
        }
      }

      function s(e) {
        var t = o.getAreaCoords(),
            i = o.getArea().getImage().width / o.getArea().getCanvasSize().w,
            r = o.getArea().getImage().height / o.getArea().getCanvasSize().h;
        e.cropject = {
          canvasSize: o.getArea().getCanvasSize(),
          areaCoords: t,
          cropWidth: t.w,
          cropHeight: t.h,
          cropTop: t.y,
          cropLeft: t.x,
          cropImageWidth: Math.round(t.w * i),
          cropImageHeight: Math.round(t.h * r),
          cropImageTop: Math.round(t.y * r),
          cropImageLeft: Math.round(t.x * i)
        };
      }

      function a(t) {
        return function () {
          h(function () {
            i.$apply(function (e) {
              t(e);
            });
          });
        };
      }

      i.canvasScalemode ? o.setScalemode(i.canvasScalemode) : o.setScalemode("fixed-height"), r.addClass(o.getScalemode()), i.liveView && "boolean" == typeof i.liveView.block ? i.liveView.render = function (e) {
        t(i, !0, e);
      } : i.liveView = {
        block: !1
      }, i.chargement || (i.chargement = function () {
        switch (window.navigator.userLanguage || window.navigator.language) {
          case "nl":
          case "nl_NL":
            return "Aan het laden";

          case "fr":
          case "fr-FR":
            return "Chargement";

          case "es":
          case "es-ES":
            return "Cargando";

          case "ca":
          case "ca-ES":
            return "Càrrega";

          case "de":
          case "de-DE":
            return "Laden";

          case "pt":
          case "pt-BR":
            return "Carregando";

          default:
            return "Loading";
        }
      }()), e.on("load-start", a(function (e) {
        e.onLoadBegin({});
      })).on("load-done", a(function (e) {
        var t = r.children();
        angular.forEach(t, function (e) {
          angular.element(e).hasClass("loading") && angular.element(e).remove();
        }), s(e), e.onLoadDone({});
      })).on("load-error", a(function (e) {
        e.onLoadError({});
      })).on("area-move area-resize", a(function (e) {
        !0 === e.changeOnFly && t(e), s(e);
      })).on("image-updated", a(function (e) {
        o.setAreaMinRelativeSize(e.areaMinRelativeSize);
      })).on("area-move-end area-resize-end image-updated", a(function (e) {
        t(e), s(e);
      })), i.$watch("image", function (e) {
        o.getArea() && (o.getArea()._size = {
          x: 0,
          y: 0,
          w: 0,
          h: 0
        }), e && r.append('<div class="loading"><span>' + i.chargement + "...</span></div>"), null !== i.timeout && h.cancel(i.timeout), i.timeout = h(function () {
          i.timeout = null, o.setInitMax(i.initMaxArea), o.setNewImageSource(i.image);
        }, 100);
      }), i.$watch("areaType", function () {
        o.setAreaType(i.areaType), t(i);
      }), i.$watch("areaMinSize", function () {
        o.setAreaMinSize(i.areaMinSize), t(i);
      }), i.$watch("areaMinRelativeSize", function () {
        "" !== i.image && (o.setAreaMinRelativeSize(i.areaMinRelativeSize), t(i));
      }), i.$watch("areaInitSize", function () {
        o.setAreaInitSize(i.areaInitSize), t(i);
      }), i.$watch("areaInitCoords", function () {
        o.setAreaInitCoords(i.areaInitCoords), o.areaInitIsRelativeToImage = i.areaInitIsRelativeToImage, t(i);
      }), i.$watch("maxCanvasDimensions", function () {
        o.setMaxCanvasDimensions(i.maxCanvasDimensions);
      }), i.$watch("minCanvasDimensions", function () {
        o.setMinCanvasDimensions(i.minCanvasDimensions);
      }), i.$watch("resultImageFormat", function () {
        o.setResultImageFormat(i.resultImageFormat), t(i);
      }), i.$watch("resultImageQuality", function () {
        o.setResultImageQuality(i.resultImageQuality), t(i);
      }), i.$watch("resultImageSize", function () {
        o.setResultImageSize(i.resultImageSize), t(i);
      }), i.$watch("paletteColorLength", function () {
        o.setPaletteColorLength(i.paletteColorLength);
      }), i.$watch("aspectRatio", function () {
        "string" == typeof i.aspectRatio && "" !== i.aspectRatio && (i.aspectRatio = parseFloat(i.aspectRatio)), i.aspectRatio && o.setAspect(i.aspectRatio);
      }), i.$watch("allowCropResizeOnCorners", function () {
        i.allowCropResizeOnCorners && o.setAllowCropResizeOnCorners(i.allowCropResizeOnCorners);
      }), i.$watch("disableCrop", function () {
        o.setDisableCrop(i.disableCrop);
      }), i.$watch(function () {
        return "fit" === o.getScalemode() ? [r[0].clientWidth, r[0].clientHeight] : "fixed-height" === o.getScalemode() ? [r[0].clientWidth, r[0].clientHeight] : "full-width" === o.getScalemode() ? r[0].clientWidth : void 0;
      }, function (e) {
        "fit" === o.getScalemode() && (o.setMaxDimensions(e[0], e[1]), t(i)), "fixed-height" === o.getScalemode() && 0 < e[0] && 0 < e[1] && (o.setMaxDimensions(e[0], e[1]), t(i)), "full-width" === o.getScalemode() && 0 < e && o.setMaxDimensions(e);
      }, !0), i.$on("$destroy", function () {
        o.destroy();
      });
    }
  };
}]), function (e) {
  "use strict";

  var u,
      l = e.Uint8Array,
      t = e.HTMLCanvasElement,
      i = t && t.prototype,
      h = /\s*;\s*base64\s*(?:;|$)/i,
      c = "toDataURL";
  l && (u = new l([62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51])), t && !i.toBlob && (i.toBlob = function (e, t) {
    if (t || (t = "image/png"), this.mozGetAsFile) e(this.mozGetAsFile("canvas", t));else if (this.msToBlob && /^\s*image\/png\s*(?:$|;)/i.test(t)) e(this.msToBlob());else {
      var i,
          r = Array.prototype.slice.call(arguments, 1),
          s = this[c].apply(this, r),
          a = s.indexOf(","),
          n = s.substring(a + 1),
          o = h.test(s.substring(0, a));
      Blob.fake ? ((i = new Blob()).encoding = o ? "base64" : "URI", i.data = n, i.size = n.length) : l && (i = o ? new Blob([function (e) {
        for (var t, i, r = e.length, s = new l(r / 4 * 3 | 0), a = 0, n = 0, o = [0, 0], h = 0, c = 0; r--;) {
          i = e.charCodeAt(a++), 255 !== (t = u[i - 43]) && void 0 !== t && (o[1] = o[0], o[0] = i, c = c << 6 | t, 4 === ++h && (s[n++] = c >>> 16, 61 !== o[1] && (s[n++] = c >>> 8), 61 !== o[0] && (s[n++] = c), h = 0));
        }

        return s;
      }(n)], {
        type: t
      }) : new Blob([decodeURIComponent(n)], {
        type: t
      })), void 0 !== e && e(i);
    }
  }, i.toDataURLHD ? i.toBlobHD = function () {
    c = "toDataURLHD";
    var e = this.toBlob();
    return c = "toDataURL", e;
  } : i.toBlobHD = i.toBlob);
}("undefined" != typeof self && self || "undefined" != typeof window && window || this.content || this), function () {
  function f(e) {
    this.canvas = document.createElement("canvas"), this.context = this.canvas.getContext("2d"), document.body.appendChild(this.canvas), this.width = this.canvas.width = e.width, this.height = this.canvas.height = e.height, this.context.drawImage(e, 0, 0, this.width, this.height);
  }

  f.prototype.clear = function () {
    this.context.clearRect(0, 0, this.width, this.height);
  }, f.prototype.update = function (e) {
    this.context.putImageData(e, 0, 0);
  }, f.prototype.getPixelCount = function () {
    return this.width * this.height;
  }, f.prototype.getImageData = function () {
    return this.context.getImageData(0, 0, this.width, this.height);
  }, f.prototype.removeCanvas = function () {
    this.canvas.parentNode.removeChild(this.canvas);
  };

  function e() {}

  if ((window.ColorThief = e).prototype.getColor = function (e, t) {
    return this.getPalette(e, 5, t)[0];
  }, e.prototype.getPalette = function (e, t, i) {
    void 0 === t && (t = 10), (void 0 === i || i < 1) && (i = 10);

    for (var r, s, a, n, o = new f(e), h = o.getImageData().data, c = o.getPixelCount(), u = [], l = 0; l < c; l += i) {
      s = h[0 + (r = 4 * l)], a = h[1 + r], n = h[2 + r], 125 <= h[3 + r] && (250 < s && 250 < a && 250 < n || u.push([s, a, n]));
    }

    var g = v.quantize(u, t),
        p = g ? g.palette() : null;
    return o.removeCanvas(), p;
  }, !d) var d = {
    map: function map(e, i) {
      var r = {};
      return i ? e.map(function (e, t) {
        return r.index = t, i.call(r, e);
      }) : e.slice();
    },
    naturalOrder: function naturalOrder(e, t) {
      return e < t ? -1 : t < e ? 1 : 0;
    },
    sum: function sum(e, r) {
      var s = {};
      return e.reduce(r ? function (e, t, i) {
        return s.index = i, e + r.call(s, t);
      } : function (e, t) {
        return e + t;
      }, 0);
    },
    max: function max(e, t) {
      return Math.max.apply(null, t ? d.map(e, t) : e);
    }
  };
  var g,
      l,
      v = (l = 8 - (g = 5), p.prototype = {
    volume: function volume(e) {
      var t = this;
      return t._volume && !e || (t._volume = (t.r2 - t.r1 + 1) * (t.g2 - t.g1 + 1) * (t.b2 - t.b1 + 1)), t._volume;
    },
    count: function count(e) {
      var t = this,
          i = t.histo;

      if (!t._count_set || e) {
        var r,
            s,
            a,
            n = 0;

        for (r = t.r1; r <= t.r2; r++) {
          for (s = t.g1; s <= t.g2; s++) {
            for (a = t.b1; a <= t.b2; a++) {
              n += i[m(r, s, a)] || 0;
            }
          }
        }

        t._count = n, t._count_set = !0;
      }

      return t._count;
    },
    copy: function copy() {
      var e = this;
      return new p(e.r1, e.r2, e.g1, e.g2, e.b1, e.b2, e.histo);
    },
    avg: function avg(e) {
      var t = this,
          i = t.histo;

      if (!t._avg || e) {
        var r,
            s,
            a,
            n,
            o = 0,
            h = 1 << 8 - g,
            c = 0,
            u = 0,
            l = 0;

        for (s = t.r1; s <= t.r2; s++) {
          for (a = t.g1; a <= t.g2; a++) {
            for (n = t.b1; n <= t.b2; n++) {
              o += r = i[m(s, a, n)] || 0, c += r * (s + .5) * h, u += r * (a + .5) * h, l += r * (n + .5) * h;
            }
          }
        }

        t._avg = o ? [~~(c / o), ~~(u / o), ~~(l / o)] : [~~(h * (t.r1 + t.r2 + 1) / 2), ~~(h * (t.g1 + t.g2 + 1) / 2), ~~(h * (t.b1 + t.b2 + 1) / 2)];
      }

      return t._avg;
    },
    contains: function contains(e) {
      var t = this,
          i = e[0] >> l;
      return gval = e[1] >> l, bval = e[2] >> l, i >= t.r1 && i <= t.r2 && gval >= t.g1 && gval <= t.g2 && bval >= t.b1 && bval <= t.b2;
    }
  }, c.prototype = {
    push: function push(e) {
      this.vboxes.push({
        vbox: e,
        color: e.avg()
      });
    },
    palette: function palette() {
      return this.vboxes.map(function (e) {
        return e.color;
      });
    },
    size: function size() {
      return this.vboxes.size();
    },
    map: function map(e) {
      for (var t = this.vboxes, i = 0; i < t.size(); i++) {
        if (t.peek(i).vbox.contains(e)) return t.peek(i).color;
      }

      return this.nearest(e);
    },
    nearest: function nearest(e) {
      for (var t, i, r, s = this.vboxes, a = 0; a < s.size(); a++) {
        ((i = Math.sqrt(Math.pow(e[0] - s.peek(a).color[0], 2) + Math.pow(e[1] - s.peek(a).color[1], 2) + Math.pow(e[2] - s.peek(a).color[2], 2))) < t || void 0 === t) && (t = i, r = s.peek(a).color);
      }

      return r;
    },
    forcebw: function forcebw() {
      var e = this.vboxes;
      e.sort(function (e, t) {
        return d.naturalOrder(d.sum(e.color), d.sum(t.color));
      });
      var t = e[0].color;
      t[0] < 5 && t[1] < 5 && t[2] < 5 && (e[0].color = [0, 0, 0]);
      var i = e.length - 1,
          r = e[i].color;
      251 < r[0] && 251 < r[1] && 251 < r[2] && (e[i].color = [255, 255, 255]);
    }
  }, {
    quantize: function quantize(e, t) {
      if (!e.length || t < 2 || 256 < t) return !1;

      var h = function (e) {
        var t,
            i,
            r,
            s,
            a = new Array(1 << 3 * g);
        return e.forEach(function (e) {
          i = e[0] >> l, r = e[1] >> l, s = e[2] >> l, t = m(i, r, s), a[t] = (a[t] || 0) + 1;
        }), a;
      }(e);

      h.forEach(function () {});

      var i = function (e, t) {
        var i,
            r,
            s,
            a = 1e6,
            n = 0,
            o = 1e6,
            h = 0,
            c = 1e6,
            u = 0;
        return e.forEach(function (e) {
          i = e[0] >> l, r = e[1] >> l, s = e[2] >> l, i < a ? a = i : n < i && (n = i), r < o ? o = r : h < r && (h = r), s < c ? c = s : u < s && (u = s);
        }), new p(a, n, o, h, c, u, t);
      }(e, h),
          r = new o(function (e, t) {
        return d.naturalOrder(e.count(), t.count());
      });

      function s(e, t) {
        for (var i, r = 1, s = 0; s < 1e3;) {
          if ((i = e.pop()).count()) {
            var a = u(h, i),
                n = a[0],
                o = a[1];
            if (!n) return;
            if (e.push(n), o && (e.push(o), r++), t <= r) return;
            if (1e3 < s++) return;
          } else e.push(i), s++;
        }
      }

      r.push(i), s(r, .75 * t);

      for (var a = new o(function (e, t) {
        return d.naturalOrder(e.count() * e.volume(), t.count() * t.volume());
      }); r.size();) {
        a.push(r.pop());
      }

      s(a, t - a.size());

      for (var n = new c(); a.size();) {
        n.push(a.pop());
      }

      return n;
    }
  });

  function m(e, t, i) {
    return (e << 2 * g) + (t << g) + i;
  }

  function o(e) {
    var t = [],
        i = !1;

    function r() {
      t.sort(e), i = !0;
    }

    return {
      push: function push(e) {
        t.push(e), i = !1;
      },
      peek: function peek(e) {
        return i || r(), void 0 === e && (e = t.length - 1), t[e];
      },
      pop: function pop() {
        return i || r(), t.pop();
      },
      size: function size() {
        return t.length;
      },
      map: function map(e) {
        return t.map(e);
      },
      debug: function debug() {
        return i || r(), t;
      }
    };
  }

  function p(e, t, i, r, s, a, n) {
    var o = this;
    o.r1 = e, o.r2 = t, o.g1 = i, o.g2 = r, o.b1 = s, o.b2 = a, o.histo = n;
  }

  function c() {
    this.vboxes = new o(function (e, t) {
      return d.naturalOrder(e.vbox.count() * e.vbox.volume(), t.vbox.count() * t.vbox.volume());
    });
  }

  function u(e, c) {
    if (c.count()) {
      var t = c.r2 - c.r1 + 1,
          i = c.g2 - c.g1 + 1,
          r = c.b2 - c.b1 + 1,
          s = d.max([t, i, r]);
      if (1 == c.count()) return [c.copy()];
      var u,
          a,
          n,
          o,
          l = 0,
          g = [],
          p = [];
      if (s == t) for (u = c.r1; u <= c.r2; u++) {
        for (o = 0, a = c.g1; a <= c.g2; a++) {
          for (n = c.b1; n <= c.b2; n++) {
            o += e[m(u, a, n)] || 0;
          }
        }

        l += o, g[u] = l;
      } else if (s == i) for (u = c.g1; u <= c.g2; u++) {
        for (o = 0, a = c.r1; a <= c.r2; a++) {
          for (n = c.b1; n <= c.b2; n++) {
            o += e[m(a, u, n)] || 0;
          }
        }

        l += o, g[u] = l;
      } else for (u = c.b1; u <= c.b2; u++) {
        for (o = 0, a = c.r1; a <= c.r2; a++) {
          for (n = c.g1; n <= c.g2; n++) {
            o += e[m(a, n, u)] || 0;
          }
        }

        l += o, g[u] = l;
      }
      return g.forEach(function (e, t) {
        p[t] = l - e;
      }), h(s == t ? "r" : s == i ? "g" : "b");
    }

    function h(e) {
      var t,
          i,
          r,
          s,
          a,
          n = e + "1",
          o = e + "2",
          h = 0;

      for (u = c[n]; u <= c[o]; u++) {
        if (g[u] > l / 2) {
          for (r = c.copy(), s = c.copy(), a = (t = u - c[n]) <= (i = c[o] - u) ? Math.min(c[o] - 1, ~~(u + i / 2)) : Math.max(c[n], ~~(u - 1 - t / 2)); !g[a];) {
            a++;
          }

          for (h = p[a]; !h && g[a - 1];) {
            h = p[--a];
          }

          return r[o] = a, s[n] = r[o] + 1, [r, s];
        }
      }
    }
  }

  "function" == typeof define && define.amd ? define([], function () {
    return e;
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? module.exports = e : this.ColorThief = e;
}.call(this), function () {
  function f(e, t, i, r) {
    var s = e.naturalWidth,
        a = e.naturalHeight;

    if (s + a !== !1) {
      var n = i.width,
          o = i.height,
          h = t.getContext("2d");
      h.save(), function (e, t, i, r, s) {
        switch (s) {
          case 5:
          case 6:
          case 7:
          case 8:
            e.width = r, e.height = i;
            break;

          default:
            e.width = i, e.height = r;
        }

        switch (s) {
          case 2:
            t.translate(i, 0), t.scale(-1, 1);
            break;

          case 3:
            t.translate(i, r), t.rotate(Math.PI);
            break;

          case 4:
            t.translate(0, r), t.scale(1, -1);
            break;

          case 5:
            t.rotate(.5 * Math.PI), t.scale(1, -1);
            break;

          case 6:
            t.rotate(.5 * Math.PI), t.translate(0, -r);
            break;

          case 7:
            t.rotate(.5 * Math.PI), t.translate(i, -r), t.scale(-1, 1);
            break;

          case 8:
            t.rotate(-.5 * Math.PI), t.translate(-i, 0);
        }
      }(t, h, n, o, i.orientation), function (e) {
        var t = e.naturalWidth;

        if (1048576 < t * e.naturalHeight) {
          var i = document.createElement("canvas");
          i.width = i.height = 1;
          var r = i.getContext("2d");
          return r.drawImage(e, 1 - t, 0), 0 === r.getImageData(0, 0, 1, 1).data[3];
        }

        return !1;
      }(e) && (s /= 2, a /= 2);
      var c = 1024,
          u = document.createElement("canvas");
      u.width = u.height = c;

      for (var l = u.getContext("2d"), g = r ? function (e, t, i) {
        var r = document.createElement("canvas");
        r.width = 1, r.height = i;
        var s = r.getContext("2d");
        s.drawImage(e, 0, 0);

        for (var a = s.getImageData(0, 0, 1, i).data, n = 0, o = i, h = i; n < h;) {
          0 === a[4 * (h - 1) + 3] ? o = h : n = h, h = o + n >> 1;
        }

        var c = h / i;
        return 0 == c ? 1 : c;
      }(e, 0, a) : 1, p = Math.ceil(c * n / s), f = Math.ceil(c * o / a / g), d = 0, v = 0; d < a;) {
        for (var m = 0, w = 0; m < s;) {
          l.clearRect(0, 0, c, c), l.drawImage(e, -m, -d), h.drawImage(u, 0, 0, c, c, w, v, p, f), m += c, w += p;
        }

        d += c, v += f;
      }

      h.restore(), u = l = null;
    }
  }

  var d = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;

  function e(e) {
    if (window.Blob && e instanceof Blob) {
      if (!d) throw Error("No createObjectURL function found to create blob url");
      var t = new Image();
      t.src = d.createObjectURL(e), this.blob = e, e = t;
    }

    if (!e.naturalWidth && !e.naturalHeight) {
      var r = this;
      e.onload = e.onerror = function () {
        var e = r.imageLoadListeners;

        if (e) {
          r.imageLoadListeners = null;

          for (var t = 0, i = e.length; t < i; t++) {
            e[t]();
          }
        }
      }, this.imageLoadListeners = [];
    }

    this.srcImage = e;
  }

  e.prototype.render = function (e, t, i) {
    if (this.imageLoadListeners) {
      var r = this;
      this.imageLoadListeners.push(function () {
        r.render(e, t, i);
      });
    } else {
      t = t || {};
      var s = this.srcImage.naturalWidth,
          a = this.srcImage.naturalHeight,
          n = t.width,
          o = t.height,
          h = t.maxWidth,
          c = t.maxHeight,
          u = !this.blob || "image/jpeg" === this.blob.type;
      n && !o ? o = a * n / s << 0 : o && !n ? n = s * o / a << 0 : (n = s, o = a), h && h < n && (o = a * (n = h) / s << 0), c && c < o && (n = s * (o = c) / a << 0);
      var l = {
        width: n,
        height: o
      };

      for (var g in t) {
        l[g] = t[g];
      }

      var p = e.tagName.toLowerCase();
      "img" === p ? e.src = function (e, t, i) {
        var r = document.createElement("canvas");
        return f(e, r, t, i), r.toDataURL("image/jpeg", t.quality || .8);
      }(this.srcImage, l, u) : "canvas" === p && f(this.srcImage, e, l, u), "function" == typeof this.onrender && this.onrender(e), i && i(), this.blob && (this.blob = null, d.revokeObjectURL(this.srcImage.src));
    }
  }, "function" == typeof define && define.amd ? define([], function () {
    return e;
  }) : "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) ? module.exports = e : this.MegaPixImage = e;
}.call(this);